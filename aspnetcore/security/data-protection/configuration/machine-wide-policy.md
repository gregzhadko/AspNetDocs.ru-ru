---
title: Поддержка политика компьютера для защиты данных в ASP.NET Core
author: rick-anderson
description: Сведения о поддержке для настройки политики компьютера по умолчанию для всех приложений, использующих защиты данных в ASP.NET Core.
ms.author: riande
ms.date: 10/14/2016
uid: security/data-protection/configuration/machine-wide-policy
ms.openlocfilehash: 70aaca7afcd3df22cebb4466fbd9845a2277688c
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/01/2019
ms.locfileid: "57055591"
---
# <a name="data-protection-machine-wide-policy-support-in-aspnet-core"></a>Поддержка политика компьютера для защиты данных в ASP.NET Core

Автор: [Рик Андерсон](https://twitter.com/RickAndMSFT) (Rick Anderson)

При запуске в Windows, система защиты данных обеспечивает ограниченную поддержку для настройки политики компьютера по умолчанию для всех приложений, использующих защиты данных в ASP.NET Core. Общая идея заключается в том, что администратор может потребоваться изменить значение по умолчанию, такие как используемые алгоритмы или время жизни ключа, без необходимости вручную обновлять каждое приложение на компьютере.

> [!WARNING]
> Системный администратор может задать политику по умолчанию, но они не может принудительно. Разработчик приложений всегда можно переопределить любое значение с одним из собственных выбор. Политика по умолчанию влияет только на приложения, где разработчик не указано явное значение для параметра.

## <a name="setting-default-policy"></a>Задание политики по умолчанию

Чтобы настроить политику по умолчанию, администратор может задать известные значения в системном реестре в следующем разделе реестра:

**HKLM\SOFTWARE\Microsoft\DotNetPackages\Microsoft.AspNetCore.DataProtection**

Если вы используете 64-разрядной операционной системе и хотите повлиять на 32-разрядных приложений, не забудьте настроить эквивалент Wow6432Node указанный выше раздел.

Ниже приведены поддерживаемые значения.

| Значение              | Тип   | Описание: |
| ------------------ | :----: | ----------- |
| EncryptionType     | string | Указывает, какие алгоритмы следует использовать для защиты данных. Значение должно быть CNG-CBC, CNG GCM или управляемый код и описан более подробно ниже. |
| DefaultKeyLifetime | DWORD  | Указывает время существования для вновь создаваемых ключей. Значение указывается в днях и должен быть > = 7. |
| KeyEscrowSinks     | string | Указывает типы, которые используются для доверительного хранения ключа. Значение представляет собой список разделенных точкой с запятой приемников доверительного хранения ключа, где каждый элемент в списке является квалифицированное имя типа, который реализует [IKeyEscrowSink](/dotnet/api/microsoft.aspnetcore.dataprotection.keymanagement.ikeyescrowsink). |

## <a name="encryption-types"></a>Типы шифрования

Если задан CNG-CBC, система настроена для использования режима CBC симметричный блочный шифр конфиденциальность и HMAC для подлинности с помощью службы, предоставляемые Windows CNG (см. в разделе [указание пользовательские алгоритмы Windows CNG](xref:security/data-protection/configuration/overview#specifying-custom-windows-cng-algorithms) для Дополнительные сведения). Поддерживаются следующие дополнительные значения, каждый из которых соответствует свойству типа CngCbcAuthenticatedEncryptionSettings.

| Значение                       | Тип   | Описание: |
| --------------------------- | :----: | ----------- |
| EncryptionAlgorithm         | string | Имя алгоритма симметричного блочного шифра, понятны CNG. Этот алгоритм открыт в режиме CBC. |
| EncryptionAlgorithmProvider | string | Имя реализации поставщика CNG, способный создать алгоритм EncryptionAlgorithm. |
| EncryptionAlgorithmKeySize  | DWORD  | Длина ключа для наследования для алгоритма симметричного блочного шифра (в битах). |
| HashAlgorithm               | string | Имя хэш-алгоритма, воспринимаемый CNG. Этот алгоритм открыт в режиме HMAC. |
| HashAlgorithmProvider       | string | Имя реализации поставщика CNG, способный создать алгоритм HashAlgorithm. |

Если EncryptionType CNG-GCM, система настроен для использования симметричный блочный шифр режим Galois/счетчика по конфиденциальности и подлинность с помощью служб, предоставляемых Windows CNG (см. в разделе [указание пользовательские алгоритмы Windows CNG](xref:security/data-protection/configuration/overview#specifying-custom-windows-cng-algorithms) Для получения дополнительных сведений). Поддерживаются следующие дополнительные значения, каждый из которых соответствует свойству типа CngGcmAuthenticatedEncryptionSettings.

| Значение                       | Тип   | Описание |
| --------------------------- | :----: | ----------- |
| EncryptionAlgorithm         | string | Имя алгоритма симметричного блочного шифра, понятны CNG. Этот алгоритм открыт в режиме Galois/счетчика. |
| EncryptionAlgorithmProvider | string | Имя реализации поставщика CNG, способный создать алгоритм EncryptionAlgorithm. |
| EncryptionAlgorithmKeySize  | DWORD  | Длина ключа для наследования для алгоритма симметричного блочного шифра (в битах). |

Если EncryptionType является управляемым, система настроена для использования управляемых SymmetricAlgorithm конфиденциальность и KeyedHashAlgorithm для подлинности (см. в разделе [Указание пользовательского управляемого алгоритмы](xref:security/data-protection/configuration/overview#specifying-custom-managed-algorithms) подробности). Поддерживаются следующие дополнительные значения, каждый из которых соответствует свойству типа ManagedAuthenticatedEncryptionSettings.

| Значение                      | Тип   | Описание: |
| -------------------------- | :----: | ----------- |
| EncryptionAlgorithmType    | string | Квалифицированное имя типа, который реализует SymmetricAlgorithm. |
| EncryptionAlgorithmKeySize | DWORD  | Длина ключа для наследования для алгоритма симметричного шифрования (в битах). |
| ValidationAlgorithmType    | string | Квалифицированное имя типа, который реализует алгоритм KeyedHashAlgorithm. |

Если задан имеет любое другое значение, отличное от null или пусто, система защиты данных вызывает исключение при запуске.

> [!WARNING]
> Чтобы настроить параметр политики по умолчанию, который включает в себя имена типов (EncryptionAlgorithmType, ValidationAlgorithmType, KeyEscrowSinks), типы должны быть доступны приложению. Это означает, что для приложений, запущенных в классическую среду CLR, сборок, содержащих эти типы должны присутствовать в глобальный кэш сборок (GAC). Для приложений ASP.NET Core, запущенных в .NET Core следует установить пакеты, содержащие эти типы.
