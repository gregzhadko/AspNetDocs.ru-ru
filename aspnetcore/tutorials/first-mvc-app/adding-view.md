---
title: Добавление представления в приложение MVC ASP.NET Core
author: rick-anderson
description: Добавление представления в простое приложение ASP.NET Core MVC
ms.author: riande
ms.date: 03/04/2017
uid: tutorials/first-mvc-app/adding-view
ms.openlocfilehash: 32eddb233a8a6b9b8f480926673d15d568ce6ede
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/01/2019
ms.locfileid: "57032341"
---
# <a name="add-a-view-to-an-aspnet-core-mvc-app"></a>Добавление представления в приложение MVC ASP.NET Core

Автор: [Рик Андерсон](https://twitter.com/RickAndMSFT) (Rick Anderson)

В этом разделе вы измените класс `HelloWorldController`, чтобы использовать файлы представления [Razor](xref:mvc/views/razor) для отчетливой инкапсуляции процесса создания HTML-ответов для клиента.

Файл шаблона представления создается с помощью Razor. Шаблоны представления на основе Razor имеют расширение файла *.cshtml*. Они реализуют удобный способ для создания выходных данных HTML с помощью C#.

Сейчас метод `Index` возвращает строку с сообщением, которое жестко задано в классе контроллера. В классе `HelloWorldController` замените метод `Index` следующим кодом:

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/HelloWorldController.cs?name=snippet_4)]

Предыдущий код вызывает метод <xref:Microsoft.AspNetCore.Mvc.Controller.View*> контроллера. В нем используется шаблон представления для создания HTML-ответа. Методы контроллера (также называются *методами действия*), такие как приведенный выше метод `Index`, обычно возвращают <xref:Microsoft.AspNetCore.Mvc.IActionResult> (или производный от <xref:Microsoft.AspNetCore.Mvc.ActionResult> класс), а не типы, такие как `string`.

## <a name="add-a-view"></a>Добавление представления

<!-- VS -------------------------->
# <a name="visual-studiotabvisual-studio"></a>[Visual Studio](#tab/visual-studio)

* Щелкните правой кнопкой мыши папку *Views*, а затем выберите **Добавить > Новая папка**. Назовите папку *HelloWorld*.

* Щелкните правой кнопкой мыши папку *Views/HelloWorld*, а затем выберите **Добавить > Новый элемент**.

* В диалоговом окне **Добавление нового элемента MvcMovie** выполните следующие действия.

  * В поле поиска в правом верхнем углу введите *view* (представление).

  * Нажмите **Представление Razor**

  * В поле *Имя* оставьте значение **Index.cshtml**.

  * Нажмите **Добавить**

![Диалоговое окно ''Добавление нового элемента''](adding-view/_static/add_view.png)

<!-- Code -------------------------->
# <a name="visual-studio-codetabvisual-studio-code"></a>[Visual Studio Code.](#tab/visual-studio-code)

Добавьте представление `Index` для `HelloWorldController`.

* Добавьте новую папку с именем *Views/HelloWorld*.
* Добавьте новый файл *Index.cshtml* в папку *Views/HelloWorld*.

<!-- Mac -------------------------->
# <a name="visual-studio-for-mactabvisual-studio-mac"></a>[Visual Studio для Mac](#tab/visual-studio-mac)

* Щелкните правой кнопкой мыши папку *Views*, а затем выберите **Добавить > Новая папка**. Назовите папку *HelloWorld*.
* Щелкните правой кнопкой мыши папку *Views/HelloWorld*, а затем выберите **Добавить > Новый файл**.
* В диалоговом окне **Новый файл** выполните следующие действия.

  * В левой области выберите **Веб**.
  * В центральной области выберите **Пустой HTML-файл**.
  * В поле **Имя** введите *Index.cshtml*.
  * Щелкните **Создать**.

![Диалоговое окно ''Добавление нового элемента''](adding-view/_static/add_view.png)

---  
<!-- End of VS tabs -->

Замените содержимое файла представления Razor *Views/HelloWorld/Index.cshtml* следующим:

[!code-HTML[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie22/Views/HelloWorld/Index1.cshtml?highlight=7)]

Перейдите к `https://localhost:xxxx/HelloWorld`. Метод `Index` в `HelloWorldController` сделал совсем мало. Он выполнил оператор `return View();`, который указал, что метод должен использовать файл шаблона представления для отображения ответа в браузере. Поскольку имя файла шаблона представления не указывается явно, модель MVC по умолчанию использует файл представления *Index.cshtml* в папке */Views/HelloWorld*. На рисунке ниже показана строка "Hello from our View Template!", которая жестко задана в представлении.

![Окно браузера](~/tutorials/first-mvc-app/adding-view/_static/hell_template.png)

## <a name="change-views-and-layout-pages"></a>Изменение представлений и страниц макета

Выберите ссылки в меню (**MvcMovie**, **Домашняя страница** и **Конфиденциальность**). Меню на каждой странице имеют одинаковый макет. Макет меню реализован в файле *Views/Shared/_Layout.cshtml*. Откройте файл *Views/Shared/_Layout.cshtml*.

С помощью шаблонов [макета](xref:mvc/views/layout) можно в одном месте задать макет контейнера HTML для всего сайта и затем использовать его на разных страницах сайта. Найдите строку `@RenderBody()`. `RenderBody` — это заполнитель, в котором отображаются все создаваемые страницы для определенных представлений, *упакованные* на странице макета. Например, если щелкнуть ссылку **Конфиденциальность**, представление **Views/Home/Privacy.cshtml** отображается в методе `RenderBody`.

## <a name="change-the-title-footer-and-menu-link-in-the-layout-file"></a>Изменение заголовка, нижнего колонтитула и ссылки меню в файле макета

* В элементах заголовка и нижнего колонтитула измените `MvcMovie` на `Movie App`.
* Измените элемент привязки `<a class="navbar-brand" asp-area="" asp-controller="Home" asp-action="Index">MvcMovie</a>` на `<a class="navbar-brand" asp-controller="Movies" asp-action="Index">Movie App</a>`.

Эти изменения выделены в следующей разметке:

[!code-html[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie22/Views/Shared/_Layout.cshtml?highlight=6,24,51)]

В приведенной выше разметке [атрибут вспомогательной функции тега привязки](xref:mvc/views/tag-helpers/builtin-th/anchor-tag-helper) `asp-area` был опущен, так как это приложение не использует [области](xref:mvc/controllers/areas).

<!-- Routing has changed in 2.2, it's going to the last route.
>[!WARNING]
> We haven't implemented the `Movies` controller yet, so if you click the `Movie App` link, you get a 404 (Not found) error.
-->

**Примечание**. Контроллер `Movies` не был реализован. На этом этапе ссылка `Movie App` не работает.

Сохраните изменения и нажмите на ссылку **Конфиденциальность**. Обратите внимание, что заголовок вкладки браузера изменяется на **Политика конфиденциальности — Movie App** вместо **Политика конфиденциальности — Mvc Movie**:

![Вкладка "Конфиденциальность"](~/tutorials/first-mvc-app/adding-view/_static/about2.png)

Выберите ссылку **Домашняя страница** и убедитесь, что в заголовке и тексте привязки также отображается **Movie App**. Таким образом, внеся одно изменение в шаблон макета, мы изменили заголовок и текст ссылки на всех страницах сайта.

Просмотрите файл *Views/_ViewStart.cshtml*:

```HTML
@{
    Layout = "_Layout";
}
```

Файл *Views/_ViewStart.cshtml* предоставляет файл *Views/Shared/_Layout.cshtml* для каждого представления. Свойство `Layout` может задавать другое представление макета или иметь значение `null`, при котором макет не используется.

Измените заголовок и элемент `<h2>` файла представления *Views/HelloWorld/Index.cshtml*:

[!code-HTML[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Views/HelloWorld/Index2.cshtml?highlight=2,5)]

Заголовок и элемент `<h2>` немного отличаются, чтобы вы видели, какой именно фрагмент кода изменяет отображение.

`ViewData["Title"] = "Movie List";` в приведенном выше коде присваивает свойству `Title` словаря `ViewData` значение "Movie List". Свойство `Title` используется в элементе HTML `<title>` на странице макета:

```HTML
<title>@ViewData["Title"] - Movie App</title>
   ```

Сохраните изменения и перейдите к `https://localhost:xxxx/HelloWorld`. Обратите внимание, что основной и дополнительный заголовки браузера изменились. (Если изменения не отображаются, возможно, вы просматриваете кэшированное содержимое. В этом случае нажмите в браузере клавиши CTRL+F5 для принудительной загрузки ответа сервера.) Заголовок браузера создается с помощью атрибута `ViewData["Title"]`, который задается в шаблоне представления *Index.cshtml* и дополнительной строки "- Movie App", добавляемой в файл макета.

Также обратите внимание, что содержимое шаблона представления *Index.cshtml* объединяется с шаблоном представления *Views/Shared/_Layout.cshtml*, а в браузер отправляется один ответ HTML. С помощью шаблонов макета можно легко вносить изменения, которые применяются ко всем страницам приложения. Дополнительные сведения см. в разделе [Макет](xref:mvc/views/layout).

![Представление списка фильмов](~/tutorials/first-mvc-app/adding-view/_static/hell3.png)

В этом примере небольшой фрагмент данных (сообщение "Hello from our View Template!" ) жестко задан в коде. Приложение MVC предоставляет представление, вы реализуете контроллер, однако модели на данный момент еще нет.

## <a name="passing-data-from-the-controller-to-the-view"></a>Передача данных из контроллера в представление

Действия контроллера вызываются в ответ на входящий запрос URL-адреса. Код, обрабатывающий входящие запросы браузера, добавляется в класс контроллера. Контроллер извлекает данные из источника данных и определяет тип ответа, который будет отправлен в браузер. Контроллер может использовать шаблоны представлений для создания и форматирования ответа HTML, отправляемого браузеру.

Контроллер отвечает за предоставление данных, необходимых шаблону представления для отображения ответа. Рекомендации: шаблоны представлений **не должны** выполнять бизнес-логику или напрямую взаимодействовать с базой данных. Вместо этого они должны работать только с данными, которые им предоставляет контроллер. Подобное разделение сфер ответственности позволяет обеспечить максимальную оптимизацию кода, а также удобство его тестирования и поддержки.

В настоящее время метод `Welcome` в классе `HelloWorldController` принимает параметры `name` и `ID`, после чего выводит значения непосредственно в браузер. Вместо отображения ответа в виде строки настройте контроллер для использования шаблона представления. Шаблон представления создает динамический ответ, для получения которого необходимо передать соответствующие фрагменты данных из контроллера в представление. Для этого контроллер может поместить динамические данные (параметры), которые требуются шаблону представления, в словарь `ViewData`, к которому впоследствии будет обращаться этот шаблон.

В файле *HelloWorldController.cs* измените метод `Welcome` так, чтобы добавлять значения `Message` и `NumTimes` в словарь `ViewData`. Словарь `ViewData` является динамическим объектом, то есть можно использовать любой тип. Объект `ViewData` не имеет определенных свойств, пока в него не будут добавлены какие-либо данные. [Система привязки модели MVC](xref:mvc/models/model-binding) автоматически сопоставляет именованные параметры (`name` и `numTimes`) из строк запроса в адресной строке с параметрами метода. Полный файл *HelloWorldController.cs* выглядит следующим образом:

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/HelloWorldController.cs?name=snippet_5)]

Объект словаря `ViewData` содержит данные, которые будут передаваться в представление. 

Создайте шаблон представления экрана приветствия с именем *Views/HelloWorld/Welcome.cshtml*.

В шаблоне представления *Welcome.cshtml* создайте цикл, который будет отображать строку "Hello" `NumTimes`. Замените содержимое файла *Views/HelloWorld/Welcome.cshtml* следующим:

[!code-html[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Views/HelloWorld/Welcome.cshtml)]

Сохраните изменения и перейдите по следующему URL-адресу:

`https://localhost:xxxx/HelloWorld/Welcome?name=Rick&numtimes=4`

Данные извлекаются по URL-адресу и передаются в контроллер с помощью [средства привязки модели MVC](xref:mvc/models/model-binding). Контроллер упаковывает данные в словарь `ViewData` и передает этот объект в представление. Представление отображает данные в формате HTML в браузере.

![Представление конфиденциальности, в котором отображается приветственный заголовок и четыре раза выводится фраза Hello Rick.](~/tutorials/first-mvc-app/adding-view/_static/rick2.png)

В примере выше мы использовали словарь `ViewData` для передачи данных из контроллера в представление. Далее в этом руководстве для передачи данных из контроллера в представление мы будем использовать модель представления. Подход к передаче данных на основе модели представления является предпочтительным относительно применения словаря `ViewData`. Дополнительные сведения см. в статье [When to use ViewBag, ViewData, or TempData in ASP.NET MVC 3 applications](http://www.rachelappel.com/when-to-use-viewbag-viewdata-or-tempdata-in-asp-net-mvc-3-applications/) (Использование ViewBag, ViewData или TempData в приложениях ASP.NET MVC 3).

В следующем руководстве создается база данных фильмов.

> [!div class="step-by-step"]
> [Назад](adding-controller.md)
> [Вперед](adding-model.md)
