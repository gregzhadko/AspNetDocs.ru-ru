---
title: Привязка модели в ASP.NET Core
author: tdykstra
description: Узнайте, как привязка модели в ASP.NET Core MVC сопоставляет данные из HTTP-запросов с параметрами методов действия.
ms.assetid: 0be164aa-1d72-4192-bd6b-192c9c301164
ms.author: tdykstra
ms.date: 11/13/2018
uid: mvc/models/model-binding
ms.openlocfilehash: 1dc9b41328ed78440622acc1865b6f088d394403
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/01/2019
ms.locfileid: "57037051"
---
# <a name="model-binding-in-aspnet-core"></a><span data-ttu-id="b2387-103">Привязка модели в ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="b2387-103">Model Binding in ASP.NET Core</span></span>

<span data-ttu-id="b2387-104">Автор: [Рэйчел Аппель](https://github.com/rachelappel) (Rachel Appel)</span><span class="sxs-lookup"><span data-stu-id="b2387-104">By [Rachel Appel](https://github.com/rachelappel)</span></span>

## <a name="introduction-to-model-binding"></a><span data-ttu-id="b2387-105">Общие сведения о привязке модели</span><span class="sxs-lookup"><span data-stu-id="b2387-105">Introduction to model binding</span></span>

<span data-ttu-id="b2387-106">Привязка модели в ASP.NET Core MVC сопоставляет данные из HTTP-запросов с параметрами методов действия.</span><span class="sxs-lookup"><span data-stu-id="b2387-106">Model binding in ASP.NET Core MVC maps data from HTTP requests to action method parameters.</span></span> <span data-ttu-id="b2387-107">Параметры могут быть простыми типами, такими как строки, целые числа или значения с плавающей запятой, или они могут быть сложными типами.</span><span class="sxs-lookup"><span data-stu-id="b2387-107">The parameters may be simple types such as strings, integers, or floats, or they may be complex types.</span></span> <span data-ttu-id="b2387-108">Это отличная возможность в MVC, так как сопоставление входящих данных с аналогами часто является повторяющейся операцией независимо от размера и сложности данных.</span><span class="sxs-lookup"><span data-stu-id="b2387-108">This is a great feature of MVC because mapping incoming data to a counterpart is an often repeated scenario, regardless of size or complexity of the data.</span></span> <span data-ttu-id="b2387-109">В MVC эта проблема решается путем абстрагирования привязки, поэтому разработчикам не нужно переписывать незначительно отличающуюся версию одного и того же кода в каждом приложении.</span><span class="sxs-lookup"><span data-stu-id="b2387-109">MVC solves this problem by abstracting binding away so developers don't have to keep rewriting a slightly different version of that same code in every app.</span></span> <span data-ttu-id="b2387-110">Написание собственного кода для преобразователя типов занимает много времени и подвержено ошибкам.</span><span class="sxs-lookup"><span data-stu-id="b2387-110">Writing your own text to type converter code is tedious, and error prone.</span></span>

## <a name="how-model-binding-works"></a><span data-ttu-id="b2387-111">Принцип действия привязки модели</span><span class="sxs-lookup"><span data-stu-id="b2387-111">How model binding works</span></span>

<span data-ttu-id="b2387-112">Когда MVC получает HTTP-запрос, он направляет его в определенный метод действия контроллера.</span><span class="sxs-lookup"><span data-stu-id="b2387-112">When MVC receives an HTTP request, it routes it to a specific action method of a controller.</span></span> <span data-ttu-id="b2387-113">Он определяет, какой метод действия необходимо запустить с учетом данных маршрута, а затем привязывает значения из HTTP-запроса к параметрам метода действия.</span><span class="sxs-lookup"><span data-stu-id="b2387-113">It determines which action method to run based on what is in the route data, then it binds values from the HTTP request to that action method's parameters.</span></span> <span data-ttu-id="b2387-114">Например, рассмотрим следующий URL-адрес:</span><span class="sxs-lookup"><span data-stu-id="b2387-114">For example, consider the following URL:</span></span>

`http://contoso.com/movies/edit/2`

<span data-ttu-id="b2387-115">Поскольку шаблон маршрута имеет вид `{controller=Home}/{action=Index}/{id?}`, направляет `movies/edit/2` в контроллер `Movies`, и его метод действия `Edit`.</span><span class="sxs-lookup"><span data-stu-id="b2387-115">Since the route template looks like this, `{controller=Home}/{action=Index}/{id?}`, `movies/edit/2` routes to the `Movies` controller, and its `Edit` action method.</span></span> <span data-ttu-id="b2387-116">Он также принимает необязательный параметр `id`.</span><span class="sxs-lookup"><span data-stu-id="b2387-116">It also accepts an optional parameter called `id`.</span></span> <span data-ttu-id="b2387-117">Код для метода действия должен выглядеть примерно следующим образом:</span><span class="sxs-lookup"><span data-stu-id="b2387-117">The code for the action method should look something like this:</span></span>

```csharp
public IActionResult Edit(int? id)
   ```

<span data-ttu-id="b2387-118">Примечание. Строки в URL-маршрут не чувствительны к регистру.</span><span class="sxs-lookup"><span data-stu-id="b2387-118">Note: The strings in the URL route are not case sensitive.</span></span>

<span data-ttu-id="b2387-119">MVC попытается привязать данные запроса к параметрам действия по имени.</span><span class="sxs-lookup"><span data-stu-id="b2387-119">MVC will try to bind request data to the action parameters by name.</span></span> <span data-ttu-id="b2387-120">MVC будет искать значения для каждого параметра, используя имя параметра и имена его открытых задаваемых свойств.</span><span class="sxs-lookup"><span data-stu-id="b2387-120">MVC will look for values for each parameter using the parameter name and the names of its public settable properties.</span></span> <span data-ttu-id="b2387-121">В приведенном выше примере единственным параметром действия является `id`, который MVC привязывает к значению с тем же именем в значениях маршрута.</span><span class="sxs-lookup"><span data-stu-id="b2387-121">In the above example, the only action parameter is named `id`, which MVC binds to the value with the same name in the route values.</span></span> <span data-ttu-id="b2387-122">Помимо значений маршрута, MVC будет привязывать данные из различных частей запроса, следуя установленному порядку.</span><span class="sxs-lookup"><span data-stu-id="b2387-122">In addition to route values MVC will bind data from various parts of the request and it does so in a set order.</span></span> <span data-ttu-id="b2387-123">Ниже приведен список источников данных в порядке, в котором их просматривает привязка модели.</span><span class="sxs-lookup"><span data-stu-id="b2387-123">Below is a list of the data sources in the order that model binding looks through them:</span></span>

1. <span data-ttu-id="b2387-124">`Form values`: Это значения формы, включаемые в HTTP-запросе, с помощью метода POST.</span><span class="sxs-lookup"><span data-stu-id="b2387-124">`Form values`: These are form values that go in the HTTP request using the POST method.</span></span> <span data-ttu-id="b2387-125">(включая запросы POST jQuery)</span><span class="sxs-lookup"><span data-stu-id="b2387-125">(including jQuery POST requests).</span></span>

2. <span data-ttu-id="b2387-126">`Route values`: Набор значений маршрута, предоставляемых [маршрутизации](xref:fundamentals/routing)</span><span class="sxs-lookup"><span data-stu-id="b2387-126">`Route values`: The set of route values provided by [Routing](xref:fundamentals/routing)</span></span>

3. <span data-ttu-id="b2387-127">`Query strings`: Часть URI, строки запроса.</span><span class="sxs-lookup"><span data-stu-id="b2387-127">`Query strings`: The query string part of the URI.</span></span>

<!-- DocFX BUG
The link works but generates an error when building with DocFX
@fundamentals/routing
[Routing](xref:fundamentals/routing)
-->

<span data-ttu-id="b2387-128">Примечание. Значения формы, данные о маршруте и запросов строки хранятся как пары "имя значение".</span><span class="sxs-lookup"><span data-stu-id="b2387-128">Note: Form values, route data, and query strings are all stored as name-value pairs.</span></span>

<span data-ttu-id="b2387-129">Так как привязка модели запросила ключ `id`, а в значениях формы нет ничего с именем `id`, она перешла к поиску ключа в значениях маршрута.</span><span class="sxs-lookup"><span data-stu-id="b2387-129">Since model binding asked for a key named `id` and there's nothing named `id` in the form values, it moved on to the route values looking for that key.</span></span> <span data-ttu-id="b2387-130">В нашем примере найдено совпадение.</span><span class="sxs-lookup"><span data-stu-id="b2387-130">In our example, it's a match.</span></span> <span data-ttu-id="b2387-131">Выполняется привязка, а значение преобразуется в целое число 2.</span><span class="sxs-lookup"><span data-stu-id="b2387-131">Binding happens, and the value is converted to the integer 2.</span></span> <span data-ttu-id="b2387-132">Тот же запрос с использованием Edit(string id) приведет к преобразованию в строку "2".</span><span class="sxs-lookup"><span data-stu-id="b2387-132">The same request using Edit(string id) would convert to the string "2".</span></span>

<span data-ttu-id="b2387-133">Пока в примере используются простые типы.</span><span class="sxs-lookup"><span data-stu-id="b2387-133">So far the example uses simple types.</span></span> <span data-ttu-id="b2387-134">В MVC простыми типами являются любые типы-примитивы .NET или типы с преобразователем строковых типов.</span><span class="sxs-lookup"><span data-stu-id="b2387-134">In MVC simple types are any .NET primitive type or type with a string type converter.</span></span> <span data-ttu-id="b2387-135">Если бы параметром метода действия был класс, такой как тип `Movie`, который в качестве свойств содержал простые и сложные типы, привязка модели MVC обработала бы его соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="b2387-135">If the action method's parameter were a class such as the `Movie` type, which contains both simple and complex types as properties, MVC's model binding will still handle it nicely.</span></span> <span data-ttu-id="b2387-136">При поиске совпадений она использует отражение и рекурсию для обхода свойств сложных типов.</span><span class="sxs-lookup"><span data-stu-id="b2387-136">It uses reflection and recursion to traverse the properties of complex types looking for matches.</span></span> <span data-ttu-id="b2387-137">Для привязки значений к свойствам привязка модели ищет шаблон *имя_параметра.имя_свойства*.</span><span class="sxs-lookup"><span data-stu-id="b2387-137">Model binding looks for the pattern *parameter_name.property_name* to bind values to properties.</span></span> <span data-ttu-id="b2387-138">Если она не находит совпадающие значения этого вида, будет предпринята попытка привязки с помощью только имени свойства.</span><span class="sxs-lookup"><span data-stu-id="b2387-138">If it doesn't find matching values of this form, it will attempt to bind using just the property name.</span></span> <span data-ttu-id="b2387-139">Для таких типов, например типов `Collection`, привязка модели ищет совпадения с *имя_параметра [индекс]* или просто *[индекс]*.</span><span class="sxs-lookup"><span data-stu-id="b2387-139">For those types such as `Collection` types, model binding looks for matches to *parameter_name[index]* or just *[index]*.</span></span> <span data-ttu-id="b2387-140">Привязка модели аналогичным образом обрабатывает типы `Dictionary`, выполняя поиск *имя_параметра[ключ]* или просто *[ключ]*, при условии, что ключи являются простыми типами.</span><span class="sxs-lookup"><span data-stu-id="b2387-140">Model binding treats  `Dictionary` types similarly, asking for *parameter_name[key]* or just *[key]*, as long as the keys are simple types.</span></span> <span data-ttu-id="b2387-141">Поддерживаемые ключи совпадают с именами полей HTML и вспомогательными функциями тегов, созданными для того же типа модели.</span><span class="sxs-lookup"><span data-stu-id="b2387-141">Keys that are supported match the field names HTML and tag helpers generated for the same model type.</span></span> <span data-ttu-id="b2387-142">Благодаря полной совместимости значений для удобства пользователей в полях формы остаются введенные значения, например, если привязанные данные не прошли проверку.</span><span class="sxs-lookup"><span data-stu-id="b2387-142">This enables round-tripping values so that the form fields remain filled with the user's input for their convenience, for example, when bound data from a create or edit didn't pass validation.</span></span>

<span data-ttu-id="b2387-143">Чтобы реализовать привязку модели, этот класс должен иметь открытый конструктор по умолчанию, а также открытые и доступные для записи свойства, подлежащие привязке.</span><span class="sxs-lookup"><span data-stu-id="b2387-143">To make model binding possible, the class must have a public default constructor and public writable properties to bind.</span></span> <span data-ttu-id="b2387-144">Когда происходит привязка модели, класс создается с помощью открытого конструктора по умолчанию, а затем можно задать свойства.</span><span class="sxs-lookup"><span data-stu-id="b2387-144">When model binding occurs, the class is instantiated using the public default constructor, then the properties can be set.</span></span>

<span data-ttu-id="b2387-145">После привязки параметра привязка модели прекращает поиск значений с таким именем и переходит к привязке следующего параметра.</span><span class="sxs-lookup"><span data-stu-id="b2387-145">When a parameter is bound, model binding stops looking for values with that name and it moves on to bind the next parameter.</span></span> <span data-ttu-id="b2387-146">В противном случае привязка модели по умолчанию задает для параметров значения по умолчанию в зависимости от их типа:</span><span class="sxs-lookup"><span data-stu-id="b2387-146">Otherwise, the default model binding behavior sets parameters to their default values depending on their type:</span></span>

* <span data-ttu-id="b2387-147">`T[]`: За исключением массивов типа `byte[]`, привязка задает параметрам типа `T[]` для `Array.Empty<T>()`.</span><span class="sxs-lookup"><span data-stu-id="b2387-147">`T[]`: With the exception of arrays of type `byte[]`, binding sets parameters of type `T[]` to `Array.Empty<T>()`.</span></span> <span data-ttu-id="b2387-148">Массивам типа `byte[]` задается значение `null`.</span><span class="sxs-lookup"><span data-stu-id="b2387-148">Arrays of type `byte[]` are set to `null`.</span></span>

* <span data-ttu-id="b2387-149">Ссылочные типы. Привязка создает экземпляр класса с помощью конструктора по умолчанию без задания свойств.</span><span class="sxs-lookup"><span data-stu-id="b2387-149">Reference Types: Binding creates an instance of a class with the default constructor without setting properties.</span></span> <span data-ttu-id="b2387-150">Однако привязка модели задает параметрам типа `string` значение `null`.</span><span class="sxs-lookup"><span data-stu-id="b2387-150">However, model binding sets `string` parameters to `null`.</span></span>

* <span data-ttu-id="b2387-151">Типы, допускающие значения NULL: Типы, допускающие значение NULL, присваивается `null`.</span><span class="sxs-lookup"><span data-stu-id="b2387-151">Nullable Types: Nullable types are set to `null`.</span></span> <span data-ttu-id="b2387-152">В приведенном выше примере привязка модели задает `id` значение `null`, так как он имеет тип `int?`.</span><span class="sxs-lookup"><span data-stu-id="b2387-152">In the above example, model binding sets `id` to `null` since it's of type `int?`.</span></span>

* <span data-ttu-id="b2387-153">Типы значений: Типы, не допускающие значений типа `T` присваивается `default(T)`.</span><span class="sxs-lookup"><span data-stu-id="b2387-153">Value Types: Non-nullable value types of type `T` are set to `default(T)`.</span></span> <span data-ttu-id="b2387-154">Например, привязка модели присвоит параметру `int id` значение 0.</span><span class="sxs-lookup"><span data-stu-id="b2387-154">For example, model binding will set a parameter `int id` to 0.</span></span> <span data-ttu-id="b2387-155">Вместо значений по умолчанию рекомендуется использовать проверку модели или типы, допускающие значение NULL.</span><span class="sxs-lookup"><span data-stu-id="b2387-155">Consider using model validation or nullable types rather than relying on default values.</span></span>

<span data-ttu-id="b2387-156">Если привязка завершается сбоем, MVC не вызывает ошибку.</span><span class="sxs-lookup"><span data-stu-id="b2387-156">If binding fails, MVC doesn't throw an error.</span></span> <span data-ttu-id="b2387-157">Каждое действие, которое принимает вводимые пользователем данные, должно проверять свойство `ModelState.IsValid`.</span><span class="sxs-lookup"><span data-stu-id="b2387-157">Every action which accepts user input should check the `ModelState.IsValid` property.</span></span>

<span data-ttu-id="b2387-158">Примечание. Каждая запись в контроллера `ModelState` свойство `ModelStateEntry` содержащий `Errors` свойство.</span><span class="sxs-lookup"><span data-stu-id="b2387-158">Note: Each entry in the controller's `ModelState` property is a `ModelStateEntry` containing an `Errors` property.</span></span> <span data-ttu-id="b2387-159">Необходимость запрашивать эту коллекцию самостоятельно возникает редко.</span><span class="sxs-lookup"><span data-stu-id="b2387-159">It's rarely necessary to query this collection yourself.</span></span> <span data-ttu-id="b2387-160">Взамен рекомендуется использовать `ModelState.IsValid`.</span><span class="sxs-lookup"><span data-stu-id="b2387-160">Use `ModelState.IsValid` instead.</span></span>

<span data-ttu-id="b2387-161">Кроме того, существуют некоторые особые типы данных, которые MVC необходимо учитывать при выполнении привязки модели:</span><span class="sxs-lookup"><span data-stu-id="b2387-161">Additionally, there are some special data types that MVC must consider when performing model binding:</span></span>

* <span data-ttu-id="b2387-162">`IFormFile`, `IEnumerable<IFormFile>`: Один или несколько отправленных файлов, которые являются частью HTTP-запроса.</span><span class="sxs-lookup"><span data-stu-id="b2387-162">`IFormFile`, `IEnumerable<IFormFile>`: One or more uploaded files that are part of the HTTP request.</span></span>

* <span data-ttu-id="b2387-163">`CancellationToken`: Используется для отмены действия в асинхронных контроллерах.</span><span class="sxs-lookup"><span data-stu-id="b2387-163">`CancellationToken`: Used to cancel activity in asynchronous controllers.</span></span>

<span data-ttu-id="b2387-164">Эти типы можно привязать к параметрам действия или к свойствам в типе класса.</span><span class="sxs-lookup"><span data-stu-id="b2387-164">These types can be bound to action parameters or to properties on a class type.</span></span>

<span data-ttu-id="b2387-165">После привязки модели происходит [проверка](validation.md).</span><span class="sxs-lookup"><span data-stu-id="b2387-165">Once model binding is complete, [Validation](validation.md) occurs.</span></span> <span data-ttu-id="b2387-166">Привязка модели по умолчанию отлично подходит для подавляющего большинства сценариев разработки.</span><span class="sxs-lookup"><span data-stu-id="b2387-166">Default model binding works great for the vast majority of development scenarios.</span></span> <span data-ttu-id="b2387-167">Она также является расширяемой, поэтому если у вас есть особые потребности, можно настроить встроенное поведение.</span><span class="sxs-lookup"><span data-stu-id="b2387-167">It's also extensible so if you have unique needs you can customize the built-in behavior.</span></span>

## <a name="customize-model-binding-behavior-with-attributes"></a><span data-ttu-id="b2387-168">Настройка поведения привязки модели с помощью атрибутов</span><span class="sxs-lookup"><span data-stu-id="b2387-168">Customize model binding behavior with attributes</span></span>

<span data-ttu-id="b2387-169">В MVC есть несколько атрибутов, которые можно использовать для направления поведения привязки модели по умолчанию в другой источник.</span><span class="sxs-lookup"><span data-stu-id="b2387-169">MVC contains several attributes that you can use to direct its default model binding behavior to a different source.</span></span> <span data-ttu-id="b2387-170">Например, с помощью атрибутов `[BindRequired]` или `[BindNever]` можно указать, требуется ли привязка для свойства или она вообще не должна выполняться.</span><span class="sxs-lookup"><span data-stu-id="b2387-170">For example, you can specify whether binding is required for a property, or if it should never happen at all by using the `[BindRequired]` or `[BindNever]` attributes.</span></span> <span data-ttu-id="b2387-171">Кроме того, можно переопределить источник данных по умолчанию и указать источник данных связывателя модели.</span><span class="sxs-lookup"><span data-stu-id="b2387-171">Alternatively, you can override the default data source, and specify the model binder's data source.</span></span> <span data-ttu-id="b2387-172">Ниже приведен список атрибутов привязки модели.</span><span class="sxs-lookup"><span data-stu-id="b2387-172">Below is a list of model binding attributes:</span></span>

* <span data-ttu-id="b2387-173">`[BindRequired]`: Этот атрибут добавляет ошибку состояния модели, если привязку выполнить невозможно.</span><span class="sxs-lookup"><span data-stu-id="b2387-173">`[BindRequired]`: This attribute adds a model state error if binding cannot occur.</span></span>

* <span data-ttu-id="b2387-174">`[BindNever]`: Указывает связывателю модели никогда не выполнять привязку к данному параметру.</span><span class="sxs-lookup"><span data-stu-id="b2387-174">`[BindNever]`: Tells the model binder to never bind to this parameter.</span></span>

* <span data-ttu-id="b2387-175">`[FromHeader]`, `[FromQuery]`, `[FromRoute]`, `[FromForm]`: Используются для указания точного источника привязки, необходимо применить.</span><span class="sxs-lookup"><span data-stu-id="b2387-175">`[FromHeader]`, `[FromQuery]`, `[FromRoute]`, `[FromForm]`: Use these to specify the exact binding source you want to apply.</span></span>

* <span data-ttu-id="b2387-176">`[FromServices]`: Этот атрибут использует [внедрения зависимостей](../../fundamentals/dependency-injection.md) для привязки параметров из служб.</span><span class="sxs-lookup"><span data-stu-id="b2387-176">`[FromServices]`: This attribute uses [dependency injection](../../fundamentals/dependency-injection.md) to bind parameters from services.</span></span>

* <span data-ttu-id="b2387-177">`[FromBody]`: Используйте настроенные модули форматирования для привязки данных из текста запроса.</span><span class="sxs-lookup"><span data-stu-id="b2387-177">`[FromBody]`: Use the configured formatters to bind data from the request body.</span></span> <span data-ttu-id="b2387-178">Модуль форматирования выбирается в зависимости от типа содержимого запроса.</span><span class="sxs-lookup"><span data-stu-id="b2387-178">The formatter is selected based on content type of the request.</span></span>

* <span data-ttu-id="b2387-179">`[ModelBinder]`: Используется для переопределения связывателя модели по умолчанию, источник привязки и имя.</span><span class="sxs-lookup"><span data-stu-id="b2387-179">`[ModelBinder]`: Used to override the default model binder, binding source and name.</span></span>

<span data-ttu-id="b2387-180">Атрибуты очень полезны при переопределении поведения по умолчанию привязки модели.</span><span class="sxs-lookup"><span data-stu-id="b2387-180">Attributes are very helpful tools when you need to override the default behavior of model binding.</span></span>

## <a name="customize-model-binding-and-validation-globally"></a><span data-ttu-id="b2387-181">Глобальная настройка привязки и проверки модели</span><span class="sxs-lookup"><span data-stu-id="b2387-181">Customize model binding and validation globally</span></span>

<span data-ttu-id="b2387-182">Поведение привязки модели и системы проверки определяется классом [ModelMetadata](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.modelmetadata), который описывает:</span><span class="sxs-lookup"><span data-stu-id="b2387-182">The model binding and validation system's behavior is driven by [ModelMetadata](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.modelmetadata) that describes:</span></span>

* <span data-ttu-id="b2387-183">Как модель будет привязана.</span><span class="sxs-lookup"><span data-stu-id="b2387-183">How a model is to be bound.</span></span>
* <span data-ttu-id="b2387-184">Как выполняется проверка типа и его свойств.</span><span class="sxs-lookup"><span data-stu-id="b2387-184">How validation occurs on the type and its properties.</span></span>

<span data-ttu-id="b2387-185">Аспекты поведения системы можно настроить глобально, добавив поставщика сведений в [MvcOptions.ModelMetadataDetailsProviders](/dotnet/api/microsoft.aspnetcore.mvc.mvcoptions.modelmetadatadetailsproviders#Microsoft_AspNetCore_Mvc_MvcOptions_ModelMetadataDetailsProviders).</span><span class="sxs-lookup"><span data-stu-id="b2387-185">Aspects of the system's behavior can be configured globally by adding a details provider to [MvcOptions.ModelMetadataDetailsProviders](/dotnet/api/microsoft.aspnetcore.mvc.mvcoptions.modelmetadatadetailsproviders#Microsoft_AspNetCore_Mvc_MvcOptions_ModelMetadataDetailsProviders).</span></span> <span data-ttu-id="b2387-186">MVC имеет несколько встроенных поставщиков сведений, которые позволяют настраивать такое поведение, как отключение привязки модели или проверки для определенных типов.</span><span class="sxs-lookup"><span data-stu-id="b2387-186">MVC has a few built-in details providers that allow configuring behavior such as disabling model binding or validation for certain types.</span></span>

<span data-ttu-id="b2387-187">Для отключения привязки модели для всех моделей определенного типа добавьте [ExcludeBindingMetadataProvider](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.metadata.excludebindingmetadataprovider) в `Startup.ConfigureServices`.</span><span class="sxs-lookup"><span data-stu-id="b2387-187">To disable model binding on all models of a certain type, add an [ExcludeBindingMetadataProvider](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.metadata.excludebindingmetadataprovider) in `Startup.ConfigureServices`.</span></span> <span data-ttu-id="b2387-188">Например, для отключения привязки модели для всех моделей типа `System.Version`:</span><span class="sxs-lookup"><span data-stu-id="b2387-188">For example, to disable model binding on all models of type `System.Version`:</span></span>

```csharp
services.AddMvc().AddMvcOptions(options =>
    options.ModelMetadataDetailsProviders.Add(
        new ExcludeBindingMetadataProvider(typeof(System.Version))));
```

<span data-ttu-id="b2387-189">Чтобы отключить проверку свойств определенного типа, добавьте [SuppressChildValidationMetadataProvider](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.suppresschildvalidationmetadataprovider) в `Startup.ConfigureServices`.</span><span class="sxs-lookup"><span data-stu-id="b2387-189">To disable validation on properties of a certain type, add a [SuppressChildValidationMetadataProvider](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.suppresschildvalidationmetadataprovider) in `Startup.ConfigureServices`.</span></span> <span data-ttu-id="b2387-190">Например, чтобы отключить проверку по свойствам типа `System.Guid`:</span><span class="sxs-lookup"><span data-stu-id="b2387-190">For example, to disable validation on properties of type `System.Guid`:</span></span>

```csharp
services.AddMvc().AddMvcOptions(options =>
    options.ModelMetadataDetailsProviders.Add(
        new SuppressChildValidationMetadataProvider(typeof(System.Guid))));
```

## <a name="bind-formatted-data-from-the-request-body"></a><span data-ttu-id="b2387-191">Привязка отформатированных данных из текста запроса</span><span class="sxs-lookup"><span data-stu-id="b2387-191">Bind formatted data from the request body</span></span>

<span data-ttu-id="b2387-192">Данные запроса могут иметь различные форматы, включая JSON, XML и многие другие.</span><span class="sxs-lookup"><span data-stu-id="b2387-192">Request data can come in a variety of formats including JSON, XML and many others.</span></span> <span data-ttu-id="b2387-193">Если вы используете атрибут [FromBody], чтобы указать необходимость привязки параметра к данным в тексте запроса, MVC использует настроенный набор модулей форматирования для обработки данных запроса на основе его типа содержимого.</span><span class="sxs-lookup"><span data-stu-id="b2387-193">When you use the [FromBody] attribute to indicate that you want to bind a parameter to data in the request body, MVC uses a configured set of formatters to handle the request data based on its content type.</span></span> <span data-ttu-id="b2387-194">По умолчанию MVC содержит класс `JsonInputFormatter` для обработки данных JSON, но вы можете добавить дополнительные модули форматирования для обработки XML и других пользовательских форматов.</span><span class="sxs-lookup"><span data-stu-id="b2387-194">By default MVC includes a `JsonInputFormatter` class for handling JSON data, but you can add additional formatters for handling XML and other custom formats.</span></span>

> [!NOTE]
> <span data-ttu-id="b2387-195">Для каждого действия с атрибутом `[FromBody]` может существовать не более одного параметра.</span><span class="sxs-lookup"><span data-stu-id="b2387-195">There can be at most one parameter per action decorated with `[FromBody]`.</span></span> <span data-ttu-id="b2387-196">Среда выполнения ASP.NET Core MVC делегирует ответственность за считывание потока запроса модулю форматирования.</span><span class="sxs-lookup"><span data-stu-id="b2387-196">The ASP.NET Core MVC run-time delegates the responsibility of reading the request stream to the formatter.</span></span> <span data-ttu-id="b2387-197">После считывания потока запроса для параметра, как правило, невозможно повторно считать поток запроса для привязки других параметров `[FromBody]`.</span><span class="sxs-lookup"><span data-stu-id="b2387-197">Once the request stream is read for a parameter, it's generally not possible to read the request stream again for binding other `[FromBody]` parameters.</span></span>

> [!NOTE]
> <span data-ttu-id="b2387-198">`JsonInputFormatter` является модулем форматирования по умолчанию и основан на [Json.NET](https://www.newtonsoft.com/json).</span><span class="sxs-lookup"><span data-stu-id="b2387-198">The `JsonInputFormatter` is the default formatter and is based on [Json.NET](https://www.newtonsoft.com/json).</span></span>

<span data-ttu-id="b2387-199">ASP.NET Core выбирает модули форматирования входных данных на основе заголовка [Content-Type](https://www.w3.org/Protocols/rfc1341/4_Content-Type.html) и типа параметра, если отсутствует примененный к нему атрибут, указывающий иное.</span><span class="sxs-lookup"><span data-stu-id="b2387-199">ASP.NET Core selects input formatters based on the [Content-Type](https://www.w3.org/Protocols/rfc1341/4_Content-Type.html) header and the type of the parameter, unless there's an attribute applied to it specifying otherwise.</span></span> <span data-ttu-id="b2387-200">Чтобы использовать XML или другой формат, его необходимо настроить в файле *Startup.cs*, но, возможно, сначала потребуется получить ссылку на `Microsoft.AspNetCore.Mvc.Formatters.Xml` с помощью NuGet.</span><span class="sxs-lookup"><span data-stu-id="b2387-200">If you'd like to use XML or another format you must configure it in the *Startup.cs* file, but you may first have to obtain a reference to `Microsoft.AspNetCore.Mvc.Formatters.Xml` using NuGet.</span></span> <span data-ttu-id="b2387-201">Код запуска должен выглядеть примерно следующим образом:</span><span class="sxs-lookup"><span data-stu-id="b2387-201">Your startup code should look something like this:</span></span>

```csharp
public void ConfigureServices(IServiceCollection services)
{
    services.AddMvc()
        .AddXmlSerializerFormatters();
   }
```

<span data-ttu-id="b2387-202">Код в файле *Startup.cs* содержит метод `ConfigureServices` с аргументом `services`, который можно использовать для построения служб для приложения ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="b2387-202">Code in the *Startup.cs* file contains a `ConfigureServices` method with a `services` argument you can use to build up services for your ASP.NET Core app.</span></span> <span data-ttu-id="b2387-203">В примере показано добавление модуля форматирования XML в качестве службы, которую MVC будет предоставлять для этого приложения.</span><span class="sxs-lookup"><span data-stu-id="b2387-203">In the sample, we are adding an XML formatter as a service that MVC will provide for this app.</span></span> <span data-ttu-id="b2387-204">Аргумент `options`, переданный в метод `AddMvc`, позволяет добавлять фильтры, модули форматирования и другие системные параметры из MVC при запуске приложения и управлять ими.</span><span class="sxs-lookup"><span data-stu-id="b2387-204">The `options` argument passed into the `AddMvc` method allows you to add and manage filters, formatters, and other system options from MVC upon app startup.</span></span> <span data-ttu-id="b2387-205">Затем для работы с необходимым форматом атрибут `Consumes` применяется к классам контроллера или методам действий.</span><span class="sxs-lookup"><span data-stu-id="b2387-205">Then apply the `Consumes` attribute to controller classes or action methods to work with the format you want.</span></span>

### <a name="custom-model-binding"></a><span data-ttu-id="b2387-206">Пользовательская привязка модели</span><span class="sxs-lookup"><span data-stu-id="b2387-206">Custom Model Binding</span></span>

<span data-ttu-id="b2387-207">Для расширения возможностей привязки модели можно написать собственные пользовательские связыватели модели.</span><span class="sxs-lookup"><span data-stu-id="b2387-207">You can extend model binding by writing your own custom model binders.</span></span> <span data-ttu-id="b2387-208">Узнайте больше о [пользовательской привязке модели](../advanced/custom-model-binding.md).</span><span class="sxs-lookup"><span data-stu-id="b2387-208">Learn more about [custom model binding](../advanced/custom-model-binding.md).</span></span>
