---
uid: web-pages/overview/performance-and-traffic/15-caching-to-improve-the-performance-of-your-website
title: Кэширование данных в веб-ASP.NET страниц узла (Razor) для повышения производительности | Документация Майкрософт
author: Rick-Anderson
description: Можно ускорить веб-сайта, унаследовав его хранения — то есть кэш — результаты, обычно бы много времени получения и обработки данных...
ms.author: riande
ms.date: 02/14/2014
ms.assetid: 961e525b-7700-469e-8a68-d7010b6fb68c
msc.legacyurl: /web-pages/overview/performance-and-traffic/15-caching-to-improve-the-performance-of-your-website
msc.type: authoredcontent
ms.openlocfilehash: 01796d3ca699a6af5d9162b22a926551435c2040
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65134580"
---
# <a name="caching-data-in-an-aspnet-web-pages-razor-site-for-better-performance"></a>Кэширование данных на сайте ASP.NET Web Pages (Razor) для повышения производительности

по [Tom FitzMacken](https://github.com/tfitzmac)

> В этой статье описываются способы использования вспомогательным приложением для кэширования данных для повышения производительности в на веб-сайте ASP.NET Web Pages (Razor). Веб-сайта можно ускорить, унаследовав его хранения &#8212; т.е кэшировать &#8212; результатов данных, обычно будет занимать много времени, получения и обработки и часто не меняется.
> 
> **Вы узнаете, как:** 
> 
> - Как использовать кэширование для повышения скорости реагирования веб-сайта.
> 
> Ниже приведены функции ASP.NET, представленные в этой статье.
> 
> - `WebCache` Вспомогательный.
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a>Версии программного обеспечения, используемые в этом руководстве
> 
> 
> - Веб-страниц ASP.NET (Razor) 3
>   
> 
> Этот учебник также работает с ASP.NET Web Pages 2.

Каждый раз, когда кто-то запрашивает страницу с веб-узла, веб-сервер должен выполнить некоторые действия, чтобы выполнить запрос. Для некоторых страниц сервер может иметь для выполнения задач, которые долго (сравнительно), такие как извлечение данных из базы данных. Даже если эти задачи не принимают долго в абсолютных цифрах, если большой объем трафика, можно добавить весь ряд отдельных запросов, которые веб-сервер для выполнения задачи сложной или медленной до большой объем работы. В конечном счете это может повлиять на производительность сайта.

Для кэширования данных является одним из способов повышения производительности веб-сайта в случаях следующим образом. Если сайт получает повторных запросов одной и той же информации и сведения не должны быть изменены для каждого пользователя, а не время конфиденциальными, вместо повторного выборка или повторное вычисление, можно выборки данных один раз и затем сохранять полученные данные. В следующий раз поступлении запроса для этого сведения, вы просто получить данную информацию из кэша.

Как правило можно кэшировать сведения, которые изменяются редко. Сведения, добавленные в кэше, он хранится в памяти на веб-сервере. Можно указать, как долго должен кэшироваться, от нескольких секунд до дней. По истечении времени кэширования сведения автоматически удаляется из кэша.

> [!NOTE]
> Записей в кэше может быть удалена в целях отличное от их срока. Например веб-сервер может временно нехватке памяти, и один из способов, он может освобождать память — путем создания записи из кэша. Как вы увидите, даже если вы собрали сведения в кэш, вам нужно убедитесь, что это по-прежнему возможна при необходимости.

Представьте, что ваш веб-сайт имеет страницу, которая отображает текущую температуру и прогноз погоды. Чтобы получить такую информацию, может отправить запрос к внешней службе. Поскольку эта информация не меняется большая (в пределах периода времени, например), а также поскольку внешних вызовов требуется время и пропускную способность, он хорошо подходит для кэширования.

## <a name="adding-caching-to-a-page"></a>Добавление кэширования на страницу

ASP.NET включает в себя `WebCache` помощник, который облегчает добавление кэширования для веб-узла и добавления данных в кэш. В этой процедуре вы создадите страницу, которая кэширует текущее время. Это не реальный пример, так как текущее время — нечто, редко меняется, а кроме того это сложно рассчитать. Тем не менее это хороший способ продемонстрировать, кэширование в действии.

1. Добавьте новую страницу с именем *WebCache.cshtml* на веб-сайт.
2. Добавьте следующий код и разметку страницы:

    [!code-cshtml[Main](15-caching-to-improve-the-performance-of-your-website/samples/sample1.cshtml)]

    При кэшировании данных, можно разместить его в кэш, используя имя является уникальным для веб-сайта. В этом случае будет использоваться запись с именем `CachedTime`. Это `cacheItemKey` показано в примере кода.

    Код сначала считывает `CachedTime` элемента кэша. Если значение возвращается (то есть, если запись кэша не равно null), код просто задает значение переменной времени для кэширования данных.

    Тем не менее если запись кэша не существует (то есть он имеет значение null), код задает значение времени, добавляет его в кэш и задает значение срока действия до одной минуты. В течение одной минуты удаляются записи кэша. (Значение по умолчанию срока действия для элемента в кэше составляет 20 минут). Команда `WebCache.Set(cacheItemKey, time, 1, false)` показано, как добавить текущее значение времени в кэш и его срок действия набора в 1 минуту. Установка *slidingExpiration* параметр `false` означает, что срок действия не обновляется при каждом запросе. Ее действия истекает ровно 1 минуту после ее добавления в кэш. Если это значение равно `true` время окончания срока действия 1 минута сбрасывается при каждом запросе значения из кэша.

    Этот код иллюстрирует шаблон, который всегда следует использовать при кэшировании данных. Прежде чем что-то из кэша, всегда сначала проверьте ли `WebCache.Get` метод вернул значение null. Помните, что запись кэша истек или был удален по другой причине, поэтому любой определенной записи никогда не обязательно находиться в кэше.
3. Запустите *WebCache.cshtml* в браузере. (Убедитесь, что выбран страницы **файлы** рабочей области, прежде чем запускать его.) При первом запросе страницы, время данные находятся не в кэше, и код должен добавить значения времени в кэш.

    ![кэш-1](15-caching-to-improve-the-performance-of-your-website/_static/image1.jpg)
4. Обновить *WebCache.cshtml* в браузере. В данном случае данные времени находится в кэше. Обратите внимание на то, что время не изменилось со времени последнего просмотра страницы.

    ![кэш-2](15-caching-to-improve-the-performance-of-your-website/_static/image2.jpg)
5. Подождите одну минуту очистить кэш и затем обновите страницу. Страницу еще раз означает, что данные времени не был найден в кэше и время обновления добавляется в кэш.

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a>Дополнительные ресурсы

- [Отображение данных в диаграмме](https://go.microsoft.com/fwlink/?LinkId=202895)
- [Справочник по WebCache API](https://msdn.microsoft.com/library/system.web.helpers.webcache(v=vs.99).aspx) (MSDN)
