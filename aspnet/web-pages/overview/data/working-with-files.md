---
uid: web-pages/overview/data/working-with-files
title: Работа с файлами на сайте ASP.NET Web Pages (Razor) | Документация Майкрософт
author: Rick-Anderson
description: В этой главе объясняется, как для чтения, записи, добавление, удаление и передачи файлов.
ms.author: riande
ms.date: 02/20/2014
ms.assetid: eee916e4-ba4c-439a-a24e-68df7d45a569
msc.legacyurl: /web-pages/overview/data/working-with-files
msc.type: authoredcontent
ms.openlocfilehash: 4a62cce3af57b507882744f948ce208becdb03ac
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59382307"
---
# <a name="working-with-files-in-an-aspnet-web-pages-razor-site"></a><span data-ttu-id="9f3d5-103">Работа с файлами на сайте ASP.NET Web Pages (Razor)</span><span class="sxs-lookup"><span data-stu-id="9f3d5-103">Working with Files in an ASP.NET Web Pages (Razor) Site</span></span>

<span data-ttu-id="9f3d5-104">по [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="9f3d5-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="9f3d5-105">В этой статье объясняется, как для чтения, записи, добавление, удаление и передачи файлов на сайте веб-страниц ASP.NET (Razor).</span><span class="sxs-lookup"><span data-stu-id="9f3d5-105">This article explains how to read, write, append, delete, and upload files in an ASP.NET Web Pages (Razor) site.</span></span>
> 
> > [!NOTE]
> > <span data-ttu-id="9f3d5-106">Если вы хотите отправлять изображения и управление ими (например, перевернуть или изменить их размер), см. в разделе [работа с изображениями на сайте веб-страниц ASP.NET](https://go.microsoft.com/fwlink/?LinkId=202897).</span><span class="sxs-lookup"><span data-stu-id="9f3d5-106">If you want to upload images and manipulate them (for example, flip or resize them), see [Working with Images in an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=202897).</span></span>
> 
> 
> **<span data-ttu-id="9f3d5-107">Вы узнаете, как:</span><span class="sxs-lookup"><span data-stu-id="9f3d5-107">What you'll learn:</span></span>** 
> 
> - <span data-ttu-id="9f3d5-108">Как создать текстовый файл и записать на него данные.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-108">How to create a text file and write data to it.</span></span>
> - <span data-ttu-id="9f3d5-109">Как добавлять данные в существующий файл.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-109">How to append data to an existing file.</span></span>
> - <span data-ttu-id="9f3d5-110">Как чтение данных из файла и отобразить его.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-110">How to read a file and display from it.</span></span>
> - <span data-ttu-id="9f3d5-111">Как удалить файлы с веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-111">How to delete files from a website.</span></span>
> - <span data-ttu-id="9f3d5-112">Как разрешить пользователям отправлять одного или нескольких файлов.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-112">How to let users upload one file or multiple files.</span></span>
> 
> <span data-ttu-id="9f3d5-113">Ниже перечислены возможности, представленные в этой статье программирования ASP.NET:</span><span class="sxs-lookup"><span data-stu-id="9f3d5-113">These are the ASP.NET programming features introduced in the article:</span></span>
> 
> - <span data-ttu-id="9f3d5-114">`File` Объект, который предоставляет способ для управления файлами.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-114">The `File` object, which provides a way to manage files.</span></span>
> - <span data-ttu-id="9f3d5-115">`FileUpload` Вспомогательный.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-115">The `FileUpload` helper.</span></span>
> - <span data-ttu-id="9f3d5-116">`Path` Объект, который предоставляет методы, позволяющие управлять путь и имена файлов.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-116">The `Path` object, which provides methods that let you manipulate path and file names.</span></span>
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="9f3d5-117">Версии программного обеспечения, используемые в этом руководстве</span><span class="sxs-lookup"><span data-stu-id="9f3d5-117">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="9f3d5-118">Веб-страниц ASP.NET (Razor) 2</span><span class="sxs-lookup"><span data-stu-id="9f3d5-118">ASP.NET Web Pages (Razor) 2</span></span>
> - <span data-ttu-id="9f3d5-119">WebMatrix 2</span><span class="sxs-lookup"><span data-stu-id="9f3d5-119">WebMatrix 2</span></span>
>   
> 
> <span data-ttu-id="9f3d5-120">Этот учебник также работает с WebMatrix 3.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-120">This tutorial also works with WebMatrix 3.</span></span>


<a id="Creating_a_Text_File"></a>
## <a name="creating-a-text-file-and-writing-data-to-it"></a><span data-ttu-id="9f3d5-121">Создание текстового файла и запись в нее данных</span><span class="sxs-lookup"><span data-stu-id="9f3d5-121">Creating a Text File and Writing Data to It</span></span>

<span data-ttu-id="9f3d5-122">Помимо использования базы данных в веб-сайта, может работать с файлами.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-122">In addition to using a database in your website, you might work with files.</span></span> <span data-ttu-id="9f3d5-123">Например можно использовать текстовые файлы как простой способ хранения данных для сайта.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-123">For example, you might use text files as a simple way to store data for the site.</span></span> <span data-ttu-id="9f3d5-124">(Текстовый файл, который используется для хранения данных иногда называют *неструктурированного файла*.) Текстовые файлы можно представлять в различных форматах, например *.txt*, *.xml*, или *.csv* (значения с разделителями запятыми).</span><span class="sxs-lookup"><span data-stu-id="9f3d5-124">(A text file that's used to store data is sometimes called a *flat file*.) Text files can be in different formats, like *.txt*, *.xml*, or *.csv* (comma-delimited values).</span></span>

<span data-ttu-id="9f3d5-125">Если вы хотите хранить данные в текстовый файл, можно использовать `File.WriteAllText` метод, чтобы задать его для создания и данные для записи в него.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-125">If you want to store data in a text file, you can use the `File.WriteAllText` method to specify the file to create and the data to write to it.</span></span> <span data-ttu-id="9f3d5-126">В этой процедуре вы создадите страницу, содержащую простая форма с тремя `input` элементы (имя, фамилию и адрес электронной почты) и **отправить** кнопки.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-126">In this procedure, you'll create a page that contains a simple form with three `input` elements (first name, last name, and email address) and a **Submit** button.</span></span> <span data-ttu-id="9f3d5-127">Когда пользователь отправляет форму, введенные пользователем данные будут храниться в текстовом файле.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-127">When the user submits the form, you'll store the user's input in a text file.</span></span>

1. <span data-ttu-id="9f3d5-128">Создайте новую папку с именем *приложения\_данных*, если она еще не существует.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-128">Create a new folder named *App\_Data*, if it doesn't exist already.</span></span>
2. <span data-ttu-id="9f3d5-129">В корне веб-сайта, создайте файл с именем *UserData.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-129">At the root of your website, create a new file named *UserData.cshtml*.</span></span>
3. <span data-ttu-id="9f3d5-130">Замените существующее содержимое следующим:</span><span class="sxs-lookup"><span data-stu-id="9f3d5-130">Replace the existing content with the following:</span></span> 

    [!code-cshtml[Main](working-with-files/samples/sample1.cshtml)]

    <span data-ttu-id="9f3d5-131">HTML-разметка создается форма с тремя текстовыми полями.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-131">The HTML markup creates the form with the three text boxes.</span></span> <span data-ttu-id="9f3d5-132">В коде, используйте `IsPost` свойства, чтобы определить, отправлен ли страницы перед началом обработки.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-132">In the code, you use the `IsPost` property to determine whether the page has been submitted before you start processing.</span></span>

    <span data-ttu-id="9f3d5-133">Первым делом следует получить входные данные пользователя и его назначение переменных.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-133">The first task is to get the user input and assign it to variables.</span></span> <span data-ttu-id="9f3d5-134">Код затем присоединяет значения отдельных переменных в одну строку с разделителями запятыми, который сохраняется в другую переменную.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-134">The code then concatenates the values of the separate variables into one comma-delimited string, which is then stored in a different variable.</span></span> <span data-ttu-id="9f3d5-135">Обратите внимание, что разделителем в виде запятой строку, содержащуюся в кавычки («,»), так как вы выполняете внедрение буквально запятую в больших строку, который вы создаете.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-135">Notice that the comma separator is a string contained in quotation marks (","), because you're literally embedding a comma into the big string that you're creating.</span></span> <span data-ttu-id="9f3d5-136">В конце данные, которые можно сцепить друг с другом, добавлении `Environment.NewLine`.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-136">At the end of the data that you concatenate together, you add `Environment.NewLine`.</span></span> <span data-ttu-id="9f3d5-137">Это добавляет разрыв строки (символ перевода строки).</span><span class="sxs-lookup"><span data-stu-id="9f3d5-137">This adds a line break (a newline character).</span></span> <span data-ttu-id="9f3d5-138">Что вы создаете с помощью этого объединения — это строка, выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="9f3d5-138">What you're creating with all this concatenation is a string that looks like this:</span></span>

    [!code-css[Main](working-with-files/samples/sample2.css)]

    <span data-ttu-id="9f3d5-139">(С невидимым разрыва строки в конце.)</span><span class="sxs-lookup"><span data-stu-id="9f3d5-139">(With an invisible line break at the end.)</span></span>

    <span data-ttu-id="9f3d5-140">Затем создается переменная (`dataFile`), содержащий расположение и имя файла для хранения данных.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-140">You then create a variable (`dataFile`) that contains the location and name of the file to store the data in.</span></span> <span data-ttu-id="9f3d5-141">Задание расположения требует особого обращения.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-141">Setting the location requires some special handling.</span></span> <span data-ttu-id="9f3d5-142">В веб-сайтов, не рекомендуется для ссылки в коде в абсолютные пути, например *C:\Folder\File.txt* для файлов на веб-сервере.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-142">In websites, it's a bad practice to refer in code to absolute paths like *C:\Folder\File.txt* for files on the web server.</span></span> <span data-ttu-id="9f3d5-143">При перемещении веб-сайт, абсолютный путь будет работать неправильно.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-143">If a website is moved, an absolute path will be wrong.</span></span> <span data-ttu-id="9f3d5-144">Кроме того для размещенного узла (а не на своем компьютере) вы обычно даже неизвестен правильный путь при написании кода.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-144">Moreover, for a hosted site (as opposed to on your own computer) you typically don't even know what the correct path is when you're writing the code.</span></span>

    <span data-ttu-id="9f3d5-145">Но иногда (например, теперь для записи в файл) вам нужен полный путь.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-145">But sometimes (like now, for writing a file) you do need a complete path.</span></span> <span data-ttu-id="9f3d5-146">Решением является использование `MapPath` метод `Server` объекта.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-146">The solution is to use the `MapPath` method of the `Server` object.</span></span> <span data-ttu-id="9f3d5-147">Это возвращает полный путь к веб-сайту.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-147">This returns the complete path to your website.</span></span> <span data-ttu-id="9f3d5-148">Для получения пути к корню веб-сайта, пользователь `~` оператор (для represen сайта виртуального корневого) для `MapPath`.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-148">To get the path for the website root, you user the `~` operator (to represen the site's virtual root) to `MapPath`.</span></span> <span data-ttu-id="9f3d5-149">(Можно также передать имя вложенной папки, например *~/App\_данных /*, чтобы получить путь к этой вложенной папке.) Затем можно сцепить Дополнительные сведения на любой метод возвращает для создания полного пути.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-149">(You can also pass a subfolder name to it, like *~/App\_Data/*, to get the path for that subfolder.) You can then concatenate additional information onto whatever the method returns in order to create a complete path.</span></span> <span data-ttu-id="9f3d5-150">В этом примере добавьте имя файла.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-150">In this example, you add a file name.</span></span> <span data-ttu-id="9f3d5-151">(Дополнительные сведения о том, как работать с пути файлов и папок в [введение в ASP.NET веб-страниц программирование с использованием синтаксиса Razor](https://go.microsoft.com/fwlink/?LinkId=195205#ID_WorkingWithFileAndFolderPaths).)</span><span class="sxs-lookup"><span data-stu-id="9f3d5-151">(You can read more about how to work with file and folder paths in [Introduction to ASP.NET Web Pages Programming Using the Razor Syntax](https://go.microsoft.com/fwlink/?LinkId=195205#ID_WorkingWithFileAndFolderPaths).)</span></span>

    <span data-ttu-id="9f3d5-152">Файл сохраняется в *приложения\_данных* папки.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-152">The file is saved in the *App\_Data* folder.</span></span> <span data-ttu-id="9f3d5-153">Эта папка это особая папка, в ASP.NET, который используется для хранения файлов данных, как описано в разделе [введение в работу с базой данных в веб-узлы веб-страниц ASP.NET](https://go.microsoft.com/fwlink/?LinkId=195209).</span><span class="sxs-lookup"><span data-stu-id="9f3d5-153">This folder is a special folder in ASP.NET that's used to store data files, as described in [Introduction to Working with a Database in ASP.NET Web Pages Sites](https://go.microsoft.com/fwlink/?LinkId=195209).</span></span>

    <span data-ttu-id="9f3d5-154">`WriteAllText` Метод `File` объект записывает данные в файл.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-154">The `WriteAllText` method of the `File` object writes the data to the file.</span></span> <span data-ttu-id="9f3d5-155">Этот метод принимает два параметра: имя файла для записи и данные для записи (с путем).</span><span class="sxs-lookup"><span data-stu-id="9f3d5-155">This method takes two parameters: the name (with path) of the file to write to, and the actual data to write.</span></span> <span data-ttu-id="9f3d5-156">Обратите внимание, что в имени первого параметра `@` символ в качестве префикса.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-156">Notice that the name of the first parameter has an `@` character as a prefix.</span></span> <span data-ttu-id="9f3d5-157">Это сообщает ASP.NET, что вы создаете буквального строкового литерала, а знаки, такие как «/» не должны интерпретироваться особым образом.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-157">This tells ASP.NET that you're providing a verbatim string literal, and that characters like "/" should not be interpreted in special ways.</span></span> <span data-ttu-id="9f3d5-158">(Дополнительные сведения см. в разделе [введение в ASP.NET веб-программирование с помощью синтаксиса Razor](https://go.microsoft.com/fwlink/?LinkId=195205#ID_WorkingWithFileAndFolderPaths).)</span><span class="sxs-lookup"><span data-stu-id="9f3d5-158">(For more information, see [Introduction to ASP.NET Web Programming Using the Razor Syntax](https://go.microsoft.com/fwlink/?LinkId=195205#ID_WorkingWithFileAndFolderPaths).)</span></span>

    > [!NOTE]
    > <span data-ttu-id="9f3d5-159">Чтобы код, чтобы сохранять файлы в *приложения\_данных* папки, приложение должно чтения и записи разрешения для этой папки.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-159">In order for your code to save files in the *App\_Data* folder, the application needs read-write permissions for that folder.</span></span> <span data-ttu-id="9f3d5-160">На компьютере разработчика не обычно это проблема.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-160">On your development computer this is not typically an issue.</span></span> <span data-ttu-id="9f3d5-161">Тем не менее при публикации сайта поставщика услуг размещения веб-сервер, может потребоваться явно задать эти разрешения.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-161">However, when you publish your site to a hosting provider's web server, you might need to explicitly set those permissions.</span></span> <span data-ttu-id="9f3d5-162">Если вы запустите этот код на сервере поставщика услуг размещения и ошибки, проверьте с помощью поставщика услуг размещения, чтобы узнать, как задать эти разрешения.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-162">If you run this code on a hosting provider's server and get errors, check with the hosting provider to find out how to set those permissions.</span></span>

- <span data-ttu-id="9f3d5-163">Откройте страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-163">Run the page in a browser.</span></span> 

    ![](working-with-files/_static/image1.jpg)
- <span data-ttu-id="9f3d5-164">Введите значения в поля и нажмите кнопку **отправить**.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-164">Enter values into the fields and then click **Submit**.</span></span>
- <span data-ttu-id="9f3d5-165">Закройте браузер.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-165">Close the browser.</span></span>
- <span data-ttu-id="9f3d5-166">Вернитесь к проекту и обновите представление.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-166">Return to the project and refresh the view.</span></span>
- <span data-ttu-id="9f3d5-167">Откройте *data.txt* файла.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-167">Open the *data.txt* file.</span></span> <span data-ttu-id="9f3d5-168">Данные, переданные в форме находится в файле.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-168">The data you submitted in the form is in the file.</span></span> 

    ![[изображение]](working-with-files/_static/image2.jpg)
- <span data-ttu-id="9f3d5-170">Закрыть *data.txt* файла.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-170">Close the *data.txt* file.</span></span>

<a id="Appending_Data"></a>
## <a name="appending-data-to-an-existing-file"></a><span data-ttu-id="9f3d5-171">Добавление данных в существующий файл</span><span class="sxs-lookup"><span data-stu-id="9f3d5-171">Appending Data to an Existing File</span></span>

<span data-ttu-id="9f3d5-172">В предыдущем примере вы использовали `WriteAllText` для создания текстового файла, в нем есть лишь одна часть данных.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-172">In the previous example, you used `WriteAllText` to create a text file that's got just one piece of data in it.</span></span> <span data-ttu-id="9f3d5-173">Если вы снова вызвать метод и передать его в то же имя файла, существующий файл перезаписывается полностью.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-173">If you call the method again and pass it the same file name, the existing file is completely overwritten.</span></span> <span data-ttu-id="9f3d5-174">Тем не менее после создания файла часто требуется добавлять новые данные в конец файла.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-174">However, after you've created a file you often want to add new data to the end of the file.</span></span> <span data-ttu-id="9f3d5-175">Можно сделать с помощью `AppendAllText` метод `File` объекта.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-175">You can do that using the `AppendAllText` method of the `File` object.</span></span>

1. <span data-ttu-id="9f3d5-176">На веб-сайте, создается копия *UserData.cshtml* файл и назовите ее *UserDataMultiple.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-176">In the website, make a copy of the *UserData.cshtml* file and name the copy *UserDataMultiple.cshtml*.</span></span>
2. <span data-ttu-id="9f3d5-177">Замените блок кода перед открывающим `<!DOCTYPE html>` тег с приведенным ниже кодом:</span><span class="sxs-lookup"><span data-stu-id="9f3d5-177">Replace the code block before the opening `<!DOCTYPE html>` tag with the following code block:</span></span> 

    [!code-cshtml[Main](working-with-files/samples/sample3.cshtml)]

    <span data-ttu-id="9f3d5-178">Этот код содержит одно изменение из предыдущего примера.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-178">This code has one change in it from the previous example.</span></span> <span data-ttu-id="9f3d5-179">Вместо использования `WriteAllText`, он использует `the AppendAllText` метод.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-179">Instead of using `WriteAllText`, it uses `the AppendAllText` method.</span></span> <span data-ttu-id="9f3d5-180">Методы похожи, за исключением того, что `AppendAllText` добавляет данные в конец файла.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-180">The methods are similar, except that `AppendAllText` adds the data to the end of the file.</span></span> <span data-ttu-id="9f3d5-181">Как и в `WriteAllText`, `AppendAllText` создает файл, если он еще не существует.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-181">As with `WriteAllText`, `AppendAllText` creates the file if it doesn't already exist.</span></span>
3. <span data-ttu-id="9f3d5-182">Откройте страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-182">Run the page in a browser.</span></span>
4. <span data-ttu-id="9f3d5-183">Введите значения для полей и нажмите кнопку **отправить**.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-183">Enter values for the fields and then click **Submit**.</span></span>
5. <span data-ttu-id="9f3d5-184">Добавить дополнительные данные и снова отправить форму.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-184">Add more data and submit the form again.</span></span>
6. <span data-ttu-id="9f3d5-185">Вернитесь в проект, щелкните правой кнопкой мыши папку проекта и нажмите кнопку **обновить**.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-185">Return to your project, right-click the project folder, and then click **Refresh**.</span></span>
7. <span data-ttu-id="9f3d5-186">Откройте *data.txt* файла.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-186">Open the *data.txt* file.</span></span> <span data-ttu-id="9f3d5-187">Теперь в нем новых данных, который вы только что ввели.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-187">It now contains the new data that you just entered.</span></span> 

    ![[изображение]](working-with-files/_static/image3.jpg)

<a id="Reading_and_Displaying_Data"></a>
## <a name="reading-and-displaying-data-from-a-file"></a><span data-ttu-id="9f3d5-189">Чтение и отображение данных из файла</span><span class="sxs-lookup"><span data-stu-id="9f3d5-189">Reading and Displaying Data from a File</span></span>

<span data-ttu-id="9f3d5-190">Даже если не нужно записывать данные в текстовый файл, возможно, иногда необходимо считывать данные из одного.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-190">Even if you don't need to write data to a text file, you'll probably sometimes need to read data from one.</span></span> <span data-ttu-id="9f3d5-191">Чтобы сделать это, можно снова использовать `File` объекта.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-191">To do this, you can again use the `File` object.</span></span> <span data-ttu-id="9f3d5-192">Можно использовать `File` для считывания каждой строки по отдельности (разделенных точкой разрывы строк) или для чтения отдельный элемент, независимо от того, как они разделены.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-192">You can use the `File` object to read each line individually (separated by line breaks) or to read individual item no matter how they're separated.</span></span>

<span data-ttu-id="9f3d5-193">Эта процедура показано, как для чтения и отображения данных, созданный в предыдущем примере.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-193">This procedure shows you how to read and display the data that you created in the previous example.</span></span>

1. <span data-ttu-id="9f3d5-194">В корне веб-сайта, создайте файл с именем *DisplayData.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-194">At the root of your website, create a new file named *DisplayData.cshtml*.</span></span>
2. <span data-ttu-id="9f3d5-195">Замените существующее содержимое следующим:</span><span class="sxs-lookup"><span data-stu-id="9f3d5-195">Replace the existing content with the following:</span></span> 

    [!code-cshtml[Main](working-with-files/samples/sample4.cshtml)]

    <span data-ttu-id="9f3d5-196">Код начинается с чтении файла, созданного в предыдущем примере в переменной с именем `userData`, используя вызов этого метода:</span><span class="sxs-lookup"><span data-stu-id="9f3d5-196">The code starts by reading the file that you created in the previous example into a variable named `userData`, using this method call:</span></span>

    [!code-css[Main](working-with-files/samples/sample5.css)]

    <span data-ttu-id="9f3d5-197">Для этого код находится внутри `if` инструкции.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-197">The code to do this is inside an `if` statement.</span></span> <span data-ttu-id="9f3d5-198">Если вы хотите прочитать файл, рекомендуется использовать `File.Exists` метод определить, доступен ли файл.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-198">When you want to read a file, it's a good idea to use the `File.Exists` method to determine first whether the file is available.</span></span> <span data-ttu-id="9f3d5-199">Код также проверяет, является ли файл пустой.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-199">The code also checks whether the file is empty.</span></span>

    <span data-ttu-id="9f3d5-200">Текст страницы содержит два `foreach` циклы, вложенных друг друга.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-200">The body of the page contains two `foreach` loops, one nested inside the other.</span></span> <span data-ttu-id="9f3d5-201">Внешний `foreach` цикл получает одну строку за раз из файла данных.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-201">The outer `foreach` loop gets one line at a time from the data file.</span></span> <span data-ttu-id="9f3d5-202">В этом случае строки определяются разрывы строк в файле &#8212; каждого элемента данных является на отдельной строке.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-202">In this case, the lines are defined by line breaks in the file &#8212; that is, each data item is on its own line.</span></span> <span data-ttu-id="9f3d5-203">Внешний цикл создает новый элемент (`<li>` элемент) внутри упорядоченный список (`<ol>` элемент).</span><span class="sxs-lookup"><span data-stu-id="9f3d5-203">The outer loop creates a new item (`<li>` element) inside an ordered list (`<ol>` element).</span></span>

    <span data-ttu-id="9f3d5-204">Внутренний цикл разбивает каждую строку данных на элементы (поля), используя запятую в качестве разделителя.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-204">The inner loop splits each data line into items (fields) using a comma as a delimiter.</span></span> <span data-ttu-id="9f3d5-205">(Исходя из предыдущего примера, это означает, что каждая строка содержит три поля &#8212; имя, фамилию и адрес электронной почты, разделенные запятыми.) Внутренний цикл также создает `<ul>` списков и отображает один элемент для каждого поля в строке данных.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-205">(Based on the previous example, this means that each line contains three fields &#8212; the first name, last name, and email address, each separated by a comma.) The inner loop also creates a `<ul>` list and displays one list item for each field in the data line.</span></span>

    <span data-ttu-id="9f3d5-206">Код показывает, как использовать два типа данных массива и `char` тип данных.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-206">The code illustrates how to use two data types, an array and the `char` data type.</span></span> <span data-ttu-id="9f3d5-207">Массив является обязательным, поскольку `File.ReadAllLines` метод возвращает данные в виде массива.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-207">The array is required because the `File.ReadAllLines` method returns data as an array.</span></span> <span data-ttu-id="9f3d5-208">`char` Тип данных является обязательным, поскольку `Split` возвращает `array` в которой каждый элемент имеет тип `char`.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-208">The `char` data type is required because the `Split` method returns an `array` in which each element is of the type `char`.</span></span> <span data-ttu-id="9f3d5-209">(Сведения о массивах см. в разделе [введение в ASP.NET веб-программирование с помощью синтаксиса Razor](https://go.microsoft.com/fwlink/?LinkId=202890#ID_CollectionsAndObjects).)</span><span class="sxs-lookup"><span data-stu-id="9f3d5-209">(For information about arrays, see [Introduction to ASP.NET Web Programming Using the Razor Syntax](https://go.microsoft.com/fwlink/?LinkId=202890#ID_CollectionsAndObjects).)</span></span>
3. <span data-ttu-id="9f3d5-210">Откройте страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-210">Run the page in a browser.</span></span> <span data-ttu-id="9f3d5-211">Отображаются данные, введенный в предыдущих примерах.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-211">The data you entered for the previous examples is displayed.</span></span> 

    ![[изображение]](working-with-files/_static/image4.jpg)

> [!TIP] 
> 
> **<span data-ttu-id="9f3d5-213">Отображение данных из файла с разделителями запятыми Microsoft Excel</span><span class="sxs-lookup"><span data-stu-id="9f3d5-213">Displaying Data from a Microsoft Excel Comma-Delimited File</span></span>**
> 
> <span data-ttu-id="9f3d5-214">Можно использовать Microsoft Excel, чтобы сохранить данные, содержащиеся в электронную таблицу в формате с разделителями запятыми (*.csv* файла).</span><span class="sxs-lookup"><span data-stu-id="9f3d5-214">You can use Microsoft Excel to save the data contained in a spreadsheet as a comma-delimited file (*.csv* file).</span></span> <span data-ttu-id="9f3d5-215">При этом файл сохраняется в виде обычного текста, а не в формате Excel.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-215">When you do, the file is saved in plain text, not in Excel format.</span></span> <span data-ttu-id="9f3d5-216">Каждая строка в таблице, разделенные разрыв строки в текстовом файле и каждого элемента данных, разделенные запятой.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-216">Each row in the spreadsheet is separated by a line break in the text file, and each data item is separated by a comma.</span></span> <span data-ttu-id="9f3d5-217">Код, показанный в предыдущем примере можно использовать для чтения файла с разделителями запятыми Excel так же, изменив имя файла данных в коде.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-217">You can use the code shown in the previous example to read an Excel comma-delimited file just by changing the name of the data file in your code.</span></span>


<a id="Deleting_Files"></a>
## <a name="deleting-files"></a><span data-ttu-id="9f3d5-218">Удаление файлов</span><span class="sxs-lookup"><span data-stu-id="9f3d5-218">Deleting Files</span></span>

<span data-ttu-id="9f3d5-219">Чтобы удалить файлы с веб-сайта, можно использовать `File.Delete` метод.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-219">To delete files from your website, you can use the `File.Delete` method.</span></span> <span data-ttu-id="9f3d5-220">Эта процедура показано, как разрешить пользователям удалять изображения (*.jpg* файла) из *образы* папку, если они знают имя файла.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-220">This procedure shows how to let users delete an image (*.jpg* file) from an *images* folder if they know the name of the file.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="9f3d5-221">**Важные** в рабочем веб-сайте, вы обычно ограничивать доступ для внесения изменений в данные.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-221">**Important** In a production website, you typically restrict who's allowed to make changes to the data.</span></span> <span data-ttu-id="9f3d5-222">Дополнительные сведения о том, как настроить членство и о способах авторизации пользователей для выполнения задач на узле, см. в разделе [Добавление безопасности и членство в сайте веб-страниц ASP.NET](https://go.microsoft.com/fwlink/?LinkId=202904).</span><span class="sxs-lookup"><span data-stu-id="9f3d5-222">For information about how to set up membership and about ways to authorize users to perform tasks on the site, see [Adding Security and Membership to an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=202904).</span></span>


1. <span data-ttu-id="9f3d5-223">На веб-сайте, создайте вложенную папку с именем *образы*.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-223">In the website, create a subfolder named *images*.</span></span>
2. <span data-ttu-id="9f3d5-224">Скопируйте один или несколько *.jpg* файлы в *образы* папки.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-224">Copy one or more *.jpg* files into the *images* folder.</span></span>
3. <span data-ttu-id="9f3d5-225">В корне веб-сайта, создайте новый файл с именем *FileDelete.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-225">In the root of the website, create a new file named *FileDelete.cshtml*.</span></span>
4. <span data-ttu-id="9f3d5-226">Замените существующее содержимое следующим:</span><span class="sxs-lookup"><span data-stu-id="9f3d5-226">Replace the existing content with the following:</span></span> 

    [!code-cshtml[Main](working-with-files/samples/sample6.cshtml)]

    <span data-ttu-id="9f3d5-227">Эта страница содержит форму для ввода имени файла изображения.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-227">This page contains a form where users can enter the name of an image file.</span></span> <span data-ttu-id="9f3d5-228">Они не вводите *.jpg* расширение имени файла; ограничивая имя файла, следующим образом, которые помогут запрещает пользователям удалять произвольные файлы на вашем сайте.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-228">They don't enter the *.jpg* file-name extension; by restricting the file name like this, you help prevents users from deleting arbitrary files on your site.</span></span>

    <span data-ttu-id="9f3d5-229">Код считывает имя файла, что пользователь ввел и затем создает полный путь.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-229">The code reads the file name that the user has entered and then constructs a complete path.</span></span> <span data-ttu-id="9f3d5-230">Чтобы создать путь, в коде используется текущий путь к веб-сайта (возвращенная `Server.MapPath` метод), *образы* имя папки, имя, которое пользователь предоставил и «.jpg» как строковый литерал.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-230">To create the path, the code uses the current website path (as returned by the `Server.MapPath` method), the *images* folder name, the name that the user has provided, and ".jpg" as a literal string.</span></span>

    <span data-ttu-id="9f3d5-231">Для удаления файла, код вызывает метод `File.Delete` , передавая его полный путь, который вы только что создан.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-231">To delete the file, the code calls the `File.Delete` method, passing it the full path that you just constructed.</span></span> <span data-ttu-id="9f3d5-232">В конце разметку выводится сообщение с подтверждением удаления файла.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-232">At the end of the markup, code displays a confirmation message that the file was deleted.</span></span>
5. <span data-ttu-id="9f3d5-233">Откройте страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-233">Run the page in a browser.</span></span> 

    ![[изображение]](working-with-files/_static/image5.jpg)
6. <span data-ttu-id="9f3d5-235">Введите имя файла для удаления и нажмите кнопку **отправить**.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-235">Enter the name of the file to delete and then click **Submit**.</span></span> <span data-ttu-id="9f3d5-236">Если файл был удален, имя файла отображается в нижней части страницы.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-236">If the file was deleted, the name of the file is displayed at the bottom of the page.</span></span>

<a id="Letting_Users_Upload_a_File"></a>
## <a name="letting-users-upload-a-file"></a><span data-ttu-id="9f3d5-237">Позволяя пользователям отправлять файл</span><span class="sxs-lookup"><span data-stu-id="9f3d5-237">Letting Users Upload a File</span></span>

<span data-ttu-id="9f3d5-238">`FileUpload` Вспомогательный позволяет пользователям отправлять файлы на веб-сайт.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-238">The `FileUpload` helper lets users upload files to your website.</span></span> <span data-ttu-id="9f3d5-239">Следующей процедуре показано, как пользователи могут передать один файл.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-239">The procedure below shows you how to let users upload a single file.</span></span>

1. <span data-ttu-id="9f3d5-240">Добавьте библиотеку ASP.NET на веб-сайт, как описано в [Установка вспомогательных функций на сайте веб-страниц ASP.NET](https://go.microsoft.com/fwlink/?LinkId=252372), если вы не добавили ранее.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-240">Add the ASP.NET Web Helpers Library to your website as described in [Installing Helpers in an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=252372), if you didn't add it previously.</span></span>
2. <span data-ttu-id="9f3d5-241">В *приложения\_данных* папки, создайте новую папку и назовите его *UploadedFiles*.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-241">In the *App\_Data* folder, create a new a folder and name it *UploadedFiles*.</span></span>
3. <span data-ttu-id="9f3d5-242">В корне, создайте новый файл с именем *FileUpload.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-242">In the root, create a new file named *FileUpload.cshtml*.</span></span>
4. <span data-ttu-id="9f3d5-243">Замените существующее содержимое на странице следующее:</span><span class="sxs-lookup"><span data-stu-id="9f3d5-243">Replace the existing content in the page with the following:</span></span> 

    [!code-cshtml[Main](working-with-files/samples/sample7.cshtml)]

    <span data-ttu-id="9f3d5-244">Часть тела страницы приложения использует `FileUpload` вспомогательный метод для создания, передачи и кнопки, вы, вероятно, знакомы с:</span><span class="sxs-lookup"><span data-stu-id="9f3d5-244">The body portion of the page uses the `FileUpload` helper to create the upload box and buttons that you're probably familiar with:</span></span>

    ![[изображение]](working-with-files/_static/image6.jpg)

    <span data-ttu-id="9f3d5-246">Свойства, заданные для `FileUpload` вспомогательный укажите, что один флажок для файла, отправляемого и возникает необходимость «отправить» для чтения **отправить**.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-246">The properties that you set for the `FileUpload` helper specify that you want a single box for the file to upload and that you want the submit button to read **Upload**.</span></span> <span data-ttu-id="9f3d5-247">(Вы добавите дополнительные поля чуть позже.)</span><span class="sxs-lookup"><span data-stu-id="9f3d5-247">(You'll add more boxes later in the article.)</span></span>

    <span data-ttu-id="9f3d5-248">Когда пользователь щелкает **отправить**, получает файл кода в верхней части страницы и сохраняет его.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-248">When the user clicks **Upload**, the code at the top of the page gets the file and saves it.</span></span> <span data-ttu-id="9f3d5-249">`Request` Объекта, который обычно используется для получения значений из полей формы также имеет `Files` массив, содержащий файл (или файлы), были переданы.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-249">The `Request` object that you normally use to get values from form fields also has a `Files` array that contains the file (or files) that have been uploaded.</span></span> <span data-ttu-id="9f3d5-250">Вы можете получить отдельные файлы из определенной позиции в массиве &#8212; к примеру, чтобы получить первый загруженный файл, вы получаете `Request.Files[0]`, чтобы получить второй файл, вы получаете `Request.Files[1]`, и т. д.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-250">You can get individual files out of specific positions in the array &#8212; for example, to get the first uploaded file, you get `Request.Files[0]`, to get the second file, you get `Request.Files[1]`, and so on.</span></span> <span data-ttu-id="9f3d5-251">(Помните, что в программировании инвентаризации обычно начинается с нуля).</span><span class="sxs-lookup"><span data-stu-id="9f3d5-251">(Remember that in programming, counting usually starts at zero.)</span></span>

    <span data-ttu-id="9f3d5-252">При извлечении отправленного файла, можно поместить его в переменной (здесь `uploadedFile`), что можно манипулировать ими.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-252">When you fetch an uploaded file, you put it in a variable (here, `uploadedFile`) so that you can manipulate it.</span></span> <span data-ttu-id="9f3d5-253">Чтобы определить имя отправленного файла, просто получить его `FileName` свойство.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-253">To determine the name of the uploaded file, you just get its `FileName` property.</span></span> <span data-ttu-id="9f3d5-254">Тем не менее, в том случае, когда пользователь отправляет файл, `FileName` содержит исходное имя пользователя, который содержит весь путь.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-254">However, when the user uploads a file, `FileName` contains the user's original name, which includes the entire path.</span></span> <span data-ttu-id="9f3d5-255">Он может выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="9f3d5-255">It might look like this:</span></span>

    *<span data-ttu-id="9f3d5-256">C:\Users\Public\Sample.txt</span><span class="sxs-lookup"><span data-stu-id="9f3d5-256">C:\Users\Public\Sample.txt</span></span>*

    <span data-ttu-id="9f3d5-257">Вы не хотите пути данных, однако, потому что это путь на компьютере пользователя, а не для сервера.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-257">You don't want all that path information, though, because that's the path on the user's computer, not for your server.</span></span> <span data-ttu-id="9f3d5-258">Необходимо просто фактическим именем файла (*Sample.txt*).</span><span class="sxs-lookup"><span data-stu-id="9f3d5-258">You just want the actual file name (*Sample.txt*).</span></span> <span data-ttu-id="9f3d5-259">Только файл из пути можно убрать с помощью `Path.GetFileName` метод следующим образом:</span><span class="sxs-lookup"><span data-stu-id="9f3d5-259">You can strip out just the file from a path by using the `Path.GetFileName` method, like this:</span></span>

    [!code-csharp[Main](working-with-files/samples/sample8.cs)]

    <span data-ttu-id="9f3d5-260">`Path` Объект — это программа, имеет ряд методов следующим образом, можно использовать для удаления путей, объединение контуров и т. д.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-260">The `Path` object is a utility that has a number of methods like this that you can use to strip paths, combine paths, and so on.</span></span>

    <span data-ttu-id="9f3d5-261">Когда вы азы имя отправленного файла, вы можете создать новый путь, для которых требуется сохранить загруженный файл в веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-261">Once you've gotten the name of the uploaded file, you can build a new path for where you want to store the uploaded file in your website.</span></span> <span data-ttu-id="9f3d5-262">В этом случае вы объединить `Server.MapPath`, имена папок (*приложения\_данных/UploadedFiles*) и имя только что удаленный файл, чтобы создать новый путь.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-262">In this case, you combine `Server.MapPath`, the folder names (*App\_Data/UploadedFiles*), and the newly stripped file name to create a new path.</span></span> <span data-ttu-id="9f3d5-263">Затем можно вызвать отправленный файл `SaveAs` метод фактически сохранить файл.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-263">You can then call the uploaded file's `SaveAs` method to actually save the file.</span></span>
5. <span data-ttu-id="9f3d5-264">Откройте страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-264">Run the page in a browser.</span></span> 

    ![[изображение]](working-with-files/_static/image7.jpg)
6. <span data-ttu-id="9f3d5-266">Нажмите кнопку **Обзор** и выберите файл для передачи.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-266">Click **Browse** and then select a file to upload.</span></span> 

    ![[изображение]](working-with-files/_static/image8.jpg)

    <span data-ttu-id="9f3d5-268">Текстовое поле рядом с полем **Обзор** кнопка будет содержать путь к файлу и расположение.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-268">The text box next to the **Browse** button will contain the path and file location.</span></span>

    ![[изображение]](working-with-files/_static/image9.jpg)
7. <span data-ttu-id="9f3d5-270">Нажмите кнопку **Выгрузка**.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-270">Click **Upload**.</span></span>
8. <span data-ttu-id="9f3d5-271">В веб-сайт, щелкните правой кнопкой мыши папку проекта и нажмите кнопку **обновить**.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-271">In the website, right-click the project folder and then click **Refresh**.</span></span>
9. <span data-ttu-id="9f3d5-272">Откройте *UploadedFiles* папки.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-272">Open the *UploadedFiles* folder.</span></span> <span data-ttu-id="9f3d5-273">Загруженный файл находится в папке.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-273">The file that you uploaded is in the folder.</span></span> 

    ![[изображение]](working-with-files/_static/image10.jpg)

<a id="Letting_Users_Upload_Multiple_Files"></a>
## <a name="letting-users-upload-multiple-files"></a><span data-ttu-id="9f3d5-275">Позволяя пользователям отправить несколько файлов</span><span class="sxs-lookup"><span data-stu-id="9f3d5-275">Letting Users Upload Multiple Files</span></span>

<span data-ttu-id="9f3d5-276">В предыдущем примере пользователи передать один файл.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-276">In the previous example, you let users upload one file.</span></span> <span data-ttu-id="9f3d5-277">Но вы можете использовать `FileUpload` вспомогательный метод для отправки нескольких файлов одновременно.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-277">But you can use the `FileUpload` helper to upload more than one file at a time.</span></span> <span data-ttu-id="9f3d5-278">Это удобно для таких сценариев, как передача фотографий, где загружать по одному файлу за раз становится утомительным.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-278">This is handy for scenarios like uploading photos, where uploading one file at a time is tedious.</span></span> <span data-ttu-id="9f3d5-279">(Сведения о передача фотографий в [работа с изображениями на сайте веб-страниц ASP.NET](https://go.microsoft.com/fwlink/?LinkId=202897).) В этом примере показано, как разрешить пользователям отправлять два за один раз несмотря на то, что для передачи более того, можно использовать тот же метод.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-279">(You can read about uploading photos in [Working with Images in an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=202897).) This example shows how to let users upload two at a time, although you can use the same technique to upload more than that.</span></span>

1. <span data-ttu-id="9f3d5-280">Добавьте библиотеку ASP.NET на веб-сайт, как описано в [Установка вспомогательных функций на сайте веб-страниц ASP.NET](https://go.microsoft.com/fwlink/?LinkId=252372), если у вас еще нет.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-280">Add the ASP.NET Web Helpers Library to your website as described in [Installing Helpers in an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=252372), if you haven't already.</span></span>
2. <span data-ttu-id="9f3d5-281">Создать новую страницу с именем *FileUploadMultiple.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-281">Create a new page named *FileUploadMultiple.cshtml*.</span></span>
3. <span data-ttu-id="9f3d5-282">Замените существующее содержимое на странице следующее:</span><span class="sxs-lookup"><span data-stu-id="9f3d5-282">Replace the existing content in the page with the following:</span></span>  

    [!code-cshtml[Main](working-with-files/samples/sample9.cshtml)]

    <span data-ttu-id="9f3d5-283">В этом примере `FileUpload` пользователям загрузить два файла по умолчанию настроен вспомогательная функция в основной области страницы.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-283">In this example, the `FileUpload` helper in the body of the page is configured to let users upload two files by default.</span></span> <span data-ttu-id="9f3d5-284">Так как `allowMoreFilesToBeAdded` присваивается `true`, вспомогательное приложение отображает ссылку, которая позволяет пользователю добавлять дополнительные поля, передачи:</span><span class="sxs-lookup"><span data-stu-id="9f3d5-284">Because `allowMoreFilesToBeAdded` is set to `true`, the helper renders a link that lets user add more upload boxes:</span></span>

    ![[изображение]](working-with-files/_static/image11.jpg)

    <span data-ttu-id="9f3d5-286">Для обработки файлов, которые пользователь отправляет на сервер, в коде используется единая базовая методика, которая использовалась в предыдущем примере &#8212; получения файла из `Request.Files` и сохраните его.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-286">To process the files that the user uploads, the code uses the same basic technique that you used in the previous example &#8212; get a file from `Request.Files` and then save it.</span></span> <span data-ttu-id="9f3d5-287">(Включая различные моменты необходимо сделать, чтобы получить правильное имя файла и путь.) Инновации сейчас том, что пользователь может быть передачу нескольких файлов и вы не знаете многие.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-287">(Including the various things you need to do to get the right file name and path.) The innovation this time is that the user might be uploading multiple files and you don't know many.</span></span> <span data-ttu-id="9f3d5-288">Чтобы узнать, можно получить `Request.Files.Count`.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-288">To find out, you can get `Request.Files.Count`.</span></span>

    <span data-ttu-id="9f3d5-289">С этим номером в руке можно перебирать `Request.Files`, в свою очередь выборки каждый файл и сохраните его.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-289">With this number in hand, you can loop through `Request.Files`, fetch each file in turn, and save it.</span></span> <span data-ttu-id="9f3d5-290">Если необходимо применить цикл известных несколько раз в коллекции, можно использовать `for` цикл, следующим образом:</span><span class="sxs-lookup"><span data-stu-id="9f3d5-290">When you want to loop a known number of times through a collection, you can use a `for` loop, like this:</span></span>

    [!code-csharp[Main](working-with-files/samples/sample10.cs)]

    <span data-ttu-id="9f3d5-291">Переменная `i` просто переходит от нуля до любой верхний предел, можно задать временной счетчик.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-291">The variable `i` is just a temporary counter that will go from zero to whatever upper limit you set.</span></span> <span data-ttu-id="9f3d5-292">В этом случае верхний предел — количество файлов.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-292">In this case, the upper limit is the number of files.</span></span> <span data-ttu-id="9f3d5-293">Но поскольку счетчика начинается с нуля, что является типичным для подсчета сценариев в ASP.NET, верхний предел фактически один меньше, чем количество файлов.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-293">But because the counter starts at zero, as is typical for counting scenarios in ASP.NET, the upper limit is actually one less than the file count.</span></span> <span data-ttu-id="9f3d5-294">(Если передаются три файла, число составляет от 0 до 2).</span><span class="sxs-lookup"><span data-stu-id="9f3d5-294">(If three files are uploaded, the count is zero to 2.)</span></span>

    <span data-ttu-id="9f3d5-295">`uploadedCount` Переменной суммирует все файлы, которые были успешно загружены и сохранены.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-295">The `uploadedCount` variable totals all the files that are successfully uploaded and saved.</span></span> <span data-ttu-id="9f3d5-296">Этот код учетных записей для вероятность того, что файл ожидаемый не сможете отправить.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-296">This code accounts for the possibility that an expected file may not be able to be uploaded.</span></span>
4. <span data-ttu-id="9f3d5-297">Откройте страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-297">Run the page in a browser.</span></span> <span data-ttu-id="9f3d5-298">В браузере отобразится страница и его отправки два поля.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-298">The browser displays the page and its two upload boxes.</span></span>
5. <span data-ttu-id="9f3d5-299">Выберите два файла для отправки.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-299">Select two files to upload.</span></span>
6. <span data-ttu-id="9f3d5-300">Нажмите кнопку **добавьте еще один файл**.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-300">Click **Add another file**.</span></span> <span data-ttu-id="9f3d5-301">На странице отображается новое окно отправки.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-301">The page displays a new upload box.</span></span> 

    ![[изображение]](working-with-files/_static/image12.jpg)
7. <span data-ttu-id="9f3d5-303">Нажмите кнопку **Выгрузка**.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-303">Click **Upload**.</span></span>
8. <span data-ttu-id="9f3d5-304">В веб-сайт, щелкните правой кнопкой мыши папку проекта и нажмите кнопку **обновить**.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-304">In the website, right-click the project folder and then click **Refresh**.</span></span>
9. <span data-ttu-id="9f3d5-305">Откройте *UploadedFiles* папку для просмотра файлов успешно отправлен.</span><span class="sxs-lookup"><span data-stu-id="9f3d5-305">Open the *UploadedFiles* folder to see the successfully uploaded files.</span></span>

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a><span data-ttu-id="9f3d5-306">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="9f3d5-306">Additional Resources</span></span>


[<span data-ttu-id="9f3d5-307">Работа с изображениями на сайте страниц ASP.NET Web</span><span class="sxs-lookup"><span data-stu-id="9f3d5-307">Working with Images in an ASP.NET Web Pages Site</span></span>](https://go.microsoft.com/fwlink/?LinkId=202897)

[<span data-ttu-id="9f3d5-308">Экспорт в CSV-файл</span><span class="sxs-lookup"><span data-stu-id="9f3d5-308">Exporting to a CSV File</span></span>](https://msdn.microsoft.com/library/ms155919.aspx)
