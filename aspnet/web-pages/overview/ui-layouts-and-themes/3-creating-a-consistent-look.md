---
uid: web-pages/overview/ui-layouts-and-themes/3-creating-a-consistent-look
title: Создание единообразного макета на сайтах веб-страницы ASP.NET (Razor) | Документация Майкрософт
author: Rick-Anderson
description: Чтобы повысить эффективность создания веб-страниц для сайта, можно создавать многократно используемые блоки содержимого (например, верхние и нижние колонтитулы) для веб-сайта, а также с...
ms.author: riande
ms.date: 03/10/2014
ms.assetid: d7bd001b-6db2-4422-9b78-f3d08b743b00
msc.legacyurl: /web-pages/overview/ui-layouts-and-themes/3-creating-a-consistent-look
msc.type: authoredcontent
ms.openlocfilehash: 3f63ce68ae4c13970ac0df196167ace0b22b592c
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78509100"
---
# <a name="creating-a-consistent-layout-in-aspnet-web-pages-razor-sites"></a>Создание единообразного макета на сайтах веб-страницы ASP.NET (Razor)

от [Tom фитзмаккен](https://github.com/tfitzmac)

> В этой статье объясняется, как использовать страницы макета на веб-сайте веб-страницы ASP.NET (Razor) для создания многократно используемых блоков содержимого (таких как верхние и нижние колонтитулы) и для создания единообразного вида для всех страниц сайта.
> 
> **Что вы узнаете:** 
> 
> - Создание многократно используемых блоков содержимого, таких как верхние и нижние колонтитулы.
> - Как создать единообразный вид для всех страниц сайта с помощью макета.
> - Передача данных во время выполнения на страницу макета.
> 
> Это функции ASP.NET, представленные в статье:
> 
> - Блоки содержимого, которые представляют собой файлы, содержащие содержимое в формате HTML, вставляемое на несколько страниц.
> - Страницы макета — страницы, которые содержат содержимое в формате HTML, которое может совместно использоваться страницами на веб-сайте.
> - Методы `RenderPage`, `RenderBody`и `RenderSection`, которые указывают ASP.NET, куда вставляются элементы страницы.
> - Словарь `PageData`, который позволяет обмениваться данными между блоками содержимого и страницами макета.
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a>Версии программного обеспечения, используемые в этом руководстве
> 
> 
> - Веб-страницы ASP.NET (Razor) 3
>   
> 
> Этот учебник также работает с веб-страницы ASP.NET 2.

## <a name="about-layout-pages"></a>О страницах макета

Многие веб-сайты имеют содержимое, отображаемое на каждой странице, например верхний и нижний колонтитулы, или поле, которое сообщает пользователям о том, что они вошли в систему. ASP.NET позволяет создать отдельный файл с блоком содержимого, который может содержать текст, разметку и код, как и обычную веб-страницу. Затем можно вставить блок содержимого на другие страницы сайта, где должны отображаться сведения. Таким образом, не нужно копировать и вставлять одно и то же содержимое на каждую страницу. Создание общего содержимого, подобного, также упрощает обновление сайта. Если необходимо изменить содержимое, можно просто обновить один файл, после чего изменения будут отражены везде, где было вставлено содержимое.

На следующей схеме показано, как работают блоки содержимого. Когда браузер запрашивает страницу с веб-сервера, ASP.NET вставляет блоки содержимого в точку, где вызывается метод `RenderPage` на главной странице. Затем готовая (Объединенная) страница отправляется в браузер.

![Концептуальная схема, показывающая, как метод RenderPage вставляет страницу, на которую указывает ссылка, в текущую страницу.](3-creating-a-consistent-look/_static/image1.jpg)

В этой процедуре вы создадите страницу, которая ссылается на два блока содержимого (верхний и нижний колонтитулы), которые находятся в отдельных файлах. Эти блоки содержимого можно использовать на любой странице сайта. Когда все будет готово, вы получите страницу следующего вида:

![Снимок экрана, показывающий страницу в браузере, которая является результатом выполнения страницы, которая содержит вызовы метода RenderPage.](3-creating-a-consistent-look/_static/image2.png)

1. В корневой папке веб-сайта создайте файл с именем *index. cshtml*.
2. Замените существующую разметку следующим:

    [!code-html[Main](3-creating-a-consistent-look/samples/sample1.html)]
3. В корневой папке создайте папку с именем *Shared*.

    > [!NOTE]
    > Распространенной практикой является хранение файлов, совместно используемых веб-страницами, в папке с именем *Shared*.
4. В *общей* папке создайте файл с именем *\_Header. cshtml*.
5. Замените имеющееся содержимое следующим:

    [!code-html[Main](3-creating-a-consistent-look/samples/sample2.html)]

    Обратите внимание, что имя файла *\_Header. cshtml*с символом подчеркивания (\_) в качестве префикса. ASP.NET не отправляет страницу в браузер, если ее имя начинается с символа подчеркивания. Это не даст пользователям напрямую запрашивать (случайно или иным образом) эти страницы. Рекомендуется использовать символ подчеркивания для наименования страниц, на которых находятся блоки содержимого, так как вы не хотите, чтобы пользователи могли запрашивать эти страницы &#8212; , они строго вставляются на другие страницы.
6. В *общей* папке создайте файл с именем *\_Footer. cshtml* и замените содержимое следующим:

    [!code-html[Main](3-creating-a-consistent-look/samples/sample3.html)]
7. На странице *index. cshtml* добавьте два вызова метода `RenderPage`, как показано ниже:

    [!code-html[Main](3-creating-a-consistent-look/samples/sample4.html)]

    В этом примере показано, как вставить блок содержимого на веб-страницу. Вызовите метод `RenderPage` и передайте ему имя файла, содержимое которого необходимо вставить в этот момент. Здесь вы вставляете содержимое файлов *\_Headers. cshtml* и *\_Footer. cshtml* в файл *index. cshtml* .
8. Запустите страницу *index. cshtml* в браузере. (В WebMatrix в рабочей области **файлы** щелкните правой кнопкой мыши файл и выберите **запустить в браузере**.)
9. В браузере просмотрите источник страницы. (Например, в Internet Explorer щелкните страницу правой кнопкой мыши и выберите пункт **Просмотр источника**.)

    Это позволяет увидеть разметку веб-страницы, отправляемую в браузер, которая сочетает разметку страницы индекса с блоками содержимого. В следующем примере показан источник страницы, отображаемый для *index. cshtml*. Вызовы `RenderPage`, вставленные в *index. cshtml* , были заменены фактическим содержимым файлов верхнего и нижнего колонтитулов.

    [!code-html[Main](3-creating-a-consistent-look/samples/sample5.html)]

## <a name="creating-a-consistent-look-using-layout-pages"></a>Создание единообразного вида с помощью страниц макета

До сих пор вы видели, что на нескольких страницах можно легко включить одно и то же содержимое. Более структурированный подход к созданию единообразного вида для сайта заключается в использовании страниц макета. Страница макета определяет структуру веб-страницы, но не содержит никакого фактического содержимого. После создания страницы макета можно создать веб-страницы, содержащие содержимое, а затем связать их со страницей макета. При отображении эти страницы будут отформатированы в соответствии со страницей макета. (В этом смысле страница макета выступает в качестве вида шаблона для содержимого, определенного на других страницах.)

Макет страницы выглядит так же, как и любая HTML-страница, за исключением того, что она содержит вызов метода `RenderBody`. Положение метода `RenderBody` на странице макета определяет, куда будут включаться сведения со страницы содержимого.

На следующей схеме показано, как страницы содержимого и страницы макета объединяются во время выполнения для создания готовой веб-страницы. Браузер запрашивает страницу содержимого. Страница содержимого содержит в ней код, указывающий страницу макета, используемую для структуры страницы. На странице макета содержимое вставляется в точку, где вызывается метод `RenderBody`. Блоки содержимого также можно вставить на страницу макета, вызвав метод `RenderPage`, как в предыдущем разделе. После завершения веб-страницы она отправляется в браузер.

![Снимок экрана, показывающий страницу в браузере, которая является результатом выполнения страницы, которая содержит вызовы метода RenderBody.](3-creating-a-consistent-look/_static/image3.jpg)

В следующей процедуре показано, как создать страницу макета и связать с ней страницы содержимого.

1. В *общей* папке веб-сайта создайте файл с именем *\_layout1. cshtml*.
2. Замените имеющееся содержимое следующим:

    [!code-html[Main](3-creating-a-consistent-look/samples/sample6.html)]

    Для вставки блоков содержимого используется метод `RenderPage` на странице макета. Страница макета может содержать только один вызов метода `RenderBody`.
3. В *общей* папке создайте файл с именем *\_Header2. cshtml* и замените имеющееся содержимое следующим:

    [!code-html[Main](3-creating-a-consistent-look/samples/sample7.html)]
4. В корневой папке создайте новую папку и назовите ее *стили*.
5. В папке *styles* создайте файл с именем *site. CSS* и добавьте следующие определения стилей:

    [!code-css[Main](3-creating-a-consistent-look/samples/sample8.css)]

    Эти определения стилей здесь предназначены только для того, чтобы продемонстрировать, как таблицы стилей можно использовать со страницами макета. При необходимости можно определить собственные стили для этих элементов.
6. В корневой папке создайте файл с именем *Content1. cshtml* и замените имеющееся содержимое следующим:

    [!code-cshtml[Main](3-creating-a-consistent-look/samples/sample9.cshtml)]

    Это страница, на которой будет использоваться макет страницы. Блок кода в верхней части страницы указывает, какую страницу макета использовать для форматирования этого содержимого.
7. Запустите *Content1. cshtml* в браузере. На подготовленной странице используется формат и таблица стилей, определенные в *\_layout1. cshtml* , и текст (содержимое), определенный в *Content1. cshtml*.

    ![[образ]](3-creating-a-consistent-look/_static/image4.png)

    Можно повторить шаг 6, чтобы создать дополнительные страницы содержимого, которые затем могут использовать одну и ту же страницу макета.

    > [!NOTE]
    > Вы можете настроить сайт, чтобы можно было автоматически использовать одну и ту же страницу макета для всех страниц содержимого в папке. Дополнительные сведения см. в разделе [Настройка поведения на уровне сайта для веб-страницы ASP.NET](https://go.microsoft.com/fwlink/?LinkId=202906).

## <a name="designing-layout-pages-that-have-multiple-content-sections"></a>Разработка страниц макета с несколькими разделами содержимого

Страница содержимого может иметь несколько разделов, что полезно, если вы хотите использовать макеты с несколькими областями с заменяемым содержимым. На странице содержимое каждому разделу присваивается уникальное имя. (Раздел по умолчанию остается неименованным.) На странице макета добавьте метод `RenderBody`, чтобы указать, где должен отображаться раздел Безымянный (по умолчанию). Затем добавьте отдельные методы `RenderSection` для отображения именованных разделов по отдельности.

На следующей схеме показано, как ASP.NET обрабатывает содержимое, разделенное на несколько разделов. Каждый именованный раздел содержится в блоке раздела на странице содержимого. (Они называются `Header` и `List` в примере). Платформа вставляет раздел содержимого на страницу макета в точке, где вызывается метод `RenderSection`. Раздел Безымянный (по умолчанию) вставляется в точку, где вызывается метод `RenderBody`, как было показано ранее.

![Концептуальная схема, показывающая, как метод RenderSection вставляет ссылки на разделы в текущую страницу.](3-creating-a-consistent-look/_static/image5.jpg)

В этой процедуре показано, как создать страницу содержимого с несколькими разделами содержимого и как визуализировать ее с помощью страницы макета, поддерживающей несколько разделов содержимого.

1. В *общей* папке создайте файл с именем *\_Layout2. cshtml*.
2. Замените имеющееся содержимое следующим:

    [!code-html[Main](3-creating-a-consistent-look/samples/sample10.html)]

    Для отображения разделов Header и List используется метод `RenderSection`.
3. В корневой папке создайте файл с именем *Content2. cshtml* и замените имеющееся содержимое следующим:

    [!code-cshtml[Main](3-creating-a-consistent-look/samples/sample11.cshtml)]

    Эта страница содержимого содержит блок кода в верхней части страницы. Каждый именованный раздел содержится в блоке раздела. Оставшаяся часть страницы содержит раздел содержимого по умолчанию (безымянный).
4. Запустите *Content2. cshtml* в браузере.

    ![Снимок экрана, показывающий страницу в браузере, которая является результатом выполнения страницы, которая содержит вызовы метода RenderSection.](3-creating-a-consistent-look/_static/image6.png)

## <a name="making-content-sections-optional"></a>Создание разделов содержимого необязательно

Как правило, разделы, создаваемые на странице содержимого, должны соответствовать разделам, определенным на странице макета. Ошибки могут возникнуть в следующих случаях.

- Страница содержимое содержит раздел, не имеющий соответствующего раздела на странице макета.
- Страница макета содержит раздел, для которого нет содержимого.
- Страница макета включает вызовы методов, которые пытаются визуализировать одну и ту же секцию более одного раза.

Однако это поведение можно переопределить для именованного раздела, объявив раздел как необязательный на странице макета. Это позволяет определить несколько страниц содержимого, которые могут совместно использовать страницу макета, но могут или не иметь содержимого для определенного раздела.

1. Откройте *Content2. cshtml* и удалите следующий раздел:

    [!code-cshtml[Main](3-creating-a-consistent-look/samples/sample12.cshtml)]
2. Сохраните страницу и запустите ее в браузере. Отображается сообщение об ошибке, так как страница содержимого не предоставляет содержимое для раздела, определенного на странице макета, а именно в разделе заголовка.

    ![Снимок экрана, показывающий ошибку, которая возникает при запуске страницы, вызывающей метод RenderSection, но соответствующий раздел не предоставляется.](3-creating-a-consistent-look/_static/image7.png)
3. В *общей* папке откройте страницу *\_Layout2. cshtml* и замените эту строку:

    [!code-javascript[Main](3-creating-a-consistent-look/samples/sample13.js)]

    на новый код:

    [!code-javascript[Main](3-creating-a-consistent-look/samples/sample14.js)]

    В качестве альтернативы можно заменить предыдущую строку кода следующим блоком кода, что дает те же результаты:

    [!code-cshtml[Main](3-creating-a-consistent-look/samples/sample15.cshtml)]
4. Снова запустите страницу *Content2. cshtml* в браузере. (Если эта страница по-прежнему открыта в браузере, можно просто обновить ее.) На этот раз страница отображается без ошибок, несмотря на то, что в ней нет заголовка.

## <a name="passing-data-to-layout-pages"></a>Передача данных на страницы макета

У вас могут быть данные, определенные на странице содержимого, на которых необходимо ссылаться на странице макета. В этом случае необходимо передать данные со страницы содержимое на страницу макета. Например, может потребоваться отобразить состояние входа пользователя или показать или скрыть области содержимого на основе введенных пользователем данных.

Чтобы передать данные со страницы содержимого на страницу макета, можно вставить значения в свойство `PageData` страницы содержимое. Свойство `PageData` — это коллекция пар "имя-значение", содержащих данные, которые необходимо передать между страницами. На странице макета можно считывать значения из свойства `PageData`.

Вот другая схема. В этом примере показано, как ASP.NET может использовать свойство `PageData` для передачи значений со страницы содержимого на страницу макета. Когда ASP.NET начинает создавать веб-страницу, она создает коллекцию `PageData`. На странице содержимого вы пишете код для размещения данных в коллекции `PageData`. К значениям в коллекции `PageData` также могут обращаться другие разделы на странице содержимого или дополнительные блоки содержимого.

![Концептуальная схема, показывающая, как страница содержимого может заполнить словарь Пажедата и передать эту информацию на страницу макета.](3-creating-a-consistent-look/_static/image8.jpg)

В следующей процедуре показано, как передавать данные со страницы содержимого на страницу макета. При запуске страницы отображается кнопка, позволяющая пользователю скрывать или отображать список, определенный на странице макета. Когда пользователь нажимайте кнопку, он устанавливает значение true/false (логическое) в свойстве `PageData`. Страница макета считывает это значение и, если оно имеет значение false, скрывает список. Значение также используется на странице содержимое, чтобы определить, следует ли отображать кнопку **Скрыть список** или **Показать список** .

![[образ]](3-creating-a-consistent-look/_static/image9.jpg)

1. В корневой папке создайте файл с именем *Content3. cshtml* и замените имеющееся содержимое следующим:

    [!code-cshtml[Main](3-creating-a-consistent-look/samples/sample16.cshtml)]

    В коде хранятся два фрагмента данных в свойстве &#8212; `PageData` заголовок веб-страницы, значение true или false, чтобы указать, следует ли отображать список.

    Обратите внимание, что ASP.NET позволяет поочередно размещать HTML-разметку на странице с помощью блока кода. Например, блок `if/else` в тексте страницы определяет, какая форма должна отображаться в зависимости от того, имеет ли `PageData["ShowList"]` значение true.
2. В *общей* папке создайте файл с именем *\_Layout3. cshtml* и замените имеющееся содержимое следующим:

    [!code-cshtml[Main](3-creating-a-consistent-look/samples/sample17.cshtml)]

    Страница макета содержит выражение в элементе `<title>`, который получает значение заголовка из свойства `PageData`. Он также использует значение `ShowList` свойства `PageData`, чтобы определить, следует ли отображать блок содержимого списка.
3. В *общей* папке создайте файл с именем *\_List. cshtml* и замените имеющееся содержимое следующим:

    [!code-html[Main](3-creating-a-consistent-look/samples/sample18.html)]
4. Запустите страницу *Content3. cshtml* в браузере. Отобразится страница со списком, видимым в левой части страницы, и кнопку **Скрыть список** внизу.

    ![Снимок экрана, показывающий страницу, содержащую список, и кнопку с текстом "скрыть список".](3-creating-a-consistent-look/_static/image10.png)
5. Щелкните **Скрыть список**. Список исчезнет, а кнопка изменится на **отобразить список**.

    ![Снимок экрана, на котором показана страница, не содержащая список, и кнопка с текстом "Показать список".](3-creating-a-consistent-look/_static/image11.png)
6. Нажмите кнопку **Показать список** и снова отобразится список.

## <a name="additional-resources"></a>Дополнительные ресурсы

[Настройка поведения на уровне сайта для веб-страницы ASP.NET](https://go.microsoft.com/fwlink/?LinkId=202906)
