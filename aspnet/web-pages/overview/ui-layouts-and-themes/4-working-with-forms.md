---
uid: web-pages/overview/ui-layouts-and-themes/4-working-with-forms
title: Работа с HTML-форм в веб-узлы ASP.NET Web Pages (Razor) | Документация Майкрософт
author: Rick-Anderson
description: Форма является раздел документа HTML размещения элементов управления вводом пользователя, такие как текстовые поля, флажки, переключатели и раскрывающихся списков. Использовать формы ч...
ms.author: riande
ms.date: 02/10/2014
ms.assetid: f3f4b8c8-e8f6-4474-ad94-69228a6c01ee
msc.legacyurl: /web-pages/overview/ui-layouts-and-themes/4-working-with-forms
msc.type: authoredcontent
ms.openlocfilehash: 680739cbcf54bc9ca7a3bd8167d043ff537eaad5
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59417537"
---
# <a name="working-with-html-forms-in-aspnet-web-pages-razor-sites"></a>Работа с HTML-формы на сайтах ASP.NET Web Pages (Razor)

по [Tom FitzMacken](https://github.com/tfitzmac)

> В этой статье описан процесс обработки HTML-форму (с помощью текстовых полей и кнопки) при работе в на веб-сайте ASP.NET Web Pages (Razor).
> 
> **Вы узнаете, как:** 
> 
> - Как создать HTML-форму.
> - Как выполнить чтение ввод данных пользователем из формы.
> - Способы проверки пользовательского ввода.
> - Как восстановить значения формы после отправки страницы.
> 
> Ниже приведены основные понятия, представленные в этой статье программирования ASP.NET.
> 
> - Объект `Request`.
> - Проверки входных данных.
> - Кодировка HTML.
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a>Версии программного обеспечения, используемые в этом руководстве
> 
> 
> - Веб-страниц ASP.NET (Razor) 3
>   
> 
> Этот учебник также работает с ASP.NET Web Pages 2.


## <a name="creating-a-simple-html-form"></a>Создание простой формы HTML

1. Создание нового веб-сайта.
2. В корневой папке создайте веб-страницы с именем *Form.cshtml* и введите следующую разметку:

    [!code-html[Main](4-working-with-forms/samples/sample1.html)]
3. Запустите страницу в браузере. (В WebMatrix в **файлы** рабочей области, щелкните правой кнопкой мыши файл, а затем выберите **запустить в браузере**.) Простая форма с тремя полями ввода и **отправить** отображается кнопка ".

    ![Снимок экрана: форма с тремя текстовыми полями.](4-working-with-forms/_static/image1.jpg)

    На этом этапе, если щелкнуть **отправить** кнопки ничего не происходит. Чтобы сделать форму полезным, необходимо добавить код, который будет выполняться на сервере.

## <a name="reading-user-input-from-the-form"></a>Чтение входных данных пользователя из формы

Для обработки формы, добавьте код, который считывает значения отправленного полей и производящий над ними. Эта процедура показано, как для чтения поля и на странице отображаются входные данные пользователя. (В реальном приложении обычно производится более интересные действия с входными данными пользователя. Можно сделать в статье о работе с базами данных.)

1. В верхней части *Form.cshtml* файл, введите следующий код:

    [!code-cshtml[Main](4-working-with-forms/samples/sample2.cshtml)]

    Когда пользователь сначала запрашивает страницу, отображается только пустая форма. Пользователь (то есть вы) заполняет форму и затем нажимает **отправить**. Это отправляет (сообщений) входные данные пользователя на сервер. По умолчанию запрос направляется к той же странице (а именно, *Form.cshtml*).

    При отправке страницы это время, введенные значения отображаются над формы:

    ![Снимок экрана, показывающий значения, которые вы ввели отображаются на странице.](4-working-with-forms/_static/image2.jpg)

    Взгляните на код для страницы. Сначала с помощью `IsPost` метод, чтобы определить, является ли страница передается &#8212; то есть, следует ли пользователь активировал **отправить** кнопки. Если это сообщение, `IsPost` возвращает значение true. Это стандартный способ веб-страницах ASP.NET для определения, является ли вы работаете с первоначального запроса (запрос GET) или обратную передачу (запрос POST). (Дополнительные сведения о GET и POST, см. в разделе боковой панели «HTTP GET и POST и IsPost свойство» в [введение в ASP.NET веб-страниц программирование с использованием синтаксиса Razor](https://go.microsoft.com/fwlink/?LinkId=202890#SB_HttpGetPost).)

    Затем получите значения, которые ввел пользователь из `Request.Form` объекта и поместить их в переменных для последующего использования. `Request.Form` Объект содержит все значения, которые были переданы со страницей, каждый из которых идентифицируется по ключу. Ключ является эквивалентом `name` атрибута поля формы, который вы собираетесь считать. Например, чтобы прочитать `companyname` поле (поле), используется `Request.Form["companyname"]`.

    Значения формы хранятся в `Request.Form` объекта в виде строк. Таким образом при наличии для работы со значением, как число или дату или другого типа, необходимо преобразовать его из строки в этот тип. В примере `AsInt` метод `Request.Form` используется для преобразования в целое значение поля сотрудников, (который содержит количества сотрудников).
2. Запустите страницу в браузере, заполните поля формы и нажмите кнопку **отправить**. На странице отображаются введенные значения.

> [!TIP] 
> 
> <a id="SB_HTMLEncoding"></a>
> ### <a name="html-encoding-for-appearance-and-security"></a>HTML-кодирование для внешнего вида и безопасности
> 
> HTML содержит специальные символы, такие как использование `<`, `>`, и `&`. Если имеются эти специальные знаки, в которых они не должны, они могут разрушить внешнего вида и функциональности веб-страницы. Например, браузер интерпретирует `<` символов (если его не следует пробел) как начало элемента HTML, например `<b>` или `<input ...>`. Если браузер не распознает элемент, он просто удаляет строку, начинающуюся с `<` пока не достигнет что-нибудь, он снова распознает. Очевидно, что это может привести в некоторых странные визуализации на странице.
> 
> HTML-кодирования заменяет эти зарезервированные символы с кодом, браузеры интерпретировать как правильному символу. Например `<` символ заменяется `&lt;` и `>` символ заменяется `&gt;`. Эти строки замены отрисовывает браузер как символы, которые вы хотите просмотреть.
> 
> Рекомендуется использовать HTML-кодирование в любое время, отображаемые строки (ввода), полученный от пользователя. Если этого не сделать, пользователь может попытаться получить веб-страницу для запуска вредоносный скрипт или выполнения других действий, представляет угрозу для безопасности веб-узла, или просто не предполагается. (Это особенно важно, если принимать вводимые пользователем данные, сохраните его где-то и отображения его в дальнейшем &#8212; как блог комментарий, проверка пользователя или примерно так, как.)
> 
> Чтобы предотвратить эти проблемы, веб-страниц ASP.NET автоматически кодирует HTML любой текст содержимого, которые выходных данных из кода. Например, при выводе содержимого переменной или выражение, с помощью кода, например `@MyVar`, веб-страниц ASP.NET автоматически кодирует выходные данные.


## <a name="validating-user-input"></a>Проверка вводимых пользователем данных

Пользователи делают ошибки. Попросите его заполнить поле и они забыли, или попросите его введите число сотрудников, и вместо этого введите имя. Чтобы убедиться в том, что формы будет заполнен правильно перед его обработкой, проверьте введенные пользователем данные.

Эта процедура рассматриваются способы проверки всех полей три формы и убедитесь, что пользователь не оставить их пустыми. Вы также проверить, что значение счетчика сотрудников является числом. При возникновении ошибок, как отображать ошибки сообщение о том, какие значения пользователь не прошел проверку.

1. В *Form.cshtml* файл, замените первый блок кода следующим кодом: 

    [!code-cshtml[Main](4-working-with-forms/samples/sample3.cshtml)]

    Для проверки пользовательского ввода, используется `Validation` вспомогательный. Зарегистрируйте обязательные поля с помощью метода `Validation.RequireField`. Зарегистрировать другие виды проверок, вызвав `Validation.Add` с указанием поля для проверки и тип выполняемой проверки.

    При запуске страницы ASP.NET выполняет все проверки, для вас. Результаты можно проверить путем вызова `Validation.IsValid`, который возвращает значение true, если все, что передается и значение false, если любое поле, не прошел проверку. Как правило, вызывается `Validation.IsValid` до выполнения обработки от вводимых пользователем данных.
2. Обновление `<body>` элемент, добавив три вызовы `Html.ValidationMessage` метод следующим образом:

    [!code-cshtml[Main](4-working-with-forms/samples/sample4.cshtml?highlight=8,13,18)]

    Для отображения сообщений об ошибках проверки, можно вызвать Html.`ValidationMessage` и передачи ей имени поля, которое необходимо для сообщение.
3. Откройте страницу. Оставьте эти поля пустыми и нажмите кнопку **отправить**. Появляются сообщения об ошибках.

    ![Снимок экрана, показывающий сообщения об ошибках, если ввод данных пользователем не проходит проверку.](4-working-with-forms/_static/image3.jpg)
4. Добавить строку (например, «ABC»), **сотрудники** поле и нажмите кнопку **отправить** еще раз. Это время, появится сообщение об ошибке, которое указывает, что строка не в нужном формате, а именно целое число.

    ![Снимок экрана, показывающий сообщения об ошибках, если пользователи введите строку для поля сотрудников.](4-working-with-forms/_static/image4.jpg)

Веб-страницы ASP.NET предоставляет дополнительные параметры для проверки введенных пользователем данных, включая возможность автоматически выполнять проверку с помощью клиентского скрипта, так что пользователи получат немедленную обратную связь в браузере. См. в разделе [дополнительные ресурсы](#Additional_Resources) разделе позже для получения дополнительных сведений.

## <a name="restoring-form-values-after-postbacks"></a>Восстановление значения формы после обратной передачи

При тестировании страницы в предыдущем разделе, вы могли заметить, при наличии ошибки проверки, все, что вы ввели (а не только недопустимые данные) был удален, необходимо было повторно введите значения для всех полей. Это иллюстрирует важный момент: при отправке страницы, обработать его и затем снова визуализации страницы, страницы создается заново с нуля. Как видно, это означает, что все значения, которые были на странице, когда оно было отправлено теряются.

Это можно исправить, однако. У вас есть доступ к значениям, которые были переданы (в `Request.Form` объекта, поэтому вы можете заполнить эти значения в поля формы, при отображении страницы.

1. В *Form.cshtml* файл, замените `value` атрибуты `<input>` элементов с помощью `value` атрибут.: 

    [!code-cshtml[Main](4-working-with-forms/samples/sample5.cshtml?highlight=13,19,25)]

    `value` Атрибут `<input>` элементов было присвоено динамически считывать значение поля из `Request.Form` объекта. При первом запросе страницы, значения в `Request.Form` объект пусты. Это нормально, так как таким образом форма является пустым.
2. Запустите страницу в браузере, заполните поля форм или оставить их пустыми и щелкните **отправить**. Откроется страница, показывающая предоставленными значениями.

    ![форм-5](4-working-with-forms/_static/image5.jpg)

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a>Дополнительные ресурсы

- [1001 способы получения входных данных из веб-пользователей](https://msdn.microsoft.com/library/ms971057.aspx)
- [С помощью форм и обработке ввода данных пользователем](https://msdn.microsoft.com/library/ms525182(VS.90).aspx)
- [Проверка пользовательского ввода на сайтах веб-страниц ASP.NET](https://go.microsoft.com/fwlink/?LinkId=253002)
- [С помощью автозаполнения в HTML-формы](https://msdn.microsoft.com/library/ms533032(VS.85).aspx)
