---
uid: web-pages/overview/testing-and-debugging/introduction-to-debugging
title: Общие сведения об отладке на сайтах веб-страницы ASP.NET (Razor) | Документация Майкрософт
author: Rick-Anderson
description: Отладка — это процесс поиска и исправления ошибок в кодовых страницах. В этой главе показаны некоторые средства и методы, которые можно использовать для отладки и анализ...
ms.author: riande
ms.date: 02/20/2014
ms.assetid: 68de4326-7611-4b9b-b5f6-79b7adc3069f
msc.legacyurl: /web-pages/overview/testing-and-debugging/introduction-to-debugging
msc.type: authoredcontent
ms.openlocfilehash: ae7d871e56326610c043dc20fe6e0919e1b4ac89
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78506460"
---
# <a name="introduction-to-debugging-aspnet-web-pages-razor-sites"></a>Общие сведения о веб-сайтах отладки веб-страницы ASP.NET (Razor)

от [Tom фитзмаккен](https://github.com/tfitzmac)

> В этой статье описываются различные способы отладки страниц на веб-сайте веб-страницы ASP.NET (Razor). Отладка — это процесс поиска и исправления ошибок в кодовых страницах.
>
> **Что вы узнаете:**
>
> - Отображение сведений, помогающих анализировать и отлаживать страницы.
> - Использование средств отладки в Visual Studio.
>
>
> Это функции ASP.NET, представленные в статье:
>
> - Вспомогательный метод `ServerInfo`.
> - вспомогательный метод `ObjectInfo`.
>
>
> ## <a name="software-versions"></a>Версии программного обеспечения
>
>
> - Веб-страницы ASP.NET (Razor) 3
> - Visual Studio 2013
>
>
> Этот учебник также работает с веб-страницы ASP.NET 2. Вы можете использовать WebMatrix 3, но интегрированный отладчик не поддерживается.

Важный аспект устранения неполадок и проблем в коде заключается в том, чтобы избежать их в первую очередь. Это можно сделать, разместив разделы кода, которые, скорее всего, будут вызывать ошибки в блоках `try/catch`. Дополнительные сведения см. в разделе об обработке ошибок в статье [Введение в веб-программирование ASP.NET с использованием синтаксиса Razor](https://go.microsoft.com/fwlink/?LinkId=202890).

`ServerInfo` вспомогательное приложение — это диагностическое средство, которое предоставляет общие сведения о среде веб-сервера, в которой размещается страница. Здесь также отображаются сведения о HTTP-запросе, которые отправляются, когда браузер запрашивает страницу. В модуле поддержки `ServerInfo` отображается удостоверение текущего пользователя, тип браузера, который сделал запрос, и т. д. Этот тип информации может помочь в устранении распространенных проблем.

1. Создайте новую веб-страницу с именем *ServerInfo. cshtml*.
2. В конце страницы, непосредственно перед закрывающим тегом `</body>` добавьте `@ServerInfo.GetHtml()`:

    [!code-cshtml[Main](introduction-to-debugging/samples/sample1.cshtml)]

    Код `ServerInfo` можно добавить в любое место страницы. Но если добавить его в конец, выходные данные будут отделены от содержимого другой страницы, что упрощает его чтение.

    > [!NOTE]
    >
    > **Важно!** Перед перемещением веб-страниц на рабочий сервер следует удалить все диагностические коды с веб-страниц. Это относится к вспомогательному модулю `ServerInfo`, а также к другим методам диагностики в этой статье, содержащим Добавление кода на страницу. Вы не хотите, чтобы посетители веб-сайта могли видеть сведения о имени сервера, именах пользователей, путях на сервере и аналогичные сведения, так как эти сведения могут быть полезны людям с вредоносными намерениями.
3. Сохраните страницу и запустите ее в браузере.

    ![Отладка — 1](introduction-to-debugging/_static/image1.jpg)

    Вспомогательный модуль `ServerInfo` отображает четыре таблицы данных на странице:

   - Конфигурация сервера. В этом разделе содержатся сведения о размещенном веб-сервере, включая имя компьютера, используемую версию ASP.NET, доменное имя и время сервера.
   - Переменные сервера ASP.NET. В этом разделе приводятся сведения о множестве сведений о протоколе HTTP (называемых HTTP-переменными) и значениях, которые являются частью каждого запроса веб-страницы.
   - Сведения о времени выполнения HTTP. В этом разделе приводятся сведения о версии платформы Microsoft .NET Framework, в которой выполняется веб-страница, путь, сведения о кэше и т. д. (Как вы узнали в статье [Введение в веб-программирование ASP.NET с использованием синтаксиса Razor](https://go.microsoft.com/fwlink/?LinkId=202890), веб-страницы ASP.NET использовании синтаксис Razor построены на базе технологии веб-сервера Microsoft ASP.NET, которая сама по себе основана на обширной библиотеке разработки программного обеспечения, именуемой .NET Framework.)
   - Переменные среды. В этом разделе приводится список всех локальных переменных среды и их значений на веб-сервере.

     Полное описание всех сведений о сервере и запросах выходит за рамки этой статьи, но можно заметить, что `ServerInfo` вспомогательный объект возвращает множество диагностических сведений. Дополнительные сведения о значениях, возвращаемых `ServerInfo`, см. в разделе [Распознаваемые переменные среды](https://technet.microsoft.com/library/dd560744(WS.10).aspx) на веб-сайте Microsoft TechNet и в [переменных сервера IIS](https://msdn.microsoft.com/library/ms524602(VS.90).aspx) на веб-сайте MSDN.

## <a name="embedding-output-expressions-to-display-page-values"></a>Встраивание выходных выражений для вывода значений страницы

Другой способ увидеть, что происходит в коде, — внедрять выходные выражения на странице. Как известно, можно вывести значение переменной напрямую, добавив что-то вроде `@myVariable` или `@(subTotal * 12)` на страницу. Для отладки эти выходные выражения можно разместить в стратегических точках кода. Это позволяет просматривать значения ключевых переменных или результаты вычислений при выполнении страницы. После завершения отладки можно удалить выражения или закомментировать их. Эта процедура иллюстрирует типичный способ использования внедренных выражений для отладки страницы.

1. Создайте страницу WebMatrix с именем *аутпутекспрессион. cshtml*.
2. Замените содержимое страницы следующим:

    [!code-html[Main](introduction-to-debugging/samples/sample2.html)]

    В примере используется оператор `switch` для проверки значения переменной `weekday`, а затем отображается другое выходное сообщение в зависимости от того, какой день недели он равен. В этом примере блок `if` в первом блоке кода произвольно изменяет день недели, добавляя один день к текущему значению дня недели. Это ошибка, представленная в целях иллюстрации.
3. Сохраните страницу и запустите ее в браузере.

    На странице отображается сообщение для неправильного дня недели. Какой бы день недели на самом деле, вы увидите сообщение в течение одного дня позже. Хотя в этом случае известно, почему сообщение отключено (поскольку код намеренно устанавливает неверное значение дня), в реальности часто трудно понять, где в коде возникают проблемы. Для отладки необходимо выяснить, что происходит со значениями ключевых объектов и переменных, таких как `weekday`.
4. Добавьте выходные выражения, вставив `@weekday`, как показано в двух местах, указанных в комментариях в коде. В этих выходных выражениях будут отображаться значения переменной в этой точке выполнения кода.

    [!code-csharp[Main](introduction-to-debugging/samples/sample3.cs?highlight=2-3,15-16)]
5. Сохраните и запустите страницу в браузере.

    На этой странице сначала отображается реальный день недели, затем — обновленный день недели, в результате которого добавляется один день, а затем полученное сообщение выдается из оператора `switch`. Выходные данные двух переменных выражений (`@weekday`) не имеют пробелов в днях, так как в выходные данные не были добавлены теги HTML `<p>`. выражения предназначены только для тестирования.

    ![Отладка — 2](introduction-to-debugging/_static/image2.jpg)

    Теперь можно увидеть, где находится ошибка. При первом отображении переменной `weekday` в коде отображается правильный день. При повторном отображении во второй раз после блока `if` в коде день отключается на единицу. Итак, вы уверены, что что-то произошло между первым и Вторым видом переменной Weekday. Если бы это была реальная ошибка, такой подход позволит сократить расположение кода, вызвавшего проблему.
6. Исправьте код на странице, удалив два добавленных выходных выражения и удалив код, который изменяет день недели. Оставшийся полный блок кода выглядит следующим образом:

    [!code-cshtml[Main](introduction-to-debugging/samples/sample4.cshtml)]
7. Запустите страницу в браузере. На этот раз отображается правильное сообщение для фактического дня недели.

## <a name="using-the-objectinfo-helper-to-display-object-values"></a>Использование вспомогательного приложения Обжектинфо для вывода значений объекта

Вспомогательный модуль `ObjectInfo` отображает тип и значение каждого переданного ему объекта. Его можно использовать для просмотра значений переменных и объектов в коде (например, с выходными выражениями в предыдущем примере), а также для просмотра сведений о типе данных объекта.

1. Откройте файл с именем *аутпутекспрессион. cshtml* , созданный ранее.
2. Замените весь код на странице следующим блоком кода:

    [!code-html[Main](introduction-to-debugging/samples/sample5.html)]
3. Сохраните и запустите страницу в браузере.

    ![Отладка — 4](introduction-to-debugging/_static/image3.jpg)

    В этом примере в модуле поддержки `ObjectInfo` отображаются два элемента:

   - Тип. Для первой переменной тип — `DayOfWeek`. Для второй переменной тип — `String`.
   - Значение. В этом случае, поскольку значение переменной приветствия уже отображается на странице, значение отображается снова при передаче переменной в `ObjectInfo`.

     Для более сложных объектов `ObjectInfo` вспомогательное приложение может отображать дополнительные сведения &#8212; по сути, оно может отображать типы и значения всех свойств объекта.

## <a name="using-debugging-tools-in-visual-studio"></a>Использование средств отладки в Visual Studio

Для более полного процесса отладки используйте [Visual Studio](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=button+cta&utm_content=download+vs2017). В Visual Studio можно задать точку останова в коде в строке, которую необходимо проверить.

![Задать точку останова](introduction-to-debugging/_static/image1.png)

При тестировании веб-сайта выполнение кода останавливается в точке останова.

![Достижение точки останова](introduction-to-debugging/_static/image2.png)

Вы можете проверить текущие значения переменных и пошагово выполнить код по строке.

![см. раздел значения.](introduction-to-debugging/_static/image3.png)

Сведения об использовании интегрированного отладчика в Visual Studio для отладки страниц Razor ASP.NET см. в разделе [программирование веб-страницы ASP.NET (Razor) с помощью Visual Studio](https://go.microsoft.com/fwlink/?LinkId=205854).

## <a name="additional-resources"></a>Дополнительные ресурсы

- [Программирование веб-страницы ASP.NET (Razor) с помощью Visual Studio](https://go.microsoft.com/fwlink/?LinkId=205854)
- [Переменные сервера IIS](https://msdn.microsoft.com/library/ms524602(VS.90).aspx) (MSDN)
- [Распознаваемые переменные среды](https://technet.microsoft.com/library/dd560744(WS.10).aspx) (TechNet)
