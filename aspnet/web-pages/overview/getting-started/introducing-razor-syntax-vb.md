---
uid: web-pages/overview/getting-started/introducing-razor-syntax-vb
title: Введение в программирование веб-ASP.NET с использованием синтаксиса Razor (Visual Basic) | Документация Майкрософт
author: Rick-Anderson
description: В этом приложении предоставляет общие сведения о программировании с помощью веб-страниц ASP.NET в Visual Basic с использованием синтаксиса Razor.
ms.author: riande
ms.date: 02/07/2014
ms.assetid: 5da59646-e973-41cd-88a9-c6b2c0594027
msc.legacyurl: /web-pages/overview/getting-started/introducing-razor-syntax-vb
msc.type: authoredcontent
ms.openlocfilehash: e6b63afb9492e810e19999c7c7ffe074ad510bda
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59406773"
---
# <a name="introduction-to-aspnet-web-programming-using-the-razor-syntax-visual-basic"></a>Введение в программирование веб-ASP.NET с использованием синтаксиса Razor (Visual Basic)

по [Tom FitzMacken](https://github.com/tfitzmac)

> В этой статье дает Общие сведения о программировании с помощью веб-страниц ASP.NET с использованием синтаксиса Razor и Visual Basic. ASP.NET — технология Майкрософт для выполнения динамических веб-страниц на веб-серверах.
> 
> **Вы узнаете, как**:
> 
> - Top 8, программирование советов по началу работы с программирования веб-страниц ASP.NET с использованием синтаксиса Razor.
> - Основные концепции программирования вам.
> - Какой код сервера ASP.NET и синтаксиса Razor посвящен.
>   
> 
> ## <a name="software-versions"></a>Версии программного обеспечения
> 
> 
> - Веб-страниц ASP.NET (Razor) 3
>   
> 
> Этот учебник также работает с ASP.NET Web Pages 2.


Большинство примеров использования ASP.NET Web Pages с синтаксисом Razor используйте C#. Но синтаксис Razor поддерживает Visual Basic. Для программирования веб-страницу ASP.NET в Visual Basic, создать веб-страницы с *.vbhtml* расширение имени файла, а затем добавьте код Visual Basic. Этой статье приводится обзор работы с языком Visual Basic и синтаксис для создания веб-страниц ASP.NET.

> [!NOTE]
> Шаблоны веб-сайт по умолчанию Microsoft WebMatrix (**кондитерской**, **Photo Gallery**, и **начального сайта**т. д.) доступны в версиях C# и Visual Basic. Шаблоны Visual Basic, можно установить как пакеты NuGet. Шаблоны веб-сайта, устанавливаются в корневой папке веб-сайта в папку с именем *шаблоны Майкрософт*.


## <a name="the-top-8-programming-tips"></a>Top 8 советов по программированию

В этом разделе перечислены несколько советов, которые абсолютно необходимо знать, как приступить к созданию кода сервера ASP.NET с использованием синтаксиса Razor.

### <a name="1-you-add-code-to-a-page-using-the--character"></a>1. Добавьте код для страницы с помощью символа @

`@` Символ запускает встроенные выражения, одной инструкции блоков и блоков с несколькими инструкциями:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample1.vbhtml)]

Результат отображается в браузере:

![Razor Img1](introducing-razor-syntax-vb/_static/image1.jpg)

> [!TIP] 
> 
> **Кодировка HTML**
> 
> При выводе содержимого на страницы с помощью `@` символов, как и в предыдущих примерах ASP.NET HTML кодирует выходные данные. Этот параметр заменяет зарезервированные символы HTML (например, `<` и `>` и `&`) с кодами, которые позволяют символов для отображения в качестве символов на веб-странице, а как HTML-теги или сущности. Без HTML-кодирования, выходные данные из кода сервера могут отображаться неправильно и может предоставить доступ к странице угрозам безопасности.
> 
> Если ваша цель — вывод HTML-разметка, отображает теги как разметка (например `<p></p>` для абзаца или `<em></em>` для выделения текста), см. в разделе [Объединение текста, разметка и код в блоках кода](#BM_CombiningTextMarkupAndCode) далее в этой статье.
> 
> Дополнительные сведения о HTML-кодирования в [работа с HTML-форм в веб-узлы веб-страниц ASP.NET](https://go.microsoft.com/fwlink/?LinkId=202892).


### <a name="2-you-enclose-code-blocks-with-codeend-code"></a>2. Заключите блоки кода с кодом... Полный код

Блок кода включает в себя один или несколько операторов кода, а заключено с ключевыми словами `Code` и `End Code`. Поместите открывающий `Code` ключевое слово сразу же после `@` символ &#8212; не должно быть пробелов между ними.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample2.vbhtml)]

Результат отображается в браузере:

![Razor Img2](introducing-razor-syntax-vb/_static/image2.jpg)

### <a name="3-inside-a-block-you-end-each-code-statement-with-a-line-break"></a>3. Внутри блока завершении каждого оператора с разрывом строки

В блоке кода Visual Basic каждая инструкция завершается разрыв строки. (Далее в этой статье вы увидите способ упаковки оператор много кода на несколько строк, при необходимости.)

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample3.vbhtml)]

### <a name="4-you-use-variables-to-store-values"></a>4. Использовать переменные для хранения значений

Можно хранить значения в *переменной*, включая строки, числа и даты, и т.д. Создание новой переменной с помощью `Dim` ключевое слово. Значения переменных можно вставить непосредственно в страницы с помощью `@`.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample4.vbhtml)]

Результат отображается в браузере:

![Razor Img3](introducing-razor-syntax-vb/_static/image3.jpg)

### <a name="5-you-enclose-literal-string-values-in-double-quotation-marks"></a>5. Вы литеральные значения строк следует заключить в двойные кавычки

Объект *строка* — это последовательность символов, которые обрабатываются как текст. Чтобы указать строку, заключите его в двойные кавычки:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample5.vbhtml)]

Чтобы внедрить двойные кавычки в пределах строковое значение, вставьте два символа двойной кавычки. Двойные кавычки появляться только один раз в выходных данных страницы, введите его как `""` в кавычках в строку и если он отображается дважды, введите его как `""""` в строке в кавычках.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample6.vbhtml)]

Результат отображается в браузере:

![Razor Img4](introducing-razor-syntax-vb/_static/image4.jpg)

### <a name="6-visual-basic-code-is-not-case-sensitive"></a>6. Код Visual Basic регистр не учитывается

Язык Visual Basic не чувствителен к регистру. Программирование ключевые слова (такие как `Dim`, `If`, и `True`) и имена переменных (как `myString`, или `subTotal`) могут быть записаны в любом случае.

Следующие строки кода присвоить значение переменной `lastname` использование строчных букв имени, а затем значение переменной с помощью имени в верхнем регистре.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample7.vbhtml)]

Результат отображается в браузере:

![vb-syntax-5](introducing-razor-syntax-vb/_static/image5.jpg)

### <a name="7-much-of-your-coding-involves-working-with-objects"></a>7. Большая часть программирования включает работу с объектами

Объект представляет нечто, что можно программировать &#8212; страницы текстовое поле, файл, изображения, веб-запроса, сообщение электронной почты, запись о заказчике (строки базы данных), и т.д. Объекты имеют свойства, описывающие их характеристики &#8212; имеет объект с текстовыми полями `Text` , объект запроса имеет `Url` , сообщение электронной почты имеет `From` свойства, а объект customer имеет `FirstName` свойство. Объекты также имеют методы, которые являются &quot;команд&quot; они могут выполнять. Примеры включают объект файла `Save` метод, объект изображения `Rotate` метод и объект по электронной почте `Send` метод.

Вы будете часто иметь дело с `Request` объект, который предоставляет сведения, такие как значения формы поля на странице (текстовые поля, и т.д.), тип браузера, выдавший запрос, URL-адрес страницы, удостоверение пользователя и т. д. В этом примере показано, как доступ к свойствам `Request` объекта и как вызывать `MapPath` метод `Request` объекта, который дает абсолютный путь к странице на сервере:

[!code-html[Main](introducing-razor-syntax-vb/samples/sample8.html)]

Результат отображается в браузере:

![Razor Img5](introducing-razor-syntax-vb/_static/image6.jpg)

### <a name="8-you-can-write-code-that-makes-decisions"></a>8. Можно написать код, который принимает решения

Ключевой особенностью динамических веб-страниц — это, вы можете определять порядок действий в зависимости от условия. Наиболее распространенный способ сделать это — с `If` инструкции (и необязательно `Else` инструкции).

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample9.vbhtml)]

Инструкция `If IsPost` является быстрым способом написания `If IsPost = True`. Вместе с `If` инструкции, существует множество способов для проверки условий, повторите блоки кода, и т. д., которые являются описано далее в этой статье.

Результат отображается в браузере (после нажатия кнопки **отправить**):

![Razor Img6](introducing-razor-syntax-vb/_static/image7.jpg)

> [!TIP] 
> 
> **HTTP GET и POST методы и свойства IsPost**
> 
> Протокол, используемый для веб-страниц (HTTP) поддерживает очень ограниченный набор методов (&quot;команд&quot;), которые используются для выполнения запросов к серверу. Два самых распространенных рисков: GET, который используется для чтения страницы, и POST, который используется для отправки страницы. Как правило первый раз пользователь запрашивает страницу, страница запрашивается с помощью запроса GET. Если пользователь заполняет форму и затем нажимает **отправить**, браузер отправляет запрос POST на сервер.
> 
> В веб-программирования часто бывает полезно знать ли страница запрашивается как GET или POST, чтобы вы знаете, как для обработки страницы. Веб-страницах ASP.NET, можно использовать `IsPost` свойство, чтобы увидеть, является ли запрос GET или POST. Если запрос POST, `IsPost` свойство возвратит значение true, и вы можете выполнять действия, такие как чтение значения текстовых полей в форме. Вы увидите множество примеров продемонстрируем способ обработки страницы по-разному в зависимости от значения `IsPost`.


## <a name="a-simple-code-example"></a>Простой пример кода

Эта процедура показано, как создать страницу, которая иллюстрирует основные приемы программирования. В примере создайте страницу, которая позволяет пользователям вводить двух чисел, а затем он добавляет их и отображает результат.

1. В редакторе создайте файл и назовите его *AddNumbers.vbhtml*.
2. Скопируйте следующий код и разметку в странице, заменив все уже на странице.

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample10.vbhtml)]

    Ниже приведены некоторые аспекты отметить:

    - `@` Символ запускается первым блоком кода в странице, и перед `totalMessage` переменной, внедренных в нижней.
    - В верхней части страницы будет заключен в `Code...End Code`.
    - Переменные `total`, `num1`, `num2`, и `totalMessage` хранить несколько чисел и строка.
    - Строковый литерал значение, присваиваемое `totalMessage` переменная находится в двойные кавычки.
    - Так как код Visual Basic регистр не учитывается, если `totalMessage` переменная используется в нижней части страницы, имени должна соответствовать только правильность написания объявления переменных в верхней части страницы. Регистр не имеет значения.
    - Выражение `num1.AsInt()`  +  `num2.AsInt()` показано, как работать с объектами и методами. `AsInt` Метод для каждой переменной преобразует строку, введенные пользователем в целое число (целое число), которые могут быть добавлены.
    - `<form>` Тег включает `method="post"` атрибута. Указывает, что когда пользователь щелкает **добавить**, страницы будут отправляться на сервер с помощью метода HTTP POST. При отправке страницы, код `If IsPost` принимает значение true и условная кода, результат сложения чисел.
3. Сохраните страницу и запустите его в браузере. (Убедитесь, что выбран страницы **файлы** рабочей области, прежде чем запускать его.) Введите двумя целыми числами и нажмите кнопку **добавить** кнопки.

    ![Razor Img7](introducing-razor-syntax-vb/_static/image8.jpg)

## <a name="visual-basic-language-and-syntax"></a>Язык Visual Basic и синтаксис

Вы уже видели простой пример, как создать веб-страницу ASP.NET, и как можно добавить код сервера для HTML-разметка. Здесь вы узнаете основы работы с Visual Basic для написания кода сервера ASP.NET с использованием синтаксиса Razor &#8212; то есть правила языка программирования.

Если вы являетесь опытным при программировании (особенно если вы использовали, C, C++, C#, Visual Basic или JavaScript), большая часть сведений здесь будут знакомы. Возможно, необходимо ознакомиться только с добавляется как WebMatrix код разметки в *.vbhtml* файлов.

### <a id="BM_CombiningTextMarkupAndCode"></a>  Объединение текста, разметки и кода в блоках кода

В блоках кода сервера часто нужно будет выводить текст и разметку страницы. Если блок кода сервера содержит текст, не кода и, вместо этого должны отображаться как есть, ASP.NET необходимо иметь возможность различать этот текст из кода. Для этого можно использовать следующие способы.

- Заключите текст в HTML-элемент блока как `<p></p>` или `<em></em>`:

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample11.vbhtml)]

    HTML-элемента может включать текст, дополнительных элементов HTML и код сервера выражения. Когда ASP.NET обнаруживает открывающий тег HTML (например, `<p>`), он отображает все, что элемент и его содержимое в виде браузера (и разрешает выражений код сервера).

- Используйте `@:` оператор или `<text>` элемент. `@:` Выводит одну строку содержимого, содержащего обычный текст или непарные теги HTML; `<text>` элемент заключает в себе несколько строк для вывода. Эти параметры полезны в тех случаях, если не требуется для отрисовки HTML-элемента как часть выходных данных.

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample12.vbhtml)]

    В следующем примере повторяется предыдущий пример, но использует одну пару `<text>` тегов, чтобы заключить текст для отображения.

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample13.vbhtml)]

    В следующем примере `<text>` и `</text>` теги заключите три строки, каждая из которых имеет неавтономные текста и несовпадающие HTML-теги (`<br />`), а также серверный код и соответствующие теги HTML. Опять же, может предшествовать каждой строки по отдельности с помощью `@:` оператор; либо works способом.

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample14.vbhtml)]

    > [!NOTE]
    > При выводе текста как показано в этом разделе &#8212; с помощью HTML-элемент, `@:` оператора, или `<text>` элемент &#8212; ASP.NET не HTML-кодирование выходных данных. (Как уже отмечалось, ASP.NET кодировать выходные данные выражения кода сервера и блоков кода сервера, которым предшествует `@`, за исключением особых случаев, указанных в этом разделе.)

### <a name="whitespace"></a>Whitespace

Лишние пробелы в операторе (и за ее пределами строковым литералом) не влияют на инструкцию:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample15.vbhtml)]

### <a name="breaking-long-statements-into-multiple-lines"></a>Разбиение длинных операторов на несколько строк

Длинный код инструкции можно разбить на несколько строк с помощью символа подчеркивания `_` (в Visual Basic называемый *символ продолжения*) после каждой строки кода. Чтобы приостановить выполнение инструкции на следующую строку, в конце строки добавьте пробел, а затем символ продолжения. Оператор Continue на следующей строке. Можно включить операторов на столько строк, сколько необходимо для повышения удобочитаемости. Следующие инструкции равнозначны:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample16.vbhtml)]

Тем не менее нельзя создать оболочку строки середине строкового литерала. Следующий пример не будет работать:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample17.vbhtml)]

Чтобы объединить длинную строку, которая переносится на несколько строк, такие как приведенный выше код, необходимо использовать *оператор объединения* (`&`), который вы увидите далее в этой статье.

### <a name="code-comments"></a>Комментарии к коду

Комментарии можно оставлять заметки как для себя или другим пользователям. Комментарии синтаксис Razor начинаются с префикса `@*` и заканчиваться `*@`.

[!code-cshtml[Main](introducing-razor-syntax-vb/samples/sample18.cshtml)]

Внутри блоков кода можно использовать комментарии синтаксис Razor, или можно использовать обычный символ комментария Visual Basic, который является либо одинарные (`'`) в качестве префикса для каждой строки.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample19.vbhtml)]

## <a name="variables"></a>Переменные

Переменная является именованный объект, который используется для хранения данных. Вы можно назвать переменные, но имя должно начинаться с буквы и не может содержать пробелы или зарезервированные символы. В Visual Basic как показано выше, не имеет значения регистра букв в имени переменной.

### <a name="variables-and-data-types"></a>Переменные и типы данных

Переменная может иметь определенный тип данных, который указывает, какие данные хранятся в переменной. У вас есть строковых переменных, в которых хранятся строковые значения (например &quot;Здравствуй, мир&quot;), целочисленные переменные, которые сохраняют значения целого числа (например, 3 или 79) и переменные date, в которых хранятся значения даты в различных форматах (например, 4/12/2012 или марта 2009 г. ). И многие другие типы данных, которые можно использовать.

Тем не менее не нужно указывать тип переменной. В большинстве случаев ASP.NET может определить тип, в зависимости от того, как используются данные в переменной. (Иногда необходимо указать тип, вы увидите примеры, когда это значение равно true.)

Чтобы объявить переменную без указания типа, используйте `Dim` плюс имя переменной (например, `Dim myVar`). Чтобы объявить переменную с типом, используйте `Dim` плюс имя переменной, за которым следует `As` и затем имя типа (например, `Dim myVar As String`).

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample20.vbhtml)]

В следующем примере некоторые встроенные выражения, которые используют переменные на веб-странице.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample21.vbhtml)]

Результат отображается в браузере:

![Razor Img9](introducing-razor-syntax-vb/_static/image9.jpg)

### <a name="converting-and-testing-data-types"></a>Преобразование и тестирование типы данных

Несмотря на то, что ASP.NET обычно можно автоматически определить тип данных, иногда это невозможно. Таким образом может потребоваться помощь ASP.NET, выполнив явное преобразование. Даже если у вас нет для преобразования типов, иногда бывает полезно проверить, какие типы данных вы можете работать с.

Наиболее распространенным случаем является необходимость преобразования строки в другой тип, такой как целое число или дату. В примере показан типичный случай, где необходимо преобразовать строку в число.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample22.vbhtml)]

Как правило входные данные пользователя будут доставляться вам как строки. Даже если предлагается ввести номер, и даже если они вводят цифры, при отправке ввод данных пользователем и прочитать его в код, данные в строковом формате. Таким образом необходимо преобразовать строку в число. В примере при попытке выполнить арифметические операции над значениями без преобразования их, возникает следующая ошибка, так как ASP.NET не удается добавить две строки:

`Cannot implicitly convert type 'string' to 'int'.`

Для преобразования значений в целые числа, следует вызвать `AsInt` метод. Если преобразование прошло успешно, затем можно добавить номера.

Ниже перечислены некоторые распространенные методы преобразования и тестирования для переменных.


:::row:::
    :::column:::
        <strong>Method</strong>
    :::column-end:::
    :::column:::
        <strong>Description</strong>
    :::column-end:::
    :::column:::
        <strong>Example</strong>
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `AsInt(), IsInt()`
    :::column-end:::
    :::column:::
        Converts a string that represents a whole number (like &quot;593&quot;) to an integer.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample23.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `AsBool(), IsBool()`
    :::column-end:::
    :::column:::
        Converts a string like &quot;true&quot; or &quot;false&quot; to a Boolean type.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample24.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `AsFloat(), IsFloat()`
    :::column-end:::
    :::column:::
        Converts a string that has a decimal value like &quot;1.3&quot; or &quot;7.439&quot; to a floating-point number.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample25.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `AsDecimal(), IsDecimal()`
    :::column-end:::
    :::column:::
        Converts a string that has a decimal value like &quot;1.3&quot; or &quot;7.439&quot; to a decimal number. (In ASP.NET, a decimal number is more precise than a floating-point number.)
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample26.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `AsDateTime(), IsDateTime()`
    :::column-end:::
    :::column:::
        Converts a string that represents a date and time value to the ASP.NET `DateTime` type.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample27.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `ToString()`
    :::column-end:::
    :::column:::
        Converts any other data type to a string.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample28.vb)]
    :::column-end:::
:::row-end:::


## <a name="operators"></a>Операторы

Оператор — это ключевое слово или символ, который сообщает ASP.NET, какого рода команду, выполняемую в выражении. Visual Basic поддерживает многие операторы, но требуется только для распознавания немного, чтобы приступить к разработке веб-страниц ASP.NET. В следующей таблице перечислены наиболее распространенные операторы.


:::row:::
    :::column:::
        <strong>Operator</strong>
    :::column-end:::
    :::column:::
        <strong>Description</strong>
    :::column-end:::
    :::column:::
        <strong>Examples</strong>
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `+ - * /`
    :::column-end:::
    :::column:::
        Math operators used in numerical expressions.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample29.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `=`
    :::column-end:::
    :::column:::
        Assignment and equality. Depending on context, either assigns the value on the right side of a statement to the object on the left side, or checks the values for equality.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample30.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `<>`
    :::column-end:::
    :::column:::
        Inequality. Returns `True` if the values are not equal.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample31.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `< > <= >=`
    :::column-end:::
    :::column:::
        Less than, greater than, less than or equal, and greater than or equal.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample32.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `&`
    :::column-end:::
    :::column:::
        Concatenation, which is used to join strings.
    :::column-end:::
    :::column:::
        [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample33.vbhtml)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `+= -=`
    :::column-end:::
    :::column:::
        The increment and decrement operators, which add and subtract 1 (respectively) from a variable.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample34.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `.`
    :::column-end:::
    :::column:::
        Dot. Used to distinguish objects and their properties and methods.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample35.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `()`
    :::column-end:::
    :::column:::
        Parentheses. Used to group expressions, to pass parameters to methods, and to access members of arrays and collections.
    :::column-end:::
    :::column:::
        [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample36.vbhtml)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `Not`
    :::column-end:::
    :::column:::
        Not. Reverses a true value to false and vice versa. Typically used as a shorthand way to test for `False` (that is, for not `True`).
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample37.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `AndAlso OrElse`
    :::column-end:::
    :::column:::
        Logical AND and OR, which are used to link conditions together.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample38.vb)]
    :::column-end:::
:::row-end:::

## <a name="working-with-file-and-folder-paths-in-code"></a>Работа с файлом и пути к папкам в коде

Вы будете часто работать пути файлов и папок в коде. Ниже приведен пример структуры физическую папку для веб-сайта, которое может отображаться на компьютере разработчика:

`C:\WebSites\MyWebSite default.cshtml datafile.txt \images Logo.jpg \styles Styles.css`

Ниже приведены некоторые важные сведения о URL-адреса и пути.

- URL-адрес начинается с любым именем домена (`http://www.example.com`) или имя сервера (`http://localhost`, `http://mycomputer`).
- URL-адрес соответствует физический путь на главном компьютере. Например `http://myserver` может соответствовать папке *C:\websites\mywebsite* на сервере.
- Виртуальный путь является сокращением для представления путей в коде без указания полного пути. Он включает в себя часть URL-адрес, который следует за именем домена или сервера. При использовании виртуальных путей, можно перенести код в другой домен или сервер без необходимости обновите пути.

Ниже приведен пример, чтобы помочь вам понять различия:

| Полный URL-адрес | `http://mycompanyserver/humanresources/CompanyPolicy.htm` |
| --- | --- |
| Имя сервера | *mycompanyserver* |
| Виртуальный путь | */HumanResources/CompanyPolicy.htm* |
| Физический путь | *C:\mywebsites\humanresources\CompanyPolicy.htm* |

Виртуальный корневой каталог — /, так же, как корень диска c диск — \. (Виртуальная папка пути всегда использовать символы косой черты). Виртуальный путь к папке не нужно иметь то же имя как физический каталог; Это может быть псевдонимом. (На рабочих серверах, виртуальный путь редко соответствует как полный физический путь.)

При работе с файлами и папками в коде, иногда требуется для ссылки на физический путь и иногда виртуального пути, в зависимости от того, какие объекты, которыми вы работаете. ASP.NET предоставляет эти средства для работы с пути файлов и папок в коде: `Server.MapPath` метод и `~` оператор и `Href` метод.

### <a name="converting-virtual-to-physical-paths-the-servermappath-method"></a>Преобразование виртуальных и физических путей: метод Server.MapPath

`Server.MapPath` Метод преобразует виртуальный путь (например */default.cshtml*) в абсолютный физический путь (например *C:\WebSites\MyWebSiteFolder\default.cshtml*). Этот метод использовать когда требуется полный физический путь. Типичный пример — при чтении или записи в текстовый файл или файл изображения на веб-сервере.

Абсолютный физический путь веб-сайта на сервере размещения сайта обычно не известен, поэтому этот метод можно преобразовать путь вы знаете, виртуальный путь, соответствующий путь на сервере для вас. Передайте виртуальный путь к файлу или папке в метод и возвращает физический путь:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample39.vbhtml)]

### <a name="referencing-the-virtual-root-the--operator-and-href-method"></a>Ссылка на виртуальный корневой каталог: ~ оператор и метод Href

В *.cshtml* или *.vbhtml* файл, вы можете ссылаться на пути виртуального корневого каталога, используя `~` оператор. Это очень удобно, так как для перемещения страниц на узле и все ссылки, содержащиеся в них на другие страницы не будет нарушена. Это также удобно в случае, если когда-либо переместить веб-сайта в другое расположение. Далее приводятся некоторые примеры.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample40.vbhtml)]

Если веб-сайт `http://myserver/myapp`, вот как ASP.NET будет интерпретировать эти пути, при запуске страницы:

- `myImagesFolder`: `http://myserver/myapp/images`
- `myStyleSheet` : `http://myserver/myapp/styles/Stylesheet.css`

(Вы не увидите эти пути в качестве значения переменной, но ASP.NET будет рассматривать пути, как в случае, они были).

Можно использовать `~` оператор, как в серверном коде (как описано выше), так и в разметке, следующим образом:

[!code-html[Main](introducing-razor-syntax-vb/samples/sample41.html)]

В разметке, использовании `~` оператор для создания путей к ресурсам, например файлы изображений, другие веб-страниц и файлов CSS. При запуске страницы ASP.NET, просматривает страницы (код и разметку) и разрешает все `~` ссылки на соответствующий путь.

## <a name="conditional-logic-and-loops"></a>Условной логики и циклов

Код сервера ASP.NET позволяет выполнять задачи на основе условий и написать код, который повторяется определенное число раз, то есть код инструкции, выполняется цикл).

### <a name="testing-conditions"></a>Проверка условий

Для тестирования на выполнение простого условия можно использовать `If...Then` инструкцию, которая возвращает `True` или `False` зависимости от теста, можно указать:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample42.vbhtml)]

`If` Ключевое слово начинается блок. Тест этот сам (условие) соответствует `If` ключевое слово и возвращает значение true или false. `If` Заканчивается инструкция `Then`. Операторы, которые будут выполняться, если аргумент имеет значение true, заключенных с `If` и `End If`. `If` Инструкция может содержать `Else` блок, который задает операторы, которые выполняются, если условие имеет значение false:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample43.vbhtml)]

Если `If` инструкции начинается блок кода, не нужно использовать обычный `Code...End Code` инструкции, чтобы включить блоки. Можно просто добавить `@` блоку, и он будет работать. Этот подход работает с `If` а также другие программирования ключевые слова, которые следуют блоки кода, включая Visual Basic `For`, `For Each`, `Do While`и т. д.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample44.vbhtml)]

Можно добавить несколько условий, используя один или несколько `ElseIf` блоков:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample45.vbhtml)]

В этом примере, если первое условие в `If` блок не имеет значение true, `ElseIf` проверяется условие. Если это условие выполнено, операторы в `ElseIf` блоке. Если ни одно из условий не соблюдается, операторы в `Else` блоке. Можно добавить любое количество `ElseIf` блокирует, а затем закройте с `Else` заблокировать, в виде &quot;все остальное&quot; условие.

Чтобы протестировать большое количество условий, используйте `Select Case` блок:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample46.vbhtml)]

Значение для проверки, указан в скобках (в примере переменная дня недели). Каждого отдельного теста использует `Case` инструкцию, которая содержит значение. Если значение `Case` инструкции совпадает со значением теста, код, который `Case` выполняется блок.

Результат выполнения двух последних блоки условий, отображаемый в браузере:

![Razor Img10](introducing-razor-syntax-vb/_static/image10.jpg)

### <a name="looping-code"></a>Циклическое кода

Часто требуется многократно выполнять те же операторы. Для этого цикла. Например вы часто выполняются те же операторы для каждого элемента в коллекции данных. Если вы знаете, точно того, как часто необходимо применить цикл, можно использовать `For` цикла. Этот тип цикла удобен для подсчета или отсчет:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample47.vbhtml)]

Цикл начинается с `For` ключевое слово, и три элемента:

- Сразу после `For` инструкции, объявите переменную счетчика (не обязательно использовать `Dim`) и укажите диапазон, как показано на `i = 10 to 20`. Это означает, что переменная `i` начинается нумерацию строк с 10 и продолжается до достижения 20 (включительно).
- Между `For` и `Next` инструкций — содержимое блока. Это может содержать один или несколько операторов кода, которые выполняются с каждого цикла.
- `Next i` Инструкция завершает цикл. Он увеличивает значение счетчика и запуске следующей итерации цикла.

Строка кода между `For` и `Next` строк содержит код, который выполняется для каждой итерации цикла. Разметка создает новый абзац (`<p>` элемент) каждый раз и добавляет строку в выходные данные, отображают значение i (счетчик). Когда вы запускаете эту страницу, в примере создается 11 строк, отображение выходных данных, с текстом в каждой строке, указывающее номер элемента.

![Razor Img11](introducing-razor-syntax-vb/_static/image11.jpg)

Если вы работаете в коллекции или массива, часто используют `For Each` цикла. Коллекция — это группа схожих объектов и `For Each` цикле позволяет выполнить задачу для каждого элемента в коллекции. Этот тип цикла удобен для коллекций, так как в отличие от `For` цикл, у вас нет для увеличения значения счетчика или ограничить. Вместо этого `For Each` код цикла просто продолжается через коллекцию до его завершения.

Этот пример возвращает элементы в `Request.ServerVariables` коллекции (который содержит сведения о веб-сервере). Она использует `For Each` цикл для отображения имени каждого элемента путем создания нового `<li>` элемента в HTML-маркированного списка.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample48.vbhtml)]

`For Each` Ключевого слова следуют переменную, которая представляет один элемент в коллекции (в примере `myItem`), за которым следует `In` ключевое слово, и вы хотите организовать цикл по коллекции. В теле `For Each` цикла, можно получить доступ к текущего элемента, с помощью переменной, объявленный ранее.

![Razor Img12](introducing-razor-syntax-vb/_static/image12.jpg)

Чтобы создать цикл программирования более общего назначения, используйте `Do While` инструкции:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample49.vbhtml)]

Этот цикл начинается с `Do While` ключевое слово, и условия, следует блок для повторения. Циклы обычно увеличивается (Добавление) или уменьшения (вычитаемое) переменной или объекта, используемые для подсчета. В примере `+=` оператор добавляет 1 к значению переменной при каждом выполнении цикла. (Чтобы уменьшают значение переменной в цикле, который отсчитывает, используйте оператор декремента `-=`.)

## <a name="objects-and-collections"></a>Объекты и коллекции

Почти все в на веб-сайте ASP.NET — это объект, включая саму веб-страницу. В этом разделе рассматриваются некоторые важные объекты, которые вы будете работать с часто в коде.

### <a name="page-objects"></a>Объекты страниц

Самый простой объект в ASP.NET является страница. Можно получить доступ к свойствам объекта страницу напрямую без любой подходящий объект. Следующий код получает путь к файлу страницы, с помощью `Request` объект страницы:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample50.vbhtml)]

Можно использовать свойства `Page` объекта, чтобы получить массу информации, такие как:

- `Request`. Как вы уже видели, это коллекция сведений о текущем запросе, включая тип браузера, выдавший запрос, URL-адрес страницы, удостоверение пользователя и т. д.
- `Response`. Это коллекция сведений об ответе (страницы), отправляемого в браузер при серверный код завершения работы. Например это свойство можно использовать для записи сведений в ответ.

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample51.vbhtml)]

### <a name="collection-objects-arrays-and-dictionaries"></a>Коллекция объектов (массивов и словарей)

Коллекция — это группа объектов одного типа, например, коллекцию `Customer` объекты из базы данных. ASP.NET содержит множество встроенных коллекций, включая `Request.Files` коллекции.

Вы будете часто работать с данными в коллекции. Два распространенных типов коллекций являются *массива* и *словарь*. Массив полезно в том случае, если вы хотите хранить коллекции схожих элементов, но не нужно создавать отдельную переменную для хранения каждого элемента:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample52.vbhtml)]

В массивах можно объявить определенный тип данных, например `String`, `Integer`, или `DateTime`. Чтобы указать, что переменная может содержать массив, добавить круглые скобки к имени переменной в объявлении (такие как `Dim myVar() As String`). Можно получить доступ к элементам в массиве с помощью их положение (индекс) или с помощью `For Each` инструкции. Массив индексы отсчитываются от нуля &#8212; то есть первый элемент находится в позиции 0, второй элемент находится в позиции 1 и т. д.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample53.vbhtml)]

Можно определить количество элементов в массиве, получив его `Length` свойство. Чтобы получить позицию конкретного элемента в массиве (т. е для поиска массив), используйте `Array.IndexOf` метод. Вы можете также выполнять действия как обратное содержимое массива ( `Array.Reverse` метод) или Сортировка содержимого ( `Array.Sort` метод).

В результате выполнения код массив строки, отображаемый в браузере.

![Razor Img13](introducing-razor-syntax-vb/_static/image13.jpg)

Словарь является коллекцией пар "ключ значение", где можно ввести ключ (или имя), чтобы задать или получить соответствующее значение:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample54.vbhtml)]

Чтобы создать словарь, используйте `New` ключевое слово, чтобы указать, что вы создаете новый `Dictionary` объекта. Словарь можно назначить переменной с помощью `Dim` ключевое слово. Можно указать типы данных элементов в словаре, с помощью скобок ( `( )` ). В конце объявления необходимо добавить еще одной пары скобок, так как это фактически является методом, который создает новый словарь.

Для добавления элементов в словарь, можно вызвать `Add` метод переменной словарь (`myScores` в данном случае), а затем укажите ключ и значение. Кроме того можно использовать скобки для указания ключа и выполните простые присваивания, как показано в следующем примере:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample55.vbhtml)]

Чтобы получить значение из словаря, необходимо указать ключ в круглые скобки:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample56.vbhtml)]

## <a name="calling-methods-with-parameters"></a>Вызов методов с параметрами

Как было показано ранее в этой статье, объекты, которые программируется с имеют методы. Например `Database` объект может иметь `Database.Connect` метод. Многие методы также имеют один или несколько параметров. Объект *параметр* является значение, которое можно передать в метод, чтобы включить этот метод для выполнения необходимых задач. Например, взгляните на объявление для `Request.MapPath` метод, который принимает три параметра:

[!code-vb[Main](introducing-razor-syntax-vb/samples/sample57.vb)]

Этот метод возвращает физический путь на сервере, который соответствует для заданного виртуального пути. Три параметра для метода являются `virtualPath`, `baseVirtualDir`, и `allowCrossAppMapping`. (Обратите внимание на то, что в объявлении с типами данных, данных, которые они оставлю перечисляются параметры). При вызове этого метода необходимо указать значения для всех трех параметров.

При использовании Visual Basic с синтаксисом Razor, у вас есть два варианта для передачи параметров в метод: *позиционные параметры* или *именованные параметры*. Чтобы вызвать метод, с помощью позиционные параметры, параметры передаются в строгом порядке, который указан в объявлении метода. (Вы обычно будет этот порядок по чтению документации для метода.) Необходимо соблюдать порядок и какого-либо параметра невозможно пропустить &#8212; при необходимости можно передать пустую строку (`""`) или значение null для позиционного параметра, которое не имеет значения для.

В следующем примере предполагается, что у вас есть папка с именем *сценариев* на веб-сайте. Этот код вызывает `Request.MapPath` метод и передает эти значения для трех параметров в правильном порядке. Затем отображается сопоставленные результирующий контур.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample58.vbhtml)]

При существует много параметров для метода, можно сохранить код более понятным и удобочитаемым с помощью именованных параметров. Чтобы вызвать метод с использованием именованных параметров, укажите имя параметра, за которым следует `:=` и затем укажите значение. Именованных параметров удобен тем, что их можно добавить в любом порядке, который вы хотите. (Недостаток заключается в вызове метода не является компактным).

В следующем примере вызывается тот же метод, как описано выше, но использует именованные параметры для предоставления значений:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample59.vbhtml)]

Как видите, эти параметры передаются в другом порядке. Тем не менее при выполнении предыдущего примера и в этом примере, они будут возвращать то же значение.

## <a name="handling-errors"></a>Обработка ошибок

### <a name="try-catch-statements"></a>Операторы Try-Catch

У вас будет часто инструкций в коде, может завершиться ошибкой по соображениям за пределами элемента управления. Пример:

- Если код пытается открыть, создание, чтение или запись в файл, может возникнуть все виды ошибок. Файл может отсутствовать, может быть заблокирован, код может не иметь разрешения и т. д.
- Аналогичным образом Если код пытается выполнить обновления записей в базе данных, могут быть проблемы с разрешениями, подключение к базе данных могут быть удалены, сохраняемые данные может быть недопустимым и т. д.

С точки зрения программирования, называются таких ситуациях *исключения*. Если код обнаруживает исключение, он создает (вызывает) сообщение об ошибке, в лучшем случае к пользователям.

![Razor Img14](introducing-razor-syntax-vb/_static/image14.jpg)

В ситуациях, где ваш код может обнаружить исключения, а также чтобы избежать сообщения об ошибках этого типа, можно использовать `Try/Catch` инструкций. В `Try` инструкции, запустите код, который вы проверяете. В одной или нескольких `Catch` инструкций, можно произвести поиск конкретных ошибок (определенные типы исключений), которые могли возникнуть. Можно включить столько `Catch` инструкциях, как вам нужно искать ошибки, которые вы ожидаем.

> [!NOTE]
> Рекомендуется избегать использования `Response.Redirect` метод в `Try/Catch` инструкции, так как он может вызвать исключение в страницу.


Пример страницы, которая создает текстовый файл, при первом запросе и затем отображает кнопку, которая позволяет пользователю открыть файл. В примере намеренно используется недопустимое имя файла, чтобы он вызовет исключение. Код включает `Catch` инструкций для двух возможных исключений: `FileNotFoundException`, это происходит, если имя файла недопустимо, и `DirectoryNotFoundException`, это происходит, если ASP.NET даже не удается найти папку. (Чтобы увидеть, как оно работает, если все работает надлежащим образом можно Раскомментировать инструкция в примере.)

Если ваш код не обрабатывает исключение, вы увидите страницу ошибки, как и на предыдущем снимке экрана. Тем не менее `Try/Catch` раздел помогает предотвратить просмотр таких ошибок пользователя.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample60.vbhtml)]

## <a name="additional-resources"></a>Дополнительные ресурсы

### <a name="reference-documentation"></a>Справочная документация

- [ASP.NET](https://msdn.microsoft.com/library/ee532866.aspx)
- [Язык Visual Basic](https://msdn.microsoft.com/library/2x7h1hfk.aspx)
