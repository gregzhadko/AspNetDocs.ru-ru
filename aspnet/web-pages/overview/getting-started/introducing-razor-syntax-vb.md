---
uid: web-pages/overview/getting-started/introducing-razor-syntax-vb
title: Общие сведения о веб-программировании ASP.NET с использованием синтаксиса Razor (Visual Basic) | Документация Майкрософт
author: Rick-Anderson
description: В этом приложении содержатся общие сведения о программировании с помощью веб-страниц ASP.NET в Visual Basic с использованием синтаксис Razor.
ms.author: riande
ms.date: 02/07/2014
ms.assetid: 5da59646-e973-41cd-88a9-c6b2c0594027
msc.legacyurl: /web-pages/overview/getting-started/introducing-razor-syntax-vb
msc.type: authoredcontent
ms.openlocfilehash: 2be57655b8c9b76b94e1d9a7ae5fbee27545a0a9
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78422664"
---
# <a name="introduction-to-aspnet-web-programming-using-the-razor-syntax-visual-basic"></a>Введение в веб-программирование на ASP.NET с помощью синтаксиса Razor (Visual Basic)

от [Tom фитзмаккен](https://github.com/tfitzmac)

> В этой статье приводятся общие сведения о программировании с помощью веб-страницы ASP.NET синтаксис Razor и Visual Basic. ASP.NET — это технология корпорации Майкрософт для запуска динамических веб-страниц на веб-серверах.
> 
> **Что вы**узнаете:
> 
> - 8 лучших советов по программированию для начинающих веб-страницы ASP.NET с помощью синтаксис Razor.
> - Основные понятия программирования, которые вам понадобятся.
> - Что ASP.NET серверный код и синтаксис Razor.
>   
> 
> ## <a name="software-versions"></a>Версии программного обеспечения
> 
> 
> - Веб-страницы ASP.NET (Razor) 3
>   
> 
> Этот учебник также работает с веб-страницы ASP.NET 2.

В большинстве примеров использования веб-страницы ASP.NET с синтаксис Razor C#. Но синтаксис Razor также поддерживает Visual Basic. Чтобы программировать веб-страницу ASP.NET в Visual Basic, создайте веб-страницу с расширением *. vbhtml* , а затем добавьте код Visual Basic. В этой статье приводятся общие сведения о работе с языком Visual Basic и синтаксисом для создания веб-страниц ASP.NET.

> [!NOTE]
> Шаблоны веб-сайтов по умолчанию для Microsoft WebMatrix (**кондитерской** **, фотоальбом и** **начальный сайт**и т. д.) C# доступны в и Visual Basic версиях. Шаблоны Visual Basic можно установить в виде пакетов NuGet. Шаблоны веб-сайтов устанавливаются в корневую папку сайта в папке с именем *Microsoft Templates*.

## <a name="the-top-8-programming-tips"></a>8 лучших советов по программированию

В этом разделе приведено несколько советов, которые необходимо знать при написании кода сервера ASP.NET с помощью синтаксис Razor.

### <a name="1-you-add-code-to-a-page-using-the--character"></a>1. Вы добавляете код на страницу с помощью символа @.

`@` символ начинается со встроенных выражений, блоков одной инструкции и многооператорных блоков:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample1.vbhtml)]

Результат отображается в браузере:

![Razor — Img1](introducing-razor-syntax-vb/_static/image1.jpg)

> [!TIP] 
> 
> **Кодировка HTML**
> 
> При отображении содержимого на странице с помощью `@` символа, как в предыдущих примерах, ASP.NET HTML кодирует выходные данные. Это заменяет зарезервированные символы HTML (например, `<` и `>` и `&`) кодами, которые позволяют отображать символы в виде символов на веб-странице, а не интерпретировать их как теги HTML или сущности. Без кодирования HTML выходные данные из кода сервера могут отображаться неправильно, и может представлять угрозу безопасности страницы.
> 
> Если ваша цель — вывод HTML-разметки, которая отображает теги как разметку (например `<p></p>` для абзаца или `<em></em>`, чтобы подчеркнуть текст), см. раздел [Объединение текста, разметки и кода в блоках кода](#BM_CombiningTextMarkupAndCode) ниже в этой статье.
> 
> Дополнительные сведения о кодировке HTML см. в статье как [работать с HTML-формами на веб-страницы ASP.NET сайтах](https://go.microsoft.com/fwlink/?LinkId=202892).

### <a name="2-you-enclose-code-blocks-with-codeend-code"></a>2. Вы заключаете блоки кода в код... Конечный код

Блок кода включает один или несколько операторов кода, заключенный в ключевые слова `Code` и `End Code`. Поместите ключевое слово Open `Code` сразу после `@` символа &#8212; , между которыми не может быть пробел.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample2.vbhtml)]

Результат отображается в браузере:

![Razor — Img2](introducing-razor-syntax-vb/_static/image2.jpg)

### <a name="3-inside-a-block-you-end-each-code-statement-with-a-line-break"></a>3. внутри блока все операторы кода завершаются разрывом строки

В блоке кода Visual Basic каждая инструкция заканчивается разрывом строки. (Далее в статье вы увидите способ заключения длинной инструкции Code в несколько строк, если это необходимо.)

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample3.vbhtml)]

### <a name="4-you-use-variables-to-store-values"></a>4. переменные используются для хранения значений

Значения можно хранить в *переменной*, включая строки, числа и даты и т. д. Новую переменную можно создать с помощью ключевого слова `Dim`. Значения переменных можно вставлять непосредственно на странице с помощью `@`.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample4.vbhtml)]

Результат отображается в браузере:

![Razor — Img3](introducing-razor-syntax-vb/_static/image3.jpg)

### <a name="5-you-enclose-literal-string-values-in-double-quotation-marks"></a>5. строковые литеральные значения заключаются в двойные кавычки.

*Строка* представляет собой последовательность символов, обрабатываемых как текст. Чтобы указать строку, заключите ее в двойные кавычки:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample5.vbhtml)]

Чтобы внедрить двойные кавычки в строковое значение, вставьте два символа двойной кавычки. Если требуется, чтобы символ двойной кавычки отображался один раз в выходных данных страницы, введите его как `""` в строке в кавычках и, если нужно, чтобы он выглядел дважды, введите его как `""""` в строке в кавычках.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample6.vbhtml)]

Результат отображается в браузере:

![Razor — Img4](introducing-razor-syntax-vb/_static/image4.jpg)

### <a name="6-visual-basic-code-is-not-case-sensitive"></a>6. Visual Basic код не чувствителен к регистру

Язык Visual Basic не чувствителен к регистру. Ключевые слова программирования (такие как `Dim`, `If`и `True`) и имена переменных (например, `myString`или `subTotal`) могут быть написаны в любом случае.

Следующие строки кода присваивают значение переменной `lastname` используя имя в нижнем регистре, а затем выводят значение переменной на страницу, используя имя в верхнем регистре.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample7.vbhtml)]

Результат отображается в браузере:

![VB — синтаксис – 5](introducing-razor-syntax-vb/_static/image5.jpg)

### <a name="7-much-of-your-coding-involves-working-with-objects"></a>7. большая часть кода предполагает работу с объектами

Объект представляет вещь, которую можно программировать с &#8212; помощью страницы, текстового поля, файла, изображения, веб-запроса, сообщения электронной почты, записи клиента (строки базы данных) и т. д. Объекты имеют свойства, описывающие их &#8212; характеристики объект текстового поля имеет свойство `Text`, объект запроса имеет свойство `Url`, сообщение электронной почты имеет свойство `From`, а объект Customer имеет свойство `FirstName`. Объекты также имеют методы, которые являются &quot;командами&quot; они могут выполняться. К примерам относятся метод `Save` файлового объекта, метод `Rotate` объекта изображения и метод `Send` объекта сообщения электронной почты.

Часто приходится работать с объектом `Request`, который предоставляет сведения, такие как значения полей формы на странице (текстовые поля и т. д.), тип браузера, который выполнил запрос, URL-адрес страницы, удостоверение пользователя и т. д. В этом примере показано, как получить доступ к свойствам объекта `Request` и вызвать метод `MapPath` объекта `Request`, который предоставляет абсолютный путь к странице на сервере:

[!code-html[Main](introducing-razor-syntax-vb/samples/sample8.html)]

Результат отображается в браузере:

![Razor — Img5](introducing-razor-syntax-vb/_static/image6.jpg)

### <a name="8-you-can-write-code-that-makes-decisions"></a>8. можно написать код, который принимает решения

Ключевой функцией динамических веб-страниц является то, что вы можете определить, что делать на основе условий. Самый распространенный способ сделать это — с помощью оператора `If` (и необязательной инструкции `Else`).

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample9.vbhtml)]

`If IsPost` инструкции — это сокращенный способ написания `If IsPost = True`. Наряду с инструкциями `If` существует множество способов проверки условий, повторных блоков кода и т. д., которые описаны далее в этой статье.

Результат, отображаемый в браузере (после нажатия кнопки **Отправить**):

![Razor — Img6](introducing-razor-syntax-vb/_static/image7.jpg)

> [!TIP] 
> 
> **Методы HTTP GET и POST и свойство POST**
> 
> Протокол, используемый для веб-страниц (HTTP), поддерживает очень ограниченное число методов (&quot;глаголы&quot;), которые используются для выполнения запросов к серверу. Двумя наиболее распространенными являются GET, который используется для чтения страницы, и POST, который используется для отправки страницы. В общем случае при первом запросе страницы пользователем страница запрашивается с помощью GET. Если пользователь заполняет форму и нажимает кнопку **Отправить**, браузер ОТПРАВЛЯЕТ запрос POST на сервер.
> 
> В веб-программировании часто бывает полезно определить, запрашивается ли страница как GET или AS POST, чтобы вы узнали, как обрабатывать страницу. В веб-страницы ASP.NET можно использовать свойство `IsPost`, чтобы определить, является ли запрос сообщением GET или POST. Если запрос является POST, свойство `IsPost` возвратит значение true, и вы можете выполнять такие действия, как чтение значений текстовых полей в форме. Во многих примерах вы увидите, как обрабатывать страницу по-разному в зависимости от значения `IsPost`.

## <a name="a-simple-code-example"></a>Простой пример кода

В этой процедуре показано, как создать страницу, на которой показаны основные методики программирования. В этом примере создается страница, позволяющая пользователям вводить два числа, затем добавляет их и отображает результат.

1. В редакторе создайте новый файл и назовите его *подставлял. vbhtml*.
2. Скопируйте приведенный ниже код и разметку на страницу, заменив все, что уже есть на странице.

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample10.vbhtml)]

    Обратите внимание на некоторые моменты.

    - `@` символ запускает первый блок кода на странице, и он предшествует `totalMessage` переменной, внедренной в нижнюю часть.
    - Блок в верхней части страницы заключается в `Code...End Code`.
    - Переменные `total`, `num1`, `num2`и `totalMessage` хранят несколько чисел и строку.
    - Литеральное строковое значение, присваиваемое переменной `totalMessage`, заключено в двойные кавычки.
    - Поскольку в Visual Basicном коде не учитывается регистр, если в нижней части страницы используется `totalMessage` переменная, ее имя должно соответствовать только написанию объявления переменной в верхней части страницы. Регистр не имеет значения.
    - Выражение `num1.AsInt()` + `num2.AsInt()` показывает, как работать с объектами и методами. Метод `AsInt` для каждой переменной преобразует строку, введенную пользователем, в целое число (Integer), которое можно добавить.
    - Тег `<form>` содержит атрибут `method="post"`. Это указывает, что при нажатии пользователем кнопки **Добавить**страница будет отправлена на сервер с помощью метода HTTP POST. При отправке страницы код `If IsPost` оценивается как true и выполняется условный код, отображая результат сложения чисел.
3. Сохраните страницу и запустите ее в браузере. (Перед выполнением страницы убедитесь, что она выбрана в рабочей области **файлы** .) Введите два целых числа и нажмите кнопку " **Добавить** ".

    ![Razor — Img7](introducing-razor-syntax-vb/_static/image8.jpg)

## <a name="visual-basic-language-and-syntax"></a>Язык и синтаксис Visual Basic

Ранее вы увидели простой пример создания веб-страницы ASP.NET, а также способ добавления серверного кода в разметку HTML. Здесь вы узнаете об основах использования Visual Basic для написания кода сервера ASP.NET, используя синтаксис Razor &#8212; , то есть правила языка программирования.

При работе с программированием (особенно если вы использовали C, C++, C#, Visual Basic или JavaScript), многие из которых вы прочитаете здесь, будут знакомы. Возможно, вам потребуется ознакомиться только с тем, как код WebMatrix добавляется к разметке в файлах *. vbhtml* .

### <a id="BM_CombiningTextMarkupAndCode"></a>Объединение текста, разметки и кода в блоках кода

В блоках кода сервера часто требуется выводить текст и разметку на страницу. Если блок кода сервера содержит текст, который не является кодом и, вместо этого, он должен быть отображен как есть, ASP.NET должен иметь возможность отличать этот текст от кода. Это можно сделать несколькими способами.

- Заключите текст в элемент блока HTML, например `<p></p>` или `<em></em>`:

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample11.vbhtml)]

    Элемент HTML может включать текст, дополнительные HTML-элементы и выражения серверного кода. Когда ASP.NET видит открывающий HTML-тег (например, `<p>`), он отображает все элементы и его содержимое в браузере (и разрешает выражения серверного кода).

- Используйте оператор `@:` или элемент `<text>`. `@:` выводит одну строку содержимого, содержащую обычный текст или несовпадающие теги HTML; элемент `<text>` включает несколько строк для вывода. Эти параметры полезны, если не нужно отображать HTML-элемент как часть выходных данных.

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample12.vbhtml)]

    В следующем примере предыдущий пример повторяется, но используется одна пара тегов `<text>` для заключения отображаемого текста.

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample13.vbhtml)]

    В следующем примере Теги `<text>` и `</text>` заключают три строки, все из которых содержат неавтономный текст и непарные теги HTML (`<br />`) вместе с серверным кодом и соответствующими тегами HTML. Опять же, можно также предшествовать каждой строке отдельно с помощью оператора `@:`. в любом случае это работает.

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample14.vbhtml)]

    > [!NOTE]
    > При выводе текста, как показано в этом &#8212; разделе, с помощью элемента html, `@:` оператор или `<text>` элемент &#8212; ASP.NET не кодирует выходные данные в формате HTML. (Как отмечалось ранее, ASP.NET кодирует выходные данные выражений серверного кода и серверных блоков кода, которым предшествуют `@`, за исключением особых случаев, указанных в этом разделе.)

### <a name="whitespace"></a>Пробел

Лишние пробелы в операторе (и вне строкового литерала) не влияют на инструкцию:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample15.vbhtml)]

### <a name="breaking-long-statements-into-multiple-lines"></a>Разбиение длинных инструкций на несколько строк

Можно разбить длинную инструкцию кода на несколько строк, используя символ подчеркивания `_` (который в Visual Basic называется *символом продолжения*) после каждой строки кода. Для разбиения оператора на следующую строку в конце строки добавьте пробел, а затем символ продолжения. Продолжите выполнение инструкции на следующей строке. Инструкции можно переносить на несколько строк, чтобы улучшить удобочитаемость. Следующие инструкции равнозначны:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample16.vbhtml)]

Однако нельзя заключить строку в середину строкового литерала. Следующий пример не работает:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample17.vbhtml)]

Чтобы объединить длинную строку, которая переносится в несколько строк, например приведенный выше код, необходимо использовать *оператор объединения* (`&`), который будет показан далее в этой статье.

### <a name="code-comments"></a>Комментарии к коду

Комментарии позволяют оставлять заметки для себя или для других пользователей. Синтаксис Razor комментарии начинаются с `@*` и заканчиваются `*@`.

[!code-cshtml[Main](introducing-razor-syntax-vb/samples/sample18.cshtml)]

В блоках кода можно использовать синтаксис Razor комментарии или можно использовать обычный Visual Basic символ комментария, который представляет собой одинарную кавычку (`'`), предваряя каждую строку.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample19.vbhtml)]

## <a name="variables"></a>Переменные

Переменная — это именованный объект, который используется для хранения данных. Можно назвать любые переменные, но имя должно начинаться с буквы и не может содержать пробелы или зарезервированные символы. В Visual Basic, как было показано ранее, регистр букв в имени переменной не имеет значения.

### <a name="variables-and-data-types"></a>Переменные и типы данных

Переменная может иметь конкретный тип данных, который указывает, какой тип данных хранится в переменной. Можно использовать строковые переменные, которые хранят строковые значения (например, &quot;Hello World&quot;), целочисленные переменные, в которых хранятся целые значения (например, 3 или 79), и переменные даты, которые хранят значения дат в различных форматах (например, 4/12/2012 или Март 2009). И существует много других типов данных, которые можно использовать.

Однако для переменной не нужно указывать тип. В большинстве случаев ASP.NET может определить тип в зависимости от того, как используются данные в переменной. (Иногда необходимо указать тип; вы увидите примеры, в которых это верно.)

Чтобы объявить переменную без указания типа, используйте `Dim` плюс имя переменной (например, `Dim myVar`). Чтобы объявить переменную с типом, используйте `Dim` плюс имя переменной, затем `As`, а затем имя типа (например, `Dim myVar As String`).

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample20.vbhtml)]

В следующем примере показаны некоторые встроенные выражения, использующие переменные на веб-странице.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample21.vbhtml)]

Результат отображается в браузере:

![Razor — Img9](introducing-razor-syntax-vb/_static/image9.jpg)

### <a name="converting-and-testing-data-types"></a>Преобразование и тестирование типов данных

Хотя ASP.NET обычно может определять тип данных автоматически, иногда он не может. Таким образом, может потребоваться помочь ASP.NET, выполнив явное преобразование. Даже если нет необходимости в преобразовании типов, иногда полезно проверить, какие типы данных могут быть вам доступны.

Наиболее распространенным случаем является преобразование строки в другой тип, например в Integer или Date. В следующем примере показан типичный случай, когда необходимо преобразовать строку в число.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample22.vbhtml)]

Как правило, вводимые пользователем данные поступают в виде строк. Даже если вы предоставили пользователю запрос на ввод числа, и даже если он вводил цифру, при отправке пользовательского ввода и считывании его в коде данные представлены в строковом формате. Поэтому необходимо преобразовать строку в число. В этом примере, если вы попытаетесь выполнить арифметические действия со значениями без их преобразования, выдается следующее сообщение об ошибке, так как ASP.NET не может добавить две строки:

`Cannot implicitly convert type 'string' to 'int'.`

Чтобы преобразовать значения в целые числа, вызовите метод `AsInt`. Если преобразование выполнено успешно, можно добавить числа.

В следующей таблице перечислены некоторые распространенные методы преобразования и тестирования для переменных.

:::row:::
    :::column:::
        <strong>Метод</strong>
    :::column-end:::
    :::column:::
        <strong>Описание</strong>
    :::column-end:::
    :::column:::
        <strong>Пример</strong>
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `AsInt(), IsInt()`
    :::column-end:::
    :::column:::
        Преобразует строку, представляющую целое число (например, &quot;593&quot;) в целое число.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample23.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `AsBool(), IsBool()`
    :::column-end:::
    :::column:::
        Преобразует строку, такую как &quot;true&quot; или &quot;false&quot;, в логический тип.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample24.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `AsFloat(), IsFloat()`
    :::column-end:::
    :::column:::
        Преобразует строку, имеющую десятичное значение, например &quot;1,3&quot; или &quot;7,439&quot;, в число с плавающей запятой.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample25.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `AsDecimal(), IsDecimal()`
    :::column-end:::
    :::column:::
        Преобразует строку, имеющую десятичное значение, например &quot;1,3&quot; или &quot;7,439&quot;, в десятичное число. (В ASP.NET десятичное число является более точным, чем число с плавающей запятой.)
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample26.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `AsDateTime(), IsDateTime()`
    :::column-end:::
    :::column:::
        Преобразует строку, представляющую значение даты и времени, в тип `DateTime` ASP.NET.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample27.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `ToString()`
    :::column-end:::
    :::column:::
        Преобразует любой другой тип данных в строку.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample28.vb)]
    :::column-end:::
:::row-end:::

## <a name="operators"></a>Операторы

Оператор — это ключевое слово или символ, который сообщает ASP.NET, какой тип команды выполнять в выражении. Visual Basic поддерживает много операторов, но для начала разработки веб-страниц ASP.NET необходимо только распознавать несколько. В следующей таблице перечислены наиболее распространенные операторы.

:::row:::
    :::column:::
        <strong>Оператор</strong>
    :::column-end:::
    :::column:::
        <strong>Описание</strong>
    :::column-end:::
    :::column:::
        <strong>Примеры</strong>
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `+ - * /`
    :::column-end:::
    :::column:::
        Математические операторы, используемые в числовых выражениях.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample29.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `=`
    :::column-end:::
    :::column:::
        Присваивание и равенство. В зависимости от контекста либо присваивает значение справа от оператора объекту с левой стороны, либо проверяет значения на равенство.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample30.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `<>`
    :::column-end:::
    :::column:::
        Неравенство. Возвращает `True`, если значения не равны.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample31.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `< > <= >=`
    :::column-end:::
    :::column:::
        Меньше, больше, меньше или равно и больше или равно.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample32.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `&`
    :::column-end:::
    :::column:::
        Объединение, которое используется для соединения строк.
    :::column-end:::
    :::column:::
        [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample33.vbhtml)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `+= -=`
    :::column-end:::
    :::column:::
        Операторы инкремента и декремента, которые добавляют и вычитают 1 (соответственно) из переменной.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample34.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `.`
    :::column-end:::
    :::column:::
        Оператор. Используется для различения объектов и их свойств и методов.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample35.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `()`
    :::column-end:::
    :::column:::
        Скобки. Используется для группирования выражений, для передачи параметров методам и для доступа к членам массивов и коллекций.
    :::column-end:::
    :::column:::
        [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample36.vbhtml)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `Not`
    :::column-end:::
    :::column:::
        Недостаточно. Меняет значение true на false и наоборот. Обычно используется в качестве краткого способа проверки `False` (то есть не `True`).
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample37.vb)]
    :::column-end:::
:::row-end:::

---

:::row:::
    :::column:::
        `AndAlso OrElse`
    :::column-end:::
    :::column:::
        Логические и и OR, которые используются для связи условий.
    :::column-end:::
    :::column:::
        [!code-vb[Main](introducing-razor-syntax-vb/samples/sample38.vb)]
    :::column-end:::
:::row-end:::

## <a name="working-with-file-and-folder-paths-in-code"></a>Работа с путями к файлам и папкам в коде

Вы часто работаете с путями к файлам и папкам в коде. Ниже приведен пример структуры физической папки для веб-сайта, который может отображаться на компьютере разработчика.

`C:\WebSites\MyWebSite default.cshtml datafile.txt \images Logo.jpg \styles Styles.css`

Ниже приведены некоторые основные сведения о URL-адресах и путях.

- URL-адрес начинается с доменного имени (`http://www.example.com`) или имени сервера (`http://localhost`, `http://mycomputer`).
- URL-адрес соответствует физическому пути на главном компьютере. Например, `http://myserver` может соответствовать папке *к:\вебситес\мивебсите* на сервере.
- Виртуальный путь является краткой для представления путей в коде без указания полного пути. Он включает часть URL-адреса, следующую за именем домена или сервера. При использовании виртуальных путей можно переместить код в другой домен или сервер без необходимости обновлять пути.

Ниже приведен пример, который поможет понять различия:

| Полный URL-адрес | `http://mycompanyserver/humanresources/CompanyPolicy.htm` |
| --- | --- |
| Имя сервера | *микомпанисервер* |
| Виртуальный путь | */humanresources/CompanyPolicy.htm* |
| Физический путь | *к:\мивебситес\хуманресаурцес\компаниполици.хтм* |

Виртуальный корень имеет значение/, как и корневой каталог диска C: \. (Пути к виртуальным папкам всегда используют косую черту.) Виртуальный путь к папке не должен совпадать с именем физической папки. Это может быть псевдоним. (На рабочих серверах виртуальный путь редко соответствует точному физическому пути.)

При работе с файлами и папками в коде иногда требуется ссылка на физический путь и иногда виртуальный путь в зависимости от объектов, с которыми вы работаете. ASP.NET предоставляет следующие средства для работы с путями к файлам и папкам в коде: метод `Server.MapPath`, оператор `~` и метод `Href`.

### <a name="converting-virtual-to-physical-paths-the-servermappath-method"></a>Преобразование виртуальных в физические пути: метод Server. MapPath

Метод `Server.MapPath` Преобразует виртуальный путь (например, */дефаулт.кштмл*) в абсолютный физический путь (например, *к:\вебситес\мивебситефолдер\дефаулт.кштмл*). Этот метод используется в любой момент, когда требуется полный физический путь. Типичный пример — при чтении или записи текстового файла или файла изображения на веб-сервере.

Как правило, абсолютный физический путь к сайту на сервере узла размещения не известен, поэтому этот метод может преобразовать известный путь (виртуальный путь) в соответствующий путь на сервере. Виртуальный путь передается в файл или папку в метод и возвращает физический путь:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample39.vbhtml)]

### <a name="referencing-the-virtual-root-the--operator-and-href-method"></a>Ссылка на виртуальный корень: оператор ~ и метод href

В файле *. cshtml* или *. vbhtml* можно ссылаться на виртуальный корневой путь с помощью оператора `~`. Это очень удобно, так как можно перемещать страницы на сайте и любые ссылки, содержащиеся на других страницах, не будут разорваны. Это также удобно, если вы перемещаете веб-сайт в другое место. Ниже приведены некоторые примеры:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample40.vbhtml)]

Если веб-сайт `http://myserver/myapp`, то, как ASP.NET будет обрабатывать эти пути при выполнении страницы:

- `myImagesFolder`: `http://myserver/myapp/images`
- `myStyleSheet` : `http://myserver/myapp/styles/Stylesheet.css`

(В действительности эти пути не отображаются как значения переменной, но ASP.NET будет рассматривать пути так, как будто они были.)

Оператор `~` можно использовать как в коде сервера (как описано выше), так и в разметке следующим образом:

[!code-html[Main](introducing-razor-syntax-vb/samples/sample41.html)]

В разметке оператор `~` используется для создания путей к ресурсам, таким как файлы изображений, другие веб-страницы и файлы CSS. При запуске страницы ASP.NET просматривает страницу (как код, так и разметку) и разрешает все `~` ссылки на соответствующий путь.

## <a name="conditional-logic-and-loops"></a>Условная логика и циклы

ASP.NET Server Code позволяет выполнять задачи на основе условий и писать код, который повторяет инструкции определенное число раз, то есть код, выполняющий цикл.

### <a name="testing-conditions"></a>Условия тестирования

Чтобы проверить простое условие, используйте инструкцию `If...Then`, которая возвращает `True` или `False` на основе указанного теста:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample42.vbhtml)]

Ключевое слово `If` запускает блок. Фактический тест (условие) следует за ключевым словом `If` и возвращает true или false. Оператор `If` заканчивается `Then`. Инструкции, которые будут выполняться, если тест имеет значение true, заключаются в `If` и `End If`. Инструкция `If` может включать блок `Else`, указывающий, какие операторы выполняются, если условие ложно:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample43.vbhtml)]

Если оператор `If` запускает блок кода, для включения блоков не нужно использовать обычные операторы `Code...End Code`. Можно просто добавить `@` в блок, и он будет работать. Этот подход работает с `If`, а также с другими Visual Basic ключевыми словами программирования, за которыми следуют блоки кода, включая `For`, `For Each`, `Do While`и т. д.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample44.vbhtml)]

Можно добавить несколько условий с помощью одного или нескольких блоков `ElseIf`:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample45.vbhtml)]

В этом примере, если первое условие в блоке `If` не равно true, проверяется `ElseIf` условие. Если это условие выполнено, выполняются инструкции в блоке `ElseIf`. Если ни одно из условий не соблюдается, выполняются инструкции в блоке `Else`. Можно добавить любое количество блоков `ElseIf`, а затем закрыть блок `Else` как &quot;все остальное&quot; условие.

Чтобы проверить большое количество условий, используйте блок `Select Case`:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample46.vbhtml)]

Проверяемое значение находится в круглых скобках (в примере это переменная Weekday). Каждый отдельный тест использует инструкцию `Case`, в которой содержится значение. Если значение инструкции `Case` соответствует тестовому значению, выполняется код в этом блоке `Case`.

Результат двух последних условных блоков, отображаемых в браузере:

![Razor — Img10](introducing-razor-syntax-vb/_static/image10.jpg)

### <a name="looping-code"></a>Циклическое выполнение кода

Часто приходится многократно выполнять одни и те же инструкции. Для этого нужно выполнить цикл. Например, часто выполняются одни и те же инструкции для каждого элемента в коллекции данных. Если точно известно, сколько раз вы хотите пройти цикл, можно использовать цикл `For`. Этот тип цикла особенно полезен для подсчета или пересчета:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample47.vbhtml)]

Цикл начинается с ключевого слова `For`, за которым следуют три элемента:

- Сразу после оператора `For` объявляется переменная счетчика (не нужно использовать `Dim`), а затем указывается диапазон, как в `i = 10 to 20`. Это означает, что переменная `i` начнет подсчитаться 10 и продолжить до 20 (включительно).
- Между операторами `For` и `Next` является содержимым блока. Может содержать один или несколько инструкций кода, выполняемых с каждым циклом.
- Оператор `Next i` завершает цикл. Он увеличивает счетчик и запускает следующую итерацию цикла.

Строка кода между строками `For` и `Next` содержит код, который выполняется для каждой итерации цикла. Разметка создает новый абзац (`<p>` элемент) каждый раз и добавляет строку к выходу, отображая значение i (счетчик). При запуске этой страницы в примере создаются 11 строк, в которых отображаются выходные данные, и текст в каждой строке, указывающей на номер товара.

![Razor — Img11](introducing-razor-syntax-vb/_static/image11.jpg)

При работе с коллекцией или массивом часто используется цикл `For Each`. Коллекция — это группа схожих объектов, а цикл `For Each` позволяет выполнять задачу для каждого элемента в коллекции. Этот тип цикла удобен для коллекций, так как в отличие от цикла `For` не нужно увеличивать счетчик или устанавливать ограничение. Вместо этого код цикла `For Each` просто проходит по коллекции, пока не завершится.

Этот пример возвращает элементы коллекции `Request.ServerVariables` (которая содержит сведения о веб-сервере). Он использует цикл `For Each` для вывода имени каждого элемента путем создания нового элемента `<li>` в маркированном списке HTML.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample48.vbhtml)]

За ключевым словом `For Each` следует переменная, представляющая один элемент в коллекции (в примере, `myItem`), за которой следует ключевое слово `In`, а затем Коллекция, которую необходимо прокручивать. В теле цикла `For Each` можно получить доступ к текущему элементу с помощью объявленной ранее переменной.

![Razor — Img12](introducing-razor-syntax-vb/_static/image12.jpg)

Чтобы создать более общий цикл общего назначения, используйте оператор `Do While`:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample49.vbhtml)]

Этот цикл начинается с ключевого слова `Do While`, за которым следует условие, за которым следует блок, который необходимо повторить. Циклы обычно увеличивают (добавляются в) или уменьшают (вычитаются из) переменную или объект, используемый для подсчета. В этом примере оператор `+=` добавляет 1 к значению переменной при каждом запуске цикла. (Чтобы уменьшить переменную в цикле, который подсчитывается вниз, используйте оператор декремента `-=`.)

## <a name="objects-and-collections"></a>Объекты и коллекции

Практически все на веб-сайте ASP.NET — это объект, включая саму веб-страницу. В этом разделе обсуждаются некоторые важные объекты, с которыми часто приходится работать в коде.

### <a name="page-objects"></a>Объекты Page

Самым основным объектом в ASP.NET является страница. Вы можете обращаться к свойствам объекта Page напрямую, не используя соответствующий объект. Следующий код получает путь к файлу страницы, используя объект `Request` страницы:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample50.vbhtml)]

Вы можете использовать свойства объекта `Page` для получения большого объема информации, например:

- `Request`. Как уже было показано, это коллекция сведений о текущем запросе, включая тип браузера, который сделал запрос, URL-адрес страницы, удостоверение пользователя и т. д.
- `Response`. Это коллекция сведений о ответе (странице), которая будет отправлена в браузер после завершения выполнения кода сервера. Например, это свойство можно использовать для записи сведений в ответ.

    [!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample51.vbhtml)]

### <a name="collection-objects-arrays-and-dictionaries"></a>Объекты коллекции (массивы и словари)

Коллекция — это группа объектов одного типа, например коллекция объектов `Customer` из базы данных. ASP.NET содержит множество встроенных коллекций, таких как коллекция `Request.Files`.

Вы часто работаете с данными в коллекциях. Два общих типа коллекций — это *массив* и *словарь*. Массив полезен, если нужно сохранить коллекцию схожих элементов, но не нужно создавать отдельную переменную для хранения каждого элемента:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample52.vbhtml)]

При использовании массивов вы объявляете конкретный тип данных, например `String`, `Integer`или `DateTime`. Чтобы указать, что переменная может содержать массив, добавьте круглые скобки в имя переменной в объявлении (например, `Dim myVar() As String`). Доступ к элементам массива можно получить с помощью их позиции (индекса) или с помощью инструкции `For Each`. Индексы массива отсчитываются от &#8212; нуля, т. е. первый элемент находится в позиции 0, второй элемент — в позиции 1 и т. д.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample53.vbhtml)]

Чтобы определить количество элементов в массиве, можно получить свойство `Length`. Чтобы получить позицию определенного элемента в массиве (то есть для поиска в массиве), используйте метод `Array.IndexOf`. Можно также выполнять такие действия, как обратный порядок содержимого массива (метод `Array.Reverse`) или сортировать содержимое (метод `Array.Sort`).

Выходные данные кода массива строк, отображаемого в браузере:

![Razor — Img13](introducing-razor-syntax-vb/_static/image13.jpg)

Словарь — это коллекция пар "ключ-значение", где вы предоставляете ключ (или имя) для установки или получения соответствующего значения:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample54.vbhtml)]

Чтобы создать словарь, используйте ключевое слово `New`, чтобы указать, что создается новый объект `Dictionary`. Можно назначить словарь переменной с помощью ключевого слова `Dim`. Типы данных элементов словаря указываются с помощью круглых скобок (`( )`). В конце объявления необходимо добавить еще одну пару круглых скобок, поскольку это фактически метод, создающий новый словарь.

Чтобы добавить элементы в словарь, можно вызвать метод `Add` переменной Dictionary (`myScores` в этом случае), а затем указать ключ и значение. Кроме того, можно использовать круглые скобки для обозначения ключа и выполнить простое назначение, как показано в следующем примере:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample55.vbhtml)]

Чтобы получить значение из словаря, необходимо указать ключ в круглых скобках:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample56.vbhtml)]

## <a name="calling-methods-with-parameters"></a>Вызов методов с параметрами

Как было показано ранее в этой статье, объекты, с которыми Вы запрограммированы, имеют методы. Например, объект `Database` может иметь метод `Database.Connect`. Многие методы также имеют один или несколько параметров. *Параметр* — это значение, передаваемое в метод, чтобы позволить методу завершить свою задачу. Например, рассмотрим объявление метода `Request.MapPath`, который принимает три параметра:

[!code-vb[Main](introducing-razor-syntax-vb/samples/sample57.vb)]

Этот метод возвращает физический путь на сервере, соответствующий указанному виртуальному пути. Три параметра для метода: `virtualPath`, `baseVirtualDir`и `allowCrossAppMapping`. (Обратите внимание, что в объявлении указаны параметры с типами данных, которые они будут принимать.) При вызове этого метода необходимо указать значения для всех трех параметров.

Если вы используете Visual Basic с синтаксис Razor, у вас есть два варианта передачи параметров в метод: *позиционированные параметры* или *именованные параметры*. Чтобы вызвать метод с помощью методов с параметрами, необходимо передать параметры в определенном порядке, указанном в объявлении метода. (Обычно этот порядок вы узнаете, читая документацию по методу.) Необходимо следовать указанному порядку, и при необходимости пропустить какие-либо &#8212; параметры, передается пустая строка (`""`) или значение NULL для параметра позиционирования, для которого у вас нет значения.

В следующем примере предполагается, что на веб-сайте есть папка с именем *Scripts* . Код вызывает метод `Request.MapPath` и передает значения для трех параметров в правильном порядке. Затем отображается полученный сопоставленный путь.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample58.vbhtml)]

Если для метода имеется много параметров, можно защитить код и сделать его более удобочитаемым с помощью именованных параметров. Чтобы вызвать метод с использованием именованных параметров, укажите имя параметра, а затем `:=`, а затем укажите значение. Преимущество именованных параметров заключается в том, что их можно добавлять в любом порядке. (Недостаток заключается в том, что вызов метода не является компактным.)

В следующем примере вызывается тот же метод, что и выше, но для предоставления значений используются именованные параметры:

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample59.vbhtml)]

Как видите, параметры передаются в другом порядке. Однако если запустить предыдущий пример и этот пример, они будут возвращать одно и то же значение.

## <a name="handling-errors"></a>Обработка ошибок

### <a name="try-catch-statements"></a>Операторы Try-Catch

Часто в коде есть операторы, которые могут завершиться ошибкой по причинам, находящимся за пределами элемента управления. Пример:

- Если код пытается открыть, создать, прочитать или записать файл, могут возникать все виды ошибок. Возможно, нужный файл не существует, он может быть заблокирован, код может не иметь разрешений и т. д.
- Аналогично, если код пытается обновить записи в базе данных, могут возникнуть проблемы с разрешениями, подключение к базе данных может быть удалено, данные для сохранения могут быть недействительными и т. д.

В терминах программирования эти ситуации называются *исключениями*. Если код встречает исключение, он создает (выдает) сообщение об ошибке, которое, в лучшем случае, неудобно для пользователей.

![Razor — Img14](introducing-razor-syntax-vb/_static/image14.jpg)

В ситуациях, когда код может столкнуться с исключениями и во избежание сообщений об ошибках этого типа, можно использовать инструкции `Try/Catch`. В инструкции `Try` выполняется проверка кода. В одной или нескольких инструкциях `Catch` можно найти определенные ошибки (определенные типы исключений), которые могли произойти. Можно включить столько `Catch` инструкций, сколько необходимо для поиска ожидаемых ошибок.

> [!NOTE]
> Рекомендуется избегать использования метода `Response.Redirect` в инструкциях `Try/Catch`, так как это может вызвать исключение на странице.

В следующем примере показана страница, которая создает текстовый файл при первом запросе, а затем отображает кнопку, которая позволяет пользователю открыть файл. В этом примере преднамеренно используется неправильное имя файла, что вызовет исключение. Код включает `Catch` операторы для двух возможных исключений: `FileNotFoundException`, которое происходит, если имя файла является недопустимым, и `DirectoryNotFoundException`, что происходит, если ASP.NET даже не может найти папку. (Чтобы увидеть, как она работает, когда все работает правильно, можно убрать комментарий к оператору в этом примере.)

Если код не обработал исключение, появится страница ошибки, как на предыдущем снимке экрана. Однако раздел `Try/Catch` помогает предотвратить возникновение ошибок такого типа.

[!code-vbhtml[Main](introducing-razor-syntax-vb/samples/sample60.vbhtml)]

## <a name="additional-resources"></a>Дополнительные ресурсы

### <a name="reference-documentation"></a>Справочная документация

- [ASP.NET](https://msdn.microsoft.com/library/ee532866.aspx)
- [Язык Visual Basic](https://msdn.microsoft.com/library/2x7h1hfk.aspx)
