---
uid: web-pages/overview/getting-started/11-adding-email-to-your-web-site
title: Отправка электронной почты с веб-ASP.NET страниц узла (Razor) | Документация Майкрософт
author: Rick-Anderson
description: В этой главе объясняется, как отправить сообщение по электронной почте с веб-сайта.
ms.author: riande
ms.date: 02/20/2014
ms.assetid: fc49bcb9-f1a9-4048-8c3f-b60951853200
msc.legacyurl: /web-pages/overview/getting-started/11-adding-email-to-your-web-site
msc.type: authoredcontent
ms.openlocfilehash: 0263f736b96f8e8572536f3783d86c261d7c0512
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59411232"
---
# <a name="sending-email-from-an-aspnet-web-pages-razor-site"></a><span data-ttu-id="f0dc8-103">Отправка сообщения электронной почты с сайта ASP.NET Web Pages (Razor)</span><span class="sxs-lookup"><span data-stu-id="f0dc8-103">Sending Email from an ASP.NET Web Pages (Razor) Site</span></span>

<span data-ttu-id="f0dc8-104">по [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="f0dc8-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="f0dc8-105">В этой статье объясняется, как отправлять сообщения электронной почты из веб-сайта, при использовании веб-страниц ASP.NET (Razor).</span><span class="sxs-lookup"><span data-stu-id="f0dc8-105">This article explains how to send an email message from a website when you use ASP.NET Web Pages (Razor).</span></span>
> 
> <span data-ttu-id="f0dc8-106">Вы узнаете, как:</span><span class="sxs-lookup"><span data-stu-id="f0dc8-106">What you'll learn:</span></span>
> 
> - <span data-ttu-id="f0dc8-107">Как отправлять сообщения электронной почты с веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-107">How to send an email message from your website.</span></span>
> - <span data-ttu-id="f0dc8-108">Как добавить файл в сообщение электронной почты.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-108">How to attach a file to an email message.</span></span>
> 
> <span data-ttu-id="f0dc8-109">Это функция ASP.NET, впервые представленная в этой статье:</span><span class="sxs-lookup"><span data-stu-id="f0dc8-109">This is the ASP.NET feature introduced in the article:</span></span>
> 
> - <span data-ttu-id="f0dc8-110">`WebMail` Вспомогательный.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-110">The `WebMail` helper.</span></span>
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="f0dc8-111">Версии программного обеспечения, используемые в этом руководстве</span><span class="sxs-lookup"><span data-stu-id="f0dc8-111">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="f0dc8-112">Веб-страниц ASP.NET (Razor) 3</span><span class="sxs-lookup"><span data-stu-id="f0dc8-112">ASP.NET Web Pages (Razor) 3</span></span>
>   
> 
> <span data-ttu-id="f0dc8-113">Этот учебник также работает с ASP.NET Web Pages 2.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-113">This tutorial also works with ASP.NET Web Pages 2.</span></span>


<a id="Sending_Email_Messages"></a>
## <a name="sending-email-messages-from-your-website"></a><span data-ttu-id="f0dc8-114">Отправка сообщений электронной почты с веб-сайта</span><span class="sxs-lookup"><span data-stu-id="f0dc8-114">Sending Email Messages from Your Website</span></span>

<span data-ttu-id="f0dc8-115">Существует множество причин, почему может потребоваться отправка электронной почты с веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-115">There are all sorts of reasons why you might need to send email from your website.</span></span> <span data-ttu-id="f0dc8-116">Может отправить подтверждение для пользователей, или может отправлять уведомления для себя (например, что новый пользователь зарегистрировал.) `WebMail` Вспомогательный упрощает для отправки электронной почты.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-116">You might send confirmation messages to users, or you might send notifications to yourself (for example, that a new user has registered.) The `WebMail` helper makes it easy for you to send email.</span></span>

<span data-ttu-id="f0dc8-117">Чтобы использовать `WebMail` вспомогательного приложения, у вас есть доступ к SMTP-сервер.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-117">To use the `WebMail` helper, you have to have access to an SMTP server.</span></span> <span data-ttu-id="f0dc8-118">(Расшифровывается SMTP *протокол SMTP*.) SMTP-сервер — это почтовый сервер, который только перенаправляет сообщения на сервер получателя &#8212; сторона исходящие сообщения электронной почты.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-118">(SMTP stands for *Simple Mail Transfer Protocol*.) An SMTP server is an email server that only forwards messages to the recipient's server &#8212; it's the outbound side of email.</span></span> <span data-ttu-id="f0dc8-119">При использовании поставщика услуг размещения для веб-сайта, они, скорее всего, настраивается по электронной почте, и они расскажем вам, что такое имя сервера SMTP.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-119">If you use a hosting provider for your website, they probably set you up with email and they can tell you what your SMTP server name is.</span></span> <span data-ttu-id="f0dc8-120">Если вы работаете в корпоративной сети, администратор или ваш ИТ-отдел обычно обеспечивает сведения о SMTP-сервер, который можно использовать.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-120">If you're working inside a corporate network, an administrator or your IT department can usually give you the information about an SMTP server that you can use.</span></span> <span data-ttu-id="f0dc8-121">Если вы работаете дома, вы даже можно протестировать с помощью поставщика обычные электронной почты, который можно сообщить имя SMTP-сервера.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-121">If you're working at home, you might even be able to test using your ordinary email provider, who can tell you the name of their SMTP server.</span></span> <span data-ttu-id="f0dc8-122">Обычно нужно:</span><span class="sxs-lookup"><span data-stu-id="f0dc8-122">You typically need:</span></span>

- <span data-ttu-id="f0dc8-123">Имя SMTP-сервера.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-123">The name of the SMTP server.</span></span>
- <span data-ttu-id="f0dc8-124">Номер порта.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-124">The port number.</span></span> <span data-ttu-id="f0dc8-125">Это почти всегда 25.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-125">This is almost always 25.</span></span> <span data-ttu-id="f0dc8-126">Тем не менее поставщик услуг Интернета может потребоваться использовать порт 587.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-126">However, your ISP may require you to use port 587.</span></span> <span data-ttu-id="f0dc8-127">Если вы используете протокол SSL (SSL) для электронной почты, может потребоваться другой порт.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-127">If you are using secure sockets layer (SSL) for email, you might need a different port.</span></span> <span data-ttu-id="f0dc8-128">Обратитесь к поставщику услуг электронной почты.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-128">Check with your email provider.</span></span>
- <span data-ttu-id="f0dc8-129">Учетные данные (имя пользователя, пароль).</span><span class="sxs-lookup"><span data-stu-id="f0dc8-129">Credentials (user name, password).</span></span>

<span data-ttu-id="f0dc8-130">В этой процедуре вы создадите две страницы.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-130">In this procedure, you create two pages.</span></span> <span data-ttu-id="f0dc8-131">Первая страница содержит форму, которая позволяет пользователям вводить описание, как если бы они заполнив форму технической поддержки.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-131">The first page has a form that lets users enter a description, as if they were filling in a technical-support form.</span></span> <span data-ttu-id="f0dc8-132">Первая страница отправляет данные на вторую страницу.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-132">The first page submits its information to a second page.</span></span> <span data-ttu-id="f0dc8-133">На второй странице код извлекает сведения о пользователе и отправляет сообщение электронной почты.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-133">In the second page, code extracts the user's information and sends an email message.</span></span> <span data-ttu-id="f0dc8-134">Она также отображает сообщение с подтверждением, что получен отчет о проблеме.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-134">It also displays a message confirming that the problem report has been received.</span></span>

![[изображение]](11-adding-email-to-your-web-site/_static/image1.jpg)

> [!NOTE]
> <span data-ttu-id="f0dc8-136">Для простоты в этом примере, этот код инициализирует `WebMail` вспомогательный справа на странице, где его использовать.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-136">To keep this example simple, the code initializes the `WebMail` helper right in the page where you use it.</span></span> <span data-ttu-id="f0dc8-137">Тем не менее для реальных веб-сайтов, лучше поместить следующий код инициализации в глобальный файл, таким образом, необходимо инициализировать `WebMail` вспомогательный класс для всех файлов в веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-137">However, for real websites, it's a better idea to put initialization code like this in a global file, so that you initialize the `WebMail` helper for all files in your website.</span></span> <span data-ttu-id="f0dc8-138">Дополнительные сведения см. в разделе [поведение Настройка сайта для веб-страниц ASP.NET](https://go.microsoft.com/fwlink/?LinkId=202906#Setting_Values_For_Helpers).</span><span class="sxs-lookup"><span data-stu-id="f0dc8-138">For more information, see [Customizing Site-Wide Behavior for ASP.NET Web Pages](https://go.microsoft.com/fwlink/?LinkId=202906#Setting_Values_For_Helpers).</span></span>


1. <span data-ttu-id="f0dc8-139">Создание нового веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-139">Create a new website.</span></span>
2. <span data-ttu-id="f0dc8-140">Добавьте новую страницу с именем *EmailRequest.cshtml* и добавьте следующую разметку:</span><span class="sxs-lookup"><span data-stu-id="f0dc8-140">Add a new page named *EmailRequest.cshtml* and add the following markup:</span></span> 

    [!code-html[Main](11-adding-email-to-your-web-site/samples/sample1.html)]

    <span data-ttu-id="f0dc8-141">Обратите внимание, что `action` атрибут элемента формы было присвоено *ProcessRequest.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-141">Notice that the `action` attribute of the form element has been set to *ProcessRequest.cshtml*.</span></span> <span data-ttu-id="f0dc8-142">Это означает, что форма будет отправлена на эту страницу, вместо возврата в текущей страницы.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-142">This means that the form will be submitted to that page instead of back to the current page.</span></span>
3. <span data-ttu-id="f0dc8-143">Добавьте новую страницу с именем *ProcessRequest.cshtml* на веб-сайт и добавьте следующий код и разметки:</span><span class="sxs-lookup"><span data-stu-id="f0dc8-143">Add a new page named *ProcessRequest.cshtml* to the website and add the following code and markup:</span></span>   

    [!code-cshtml[Main](11-adding-email-to-your-web-site/samples/sample2.cshtml)]

    <span data-ttu-id="f0dc8-144">В коде получить значения поля формы, которые были переданы на страницу.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-144">In the code, you get the values of the form fields that were submitted to the page.</span></span> <span data-ttu-id="f0dc8-145">Затем можно вызвать `WebMail` вспомогательного приложения `Send` метод для создания и отправки сообщения электронной почты.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-145">You then call the `WebMail` helper's `Send` method to create and send the email message.</span></span> <span data-ttu-id="f0dc8-146">В этом случае значения, используемые состоят из текст, который вы можете сцеплять со значениями, которые были переданы из формы.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-146">In this case, the values to use are made up of text that you concatenate with the values that were submitted from the form.</span></span>

    <span data-ttu-id="f0dc8-147">Код для этой страницы находится внутри `try/catch` блока.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-147">The code for this page is inside a `try/catch` block.</span></span> <span data-ttu-id="f0dc8-148">Если для какой-либо причине попытка отправить сообщение электронной почты не работает (например, параметры не требуются справа), код в `catch` блок выполняется и задает `errorMessage` переменной о возникшей ошибке.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-148">If for any reason the attempt to send an email doesn't work (for example, the settings aren't right), the code in the `catch` block runs and sets the `errorMessage` variable to the error that has occurred.</span></span> <span data-ttu-id="f0dc8-149">(Дополнительные сведения о `try/catch` блоки или `<text>` тег, см. в разделе [введение в ASP.NET веб-страниц программирование с использованием синтаксиса Razor](https://go.microsoft.com/fwlink/?LinkID=251587#ID_HandlingErrors).)</span><span class="sxs-lookup"><span data-stu-id="f0dc8-149">(For more information about `try/catch` blocks or the `<text>` tag, see [Introduction to ASP.NET Web Pages Programming Using the Razor Syntax](https://go.microsoft.com/fwlink/?LinkID=251587#ID_HandlingErrors).)</span></span>

    <span data-ttu-id="f0dc8-150">В основной области страницы Если `errorMessage` переменная пуста (по умолчанию), пользователь видит сообщение, которое было отправлено сообщение электронной почты.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-150">In the body of the page, if the `errorMessage` variable is empty (the default), the user sees a message that the email message has been sent.</span></span> <span data-ttu-id="f0dc8-151">Если `errorMessage` переменной присвоено значение true, который пользователь видит сообщение, что возникла ошибка при отправке сообщения.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-151">If the `errorMessage` variable is set to true, the user sees a message that there's been a problem sending the message.</span></span>

    <span data-ttu-id="f0dc8-152">Обратите внимание, что в области страницы, которая отображает сообщение об ошибке, дополнительной проверки: `if(debuggingFlag)`.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-152">Notice that in the portion of the page that displays an error message, there's an additional test: `if(debuggingFlag)`.</span></span> <span data-ttu-id="f0dc8-153">Это переменная, которое можно задать значение true, если возникают проблемы при отправке сообщения электронной почты.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-153">This is a variable that you can set to true if you're having trouble sending email.</span></span> <span data-ttu-id="f0dc8-154">Когда `debuggingFlag` имеет значение true, и есть ли ошибка при отправке электронной почты, отображается сообщение об ошибке дополнительные, показывающее, все, что при попытке отправить сообщение электронной почты сообщает ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-154">When `debuggingFlag` is true, and if there's a problem sending email, an additional error message is displayed that shows whatever ASP.NET has reported when it tried to send the email message.</span></span> <span data-ttu-id="f0dc8-155">Равномерное предупреждение, однако: сообщения об ошибках, которые ASP.NET выдает сообщение, если оно не может отправлять сообщения электронной почты могут быть универсальными.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-155">Fair warning, though: the error messages that ASP.NET reports when it can't send an email message can be generic.</span></span> <span data-ttu-id="f0dc8-156">Например если ASP.NET не удается связаться с SMTP-сервера (например, из-за ошибки в имени сервера), ошибка `Failure sending mail`.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-156">For example, if ASP.NET can't contact the SMTP server (for example, because you made an error in the server name), the error is `Failure sending mail`.</span></span>

    > [!NOTE] 
    > 
    > <span data-ttu-id="f0dc8-157">**Важные** при получении сообщения об ошибке из объекта исключения (`ex` в коде), выполните *не* регулярно передать это сообщение по пользователям.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-157">**Important** When you get an error message from an exception object (`ex` in the code), do *not* routinely pass that message through to users.</span></span> <span data-ttu-id="f0dc8-158">Объекты исключения часто содержат сведения, пользователи не должны видеть и, даже к уязвимости системы безопасности.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-158">Exception objects often include information that users should not see and that can even be a security vulnerability.</span></span> <span data-ttu-id="f0dc8-159">Вот почему этот код содержит переменную `debuggingFlag` , используемый как переключатель отображение сообщений об ошибках, почему переменной по умолчанию имеет значение false.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-159">That's why this code includes the variable `debuggingFlag` that's used as a switch to display the error message, and why the variable by default is set to false.</span></span> <span data-ttu-id="f0dc8-160">Следует задавать эту переменную, равным true (и следовательно, будут отображаться сообщение об ошибке) *только* при возникновении проблемы с отправкой электронной почты и необходимо выполнить отладку.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-160">You should set that variable to true (and therefore display the error message) *only* if you're having a problem with sending email and you need to debug.</span></span> <span data-ttu-id="f0dc8-161">После устранения проблемы задайте `debuggingFlag` обратно в значение false.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-161">Once you have fixed any problems, set `debuggingFlag` back to false.</span></span>

    <span data-ttu-id="f0dc8-162">Изменить связанные параметры в коде, электронной почты следующее:</span><span class="sxs-lookup"><span data-stu-id="f0dc8-162">Modify the following email related settings in the code:</span></span>

   - <span data-ttu-id="f0dc8-163">Задайте `your-SMTP-host` имя SMTP-сервера, у вас есть доступ к.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-163">Set `your-SMTP-host` to the name of the SMTP server that you have access to.</span></span>
   - <span data-ttu-id="f0dc8-164">Задайте `your-user-name-here` имени пользователя для учетной записи сервера SMTP.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-164">Set `your-user-name-here` to the user name for your SMTP server account.</span></span>
   - <span data-ttu-id="f0dc8-165">Задайте `your-account-password` на пароль для учетной записи сервера SMTP.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-165">Set `your-account-password` to the password for your SMTP server account.</span></span>
   - <span data-ttu-id="f0dc8-166">Задайте `your-email-address-here` на адрес электронной почты.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-166">Set `your-email-address-here` to your own email address.</span></span> <span data-ttu-id="f0dc8-167">Это адрес электронной почты, которые отправляются сообщения.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-167">This is the email address that the message is sent from.</span></span> <span data-ttu-id="f0dc8-168">(Некоторые поставщики электронной почты не позволяют задать другой `From` адресов и будет использовать имя пользователя как `From` адрес.)</span><span class="sxs-lookup"><span data-stu-id="f0dc8-168">(Some email providers don't let you specify a different `From` address and will use your user name as the `From` address.)</span></span>

     > [!TIP] 
     > 
     > <a id="configuring_email_settings"></a>
     > ### <a name="configuring-email-settings"></a><span data-ttu-id="f0dc8-169">Настройка параметров электронной почты</span><span class="sxs-lookup"><span data-stu-id="f0dc8-169">Configuring Email Settings</span></span>
     > 
     > <span data-ttu-id="f0dc8-170">Он может быть сложной задачей, иногда для того, чтобы убедиться в том, что у вас есть нужные параметры для SMTP-сервера, номер порта и т. д.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-170">It can be a challenge sometimes to make sure you have the right settings for the SMTP server, port number, and so on.</span></span> <span data-ttu-id="f0dc8-171">Несколько советов:</span><span class="sxs-lookup"><span data-stu-id="f0dc8-171">Here are a few tips:</span></span>
     > 
     > - <span data-ttu-id="f0dc8-172">Имя SMTP-сервера часто выглядит примерно так `smtp.provider.com` или `smtp.provider.net`.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-172">The SMTP server name is often something like `smtp.provider.com` or `smtp.provider.net`.</span></span> <span data-ttu-id="f0dc8-173">Однако если вы публикуете веб-узла поставщика услуг размещения, имя SMTP-сервера на этом этапе может быть `localhost`.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-173">However, if you publish your site to a hosting provider, the SMTP server name at that point might be `localhost`.</span></span> <span data-ttu-id="f0dc8-174">Это обусловлено тем, после того как вы опубликовали и ваш сайт работает на сервере поставщика, сервера электронной почты может быть локальным с точки зрения приложения.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-174">This is because after you've published and your site is running on the provider's server, the email server might be local from the perspective of your application.</span></span> <span data-ttu-id="f0dc8-175">Это изменение в имена серверов могут означать, что необходимо изменить имя SMTP-сервера как часть процесс публикации.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-175">This change in server names might mean you have to change the SMTP server name as part of your publishing process.</span></span>
     > - <span data-ttu-id="f0dc8-176">Номер порта, обычно — 25.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-176">The port number is usually 25.</span></span> <span data-ttu-id="f0dc8-177">Тем не менее некоторые поставщики требуют использовать порт 587 или некоторых других портов.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-177">However, some providers require you to use port 587 or some other port.</span></span>
     > - <span data-ttu-id="f0dc8-178">Убедитесь, что используется правильные учетные данные.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-178">Make sure that you use the right credentials.</span></span> <span data-ttu-id="f0dc8-179">Если вы опубликовали свой сайт у поставщика услуг размещения, используйте учетные данные, которые поставщик указал специально предназначены для электронной почты.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-179">If you've published your site to a hosting provider, use the credentials that the provider has specifically indicated are for email.</span></span> <span data-ttu-id="f0dc8-180">Это может отличаться от учетных данных, используемых для публикации.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-180">These might be different from the credentials you use to publish.</span></span>
     > - <span data-ttu-id="f0dc8-181">Иногда вообще не требуются учетные данные.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-181">Sometimes you don't need credentials at all.</span></span> <span data-ttu-id="f0dc8-182">При отправке электронной почты с помощью ваш поставщик услуг Интернета, поставщика электронной почты могут уже знать свои учетные данные.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-182">If you're sending email using your personal ISP, your email provider might already know your credentials.</span></span> <span data-ttu-id="f0dc8-183">После публикации, может потребоваться использовать другие учетные данные, чем при тестировании на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-183">After you publish, you might need to use different credentials than when you test on your local computer.</span></span>
     > - <span data-ttu-id="f0dc8-184">Если поставщика электронной почты использует шифрование, необходимо установить `WebMail.EnableSsl` для `true`.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-184">If your email provider uses encryption, you have to set `WebMail.EnableSsl` to `true`.</span></span>
4. <span data-ttu-id="f0dc8-185">Запустите *EmailRequest.cshtml* страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-185">Run the *EmailRequest.cshtml* page in a browser.</span></span> <span data-ttu-id="f0dc8-186">(Убедитесь, что выбран страницы **файлы** рабочей области, прежде чем запускать его.)</span><span class="sxs-lookup"><span data-stu-id="f0dc8-186">(Make sure the page is selected in the **Files** workspace before you run it.)</span></span>
5. <span data-ttu-id="f0dc8-187">Введите свое имя и описание проблемы, а затем нажмите кнопку **отправить** кнопки.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-187">Enter your name and a problem description, and then click the **Submit** button.</span></span> <span data-ttu-id="f0dc8-188">Вы будете перенаправлены *ProcessRequest.cshtml* страницу, подтверждает ваше сообщение и который отправляет сообщение электронной почты.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-188">You're redirected to the *ProcessRequest.cshtml* page, which confirms your message and which sends you an email message.</span></span> 

    ![[изображение]](11-adding-email-to-your-web-site/_static/image2.jpg)

<a id="Sending_a_File"></a>
## <a name="sending-a-file-using-email"></a><span data-ttu-id="f0dc8-190">Отправка файла с помощью электронной почты</span><span class="sxs-lookup"><span data-stu-id="f0dc8-190">Sending a File Using Email</span></span>

<span data-ttu-id="f0dc8-191">Вы также можете отправлять файлы, вложенные в сообщения электронной почты.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-191">You can also send files that are attached to email messages.</span></span> <span data-ttu-id="f0dc8-192">В этой процедуре вы создадите к текстовому файлу и две страницы HTML.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-192">In this procedure, you create a text file and two HTML pages.</span></span> <span data-ttu-id="f0dc8-193">Текстовый файл будет использоваться как вложения электронной почты.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-193">You'll use the text file as an email attachment.</span></span>

1. <span data-ttu-id="f0dc8-194">На веб-сайте, добавьте новый текстовый файл и назовите его *MyFile.txt*.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-194">In the website, add a new text file and name it *MyFile.txt*.</span></span>
2. <span data-ttu-id="f0dc8-195">Скопируйте следующий текст и вставьте его в файле:</span><span class="sxs-lookup"><span data-stu-id="f0dc8-195">Copy the following text and paste it in the file:</span></span> 

    `Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.`
3. <span data-ttu-id="f0dc8-196">Создание страницы с именем *SendFile.cshtml* и добавьте следующую разметку:</span><span class="sxs-lookup"><span data-stu-id="f0dc8-196">Create a page named *SendFile.cshtml* and add the following markup:</span></span> 

    [!code-html[Main](11-adding-email-to-your-web-site/samples/sample3.html)]
4. <span data-ttu-id="f0dc8-197">Создание страницы с именем *ProcessFile.cshtml* и добавьте следующую разметку:</span><span class="sxs-lookup"><span data-stu-id="f0dc8-197">Create a page named *ProcessFile.cshtml* and add the following markup:</span></span> 

    [!code-cshtml[Main](11-adding-email-to-your-web-site/samples/sample4.cshtml)]
5. <span data-ttu-id="f0dc8-198">Изменить связанные параметры в коде из примера, электронной почты следующее:</span><span class="sxs-lookup"><span data-stu-id="f0dc8-198">Modify the following email related settings in the code from the example:</span></span>

    - <span data-ttu-id="f0dc8-199">Задайте `your-SMTP-host` имя SMTP-сервера, у вас есть доступ к.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-199">Set `your-SMTP-host` to the name of an SMTP server that you have access to.</span></span>
    - <span data-ttu-id="f0dc8-200">Задайте `your-user-name-here` имени пользователя для учетной записи сервера SMTP.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-200">Set `your-user-name-here` to the user name for your SMTP server account.</span></span>
    - <span data-ttu-id="f0dc8-201">Задайте `your-email-address-here` на адрес электронной почты.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-201">Set `your-email-address-here` to your own email address.</span></span> <span data-ttu-id="f0dc8-202">Это адрес электронной почты, которые отправляются сообщения.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-202">This is the email address that the message is sent from.</span></span>
    - <span data-ttu-id="f0dc8-203">Задайте `your-account-password` на пароль для учетной записи сервера SMTP.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-203">Set `your-account-password` to the password for your SMTP server account.</span></span>
    - <span data-ttu-id="f0dc8-204">Задайте `target-email-address-here` на адрес электронной почты.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-204">Set `target-email-address-here` to your own email address.</span></span> <span data-ttu-id="f0dc8-205">(Как раньше, вы обычно отправляете сообщение электронной почты другому пользователю, но для тестирования, его можно отправить себе.)</span><span class="sxs-lookup"><span data-stu-id="f0dc8-205">(As before, you'd normally send an email to someone else, but for testing, you can send it to yourself.)</span></span>
6. <span data-ttu-id="f0dc8-206">Запустите *SendFile.cshtml* страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-206">Run the *SendFile.cshtml* page in a browser.</span></span>
7. <span data-ttu-id="f0dc8-207">Введите свое имя, тема и имя вкладываемого файла текста (*MyFile.txt*).</span><span class="sxs-lookup"><span data-stu-id="f0dc8-207">Enter your name, a subject line, and the name of the text file to attach (*MyFile.txt*).</span></span>
8. <span data-ttu-id="f0dc8-208">Нажмите кнопку `Submit`.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-208">Click the `Submit` button.</span></span> <span data-ttu-id="f0dc8-209">Как и раньше, вы будете перенаправлены *ProcessFile.cshtml* страницу, подтверждает ваше сообщение и который отправляет вам сообщение электронной почты с вложенный файл.</span><span class="sxs-lookup"><span data-stu-id="f0dc8-209">As before, you're redirected to the *ProcessFile.cshtml* page, which confirms your message and which sends you an email message with the attached file.</span></span>

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a><span data-ttu-id="f0dc8-210">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="f0dc8-210">Additional Resources</span></span>


- [<span data-ttu-id="f0dc8-211">Руководство по устранению неполадок веб-страниц ASP.NET (Razor)</span><span class="sxs-lookup"><span data-stu-id="f0dc8-211">ASP.NET Web Pages (Razor) Troubleshooting Guide</span></span>](https://go.microsoft.com/fwlink/?LinkId=253001)
- [<span data-ttu-id="f0dc8-212">Протокол SMTP</span><span class="sxs-lookup"><span data-stu-id="f0dc8-212">Simple Mail Transfer Protocol</span></span>](https://msdn.microsoft.com/library/aa480435.aspx)
- [<span data-ttu-id="f0dc8-213">Настройка поведения сайта веб-страниц ASP.NET</span><span class="sxs-lookup"><span data-stu-id="f0dc8-213">Customizing Site-Wide Behavior for ASP.NET Web Pages</span></span>](https://go.microsoft.com/fwlink/?LinkId=202906)
