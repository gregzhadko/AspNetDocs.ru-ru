---
uid: web-pages/overview/security/enabling-login-from-external-sites-in-an-aspnet-web-pages-site
title: Вход с помощью внешних сайтов на веб-ASP.NET страниц узла (Razor) | Документация Майкрософт
author: Rick-Anderson
description: В этой статье объясняется, как выполнить вход на сайт веб-страниц ASP.NET (Razor), с помощью Facebook, Google, Twitter, Yahoo и других сайтов, то есть, как обеспечить поддержку...
ms.author: riande
ms.date: 02/21/2014
ms.assetid: ef852096-a5bf-47b3-9945-125cde065093
msc.legacyurl: /web-pages/overview/security/enabling-login-from-external-sites-in-an-aspnet-web-pages-site
msc.type: authoredcontent
ms.openlocfilehash: 188a9203ba7b04f5a88d0f802f1a05bf35d58d8c
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/01/2019
ms.locfileid: "57045661"
---
<a name="logging-in-using-external-sites-in-an-aspnet-web-pages-razor-site"></a>Вход с помощью внешних сайтов на сайте ASP.NET Web Pages (Razor)
====================
по [Tom FitzMacken](https://github.com/tfitzmac)

> В этой статье объясняется, как выполнить вход на сайт веб-страниц ASP.NET (Razor), с помощью Facebook, Google, Twitter, Yahoo и других сайтов, то есть как для поддержки OAuth и OpenID в веб-узла.
> 
> Вы узнаете, как:
> 
> - Выполнение входа с другого сайта, если вы используете шаблон начального сайта WebMatrix.
> 
> Это функция ASP.NET, впервые представленная в этой статье:
> 
> - `OAuthWebSecurity` Вспомогательный.
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a>Версии программного обеспечения, используемые в этом руководстве
> 
> 
> - Веб-страниц ASP.NET (Razor) 2
> - WebMatrix 3

Веб-страниц ASP.NET включает в себя поддержку [OAuth](http://oauth.net/) и [OpenID](http://openid.net/) поставщиков. С помощью этих поставщиков, вы можете разрешить пользователям входить на сайт, с помощью существующих учетных данных из Facebook, Twitter, Майкрософт и Google. Например чтобы войти с использованием учетной записи Facebook, пользователей можно выбрать значок Facebook, который перенаправляет их на страницу входа Facebook, где они ввести учетные данные. Они затем можно связать имя входа Facebook со своей учетной записью на узле. Улучшение функций членства веб-страницы – что пользователи могут связать несколько попыток входа (в том числе имена входа из сетевых сообществ) с одной учетной записи на веб-сайте.

На этом изображении показаны на страницу входа из **начального сайта** шаблон, где пользователь может выбрать значок, Facebook, Twitter, Google или Microsoft, чтобы включить ведение журнала с помощью учетной записи внешнего:

![внешних поставщиков](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/_static/image1.png)

Вы можете включить членством, OAuth и OpenID, раскомментировав несколько строк кода в **начального сайта** шаблона. Методы и свойства, которые позволяют работать с OAuth и OpenID поставщики находятся в `WebMatrix.Security.OAuthWebSecurity` класса. **Начального сайта** шаблон включает инфраструктуру полнофункционального членства, дополненный страницу входа, базы данных членства и весь код, вам нужно разрешить пользователям входить на сайт, с помощью локальных учетных данных или из другого сайта .

В этом разделе приведен пример того, как для входа с внешних сайтов с сайтом на основе пользователей **начального сайта** шаблона. После создания начального сайта, это сделать (выполните сведения):

- Для узлов, которые используют поставщик OAuth (Facebook, Twitter и Майкрософт) создать приложение на внешний сайт. Это дает ключи приложений, которая потребуется для вызова функции login для этих сайтов.
- Для сайтов, использующих поставщик OpenID (Google) у вас нет для создания приложения. Для всех этих узлов необходимо настроить учетную запись для входа в систему и создавать приложения для разработчиков.

    > [!NOTE]
    > Приложения Майкрософт принимать динамический URL-адрес для работающего веб-сайта, только в том случае, поэтому ее невозможно использовать URL-адрес локального веб-сайта для тестирования имен входа.
- Измените несколько файлов в веб-сайта, чтобы указать поставщика проверки подлинности и для отправки имени входа на сайт, который вы хотите использовать.

В этой статье приведены отдельные инструкции для выполнения следующих задач:

- [Включение имен входа Google](#To_enable_Google_logins)
- [Включение имен входа Facebook](#To_enable_Facebook_logins)
- [Включение имен входа Twitter](#To_enable_Twitter_logins)

<a id="To_enable_Google_logins"></a>
## <a name="enabling-google-logins"></a>Включение имен входа Google

1. Создайте или откройте узел веб-страниц ASP.NET, основанный на шаблоне начального сайта WebMatrix.
2. Откройте  *\_AppStart.cshtml* странице и раскомментируйте следующую строку кода. 

    [!code-css[Main](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/samples/sample1.css)]

### <a name="testing-google-login"></a>Тестирование входа Google

1. Запустите *default.cshtml* страницы веб-сайта и выберите **вход** кнопки.
2. На *входа* странице **вход с помощью другой службы** выберите либо **Google** или **Yahoo** кнопка "Отправить". В этом примере используется имя входа Google. 

    Веб-страницы перенаправляет запрос на страницу входа Google.

    ![Вход Google](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/_static/image2.png)
3. Введите учетные данные для существующей учетной записи Google.
4. Если Google спрашивает, хотите ли вы разрешить *Localhost* использовать информацию из учетной записи, нажмите кнопку **Разрешить**.

    Код использует маркер Google для проверки подлинности пользователя и возвращает на эту страницу на веб-сайте. Эта страница позволяет связать их имени для входа Google с существующей учетной записи на веб-сайте, или они могут зарегистрировать новую учетную запись на сайте, чтобы связать внешней учетной записи с.

    ![OAuth-5](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/_static/image3.png)
5. Выберите **связать** кнопки. Браузер возвращается на домашнюю страницу приложения.

<a id="To_enable_Facebook_logins"></a>
## <a name="enabling-facebook-logins"></a>Включение имен входа Facebook

1. Перейдите к [сайт разработчиков Facebook](https://developers.facebook.com/apps) (вход, если вы еще не вошли).
2. Выберите **создать новое приложение** кнопку, а затем следуйте инструкциям на экране, чтобы задать имя и создать новое приложение.
3. В разделе **выберите, каким образом ваше приложение будет интегрировано с Facebook**, выберите **веб-сайт** раздел.
4. Заполните **URL-адрес сайта** с URL-адрес веб-сайта (например, `http://www.example.com`). **Домена** поле является необязательным; это можно использовать для проверки подлинности для всего домена (такие как *example.com*). 

    > [!NOTE]
    > При запуске на локальном компьютере с URL-адрес сайта, такие как `http://localhost:12345` (где номер является номером локального порта), можно добавить это значение, чтобы **URL-адрес сайта** для тестирования веб-узла. Тем не менее, номер порта изменений локального сайта в любое время, вам потребуется обновить **URL-адрес сайта** поле приложения.
5. Выберите **сохранить изменения** кнопки.
6. Выберите **приложений** снова откройте вкладку, а затем просмотрите начальной страницы в приложении.
7. Копировать **идентификатор приложения** и **секрет приложения** значения для вашего приложения и вставьте их в текстовый временный файл. Эти значения к поставщику Facebook передаст в код веб-сайта.
8. Выйдите из сайта разработчика Facebook.

Теперь вы внести изменения две страницы в веб-сайта, чтобы пользователи будут возможность войти на сайт, используя учетные записи Facebook.

1. Создайте или откройте узел веб-страниц ASP.NET, основанный на шаблоне начального сайта WebMatrix.
2. Откройте  *\_AppStart.cshtml* странице и раскомментируйте код для поставщика Facebook OAuth. Блок кода Раскомментировать области кода выглядит следующим образом: 

    [!code-csharp[Main](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/samples/sample2.cs)]
3. Копировать **идентификатор приложения** значение из приложения Facebook в качестве значения `appId` параметра (внутри кавычек).
4. Копировать **секрет приложения** значение из приложения Facebook в качестве `appSecret` значение параметра.
5. Сохраните и закройте файл.

### <a name="testing-facebook-login"></a>Тестирование входа в Facebook

1. Запустите веб-узла *default.cshtml* странице и выбрать **входа** кнопки.
2. На *входа* странице **вход с помощью другой службы** выберите **Facebook** значок. 

    Веб-страницы перенаправляет запрос на страницу входа в Facebook.

    ![OAuth 2](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/_static/image4.png)
3. Войдите в учетную запись Facebook. 

    Код использует маркер Facebook для проверки подлинности и затем возвращается на страницу, где можно связать имя входа Facebook с именем входа веб сайта. Адрес имя или адрес электронной почты пользователя заполняется в **электронной почты** поле в форме.

    ![OAuth-5](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/_static/image5.png)
4. Выберите **связать** кнопки. 

    Браузер возвращается на домашнюю страницу, и вы вошли.

<a id="To_enable_Twitter_logins"></a>
## <a name="enabling-twitter-logins"></a>Включение имен входа Twitter

1. Перейдите к [сайте разработчиков Twitter](https://dev.twitter.com/).
2. Выберите **Создание приложения** ссылку и затем войти на сайт.
3. На **создать приложение** форме, заполните **имя** и **описание** поля.
4. В **веб-сайт** введите URL-адрес веб-сайта (например, `http://www.example.com`). 

    > [!NOTE]
    > Если вы тестируете свой сайт локально (с помощью URL-адресу вида `http://localhost:12345`), URL-адрес может не поддерживать в Twitter. Тем не менее, можно использовать локальный петлевой IP-адрес (например `http://127.0.0.1:12345`). Это упрощает процесс тестирования приложения локально. Тем не менее, при каждом изменении номер порта на локальный сайт, вам потребуется обновить **веб-сайт** поле приложения.
5. В **URL-адрес обратного вызова** введите URL-адрес для страницы в веб-сайта, нужно вернуться после входа в Twitter. Например, чтобы отправить пользователей на домашнюю страницу сайта Starter (который будет распознавать их состояние вошедшего в систему), введите же URL-адрес, введенный в **веб-сайт** поля.
6. Примите условия и выберите **создать приложение Twitter** кнопки.
7. На **Мои приложения** целевой страницы, выберите созданное приложение.
8. На **сведения** вкладке, прокрутите вниз и выберите пункт **создать My Access Token** кнопки.
9. На **сведения** вкладке, скопируйте **ключ потребителя** и **секретный ключ потребителя** значения для вашего приложения и вставьте их в текстовый временный файл. Вы передадите эти значения к поставщику Twitter в коде веб-сайта.
10. Выход на сайте Twitter.

Теперь можно внести изменения две страницы в веб-сайта таким образом, пользователи смогут войти на сайт, с помощью учетной записи Twitter.

1. Создайте или откройте узел веб-страниц ASP.NET, основанный на шаблоне начального сайта WebMatrix.
2. Откройте  *\_AppStart.cshtml* странице и раскомментируйте код для поставщика Twitter OAuth. Блок кода Раскомментировать области кода выглядит следующим образом: 

    [!code-csharp[Main](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/samples/sample3.cs)]
3. Копировать **ключ потребителя** значение из приложения Twitter для параметра `consumerKey` параметр (внутри кавычек).
4. Копировать **секретный ключ потребителя** значение из приложения Twitter для параметра `consumerSecret` параметр.
5. Сохраните и закройте файл.

### <a name="testing-twitter-login"></a>Тестирование входа в Twitter

1. Запустите *default.cshtml* страницы веб-сайта и выберите **входа** кнопки.
2. На *входа* странице **вход с помощью другой службы** выберите **Twitter** значок. 

    Веб-страницы перенаправляет запрос на страницу входа Twitter для приложения, которое вы создали.

    ![OAuth — 4](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/_static/image6.png)
3. Войдите в учетную запись Twitter.
4. Код использует маркер Twitter для проверки подлинности пользователя и последующий возврат к странице где можно связать имя входа с учетной записью веб-сайта. Имя или адрес электронной почты адрес заполняется в **электронной почты** поле в форме.

    ![OAuth-5](enabling-login-from-external-sites-in-an-aspnet-web-pages-site/_static/image7.png)
5. Выберите **связать** кнопки. 

    Браузер возвращается на домашнюю страницу, и вы вошли.

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a>Дополнительные ресурсы


- [Настройка поведения в масштабах сайта](https://go.microsoft.com/fwlink/?LinkId=202906)
- [Добавление безопасности и членства ASP.NET веб-узел страницы](https://go.microsoft.com/fwlink/?LinkID=202904)
