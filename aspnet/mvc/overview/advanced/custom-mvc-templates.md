---
uid: mvc/overview/advanced/custom-mvc-templates
title: Пользовательский шаблон MVC | Документация Майкрософт
author: joeloff
description: Создайте шаблон в виде расширения VSIX.
ms.author: riande
ms.date: 12/10/2012
ms.assetid: b0a214c7-2f38-4dbc-b47f-bd7bd9df97bd
msc.legacyurl: /mvc/overview/advanced/custom-mvc-templates
msc.type: authoredcontent
ms.openlocfilehash: 0603bc24e070e223551813f66a75889a2e46fd35
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59379551"
---
# <a name="custom-mvc-template"></a>Пользовательский шаблон MVC

по [Жак Элоф](https://github.com/joeloff)

В выпуске обновления средств MVC 3 для Visual Studio 2010 появился в мастере отдельных проектов для проектов MVC. Изменение было продиктовано два фактора. Во-первых введение новых шаблонов в MVC 3 и поддержку обработчиков дополнительное представление, таких как Razor привести к overcrowding диалогового окна нового проекта в Visual Studio. Во-вторых клиенты задавали для точек расширения, и мастер создания проекта MVC бы позволить нам возможность ответить на эти запросы.

Добавление пользовательских шаблонов был тягостным процессом, который предполагавшим статическую компоновку с помощью реестра, чтобы отобразить новые шаблоны мастер проекта MVC. Автор шаблона было включите его в MSI-ФАЙЛ, убедитесь, что необходимые записи реестра будут создаваться во время установки. Вместо этого мы хотели сделать файл ZIP, содержащий шаблон, доступный и позволить конечному пользователю вручную создать необходимые записи реестра.

Ни один из описанных подходов идеально, поэтому мы решили использовать некоторые из них существующей инфраструктуры, предоставляемые [VSIX](https://msdn.microsoft.com/library/ff363239.aspx) расширения, чтобы упростить создание и настройка, распространение и устанавливать пользовательские шаблоны MVC, начиная с MVC 4 для Visual Studio 2012. Ниже приведены некоторые преимущества этого подхода.

- Расширение VSIX может содержать несколько шаблонов, поддержка различных языков (C# и Visual Basic) и несколько обработчиков представлений (ASPX и Razor).
- Расширение VSIX можно назначить несколько номеров SKU для Visual Studio, включая Express SKU.
- [Коллекции Visual Studio](https://visualstudiogallery.msdn.microsoft.com/) упрощает распространение расширения для широкой аудитории.
- Это упрощает создание исправлений и обновлений для настраиваемых шаблонов можно обновить расширения VSIX.

## <a name="prerequisites"></a>Предварительные требования

- Пользователи должны быть знакомы с созданием шаблонов проектов, включая необходимые разметка vstemplate-файлы и т. д.
- Пользователям будет необходимо приобрести Visual Studio Professional или более поздней версии. Express SKU не поддерживают создание проекты VSIX.
- [Visual Studio 2012 SDK](https://www.microsoft.com/download/details.aspx?id=30668) установлен.

## <a name="example"></a>Пример

Первым шагом является создание проект VSIX с помощью C# или Visual Basic. Выберите **файл > Новый проект**, затем нажмите кнопку **расширяемости** в левой панели и выберите **проект VSIX**.

![Создание проекта](custom-mvc-templates/_static/image1.jpg)

После создания проект будет открыт конструктор VSIX.

![Метаданные конструктора проектов](custom-mvc-templates/_static/image2.jpg)

Конструктор можно использовать для изменения некоторые общие свойства расширения, которое будет отображаться для пользователей при установке расширения или Обзор установленных расширений в Visual Studio (**Сервис > расширения и обновления**). После завершения щелкните Общие сведения **вкладке цели установки**.

![Целевые объекты установки конструктора проектов](custom-mvc-templates/_static/image3.jpg)

Эта вкладка используется для указания номера SKU и версиях Visual Studio, поддерживаемые расширения. Установите флажок для **этот VSIX устанавливается для всех пользователей** для включения экземпляров на уровне компьютера VSIX. Щелкните **New** кнопку справа, чтобы добавить еще SKU например Express Web Developer (VWD).

![Добавление нового целевого объекта установки](custom-mvc-templates/_static/image4.jpg)

Если планируется поддержка Professional и более поздних версий SKU, (Professional, Premium и Ultimate) необходимо только выбрать минимальный номер SKU в семействе **Microsoft.VisualStudio.Pro**. Не забудьте сохранить все изменения после завершения цели установки.

![Целевые объекты установки конструктора проектов](custom-mvc-templates/_static/image5.jpg)

**Активы** вкладка используется для добавления всех файлов содержимого в файл VSIX. Так как MVC требует пользовательских метаданных будет редактирования необработанные XML-манифеста VSIX-файл вместо использования **активы** tab, чтобы добавить содержимое. Начните с добавления содержимое шаблона проекта VSIX. Очень важно, что структура папок и содержимое отражает проекта. В приведенном ниже примере содержит четыре шаблона проекта, которые были получены на основе базовый шаблон проекта. Убедитесь, что все файлы, которые составляют шаблон проекта (прежним папке Шаблоны_проекта) добавляются **содержимого** itemgroup в VSIX проекта, файл, и что каждый элемент содержит  **CopyToOutputDirectory** и **IncludeInVsix** задать метаданные, как показано в следующем примере.

&lt;Состав содержимого =&quot;ProjectTemplates\MyMvcWebApplicationProjectTemplate.csaspx\BasicWeb.config&quot;&gt;

&lt;CopyToOutputDirectory&gt;всегда&lt;/CopyToOutputDirectory&gt;

&lt;IncludeInVSIX&gt;true&lt;/IncludeInVSIX&gt;

&lt;/ Content&gt;

В противном случае IDE будет пытаться компилировать содержимое шаблона при создании VSIX и скорее всего появится сообщение об ошибке. Файлы кода в шаблонах часто содержат специальные [параметров шаблона](https://msdn.microsoft.com/library/eehb4faa(v=vs.110).aspx) используется в Visual Studio при создании экземпляра шаблона проекта и таким образом, не может быть скомпилирован в интегрированной среде разработки.

![обозреватель решений](custom-mvc-templates/_static/image6.jpg)

Закройте конструктор VSIX, а затем щелкните правой кнопкой мыши **: source.extension.manifest** файл **обозревателе решений** и выберите **открыть с помощью** и выберите **XML ( Редактор текста)** параметр.

![Открыть с помощью диалогового окна](custom-mvc-templates/_static/image7.jpg)

Создание **&lt;активы&gt;** элемент и добавьте **&lt;активов&gt;** для каждого файла, которые необходимо включить в VSIX. **Тип** каждого элемента **&lt;активов&gt;** должно быть присвоено **Microsoft.VisualStudio.Mvc.Template**. Это пользовательское пространство имен, совместимый только мастером проекта MVC. См. в документации по схеме 2.0 VSIX, Дополнительные сведения о структуре и макет файла манифеста.

Просто добавлять файлы в VSIX не является достаточным для регистрации шаблонов с помощью мастера MVC. Необходимо указать сведения, такие как имя шаблона, описание, обработчиков поддерживаемых представлений и язык программирования в мастере MVC. Эта информация передается в настраиваемые атрибуты, связанные с **&lt;активов&gt;** для каждого элемента **vstemplate** файл.

&lt;Средства d:VsixSubPath =&quot;ProjectTemplates\MyMvcWebApplicationProjectTemplate.csaspx&quot;

Type=&quot;Microsoft.VisualStudio.Mvc.Template&quot;

d:Source =&quot;файла&quot;

Путь =&quot;ProjectTemplates\MyMvcWebApplicationProjectTemplate.csaspx\BasicMvcWebApplicationProjectTemplate.11.csaspx.vstemplate&quot;

ProjectType=&quot;MVC&quot;

Language =&quot;C#&quot;

ViewEngine=&quot;Aspx&quot;

TemplateId =&quot;MyMvcApplication&quot;

Title =&quot;пользовательского базового веб-приложения&quot;

Описание =&quot;пользовательский шаблон, производным от основных MVC веб-приложение (Razor)&quot;

Версия =&quot;4.0&quot;/&gt;

Ниже приведено описание настраиваемых атрибутов, которые должны присутствовать.

- **ProjectType** должно быть присвоено MVC.
- **Язык** обозначает язык разработки, поддерживаемые в шаблоне. Допустимые значения: C# или Visual Basic.
- **ViewEngine** обозначает обработчик представлений, поддерживаемых шаблона, такие как Aspx или Razor. Можно указать пользовательское значение для этого поля.
- **TemplateId** используется для объединения в шаблонах. Если значение совпадает с Идентификатором существующего шаблона будет переопределите прежде зарегистрированы с помощью MVC мастера шаблонов.
- **Заголовок** обозначает краткое описание, отображаемое в мастере под каждый шаблон проекта MVC.
- **Описание** задает более подробное описание шаблона.

После добавления всех файлов в манифест и сохранен, можно будет заметить, что **активы** вкладку в конструкторе будут отображаться все файлы, но не настраиваемых атрибутов, добавленном на **&lt;активов&gt;** элементы для **vstemplate** файлов.

![Ресурсы конструктора проектов](custom-mvc-templates/_static/image8.jpg)

Теперь осталось скомпилировать проект VSIX и установить его.

Убедитесь, что на компьютере будут закрыты все экземпляры Visual Studio, где планируется проверить расширение VSIX. Visual Studio ищет новые расширения во время запуска, поэтому если при установке VSIX открыт интегрированной среды разработки необходимо перезапустить Visual Studio. В проводнике дважды щелкните файл VSIX, чтобы запустить **установщик VSIX**, нажмите кнопку **установить** , а затем запустите Visual Studio.

![Установщик VSIX](custom-mvc-templates/_static/image9.jpg)

В меню выберите **Сервис > расширения и обновления** для подтверждения того, что было установлено расширение. Если установщик VSIX ошибок во время установки расширения установщик VSIX журнал Дополнительные сведения можно просмотреть. Обычно в создается **% temp %** папки пользователя, которого установлено расширение, например **C:\Users\Bob\AppData\Local\Temp**.

![Расширения и обновления](custom-mvc-templates/_static/image10.jpg)

После закрытия окна можно создать проект MVC 4 в см. в разделе, отображаются ли новые шаблоны в мастере MVC.

![Новый проект ASP.NET MVC 4](custom-mvc-templates/_static/image11.jpg)

## <a name="limitations"></a>Ограничения

1. Мастер MVC не поддерживает локализованные пользовательские шаблоны.
2. Мастер не сообщит все ошибки, если не удается найти настраиваемые шаблоны. Если обязательные настраиваемые атрибуты отсутствуют, шаблон будет просто исключаются из мастера.
