---
uid: mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-view
title: Добавление представления (VB) | Документация Майкрософт
author: Rick-Anderson
description: В этом учебнике вы узнаете об основах создания веб-приложения ASP.NET MVC с помощью Microsoft Visual Web Developer 2010 Express с пакетом обновления 1 (SP1)...
ms.author: riande
ms.date: 01/12/2011
ms.assetid: d3633f64-5d3c-45c9-ae4b-cb1563e3739f
msc.legacyurl: /mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-view
msc.type: authoredcontent
ms.openlocfilehash: fa200935d83bb26c07b302449a6eba6fd67b5322
ms.sourcegitcommit: 7709c0a091b8d55b7b33bad8849f7b66b23c3d72
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/19/2020
ms.locfileid: "77457365"
---
# <a name="adding-a-view-vb"></a>Добавление представления (VB)

по [Рик Андерсон (](https://twitter.com/RickAndMSFT)

> В этом учебнике вы узнаете об основах создания веб-приложения ASP.NET MVC с помощью Microsoft Visual Web Developer 2010 Express с пакетом обновления 1 (SP1), который является бесплатной версией Microsoft Visual Studio. Прежде чем начать, убедитесь, что установлены предварительные требования, перечисленные ниже. Чтобы установить все эти компоненты, щелкните следующую ссылку: [установщик веб-платформы](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack). Кроме того, вы можете отдельно установить необходимые компоненты, используя следующие ссылки:
> 
> - [Предварительные требования для Visual Studio Web Developer Express SP1](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack)
> - [Обновление инструментов ASP.NET MVC 3](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=MVC3)
> - [SQL Server Compact 4,0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(поддержка времени выполнения и средств)
> 
> Если вы используете Visual Studio 2010 вместо Visual Web Developer 2010, установите необходимые компоненты, щелкнув следующую ссылку: [Предварительные требования для Visual studio 2010](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).
> 
> Для этого раздела доступен проект Visual Web Developer с исходным кодом VB.NET. [Скачайте версию VB.NET](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098). При желании C#переключитесь на [ C# версию](../cs/adding-a-view.md) этого учебника.

В этом разделе мы собираемся изменить класс `HelloWorldController`, чтобы использовать файл шаблона представления для чистого инкапсуляции процесса создания HTML-ответов клиенту.

Начнем с использования шаблона представления с методом `Index` в классе `HelloWorldController`. В настоящее время метод `Index` возвращает строку с сообщением, жестко запрограммированным в классе контроллера. Измените метод `Index`, чтобы он возвращал объект `View`, как показано ниже:

[!code-vb[Main](adding-a-view/samples/sample1.vb)]

Теперь добавим в наш проект шаблон представления, который можно вызвать с помощью метода `Index`. Для этого щелкните правой кнопкой мыши внутри метода `Index` и выберите **Добавить представление**.

[![индексаддвиев](adding-a-view/_static/image2.png "индексаддвиев")](adding-a-view/_static/image1.png)

Откроется диалоговое окно **Добавление представления** . Оставьте записи по умолчанию и нажмите кнопку **Добавить** .

[![3addView](adding-a-view/_static/image4.png "3addView")](adding-a-view/_static/image3.png)

Создается папка *мвкмовие\виевс\хелловорлд* и файл *мвкмовие\виевс\хелловорлд\индекс.вбхтмл* . Их можно увидеть в **Обозреватель решений**:

[![солнексфелловорлдиндкс](adding-a-view/_static/image6.png "солнексфелловорлдиндкс")](adding-a-view/_static/image5.png)

Добавьте HTML-код в тег `<h2>`. Измененный файл *мвкмовие\виевс\хелловорлд\индекс.вбхтмл* показан ниже.

[!code-vbhtml[Main](adding-a-view/samples/sample2.vbhtml)]

Запустите приложение и перейдите к контроллеру &quot;Hello World&quot; (`http://localhost:xxxx/HelloWorld`). Метод `Index` в контроллере не требует много усилий. Он просто запустил инструкцию `return View()`, в которой было указано, что мы хотели использовать файл шаблона представления для отображения ответа клиенту. Так как мы не указали явно имя файла шаблона представления для использования, ASP.NET MVC по умолчанию использует файл представления *index. vbhtml* в папке *\виевс\хелловорлд* . На рисунке ниже показана строка, жестко запрограммированная в представлении.

[![3HelloWorld](adding-a-view/_static/image8.png "3HelloWorld")](adding-a-view/_static/image7.png)

Выглядит довольно хорошо. Обратите внимание, что в заголовке окна браузера указано &quot;индекс&quot; и на странице отображается большая Заглавная страница &quot;приложении MVC.&quot; Давайте изменим их.

## <a name="changing-views-and-layout-pages"></a>Изменение представлений и страниц макета

Во первых, изменим текст &quot;приложении MVC.&quot;, что текст является общим и отображается на каждой странице. Он отображается только в одном месте нашего проекта, даже если он находится на каждой странице нашего приложения. Перейдите в папку */виевс/Шаред* в **Обозреватель решений** и откройте файл *\_Layout. vbhtml* . Этот файл называется страницей макета и является общим &quot;оболочкой&quot;, используемой всеми остальными страницами.

Обратите внимание на `@RenderBody()` строку кода, расположенную в нижней части файла. `RenderBody` — это заполнитель, в котором отображаются все создаваемые страницы, &quot;заключены в оболочку&quot; на странице макета. Измените заголовок `<h1>` из **&quot;** мое приложение MVC&quot; на &quot;приложение фильмов MVC&quot;.

[!code-html[Main](adding-a-view/samples/sample3.html)]

Запустите приложение и обратите внимание на то, что теперь оно говорит &quot;&quot;приложении ролика MVC. Щелкните ссылку **About (о программе** ), и на этой странице также отображается &quot;&quot;приложения ролика MVC.

Полный *\_Layout. vbhtml* показан ниже:

[!code-cshtml[Main](adding-a-view/samples/sample4.cshtml)]

Теперь изменим заголовок страницы индекс (представление).

[!code-vbhtml[Main](adding-a-view/samples/sample5.vbhtml)]

Откройте *мвкмовие\виевс\хелловорлд\индекс.вбхтмл*. Изменение состоит из двух мест: первый — текст, отображаемый в заголовке браузера, а затем во вторичном заголовке (элемент `<h2>`). Мы сделаем их немного другими, чтобы вы могли увидеть, какой из фрагментов кода изменяет часть приложения.

Запустите приложение и перейдите к`http://localhost:xx/HelloWorld`. Обратите внимание, что основной и дополнительный заголовки браузера изменились. Очень просто внести значительные изменения в приложение с небольшими изменениями в представлении. (Если изменения не отображаются, возможно, вы просматриваете кэшированное содержимое. В этом случае нажмите в браузере клавиши CTRL+F5 для принудительной загрузки ответа сервера.)

[![3_MyMovieList](adding-a-view/_static/image10.png "3_MyMovieList")](adding-a-view/_static/image9.png)

Немного &quot;&quot; данных (в данном случае сообщение &quot;Hello World!&quot;) жестко закодировано. Наше приложение MVC имеет V (представления), и у нас есть C (Controllers), но еще нет M (Model). Вскоре мы рассмотрим, как создать базу данных и извлечь из нее данные модели.

## <a name="passing-data-from-the-controller-to-the-view"></a>Передача данных из контроллера в представление

Тем не менее, прежде чем перейти к базе данных и поговорить о моделях, давайте сначала поговорим о передаче информации из контроллера в представление. Мы хотим передать необходимый шаблон представления для отображения ответа HTML клиенту. Эти объекты, как правило, создаются и передаются классом контроллера в шаблон представления, и они должны содержать только данные, необходимые для шаблона представления, и ничего больше.

Ранее при использовании класса `HelloWorldController` метод действия `Welcome` занял `name` и параметр `numTimes`, а затем выводит значения параметров в браузер. Вместо того, чтобы контроллер продолжал обрабатывать этот ответ напрямую, давайте поместим эти данные в контейнер для представления. Контроллеры и представления могут использовать объект `ViewBag` для хранения этих данных. , Который будет автоматически передаваться в шаблон представления и использоваться для отображения ответа HTML с использованием содержимого контейнера в виде данных. Таким образом, контроллер имеет дело с одним делом и шаблоном представления, что позволяет поддерживать чистые &quot;разделения проблем&quot; в приложении.

Кроме того, можно определить пользовательский класс, затем создать экземпляр этого объекта, заполнить его данными и передать в представление. Это часто называется ViewModel, так как это пользовательская модель для представления. Однако для небольших объемов данных ViewBag работает отлично.

Вернитесь к файлу *HelloWorldController. vb* , измените метод `Welcome` в контроллере, чтобы разместить сообщение и Нумтимес в ViewBag. ViewBag — это динамический объект. Это означает, что вы можете поместить в него все, что вам нужно. ViewBag не имеет определенных свойств, пока вы не помещаете в него что-либо.

Полный `HelloWorldController.vb` с новым классом в том же файле.

[!code-vb[Main](adding-a-view/samples/sample6.vb)]

Теперь наш ViewBag содержит данные, которые будут автоматически передаваться в представление. Опять же, можно также передать наш объект следующим образом, если нам понравилось:

[!code-csharp[Main](adding-a-view/samples/sample7.cs)]

Теперь нам нужен шаблон `WelcomeView`! Запустите приложение, чтобы скомпилировать новый код. Закройте браузер, щелкните правой кнопкой мыши внутри метода `Welcome` и выберите **Добавить представление**.

Вот как выглядит диалоговое окно " **Добавление представления** ".

[![3AddWelcomeView](adding-a-view/_static/image12.png "3AddWelcomeView")](adding-a-view/_static/image11.png)

Добавьте следующий код в элемент `<h2>` в новом <em>окне приветствия.</em> файл VBHTML. Мы сделаем цикл и скажем, &quot;Привет&quot; столько раз, сколько будет говорит пользователь.

[!code-vbhtml[Main](adding-a-view/samples/sample8.vbhtml)]

Запустите приложение и перейдите к `http://localhost:xx/HelloWorld/Welcome?name=Scott&numtimes=4`

Теперь данные берутся из URL-адреса и передаются контроллеру автоматически. Контроллер упаковывает данные в объект `Model` и передает этот объект в представление. Представление, чем отображает данные в виде HTML-кода для пользователя.

[![3Hello_Scott_4](adding-a-view/_static/image14.png "3Hello_Scott_4")](adding-a-view/_static/image13.png)

Ну, это разновидность &quot;M&quot; для модели, но не тип базы данных. Итак, обобщим все полученные данные и попробуем создать базу данных фильмов.

> [!div class="step-by-step"]
> [Назад](adding-a-controller.md)
> [Вперед](adding-a-model.md)
