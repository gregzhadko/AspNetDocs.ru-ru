---
uid: mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-view
title: Добавление представления (Visual Basic) | Документация Майкрософт
author: Rick-Anderson
description: Этом учебнике описываются основы создания MVC веб-приложения ASP.NET с помощью Microsoft Visual Web Developer 2010 Express пакетом обновления 1, который является...
ms.author: riande
ms.date: 01/12/2011
ms.assetid: d3633f64-5d3c-45c9-ae4b-cb1563e3739f
msc.legacyurl: /mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-view
msc.type: authoredcontent
ms.openlocfilehash: cf2e73b4245de6fe702b8c74550e6c7fc701a47f
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65129973"
---
# <a name="adding-a-view-vb"></a>Добавление представления (VB)

по [Рик Андерсон]((https://twitter.com/RickAndMSFT))

> Этом учебнике описываются основы создания MVC веб-приложения ASP.NET с помощью Microsoft Visual Web Developer 2010 Express пакетом обновления 1, которой является бесплатной версии Microsoft Visual Studio. Перед началом работы убедитесь, что вы установили необходимые компоненты, перечисленные ниже. Все из них можно установить, щелкнув следующую ссылку: [Установщик веб-платформы](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack). Кроме того можно установить по отдельности необходимых компонентов, с помощью следующих ссылок:
> 
> - [Необходимые компоненты для Visual Studio Web Developer Express SP1](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack)
> - [Обновление средств ASP.NET MVC 3](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=MVC3)
> - [SQL Server Compact 4.0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(среды выполнения и средства поддержки)
> 
> Если вы используете Visual Studio 2010 вместо Visual Web Developer 2010, установите необходимые компоненты, щелкнув следующую ссылку: [Необходимые компоненты для Visual Studio 2010](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).
> 
> Проект Visual Web Developer с VB.NET исходный код доступен на следующей странице в этом разделе. [Загрузить версию VB.NET](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098). Если вы предпочитаете C#, переключитесь в [C# версии](../cs/adding-a-view.md) работы с этим руководством.

В этом разделе мы собираемся изменить `HelloWorldController` класс для использования в файл шаблона представления для отчетливой инкапсуляции процесса создания HTML-ответов клиенту.

Давайте начнем с помощью шаблона представления с `Index` метод в `HelloWorldController` класса. В настоящее время `Index` метод возвращает строку с сообщением, которое жестко задано в классе контроллера. Изменение `Index` метод для возврата `View` объекта, как показано в следующем:

[!code-vb[Main](adding-a-view/samples/sample1.vb)]

Теперь добавим шаблон представления в свой проект, который мы можно вызывать с помощью `Index` метод. Чтобы сделать это, щелкните правой кнопкой мыши внутри `Index` метод и нажмите кнопку **Добавление представления**.

[![IndexAddView](adding-a-view/_static/image2.png "IndexAddView")](adding-a-view/_static/image1.png)

**Добавление представления** откроется диалоговое окно. Оставьте значения по умолчанию и нажмите кнопку **добавить** кнопки.

[![3addView](adding-a-view/_static/image4.png "3addView")](adding-a-view/_static/image3.png)

*MvcMovie\Views\HelloWorld* папки и *MvcMovie\Views\HelloWorld\Index.vbhtml* создаются файл. Вы можете увидеть их в **обозревателе решений**:

[![SolnExpHelloWorldIndx](adding-a-view/_static/image6.png "SolnExpHelloWorldIndx")](adding-a-view/_static/image5.png)

Добавление HTML в разделе `<h2>` тега. Измененный *MvcMovie\Views\HelloWorld\Index.vbhtml* файла приведен ниже.

[!code-vbhtml[Main](adding-a-view/samples/sample2.vbhtml)]

Запустите приложение и перейдите к &quot;Здравствуй, мир&quot; контроллера (`http://localhost:xxxx/HelloWorld`). `Index` Метод в контроллере не делать много работы; он просто выполнил оператор `return View()`, который указывает, что мы хотели бы использовать файл шаблона представления для отображения ответа клиенту. Так как мы не указали явным образом имя файла шаблона представления для использования, ASP.NET MVC по умолчанию использует *Index.vbhtml* файл представления в *\Views\HelloWorld* папки. На рисунке ниже показана строка жестко в представлении.

[![3HelloWorld](adding-a-view/_static/image8.png "3HelloWorld")](adding-a-view/_static/image7.png)

Выглядит довольно хорошо. Обратите внимание, что строка заголовка браузера говорит &quot;индекс&quot; и появляется надпись большой заголовок на странице &quot;Мое приложение MVC.&quot; Давайте изменим их.

## <a name="changing-views-and-layout-pages"></a>Изменение представлений и страниц макета

Во-первых изменим текст &quot;Мое приложение MVC.&quot; Этот текст является общим и появляется на каждой странице. Он находится только в одном месте, в нашем проекте, даже если он находится на каждой странице, в нашем приложении. Перейдите к */Views/Shared* папку в **обозревателе решений** и откройте  *\_Layout.vbhtml* файла. Этот файл называется страницы макета и является общей &quot;оболочки&quot; , использовать другие страницы.

Примечание `@RenderBody()` строку кода, в нижней части файла. `RenderBody` — это заполнитель, где все создаваемые страницы отображаются, &quot;оболочку&quot; на странице макета. Изменение `<h1>` заголовком от **&quot;** Мое приложение MVC&quot; для &quot;Киноприложение MVC&quot;.

[!code-html[Main](adding-a-view/samples/sample3.html)]

Запустите приложение и обратите внимание, теперь отображается надпись &quot;Киноприложение MVC&quot;. Нажмите кнопку **о** ссылку и что странице показан &quot;Киноприложение MVC&quot;, слишком.

Полный  *\_Layout.vbhtml* файла приведен ниже:

[!code-cshtml[Main](adding-a-view/samples/sample4.cshtml)]

Теперь изменим заголовок страницы индекса (представление).

[!code-vbhtml[Main](adding-a-view/samples/sample5.vbhtml)]

Откройте *MvcMovie\Views\HelloWorld\Index.vbhtml*. Чтобы внести изменения в двух местах: во-первых, текст, расположенный в заголовке браузера, а затем в дополнительный заголовок ( `<h2>` элемент). Сделаем их немного отличается, вы увидите, какая часть кода изменяет соответствующую часть приложения.

Запустите приложение и перейдите к`http://localhost:xx/HelloWorld`. Обратите внимание, что основной и дополнительный заголовки браузера изменились. Это легко сделать много важных изменений в приложении с небольшими изменениями в представление. (Если изменения не отображаются, возможно, вы просматриваете кэшированное содержимое. В этом случае нажмите в браузере клавиши CTRL+F5 для принудительной загрузки ответа сервера.)

[![3_MyMovieList](adding-a-view/_static/image10.png "3_MyMovieList")](adding-a-view/_static/image9.png)

Небольшой фрагмент &quot;данных&quot; (в данном случае &quot;Hello World!&quot; сообщения) задано жестко, однако. Наше приложение MVC имеет V (представления), и у нас есть C (контроллеры), но не M (модель) еще. Чуть ниже мы рассмотрим создание базы данных и получать данные модели из нее.

## <a name="passing-data-from-the-controller-to-the-view"></a>Передача данных из контроллера в представление

Прежде чем мы перейдите к базе данных и поговорим о моделях, но давайте сперва поговорим о передачи данных из контроллера в представление. Мы хотим передать шаблон представления требуется для визуализации HTML-ответа клиента. Эти объекты обычно создаются и передается шаблона представления с помощью класса контроллера, и они должны содержать только данные, которые требуются шаблону представления и больше нет.

Ранее с помощью `HelloWorldController` класс, `Welcome` метод действия заняло `name` и `numTimes` параметров и затем выходных данных, значения параметров в браузер. Вместо этого, чем у контроллера продолжают отображаться этот ответ непосредственно, давайте вместо этого мы поместим эти данные в контейнере для представления. Можно использовать контроллеры и представления `ViewBag` объект для хранения этих данных. Будет автоматически передаются по шаблона представления и используется для отрисовки HTML-ответа, используя содержимого контейнера в качестве данных. Таким образом, контроллер отвечает за одну вещь и этот шаблон с другим, благодаря чему мы можем поддерживать чистую &quot;Разделение областей ответственности&quot; в приложении.

Кроме того мы может определить пользовательский класс, создайте экземпляр этого объекта самостоятельно, наполнения данными и передать его в представление. Который часто называется ViewModel, так как он является пользовательской модели для представления. Для небольших объемов данных Однако ViewBag прекрасно работает.

Вернитесь к *HelloWorldController.vb* изменение в файле `Welcome` метод внутри на контроллере, чтобы поместить сообщение и; numtimes = в ViewBag. ViewBag является динамическим объектом. Это означает, что можно поместить все, что вы хотите его. ViewBag не имеет определенных свойств до помещен внутри него.

Полный `HelloWorldController.vb` с новым классом в одном файле.

[!code-vb[Main](adding-a-view/samples/sample6.vb)]

Теперь наши ViewBag содержит данные, которые будут передаваться представления автоматически. Опять же в качестве альтернативы мы удалось передали в собственный объект следующим образом если нам понравились:

[!code-csharp[Main](adding-a-view/samples/sample7.cs)]

Теперь мы `WelcomeView` шаблона! Запустите приложение, поэтому выполняется компиляция нового кода. Закройте браузер, щелкните правой кнопкой мыши внутри `Welcome` метод, а затем щелкните **Добавление представления**.

Вот что вашей **Добавление представления** выглядит диалоговое окно.

[![3AddWelcomeView](adding-a-view/_static/image12.png "3AddWelcomeView")](adding-a-view/_static/image11.png)

Добавьте следующий код в разделе `<h2>` элемент в новом <em>приветствия.</em> vbhtml-файл. Мы сделать цикл и сказать &quot;Hello&quot; столько раз, сколько пользователь говорит, мы должны!

[!code-vbhtml[Main](adding-a-view/samples/sample8.vbhtml)]

Запустите приложение и перейдите к `http://localhost:xx/HelloWorld/Welcome?name=Scott&numtimes=4`

Теперь данные из URL-адрес и автоматически передаются в контроллер. Контроллер упаковывает данные в `Model` объект и передает этот объект в представление. Представление не отображает данные в формате HTML для пользователя.

[![3Hello_Scott_4](adding-a-view/_static/image14.png "3Hello_Scott_4")](adding-a-view/_static/image13.png)

Ну, подход из &quot;M&quot; для модели, а не тип базы данных. Итак, обобщим все полученные данные и попробуем создать базу данных фильмов.

> [!div class="step-by-step"]
> [Назад](adding-a-controller.md)
> [Вперед](adding-a-model.md)
