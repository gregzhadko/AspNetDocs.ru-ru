---
uid: mvc/overview/older-versions/getting-started-with-aspnet-mvc3/cs/adding-a-view
title: Добавление представления (C#) | Документация Майкрософт
author: Rick-Anderson
description: В этом учебнике вы узнаете об основах создания веб-приложения ASP.NET MVC с помощью Microsoft Visual Web Developer 2010 Express с пакетом обновления 1 (SP1)...
ms.author: riande
ms.date: 01/12/2011
ms.assetid: abc7c78d-cb09-4a4c-a887-61bc401d40e3
msc.legacyurl: /mvc/overview/older-versions/getting-started-with-aspnet-mvc3/cs/adding-a-view
msc.type: authoredcontent
ms.openlocfilehash: b4a1316feb8d9b7f3ef5ca4755bf1cc5b23e6ef9
ms.sourcegitcommit: 7709c0a091b8d55b7b33bad8849f7b66b23c3d72
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/19/2020
ms.locfileid: "77458218"
---
# <a name="adding-a-view-c"></a>Добавление представления (C#)

по [Рик Андерсон (](https://twitter.com/RickAndMSFT)

> > [!NOTE]
> > Обновленная версия этого учебника доступна [здесь](../../../getting-started/introduction/getting-started.md) , в которой используется ASP.NET MVC 5 и Visual Studio 2013. Он более безопасен, гораздо проще следовать и демонстрирует дополнительные функции.
> 
> 
> В этом учебнике вы узнаете об основах создания веб-приложения ASP.NET MVC с помощью Microsoft Visual Web Developer 2010 Express с пакетом обновления 1 (SP1), который является бесплатной версией Microsoft Visual Studio. Прежде чем начать, убедитесь, что установлены предварительные требования, перечисленные ниже. Чтобы установить все эти компоненты, щелкните следующую ссылку: [установщик веб-платформы](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack). Кроме того, вы можете отдельно установить необходимые компоненты, используя следующие ссылки:
> 
> - [Предварительные требования для Visual Studio Web Developer Express SP1](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack)
> - [Обновление инструментов ASP.NET MVC 3](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=MVC3)
> - [SQL Server Compact 4,0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(поддержка времени выполнения и средств)
> 
> Если вы используете Visual Studio 2010 вместо Visual Web Developer 2010, установите необходимые компоненты, щелкнув следующую ссылку: [Предварительные требования для Visual studio 2010](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).
> 
> Для этого раздела доступен проект Visual C# Web Developer с исходным кодом. [Скачайте C# версию](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098). Если вы предпочитаете Visual Basic, переключитесь на [Visual Basic версию](../vb/intro-to-aspnet-mvc-3.md) этого учебника.

В этом разделе вы намерены изменить класс `HelloWorldController` для использования представления файлов шаблонов для аккуратной инкапсуляции процесса создания HTML-ответов клиенту.

Вы создадите файл шаблона представления, используя новый [модуль представления Razor](https://weblogs.asp.net/scottgu/archive/2010/07/02/introducing-razor.aspx) , представленный в ASP.NET MVC 3. Шаблоны представлений на основе Razor имеют расширение *. cshtml* и предоставляют элегантный способ создания выходных данных HTML с помощью C#. Razor уменьшает количество символов и нажатий клавиш, необходимых при написании шаблона представления, и обеспечивает быстрый и жидкий рабочий процесс кодирования.

Начните с использования шаблона представления с методом `Index` в классе `HelloWorldController`. На данный момент метод `Index` возвращает строку с сообщением, которое жестко задано в классе контроллера. Измените метод `Index`, чтобы он возвращал объект `View`, как показано ниже:

[!code-csharp[Main](adding-a-view/samples/sample1.cs)]

Этот код использует шаблон представления для создания HTML-ответа браузеру. В проекте добавьте шаблон представления, который можно использовать с методом `Index`. Для этого щелкните правой кнопкой мыши внутри метода `Index` и выберите **Добавить представление**.

![](adding-a-view/_static/image1.png)

Откроется диалоговое окно **Добавление представления** . Оставьте значения по умолчанию так же, как и нажмите кнопку **Добавить** :

![](adding-a-view/_static/image2.png)

Создается папка *мвкмовие\виевс\хелловорлд* и файл *мвкмовие\виевс\хелловорлд\индекс.кштмл* . Их можно увидеть в **Обозреватель решений**:

![](adding-a-view/_static/image3.png)

Ниже показан созданный файл *index. cshtml* :

[![Хелловорлдиндекс](adding-a-view/_static/image5.png)](adding-a-view/_static/image4.png)

Добавьте HTML-код в тег `<h2>`. Измененный файл *мвкмовие\виевс\хелловорлд\индекс.кштмл* показан ниже.

[!code-cshtml[Main](adding-a-view/samples/sample2.cshtml)]

Запустите приложение и перейдите к контроллеру `HelloWorld` (`http://localhost:xxxx/HelloWorld`). Метод `Index` в контроллере не требует много усилий. Он просто запустил инструкцию `return View()`, которая указывает, что метод должен использовать файл шаблона представления для отображения ответа в браузере. Так как вы не указали имя используемого файла шаблона представления, ASP.NET MVC по умолчанию использует файл представления *index. cshtml* в папке *\виевс\хелловорлд* . На рисунке ниже показана строка, жестко запрограммированная в представлении.

![](adding-a-view/_static/image6.png)

Выглядит довольно хорошо. Однако обратите внимание, что в заголовке окна обозревателя указано «index», а на странице «Мое приложение MVC» отображается заголовок Давайте изменим их.

## <a name="changing-views-and-layout-pages"></a>Изменение представлений и страниц макета

Сначала нужно изменить заголовок "мое приложение MVC" в верхней части страницы. Этот текст является общим для каждой страницы. Фактически она реализована только в одном месте проекта, хотя она отображается на каждой странице приложения. Перейдите в папку */виевс/Шаред* в **Обозреватель решений** и откройте файл *\_Layout. cshtml* . Этот файл называется *страницей макета* и является общим "оболочкой", используемой всеми остальными страницами.

[![_LayoutCshtml](adding-a-view/_static/image8.png)](adding-a-view/_static/image7.png)

Шаблоны макета позволяют указать макет контейнера HTML сайта в одном месте, а затем применить его на нескольких страницах сайта. Обратите внимание на строку `@RenderBody()`, расположенную в нижней части файла. `RenderBody` — это заполнитель, в котором на странице макета отображаются все создаваемые страницы конкретного представления, "Упакованные". Измените заголовок заголовка в шаблоне макета с "мое приложение MVC" на "приложение ролика MVC".

[!code-cshtml[Main](adding-a-view/samples/sample3.cshtml)]

Запустите приложение и обратите внимание, что теперь оно говорит о "приложении MVC Movie". Щелкните ссылку **About (о программе** ), и вы увидите, как на этой странице также отображается «приложение MVC Movie». Мы смогли внести изменения один раз в шаблон макета и все страницы сайта отражали новый заголовок.

![](adding-a-view/_static/image9.png)

Полный файл *\_Layout. cshtml* показан ниже:

[!code-cshtml[Main](adding-a-view/samples/sample4.cshtml)]

Теперь изменим заголовок страницы индекс (представление).

Откройте *мвкмовие\виевс\хелловорлд\индекс.кштмл*. Изменение состоит из двух мест: первый — текст, отображаемый в заголовке браузера, а затем во вторичном заголовке (элемент `<h2>`). Сделайте их немного разными, чтобы видеть, какой именно фрагмент кода изменяет соответствующую часть приложения.

[!code-cshtml[Main](adding-a-view/samples/sample5.cshtml)]

Чтобы указать отображаемый заголовок HTML, в приведенном выше коде задается свойство `Title` объекта `ViewBag` (который находится в шаблоне представления *index. cshtml* ). Если взглянуть на исходный код шаблона макета, можно заметить, что шаблон использует это значение в элементе `<title>` как часть `<head>` раздела HTML. С помощью этого подхода можно легко передавать другие параметры между шаблоном представления и файлом макета.

Запустите приложение и перейдите к `http://localhost:xx/HelloWorld`. Обратите внимание, что основной и дополнительный заголовки браузера изменились. (Если изменения не отображаются, возможно, вы просматриваете кэшированное содержимое. В этом случае нажмите в браузере клавиши CTRL+F5 для принудительной загрузки ответа сервера.)

Также обратите внимание на то, как содержимое в шаблоне представления *index. cshtml* было объединено с шаблоном представления *\_Layout. cshtml* и одним ответом HTML, отправленным браузеру. С помощью шаблонов макета можно легко вносить изменения, которые применяются ко всем страницам приложения.

![](adding-a-view/_static/image10.png)

В этом примере небольшой фрагмент данных (сообщение "Hello from our View Template!" ) жестко задан в коде. Приложение MVC предоставляет представление, вы реализуете контроллер, однако модели на данный момент еще нет. Вскоре мы рассмотрим, как создать базу данных и извлечь из нее данные модели.

## <a name="passing-data-from-the-controller-to-the-view"></a>Передача данных из контроллера в представление

Тем не менее, прежде чем перейти к базе данных и поговорить о моделях, давайте сначала поговорим о передаче информации из контроллера в представление. Классы контроллеров вызываются в ответ на входящий запрос URL-адреса. Класс контроллера — это место, где вы пишете код, который обрабатывает входящие параметры, получает данные из базы данных и в конечном итоге определяет тип ответа, отправляемого обратно в браузер. Шаблоны представлений можно использовать из контроллера для создания и форматирования HTML-ответа в браузере.

Контроллеры несут ответственность за предоставление любых данных или объектов, необходимых для отображения шаблона представления в ответ на браузер. Шаблон представления никогда не должен выполнять бизнес-логику или напрямую взаимодействовать с базой данных. Вместо этого он должен работать только с данными, предоставленными ему контроллером. Поддержание такого "разделения ответственности" помогает обеспечить чистоту и удобство в работе кода.

В настоящее время метод действия `Welcome` в классе `HelloWorldController` принимает `name` и параметр `numTimes`, а затем выводит значения непосредственно в браузер. Вместо того, чтобы передавать этот ответ контроллером в виде строки, давайте изменим контроллер на использование шаблона представления. Шаблон представления создаст динамический ответ, для получения которого необходимо передать соответствующие фрагменты данных из контроллера в представление. Для этого контроллер должен разместить динамические данные, необходимые шаблону представления, в объект `ViewBag`, к которому может получить доступ шаблон представления.

Вернитесь в файл *HelloWorldController.CS* и измените метод `Welcome`, добавив `Message` и `NumTimes` значение в объект `ViewBag`. `ViewBag` является динамическим объектом. Это означает, что вы можете поместить в него все необходимое. Объект `ViewBag` не имеет определенных свойств, пока вы не помещаете в него что-либо. Полный файл *HelloWorldController.cs* выглядит следующим образом:

[!code-csharp[Main](adding-a-view/samples/sample6.cs)]

Теперь объект `ViewBag` содержит данные, которые будут автоматически передаваться в представление.

Теперь вам нужен шаблон представления приветствия! В меню **Отладка** выберите команду **построить MvcMovie** , чтобы убедиться, что проект скомпилирован.

[![Буилдхелловорлд](adding-a-view/_static/image12.png)](adding-a-view/_static/image11.png)

Затем щелкните правой кнопкой мыши внутри метода `Welcome` и выберите **Добавить представление**. Диалоговое окно **Добавление представления** выглядит следующим образом:

![](adding-a-view/_static/image13.png)

Нажмите кнопку **Добавить**, а затем добавьте следующий код в элемент `<h2>` в новом файле *Welcome. cshtml* . Вы создадите цикл, который выводит слово «Привет» столько раз, сколько оно говорит пользователю. Полный файл *Welcome. cshtml* приведен ниже.

[!code-cshtml[Main](adding-a-view/samples/sample7.cshtml)]

Запустите приложение и перейдите по следующему URL-адресу:

`http://localhost:xx/HelloWorld/Welcome?name=Scott&numtimes=4`

Теперь данные берутся из URL-адреса и передаются контроллеру автоматически. Контроллер упаковывает данные в объект `ViewBag` и передает этот объект в представление. Представление затем отображает данные в виде HTML-кода для пользователя.

![](adding-a-view/_static/image14.png)

Этот подход характерен для модели, а не для базы данных. Итак, обобщим все полученные данные и попробуем создать базу данных фильмов.

> [!div class="step-by-step"]
> [Назад](adding-a-controller.md)
> [Вперед](adding-a-model.md)
