---
uid: mvc/overview/older-versions/getting-started-with-aspnet-mvc4/adding-a-view
title: Добавление представления | Документация Майкрософт
author: Rick-Anderson
description: Примечание. Обновленная версия этого учебника доступна здесь, в которой используется ASP.NET MVC 5 и Visual Studio 2013. Он более безопасен, гораздо проще в исполнении и демонстрации...
ms.author: riande
ms.date: 08/28/2012
ms.assetid: dde851d7-882e-4d99-9b96-cf96daed81cc
msc.legacyurl: /mvc/overview/older-versions/getting-started-with-aspnet-mvc4/adding-a-view
msc.type: authoredcontent
ms.openlocfilehash: 81c2e1f46b08cbc9b5aa5d6c1b36d9d8dc2ba581
ms.sourcegitcommit: 7709c0a091b8d55b7b33bad8849f7b66b23c3d72
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/19/2020
ms.locfileid: "77457639"
---
# <a name="adding-a-view"></a>Добавление представления

по [Рик Андерсон (](https://twitter.com/RickAndMSFT)

> > [!NOTE]
> > Обновленная версия этого учебника доступна [здесь](../../getting-started/introduction/getting-started.md) , в которой используется ASP.NET MVC 5 и Visual Studio 2013. Он более безопасен, гораздо проще следовать и демонстрирует дополнительные функции.

В этом разделе вы намерены изменить класс `HelloWorldController` для использования представления файлов шаблонов для аккуратной инкапсуляции процесса создания HTML-ответов клиенту.

Вы создадите файл шаблона представления с помощью [подсистемы представлений Razor](https://weblogs.asp.net/scottgu/archive/2010/07/02/introducing-razor.aspx) , представленной в ASP.NET MVC 3. Шаблоны представлений на основе Razor имеют расширение *. cshtml* и предоставляют элегантный способ создания выходных данных HTML с помощью C#. Razor уменьшает количество символов и нажатий клавиш, необходимых при написании шаблона представления, и обеспечивает быстрый и жидкий рабочий процесс кодирования.

На данный момент метод `Index` возвращает строку с сообщением, которое жестко задано в классе контроллера. Измените метод `Index`, чтобы он возвращал объект `View`, как показано в следующем коде:

[!code-csharp[Main](adding-a-view/samples/sample1.cs)]

В приведенном выше методе `Index` используется шаблон представления для создания HTML-ответа браузеру. Методы контроллера (также известные как [методы действий](http://rachelappel.com/asp.net-mvc-actionresults-explained)), например метод `Index` выше, обычно возвращают [ActionResult](https://msdn.microsoft.com/library/system.web.mvc.actionresult.aspx) (или класс, производный от [ActionResult](https://msdn.microsoft.com/library/system.web.mvc.actionresult.aspx)), а не примитивные типы, такие как String.

В проекте добавьте шаблон представления, который можно использовать с методом `Index`. Для этого щелкните правой кнопкой мыши внутри метода `Index` и выберите **Добавить представление**.

![](adding-a-view/_static/image1.png)

Откроется диалоговое окно **Добавление представления** . Оставьте значения по умолчанию так же, как и нажмите кнопку **Добавить** :

![](adding-a-view/_static/image2.png)

Создается папка *мвкмовие\виевс\хелловорлд* и файл *мвкмовие\виевс\хелловорлд\индекс.кштмл* . Их можно увидеть в **Обозреватель решений**:

![](adding-a-view/_static/image3.png)

Ниже показан созданный файл *index. cshtml* :

![хелловорлдиндекс](adding-a-view/_static/image4.png)

Добавьте следующий HTML-код в тег `<h2>`.

[!code-html[Main](adding-a-view/samples/sample2.html)]

Полный файл *мвкмовие\виевс\хелловорлд\индекс.кштмл* показан ниже.

[!code-cshtml[Main](adding-a-view/samples/sample3.cshtml?highlight=7-8)]

Если вы используете Visual Studio 2012, в обозревателе решений щелкните правой кнопкой мыши файл *index. cshtml* и выберите пункт **Просмотреть в инспектор страниц**.

![PI](adding-a-view/_static/image5.png)

В [инспектор страниц учебнике](../../views/using-page-inspector-in-aspnet-mvc.md) содержится дополнительная информация об этом новом средстве.

Кроме того, запустите приложение и перейдите к контроллеру `HelloWorld` (`http://localhost:xxxx/HelloWorld`). Метод `Index` в контроллере не требует много усилий. Он просто запустил инструкцию `return View()`, которая указывает, что метод должен использовать файл шаблона представления для отображения ответа в браузере. Так как вы не указали имя используемого файла шаблона представления, ASP.NET MVC по умолчанию использует файл представления *index. cshtml* в папке *\виевс\хелловорлд* . На рисунке ниже показана строка &quot;Hello из нашего шаблона представления. в представлении&quot; жестко запрограммировано.

![](adding-a-view/_static/image6.png)

Выглядит довольно хорошо. Однако обратите внимание, что в заголовке окна браузера отображается &quot;индексировать мой ASP.NET&quot;, а в верхней части страницы указано &quot;логотип.&quot; под &quot;логотип.&quot; ссылка — это ссылки для регистрации и входа, а ниже — ссылки на домашние страницы, сведения о контактах и обращения к ним. Давайте изменим некоторые из них.

## <a name="changing-views-and-layout-pages"></a>Изменение представлений и страниц макета

Сначала необходимо изменить &quot;эмблему. заголовок&quot; в верхней части страницы. Этот текст является общим для каждой страницы. Фактически он реализуется только в одном месте проекта, хотя он отображается на каждой странице приложения. Перейдите в папку */виевс/Шаред* в **Обозреватель решений** и откройте файл *\_Layout. cshtml* . Этот файл называется *страницей макета* и является общим &quot;оболочкой&quot;, используемой всеми остальными страницами.

![_LayoutCshtml](adding-a-view/_static/image7.png)

Шаблоны макета позволяют указать макет контейнера HTML сайта в одном месте, а затем применить его на нескольких страницах сайта. Найдите строку `@RenderBody()`. `RenderBody` — это заполнитель, в котором отображаются все создаваемые страницы для определенных представлений, &quot;упакованные&quot; на странице макета. Например, если выбрать ссылку About, представление *виевс\хоме\абаут.кштмл* будет отображаться внутри метода `RenderBody`.

Измените заголовок сайт-заголовок в шаблоне макета с &quot;логотипа здесь&quot; &quot;&quot;фильмов MVC.

[!code-cshtml[Main](adding-a-view/samples/sample4.cshtml)]

Замените содержимое элемента Title следующей разметкой:

[!code-cshtml[Main](adding-a-view/samples/sample5.cshtml)]

Запустите приложение и обратите внимание, что теперь оно говорит &quot;&quot;фильмов MVC. Щелкните ссылку **About (о программе** ), и вы увидите, как на этой странице также отображается &quot;роли MVC&quot;. Мы смогли внести изменения один раз в шаблон макета и все страницы сайта отражали новый заголовок.

![](adding-a-view/_static/image8.png)

Теперь изменим заголовок представления индекса.

Откройте *мвкмовие\виевс\хелловорлд\индекс.кштмл*. Изменение состоит из двух мест: первый — текст, отображаемый в заголовке браузера, а затем во вторичном заголовке (элемент `<h2>`). Сделайте их немного разными, чтобы видеть, какой именно фрагмент кода изменяет соответствующую часть приложения.

[!code-cshtml[Main](adding-a-view/samples/sample6.cshtml)]

Чтобы указать отображаемый заголовок HTML, в приведенном выше коде задается свойство `Title` объекта `ViewBag` (который находится в шаблоне представления *index. cshtml* ). Если взглянуть на исходный код шаблона макета, вы заметите, что шаблон использует это значение в элементе `<title>` как часть `<head>`ного раздела HTML, который мы изменили ранее. Используя этот `ViewBag` подход, можно легко передавать другие параметры между шаблоном представления и файлом макета.

Запустите приложение и перейдите к `http://localhost:xx/HelloWorld`. Обратите внимание, что основной и дополнительный заголовки браузера изменились. (Если изменения не отображаются, возможно, вы просматриваете кэшированное содержимое. Нажмите сочетание клавиш CTRL + F5 в браузере, чтобы принудительно загрузить ответ от сервера.) Заголовок браузера создается с `ViewBag.Title`, заданными в шаблоне представления *index. cshtml* , и дополнительным приложением &quot;-Movie,&quot; Добавлено в файл макета.

Также обратите внимание на то, как содержимое в шаблоне представления *index. cshtml* было объединено с шаблоном представления *\_Layout. cshtml* и одним ответом HTML, отправленным браузеру. С помощью шаблонов макета можно легко вносить изменения, которые применяются ко всем страницам приложения.

![](adding-a-view/_static/image9.png)

Наш небольшой &quot;&quot; данных (в данном случае &quot;Hello из нашего шаблона представления&quot; сообщение) жестко закодировано. Приложение MVC имеет &quot;V&quot; (представление), а &quot;C&quot; (Controller), но еще не &quot;M&quot; (модель). Вскоре мы рассмотрим, как создать базу данных и извлечь из нее данные модели.

## <a name="passing-data-from-the-controller-to-the-view"></a>Передача данных из контроллера в представление

Тем не менее, прежде чем перейти к базе данных и поговорить о моделях, давайте сначала поговорим о передаче информации из контроллера в представление. Классы контроллеров вызываются в ответ на входящий запрос URL-адреса. Класс контроллера — это место написания кода, обрабатывающего входящие запросы браузера, получение данных из базы данных и, в конечном итоге, выбор типа ответа, отправляемого обратно в браузер. Шаблоны представлений можно использовать из контроллера для создания и форматирования HTML-ответа в браузере.

Контроллеры несут ответственность за предоставление любых данных или объектов, необходимых для отображения шаблона представления в ответ на браузер. Рекомендуется: **шаблон представления никогда не должен выполнять бизнес-логику или напрямую взаимодействовать с базой данных**. Вместо этого шаблон представления должен работать только с данными, предоставленными ему контроллером. Поддержка этого &quot;разделение проблем&quot; помогает обеспечить чистоту, тестирование и удобство сопровождения кода.

В настоящее время метод действия `Welcome` в классе `HelloWorldController` принимает `name` и параметр `numTimes`, а затем выводит значения непосредственно в браузер. Вместо того, чтобы передавать этот ответ контроллером в виде строки, давайте изменим контроллер на использование шаблона представления. Шаблон представления создаст динамический ответ, для получения которого необходимо передать соответствующие фрагменты данных из контроллера в представление. Это можно сделать, разместив в контроллере динамические данные (параметры), необходимые шаблону представления, в объект `ViewBag`, к которому может получить доступ шаблон представления.

Вернитесь в файл *HelloWorldController.CS* и измените метод `Welcome`, добавив `Message` и `NumTimes` значение в объект `ViewBag`. `ViewBag` является динамическим объектом. Это означает, что вы можете поместить в него все необходимое. Объект `ViewBag` не имеет определенных свойств, пока вы не помещаете в него что-либо. [Система привязки модели MVC ASP.NET](http://odetocode.com/Blogs/scott/archive/2009/04/27/6-tips-for-asp-net-mvc-model-binding.aspx) автоматически сопоставляет именованные параметры (`name` и `numTimes`) из строки запроса в адресной строке с параметрами в методе. Полный файл *HelloWorldController.cs* выглядит следующим образом:

[!code-csharp[Main](adding-a-view/samples/sample7.cs)]

Теперь объект `ViewBag` содержит данные, которые будут автоматически передаваться в представление.

Теперь вам нужен шаблон представления приветствия! В меню **Сборка** выберите команду **построить MvcMovie** , чтобы убедиться, что проект скомпилирован.

Затем щелкните правой кнопкой мыши внутри метода `Welcome` и выберите **Добавить представление**.

![](adding-a-view/_static/image10.png)

Диалоговое окно **Добавление представления** выглядит следующим образом:

![](adding-a-view/_static/image11.png)

Нажмите кнопку **Добавить**, а затем добавьте следующий код в элемент `<h2>` в новом файле *Welcome. cshtml* . Вы создадите цикл, который говорит &quot;Hello&quot; столько раз, сколько оно говорит пользователю. Полный файл *Welcome. cshtml* приведен ниже.

[!code-cshtml[Main](adding-a-view/samples/sample8.cshtml)]

Запустите приложение и перейдите по следующему URL-адресу:

`http://localhost:xx/HelloWorld/Welcome?name=Scott&numtimes=4`

Теперь данные берутся из URL-адреса и передаются контроллеру с помощью [связывателя модели](http://odetocode.com/Blogs/scott/archive/2009/04/27/6-tips-for-asp-net-mvc-model-binding.aspx). Контроллер упаковывает данные в объект `ViewBag` и передает этот объект в представление. Представление затем отображает данные в виде HTML-кода для пользователя.

![](adding-a-view/_static/image12.png)

В приведенном выше примере мы использовали объект `ViewBag` для передачи данных из контроллера в представление. В последнююмся руководстве мы будем использовать модель представления для передачи данных из контроллера в представление. Подход модели представления для передачи данных, как правило, является более предпочтительным по сравнению с использованием контейнера представления. Дополнительные сведения см. в записи блога о [строго типизированных представлениях Dynamic V](https://blogs.msdn.com/b/rickandy/archive/2011/01/28/dynamic-v-strongly-typed-views.aspx) .

Ну, это разновидность &quot;M&quot; для модели, но не тип базы данных. Итак, обобщим все полученные данные и попробуем создать базу данных фильмов.

> [!div class="step-by-step"]
> [Назад](adding-a-controller.md)
> [Вперед](adding-a-model.md)
