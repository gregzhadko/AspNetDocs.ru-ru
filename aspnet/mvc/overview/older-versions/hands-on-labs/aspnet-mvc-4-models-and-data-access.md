---
uid: mvc/overview/older-versions/hands-on-labs/aspnet-mvc-4-models-and-data-access
title: Модели и доступ к данным ASP.NET MVC 4 | Документация Майкрософт
author: rick-anderson
description: Примечание. в этом практическом занятии предполагается, что у вас есть базовые знания о ASP.NET MVC. Если вы ранее не использовали ASP.NET MVC, рекомендуется перейти на ASP.NET MVC 4...
ms.author: riande
ms.date: 02/18/2013
ms.assetid: 634ea84b-f904-4afe-b71b-49cccef4d9cc
msc.legacyurl: /mvc/overview/older-versions/hands-on-labs/aspnet-mvc-4-models-and-data-access
msc.type: authoredcontent
ms.openlocfilehash: 90635b617930d0a9c126795f4c8790d542e33dc9
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78451470"
---
# <a name="aspnet-mvc-4-models-and-data-access"></a>Модели и доступ к данным в ASP.NET MVC 4

по [веб-Camp командам](https://twitter.com/webcamps)

[Скачать обучающий комплект Web Camp](https://aka.ms/webcamps-training-kit)

В этой практической лабораторной работе предполагается, что у вас есть базовые знания о **ASP.NET MVC**. Если вы ранее не использовали **ASP.NET MVC** , мы рекомендуем вам перейти на практический семинар **ASP.NET MVC 4** .

Эта лабораторная работа посвящена усовершенствованиям и новым функциям, описанным выше, путем применения незначительных изменений в образце веб-приложения, предоставленном в исходной папке.

> [!NOTE]
> Все примеры кода и фрагментов включены в набор средств для обучения Web Camp, доступный в [выпусках Microsoft-Web/вебкамптраинингкит](https://aka.ms/webcamps-training-kit). Проект, относящийся к этой лабораторной работе, доступен по [моделям ASP.NET MVC 4 и доступу к данным](https://github.com/Microsoft-Web/HOL-MVC4ModelsAndDataAccess).

В практической лабораторной работе по **ASP.NET MVC** вы передавали жестко закодированные данные из контроллеров в шаблоны представления. Однако для создания реального веб-приложения может потребоваться использовать реальную базу данных.

В этом практическом занятии будет показано, как использовать ядро СУБД для хранения и извлечения данных, необходимых для приложения музыкального магазина. Для этого вы начнете с существующей базы данных и создадите EDM из нее. В рамках этого лабораторного занятия вы будете соответствовать **Database First** подходу, а также **Code First** подходу.

Однако можно также использовать подход **Model First** , создать ту же модель с помощью инструментов, а затем создать из нее базу данных.

![Database First и Model First](aspnet-mvc-4-models-and-data-access/_static/image1.png "Database First и Model First")

*Database First и Model First*

После создания модели необходимо внести соответствующие изменения в Стореконтроллер, чтобы предоставить представления магазинов с данными, полученными из базы данных, а не с помощью жестко закодированных данных. Вносить изменения в шаблоны представления не требуется, так как Стореконтроллер будет возвращать те же ViewModel-данные в шаблоны представлений, хотя на этот раз данные поступают из базы данных.

**Code First подход**

Code First подход позволяет нам определить модель из кода без создания классов, которые обычно связаны с платформой.

В коде сначала объекты модели определяются с помощью POCO, &quot;простые старые объекты CLR&quot;. POCO — это простые обычные классы, которые не имеют наследования и не реализуют интерфейсы. Мы можем автоматически создать базу данных из них, или можно использовать существующую базу данных и создать сопоставление класса из кода.

Преимущества использования этого подхода в том, что модель остается независимой от платформы сохраняемости (в данном случае Entity Framework), так как классы POCO не связаны с платформой сопоставления.

> [!NOTE]
> Эта лабораторная работа основана на ASP.NET MVC 4 и версии примера приложения музыкального магазина, которая настроена и уменьшена в соответствии с функциями, представленными в этой практической лабораторной работе.
> 
> Если вы хотите изучить все приложение учебника по всему **музыкальному магазину** , его можно найти в [MVC-Music-Store](https://github.com/evilDave/MVC-Music-Store).

<a id="Prerequisites"></a>

<a id="Prerequisites"></a>
### <a name="prerequisites"></a>предварительные требования

Для выполнения этой лабораторной работы необходимо иметь следующие элементы:

- [Microsoft Visual Studio Express 2012 для Web](https://www.microsoft.com/visualstudio/eng/products/visual-studio-express-for-web) или старше (см. [приложение а](#AppendixA) для получения инструкций по его установке).

<a id="Setup"></a>

<a id="Setup"></a>
### <a name="setup"></a>Настройка

**Установка фрагментов кода**

Для удобства большая часть кода, который вы будете управлять в этой лаборатории, доступна в виде фрагментов кода Visual Studio. Чтобы установить фрагменты кода, запустите файл **.\саурце\сетуп\кодесниппетс.ВСИ** .

Если вы не знакомы с фрагментами кода Visual Studio Code и хотите узнать, как их использовать, см. приложение в этом документе &quot;[приложении C: использование фрагментов кода](#AppendixC)&quot;.

---

<a id="Exercises"></a>

<a id="Exercises"></a>
## <a name="exercises"></a>Полнят

Эта практическая лабораторная работа состоит из следующих упражнений:

1. [Упражнение 1. Добавление базы данных](#Exercise1)
2. [Упражнение 2. Создание базы данных с помощью Code First](#Exercise2)
3. [Упражнение 3. запрос параметров к базе данных](#Exercise3)

> [!NOTE]
> Каждое упражнение сопровождается **конечной** папкой, содержащей итоговое решение, которое следует получить после завершения упражнений. Это решение можно использовать в качестве инструкции, если вам нужна дополнительная помощь по работе с упражнениями.

Предполагаемое время выполнения этой лабораторной работы: **35 минут**.

<a id="Exercise1"></a>

<a id="Exercise_1_Adding_a_Database"></a>
### <a name="exercise-1-adding-a-database"></a>Упражнение 1. Добавление базы данных

В этом упражнении вы узнаете, как добавить базу данных с таблицами приложения Мусиксторе в решение для использования его данных. После создания базы данных с моделью и добавления ее в решение будет изменен класс Стореконтроллер, чтобы предоставить шаблон представления с данными, полученными из базы данных, вместо использования жестко заданных значений.

<a id="Ex1Task1"></a>

<a id="Task_1_-_Adding_a_Database"></a>
#### <a name="task-1---adding-a-database"></a>Задача 1. Добавление базы данных

В этой задаче вы добавите уже созданную базу данных с основными таблицами приложения Мусиксторе в решение.

1. Откройте **Начальное** решение, расположенное по адресу **Source/EX1-аддингадатабаседбфирст/Begin/** Folder.

   1. Перед продолжением необходимо загрузить некоторые недостающие пакеты NuGet. Для этого в меню **проект** выберите пункт **Управление пакетами NuGet**.
   2. В диалоговом окне **Управление пакетами NuGet** нажмите кнопку **восстановить** , чтобы скачать недостающие пакеты.
   3. Наконец, создайте решение, щелкнув **build** | **Build Solution**.

      > [!NOTE]
      > Одним из преимуществ использования NuGet является то, что вам не нужно поставлять все библиотеки в проекте, уменьшая размер проекта. С помощью средств управления питанием NuGet, указав версии пакетов в файле Packages. config, вы сможете скачать все необходимые библиотеки при первом запуске проекта. Именно поэтому после открытия существующего решения из этой лабораторной работы потребуется выполнить следующие действия.
2. Добавьте файл базы данных **мвкмусиксторе** . В этой практической лабораторной работе вы будете использовать уже созданную базу данных с именем **мвкмусиксторе. mdf**. Для этого щелкните правой кнопкой мыши папку " **приложение\_данные** ", наведите указатель на пункт **Добавить** и выберите пункт **существующий элемент**. Перейдите к **\саурце\ассетс** и выберите файл **мвкмусиксторе. mdf** .

    ![Добавление существующего элемента](aspnet-mvc-4-models-and-data-access/_static/image2.png "Добавление существующего элемента")

    *Добавление существующего элемента*

    ![Файл базы данных Мвкмусиксторе. mdf](aspnet-mvc-4-models-and-data-access/_static/image3.png "Файл базы данных Мвкмусиксторе. mdf")

    *Файл базы данных Мвкмусиксторе. mdf*

    База данных добавлена в проект. Даже если база данных находится внутри решения, можно запрашивать и обновлять ее, как если бы она была размещена на другом сервере базы данных.

    ![База данных Мвкмусиксторе в обозреватель решений](aspnet-mvc-4-models-and-data-access/_static/image4.png "База данных Мвкмусиксторе в обозреватель решений")

    *База данных Мвкмусиксторе в обозреватель решений*
3. Проверьте соединение с базой данных. Для этого дважды щелкните **мвкмусиксторе. mdf** , чтобы установить соединение.

    ![Подключение к Мвкмусиксторе. mdf](aspnet-mvc-4-models-and-data-access/_static/image5.png "Подключение к Мвкмусиксторе. mdf")

    *Подключение к Мвкмусиксторе. mdf*

<a id="Ex1Task2"></a>

<a id="Task_2_-_Creating_a_Data_Model"></a>
#### <a name="task-2---creating-a-data-model"></a>Задача 2. Создание модели данных

В этой задаче будет создана модель данных для взаимодействия с базой данных, добавленной в предыдущей задаче.

1. Создайте модель данных, которая будет представлять базу данных. Для этого в обозреватель решений щелкните правой кнопкой мыши папку **модели** , наведите указатель на пункт **Добавить** и выберите пункт **новый элемент**. В диалоговом окне **Добавление нового элемента** выберите шаблон **данных** , а затем элемент **EDM ADO.NET** . Измените имя модели данных на **сторедб. EDMX** и нажмите кнопку **Добавить**.

    ![Добавление EDM ADO.NET Сторедб](aspnet-mvc-4-models-and-data-access/_static/image6.png "Добавление EDM ADO.NET Сторедб")

    *Добавление EDM ADO.NET Сторедб*
2. Откроется **мастер EDM** . Этот мастер поможет вам создать слой модели. Поскольку модель должна быть создана на основе недавно добавленной существующей базы данных, выберите **создать из базы данных** и нажмите кнопку **Далее**.

    ![Выбор содержимого модели](aspnet-mvc-4-models-and-data-access/_static/image7.png "Выбор содержимого модели")

    *Выбор содержимого модели*
3. Поскольку модель создается на основе базы данных, необходимо указать соединение, которое будет использоваться. Нажмите кнопку **создать соединение**.
4. Выберите **Microsoft SQL Server файл базы данных** и нажмите кнопку **продолжить**.

    ![Выбор источника данных](aspnet-mvc-4-models-and-data-access/_static/image8.png "Выбор источника данных")

    *Диалоговое окно выбора источника данных*
5. Нажмите кнопку **Обзор** и выберите базу данных **мвкмусиксторе. mdf** , расположенную в папке **приложения\_данных** , и нажмите кнопку **ОК**.

    ![Свойства соединения](aspnet-mvc-4-models-and-data-access/_static/image9.png "Свойства подключения")

    *Свойства соединения*
6. Созданный класс должен иметь то же имя, что и строка подключения сущности, поэтому измените его имя на **мусиксторинтитиес** и нажмите кнопку **Далее**.

    ![Выбор подключения к данным](aspnet-mvc-4-models-and-data-access/_static/image10.png "Выбор подключения к данным")

    *Выбор подключения к данным*
7. Выберите объекты базы данных для использования. Так как модель сущностей будет использовать только таблицы базы данных, выберите параметр **таблицы** и убедитесь, что выбраны также параметры **включить столбцы внешнего ключа в параметр Model** и **создания множественного или единственного числа созданные имена объектов** . Измените пространство имен модели на **мвкмусиксторе. Model** и нажмите кнопку **Готово**.

    ![Выбор объектов базы данных](aspnet-mvc-4-models-and-data-access/_static/image11.png "Выбор объектов базы данных")

    *Выбор объектов базы данных*

    > [!NOTE]
    > Если отображается диалоговое окно предупреждения системы безопасности, нажмите кнопку **ОК** , чтобы запустить шаблон и создать классы для сущностей модели.
8. Появится схема сущностей для базы данных, в то время как будет создан отдельный класс, который сопоставляет каждую таблицу с базой данных. Например, таблица « **альбомы** » будет представлена классом **альбома** , где каждый столбец в таблице будет сопоставлен со свойством класса. Это позволит вам запрашивать и работать с объектами, представляющими строки в базе данных.

    ![Схема сущности](aspnet-mvc-4-models-and-data-access/_static/image12.png "Схема сущностей")

    *Схема сущности*

    > [!NOTE]
    > Шаблон T4 (. TT) запускает код для создания классов сущностей и перезаписывает существующие классы с тем же именем. В этом примере классы &quot;&quot;альбома, &quot;жанр&quot; и &quot;исполнителя были перезаписаны созданным кодом.&quot;

<a id="Ex1Task3"></a>

<a id="Task_3_-_Building_the_Application"></a>
#### <a name="task-3---building-the-application"></a>Задача 3. Создание приложения

В этой задаче будет проверяться, что, несмотря на то, что создание модели удалило классы « **альбом**», « **Жанр** » и « **исполнитель** », проект успешно строится с использованием новых классов модели данных.

1. Выполните сборку проекта, выбрав пункт меню **Сборка** , а затем — **сборку мвкмусиксторе**.

    ![Сборка проекта](aspnet-mvc-4-models-and-data-access/_static/image13.png "Сборка проекта")

    *Сборка проекта*
2. Проект успешно строится. Почему он по-прежнему работает? Это работает потому, что таблицы базы данных имеют поля, включающие свойства, которые использовались в **альбоме** удаленных классов и **жанре**.

    ![Сборки были выполнены](aspnet-mvc-4-models-and-data-access/_static/image14.png "Сборки были выполнены")

    *Сборки были выполнены*
3. Хотя конструктор отображает сущности в формате схемы, они фактически C# являются классами. Разверните узел **сторедб. EDMX** в Обозреватель решений а затем **StoreDB.TT**, вы увидите новые созданные сущности.

    ![Созданные файлы](aspnet-mvc-4-models-and-data-access/_static/image15.png "Созданные файлы")

    *Созданные файлы*

<a id="Ex1Task4"></a>

<a id="Task_4_-_Querying_the_Database"></a>
#### <a name="task-4---querying-the-database"></a>Задача 4. запрос к базе данных

В этой задаче будет обновлен класс Стореконтроллер, так что вместо использования жестко зафиксированных данных будет получен запрос к базе данных для получения информации.

1. Откройте **контроллерс\стореконтроллер.КС** и добавьте в класс следующее поле для хранения экземпляра класса **Мусиксторинтитиес** с именем **сторедб**:

    (Фрагмент кода — *модели и доступ к данным — EX1 сторедб*)

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample1.cs)]
2. Класс **мусиксторинтитиес** предоставляет свойство коллекции для каждой таблицы в базе данных. Обновите метод действия **обзора** , чтобы получить жанр со всеми **альбомами**.

    (Фрагмент кода — *модели и доступ к данным — обзор хранилища EX1*)

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample2.cs)]

    > [!NOTE]
    > Для создания строго типизированных выражений запросов в этих коллекциях используется функция .NET, называемая языком **LINQ** , которая будет выполнять код для базы данных и возвращать объекты, с которыми можно программировать.
    > 
    > Дополнительные сведения о LINQ см. на [веб-сайте MSDN](https://msdn.microsoft.com/library/bb397926&amp;#040;v=vs.110&amp;#041;.aspx).
3. Обновите метод действия **индекса** , чтобы получить все жанры.

    (Фрагмент кода — *модели и доступ к данным — индекс хранилища EX1*)

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample3.cs)]
4. Обновление метода действия **индекса** для получения всех жанров и преобразования коллекции в список.

    (Фрагмент кода — *модели и доступ к данным — хранилище EX1 Store женремену*)

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample4.cs)]

<a id="Ex1Task5"></a>

<a id="Task_5_-_Running_the_Application"></a>
#### <a name="task-5---running-the-application"></a>Задача 5. Запуск приложения

В этой задаче будет проверено, что страница "индекс магазина" теперь будет отображать жанры, хранящиеся в базе данных, а не жестко закодированные. Нет необходимости изменять шаблон представления, так как **стореконтроллер** возвращает те же сущности, что и раньше, хотя на этот раз данные будут поступать из базы данных.

1. Перестройте решение и нажмите клавишу **F5** , чтобы запустить приложение.
2. Проект начинается на домашней странице. Убедитесь, что меню **жанров** больше не является жестко закодированным списком, и данные извлекаются из базы данных напрямую.

    ![бровсингженресфромдатабасе](aspnet-mvc-4-models-and-data-access/_static/image16.png)

    *Просмотр жанров из базы данных*
3. Теперь перейдите к любому жанру и убедитесь, что альбомы заполнены из базы данных.

    ![Просмотр альбомов из базы данных](aspnet-mvc-4-models-and-data-access/_static/image17.png "Просмотр альбомов из базы данных")

    *Просмотр альбомов из базы данных*

<a id="Exercise2"></a>

<a id="Exercise_2_Creating_a_Database_Using_Code_First"></a>
### <a name="exercise-2-creating-a-database-using-code-first"></a>Упражнение 2. Создание базы данных с помощью Code First

В этом упражнении вы узнаете, как использовать Code First подход для создания базы данных с таблицами приложения Мусиксторе и получения доступа к его данным.

После создания модели вы измените Стореконтроллер, чтобы предоставить шаблон представления с данными, полученными из базы данных, вместо использования жестко заданных значений.

> [!NOTE]
> Если вы выполнили упражнение 1 и уже работали с Database Firstным подходом, вы узнаете, как получить те же результаты с помощью другого процесса. Для упрощения чтения были отмечены задачи, общие с помощью упражнения 1. Если вы еще не выполнили упражнение 1, но хотели бы изучить Code Firstный подход, вы можете начать с этого упражнения и получить полный охват статьи.

<a id="Ex2Task1"></a>

<a id="Task_1_-_Populating_Sample_Data"></a>
#### <a name="task-1---populating-sample-data"></a>Задача 1. Заполнение демонстрационных данных

В этой задаче вы заполните базу данных образцами данных при первоначальном создании с помощью кода — First.

1. Откройте **Начальное** решение, расположенное по адресу **Source/EX2-креатингадатабасекодефирст/Begin/** Folder. В противном случае вы можете продолжать **использовать решение, полученное в результате** выполнения предыдущего упражнения.

   1. Если вы открыли предоставленное **Начальное** решение, перед продолжением потребуется загрузить некоторые недостающие пакеты NuGet. Для этого в меню **проект** выберите пункт **Управление пакетами NuGet**.
   2. В диалоговом окне **Управление пакетами NuGet** нажмите кнопку **восстановить** , чтобы скачать недостающие пакеты.
   3. Наконец, создайте решение, щелкнув **build** | **Build Solution**.

      > [!NOTE]
      > Одним из преимуществ использования NuGet является то, что вам не нужно поставлять все библиотеки в проекте, уменьшая размер проекта. С помощью средств управления питанием NuGet, указав версии пакетов в файле Packages. config, вы сможете скачать все необходимые библиотеки при первом запуске проекта. Именно поэтому после открытия существующего решения из этой лабораторной работы потребуется выполнить следующие действия.
2. Добавьте файл **SampleData.CS** в папку **Models** . Для этого щелкните правой кнопкой мыши папку **модели** , наведите указатель на пункт **Добавить** и выберите пункт **существующий элемент**. Перейдите к **\саурце\ассетс** и выберите файл **SampleData.CS** .

    ![Пример заполнения данных в коде](aspnet-mvc-4-models-and-data-access/_static/image18.png "Пример заполнения данных в коде")

    *Пример заполнения данных в коде*
3. Откройте файл **Global.asax.CS** и добавьте следующие операторы *using* .

    (Фрагмент кода — *модели и доступ к данным — глобальный Ex2ный asax using*)

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample5.cs)]
4. В методе **запуска\_приложения ()** добавьте следующую строку, чтобы задать инициализатор базы данных.

    (Фрагмент кода — *модели и доступ к данным — EX2 Global asax сетинитиализер*)

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample6.cs)]

<a id="Ex2Task2"></a>

<a id="Task_2_-_Configuring_the_connection_to_the_Database"></a>
#### <a name="task-2---configuring-the-connection-to-the-database"></a>Задача 2. Настройка подключения к базе данных

Теперь, когда база данных уже добавлена в наш проект, в файле **Web. config** будет записана строка подключения.

1. Добавьте строку подключения в **файл Web. config**. Для этого откройте **файл Web. config** в корневом каталоге проекта и замените строку подключения с именем DefaultConnection следующей строкой в **&lt;ConnectionString&gt;** разделе:

    ![Расположение файла Web. config](aspnet-mvc-4-models-and-data-access/_static/image19.png "Расположение файла Web. config")

    *Расположение файла Web. config*

    [!code-xml[Main](aspnet-mvc-4-models-and-data-access/samples/sample7.xml)]

<a id="Ex2Task3"></a>

<a id="Task_3_-_Working_with_the_Model"></a>
#### <a name="task-3---working-with-the-model"></a>Задача 3. Работа с моделью

Теперь, когда соединение с базой данных уже настроено, вы свяжете модель с таблицами базы данных. В этой задаче будет создан класс, который будет связан с базой данных с Code First. Помните, что существует существующий класс модели POCO, который необходимо изменить.

> [!NOTE]
> Если вы выполнили упражнение 1, то обратите внимание, что этот шаг был выполнен мастером. Выполняя Code First, вы вручную создадите классы, которые будут связаны с сущностями данных.

1. Откройте класс модели POCO « **Жанр** » из папки проекта **модели** и добавьте идентификатор. Используйте свойство int с именем **GenreId**.

    (Фрагмент кода — *модели и доступ к данным — Ex2 Code First жанр*)

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample8.cs)]

    > [!NOTE]
    > Для работы с соглашениями Code First, жанр класса должен иметь свойство первичного ключа, которое будет автоматически обнаруживаться.
    > 
    > Дополнительные сведения о соглашениях Code First см. в этой [статье MSDN](https://msdn.microsoft.com/library/hh161541&amp;#040;v=vs.103&amp;#041;.aspx).
2. Теперь откройте **альбом** класс модели POCO из папки проекта **модели** и включите внешние ключи, а затем создайте свойства с именами **GenreId** и **артистид**. Этот класс уже имеет **GenreId** для первичного ключа.

    (Фрагмент кода — *модели и доступ к данным — Ex2 Code First альбом*)

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample9.cs)]
3. Откройте **класс модели** POCO и включите свойство **артистид** .

    (Фрагмент кода — *модели и доступ к данным — Ex2 Code First исполнителя*)

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample10.cs)]
4. Щелкните правой кнопкой мыши папку проекта **модели** и выберите команду **Добавить | Класс**. Назовите файл **MusicStoreEntities.CS**. Затем нажмите кнопку **Добавить.**

    ![Добавление класса](aspnet-mvc-4-models-and-data-access/_static/image20.png "Добавление класса")

    *Добавление нового элемента*

    ![Добавление Class2](aspnet-mvc-4-models-and-data-access/_static/image21.png "Добавление Class2")

    *Добавление класса*
5. Откройте только что созданный класс **MusicStoreEntities.CS**и включите пространства имен **System. Data. Entity** и **System. Data. Entity. Infrastructure**.

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample11.cs)]
6. Замените объявление класса для расширения класса **DbContext** : Объявите открытый **DBSet** и переопределите метод **OnModelCreating** . После выполнения этого шага вы получите доменный класс, который свяжет модель с Entity Framework. Для этого замените код класса следующим кодом:

    (Фрагмент кода — *модели и доступ к данным — Ex2 Code First мусиксторинтитиес*)

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample12.cs)]

> [!NOTE]
> С помощью Entity Framework **DbContext** и **DBSet** вы сможете запросить жанр класса POCO. Расширяя метод **OnModelCreating** , вы указываете в **коде** , как жанр будет сопоставляться с таблицей базы данных. Дополнительные сведения о DBContext и DBSet можно найти в этой статье MSDN: [Link](https://msdn.microsoft.com/library/system.data.entity.dbcontext(v=vs.103).aspx)

<a id="Ex2Task4"></a>

<a id="Task_4_-_Querying_the_Database"></a>
#### <a name="task-4---querying-the-database"></a>Задача 4. запрос к базе данных

В этой задаче будет обновлен класс Стореконтроллер, чтобы вместо использования жестко зафиксированных данных он извлек его из базы данных.

> [!NOTE]
> Эта задача часто используется в упражнении 1.
> 
> Если вы выполнили упражнение 1, то эти действия будут одинаковы в обоих подходах (сначала база данных или код). Они отличаются друг от друга тем, как данные связаны с моделью, но доступ к сущностям данных пока не является прозрачным для контроллера.

1. Откройте **контроллерс\стореконтроллер.КС** и добавьте в класс следующее поле для хранения экземпляра класса **Мусиксторинтитиес** с именем **сторедб**:

    (Фрагмент кода — *модели и доступ к данным — EX1 сторедб*)

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample13.cs)]
2. Класс **мусиксторинтитиес** предоставляет свойство коллекции для каждой таблицы в базе данных. Обновите метод действия **обзора** , чтобы получить жанр со всеми **альбомами**.

    (Фрагмент кода — *модели и доступ к данным — обзор хранилища EX2*)

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample14.cs)]

    > [!NOTE]
    > Для создания строго типизированных выражений запросов в этих коллекциях используется функция .NET, называемая языком **LINQ** , которая будет выполнять код для базы данных и возвращать объекты, с которыми можно программировать.
    > 
    > Дополнительные сведения о LINQ см. на [веб-сайте MSDN](https://msdn.microsoft.com/library/bb397926(v=vs.110).aspx).
3. Обновите метод действия **индекса** , чтобы получить все жанры.

    (Фрагмент кода — *модели и доступ к данным — индекс хранилища EX2*)

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample15.cs)]
4. Обновление метода действия **индекса** для получения всех жанров и преобразования коллекции в список.

    (Фрагмент кода — *модели и доступ к данным — хранилище EX2 Store женремену*)

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample16.cs)]

<a id="Ex2Task5"></a>

<a id="Task_5_-_Running_the_Application"></a>
#### <a name="task-5---running-the-application"></a>Задача 5. Запуск приложения

В этой задаче будет проверено, что страница "индекс магазина" теперь будет отображать жанры, хранящиеся в базе данных, а не жестко закодированные. Нет необходимости изменять шаблон представления, так как **стореконтроллер** возвращает тот же **стореиндексвиевмодел** , что и раньше, но на этот раз данные поступают из базы данных.

1. Перестройте решение и нажмите клавишу **F5** , чтобы запустить приложение.
2. Проект начинается на домашней странице. Убедитесь, что меню **жанров** больше не является жестко закодированным списком, и данные извлекаются из базы данных напрямую.

    ![бровсингженресфромдатабасе](aspnet-mvc-4-models-and-data-access/_static/image22.png)

    *Просмотр жанров из базы данных*
3. Теперь перейдите к любому жанру и убедитесь, что альбомы заполнены из базы данных.

    ![Просмотр альбомов из базы данных](aspnet-mvc-4-models-and-data-access/_static/image23.png "Просмотр альбомов из базы данных")

    *Просмотр альбомов из базы данных*

<a id="Exercise3"></a>

<a id="Exercise_3_Querying_the_Database_with_Parameters"></a>
### <a name="exercise-3-querying-the-database-with-parameters"></a>Упражнение 3. запрос параметров к базе данных

В этом упражнении вы узнаете, как выполнять запросы к базе данных с помощью параметров, а также как использовать функцию формирования результатов запросов, которая сокращает число обращений к базе данных, получая данные более эффективным образом.

> [!NOTE]
> Дополнительные сведения о формировании результатов запроса см. в следующей [статье MSDN](https://msdn.microsoft.com/library/bb896272&amp;#040;v=vs.100&amp;#041;.aspx).

<a id="Ex3Task1"></a>

<a id="Task_1_-_Modifying_StoreController_to_Retrieve_Albums_from_Database"></a>
#### <a name="task-1---modifying-storecontroller-to-retrieve-albums-from-database"></a>Задача 1. изменение Стореконтроллер для получения альбомов из базы данных

В этой задаче будет изменен класс **стореконтроллер** , чтобы получить доступ к базе данных для получения альбомов от определенного жанра.

1. Откройте решение **Begin** , расположенное в папке **Source\Ex3-QueryingTheDatabaseWithParametersCodeFirst\Begin** , если вы хотите использовать подход с кодом, или папку **Source\Ex3-QueryingTheDatabaseWithParametersDBFirst\Begin** , если хотите использовать подход с первой базой данных. В противном случае вы можете продолжать **использовать решение, полученное в результате** выполнения предыдущего упражнения.

   1. Если вы открыли предоставленное **Начальное** решение, перед продолжением потребуется загрузить некоторые недостающие пакеты NuGet. Для этого в меню **проект** выберите пункт **Управление пакетами NuGet**.
   2. В диалоговом окне **Управление пакетами NuGet** нажмите кнопку **восстановить** , чтобы скачать недостающие пакеты.
   3. Наконец, создайте решение, щелкнув **build** | **Build Solution**.

      > [!NOTE]
      > Одним из преимуществ использования NuGet является то, что вам не нужно поставлять все библиотеки в проекте, уменьшая размер проекта. С помощью средств управления питанием NuGet, указав версии пакетов в файле Packages. config, вы сможете скачать все необходимые библиотеки при первом запуске проекта. Именно поэтому после открытия существующего решения из этой лабораторной работы потребуется выполнить следующие действия.
2. Откройте класс **стореконтроллер** , чтобы изменить метод действия **обзора** . Для этого в **Обозреватель решений**разверните папку **Controllers** и дважды щелкните **StoreController.CS**.
3. Измените метод действия **обзора** , чтобы получить Альбомы для определенного жанра. Для этого замените следующий код:

    (Фрагмент кода — *модели и доступ к данным — EX3 Стореконтроллер бровсемесод*)

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample17.cs)]

> [!NOTE]
> Чтобы заполнить коллекцию сущности, необходимо использовать метод **include** , чтобы указать, что нужно извлечь альбомы. Можно использовать. **Одно расширение ()** в LINQ, поскольку в данном случае для альбома требуется только один жанр. Метод **Single ()** принимает лямбда-выражение в качестве параметра, который в данном случае указывает один объект жанра, который соответствует определенному значению.
> 
> Вы будете использовать функцию, которая позволяет указать другие связанные сущности, которые нужно загрузить, а также при извлечении объекта жанра. Эта функция называется **формированием результатов запроса**и позволяет сократить число попыток доступа к базе данных для получения информации. В этом случае вам потребуется предварительно получить Альбомы для полученного жанра.
> 
> Запрос содержит **жанры. include (&quot;альбомы&quot;)** , чтобы указать, что вы хотите использовать связанные альбомы. Это приведет к более эффективному приложению, так как будет извлекать данные о жанрах и альбомах в одном запросе к базе данных.

<a id="Ex3Task2"></a>

<a id="Task_2_-_Running_the_Application"></a>
#### <a name="task-2---running-the-application"></a>Задача 2. Запуск приложения

В этой задаче вы запустите приложение и получите альбомы определенного жанра из базы данных.

1. Нажмите клавишу **F5** , чтобы запустить приложение.
2. Проект начинается на домашней странице. Измените URL-адрес на **/Сторе/бровсе? жанр = POP** , чтобы убедиться, что результаты извлекаются из базы данных.

    ![Просмотр по жанру](aspnet-mvc-4-models-and-data-access/_static/image24.png "Просмотр по жанру")

    *Просмотр/Сторе/бровсе? жанр = POP*

<a id="Ex3Task3"></a>

<a id="Task_3_-_Accessing_Albums_by_Id"></a>
#### <a name="task-3---accessing-albums-by-id"></a>Задача 3. доступ к альбомам по идентификатору

В этой задаче будет повторена предыдущая процедура для получения альбомов по идентификатору.

1. При необходимости закройте браузер, чтобы вернуться в Visual Studio. Откройте класс **стореконтроллер** , чтобы изменить метод действия **Details** . Для этого в **Обозреватель решений**разверните папку **Controllers** и дважды щелкните **StoreController.CS**.
2. Измените метод действия **Details** , чтобы получить сведения о альбомах на основе их **идентификатора**. Для этого замените следующий код:

    (Фрагмент кода — *модели и доступ к данным — EX3 Стореконтроллер детаилсмесод*)

    [!code-csharp[Main](aspnet-mvc-4-models-and-data-access/samples/sample18.cs)]

<a id="Ex3Task4"></a>

<a id="Task_4_-_Running_the_Application"></a>
#### <a name="task-4---running-the-application"></a>Задача 4. Запуск приложения

В этой задаче вы запустите приложение в веб-браузере и получите сведения об альбоме по идентификатору.

1. Нажмите клавишу **F5** , чтобы запустить приложение.
2. Проект начинается на домашней странице. Измените URL-адрес на **/Store/Details/51** или просмотрите жанры и выберите альбом, чтобы убедиться, что результаты получены из базы данных.

    ![Сведения о просмотре](aspnet-mvc-4-models-and-data-access/_static/image25.png "Сведения о просмотре")

    *Просмотр/Store/Details/51*

> [!NOTE]
> Кроме того, это приложение можно развернуть на веб-сайтах Windows Azure в [приложении б: Публикация приложения ASP.NET MVC 4 с помощью веб-развертывание](#AppendixB).

---

<a id="Summary"></a>

<a id="Summary"></a>
## <a name="summary"></a>Сводка

Выполняя эту практическую лабораторию, вы узнали об основах моделей и доступа к данным ASP.NET MVC, используя подход **Database First** , а также **Code First** подход:

- Добавление базы данных в решение для использования ее данных
- Обновление контроллеров для предоставления шаблонов представлений с данными, полученными из базы данных, а не жестко запрограммированной
- Запрос к базе данных с помощью параметров
- Использование формирования результатов запроса — функции, которая сокращает количество обращений к базе данных, получение данных более эффективным способом
- Как использовать Database First и Code First подходов в Microsoft Entity Framework для связи базы данных с моделью

<a id="AppendixA"></a>

<a id="Appendix_A_Installing_Visual_Studio_Express_2012_for_Web"></a>
## <a name="appendix-a-installing-visual-studio-express-2012-for-web"></a>Приложение а. Установка Visual Studio Express 2012 для Web

Вы можете установить **Microsoft Visual Studio Express 2012 для Web** или другой &quot;Express&quot; версии с помощью **[установщик веб-платформы Майкрософт](https://www.microsoft.com/web/downloads/platform.aspx)** . Следующие инструкции помогут вам выполнить действия, необходимые для установки *Visual Studio Express 2012 для Web* с помощью *установщик веб-платформы Майкрософт*.

1. Перейдите в [[https://go.microsoft.com/?linkid=9810169](https://go.microsoft.com/?linkid=9810169)](https://go.microsoft.com/?linkid=9810169). Кроме того, если у вас уже установлен установщик веб-платформы, вы можете открыть его и найти продукт &quot;<em>Visual Studio Express 2012 для Web с Windows Azure SDK</em>&quot;.
2. Щелкните **Install Now (установить сейчас**). Если у вас нет **установщика веб-платформы** , вы будете сначала перенаправлены на загрузку и установку.
3. После открытия **установщика веб-платформы** нажмите кнопку **установить** , чтобы начать установку.

    ![Установка Visual Studio Express](aspnet-mvc-4-models-and-data-access/_static/image26.png "Установка Visual Studio Express")

    *Установка Visual Studio Express*
4. Прочитайте все лицензии и условия продуктов и нажмите кнопку " **принять** ", чтобы продолжить.

    ![Принятие условий лицензии](aspnet-mvc-4-models-and-data-access/_static/image27.png)

    *Принятие условий лицензии*
5. Дождитесь завершения процесса загрузки и установки.

    ![Ход установки](aspnet-mvc-4-models-and-data-access/_static/image28.png)

    *Ход установки*
6. После завершения установки нажмите кнопку **Готово**.

    ![Установка завершена](aspnet-mvc-4-models-and-data-access/_static/image29.png)

    *Установка завершена*
7. Нажмите кнопку **выход** , чтобы закрыть установщик веб-платформы.
8. Чтобы открыть Visual Studio Express для Интернета, перейдите на **начальный** экран и начните запись &quot;**VS Express**&quot;, а затем щелкните плитку **VS Express для Web** .

    ![Плитка VS Express для Web](aspnet-mvc-4-models-and-data-access/_static/image30.png)

    *Плитка VS Express для Web*

<a id="AppendixB"></a>

<a id="Appendix_B_Publishing_an_ASPNET_MVC_4_Application_using_Web_Deploy"></a>
## <a name="appendix-b-publishing-an-aspnet-mvc-4-application-using-web-deploy"></a>Приложение б. Публикация приложения ASP.NET MVC 4 с помощью веб-развертывание

В этом приложении показано, как создать новый веб-сайт из портал управления Windows Azure и опубликовать полученное приложение, выполнив следующие лабораторные занятия, используя возможности публикации веб-развертывание, предоставляемые Windows Azure.

<a id="ApxBTask1"></a>

<a id="Task_1_-_Creating_a_New_Web_Site_from_the_Windows_Azure_Portal"></a>
#### <a name="task-1---creating-a-new-web-site-from-the-windows-azure-portal"></a>Задача 1. Создание нового веб-сайта на портале Windows Azure

1. Перейдите в [портал управления Windows Azure](https://manage.windowsazure.com/) и выполните вход с использованием учетных данных Майкрософт, связанных с подпиской.

    > [!NOTE]
    > С помощью Windows Azure можно бесплатно разместить 10 веб-сайтов ASP.NET, а затем масштабировать их по мере роста объема трафика. Вы можете зарегистрироваться [здесь](https://aka.ms/aspnet-hol-azure).

    ![Вход в Windows портал Azure](aspnet-mvc-4-models-and-data-access/_static/image31.png "Вход в Windows портал Azure")

    *Вход в Windows Azure портал управления*
2. На панели команд щелкните **создать** .

    ![Создание нового веб-сайта](aspnet-mvc-4-models-and-data-access/_static/image32.png "Создание нового веб-сайта")

    *Создание нового веб-сайта*
3. Щелкните **Compute** | **веб-сайт**. Затем выберите пункт **Быстрое создание** . Предоставьте доступный URL-адрес для нового веб-сайта и щелкните **создать веб-сайт**.

    > [!NOTE]
    > Веб-сайт Windows Azure — это узел для веб-приложения, работающего в облаке, которыми можно управлять и которыми вы управляете. Параметр Быстрое создание позволяет развернуть завершенное веб-приложение на веб-сайте Windows Azure извне портала. Он не включает шаги по настройке базы данных.

    ![Создание нового веб-сайта с помощью быстрого создания](aspnet-mvc-4-models-and-data-access/_static/image33.png "Создание нового веб-сайта с помощью быстрого создания")

    *Создание нового веб-сайта с помощью быстрого создания*
4. Дождитесь создания нового **веб-сайта** .
5. После создания веб-сайта щелкните ссылку в столбце **URL-адрес** . Убедитесь, что новый веб-сайт работает.

    ![Обзор нового веб-сайта](aspnet-mvc-4-models-and-data-access/_static/image34.png "Обзор нового веб-сайта")

    *Обзор нового веб-сайта*

    ![Веб-сайт работает](aspnet-mvc-4-models-and-data-access/_static/image35.png "Веб-сайт работает")

    *Веб-сайт работает*
6. Вернитесь на портал и щелкните имя веб-сайта в столбце **имя** , чтобы отобразить страницы управления.

    ![Открытие страниц управления веб-сайтом](aspnet-mvc-4-models-and-data-access/_static/image36.png "Открытие страниц управления веб-сайтом")

    *Открытие страниц управления веб-сайтом*
7. На странице **панель мониторинга** в разделе **краткий обзор** щелкните ссылку **скачать профиль публикации** .

    > [!NOTE]
    > *Профиль публикации* содержит все сведения, необходимые для публикации веб-приложения на веб-сайте Windows Azure для каждого включенного метода публикации. Профиль публикации содержит URL-адреса, учетные данные пользователей и строки для открытия базы данных, которые необходимы для проверки подлинности и подключения к каждой из конечных точек, соответствующей разрешенному методу публикации. **Microsoft WebMatrix 2**, **Microsoft Visual Studio Express для Web** и **Microsoft Visual Studio 2012** поддерживают чтение профилей публикации для автоматизации настройки этих программ для публикации веб-приложений на веб-сайтах Windows Azure.

    ![Скачивание профиля публикации веб-сайта](aspnet-mvc-4-models-and-data-access/_static/image37.png "Скачивание профиля публикации веб-сайта")

    *Скачивание профиля публикации веб-сайта*
8. Скачайте файл профиля публикации в известное расположение. Далее в этом упражнении вы узнаете, как использовать этот файл для публикации веб-приложения на веб-сайтах Windows Azure из Visual Studio.

    ![Сохранение файла профиля публикации](aspnet-mvc-4-models-and-data-access/_static/image38.png "Сохранение профиля публикации")

    *Сохранение файла профиля публикации*

<a id="ApxBTask2"></a>

<a id="Task_2_-_Configuring_the_Database_Server"></a>
#### <a name="task-2---configuring-the-database-server"></a>Задача 2. Настройка сервера базы данных

Если приложение использует SQL Server базы данных, потребуется создать сервер базы данных SQL. Если вы хотите развернуть простое приложение, которое не использует SQL Server вы можете пропустить эту задачу.

1. Для хранения базы данных приложения необходим сервер базы данных SQL. Серверы базы данных SQL можно просмотреть в подписке на портале управления Windows Azure в **базах данных sql** | **серверы** | **панели мониторинга сервера**. Если сервер не создан, можно создать его с помощью кнопки **Добавить** на панели команд. Запишите **имя сервера и URL-адрес, имя для входа администратора и пароль**, так как они будут использоваться в следующих задачах. Пока не создавайте базу данных, так как она будет создана на более позднем этапе.

    ![Панель мониторинга сервера базы данных SQL](aspnet-mvc-4-models-and-data-access/_static/image39.png "Панель мониторинга сервера базы данных SQL")

    *Панель мониторинга сервера базы данных SQL*
2. В следующей задаче вы проверите подключение к базе данных из Visual Studio. по этой причине необходимо включить локальный IP-адрес в список **разрешенных IP-адресов**сервера. Для этого нажмите кнопку **настроить**, выберите IP-адрес из **текущего IP-адреса клиента** и вставьте его в текстовые поля **начальный IP-адрес** и **конечный IP** -адрес и нажмите кнопку ![добавить-клиент-IP – адрес-OK-кнопка](aspnet-mvc-4-models-and-data-access/_static/image40.png).

    ![Добавление IP-адреса клиента](aspnet-mvc-4-models-and-data-access/_static/image41.png)

    *Добавление IP-адреса клиента*
3. После добавления **IP-адреса клиента** в список Разрешенные IP-адреса нажмите кнопку **сохранить** , чтобы подтвердить изменения.

    ![Подтверждение изменений](aspnet-mvc-4-models-and-data-access/_static/image42.png)

    *Подтверждение изменений*

<a id="ApxBTask3"></a>

<a id="Task_3_-_Publishing_an_ASPNET_MVC_4_Application_using_Web_Deploy"></a>
#### <a name="task-3---publishing-an-aspnet-mvc-4-application-using-web-deploy"></a>Задача 3. Публикация приложения ASP.NET MVC 4 с помощью веб-развертывание

1. Вернитесь к решению ASP.NET MVC 4. В **Обозреватель решений**щелкните правой кнопкой мыши проект веб-сайта и выберите **опубликовать**.

    ![Публикация приложения](aspnet-mvc-4-models-and-data-access/_static/image43.png "Публикация приложения")

    *Публикация веб-сайта*
2. Импортируйте профиль публикации, сохраненный в первой задаче.

    ![Импорт профиля публикации](aspnet-mvc-4-models-and-data-access/_static/image44.png "Импорт профиля публикации")

    *Импорт профиля публикации*
3. Щелкните **проверить подключение**. После завершения проверки нажмите кнопку **Далее**.

    > [!NOTE]
    > Проверка завершится, когда появится зеленая галочка рядом с кнопкой проверить подключение.

    ![Проверка подключения](aspnet-mvc-4-models-and-data-access/_static/image45.png "Проверка подключения")

    *Проверка подключения*
4. На странице **Параметры** в разделе **базы данных** нажмите кнопку рядом с текстовым полем подключения к базе данных (т. е. **DefaultConnection**).

    ![Конфигурация веб-развертывания](aspnet-mvc-4-models-and-data-access/_static/image46.png "Конфигурация веб-развертывания")

    *Конфигурация веб-развертывания*
5. Настройте подключение к базе данных следующим образом.

   - В поле **имя сервера** введите URL-адрес сервера базы данных SQL с помощью префикса *TCP:* .
   - В окне **имя пользователя** введите имя для входа администратора сервера.
   - В окне **пароль** введите пароль для входа администратора сервера.
   - Введите новое имя базы данных.

     ![Настройка строки подключения к целевому объекту](aspnet-mvc-4-models-and-data-access/_static/image47.png "Настройка строки подключения к целевому объекту")

     *Настройка строки подключения к целевому объекту*
6. Нажмите кнопку **ОК**. При появлении запроса на создание базы данных нажмите кнопку **Да**.

    ![Создание базы данных](aspnet-mvc-4-models-and-data-access/_static/image48.png "Создание строки базы данных")

    *Создание базы данных*
7. Строка подключения, которая будет использоваться для подключения к базе данных SQL в Windows Azure, отображается в текстовом поле подключения по умолчанию. Затем нажмите кнопку **Далее**.

    ![Строка подключения, указывающая на базу данных SQL](aspnet-mvc-4-models-and-data-access/_static/image49.png "Строка подключения, указывающая на базу данных SQL")

    *Строка подключения, указывающая на базу данных SQL*
8. На странице **Предварительный просмотр** нажмите кнопку **опубликовать**.

    ![Публикация веб-приложения](aspnet-mvc-4-models-and-data-access/_static/image50.png "Публикация веб-приложения")

    *Публикация веб-приложения*
9. По завершении процесса публикации браузер по умолчанию будет открывать опубликованный веб-сайт.

<a id="AppendixC"></a>

<a id="Appendix_C_Using_Code_Snippets"></a>
## <a name="appendix-c-using-code-snippets"></a>Приложение в. Использование фрагментов кода

С помощью фрагментов кода вы можете получить все необходимые вам коды. В лабораторном документе вы узнаете, когда можно использовать их, как показано на следующем рисунке.

![Использование фрагментов кода Visual Studio для вставки кода в проект](aspnet-mvc-4-models-and-data-access/_static/image51.png "Использование фрагментов кода Visual Studio для вставки кода в проект")

*Использование фрагментов кода Visual Studio для вставки кода в проект*

***Добавление фрагмента кода с помощью клавиатуры (C# только)***

1. Поместите курсор в то место, куда вы хотите вставить код.
2. Начните вводить имя фрагмента (без пробелов или дефисов).
3. Посмотрите, как IntelliSense отображает соответствующие имена фрагментов кода.
4. Выберите правильный фрагмент кода (или вводите его, пока не будет выбрано имя всего фрагмента).
5. Дважды нажмите клавишу TAB, чтобы вставить фрагмент в позицию курсора.

![Начните вводить имя фрагмента](aspnet-mvc-4-models-and-data-access/_static/image52.png "Начните вводить имя фрагмента")

*Начните вводить имя фрагмента*

![Нажмите клавишу TAB, чтобы выбрать выделенный фрагмент.](aspnet-mvc-4-models-and-data-access/_static/image53.png "Нажмите клавишу TAB, чтобы выбрать выделенный фрагмент.")

*Нажмите клавишу TAB, чтобы выбрать выделенный фрагмент.*

![Снова нажмите клавишу TAB, и фрагмент развернется](aspnet-mvc-4-models-and-data-access/_static/image54.png "Снова нажмите клавишу TAB, и фрагмент развернется")

*Снова нажмите клавишу TAB, и фрагмент развернется*

***Добавление фрагмента кода с помощью мыши (C#, Visual Basic и XML)*** одного. Щелкните правой кнопкой мыши место, куда нужно вставить фрагмент кода.

1. Выберите **Вставить фрагмент** , за которым следуют **фрагменты кода**.
2. Выберите соответствующий фрагмент из списка, щелкнув его.

![Щелкните правой кнопкой мыши место, куда нужно вставить фрагмент кода, и выберите пункт Вставить фрагмент.](aspnet-mvc-4-models-and-data-access/_static/image55.png "Щелкните правой кнопкой мыши место, куда нужно вставить фрагмент кода, и выберите пункт Вставить фрагмент.")

*Щелкните правой кнопкой мыши место, куда нужно вставить фрагмент кода, и выберите пункт Вставить фрагмент.*

![Выберите соответствующий фрагмент из списка, щелкнув его.](aspnet-mvc-4-models-and-data-access/_static/image56.png "Выберите соответствующий фрагмент из списка, щелкнув его.")

*Выберите соответствующий фрагмент из списка, щелкнув его.*
