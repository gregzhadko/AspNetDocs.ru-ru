---
uid: mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-7
title: Часть 7. Членство и авторизация | Документация Майкрософт
author: jongalloway
description: В этой серии руководств описаны все шаги, необходимые для построения примера приложения ASP.NET MVC Music Store. Часть 7 охватывает членство и авторизация.
ms.author: riande
ms.date: 10/13/2010
ms.assetid: c8511ebe-68bc-4240-87c3-d5ced84a3f37
msc.legacyurl: /mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-7
msc.type: authoredcontent
ms.openlocfilehash: 44205f0ef59e00ad9fb1c45fdc0ba8934b5804cc
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/01/2019
ms.locfileid: "57060431"
---
<a name="part-7-membership-and-authorization"></a>Часть 7. Членство и авторизация
====================
по [Джон Гэллоуэй](https://github.com/jongalloway)

> Store музыки MVC является учебного приложения, которое вводятся и описываются пошаговые использование ASP.NET MVC и Visual Studio для разработки веб-приложений.  
>   
> Store музыки MVC — это реализация хранилища упрощенный пример, который продает музыкальные альбомы через Интернет и реализует базовый сайт администрирования, вход пользователя и корзины для покупок функциональные возможности.  
>   
> В этой серии руководств описаны все шаги, необходимые для построения примера приложения ASP.NET MVC Music Store. Часть 7 охватывает членство и авторизация.


Нашего контроллера Store Manager в настоящее время доступен всем, посетите наш сайт. Изменим его, чтобы ограничить разрешения для администраторов сайта.

## <a name="adding-the-accountcontroller-and-views"></a>Добавление AccountController и представлений

Отличие между полным шаблоном веб-приложение ASP.NET MVC 3 и шаблон ASP.NET MVC 3 пустое веб-приложение в том, что пустой шаблон не включает контроллер учетной записи. Мы добавим контроллера учетных записей путем копирования нескольких файлов из нового приложения ASP.NET MVC, созданные на основе полного шаблона веб-приложение ASP.NET MVC 3.

Создайте новое приложение ASP.NET MVC с помощью полного шаблона веб-приложение ASP.NET MVC 3 и скопируйте следующие файлы в те же каталоги, в нашем проекте:

1. Скопируйте AccountController.cs в каталоге Controllers
2. Скопируйте AccountModels в каталоге моделей
3. Создание учетной записи каталога в каталоге Views и скопируйте все четыре представления в

Измените пространство имен для классов контроллера и модели, чтобы они начинались с MvcMusicStore. Класс AccountController следует использовать пространство имен MvcMusicStore.Controllers и AccountModels класс следует использовать пространство имен MvcMusicStore.Models.

*Примечание. Эти файлы также доступны в загружаемом MvcMusicStore Assets.zip, из которого мы наш сайт разработки файлы скопированы в начале этого руководства. Членство в файлы расположены в каталоге кода.*

Обновленное решение должно выглядеть следующим образом:

![](mvc-music-store-part-7/_static/image1.png)

## <a name="adding-an-administrative-user-with-the-aspnet-configuration-site"></a>Добавление администратора с веб-сайт конфигурации ASP.NET

Прежде чем мы требовать авторизации в наш веб-сайт, необходимо создать пользователя с доступом. Самый простой способ создать пользователя является использование встроенных веб-сайт конфигурации ASP.NET.

Запустите веб-сайт конфигурации ASP.NET, щелкнув следующий значок в обозревателе решений.

![](mvc-music-store-part-7/_static/image2.png)

Откроется веб-сайт конфигурации. Щелкните на вкладке "Безопасность" на начальном экране, а затем щелкните ссылку «Включить роли» в центре экрана.

![](mvc-music-store-part-7/_static/image3.png)

Щелкните ссылку «Создать "или" Управление роли».

![](mvc-music-store-part-7/_static/image4.png)

Введите имя роли «Администратор» и нажмите кнопку "Добавить роль".

![](mvc-music-store-part-7/_static/image5.png)

Нажмите кнопку "Назад", а затем щелкните ссылку Создать пользователя с левой стороны.

![](mvc-music-store-part-7/_static/image6.png)

Заполните поля сведений пользователя в левой части, используя следующие сведения:

| **Поле** | **Значение** |
| --- | --- |
| **Имя пользователя** | Администратор |
| **Пароль** | / password123! |
| **Подтверждение пароля** | / password123! |
| **Электронная почта** | (любой адрес электронной почты будут работать) |
| **Контрольный вопрос** | (любое) |
| **Ответ на контрольный вопрос** | (любое) |

*Примечание. Конечно, можно использовать любой пароль, в которой вы хотите создать. Параметры безопасности по умолчанию пароль требуется пароль, который имеет 7 символов и содержит один специальный символ.*

Выберите роль администратора для этого пользователя и нажмите кнопку Create User.

![](mvc-music-store-part-7/_static/image7.png)

На этом этапе вы увидите сообщение о том, что пользователь успешно создан.

![](mvc-music-store-part-7/_static/image8.png)

Теперь можно закрыть окно браузера.

## <a name="role-based-authorization"></a>Авторизация на основе ролей

Теперь мы может ограничить доступ к StoreManagerController, используя атрибут [Authorize], указав, что пользователь должен быть в роль администратора для доступа к любого действия контроллера в классе.

[!code-csharp[Main](mvc-music-store-part-7/samples/sample1.cs)]

*Примечание. Можно поместить атрибут [Authorize] в методах определенное действие, а также на уровне класса контроллера.*

Теперь, перейдя к /StoreManager появляется диалоговое окно Вход в систему:

![](mvc-music-store-part-7/_static/image9.png)

После входа в систему с нашей новой учетной записи администратора, мы можем перейти на экран редактирования альбома как перед.

> [!div class="step-by-step"]
> [Назад](mvc-music-store-part-6.md)
> [Вперед](mvc-music-store-part-8.md)
