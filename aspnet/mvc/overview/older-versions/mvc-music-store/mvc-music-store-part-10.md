---
uid: mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-10
title: Часть 10. Окончательные обновления структуры навигации и проекта сайта, заключение | Документация Майкрософт
author: jongalloway
description: В этой серии руководств описаны все шаги, необходимые для построения примера приложения ASP.NET MVC Music Store. Часть 10 охватывает окончательные обновления структуры навигации и S...
ms.author: riande
ms.date: 04/21/2011
ms.assetid: 0c6e4c2f-fcdb-4978-9656-1990c6f15727
msc.legacyurl: /mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-10
msc.type: authoredcontent
ms.openlocfilehash: 48404f449ce2641bdff55b9ad75aa5eec1aee46b
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59403302"
---
# <a name="part-10-final-updates-to-navigation-and-site-design-conclusion"></a>Часть 10. Окончательные обновления структуры навигации и проекта сайта, заключение

по [Джон Гэллоуэй](https://github.com/jongalloway)

> Store музыки MVC является учебного приложения, которое вводятся и описываются пошаговые использование ASP.NET MVC и Visual Studio для разработки веб-приложений.  
>   
> Store музыки MVC — это реализация хранилища упрощенный пример, который продает музыкальные альбомы через Интернет и реализует базовый сайт администрирования, вход пользователя и корзины для покупок функциональные возможности.  
>   
> В этой серии руководств описаны все шаги, необходимые для построения примера приложения ASP.NET MVC Music Store. Часть 10 охватывает окончательные обновления структуры навигации и проекта сайта, заключение.


Мы завершили все основные функции по нашем сайте, но по-прежнему у нас есть некоторые возможности для добавления в структуру переходов узла, на домашней странице и странице Обзор Store.

## <a name="creating-the-shopping-cart-summary-partial-view"></a>Создание сводки частичного представления корзину для покупок

Необходимо предоставить количество элементов в корзине пользователя на всем сайте.

![](mvc-music-store-part-10/_static/image1.png)

Можно легко реализовать это путем создания частичного представления, который добавляется в нашей Site.master.

Как было показано ранее, контроллер ShoppingCart включает метод действия CartSummary, который возвращает частичного представления:

[!code-csharp[Main](mvc-music-store-part-10/samples/sample1.cs)]

Чтобы создать CartSummary частичного представления, представления/ShoppingCart папку правой кнопкой мыши и выберите Add View. Имя представления CartSummary, а также установите флажок «Создать частичное представление», как показано ниже.

![](mvc-music-store-part-10/_static/image2.png)

Частичное представление CartSummary выполняется очень просто — это просто ссылка в представление ShoppingCart Index, показывающий количество элементов в корзине. Полный код для CartSummary.cshtml выглядит следующим образом:

[!code-cshtml[Main](mvc-music-store-part-10/samples/sample2.cshtml)]

В любой страницы в узле, включая главный узел, с помощью метода Html.RenderAction, можно включить частичное представление. RenderAction требует указать имя действия («CartSummary») и имя контроллера («ShoppingCart») как ниже.

[!code-cshtml[Main](mvc-music-store-part-10/samples/sample3.cshtml)]

Перед добавлением узла макета, мы также создадим меню жанр для принятия всех новостей Site.master за один раз.

## <a name="creating-the-genre-menu-partial-view"></a>Создание меню частичного представления жанра

Нам сделать его намного проще для наших пользователей перейти в магазине, добавив меню жанра, в которой перечислены все жанры доступны в нашем магазине.

![](mvc-music-store-part-10/_static/image3.png)

Мы будем следовать же действия также создать GenreMenu частичного представления, а затем можно добавить оба главного узла. Во-первых добавьте следующее действие контроллера GenreMenu StoreController:

[!code-csharp[Main](mvc-music-store-part-10/samples/sample4.cs)]

Это действие возвращает список жанров, которые будут отображаться с частичного представления, который мы создадим Далее.

*Примечание. Мы добавили атрибут [ChildActionOnly] для этого действия контроллера, который указывает, что нам нужен только это действие для использования из частичного представления. Этот атрибут не позволит выполнить, перейдя по адресу /Store/GenreMenu действия контроллера. Это не является обязательным для частичных представлений, но рекомендуется, поскольку мы хотим убедиться, что наши действия контроллера используются как планировалось. Мы также возвращается PartialView, а не представление, позволяющее знать, что его не следует использовать макет для этого представления, так как он включен в других представлениях обработчик представлений.*

Щелкните правой кнопкой мыши на действие контроллера GenreMenu и создать частичное представление с именем GenreMenu, который является строго типизированным с помощью класса данных представления жанра, как показано ниже.

![](mvc-music-store-part-10/_static/image4.png)

Обновите код представления для частичного представления GenreMenu для отображения элементов, с помощью неупорядоченный список следующим образом.

[!code-cshtml[Main](mvc-music-store-part-10/samples/sample5.cshtml)]

## <a name="updating-site-layout-to-display-our-partial-views"></a>Обновление сайта макет для отображения наши частичного представления

Мы можем добавить наш частичные представления макета веб-узла (/представления/Общие/\_Layout.cshtml) путем вызова Html.RenderAction(). Мы добавим их обоих в, а также некоторые дополнительные разметки, чтобы отобразить их, как показано ниже:

[!code-cshtml[Main](mvc-music-store-part-10/samples/sample6.cshtml)]

Теперь при запуске приложения, мы увидим сводки для покупок в верхней и жанр в области навигации слева.

## <a name="update-to-the-store-browse-page"></a>Обновите страницу Обзор Store

На странице Обзор Store работает, но выглядит не очень хорошо. Мы можем обновить страницу, чтобы показать альбомов в улучшения макета, обновив код представления (находится в /Views/Store/Browse.cshtml) следующим образом:

[!code-cshtml[Main](mvc-music-store-part-10/samples/sample7.cshtml)]

Здесь мы выполняем использовать класс Url.Action, а не Html.ActionLink, что мы применить специальное форматирование к ссылку, чтобы включить изображения альбома.

*Примечание. Мы при отображении универсального обложкам эти альбомов. Эта информация хранится в базе данных и можно изменять с помощью Store Manager. Можно также добавить собственные рисунки.*

Теперь при просмотре мы жанр фильма, мы увидим альбомов, из сетки с иллюстрацией альбома.

![](mvc-music-store-part-10/_static/image5.png)

## <a name="updating-the-home-page-to-show-top-selling-albums"></a>Обновление домашней страницы для отображения наиболее продаваемых альбомов верхней

Мы хотим компонентов наши наиболее продаваемые альбомов на домашней странице для увеличения продаж. Сделаем некоторые обновления для наших HomeController для обработки и добавить некоторые дополнительные графики.

Во-первых мы добавим свойство навигации к нашему классу альбома, чтобы EntityFramework знал, что они связаны. Последние три строки из наших **альбома** класс теперь должен выглядеть следующим образом:

[!code-csharp[Main](mvc-music-store-part-10/samples/sample8.cs)]

*Примечание. В этом случае потребуется добавить с помощью инструкции, чтобы объединить в пространстве имен System.Collections.Generic.*

Во-первых мы добавим поле storeDB и MvcMusicStore.Models, с помощью инструкций, как в нашем другие контроллеры. Далее мы добавим следующий метод HomeController, который запрашивает top наиболее продаваемых альбомов в соответствии с OrderDetails нашей базы данных.

[!code-csharp[Main](mvc-music-store-part-10/samples/sample9.cs)]

Это частный метод, так как мы не хотим сделать ее доступной как действие контроллера. Мы его включением в HomeController для простоты, но рекомендуется для перемещения бизнес-логику в отдельную службу классы соответствующим образом.

С этим мы можем обновить действие контроллера индекс для запроса пять наиболее популярных альбомы и возвращать их в представление.

[!code-csharp[Main](mvc-music-store-part-10/samples/sample10.cs)]

Полный код для обновленных HomeController является, как показано ниже.

[!code-csharp[Main](mvc-music-store-part-10/samples/sample11.cs)]

Наконец нам потребуется обновить нашего Главная индекс представления так, чтобы отобразить список альбомов путем обновления типа модели и добавлении списка альбома нижней. Мы будет использовать эту возможность также добавить на страницу заголовка и раздела повышения роли.

[!code-cshtml[Main](mvc-music-store-part-10/samples/sample12.cshtml)]

Теперь при запуске приложения, мы увидим обновленные домашней страницы с верхней наиболее продаваемых альбомы и наши рекламные сообщения.

![](mvc-music-store-part-10/_static/image1.jpg)

## <a name="conclusion"></a>Заключение

Мы уже видели, что ASP.NET MVC упрощает создание сложных веб-сайт с помощью доступа к базе данных, членство, AJAX, и т.д. довольно быстро. Будем надеяться, что приведенная в этом учебнике вам инструменты, которые необходимо приступить к созданию собственных ASP.NET MVC приложений!


> [!div class="step-by-step"]
> [Назад](mvc-music-store-part-9.md)
