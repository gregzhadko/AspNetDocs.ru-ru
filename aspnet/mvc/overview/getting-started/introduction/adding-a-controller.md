---
uid: mvc/overview/getting-started/introduction/adding-a-controller
title: Добавление контроллера | Документация Майкрософт
author: Rick-Anderson
description: ''
ms.author: riande
ms.date: 10/17/2013
ms.assetid: cc764f3b-6921-486a-8f44-c6ccd1249acd
msc.legacyurl: /mvc/overview/getting-started/introduction/adding-a-controller
msc.type: authoredcontent
ms.openlocfilehash: ae3258872df798f52d8e031dc8ebf01b4f0a7358
ms.sourcegitcommit: 4e6d586faadbe4d9ef27122f86335ec9385134af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/28/2020
ms.locfileid: "89045134"
---
# <a name="adding-a-controller"></a>Добавление контроллера

по [Рик Андерсон (](https://twitter.com/RickAndMSFT)

[!INCLUDE [consider RP](~/includes/razor.md)]

MVC означает *модель-представление-контроллер*. MVC — это шаблон для разработки приложений, которые хорошо спроектированы, тестируемы и просты в обслуживании. Приложения на основе MVC содержат:

- **M** Оделс: классы, представляющие данные приложения и использующие логику проверки для применения бизнес-правил для этих данных.
- **V** редставления: файлы шаблонов, используемые приложением для динамического создания ответов HTML.
- **C** — это классы, которые обрабатывали входящие запросы браузера, извлекают данные модели, а затем указывают шаблоны представлений, которые возвращают ответ в браузер.

Мы покажем все эти концепции в этой серии руководств и покажем, как их использовать для создания приложения.

Начнем с создания класса Controller. В **Обозреватель решений**щелкните правой кнопкой мыши папку *Controllers* и выберите команду **добавить**, а затем — **контроллер**.

![](adding-a-controller/_static/image1.png)

В диалоговом окне **Добавление шаблона** щелкните элемент **контроллер MVC 5 — пустой**и нажмите кнопку **добавить**.

![](adding-a-controller/_static/image2.png)  

Присвойте новому контроллеру имя "HelloWorldController" и нажмите кнопку **Добавить**.

![добавить контроллер](adding-a-controller/_static/image3.png)

Обратите внимание, что в **Обозреватель решений** создан новый файл с именем *HelloWorldController.CS* и Новая папка *виевс\хелловорлд*. Контроллер открыт в интегрированной среде разработки.

![](adding-a-controller/_static/image4.png)

Замените содержимое файла на код, приведенный ниже.

[!code-csharp[Main](adding-a-controller/samples/sample1.cs)]

В качестве примера методы контроллера будут возвращать строку HTML. Контроллеру присваивается имя `HelloWorldController` , а первым методу присваивается имя `Index` . Давайте выберем его из браузера. Запустите приложение (нажмите клавишу F5 или CTRL + F5). В браузере добавьте &quot; HelloWorld &quot; к пути в адресной строке. (Например, на рисунке ниже, это `http://localhost:1234/HelloWorld.` ) Страница в браузере будет выглядеть, как на следующем снимке экрана. В приведенном выше методе код возвратил строку напрямую. Вы сообщили системе, что просто возвращали какой-либо код HTML.

![](adding-a-controller/_static/image5.png)

ASP.NET MVC вызывает различные классы контроллеров (и различные методы действий в них) в зависимости от входящего URL-адреса. Логика маршрутизации URL-адресов по умолчанию, используемая ASP.NET MVC, использует следующий формат для определения того, какой код вызывать:

`/[Controller]/[ActionName]/[Parameters]`

Формат маршрутизации задается в файле * \_ Start/раутеконфиг. CS приложения* .

[!code-csharp[Main](adding-a-controller/samples/sample2.cs?highlight=7-8)]

При запуске приложения и отсутствии сегментов URL-адреса по умолчанию используется "домашний" контроллер и метод действия "index", указанный в разделе по умолчанию приведенного выше кода.

Первая часть URL-адреса определяет класс контроллера для выполнения. Поэтому */хелловорлд* сопоставляется с `HelloWorldController` классом. Вторая часть URL-адреса определяет метод действия для выполняемого класса. Поэтому */хелловорлд/индекс* приведет к `Index` `HelloWorldController` выполнению метода класса. Обратите внимание, что нам пришлось бы перейти к */хелловорлд* , а метод использовался `Index` по умолчанию. Это обусловлено тем, что метод с именем `Index` является методом по умолчанию, который будет вызываться на контроллере, если он не указан явно. В третьей части сегмента URL-адреса (`Parameters`) указываются данные маршрута. Далее в этом руководстве мы увидим данные маршрутизации.

Перейдите по адресу `http://localhost:xxxx/HelloWorld/Welcome`. `Welcome`Метод выполняет операцию и возвращает строку, &quot; которая является методом действия приветствия... &quot; По умолчанию используется сопоставление MVC `/[Controller]/[ActionName]/[Parameters]` . Для этого URL-адреса заданы контроллер `HelloWorld` и метод действия `Welcome`. Часть URL-адреса `[Parameters]` на данный момент еще не использовалась.

![](adding-a-controller/_static/image6.png)

Давайте немного изменим пример, чтобы вы могли передать некоторые сведения о параметрах с URL-адреса на контроллер (например, */хелловорлд/велкоме? Name = Скотт &amp; нумтимес = 4*). Измените `Welcome` метод, включив в него два параметра, как показано ниже. Обратите внимание, что в коде используется функция необязательного параметра C#, указывающая, что `numTimes` параметру по умолчанию будет присвоено значение 1, если для этого параметра не передается никакого значения

[!code-csharp[Main](adding-a-controller/samples/sample3.cs)]

> [!NOTE]
> Примечание о безопасности. в приведенном выше коде используется [HttpUtility.Htmленкоде](https://msdn.microsoft.com/library/ee360286(v=vs.110).aspx) для защиты приложения от вредоносных входных данных (а именно — JavaScript). Дополнительные сведения см. в статье [Защита от эксплойтов сценариев в веб-приложении путем применения кодировки HTML к строкам](https://msdn.microsoft.com/library/a2a4yykt(v=vs.100).aspx).

 Запустите приложение и перейдите по URL-адресу примера ( `http://localhost:xxxx/HelloWorld/Welcome?name=Scott&numtimes=4` ). Вы можете попробовать различные значения `name` и `numtimes` в URL-адресе. [Система привязки модели MVC ASP.NET](http://odetocode.com/Blogs/scott/archive/2009/04/27/6-tips-for-asp-net-mvc-model-binding.aspx) автоматически сопоставляет именованные параметры из строки запроса в адресной строке с параметрами в методе.

![](adding-a-controller/_static/image7.png)

В приведенном выше примере сегмент URL-адреса ( `Parameters` ) не используется, `name` Параметры и `numTimes` передаются как [строки запроса](http://en.wikipedia.org/wiki/Query_string). Знак вопроса (вопросительный знак) в приведенном выше URL-адресе — это разделитель, и следуют строки запроса. Символ &amp; разделяет строки запроса.

Замените метод приветствия следующим кодом:

[!code-csharp[Main](adding-a-controller/samples/sample4.cs)]

Запустите приложение и введите следующий URL-адрес: `http://localhost:xxx/HelloWorld/Welcome/1?name=Scott`

![](adding-a-controller/_static/image8.png)

На этот раз третий сегмент URL-адреса соответствует параметру `ID.` маршрута `Welcome` метод действия содержит параметр ( `ID` ), соответствующий спецификации URL-адреса в `RegisterRoutes` методе.

[!code-csharp[Main](adding-a-controller/samples/sample5.cs?highlight=7)]

В приложениях ASP.NET MVC обычно передаются параметры в виде данных маршрута (как мы делали с помощью приведенного выше идентификатора), чем передача их в виде строк запроса. Можно также добавить маршрут для передачи `name` `numtimes` параметров и in в качестве данных маршрута в URL-адресе. В файле * \_ старт\раутеконфиг.КС приложения* Добавьте маршрут Hello:

[!code-csharp[Main](adding-a-controller/samples/sample6.cs?highlight=13-16)]

Запустите приложение и перейдите к `/localhost:XXX/HelloWorld/Welcome/Scott/3` .

![](adding-a-controller/_static/image9.png)

Для многих приложений MVC маршрут по умолчанию работает нормально. Далее в этом руководстве вы узнаете, как передавать данные с помощью связывателя модели, и вам не придется изменять маршрут по умолчанию для этого.

В этих примерах контроллер выполняет &quot; VC- &quot; часть MVC, т. е. представление и контроллер работают. Контроллер возвращает HTML напрямую. Обычно вы не хотите, чтобы контроллеры возвращали HTML напрямую, так как это очень громоздкий для кода. Вместо этого мы обычно используем отдельный файл шаблона представления для создания ответа HTML. Давайте посмотрим, как это можно сделать.

> [!div class="step-by-step"]
> [Назад](getting-started.md)
> [Вперед](adding-a-view.md)
