---
uid: mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application
title: Руководство. Начало работы с Entity Framework 6 Code First с помощью MVC 5 | Документация Майкрософт
description: В этой серии руководств вы узнаете, как создать приложение ASP.NET MVC 5, которое использует Entity Framework 6 для доступа к данным.
author: tdykstra
ms.author: riande
ms.date: 01/22/2019
ms.topic: tutorial
ms.assetid: 00bc8b51-32ed-4fd3-9745-be4c2a9c1eaf
msc.legacyurl: /mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application
msc.type: authoredcontent
ms.openlocfilehash: a00a5a3aa295c2584b90abbf931c258c9e1b58ca
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78499410"
---
# <a name="tutorial-get-started-with-entity-framework-6-code-first-using-mvc-5"></a>Руководство. Начало работы с Entity Framework 6 Code First с помощью MVC 5

> [!NOTE]
> Для новой разработки рекомендуется [ASP.NET Core Razor Pages](/aspnet/core/razor-pages) с контроллерами и ПРЕДСТАВЛЕНИЯМИ MVC ASP.NET. Серию руководств, аналогичную этой, с помощью Razor Pages см. [в разделе Учебник. Начало работы с Razor Pages в ASP.NET Core](/aspnet/core/tutorials/razor-pages/razor-pages-start). Новое руководство:
> * проще для выполнения;
> * содержит больше рекомендаций по EF Core;
> * использует более эффективные запросы;
> * более актуально, так как используются новейшие API;
> * охватывает дополнительные возможности;
> * является предпочтительным подходом для разработки новых приложений.

В этой серии руководств вы узнаете, как создать приложение ASP.NET MVC 5, которое использует Entity Framework 6 для доступа к данным. В этом руководстве используется рабочий процесс Code First. Сведения о выборе между Code First, Database First и Model First см. [в разделе Создание модели](/ef/ef6/modeling/).

В этой серии руководств объясняется, как создать пример приложения университета Contoso. Пример приложения — это простой веб-сайт университета. С его помощью можно просматривать и обновлять сведения об учащихся, курсах и преподавателях. Ниже приведены два создаваемых экрана.

![Students_Index_page](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/_static/image1.png)

![Изменить учащийся](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/_static/image2.png)

Изучив это руководство, вы:

> [!div class="checklist"]
> * Создание веб-приложения MVC
> * Настройка стиля сайта
> * Установка Entity Framework 6
> * Создание модели данных
> * Создание контекста базы данных
> * Инициализация базы данных с тестовыми данными
> * Настройка EF 6 для использования LocalDB
> * Создание контроллера и представлений
> * Просмотр базы данных

## <a name="prerequisites"></a>предварительные требования

* [Visual Studio 2017](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=button+cta&utm_content=download+vs2017)

## <a name="create-an-mvc-web-app"></a>Создание веб-приложения MVC

1. Откройте Visual Studio и создайте C# веб-проект с помощью шаблона **веб-приложения ASP.NET (.NET Framework)** . Присвойте проекту имя *ContosoUniversity* и нажмите кнопку **ОК**.

   ![Диалоговое окно "Создание проекта" в Visual Studio](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/_static/new-project-dialog.png)

1. В **новом веб-приложении ASP.NET — ContosoUniversity**выберите **MVC**.

   ![Диалоговое окно "Создание веб-приложения" в Visual Studio](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/_static/new-web-app-dialog.png)

    > [!NOTE]
    > По умолчанию параметр **authentication** имеет значение **без проверки подлинности**. В этом руководстве для веб-приложения пользователи не должны входить в систему. Кроме того, он не ограничивает доступ в зависимости от того, кто вошел в систему.

1. Чтобы создать проект, щелкните **ОК**.

## <a name="set-up-the-site-style"></a>Настройка стиля сайта

Выполните незначительную настройку меню, макета и домашней страницы сайта.

1. Откройте *Views\Shared\\_layout. cshtml*и внесите следующие изменения:

   - Измените каждое вхождение «мое приложение ASP.NET» и «имя приложения» на «университет Contoso».
   - Добавьте пункты меню для учащихся, курсов, преподавателей и отделов и удалите контактную запись.

   Изменения выделены в следующем фрагменте кода:

   [!code-cshtml[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample1.cshtml?highlight=6,19,24-27,38)]

2. В *Views\Home\Index.cshtml*замените содержимое файла следующим кодом, чтобы заменить текст о ASP.NET и MVC текстом, посвященным этому приложению:

   [!code-cshtml[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample2.cshtml)]

3. Нажмите клавиши CTRL + F5, чтобы запустить веб-сайт. Домашняя страница отображается в главном меню.

## <a name="install-entity-framework-6"></a>Установка Entity Framework 6

1. В меню **Сервис** выберите **Диспетчер пакетов NuGet**, а затем выберите **консоль диспетчера пакетов**.

2. В окне **Консоль диспетчера пакетов** введите следующую команду:

   ```text
   Install-Package EntityFramework
   ```

Этот шаг состоит из нескольких шагов, которые можно выполнить в этом руководстве вручную, но это могло быть сделано автоматически с помощью функции формирования шаблонов ASP.NET MVC. Их можно выполнить вручную, чтобы увидеть шаги, необходимые для использования Entity Framework (EF). Позднее формирование шаблонов будет использоваться для создания контроллера и представлений MVC. Альтернативой является возможность формирования шаблонов автоматически устанавливать пакет EF NuGet, создать класс контекста базы данных и создать строку подключения. Когда все будет готово, все, что нужно сделать, — пропустить эти шаги и сформировать шаблон контроллера MVC после создания классов сущностей.

## <a name="create-the-data-model"></a>Создание модели данных

Теперь необходимо создать классы сущностей для приложения университета Contoso. Начнем с следующих трех сущностей:

**Курс** <-> **регистрации** <-> **учащийся**

| Сущности | Связь |
| -------- | ------------ |
| Курс регистрации | Один ко многим |
| Регистрация учащихся | Один ко многим |

Между сущностями `Student` и `Enrollment`, а также между сущностями `Course` и `Enrollment` существует отношение "один ко многим". Другими словами, учащийся может быть зарегистрирован в любом количестве курсов, а в отдельном курсе может быть зарегистрировано любое количество учащихся.

В следующих разделах вы создадите класс для каждой из этих сущностей.

> [!NOTE]
> Если вы попытаетесь скомпилировать проект до завершения создания всех этих классов сущностей, вы получите ошибки компилятора.

### <a name="the-student-entity"></a>Сущность Student

- В папке *Models* создайте файл класса с именем *Student.CS* , щелкнув правой кнопкой мыши папку в **обозреватель решений** и выбрав пункт **Добавить** > **класс**. Замените код шаблона следующим кодом:

   [!code-csharp[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample3.cs)]

Свойство `ID` будет использоваться в качестве столбца первичного ключа в таблице базы данных, соответствующей этому классу. По умолчанию Entity Framework интерпретирует свойство с именем `ID` или *classname* `ID` в качестве первичного ключа.

Свойство `Enrollments` является *свойством навигации*. Свойства навигации содержат другие сущности, связанные с этой сущностью. В этом случае свойство `Enrollments` сущности `Student` будет содержать все `Enrollment` сущности, связанные с этой сущностью `Student`. Иными словами, если данная строка `Student` в базе данных содержит две связанные `Enrollment` строки (строки, которые содержат значение первичного ключа учащегося в их `StudentID` внешнем ключевом столбце), то `Student` `Enrollments`ной сущности будут содержать эти две `Enrollment` сущности.

Свойства навигации обычно определяются как `virtual`, чтобы они могли воспользоваться преимуществами определенных Entity Frameworkных функций, таких как *Отложенная загрузка*. (Отложенная загрузка будет объяснена позже, в руководстве по [чтению связанных данных](reading-related-data-with-the-entity-framework-in-an-asp-net-mvc-application.md) далее в этой серии.)

Если свойство навигации может содержать несколько сущностей (как в отношениях "многие ко многим" или "один ко многим"), оно должно иметь тип списка, допускающий добавление, удаление и обновление записей, такой как `ICollection`.

### <a name="the-enrollment-entity"></a>Сущность Enrollment

- В папке *Models* создайте файл *Enrollment.cs* и замените существующий код следующим кодом:

   [!code-csharp[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample4.cs)]

Свойство `EnrollmentID` будет первичным ключом; Эта сущность использует шаблон `ID` *className* вместо `ID` сама по себе, как показано в `Student` сущности. Как правило, следует выбирать один шаблон, который будет использоваться в рамках всей модели данных. В этом случае демонстрируется возможность использования любого из шаблонов. В последующем учебнике вы узнаете, как использование `ID` без `classname` упрощает реализацию наследования в модели данных.

Свойство `Grade` является [перечислением](/ef/ef6/modeling/code-first/data-types/enums). Знак вопроса после объявления типа `Grade` указывает, что свойство `Grade`[допускает значение NULL](/dotnet/csharp/programming-guide/nullable-types/using-nullable-types). Оценка, имеющая значение null, отличается от нулевой — значение NULL означает, что категория не известна или еще не была назначена.

Свойство `StudentID` представляет собой внешний ключ. Ему соответствует свойство навигации `Student`. Сущность `Enrollment` связана с одной сущностью `Student`, поэтому это свойство может содержать одну сущность `Student` (в отличие от представленного ранее свойства навигации `Student.Enrollments`, которое может содержать несколько сущностей `Enrollment`).

Свойство `CourseID` представляет собой внешний ключ. Ему соответствует свойство навигации `Course`. Сущность `Enrollment` связана с одной сущностью `Course`.

Entity Framework интерпретирует свойство как свойство внешнего ключа, если оно называется *&lt;имя свойства навигации&gt;&lt;имя свойства первичного ключа&gt;* (например, `StudentID` для свойства навигации `Student`, так как первичный ключ `Student` сущности `ID`). Свойства внешнего ключа также можно назвать тем же просто *&lt;имени свойства первичного ключа&gt;* (например, `CourseID`, так как первичный ключ `Course` сущности `CourseID`).

### <a name="the-course-entity"></a>Сущность Course

- В папке *Models* создайте *Course.CS*, заменив Код шаблона следующим кодом:

   [!code-csharp[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample5.cs)]

Свойство `Enrollments` является свойством навигации. Сущность `Course` может быть связана с любым числом сущностей `Enrollment`.

Дополнительные сведения об атрибуте <xref:System.ComponentModel.DataAnnotations.Schema.DatabaseGeneratedAttribute> см. в последующем учебнике этой серии. Фактически, этот атрибут позволяет ввести первичный ключ для курса, а не использовать базу данных, чтобы создать его.

## <a name="create-the-database-context"></a>Создание контекста базы данных

Класс main, который координирует Entity Framework функциональные возможности для конкретной модели данных, является классом *контекста базы данных* . Этот класс создается путем наследования от класса [System. Data. Entity. DbContext](https://msdn.microsoft.com/library/system.data.entity.dbcontext(v=vs.113).aspx) . В коде вы указываете, какие сущности включены в модель данных. Также вы можете настроить реакцию платформы Entity Framework на некоторые события. В этом проекте соответствующий класс называется `SchoolContext`.

- Чтобы создать папку в проекте ContosoUniversity, щелкните правой кнопкой мыши проект в **Обозреватель решений** и нажмите кнопку **Добавить**, а затем выберите пункт **создать папку**. Назовите новую папку *DAL* (для уровня доступа к данным). В этой папке создайте новый файл класса с именем *SchoolContext.CS*и замените код шаблона следующим кодом:

   [!code-csharp[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample6.cs)]

### <a name="specify-entity-sets"></a>Указание наборов сущностей

Этот код создает свойство [DbSet](https://msdn.microsoft.com/library/system.data.entity.dbset(v=vs.113).aspx) для каждого набора сущностей. В терминологии Entity Framework *набор сущностей* обычно соответствует таблице базы данных, а *сущность* соответствует строке в таблице.

> [!NOTE]
>
> Можно опустить операторы `DbSet<Enrollment>` и `DbSet<Course>`, и это будет работать одинаково. Entity Framework будет включать их неявно, так как сущность `Student` ссылается на сущность `Enrollment`, а `Enrollment` сущность ссылается на сущность `Course`.

### <a name="specify-the-connection-string"></a>Укажите строку подключения

Имя строки подключения (которое будет добавлено в файл Web. config позже) передается в конструктор.

[!code-csharp[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample7.cs?highlight=1)]

Можно также передать саму строку подключения, а не имя, которое хранится в файле Web. config. Дополнительные сведения о параметрах для указания используемой базы данных см. в разделе [строки подключения и модели](/ef/ef6/fundamentals/configuring/connection-strings).

Если вы не укажете строку соединения или имя явным образом, Entity Framework предполагает, что имя строки подключения совпадает с именем класса. Имя строки подключения по умолчанию в этом примере будет `SchoolContext`, то же, что и то, что вы указываете явно.

### <a name="specify-singular-table-names"></a>Укажите имена таблиц в единственном числе

Инструкция `modelBuilder.Conventions.Remove` в методе [OnModelCreating](https://msdn.microsoft.com/library/system.data.entity.dbcontext.onmodelcreating(v=vs.103).aspx) предотвращает множественное преобразование имен таблиц. Если этого не сделать, созданные таблицы в базе данных будут называться `Students`, `Courses`и `Enrollments`. Вместо этого имена таблиц будут `Student`, `Course`и `Enrollment`. В среде разработчиков нет единого мнения о том, следует ли использовать имена таблиц во множественном числе. В этом руководстве используется форма единственного числа, но важно отметить, что вы можете выбрать любую из этих форм, включив или опустив эту строку кода.

## <a name="initialize-db-with-test-data"></a>Инициализация базы данных с тестовыми данными

Entity Framework может автоматически создавать (или удалять и повторно создавать) базу данных при запуске приложения. Можно указать, что это должно выполняться при каждом запуске приложения или только в случае, если модель не синхронизирована с существующей базой данных. Можно также написать `Seed` метод, который Entity Framework автоматически вызывается после создания базы данных, чтобы заполнить ее тестовыми данными.

По умолчанию база данных создается только в том случае, если она не существует (и вызывает исключение, если модель изменилась и база данных уже существует). В этом разделе вы укажете, что база данных должна быть удалена и создана повторно при каждом изменении модели. Удаление базы данных приводит к утрате всех данных. Как правило, это нормально во время разработки, поскольку при повторном создании базы данных и повторном создании тестовых данных будет выполняться метод `Seed`. Но в рабочей среде обычно не требуется терять все данные каждый раз, когда необходимо изменить схему базы данных. Далее вы узнаете, как управлять изменениями модели с помощью Code First Migrations для изменения схемы базы данных вместо удаления и повторного создания базы данных.

1. В папке DAL создайте новый файл класса с именем *SchoolInitializer.CS* и замените код шаблона следующим кодом, который вызывает создание базы данных при необходимости и загружает тестовые данные в новую базу данных.

   [!code-csharp[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample8.cs)]

   Метод `Seed` принимает объект контекста базы данных в качестве входного параметра, а код в методе использует этот объект для добавления новых сущностей в базу данных. Для каждого типа сущности код создает коллекцию новых сущностей, добавляет их в соответствующее свойство `DbSet`, а затем сохраняет изменения в базе данных. Не нужно вызывать метод `SaveChanges` после каждой группы сущностей, как это сделано здесь, но это помогает узнать источник проблемы, если во время записи кода в базу данных возникает исключение.

2. Чтобы указать Entity Framework использовать класс инициализатора, добавьте элемент в элемент `entityFramework` в файле *Web. config* приложения (в корневой папке проекта), как показано в следующем примере:

   [!code-xml[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample9.xml?highlight=2-6)]

   `context type` указывает полное имя класса контекста и сборку, в которой он находится, а `databaseinitializer type` указывает полное имя класса инициализатора и сборку, в которой он находится. (Если не нужно, чтобы EF использовал инициализатор, можно задать атрибут для элемента `context`: `disableDatabaseInitialization="true"`.) Дополнительные сведения см. в разделе [Параметры файла конфигурации](/ef/ef6/fundamentals/configuring/config-file).

   Альтернативой заданию инициализатора в файле *Web. config* является это сделать в коде, добавив оператор `Database.SetInitializer` в метод `Application_Start` в файле *Global.asax.CS* . Дополнительные сведения см. [в разделе Основные сведения об инициализаторах баз данных в Entity Framework Code First](http://www.codeguru.com/csharp/article.php/c19999/Understanding-Database-Initializers-in-Entity-Framework-Code-First.htm).

Теперь приложение настроено таким образом, что при первом обращении к базе данных в заданном запуске приложения Entity Framework сравнивает базу данных с моделью (ваша `SchoolContext` и классы сущностей). При наличии разницы приложение удаляет и повторно создает базу данных.

> [!NOTE]
> При развертывании приложения на рабочем веб-сервере необходимо удалить или отключить код, который удаляет и повторно создает базу данных. Это можно сделать в последующем учебнике этой серии.

## <a name="set-up-ef-6-to-use-localdb"></a>Настройка EF 6 для использования LocalDB

[LocalDB](/sql/database-engine/configure-windows/sql-server-2016-express-localdb?view=sql-server-2017) — это упрощенная версия ядра СУБД SQL Server Express. Его легко установить и настроить, запустить по запросу и запустить в пользовательском режиме. LocalDB выполняется в специальном режиме выполнения SQL Server Express, который позволяет работать с базами данных в виде *MDF* -файлов. Файлы базы данных LocalDB можно поместить в папку *данных приложения\_* веб-проекта, если требуется скопировать базу данных вместе с проектом. Функция пользовательского экземпляра в SQL Server Express также позволяет работать с *MDF* -файлами, но функция пользовательского экземпляра является устаревшей. Поэтому для работы с *MDF* -файлами рекомендуется использовать LocalDB. LocalDB устанавливается по умолчанию в Visual Studio.

Как правило, SQL Server Express не используется для рабочих веб-приложений. LocalDB в частности не рекомендуется для использования в рабочей среде с веб-приложением, поскольку оно не предназначено для работы с IIS.

- В этом руководстве вы будете работать с LocalDB. Откройте файл *Web. config* приложения и добавьте элемент `connectionStrings` перед элементом `appSettings`, как показано в следующем примере. (Убедитесь, что вы обновляете файл *Web. config* в корневой папке проекта. Существует также файл *Web. config* в подпапке *views* , которую не нужно обновлять.)

   [!code-xml[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample10.xml?highlight=1-3)]

Добавленная строка подключения указывает, что Entity Framework будет использовать базу данных LocalDB с именем *ContosoUniversity1. mdf*. (База данных пока не существует, но EF создаст ее.) Если вы хотите создать базу данных в папке *приложения\_данных* , можно добавить `AttachDBFilename=|DataDirectory|\ContosoUniversity1.mdf` в строку подключения. Дополнительные сведения о строках подключения см. в разделе [SQL Server строки подключения для веб-приложений ASP.NET](/previous-versions/aspnet/jj653752(v=vs.110)).

В файле *Web. config* действительно не требуется строка подключения. Если строка подключения не указана, Entity Framework использует строку подключения по умолчанию на основе класса контекста. Дополнительные сведения см. [в разделе Code First к новой базе данных](/ef/ef6/modeling/code-first/workflows/new-database).

## <a name="create-controller-and-views"></a>Создание контроллера и представлений

Теперь вы создадите веб-страницу для вывода данных. Процесс запроса данных автоматически инициирует создание базы данных. Начнем с создания нового контроллера. Но прежде чем это сделать, постройте проект, чтобы сделать классы модели и контекста доступными для формирования шаблонов контроллера MVC.

1. Щелкните правой кнопкой мыши папку **Controllers** в **Обозреватель решений**, выберите **добавить**, а затем — новый шаблонный **элемент**.
2. В диалоговом окне **Добавление шаблона** выберите **контроллер MVC 5 с представлениями с помощью Entity Framework**и нажмите кнопку **добавить**.

     ![Диалоговое окно "Добавление шаблона" в Visual Studio](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/_static/add-scaffold.png)

3. В диалоговом окне **Добавление контроллера** выберите следующие параметры, а затем нажмите кнопку **Добавить**.

   - Класс модели: **Student (ContosoUniversity. Models)** . (Если этот параметр не отображается в раскрывающемся списке, выполните сборку проекта и повторите попытку.)
   - Класс контекста данных: **SchoolContext (ContosoUniversity. DAL)** .
   - Имя контроллера: **студентконтроллер** (не StudentsController).
   - Оставьте значения по умолчанию для других полей.

     При нажатии кнопки **Добавить**создается файл *StudentController.CS* и набор представлений (*CSHTML* -файлов), которые работают с контроллером. В будущем при создании проектов, использующих Entity Framework, можно также воспользоваться некоторыми дополнительными функциональными возможностями средства формирования шаблонов: создать первый класс модели, не создавать строку подключения, а затем в поле **Добавить контроллер** укажите **новый контекст данных** , нажав кнопку **+** рядом с **классом контекста данных**. Формирование шаблонов создаст класс `DbContext` и строку подключения, а также контроллер и представления.
4. Visual Studio откроет файл *контроллерс\студентконтроллер.КС* . Вы видите, что создана переменная класса, которая создает экземпляр объекта контекста базы данных:

     [!code-csharp[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample11.cs)]

     Метод действия `Index` возвращает список учащихся из набора сущностей *Student* , считывая свойство `Students` экземпляра контекста базы данных:

     [!code-csharp[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample12.cs)]

     В представлении *студент\индекс.кштмл* этот список отображается в таблице:

     [!code-cshtml[Main](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/samples/sample13.cshtml)]
5. Чтобы запустить проект, нажмите сочетание клавиш CTRL+F5. (Если вы получаете ошибку "не удается создать теневую копию", закройте браузер и повторите попытку.)

     Щелкните вкладку **students (учащиеся** ), чтобы просмотреть тестовые данные, вставленные методом `Seed`. В зависимости от того, насколько ограничивается окно браузера, вы увидите ссылку на вкладку Student в верхней адресной строке или щелкните правый верхний угол, чтобы увидеть ссылку.

     ![Кнопка меню](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application/_static/image14.png)

## <a name="view-the-database"></a>Просмотр базы данных

Когда вы запустили страницу учащихся и приложение попыталось получить доступ к базе данных, EF обнаружил, что база данных не была создана и не создала ее. Затем EF запустил метод SEED для заполнения базы данных данными.

Для просмотра базы данных в Visual Studio можно использовать либо **Обозреватель сервера** , либо **Обозреватель объектов SQL Server** (SSOX). В этом руководстве вы будете использовать **Обозреватель сервера**.

1. Закройте браузер.
2. В **Обозреватель сервера**раскройте узел **подключения к данным** (сначала необходимо нажать кнопку Обновить), раскройте узел **School context (ContosoUniversity)** , а затем разверните узел **таблицы** , чтобы просмотреть таблицы в новой базе данных.

3. Щелкните правой кнопкой мыши таблицу **Student** и выберите команду **Показать данные таблицы** , чтобы просмотреть созданные столбцы и строки, вставленные в таблицу.

4. Закройте подключение **Обозреватель сервера** .

Файлы базы данных *ContosoUniversity1. mdf* и *. ldf* находятся в папке *% UserProfile%* .

Поскольку вы используете `DropCreateDatabaseIfModelChanges` инициализатор, теперь можно внести изменения в класс `Student`, запустить приложение еще раз, и база данных будет автоматически создана заново в соответствии с внесенным изменением. Например, если добавить в класс `Student` `EmailAddress` свойство, снова запустить страницу Students и снова просмотреть таблицу, появится новый столбец `EmailAddress`.

## <a name="conventions"></a>Соглашения

Объем кода, который вам пришлось писать, чтобы Entity Framework иметь возможность создать полную базу данных для вас, является минимальным из-за *соглашений*или допущений, которые Entity Framework делают. Некоторые из них уже были отмечены или использованы без вашего уведомления:

- В качестве имен таблиц используются множественные формы имен классов сущностей.
- В качестве имен столбцов используются имена свойств сущностей.
- Свойства сущности с именами `ID` или *classname* `ID` распознаются как свойства первичного ключа.
- Свойство интерпретируется как свойство внешнего ключа, если оно называется *&lt;имя свойства навигации&gt;&lt;имя свойства первичного ключа&gt;* (например, `StudentID` для свойства навигации `Student`, так как первичный ключ `Student` сущности `ID`). Свойства внешнего ключа также можно назвать тем же просто &lt;имени свойства первичного ключа&gt; (например, `EnrollmentID`, так как первичный ключ `Enrollment` сущности `EnrollmentID`).

Вы видели, что соглашения можно переопределить. Например, вы указали, что имена таблиц не должны быть в множественном числе, и позже вы увидите, как явно пометить свойство как свойство внешнего ключа.

## <a name="get-the-code"></a>Получение кода

[Скачать завершенный проект](https://webpifeed.blob.core.windows.net/webpifeed/Partners/ASP.NET%20MVC%20Application%20Using%20Entity%20Framework%20Code%20First.zip)

## <a name="additional-resources"></a>Дополнительные ресурсы

Дополнительные сведения об EF 6 см. в следующих статьях:

* [Доступ к данным ASP.NET. Рекомендуемые ресурсы](../../../../whitepapers/aspnet-data-access-content-map.md)

* [Соглашения Code First](/ef/ef6/modeling/code-first/conventions/built-in)

* [Создание более сложной модели данных](creating-a-more-complex-data-model-for-an-asp-net-mvc-application.md)

## <a name="next-steps"></a>Дальнейшие действия

Изучив это руководство, вы:

> [!div class="checklist"]
> * Создано веб-приложение MVC
> * Настройка стиля сайта
> * Установлено Entity Framework 6
> * Создание модели данных
> * Создание контекста базы данных
> * Инициализация базы данных с тестовыми данными
> * Настройка EF 6 для использования LocalDB
> * Создание контроллера и представлений
> * Просмотр базы данных

Перейдите к следующей статье, чтобы узнать, как просмотреть и настроить код создания, чтения, обновления и удаления (CRUD) в контроллерах и представлениях.
> [!div class="nextstepaction"]
> [Реализация базовых функций CRUD](implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application.md)