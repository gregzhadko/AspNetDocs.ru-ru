---
uid: mvc/overview/getting-started/getting-started-with-ef-using-mvc/sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application
title: Учебник. Добавление сортировки, фильтрации и разбиения на страницы с помощью Entity Framework в приложении MVC ASP.NET | Документация Майкрософт
author: tdykstra
description: В этом руководстве вы добавите функции сортировки, фильтрации и разбиения на страницы для индекса учащихся. Вы также создадите простую страницу группирования.
ms.author: riande
ms.date: 01/14/2019
ms.assetid: d5723e46-41fe-4d09-850a-e03b9e285bfa
msc.legacyurl: /mvc/overview/getting-started/getting-started-with-ef-using-mvc/sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application
msc.type: authoredcontent
ms.topic: tutorial
ms.openlocfilehash: d9fadc12aa83a8095f364cf39e5376243a7d0670
ms.sourcegitcommit: f774732a3960fca079438a88a5472c37cf7be08a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/06/2019
ms.locfileid: "68810751"
---
# <a name="tutorial-add-sorting-filtering-and-paging-with-the-entity-framework-in-an-aspnet-mvc-application"></a><span data-ttu-id="f6b8e-104">Учебник. Добавление сортировки, фильтрации и разбиения на страницы с помощью Entity Framework в приложении ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="f6b8e-104">Tutorial: Add sorting, filtering, and paging with the Entity Framework in an ASP.NET MVC application</span></span>

<span data-ttu-id="f6b8e-105">В [предыдущем руководстве](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md)вы реализовали набор веб-страниц для базовых операций CRUD для `Student` сущностей.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-105">In the [previous tutorial](creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md), you implemented a set of web pages for basic CRUD operations for `Student` entities.</span></span> <span data-ttu-id="f6b8e-106">В этом руководстве вы добавите функции сортировки, фильтрации и разбиения на страницы для индекса учащихся.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-106">In this tutorial you add sorting, filtering, and paging functionality to the **Students** Index page.</span></span> <span data-ttu-id="f6b8e-107">Вы также создадите простую страницу группирования.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-107">You also create a simple grouping page.</span></span>

<span data-ttu-id="f6b8e-108">На следующем рисунке показано, как будет выглядеть страница после завершения.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-108">The following image shows what the page will look like when you're done.</span></span> <span data-ttu-id="f6b8e-109">Заголовки столбцов являются ссылками, при нажатии на которые происходит сортировка по этому столбцу.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-109">The column headings are links that the user can click to sort by that column.</span></span> <span data-ttu-id="f6b8e-110">При повторном нажатии на заголовок происходит переключение между сортировкой по возрастанию и убыванию.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-110">Clicking a column heading repeatedly toggles between ascending and descending sort order.</span></span>

![Students_Index_page_with_paging](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image1.png)

<span data-ttu-id="f6b8e-112">В этом учебнике рассмотрены следующие задачи.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-112">In this tutorial, you:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="f6b8e-113">Добавление ссылок для сортировки столбцов</span><span class="sxs-lookup"><span data-stu-id="f6b8e-113">Add column sort links</span></span>
> * <span data-ttu-id="f6b8e-114">Добавление поля поиска</span><span class="sxs-lookup"><span data-stu-id="f6b8e-114">Add a Search box</span></span>
> * <span data-ttu-id="f6b8e-115">Добавить подкачку</span><span class="sxs-lookup"><span data-stu-id="f6b8e-115">Add paging</span></span>
> * <span data-ttu-id="f6b8e-116">Создание страницы сведений</span><span class="sxs-lookup"><span data-stu-id="f6b8e-116">Create an About page</span></span>

## <a name="prerequisites"></a><span data-ttu-id="f6b8e-117">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="f6b8e-117">Prerequisites</span></span>

* [<span data-ttu-id="f6b8e-118">Реализация базовой функциональности CRUD</span><span class="sxs-lookup"><span data-stu-id="f6b8e-118">Implementing Basic CRUD Functionality</span></span>](implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application.md)

## <a name="add-column-sort-links"></a><span data-ttu-id="f6b8e-119">Добавление ссылок для сортировки столбцов</span><span class="sxs-lookup"><span data-stu-id="f6b8e-119">Add column sort links</span></span>

<span data-ttu-id="f6b8e-120">Чтобы добавить сортировку на страницу индекса учащихся, измените `Index` метод `Student` контроллера `Student` и добавьте код в представление индекса.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-120">To add sorting to the Student Index page, you'll change the `Index` method of the `Student` controller and add code to the `Student` Index view.</span></span>

### <a name="add-sorting-functionality-to-the-index-method"></a><span data-ttu-id="f6b8e-121">Добавление функции сортировки в метод Index</span><span class="sxs-lookup"><span data-stu-id="f6b8e-121">Add sorting functionality to the Index method</span></span>

- <span data-ttu-id="f6b8e-122">В *контроллерс\студентконтроллер.КС*замените `Index` метод следующим кодом:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-122">In *Controllers\StudentController.cs*, replace the `Index` method with the following code:</span></span>

   [!code-csharp[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample1.cs)]

<span data-ttu-id="f6b8e-123">Этот код принимает параметр `sortOrder` из строки запроса в URL.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-123">This code receives a `sortOrder` parameter from the query string in the URL.</span></span> <span data-ttu-id="f6b8e-124">Значение строки запроса предоставляется ASP.NET MVC в качестве параметра метода действия.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-124">The query string value is provided by ASP.NET MVC as a parameter to the action method.</span></span> <span data-ttu-id="f6b8e-125">Параметр представляет собой строку, которая имеет значение "Name" или "Date", при необходимости за которой следует символ подчеркивания и строка "DESC" для указания порядка убывания.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-125">The parameter is a string that's either "Name" or "Date", optionally followed by an underscore and the string "desc" to specify descending order.</span></span> <span data-ttu-id="f6b8e-126">По умолчанию используется порядок сортировки по возрастанию.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-126">The default sort order is ascending.</span></span>

<span data-ttu-id="f6b8e-127">При первом запросе страницы Index строка запроса отсутствует.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-127">The first time the Index page is requested, there's no query string.</span></span> <span data-ttu-id="f6b8e-128">Студенты отображаются в порядке возрастания по `LastName`, который является значением по умолчанию, установленным в `switch` операторе перебора.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-128">The students are displayed in ascending order by `LastName`, which is the default as established by the fall-through case in the `switch` statement.</span></span> <span data-ttu-id="f6b8e-129">Когда пользователь щелкает гиперссылку заголовка столбца, в строку запроса подставляется соответствующее значение параметра `sortOrder`.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-129">When the user clicks a column heading hyperlink, the appropriate `sortOrder` value is provided in the query string.</span></span>

<span data-ttu-id="f6b8e-130">Эти две `ViewBag` переменные используются, чтобы представление могли настроить гиперссылки заголовка столбца с соответствующими значениями строки запроса:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-130">The two `ViewBag` variables are used so that the view can configure the column heading hyperlinks with the appropriate query string values:</span></span>

[!code-csharp[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample2.cs)]

<span data-ttu-id="f6b8e-131">Это тернарные условные операторы.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-131">These are ternary statements.</span></span> <span data-ttu-id="f6b8e-132">Первый указывает, что если `sortOrder` параметр имеет значение null или пуст, `ViewBag.NameSortParm` то для него должно быть задано\_имя DESC; в противном случае ему следует присвоить пустую строку.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-132">The first one specifies that if the `sortOrder` parameter is null or empty, `ViewBag.NameSortParm` should be set to "name\_desc"; otherwise, it should be set to an empty string.</span></span> <span data-ttu-id="f6b8e-133">Следующие два оператора устанавливают гиперссылки в заголовках столбцов в представлении следующим образом:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-133">These two statements enable the view to set the column heading hyperlinks as follows:</span></span>

| <span data-ttu-id="f6b8e-134">Текущий порядок сортировки</span><span class="sxs-lookup"><span data-stu-id="f6b8e-134">Current sort order</span></span> | <span data-ttu-id="f6b8e-135">Гиперссылка "Last Name" (Фамилия)</span><span class="sxs-lookup"><span data-stu-id="f6b8e-135">Last Name Hyperlink</span></span> | <span data-ttu-id="f6b8e-136">Гиперссылка "Date" (Дата)</span><span class="sxs-lookup"><span data-stu-id="f6b8e-136">Date Hyperlink</span></span> |
| --- | --- | --- |
| <span data-ttu-id="f6b8e-137">"Last Name" (Фамилия) по возрастанию</span><span class="sxs-lookup"><span data-stu-id="f6b8e-137">Last Name ascending</span></span> | <span data-ttu-id="f6b8e-138">descending</span><span class="sxs-lookup"><span data-stu-id="f6b8e-138">descending</span></span> | <span data-ttu-id="f6b8e-139">ascending</span><span class="sxs-lookup"><span data-stu-id="f6b8e-139">ascending</span></span> |
| <span data-ttu-id="f6b8e-140">"Last Name" (Фамилия) по убыванию</span><span class="sxs-lookup"><span data-stu-id="f6b8e-140">Last Name descending</span></span> | <span data-ttu-id="f6b8e-141">ascending</span><span class="sxs-lookup"><span data-stu-id="f6b8e-141">ascending</span></span> | <span data-ttu-id="f6b8e-142">ascending</span><span class="sxs-lookup"><span data-stu-id="f6b8e-142">ascending</span></span> |
| <span data-ttu-id="f6b8e-143">"Date" (Дата) по возрастанию</span><span class="sxs-lookup"><span data-stu-id="f6b8e-143">Date ascending</span></span> | <span data-ttu-id="f6b8e-144">ascending</span><span class="sxs-lookup"><span data-stu-id="f6b8e-144">ascending</span></span> | <span data-ttu-id="f6b8e-145">descending</span><span class="sxs-lookup"><span data-stu-id="f6b8e-145">descending</span></span> |
| <span data-ttu-id="f6b8e-146">"Date" (Дата) по убыванию</span><span class="sxs-lookup"><span data-stu-id="f6b8e-146">Date descending</span></span> | <span data-ttu-id="f6b8e-147">ascending</span><span class="sxs-lookup"><span data-stu-id="f6b8e-147">ascending</span></span> | <span data-ttu-id="f6b8e-148">ascending</span><span class="sxs-lookup"><span data-stu-id="f6b8e-148">ascending</span></span> |

<span data-ttu-id="f6b8e-149">Метод использует [LINQ to Entities](/dotnet/framework/data/adonet/ef/language-reference/linq-to-entities) , чтобы указать столбец для сортировки.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-149">The method uses [LINQ to Entities](/dotnet/framework/data/adonet/ef/language-reference/linq-to-entities) to specify the column to sort by.</span></span> <span data-ttu-id="f6b8e-150">Код <xref:System.Linq.IQueryable%601> создает переменную `switch` `switch` перед инструкцией, изменяет ее в `switch` операторе и вызывает `ToList` метод после инструкции.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-150">The code creates an <xref:System.Linq.IQueryable%601> variable before the `switch` statement, modifies it in the `switch` statement, and calls the `ToList` method after the `switch` statement.</span></span> <span data-ttu-id="f6b8e-151">После создания и изменения переменных `IQueryable` запрос в базу данных не отправляется.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-151">When you create and modify `IQueryable` variables, no query is sent to the database.</span></span> <span data-ttu-id="f6b8e-152">Запрос не выполняется до тех пор, пока `IQueryable` объект не будет преобразован в коллекцию путем вызова метода, такого как. `ToList`</span><span class="sxs-lookup"><span data-stu-id="f6b8e-152">The query is not executed until you convert the `IQueryable` object into a collection by calling a method such as `ToList`.</span></span> <span data-ttu-id="f6b8e-153">Таким образом, этот код приводит к выполнению одного запроса, который не выполняется `return View` до инструкции.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-153">Therefore, this code results in a single query that is not executed until the `return View` statement.</span></span>

<span data-ttu-id="f6b8e-154">В качестве альтернативы написанию различных операторов LINQ для каждого порядка сортировки можно динамически создать инструкцию LINQ.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-154">As an alternative to writing different LINQ statements for each sort order, you can dynamically create a LINQ statement.</span></span> <span data-ttu-id="f6b8e-155">Дополнительные сведения о динамическом LINQ см. в разделе [dynamic LINQ](https://go.microsoft.com/fwlink/?LinkID=323957).</span><span class="sxs-lookup"><span data-stu-id="f6b8e-155">For information about dynamic LINQ, see [Dynamic LINQ](https://go.microsoft.com/fwlink/?LinkID=323957).</span></span>

### <a name="add-column-heading-hyperlinks-to-the-student-index-view"></a><span data-ttu-id="f6b8e-156">Добавление гиперссылок заголовка столбца в представление индекса учащихся</span><span class="sxs-lookup"><span data-stu-id="f6b8e-156">Add column heading hyperlinks to the Student index view</span></span>

1. <span data-ttu-id="f6b8e-157">В *виевс\студент\индекс.кштмл*замените `<tr>` элементы и `<th>` для строки заголовка выделенным кодом:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-157">In *Views\Student\Index.cshtml*, replace the `<tr>` and `<th>` elements for the heading row with the highlighted code:</span></span>

   [!code-cshtml[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample3.cshtml?highlight=5-15)]

   <span data-ttu-id="f6b8e-158">Этот код использует сведения в `ViewBag` свойствах для настройки гиперссылок с соответствующими значениями строки запроса.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-158">This code uses the information in the `ViewBag` properties to set up hyperlinks with the appropriate query string values.</span></span>

2. <span data-ttu-id="f6b8e-159">Чтобы проверить, работает ли сортировка, запустите страницу и щелкните заголовки столбцов **Last Name** и **Date регистрации** .</span><span class="sxs-lookup"><span data-stu-id="f6b8e-159">Run the page and click the **Last Name** and **Enrollment Date** column headings to verify that sorting works.</span></span>

   <span data-ttu-id="f6b8e-160">После того как вы щелкните заголовок **Last Name (фамилия** ), учащиеся будут отображаться в порядке убывания фамилий.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-160">After you click the **Last Name** heading, students are displayed in descending last name order.</span></span>

## <a name="add-a-search-box"></a><span data-ttu-id="f6b8e-161">Добавление поля поиска</span><span class="sxs-lookup"><span data-stu-id="f6b8e-161">Add a Search box</span></span>

<span data-ttu-id="f6b8e-162">Чтобы добавить фильтрацию на страницу индекса учащихся, добавьте в представление текстовое поле и кнопку Submit и внесите соответствующие изменения в `Index` метод.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-162">To add filtering to the Students index page, you'll add a text box and a submit button to the view and make corresponding changes in the `Index` method.</span></span> <span data-ttu-id="f6b8e-163">Текстовое поле позволяет ввести строку для поиска в полях Name и Last Name.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-163">The text box lets you enter a string to search for in the first name and last name fields.</span></span>

### <a name="add-filtering-functionality-to-the-index-method"></a><span data-ttu-id="f6b8e-164">Добавление функций фильтрации в метод Index</span><span class="sxs-lookup"><span data-stu-id="f6b8e-164">Add filtering functionality to the Index method</span></span>

- <span data-ttu-id="f6b8e-165">В *контроллерс\студентконтроллер.КС*замените `Index` метод следующим кодом (изменения выделены):</span><span class="sxs-lookup"><span data-stu-id="f6b8e-165">In *Controllers\StudentController.cs*, replace the `Index` method with the following code (the changes are highlighted):</span></span>

   [!code-csharp[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample4.cs?highlight=1,7-11)]

<span data-ttu-id="f6b8e-166">Код добавляет `searchString` параметр `Index` в метод.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-166">The code adds a `searchString` parameter to the `Index` method.</span></span> <span data-ttu-id="f6b8e-167">Значение строки поиска получается из текстового поля, которое мы добавили в представление Index.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-167">The search string value is received from a text box that you'll add to the Index view.</span></span> <span data-ttu-id="f6b8e-168">Он также добавляет `where` предложение в инструкцию LINQ, которое выбирает только учащихся, чье имя или фамилия содержат строку поиска.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-168">It also adds a `where` clause to the LINQ statement that selects only students whose first name or last name contains the search string.</span></span> <span data-ttu-id="f6b8e-169">Инструкция, которая добавляет <xref:System.Linq.Queryable.Where%2A> предложение, выполняется только в том случае, если имеется искомое значение.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-169">The statement that adds the <xref:System.Linq.Queryable.Where%2A> clause executes only if there's a value to search for.</span></span>

> [!NOTE]
> <span data-ttu-id="f6b8e-170">Во многих случаях один и тот же метод можно вызвать либо в Entity Framework наборе сущностей, либо в виде метода расширения для коллекции в памяти.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-170">In many cases you can call the same method either on an Entity Framework entity set or as an extension method on an in-memory collection.</span></span> <span data-ttu-id="f6b8e-171">Результаты обычно одинаковы, но в некоторых случаях они могут отличаться.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-171">The results are normally the same but in some cases may be different.</span></span>
>
> <span data-ttu-id="f6b8e-172">Например, .NET Framework реализация `Contains` метода возвращает все строки, когда в нее передается пустая строка, но поставщик Entity Framework для SQL Server Compact 4,0 возвращает нулевые строки для пустых строк.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-172">For example, the .NET Framework implementation of the `Contains` method returns all rows when you pass an empty string to it, but the Entity Framework provider for SQL Server Compact 4.0 returns zero rows for empty strings.</span></span> <span data-ttu-id="f6b8e-173">Поэтому код в примере (поместив `Where` инструкцию `if` внутри инструкции) гарантирует получение одинаковых результатов для всех версий SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-173">Therefore the code in the example (putting the `Where` statement inside an `if` statement) makes sure that you get the same results for all versions of SQL Server.</span></span> <span data-ttu-id="f6b8e-174">Кроме того, .NET Frameworkная реализация `Contains` метода выполняет сравнение с учетом регистра по умолчанию, но Entity Framework поставщики SQL Server по умолчанию выполняют сравнения без учета регистра.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-174">Also, the .NET Framework implementation of the `Contains` method performs a case-sensitive comparison by default, but Entity Framework SQL Server providers perform case-insensitive comparisons by default.</span></span> <span data-ttu-id="f6b8e-175">Поэтому вызов `ToUpper` метода для явного учета регистра гарантирует, что результаты не изменяются при следующем изменении кода для использования репозитория, который `IEnumerable` вернет коллекцию вместо `IQueryable` объекта.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-175">Therefore, calling the `ToUpper` method to make the test explicitly case-insensitive ensures that results do not change when you change the code later to use a repository, which will return an `IEnumerable` collection instead of an `IQueryable` object.</span></span> <span data-ttu-id="f6b8e-176">(При вызове метода `Contains` коллекции `IEnumerable` выполняется реализация .NET Framework; при вызове этого же метода у объекта `IQueryable` выполняется реализация поставщика базы данных.)</span><span class="sxs-lookup"><span data-stu-id="f6b8e-176">(When you call the `Contains` method on an `IEnumerable` collection, you get the .NET Framework implementation; when you call it on an `IQueryable` object, you get the database provider implementation.)</span></span>
>
> <span data-ttu-id="f6b8e-177">Обработка значений NULL может также отличаться для разных поставщиков баз данных или при использовании `IQueryable` объекта по сравнению с `IEnumerable` коллекцией.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-177">Null handling may also be different for different database providers or when you use an `IQueryable` object compared to when you use an `IEnumerable` collection.</span></span> <span data-ttu-id="f6b8e-178">Например, в некоторых сценариях `Where` условие, `table.Column != 0` например, не может возвращать столбцы, `null` имеющие значение.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-178">For example, in some scenarios a `Where` condition such as `table.Column != 0` may not return columns that have `null` as the value.</span></span> <span data-ttu-id="f6b8e-179">По умолчанию EF создает дополнительные операторы SQL, чтобы обеспечить равенство значений NULL в базе данных, подобной работе в памяти, но можно установить флаг [уседатабасенуллсемантикс](https://docs.microsoft.com/dotnet/api/system.data.entity.infrastructure.dbcontextconfiguration.usedatabasenullsemantics) в EF6 или вызвать метод [усерелатионалнуллс](https://docs.microsoft.com/dotnet/api/microsoft.entityframeworkcore.infrastructure.relationaldbcontextoptionsbuilder-2.userelationalnulls) в EF Core, чтобы Настройте это поведение.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-179">By default, EF generates additional SQL operators to make equality between null values work in the database like it works in memory, but you can set the [UseDatabaseNullSemantics](https://docs.microsoft.com/dotnet/api/system.data.entity.infrastructure.dbcontextconfiguration.usedatabasenullsemantics) flag in EF6 or call the [UseRelationalNulls](https://docs.microsoft.com/dotnet/api/microsoft.entityframeworkcore.infrastructure.relationaldbcontextoptionsbuilder-2.userelationalnulls) method in EF Core to configure this behavior.</span></span>

### <a name="add-a-search-box-to-the-student-index-view"></a><span data-ttu-id="f6b8e-180">Добавление поля поиска в представление индекса учащихся</span><span class="sxs-lookup"><span data-stu-id="f6b8e-180">Add a search box to the Student index view</span></span>

1. <span data-ttu-id="f6b8e-181">В *виевс\студент\индекс.кштмл*Добавьте выделенный код непосредственно перед открывающим `table` тегом, чтобы создать заголовок, текстовое поле и кнопку **поиска** .</span><span class="sxs-lookup"><span data-stu-id="f6b8e-181">In *Views\Student\Index.cshtml*, add the highlighted code immediately before the opening `table` tag in order to create a caption, a text box, and a **Search** button.</span></span>

   [!code-cshtml[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample5.cshtml?highlight=4-11)]

2. <span data-ttu-id="f6b8e-182">Запустите страницу, введите строку поиска и нажмите кнопку **Поиск** , чтобы убедиться, что фильтрация работает.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-182">Run the page, enter a search string, and click **Search** to verify that filtering is working.</span></span>

   <span data-ttu-id="f6b8e-183">Обратите внимание, что URL-адрес не содержит строку поиска "a". Это означает, что если вы заметите эту страницу в закладки, отфильтрованный список не будет получен при использовании закладки.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-183">Notice the URL doesn't contain the "an" search string, which means that if you bookmark this page, you won't get the filtered list when you use the bookmark.</span></span> <span data-ttu-id="f6b8e-184">Это также относится к ссылкам сортировки столбцов, так как они будут сортировать весь список.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-184">This applies also to the column sort links, as they will sort the whole list.</span></span> <span data-ttu-id="f6b8e-185">Вы измените кнопку **поиска** , чтобы в дальнейшем использовать строки запросов для критериев фильтрации.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-185">You'll change the **Search** button to use query strings for filter criteria later in the tutorial.</span></span>

## <a name="add-paging"></a><span data-ttu-id="f6b8e-186">Добавить подкачку</span><span class="sxs-lookup"><span data-stu-id="f6b8e-186">Add paging</span></span>

<span data-ttu-id="f6b8e-187">Чтобы добавить подкачку на страницу индекса учащихся, начните с установки пакета NuGet **пажедлист. MVC** .</span><span class="sxs-lookup"><span data-stu-id="f6b8e-187">To add paging to the Students index page, you'll start by installing the **PagedList.Mvc** NuGet package.</span></span> <span data-ttu-id="f6b8e-188">Затем вы вносите дополнительные изменения в `Index` метод и добавляете в `Index` представление ссылки для разбиения на страницы.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-188">Then you'll make additional changes in the `Index` method and add paging links to the `Index` view.</span></span> <span data-ttu-id="f6b8e-189">**Пажедлист. MVC** — это один из многих хороших пакетов разбиения по страницам и сортировки для ASP.NET MVC, и его использование здесь предназначено только в качестве примера, а не в качестве рекомендации по сравнению с другими вариантами.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-189">**PagedList.Mvc** is one of many good paging and sorting packages for ASP.NET MVC, and its use here is intended only as an example, not as a recommendation for it over other options.</span></span>

### <a name="install-the-pagedlistmvc-nuget-package"></a><span data-ttu-id="f6b8e-190">Установка пакета NuGet Пажедлист. MVC</span><span class="sxs-lookup"><span data-stu-id="f6b8e-190">Install the PagedList.MVC NuGet package</span></span>

<span data-ttu-id="f6b8e-191">Пакет NuGet **пажедлист. MVC** автоматически устанавливает пакет **пажедлист** в качестве зависимости.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-191">The NuGet **PagedList.Mvc** package automatically installs the **PagedList** package as a dependency.</span></span> <span data-ttu-id="f6b8e-192">Пакет **пажедлист** устанавливает `PagedList` тип коллекции и методы расширения для `IQueryable` коллекций и `IEnumerable` .</span><span class="sxs-lookup"><span data-stu-id="f6b8e-192">The **PagedList** package installs a `PagedList` collection type and extension methods for `IQueryable` and `IEnumerable` collections.</span></span> <span data-ttu-id="f6b8e-193">Методы расширения создают одну `PagedList` страницу данных в коллекции вне `IQueryable` или `IEnumerable`, а `PagedList` коллекция предоставляет несколько свойств и методов, которые упрощают разбиение на страницы.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-193">The extension methods create a single page of data in a `PagedList` collection out of your `IQueryable` or `IEnumerable`, and the `PagedList` collection provides several properties and methods that facilitate paging.</span></span> <span data-ttu-id="f6b8e-194">Пакет **пажедлист. MVC** устанавливает вспомогательный метод разбиения на страницы, который отображает кнопки разбиения на страницы.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-194">The **PagedList.Mvc** package installs a paging helper that displays the paging buttons.</span></span>

1. <span data-ttu-id="f6b8e-195">В меню **Сервис** выберите **Диспетчер пакетов NuGet** , а затем — **консоль диспетчера пакетов**.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-195">From the **Tools** menu, select **NuGet Package Manager** and then **Package Manager Console**.</span></span>

2. <span data-ttu-id="f6b8e-196">В окне **консоли диспетчера пакетов** убедитесь, что **источник пакета** имеет значение **NuGet.org** , а **проект по умолчанию** — **ContosoUniversity**, а затем введите следующую команду:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-196">In the **Package Manager Console** window, make sure the **Package source** is **nuget.org** and the **Default project** is **ContosoUniversity**, and then enter the following command:</span></span>

   ```text
   Install-Package PagedList.Mvc
   ```

3. <span data-ttu-id="f6b8e-197">Выполните построение проекта.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-197">Build the project.</span></span>

### <a name="add-paging-functionality-to-the-index-method"></a><span data-ttu-id="f6b8e-198">Добавление разбиения на страницы в метод Index</span><span class="sxs-lookup"><span data-stu-id="f6b8e-198">Add paging functionality to the Index method</span></span>

1. <span data-ttu-id="f6b8e-199">В *контроллерс\студентконтроллер.КС*добавьте `using` инструкцию для `PagedList` пространства имен:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-199">In *Controllers\StudentController.cs*, add a `using` statement for the `PagedList` namespace:</span></span>

   [!code-csharp[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample6.cs)]

2. <span data-ttu-id="f6b8e-200">Замените метод `Index` следующим кодом:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-200">Replace the `Index` method with the following code:</span></span>

   [!code-csharp[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample7.cs?highlight=1,3,7-16,41-43)]

   <span data-ttu-id="f6b8e-201">Этот код добавляет `page` параметр, текущий параметр порядка сортировки и текущий параметр фильтра в сигнатуру метода:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-201">This code adds a `page` parameter, a current sort order parameter, and a current filter parameter to the method signature:</span></span>

   [!code-csharp[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample8.cs)]

   <span data-ttu-id="f6b8e-202">При первом отображении страницы или если пользователь не щелкнул ссылку на подкачку или сортировку, все параметры имеют значение null.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-202">The first time the page is displayed, or if the user hasn't clicked a paging or sorting link, all the parameters are null.</span></span> <span data-ttu-id="f6b8e-203">Если щелкнуть ссылку подкачки, `page` переменная содержит номер отображаемой страницы.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-203">If a paging link is clicked, the `page` variable contains the page number to display.</span></span>

   <span data-ttu-id="f6b8e-204">`ViewBag` Свойство предоставляет представление с текущим порядком сортировки, поскольку оно должно быть включено в ссылки разбиения на страницы, чтобы порядок сортировки совпадал с порядком разбиения на страницы:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-204">A `ViewBag` property provides the view with the current sort order, because this must be included in the paging links in order to keep the sort order the same while paging:</span></span>

   [!code-csharp[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample9.cs)]

   <span data-ttu-id="f6b8e-205">Другое свойство, `ViewBag.CurrentFilter`предоставляет представление с текущей строкой фильтра.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-205">Another property, `ViewBag.CurrentFilter`, provides the view with the current filter string.</span></span> <span data-ttu-id="f6b8e-206">Это значение необходимо включить в ссылки для перелистывания, чтобы при смене страницы сохранить настройки фильтра, кроме того, необходимо восстановить значение фильтра в текстовом поле после обновления страницы.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-206">This value must be included in the paging links in order to maintain the filter settings during paging, and it must be restored to the text box when the page is redisplayed.</span></span> <span data-ttu-id="f6b8e-207">Если строка поиска изменяется во время перелистывания, то номер страницы должен быть сброшен на 1, так как с новым фильтром изменится состав отображаемых данных.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-207">If the search string is changed during paging, the page has to be reset to 1, because the new filter can result in different data to display.</span></span> <span data-ttu-id="f6b8e-208">Строка поиска изменяется при вводе значения в текстовое поле и нажатии кнопки Submit (отправить).</span><span class="sxs-lookup"><span data-stu-id="f6b8e-208">The search string is changed when a value is entered in the text box and the submit button is pressed.</span></span> <span data-ttu-id="f6b8e-209">В этом случае `searchString` параметр не равен null.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-209">In that case, the `searchString` parameter is not null.</span></span>

   [!code-csharp[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample10.cs)]

   <span data-ttu-id="f6b8e-210">В конце метода `ToPagedList` метод расширения объекта Students `IQueryable` преобразует запрос Student на одну страницу учащихся в типе коллекции, который поддерживает разбиение на страницы.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-210">At the end of the method, the `ToPagedList` extension method on the students `IQueryable` object converts the student query to a single page of students in a collection type that supports paging.</span></span> <span data-ttu-id="f6b8e-211">После этого одна страница учащихся передается в представление:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-211">That single page of students is then passed to the view:</span></span>

   [!code-csharp[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample11.cs)]

   <span data-ttu-id="f6b8e-212">Метод `ToPagedList` принимает номер страницы.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-212">The `ToPagedList` method takes a page number.</span></span> <span data-ttu-id="f6b8e-213">Два знака вопроса представляют [оператор объединения со значением NULL](/dotnet/csharp/language-reference/operators/null-coalescing-operator).</span><span class="sxs-lookup"><span data-stu-id="f6b8e-213">The two question marks represent the [null-coalescing operator](/dotnet/csharp/language-reference/operators/null-coalescing-operator).</span></span> <span data-ttu-id="f6b8e-214">Этот оператор определяет значение по умолчанию для значения null; выражение `(page ?? 1)` возвращает значение переменной `page`, если она имеет значение, и возвращает 1, если переменная `page` имеет значение null.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-214">The null-coalescing operator defines a default value for a nullable type; the expression `(page ?? 1)` means return the value of `page` if it has a value, or return 1 if `page` is null.</span></span>

### <a name="add-paging-links-to-the-student-index-view"></a><span data-ttu-id="f6b8e-215">Добавление ссылок на подкачку в представление индекса учащихся</span><span class="sxs-lookup"><span data-stu-id="f6b8e-215">Add paging links to the Student index view</span></span>

1. <span data-ttu-id="f6b8e-216">В *виевс\студент\индекс.кштмл*замените существующий код следующим кодом.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-216">In *Views\Student\Index.cshtml*, replace the existing code with the following code.</span></span> <span data-ttu-id="f6b8e-217">Изменения выделены.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-217">The changes are highlighted.</span></span>

   [!code-cshtml[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample12.cshtml?highlight=1-3,6,9,14,17,24,30,55-56,58-59)]

   <span data-ttu-id="f6b8e-218">Оператор `@model` в начале страницы указывает на то, что теперь представление принимает объект `PagedList`, а не объект `List`.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-218">The `@model` statement at the top of the page specifies that the view now gets a `PagedList` object instead of a `List` object.</span></span>

   <span data-ttu-id="f6b8e-219">`using` Инструкция для`PagedList.Mvc` предоставляет доступ к вспомогательному модулю MVC для кнопок разбиения на страницы.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-219">The `using` statement for `PagedList.Mvc` gives access to the MVC helper for the paging buttons.</span></span>

   <span data-ttu-id="f6b8e-220">Код использует перегрузку [бегинформ](/previous-versions/aspnet/dd492719(v=vs.108)) , которая позволяет ему указать [форммесод. Get](/previous-versions/aspnet/dd460179(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="f6b8e-220">The code uses an overload of [BeginForm](/previous-versions/aspnet/dd492719(v=vs.108)) that allows it to specify [FormMethod.Get](/previous-versions/aspnet/dd460179(v=vs.100)).</span></span>

   [!code-cshtml[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample13.cshtml?highlight=1)]

   <span data-ttu-id="f6b8e-221">[Бегинформ](/previous-versions/aspnet/dd492719(v=vs.108)) по умолчанию отправляет данные формы с помощью записи, что означает, что параметры передаются в тексте сообщения HTTP, а не в URL-адресе в виде строк запроса.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-221">The default [BeginForm](/previous-versions/aspnet/dd492719(v=vs.108)) submits form data with a POST, which means that parameters are passed in the HTTP message body and not in the URL as query strings.</span></span> <span data-ttu-id="f6b8e-222">При указании метода HTTP GET данные формы передаются в URL-адресе в виде строк запроса, что позволяет добавлять URL-адреса в закладки.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-222">When you specify HTTP GET, the form data is passed in the URL as query strings, which enables users to bookmark the URL.</span></span> <span data-ttu-id="f6b8e-223">[Рекомендации консорциума W3C по использованию протокола HTTP Get](http://www.w3.org/2001/tag/doc/whenToUseGet.html) рекомендуют использовать инструкцию GET, если действие не приводит к обновлению.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-223">The [W3C guidelines for the use of HTTP GET](http://www.w3.org/2001/tag/doc/whenToUseGet.html) recommend that you should use GET when the action does not result in an update.</span></span>

   <span data-ttu-id="f6b8e-224">Текстовое поле инициализируется текущей строкой поиска, поэтому при щелчке на новой странице можно увидеть текущую строку поиска.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-224">The text box is initialized with the current search string so when you click a new page you can see the current search string.</span></span>

   [!code-cshtml[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample14.cshtml?highlight=1)]

   <span data-ttu-id="f6b8e-225">Ссылки в заголовках столбцов передают в контроллер при помощи строки запроса текущее значение строки поиска, чтобы пользователь мог сортировать отфильтрованные данные:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-225">The column header links use the query string to pass the current search string to the controller so that the user can sort within filter results:</span></span>

   [!code-cshtml[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample15.cshtml?highlight=1)]

   <span data-ttu-id="f6b8e-226">Отобразится текущая страница и общее количество страниц.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-226">The current page and total number of pages are displayed.</span></span>

   [!code-cshtml[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample16.cshtml)]

   <span data-ttu-id="f6b8e-227">Если нет страниц для отображения, отображается страница 0 из 0.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-227">If there are no pages to display, "Page 0 of 0" is shown.</span></span> <span data-ttu-id="f6b8e-228">(В этом случае номер страницы больше, чем число страниц, так как `Model.PageNumber` значение равно 1, `Model.PageCount` а равно 0.)</span><span class="sxs-lookup"><span data-stu-id="f6b8e-228">(In that case the page number is greater than the page count because `Model.PageNumber` is 1, and `Model.PageCount` is 0.)</span></span>

   <span data-ttu-id="f6b8e-229">`PagedListPager` Вспомогательная функция отображает кнопки разбиения по страницам:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-229">The paging buttons are displayed by the `PagedListPager` helper:</span></span>

   [!code-cshtml[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample17.cshtml)]

   <span data-ttu-id="f6b8e-230">`PagedListPager` Вспомогательное приложение предоставляет ряд параметров, которые можно настраивать, включая URL-адреса и стили.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-230">The `PagedListPager` helper provides a number of options that you can customize, including URLs and styling.</span></span> <span data-ttu-id="f6b8e-231">Дополнительные сведения см. в разделе [тройгуде/пажедлист](https://github.com/TroyGoode/PagedList) на сайте GitHub.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-231">For more information, see [TroyGoode / PagedList](https://github.com/TroyGoode/PagedList) on the GitHub site.</span></span>

2. <span data-ttu-id="f6b8e-232">Запустите страницу.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-232">Run the page.</span></span>

   <span data-ttu-id="f6b8e-233">Чтобы убедиться, что постраничный просмотр работает, нажимайте кнопки перелистывания при различном порядке сортировки.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-233">Click the paging links in different sort orders to make sure paging works.</span></span> <span data-ttu-id="f6b8e-234">Затем введите строку поиска и повторите перелистывание, чтобы убедиться, что разбиение на страницы работает корректно вместе с сортировкой и фильтрацией.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-234">Then enter a search string and try paging again to verify that paging also works correctly with sorting and filtering.</span></span>

## <a name="create-an-about-page"></a><span data-ttu-id="f6b8e-235">Создание страницы сведений</span><span class="sxs-lookup"><span data-stu-id="f6b8e-235">Create an About page</span></span>

<span data-ttu-id="f6b8e-236">На странице со сведениями о веб-сайте университета Contoso вы увидите, сколько учащихся зарегистрировано для каждой даты регистрации.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-236">For the Contoso University website's About page, you'll display how many students have enrolled for each enrollment date.</span></span> <span data-ttu-id="f6b8e-237">Для этого понадобится группировка и выполнение простых расчетов в группах.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-237">This requires grouping and simple calculations on the groups.</span></span> <span data-ttu-id="f6b8e-238">Для выполнения этой задачи нам потребуется следующее:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-238">To accomplish this, you'll do the following:</span></span>

- <span data-ttu-id="f6b8e-239">Создать класс модели представления для данных, которые необходимо передать в представление.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-239">Create a view model class for the data that you need to pass to the view.</span></span>
- <span data-ttu-id="f6b8e-240">`About` Измените метод `Home` в контроллере.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-240">Modify the `About` method in the `Home` controller.</span></span>
- <span data-ttu-id="f6b8e-241">`About` Измените представление.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-241">Modify the `About` view.</span></span>

### <a name="create-the-view-model"></a><span data-ttu-id="f6b8e-242">Создание модели представления</span><span class="sxs-lookup"><span data-stu-id="f6b8e-242">Create the View Model</span></span>

<span data-ttu-id="f6b8e-243">Создайте папку *ViewModels* в папке проекта.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-243">Create a *ViewModels* folder in the project folder.</span></span> <span data-ttu-id="f6b8e-244">В этой папке добавьте файл класса *EnrollmentDateGroup.CS* и замените код шаблона следующим кодом:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-244">In that folder, add a class file *EnrollmentDateGroup.cs* and replace the template code with the following code:</span></span>

[!code-csharp[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample18.cs)]

### <a name="modify-the-home-controller"></a><span data-ttu-id="f6b8e-245">Изменение контроллера Home</span><span class="sxs-lookup"><span data-stu-id="f6b8e-245">Modify the Home Controller</span></span>

1. <span data-ttu-id="f6b8e-246">В *HomeController.CS*добавьте следующие `using` инструкции в начало файла:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-246">In *HomeController.cs*, add the following `using` statements at the top of the file:</span></span>

   [!code-csharp[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample19.cs)]

2. <span data-ttu-id="f6b8e-247">Добавьте переменную класса для контекста базы данных сразу после открывающей фигурной скобки для класса:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-247">Add a class variable for the database context immediately after the opening curly brace for the class:</span></span>

   [!code-csharp[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample20.cs?highlight=3)]

3. <span data-ttu-id="f6b8e-248">Замените метод `About` следующим кодом:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-248">Replace the `About` method with the following code:</span></span>

   [!code-csharp[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample21.cs)]

   <span data-ttu-id="f6b8e-249">Запрос LINQ группирует записи из таблицы студентов по дате зачисления, вычисляет число записей в каждой группе и сохраняет результаты в коллекцию объектов моделей представления `EnrollmentDateGroup`.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-249">The LINQ statement groups the student entities by enrollment date, calculates the number of entities in each group, and stores the results in a collection of `EnrollmentDateGroup` view model objects.</span></span>

4. <span data-ttu-id="f6b8e-250">`Dispose` Добавьте метод:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-250">Add a `Dispose` method:</span></span>

   [!code-csharp[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample22.cs)]

### <a name="modify-the-about-view"></a><span data-ttu-id="f6b8e-251">Изменение представления About</span><span class="sxs-lookup"><span data-stu-id="f6b8e-251">Modify the About View</span></span>

1. <span data-ttu-id="f6b8e-252">Замените код в файле *виевс\хоме\абаут.кштмл* следующим кодом:</span><span class="sxs-lookup"><span data-stu-id="f6b8e-252">Replace the code in the *Views\Home\About.cshtml* file with the following code:</span></span>

   [!code-cshtml[Main](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/samples/sample23.cshtml)]

2. <span data-ttu-id="f6b8e-253">Запустите приложение и щелкните ссылку **About (о программе** ).</span><span class="sxs-lookup"><span data-stu-id="f6b8e-253">Run the app and click the **About** link.</span></span>

   <span data-ttu-id="f6b8e-254">Число учащихся для каждой даты регистрации отображается в таблице.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-254">The count of students for each enrollment date displays in a table.</span></span>

   ![About_page](sorting-filtering-and-paging-with-the-entity-framework-in-an-asp-net-mvc-application/_static/image9.png)

## <a name="get-the-code"></a><span data-ttu-id="f6b8e-256">Получение кода</span><span class="sxs-lookup"><span data-stu-id="f6b8e-256">Get the code</span></span>

[<span data-ttu-id="f6b8e-257">Скачать завершенный проект</span><span class="sxs-lookup"><span data-stu-id="f6b8e-257">Download the Completed Project</span></span>](https://webpifeed.blob.core.windows.net/webpifeed/Partners/ASP.NET%20MVC%20Application%20Using%20Entity%20Framework%20Code%20First.zip)

## <a name="additional-resources"></a><span data-ttu-id="f6b8e-258">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="f6b8e-258">Additional resources</span></span>

<span data-ttu-id="f6b8e-259">Ссылки на другие ресурсы Entity Framework можно найти в материалах, рекомендуемых для [доступа к данным ASP.NET](../../../../whitepapers/aspnet-data-access-content-map.md).</span><span class="sxs-lookup"><span data-stu-id="f6b8e-259">Links to other Entity Framework resources can be found in [ASP.NET Data Access - Recommended Resources](../../../../whitepapers/aspnet-data-access-content-map.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="f6b8e-260">Следующие шаги</span><span class="sxs-lookup"><span data-stu-id="f6b8e-260">Next steps</span></span>

<span data-ttu-id="f6b8e-261">В этом учебнике рассмотрены следующие задачи.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-261">In this tutorial, you:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="f6b8e-262">Добавление ссылок для сортировки столбцов</span><span class="sxs-lookup"><span data-stu-id="f6b8e-262">Add column sort links</span></span>
> * <span data-ttu-id="f6b8e-263">Добавление поля поиска</span><span class="sxs-lookup"><span data-stu-id="f6b8e-263">Add a Search box</span></span>
> * <span data-ttu-id="f6b8e-264">Добавить подкачку</span><span class="sxs-lookup"><span data-stu-id="f6b8e-264">Add paging</span></span>
> * <span data-ttu-id="f6b8e-265">Создание страницы сведений</span><span class="sxs-lookup"><span data-stu-id="f6b8e-265">Create an About page</span></span>

<span data-ttu-id="f6b8e-266">Перейдите к следующей статье, чтобы узнать, как использовать устойчивость подключений и перехват команд.</span><span class="sxs-lookup"><span data-stu-id="f6b8e-266">Advance to the next article to learn how to use connection resiliency and command interception.</span></span>
> [!div class="nextstepaction"]
> [<span data-ttu-id="f6b8e-267">Устойчивость подключений и перехват команд</span><span class="sxs-lookup"><span data-stu-id="f6b8e-267">Connection resiliency and command interception</span></span>](connection-resiliency-and-command-interception-with-the-entity-framework-in-an-asp-net-mvc-application.md)
