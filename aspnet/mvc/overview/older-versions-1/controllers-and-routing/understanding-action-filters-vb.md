---
uid: mvc/overview/older-versions-1/controllers-and-routing/understanding-action-filters-vb
title: Основные сведения о фильтрах действий (VB) | Документация Майкрософт
author: microsoft
description: Цель этого руководства — объяснить фильтры действий. Фильтр действий — это атрибут, который можно применить к действию контроллера, или ко всему контроллеру...
ms.author: riande
ms.date: 10/16/2008
ms.assetid: e83812f2-c53e-4a43-a7c1-d64c59ecf694
msc.legacyurl: /mvc/overview/older-versions-1/controllers-and-routing/understanding-action-filters-vb
msc.type: authoredcontent
ms.openlocfilehash: 263658231ccaa7863508c691a3570bc00b9e8039
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78486588"
---
# <a name="understanding-action-filters-vb"></a>Общие сведения о фильтрах действий (VB)

по [Майкрософт](https://github.com/microsoft)

[Скачать в формате PDF](https://download.microsoft.com/download/e/f/3/ef3f2ff6-7424-48f7-bdaa-180ef64c3490/ASPNET_MVC_Tutorial_14_VB.pdf)

> Цель этого руководства — объяснить фильтры действий. Фильтр действий — это атрибут, который можно применить к действию контроллера, или ко всему контроллеру, который изменяет способ выполнения действия.

## <a name="understanding-action-filters"></a>Основные сведения о фильтрах действий

Цель этого руководства — объяснить фильтры действий. Фильтр действий — это атрибут, который можно применить к действию контроллера, или ко всему контроллеру, который изменяет способ выполнения действия. Платформа ASP.NET MVC содержит несколько фильтров действий:

- OutputCache — этот фильтр действий кэширует выходные данные действия контроллера на указанный период времени.
- HandleError — этот фильтр действий обрабатывает ошибки, возникающие при выполнении действия контроллера.
- Авторизовать — этот фильтр действий позволяет ограничить доступ определенным пользователем или ролью.

Вы также можете создавать собственные фильтры настраиваемых действий. Например, может потребоваться создать настраиваемый фильтр действий, чтобы реализовать пользовательскую систему проверки подлинности. Можно также создать фильтр действий, который изменяет данные представления, возвращаемые действием контроллера.

В этом руководстве вы узнаете, как создать фильтр действий с нуля. Мы создадим фильтр действий журнала, который регистрирует различные этапы обработки действия в окне вывода Visual Studio.

### <a name="using-an-action-filter"></a>Использование фильтра действий

Фильтр действий является атрибутом. Большинство фильтров действий можно применить к одному действию контроллера или ко всему контроллеру.

Например, контроллер данных в листинге 1 предоставляет действие с именем `Index()`, которое возвращает текущее время. Это действие дополнено фильтром действий `OutputCache`. Этот фильтр приводит к кэшированию значения, возвращаемого действием, в течение 10 секунд.

**Листинг 1 — `Controllers\DataController.vb`**

[!code-vb[Main](understanding-action-filters-vb/samples/sample1.vb)]

Если вы повторно вызываете действие `Index()`, введя URL-адрес/Дата/индекс в адресную строку браузера и нажимая кнопку "Обновить" несколько раз, вы увидите это же время в течение 10 секунд. Выходные данные действия `Index()` кэшируются в течение 10 секунд (см. рис. 1).

[время кэширования ![](understanding-action-filters-vb/_static/image2.png)](understanding-action-filters-vb/_static/image1.png)

**Рис. 01**. кэшированное время ([щелкните, чтобы просмотреть изображение с полным размером](understanding-action-filters-vb/_static/image3.png))

В листинге 1 один фильтр действий — `OutputCache` фильтр действий — применяется к методу `Index()`. При необходимости можно применить несколько фильтров действий к одному действию. Например, можно применить фильтры действий `OutputCache` и `HandleError` к одному и тому же действию.

В листинге 1 фильтр действий `OutputCache` применяется к действию `Index()`. Этот атрибут можно также применить к самому классу `DataController`. В этом случае результат, возвращаемый любым действием, предоставленным контроллером, будет кэшироваться в течение 10 секунд.

### <a name="the-different-types-of-filters"></a>Различные типы фильтров

Платформа ASP.NET MVC поддерживает четыре различных типа фильтров:

1. Фильтры авторизации — реализуют атрибут `IAuthorizationFilter`.
2. Фильтры действий — реализуют атрибут `IActionFilter`.
3. Фильтры результатов — реализуют атрибут `IResultFilter`.
4. Фильтры исключений — реализует атрибут `IExceptionFilter`.

Фильтры выполняются в указанном выше порядке. Например, фильтры авторизации всегда выполняются до тех пор, пока фильтры действий и фильтры исключений всегда выполняются после каждого другого типа фильтра.

Фильтры авторизации используются для реализации проверки подлинности и авторизации для действий контроллера. Например, фильтр авторизации является примером фильтра проверки подлинности.

Фильтры действий содержат логику, которая выполняется до и после выполнения действия контроллера. Для изменения данных представления, возвращаемых действием контроллера, можно использовать фильтр действий.

Фильтры результатов содержат логику, которая выполняется до и после выполнения результата представления. Например, может потребоваться изменить результат представления прямо перед отображением представления в браузере.

Фильтры исключений — это последний тип выполняемого фильтра. Фильтр исключений можно использовать для управления ошибками, возникающими в результате действий контроллера или результатов действий контроллера. Можно также использовать фильтры исключений для записи ошибок в журнал.

Каждый тип фильтра выполняется в определенном порядке. Если требуется управлять порядком, в котором выполняются фильтры одного типа, можно задать свойство порядок фильтра.

Базовый класс для всех фильтров действий является классом `System.Web.Mvc.FilterAttribute`. Если требуется реализовать определенный тип фильтра, необходимо создать класс, который наследует от базового класса Filter и реализует один или несколько интерфейсов Иаусоризатионфилтер, Иактионфилтер, Иресултфилтер или SetUnhandledExceptionFilter.

### <a name="the-base-actionfilterattribute-class"></a>Базовый класс ActionFilterAttribute

Чтобы упростить реализацию настраиваемого фильтра действий, платформа ASP.NET MVC включает базовый класс `ActionFilterAttribute`. Этот класс реализует интерфейсы `IActionFilter` и `IResultFilter` и наследует от класса `Filter`.

Терминология здесь не полностью согласуется. Технически класс, наследующий от класса ActionFilterAttribute, является как фильтром действий, так и фильтром результатов. Однако в слабом смысле фильтр действий Word используется для ссылки на любой тип фильтра в платформе ASP.NET MVC.

Базовый класс ActionFilterAttribute имеет следующие методы, которые можно переопределить:

- OnActionExecuting — этот метод вызывается перед выполнением действия контроллера.
- OnActionExecuted — этот метод вызывается после выполнения действия контроллера.
- OnResultExecuting — этот метод вызывается перед выполнением результата действия контроллера.
- Онресултексекутед — этот метод вызывается после выполнения результата действия контроллера.

В следующем разделе мы посмотрим, как можно реализовать каждый из этих методов.

### <a name="creating-a-log-action-filter"></a>Создание фильтра действий журнала

Чтобы продемонстрировать, как можно создать настраиваемый фильтр действий, мы создадим настраиваемый фильтр действий, который регистрирует этапы обработки действия контроллера в окне вывода Visual Studio. Наш `LogActionFilter` содержится в листинге 2.

**Листинг 2 — `ActionFilters\LogActionFilter.vb`**

[!code-vb[Main](understanding-action-filters-vb/samples/sample2.vb)]

В листинге 2 методы `OnActionExecuting()`, `OnActionExecuted()`, `OnResultExecuting()`и `OnResultExecuted()` вызывают метод `Log()`. Имя метода и текущие данные маршрута передаются методу `Log()`. Метод `Log()` записывает сообщение в окно вывода Visual Studio (см. рис. 2).

[![запись в окно вывода Visual Studio](understanding-action-filters-vb/_static/image5.png)](understanding-action-filters-vb/_static/image4.png)

**Рис. 02**. запись в окно вывода Visual Studio ([щелкните, чтобы просмотреть изображение с полным размером](understanding-action-filters-vb/_static/image6.png))

Контроллер Home в листинге 3 показывает, как можно применить фильтр действий журнала ко всему классу контроллера. Каждый раз, когда вызываются какие-либо действия, предоставляемые контроллером Home: метод `Index()` или метод `About()` — этапы обработки действия записываются в окно вывода Visual Studio.

**Листинг 3 — `Controllers\HomeController.vb`**

[!code-vb[Main](understanding-action-filters-vb/samples/sample3.vb)]

### <a name="summary"></a>Сводка

В этом учебнике вы предоставили ASP.NET фильтры действий MVC. Вы узнали о четырех различных типах фильтров: фильтрах авторизации, фильтрах действий, фильтрах результатов и фильтрах исключений. Вы также узнали о базовом классе `ActionFilterAttribute`.

Наконец, вы узнали, как реализовать простой фильтр действий. Мы создали фильтр действий журнала, который записывает этапы обработки действия контроллера в окно вывода Visual Studio.

> [!div class="step-by-step"]
> [Назад](asp-net-mvc-routing-overview-vb.md)
> [Вперед](improving-performance-with-output-caching-vb.md)
