---
uid: mvc/overview/older-versions-1/controllers-and-routing/creating-a-route-constraint-vb
title: Создание ограничения маршрута (Visual Basic) | Документация Майкрософт
author: StephenWalther
description: В этом руководстве Стивен Вальтер демонстрирует, как можно контролировать, как браузер запрашивает маршруты соответствия путем создания ограничения маршрута с помощью регулярных выражений.
ms.author: riande
ms.date: 02/16/2009
ms.assetid: b7cce113-c82c-45bf-b97b-357e5d9f7f56
msc.legacyurl: /mvc/overview/older-versions-1/controllers-and-routing/creating-a-route-constraint-vb
msc.type: authoredcontent
ms.openlocfilehash: 205742dd8f866c8828008c8aac7ab3f98b173ceb
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65123425"
---
# <a name="creating-a-route-constraint-vb"></a>Создание ограничения маршрута (VB)

по [Стивен Вальтер](https://github.com/StephenWalther)

> В этом руководстве Стивен Вальтер демонстрирует, как можно контролировать, как браузер запрашивает маршруты соответствия путем создания ограничения маршрута с помощью регулярных выражений.

Использовать ограничения маршрута для ограничения браузер запросы, которые соответствуют определенным маршрутом. Регулярное выражение можно использовать для указания ограничения маршрута.

Например представьте, что вы определили маршрута в листинге 1 в файле Global.asax.

**В листинге 1 - Global.asax.vb**

[!code-vb[Main](creating-a-route-constraint-vb/samples/sample1.vb)]

В листинге 1 содержит маршрут с именем продукта. Маршрут продукта можно использовать для сопоставления запросов браузера ProductController, содержащихся в листинге 2.

**В листинге 2 - Controllers\ProductController.vb**

[!code-vb[Main](creating-a-route-constraint-vb/samples/sample2.vb)]

Обратите внимание на то, что Details() действию, предоставляемым продукта контроллер принимает один параметр с именем productId. Этот параметр является параметром целое число.

Маршрут, определенный в листинге 1 будет соответствовать любой из следующих URL-адресов:

- / Продукта/23
- / Продукта/7

К сожалению маршрут будет соответствовать следующие URL-адреса:

- / Продукта/сведения
- / Продукта/apple

Поскольку действие Details() ожидает целочисленный параметр, выполняющего запрос, содержащий отличные от целочисленное значение приведет к ошибке. Например при вводе /Product/apple URL-адрес в адресную строку браузера на страницу ошибки будет получить на рис. 1.

[![В диалоговом окне нового проекта](creating-a-route-constraint-vb/_static/image1.jpg)](creating-a-route-constraint-vb/_static/image1.png)

**Рис 01**: Просмотр страницы развернуть ([Просмотр полноразмерного изображения](creating-a-route-constraint-vb/_static/image2.png))

Что Вы действительно хотите сделать — соответствовать только URL-адреса, содержащие productId правильное целое число. Ограничение можно использовать при определении маршрута для ограничения URL-адреса, которые соответствуют маршруту. Измененный маршрут продукта в листинге 3 содержит ограничение регулярное выражение, которое соответствует только целые числа.

**Листинг 3 - Global.asax.vb**

[!code-vb[Main](creating-a-route-constraint-vb/samples/sample3.vb)]

Регулярное выражение \d+ соответствует один или несколько целых чисел. Этим ограничением обусловлены сопоставления следующие URL-адреса маршрута продукта:

- / Продукта/3
- / Продукта/8999

Но не следующие URL-адреса:

- / Продукта/apple
- / Продукта

Эти запросы браузера будут обрабатываться другой маршрут или, если отсутствуют соответствующие маршруты *не удалось найти ресурс* будет возвращена ошибка.

> [!div class="step-by-step"]
> [Назад](creating-custom-routes-vb.md)
> [Вперед](creating-a-custom-route-constraint-vb.md)
