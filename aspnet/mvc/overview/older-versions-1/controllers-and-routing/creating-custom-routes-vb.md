---
uid: mvc/overview/older-versions-1/controllers-and-routing/creating-custom-routes-vb
title: Создание пользовательских маршрутов (Visual Basic) | Документация Майкрософт
author: microsoft
description: Узнайте, как добавить пользовательские маршруты для приложения ASP.NET MVC. В этом руководстве вы узнаете, как изменить таблицы маршрутизации по умолчанию в файле Global.asax.
ms.author: riande
ms.date: 02/16/2009
ms.assetid: 6ac5758b-6199-42af-adcb-21954b864951
msc.legacyurl: /mvc/overview/older-versions-1/controllers-and-routing/creating-custom-routes-vb
msc.type: authoredcontent
ms.openlocfilehash: a7b8b85ba1cf5c18e605eb8114a305272baf41a6
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59404875"
---
# <a name="creating-custom-routes-vb"></a>Создание пользовательских маршрутов (VB)

по [Microsoft](https://github.com/microsoft)

> Узнайте, как добавить пользовательские маршруты для приложения ASP.NET MVC. В этом руководстве вы узнаете, как изменить таблицы маршрутизации по умолчанию в файле Global.asax.


В этом руководстве вы узнаете, как добавить настраиваемый маршрут в приложении ASP.NET MVC. Вы узнаете, как изменение таблицы маршрутизации по умолчанию в файле Global.asax с настраиваемый маршрут.

В приложениях ASP.NET MVC таблицы маршрутизации по умолчанию будет работать нормально. Тем не менее может выясниться, что специализированные требования к маршрутизации. В этом случае можно создать настраиваемый маршрут.

Допустим, что вы создаете приложение блога. Может потребоваться обрабатывать входящие запросы, которые выглядят следующим образом:

/ Archive/12-25-2009

Когда пользователь вводит этот запрос, необходимо вернуть в записи блога, соответствующий дате 12/25/2009. Чтобы обработать этот тип запроса, необходимо создать настраиваемый маршрут.

Файл Global.asax в листинге 1 содержит новый настраиваемый маршрут с именем блог, который обрабатывает запросы, которые выглядят как /Archive/*Дата записи*.

**В листинге 1 - Global.asax (с настраиваемый маршрут)**

[!code-vb[Main](creating-custom-routes-vb/samples/sample1.vb)]

Важен порядок маршруты, добавленные в таблицу маршрутов. Наш новый настраиваемый маршрут блога добавляется перед существующего маршрута по умолчанию. Если вы изменен порядок, а затем маршрут по умолчанию всегда будет вызван вместо пользовательского маршрута.

Настраиваемый маршрут блог соответствует любой запрос, который начинается с/Archive /. Таким образом он удовлетворяет всем следующим URL-адресам:

- / Archive/12-25-2009

- / Archive/10-6-2004

- / Archive/apple

Настраиваемый маршрут сопоставляет входящий запрос к контроллеру с именем архива и вызывает действие Entry(). При вызове метода Entry() Дата записи передается как параметр с именем entryDate.

Можно использовать настраиваемый маршрут блога с помощью контроллера в листинге 2.

**В листинге 2 - ArchiveController.vb**

[!code-vb[Main](creating-custom-routes-vb/samples/sample2.vb)]

Обратите внимание на то, что метод Entry() в листинге 2 принимает параметр типа DateTime. Платформа MVC может преобразовать эту дату записи из URL-адрес в значение даты и времени автоматически. Если параметр записи даты в URL-адресе невозможно преобразовать в значение DateTime, возникает ошибка (см. рис. 1).

**Рис. 1. Ошибка в результате преобразования параметра**


[![Tдиалоговое окно нового проекта он](creating-custom-routes-vb/_static/image1.jpg)](creating-custom-routes-vb/_static/image1.png)

**Рис 01**: Ошибка в результате преобразования параметра ([Просмотр полноразмерного изображения](creating-custom-routes-vb/_static/image2.png))


## <a name="summary"></a>Сводка

Цель этого учебника было продемонстрировать, как можно создать настраиваемый маршрут. Вы узнали, как добавить настраиваемый маршрут в таблицу маршрутов в файле Global.asax, который представляет записи в блогах. Мы рассмотрели способ сопоставления запросов для записи в блогах контроллер с именем ArchiveController и действие контроллера с именем Entry().

> [!div class="step-by-step"]
> [Назад](asp-net-mvc-controller-overview-vb.md)
> [Вперед](creating-a-route-constraint-vb.md)
