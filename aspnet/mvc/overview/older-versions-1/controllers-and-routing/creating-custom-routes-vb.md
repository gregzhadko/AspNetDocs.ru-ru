---
uid: mvc/overview/older-versions-1/controllers-and-routing/creating-custom-routes-vb
title: Создание пользовательских маршрутов (VB) Документы Майкрософт
author: rick-anderson
description: Узнайте, как добавить пользовательские маршруты в приложение ASP.NET MVC. В этом уроке вы узнаете, как изменить таблицу маршрутов по умолчанию в файле Global.asax.
ms.author: riande
ms.date: 02/16/2009
ms.assetid: 6ac5758b-6199-42af-adcb-21954b864951
msc.legacyurl: /mvc/overview/older-versions-1/controllers-and-routing/creating-custom-routes-vb
msc.type: authoredcontent
ms.openlocfilehash: fd12307f685fa064832bb4198df06df2c3f2d3be
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2020
ms.locfileid: "81542746"
---
# <a name="creating-custom-routes-vb"></a>Создание пользовательских маршрутов (VB)

[корпорацией Майкрософт](https://github.com/microsoft)

> Узнайте, как добавить пользовательские маршруты в приложение ASP.NET MVC. В этом уроке вы узнаете, как изменить таблицу маршрутов по умолчанию в файле Global.asax.

В этом уроке вы узнаете, как добавить пользовательский маршрут к ASP.NET mVC-приложению. Вы узнаете, как изменить таблицу маршрута по умолчанию в файле Global.asax с помощью пользовательского маршрута.

В ASP.NET приложенияm MVC таблица маршрутов по умолчанию будет работать нормально. Тем не менее, вы можете обнаружить, что у вас есть специализированные потребности в реукторе. В этом случае можно создать пользовательский маршрут.

Представьте себе, например, что вы строите приложение для блога. Вы можете обрабатывать входящие запросы, которые выглядят следующим образом:

/Архив/12-25-2009

Когда пользователь вводит этот запрос, вы хотите вернуть запись в блоге, которая соответствует дате 12/25/2009. Для обработки такого типа запроса необходимо создать пользовательский маршрут.

Файл Global.asax в листинге 1 содержит новый пользовательский маршрут под названием Блог, который обрабатывает запросы, которые выглядят как /Archive/*Дата входа.*

**Список 1 - Global.asax (с пользовательским маршрутом)**

[!code-vb[Main](creating-custom-routes-vb/samples/sample1.vb)]

Важно ею является порядок маршрутов, которые вы добавляете в таблицу маршрутов. Наш новый пользовательский маршрут блог добавляется до существующего маршрута по умолчанию. Если вы отменили заказ, то маршрут по умолчанию всегда будет вызываться вместо пользовательского маршрута.

Пользовательский маршрут блога соответствует любому запросу, который начинается с /Archive/. Таким образом, он соответствует всем следующим URL-адресам:

- /Архив/12-25-2009

- /Архив/10-6-2004

- /Архив/яблоко

Пользовательский маршрут отображает входящий запрос контроллеру под названием Archive и вызывает действие Входа () При вызове метода входа () дата входа передается как параметр, названный entryDate.

Вы можете использовать блог пользовательский маршрут с контроллером в листинге 2.

**Список 2 - ArchiveController.vb**

[!code-vb[Main](creating-custom-routes-vb/samples/sample2.vb)]

Обратите внимание, что метод входа () в листинге 2 принимает параметр типа DateTime. Платформа MVC достаточно умна, чтобы автоматически преобразовать дату входа из URL в значение DateTime. Если параметр даты входа из URL не может быть преобразован в DateTime, возникает ошибка (см. рисунок 1).

**Рисунок 1 - Ошибка от преобразования параметра**

[![Диалоговое окно New Project (Новый проект)](creating-custom-routes-vb/_static/image1.jpg)](creating-custom-routes-vb/_static/image1.png)

**Рисунок 01**: Ошибка от преобразования параметра ([Нажмите, чтобы просмотреть полноразмерное изображение](creating-custom-routes-vb/_static/image2.png))

## <a name="summary"></a>Сводка

Цель этого учебника состояла в том, чтобы продемонстрировать, как вы можете создать пользовательский маршрут. Вы узнали, как добавить пользовательский маршрут к таблице маршрутов в файле Global.asax, который представляет записи в блоге. Мы обсудили, как сопоставить запросы на записи в блоге на контроллер под названием ArchiveController и действие контроллера под названием Entry().

> [!div class="step-by-step"]
> [Назад](asp-net-mvc-controller-overview-vb.md)
> [Вперед](creating-a-route-constraint-vb.md)
