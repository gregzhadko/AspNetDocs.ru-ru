---
uid: mvc/overview/older-versions-1/controllers-and-routing/asp-net-mvc-controller-overview-vb
title: Общие сведения о контроллере MVC ASP.NET (VB) | Документация Майкрософт
author: StephenWalther
description: В этом руководстве Стивен Вальтер содержит сведения о ASP.NET контроллерах MVC. Вы узнаете, как создавать новые контроллеры и возвращать различные типы действия Res...
ms.author: riande
ms.date: 02/16/2008
ms.assetid: 94c3e5d9-a904-445e-a34e-d92fd1ca108a
msc.legacyurl: /mvc/overview/older-versions-1/controllers-and-routing/asp-net-mvc-controller-overview-vb
msc.type: authoredcontent
ms.openlocfilehash: f19e7dd7fc025de2e0c387db898d36623e790e6a
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78486924"
---
# <a name="aspnet-mvc-controller-overview-vb"></a>Общие сведения о контроллерах в ASP.NET MVC (VB)

по [Стивен Вальтер](https://github.com/StephenWalther)

> В этом руководстве Стивен Вальтер содержит сведения о ASP.NET контроллерах MVC. Вы узнаете, как создавать новые контроллеры и возвращать различные типы результатов действий.

В этом руководстве рассматривается раздел контроллеров MVC ASP.NET, действия контроллера и результаты действий. По завершении работы с этим руководством вы узнаете, как использовать контроллеры для управления взаимодействием посетителя с веб-сайтом ASP.NET MVC.

## <a name="understanding-controllers"></a>Основные сведения об контроллерах

Контроллеры MVC отвечают за реагирование на запросы к веб-сайту ASP.NET MVC. Каждый запрос браузера сопоставляется с определенным контроллером. Например, представьте, что в адресную строку браузера введен следующий URL-адрес:

`http://localhost/Product/Index/3`

В этом случае вызывается контроллер с именем Продуктконтроллер. Продуктконтроллер отвечает за создание ответа на запрос браузера. Например, контроллер может вернуть конкретное представление обратно в браузер, или контроллер может перенаправить пользователя на другой контроллер.

В листинге 1 содержится простой контроллер с именем Продуктконтроллер.

**Listing1 — Контроллерс\продуктконтроллер.ВБ**

[!code-vb[Main](asp-net-mvc-controller-overview-vb/samples/sample1.vb)]

Как видно из листинга 1, контроллер является просто классом (Visual Basic .NET или C# классом). Контроллер — это класс, производный от базового класса System. Web. MVC. Controller. Поскольку контроллер наследуется от этого базового класса, контроллер наследует несколько полезных методов бесплатно (мы обсудим эти методы чуть позже).

## <a name="understanding-controller-actions"></a>Основные сведения о действиях контроллера

Контроллер предоставляет действия контроллера. Действие — это метод контроллера, который вызывается при вводе определенного URL-адреса в адресную строку браузера. Например, представьте, что вы выполните запрос для следующего URL-адреса:

`http://localhost/Product/Index/3`

В этом случае метод Index () вызывается для класса Продуктконтроллер. В качестве примера действия контроллера используется метод Index ().

Действие контроллера должно быть открытым методом класса Controller. По умолчанию методы Visual Basic.NET являются открытыми методами. Следует понимать, что любой открытый метод, добавляемый в класс контроллера, предоставляется как действие контроллера автоматически (необходимо соблюдать осторожность, так как действие контроллера может быть вызвано любым пользователем в Вселенной, просто введя правильный URL-адрес в адресную строку браузера).

Действие контроллера должно удовлетворять некоторым дополнительным требованиям. Метод, используемый в качестве действия контроллера, не может быть перегружен. Кроме того, действие контроллера не может быть статическим методом. Кроме того, в качестве действия контроллера можно использовать практически любой метод.

## <a name="understanding-action-results"></a>Основные сведения о результатах действия

Действие контроллера возвращает нечто, называемое *результатом действия*. Результат действия — это то, что действие контроллера возвращает в ответ на запрос браузера.

Платформа ASP.NET MVC поддерживает несколько типов результатов действий, в том числе:

1. Виевресулт — представляет HTML и разметку.
2. EmptyResult — нет результата.
3. Редиректресулт — представляет перенаправление на новый URL-адрес.
4. JsonResult — представляет нотация объектов JavaScriptный результат, который можно использовать в приложении AJAX.
5. JavaScriptResult — представляет скрипт JavaScript.
6. Контентресулт — представляет текстовый результат.
7. Филеконтентресулт — представляет загружаемый файл (с двоичным содержимым).
8. FilePathResult — представляет загружаемый файл (с путем).
9. Филестреамресулт — представляет загружаемый файл (с файловым потоком).

Все эти результаты действия наследуются от базового класса ActionResult.

В большинстве случаев действие контроллера возвращает Виевресулт. Например, действие контроллера индекса в листинге 2 Возвращает Виевресулт.

**Листинг 2. Контроллерс\букконтроллер.ВБ**

[!code-vb[Main](asp-net-mvc-controller-overview-vb/samples/sample2.vb)]

Когда действие возвращает Виевресулт, в браузер возвращается HTML. Метод Index () в листинге 2 возвращает в браузер представление с именем index.

Обратите внимание, что действие index () в листинге 2 не возвращает Виевресулт (). Вместо этого вызывается метод View () базового класса контроллера. Как правило, результат действия не возвращается напрямую. Вместо этого вызывается один из следующих методов базового класса контроллера:

1. View — возвращает результат действия Виевресулт.
2. Redirect — возвращает результат действия Редиректресулт.
3. Редиректтоактион — возвращает результат действия Редиректтораутересулт.
4. Редиректторауте — возвращает результат действия Редиректтораутересулт.
5. JSON — возвращает результат действия JsonResult.
6. JavaScriptResult — возвращает JavaScriptResult.
7. Content — возвращает результат действия Контентресулт.
8. File — возвращает Филеконтентресулт, FilePathResult или Филестреамресулт в зависимости от параметров, переданных в метод.

Таким образом, если вы хотите вернуть представление в браузер, вызовите метод View (). Если вы хотите перенаправить пользователя из одного действия контроллера в другое, вызовите метод Редиректтоактион (). Например, действие Details () в листинге 3 либо отображает представление, либо перенаправляет пользователя в действие index () в зависимости от того, имеет ли параметр ID значение.

**Листинг 3-Кустомерконтроллер. vb**

[!code-vb[Main](asp-net-mvc-controller-overview-vb/samples/sample3.vb)]

Результат действия Контентресулт — Специальный. Результат действия Контентресулт можно использовать для возврата результата действия в виде обычного текста. Например, метод Index () в листинге 4 возвращает сообщение в виде обычного текста, а не в виде HTML.

**Листинг 4. Контроллерс\статусконтроллер.ВБ**

> статусконтроллер
> 
> 
> System. Web. MVC. Controller

[!code-vb[Main](asp-net-mvc-controller-overview-vb/samples/sample4.vb)]

При вызове действия Статусконтроллер. index () представление не возвращается. Вместо этого необработанный текст "Hello World!" возвращается в браузер.

Если действие контроллера возвращает результат, который не является результатом действия (например, дата или целое число), то результат упаковывается в Контентресулт автоматически. Например, при вызове действия Index () Воркконтроллер в листинге 5 Дата возвращается как Контентресулт автоматически.

**Листинг 5-Воркконтроллер. vb**

[!code-vb[Main](asp-net-mvc-controller-overview-vb/samples/sample5.vb)]

Действие index () в листинге 5 возвращает объект DateTime. Платформа ASP.NET MVC преобразует объект DateTime в строку и автоматически заключает значение DateTime в Контентресулт. Браузер получает дату и время в виде обычного текста.

## <a name="summary"></a>Сводка

Цель этого руководства — познакомиться с основными понятиями ASP.NET контроллеров MVC, действиями контроллера и результатами действий контроллера. В первом разделе вы узнали, как добавлять новые контроллеры в проект MVC ASP.NET. Далее вы узнали, как открытые методы контроллера предоставляются в совокупности как действия контроллера. Наконец, мы обсуждали различные типы результатов действий, которые могут быть возвращены действием контроллера. В частности, мы рассмотрели, как вернуть Виевресулт, Редиректтоактионресулт и Контентресулт из действия контроллера.

> [!div class="step-by-step"]
> [Назад](creating-a-custom-route-constraint-cs.md)
> [Вперед](creating-custom-routes-vb.md)
