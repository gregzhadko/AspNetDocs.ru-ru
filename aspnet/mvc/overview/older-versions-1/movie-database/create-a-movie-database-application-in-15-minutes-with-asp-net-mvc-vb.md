---
uid: mvc/overview/older-versions-1/movie-database/create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb
title: Создание приложения для создания базы данных фильмов за 15 минут с помощью ASP.NET MVC (VB) | Документация Майкрософт
author: StephenWalther
description: Стивен Вальтер создает полностью управляемое базой данных приложение ASP.NET MVC от начала до конца. Этот учебник представляет собой отличное введение для тех, кто является новым t...
ms.author: riande
ms.date: 01/27/2009
ms.assetid: e4ba9786-734c-4eb3-91bb-089793325d0d
msc.legacyurl: /mvc/overview/older-versions-1/movie-database/create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb
msc.type: authoredcontent
ms.openlocfilehash: 0ce8161d29a8ab4005e2b20462b08c9e10ee815a
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78435774"
---
# <a name="create-a-movie-database-application-in-15-minutes-with-aspnet-mvc-vb"></a>Создание приложения базы данных Movie за 15 минут с помощью ASP.NET MVC (VB)

по [Стивен Вальтер](https://github.com/StephenWalther)

[Скачать код](https://download.microsoft.com/download/7/2/8/728F8794-E59A-4D18-9A56-7AD2DB05BD9D/MovieApp_VB.zip)

> Стивен Вальтер создает полностью управляемое базой данных приложение ASP.NET MVC от начала до конца. Этот учебник представляет собой отличное введение для тех, кто не знаком с платформой MVC ASP.NET и кто хочет понять процесс создания приложения ASP.NET MVC.

Цель этого учебника — дать вам представление о том, как это выглядит, чтобы создать приложение ASP.NET MVC. В этом руководстве я запустил создание целого приложения ASP.NET MVC от начала до конца. Я покажу, как создать простое приложение на основе базы данных, которое показывает, как можно перечислять, создавать и изменять записи базы данных.

Чтобы упростить процесс создания приложения, мы будем использовать функции формирования шаблонов Visual Studio 2008. Мы разберем, что Visual Studio создаст исходный код и содержимое для наших контроллеров, моделей и представлений.

Если вы работали с Active Server страницами или ASP.NET, то вам следует найти ASP.NET MVC очень знакомо. ASP.NET представления MVC во многом аналогичны страницам в приложении Active Server страниц. И, как и традиционное приложение ASP.NET Web Forms, ASP.NET MVC предоставляет полный доступ к широкому набору языков и классов, предоставляемых платформой .NET Framework.

Я надеюсь, что в этом учебнике вы узнаете, как процесс создания приложения ASP.NET MVC аналогичен и отличается от процесса создания Active Server страниц или приложения веб-форм ASP.NET.

## <a name="overview-of-the-movie-database-application"></a>Обзор приложения для работы с базой данных фильмов

Так как наша цель заключается в простоте, мы создадим очень простое приложение для создания базы данных фильмов. Простое приложение базы данных фильмов позволит нам выполнить три действия:

1. Вывод набора записей базы данных фильмов
2. Создать новую запись базы данных фильмов
3. Изменение существующей записи базы данных фильмов

Опять же, так как мы хотим обеспечить простоту, мы воспользуемся минимальным числом функций платформы MVC ASP.NET, необходимых для создания нашего приложения. Например, мы не будем использовать преимущества разработки на основе тестирования.

Чтобы создать приложение, необходимо выполнить следующие действия.

1. Создание проекта веб-приложения MVC ASP.NET
2. Создание базы данных
3. Создание модели базы данных
4. Создание контроллера MVC ASP.NET
5. Создание представлений MVC ASP.NET

## <a name="preliminaries"></a>Предварительные требования

Для создания приложения ASP.NET MVC вам потребуется Visual Studio 2008 или Visual Web Developer 2008 Express. Также необходимо загрузить платформу ASP.NET MVC.

Если вы не владеете Visual Studio 2008, вы можете скачать пробную версию Visual Studio 2008 90 день с этого веб-сайта:

[https://msdn.microsoft.com/vs2008/products/cc268305.aspx](https://msdn.microsoft.com/vs2008/products/cc268305.aspx)

Кроме того, можно создавать приложения ASP.NET MVC с помощью Visual Web Developer Express 2008. Если вы решили использовать Visual Web Developer Express, необходимо установить пакет обновления 1 (SP1). Вы можете загрузить Visual Web Developer 2008 Express с пакетом обновления 1 (SP1) с этого веб-сайта:

[https://www.microsoft.com/downloads/details.aspx?FamilyId=BDB6391C-05CA-4036-9154-6DF4F6DEBD14&amp;d исплайланг = EN](https://www.microsoft.com/downloads/details.aspx?FamilyId=BDB6391C-05CA-4036-9154-6DF4F6DEBD14&amp;displaylang=en)

После установки Visual Studio 2008 или Visual Web Developer 2008 необходимо установить платформу ASP.NET MVC. Платформу ASP.NET MVC можно загрузить с следующего веб-сайта:

[https://www.asp.net/mvc/](../../../index.md)

> [!NOTE] 
> 
> Вместо загрузки ASP.NET Framework и платформы ASP.NET MVC по отдельности можно воспользоваться установщиком веб-платформы. Установщик веб-платформы — это приложение, которое позволяет легко управлять установленными приложениями — компьютер:
> 
> [https://www.microsoft.com/web/gallery/Install.aspx](https://www.microsoft.com/web/gallery/Install.aspx)

## <a name="creating-an-aspnet-mvc-web-application-project"></a>Создание проекта веб-приложения ASP.NET MVC

Начнем с создания нового проекта веб-приложения ASP.NET MVC в Visual Studio 2008. Выберите файл параметров меню **, новый проект,** и на рис. 1 появится диалоговое окно Новый проект. Выберите Visual Basic в качестве языка программирования и выберите шаблон проекта веб-приложение ASP.NET MVC. Присвойте проекту имя Мовиеапп и нажмите кнопку ОК.

[![диалоговом окне «Создание проекта»](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image1.jpg)](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image1.png)

**Рис. 01**. диалоговое окно "новый проект" ([щелкните, чтобы просмотреть изображение с полным размером](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image2.png))

Убедитесь, что выбрано .NET Framework 3,5 из раскрывающегося списка в верхней части диалогового окна Новый проект или шаблон проекта веб-приложения ASP.NET MVC не будет отображаться.

При создании нового проекта веб-приложения MVC Visual Studio предлагает создать отдельный проект модульного теста. Появится диалоговое окно на рис. 2. Поскольку мы не будем создавать тесты в этом учебнике из-за ограничений по времени (и, да, нам стоит немного виновную об этом), выберите параметр **нет** и нажмите кнопку **ОК** .

> [!NOTE] 
> 
> Visual Web Developer не поддерживает тестовые проекты.

[![диалоговом окне «Создание проекта»](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image2.jpg)](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image3.png)

**Рис. 02**. диалоговое окно создания проекта модульного теста ([щелкните, чтобы просмотреть изображение с полным размером](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image4.png))

Приложение ASP.NET MVC имеет стандартный набор папок: Models, Views и Controllers Folder. Этот стандартный набор папок можно увидеть в окне обозреватель решений. Чтобы создать приложение для работы с базой данных фильмов, необходимо добавить файлы в каждую из папок Models, Views и Controllers.

При создании нового приложения MVC с помощью Visual Studio вы получаете пример приложения. Так как мы хотим начать с нуля, нам нужно удалить содержимое этого примера приложения. Необходимо удалить следующий файл и следующую папку:

- Controllers\HomeController.vb
- Views\Home

## <a name="creating-the-database"></a>Создание базы данных

Необходимо создать базу данных для хранения записей в базе данных фильмов. К счастью, Visual Studio включает бесплатную базу данных с именем SQL Server Express. Чтобы создать базу данных, выполните следующие действия.

1. Щелкните правой кнопкой мыши папку данных приложения\_в окне обозреватель решений и выберите пункт меню **Добавить, новый элемент**.
2. Выберите категорию **данных** и выберите шаблон **базы данных SQL Server** (см. рис. 3).
3. Назовите новую базу данных *мовиесдб. mdf* и нажмите кнопку **Добавить** .

После создания базы данных можно подключиться к ней, дважды щелкнув файл Мовиесдб. mdf, расположенный в папке App\_Data. Дважды щелкнув файл Мовиесдб. mdf, вы откроете окно обозреватель сервера.

> [!NOTE] 
> 
> В случае Visual Web Developer окно обозреватель сервера называется обозреватель базы данныхым окном.

[![диалоговом окне «Создание проекта»](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image3.jpg)](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image5.png)

**Рис. 03**. Создание базы данных Microsoft SQL Server ([щелкните, чтобы просмотреть изображение с полным размером](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image6.png))

Далее необходимо создать новую таблицу базы данных. В окне Обозреватель серверов щелкните правой кнопкой мыши папку таблицы и выберите пункт меню **Добавить новую таблицу**. При выборе этого пункта меню открывается конструктор таблиц базы данных. Создайте следующие столбцы базы данных:

<a id="0.2_table01"></a>

| **Имя столбца** | **Тип данных** | **Разрешить значения NULL** |
| --- | --- | --- |
| Идентификатор | Int | False |
| Title | Nvarchar (100) | False |
| Директор | Nvarchar (100) | False |
| датерелеасед | Дата и время | False |

Первый столбец ID столбца имеет два специальных свойства. Сначала необходимо пометить столбец идентификаторов как первичный ключевой столбец. Выбрав столбец Идентификатор, нажмите кнопку **Задать первичный ключ** (это значок, который выглядит как ключ). Во вторых, необходимо пометить столбец идентификаторов как столбец идентификаторов. В окно свойств столбца прокрутите вниз до раздела Спецификация идентификатора и разверните его. Измените свойство **Identity** на значение **Да**. По завершении таблица должна выглядеть, как показано на рис. 4.

[![диалоговом окне «Создание проекта»](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image4.jpg)](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image7.png)

**Рис. 04**. Таблица базы данных фильмов ([щелкните, чтобы просмотреть изображение с полным размером](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image8.png))

Последним шагом является сохранение новой таблицы. Нажмите кнопку Сохранить (значок дискеты) и присвойте новой таблице имя фильмы.

После завершения создания таблицы добавьте в нее несколько записей фильмов. Щелкните правой кнопкой мыши таблицу «фильмы» в окне обозреватель сервера и выберите пункт меню « **отобразить данные таблицы**». Введите список избранных фильмов (см. рис. 5).

[![диалоговом окне «Создание проекта»](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image5.jpg)](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image9.png)

**Рис. 05**. Ввод записей фильмов ([щелкните, чтобы просмотреть изображение с полным размером](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image10.png))

## <a name="creating-the-model"></a>Создание модели

Далее необходимо создать набор классов для представления нашей базы данных. Необходимо создать модель базы данных. Мы будем использовать преимущества Microsoft Entity Framework для автоматического создания классов для нашей модели базы данных.

> [!NOTE] 
> 
> Платформа ASP.NET MVC не привязана к Microsoft Entity Framework. Вы можете создавать классы модели базы данных, используя различные инструменты реляционного сопоставления (или/M), в том числе LINQ to SQL, компании Sonic и NHibernate.

Выполните следующие действия, чтобы запустить мастер EDM.

1. Щелкните правой кнопкой мыши папку модели в окне обозреватель решений и выберите пункт меню **Добавить, новый элемент**.
2. Выберите категорию **данных** и выберите шаблон **EDM ADO.NET** .
3. Присвойте модели данных имя *мовиесдбмодел. EDMX* и нажмите кнопку **Добавить** .

После нажатия кнопки Добавить появится мастер EDM (см. рис. 6). Чтобы завершить работу мастера, выполните следующие действия.

1. На шаге **Выбор содержимого модели** выберите параметр **создать из базы данных** .
2. На шаге **Выбор подключения к данным** используйте подключение к данным *мовиесдб. mdf* и имя *мовиесдбентитиес* для параметров подключения. Нажмите кнопку **Далее**.
3. На шаге **Выбор объектов базы данных** разверните узел таблицы и выберите таблицу фильмы. Введите пространство имен *мовиеапп. Models* и нажмите кнопку **Готово** .

[![диалоговом окне «Создание проекта»](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image6.jpg)](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image11.png)

**Рис. 6**. Создание модели базы данных с помощью мастера EDM ([щелкните, чтобы просмотреть изображение с полным размером](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image12.png))

После завершения работы мастера EDM откроется конструктор EDM. Конструктор должен отобразить таблицу базы данных фильмов (см. рис. 7).

[![диалоговом окне «Создание проекта»](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image7.jpg)](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image13.png)

**Рис. 07**. конструктор EDM ([щелкните, чтобы просмотреть изображение с полным размером](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image14.png))

Прежде чем продолжить, необходимо внести одно изменение. Мастер сущностей данных создает класс модели с именем Movies, который представляет таблицу базы данных фильмов. Так как мы будем использовать класс Movies для представления конкретного фильма, нам нужно изменить имя класса на *Movie* вместо *фильмов* (единственное, а не множественное число).

Дважды щелкните имя класса в области конструктора и измените имя класса с кино на Movie. После внесения этого изменения нажмите кнопку **сохранить** (значок гибкого диска), чтобы создать класс Movie.

## <a name="creating-the-aspnet-mvc-controller"></a>Создание контроллера MVC ASP.NET

Следующим шагом является создание контроллера MVC ASP.NET. Контроллер отвечает за управление взаимодействием пользователя с приложением MVC ASP.NET.

Выполните следующие действия.

1. В окне обозреватель решений щелкните правой кнопкой мыши папку Controllers и выберите пункт меню **Добавить, контроллер**.
2. В диалоговом окне Добавление контроллера введите имя *HomeController* и установите флажок **добавить методы действий для сценариев создания, обновления и подробностей** (см. рис. 8).
3. Нажмите кнопку **Добавить** , чтобы добавить новый контроллер в проект.

После выполнения этих действий будет создан контроллер в листинге 1. Обратите внимание, что он содержит методы с именами index, Details, CREATE и Edit. В следующих разделах мы добавим необходимый код, чтобы заставить эти методы работать.

[![диалоговом окне «Создание проекта»](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image8.jpg)](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image15.png)

**Рис. 08**. Добавление нового контроллера MVC ASP.NET ([щелкните, чтобы просмотреть изображение с полным размером](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image16.png))

**Листинг 1 — Контроллерс\хомеконтроллер.ВБ**

[!code-vb[Main](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/samples/sample1.vb)]

## <a name="listing-database-records"></a>Перечисление записей базы данных

Метод Index () контроллера Home является методом по умолчанию для приложения ASP.NET MVC. При запуске приложения ASP.NET MVC метод Index () является первым вызываемым методом контроллера.

Мы будем использовать метод Index () для вывода списка записей из таблицы базы данных фильмов. Мы будем использовать преимущества классов модели базы данных, созданных ранее для получения записей базы данных фильмов с помощью метода index ().

Я изменил класс HomeController в листинге 2, чтобы он содержал новое закрытое поле с именем \_DB. Класс Мовиесдбентитиес представляет нашу модель базы данных, и мы будем использовать этот класс для взаимодействия с нашей базой данных.

Я также изменил метод Index () в листинге 2. Метод Index () использует класс Мовиесдбентитиес для извлечения всех записей фильмов из таблицы базы данных фильмов. Выражение *\_DB. Movie. ToList ()* возвращает список всех записей фильмов из таблицы базы данных фильмов.

Список фильмов передается в представление. Все, что передается в метод View (), передается в представление как данные представления.

**Листинг 2 — Controllers/HomeController. vb (измененный метод индекса)**

[!code-vb[Main](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/samples/sample2.vb)]

Метод Index () возвращает представление с именем index. Чтобы отобразить список записей базы данных фильмов, необходимо создать это представление. Выполните следующие действия.

Перед открытием диалогового окна **Добавление представления** необходимо построить проект (выберите пункт меню **Сборка, построить решение**). в раскрывающемся списке **класс данных** не будут показаны классы.

1. Щелкните правой кнопкой мыши метод Index () в редакторе кода и выберите пункт меню **Добавить представление** (см. рис. 9).
2. В диалоговом окне Добавление представления убедитесь, что установлен флажок **создать строго типизированное представление** .
3. В раскрывающемся списке **Просмотреть содержимое** выберите *Список*значение.
4. В раскрывающемся списке **класс представления данных** выберите значение *мовиеапп. Movie*.
5. Нажмите кнопку Добавить, чтобы создать новое представление (см. рис. 10).

После выполнения этих действий в папку Views\Home будет добавлено новое представление с именем index. aspx. Содержимое представления индекса включается в листинг 3.

[![диалоговом окне «Создание проекта»](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image9.jpg)](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image17.png)

**Рис. 09**. Добавление представления из действия контроллера ([щелкните, чтобы просмотреть изображение с полным размером](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image18.png))

[![диалоговом окне «Создание проекта»](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image10.jpg)](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image19.png)

**Рис. 10**. Создание нового представления с помощью диалогового окна "Добавление представления" ([щелкните, чтобы просмотреть изображение с полным размером](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image20.png))

[!code-aspx[Main](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/samples/sample3.aspx)]

В представлении "индекс" отображаются все записи фильмов из таблицы базы данных фильмов в таблице HTML. Представление содержит цикл for each, который выполняет итерацию каждого фильма, представленного свойством ViewData. Model. Если вы запускаете приложение, нажав клавишу F5, вы увидите веб-страницу на рис. 11.

[![диалоговом окне «Создание проекта»](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image11.jpg)](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image21.png)

**Рис. 11**. представление индекса ([щелкните, чтобы просмотреть изображение с полным размером](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image22.png))

## <a name="creating-new-database-records"></a>Создание новых записей базы данных

Представление индекса, созданное в предыдущем разделе, содержит ссылку для создания новых записей базы данных. Давайте выполним логику и создадим представление, необходимое для создания новых записей базы данных фильмов.

Контроллер Home содержит два метода с именем Create (). Первый метод Create () не имеет параметров. Эта перегрузка метода Create () используется для вывода HTML-формы для создания новой записи базы данных Movie.

Второй метод Create () имеет параметр Формколлектион. Эта перегрузка метода Create () вызывается при отправке на сервер HTML-формы для создания нового фильма. Обратите внимание, что второй метод Create () имеет атрибут Акцептвербс, который предотвращает вызов метода, пока не будет выполнена операция HTTP POST.

Этот второй метод Create () был изменен в обновленном классе HomeController в листинге 4. Новая версия метода Create () принимает параметр Movie и содержит логику для вставки нового фильма в таблицу базы данных фильмов.

> [!NOTE] 
> 
> Обратите внимание на атрибут BIND. Так как мы не хотим обновлять свойство идентификатора фильма из HTML-формы, необходимо явно исключить это свойство.

**Листинг 4 — Контроллерс\хомеконтроллер.ВБ (измененный метод Create)**

[!code-vb[Main](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/samples/sample4.vb)]

Visual Studio упрощает создание формы для создания новой записи базы данных фильмов (см. рис. 12). Выполните следующие действия.

1. Щелкните правой кнопкой мыши метод Create () в редакторе кода и выберите пункт меню **Добавить представление**.
2. Убедитесь, что установлен флажок **создать строго типизированное представление** .
3. В раскрывающемся списке **Просмотр содержимого** выберите значение *создать*.
4. В раскрывающемся списке **класс представления данных** выберите значение *мовиеапп. Movie*.
5. Нажмите кнопку **Добавить** , чтобы создать новое представление.

[![диалоговом окне «Создание проекта»](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image12.jpg)](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image23.png)

**Рис. 12**. Добавление представления создания ([щелкните, чтобы просмотреть изображение с полным размером](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image24.png))

Visual Studio автоматически создает представление в листинге 5. Это представление содержит HTML-форму, которая содержит поля, соответствующие каждому свойству класса Movie.

**Листинг 5 — Виевс\хоме\креате.аспкс**

[!code-aspx[Main](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/samples/sample5.aspx)]

> [!NOTE] 
> 
> HTML-форма, созданная в диалоговом окне добавления представления, создает поле идентификатора. Поскольку столбец идентификаторов является столбцом идентификаторов, это поле формы не требуется, и его можно безопасно удалить.

После добавления представления создания в базу данных можно добавлять новые записи фильмов. Запустите приложение, нажав клавишу F5, и щелкните ссылку Создать, чтобы просмотреть форму на рис. 13. Если вы закончите и отправите форму, создается новая запись базы данных фильмов.

Обратите внимание, что проверка формы возводится автоматически. Если не вводить дату выпуска для фильма или введена недопустимая дата выпуска, форма будет отображена повторно, а поле Дата выпуска будет выделено.

[![диалоговом окне «Создание проекта»](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image13.jpg)](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image25.png)

**Рис. 13**. Создание новой записи базы данных фильмов ([щелкните, чтобы просмотреть изображение с полным размером](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image26.png))

## <a name="editing-existing-database-records"></a>Изменение существующих записей базы данных

В предыдущих разделах мы рассмотрели, как можно вывести список и создать новые записи базы данных. В этом заключительном разделе мы обсудим, как можно изменить существующие записи базы данных.

Сначала необходимо создать форму редактирования. Этот шаг прост, так как Visual Studio автоматически создаст форму редактирования для нас. Откройте класс HomeController. vb в редакторе кода Visual Studio и выполните следующие действия.

1. Щелкните правой кнопкой мыши метод Edit () в редакторе кода и выберите пункт меню **Добавить представление** (см. рис. 14).
2. Установите флажок **создать строго типизированное представление**.
3. В раскрывающемся списке **Просмотр содержимого** выберите значение *изменить*.
4. В раскрывающемся списке **класс представления данных** выберите значение *мовиеапп. Movie*.
5. Нажмите кнопку **Добавить** , чтобы создать новое представление.

При выполнении этих шагов в папку Views\Home добавляется новое представление с именем Edit. aspx. Это представление содержит HTML-форму для редактирования записи фильма.

[![диалоговом окне «Создание проекта»](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image14.jpg)](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image27.png)

**Рис. 14**. Добавление представления редактирования ([щелкните, чтобы просмотреть изображение с полным размером](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/_static/image28.png))

> [!NOTE] 
> 
> Представление редактирования содержит поле HTML-формы, соответствующее свойству "идентификатор фильма". Так как вы не хотите, чтобы пользователи редактировали значение свойства ID, следует удалить это поле формы.

Наконец, необходимо изменить контроллер Home, чтобы он поддерживал изменение записи базы данных. Обновленный класс HomeController содержится в листинге 6.

**Листинг 6 — Контроллерс\хомеконтроллер.ВБ (методы правки)**

[!code-vb[Main](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-vb/samples/sample6.vb)]

В листинге 6 я добавил дополнительную логику в обе перегрузки метода Edit (). Первый метод Edit () возвращает запись базы данных Movie, соответствующую параметру ID, переданному в метод. Вторая перегрузка выполняет обновления записи фильма в базе данных.

Обратите внимание, что необходимо получить исходный ролик, а затем вызвать Апплипропертичанжес (), чтобы обновить существующий фильм в базе данных.

## <a name="summary"></a>Сводка

Цель этого руководства — предоставить вам представление о том, как создать приложение ASP.NET MVC. Надеюсь, что вы обнаружили, что создание веб-приложения ASP.NET MVC очень похоже на процесс создания Active Server страниц или приложений ASP.NET.

В этом руководстве мы рассмотрели только самые основные возможности платформы MVC ASP.NET. В следующих руководствах мы подробно рассмотрим такие темы, как контроллеры, действия контроллера, представления, данные представления и вспомогательные методы HTML.

> [!div class="step-by-step"]
> [Назад](create-a-movie-database-application-in-15-minutes-with-asp-net-mvc-cs.md)
