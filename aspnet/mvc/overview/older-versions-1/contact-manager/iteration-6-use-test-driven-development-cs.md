---
uid: mvc/overview/older-versions-1/contact-manager/iteration-6-use-test-driven-development-cs
title: '#6 итерации — использование разработки на основе тестированияC#() | Документация Майкрософт'
author: microsoft
description: В этой шестой итерации мы добавим новые функции в наше приложение, создав модульные тесты в первую очередь и записав код в модульные тесты. В этой итерации,...
ms.author: riande
ms.date: 02/20/2009
ms.assetid: 013c3c26-7dc3-41d1-8064-f233c86008b5
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-6-use-test-driven-development-cs
msc.type: authoredcontent
ms.openlocfilehash: aee0ff9d8d7f17e8a00dab12467bd3a3457fbe18
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78487128"
---
# <a name="iteration-6--use-test-driven-development-c"></a><span data-ttu-id="b3236-104">#6 итерации — использование разработки на основе тестированияC#()</span><span class="sxs-lookup"><span data-stu-id="b3236-104">Iteration #6 – Use test-driven development (C#)</span></span>

<span data-ttu-id="b3236-105">по [Майкрософт](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="b3236-105">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="b3236-106">Скачать код</span><span class="sxs-lookup"><span data-stu-id="b3236-106">Download Code</span></span>](iteration-6-use-test-driven-development-cs/_static/contactmanager_6_cs1.zip)

> <span data-ttu-id="b3236-107">В этой шестой итерации мы добавим новые функции в наше приложение, создав модульные тесты в первую очередь и записав код в модульные тесты.</span><span class="sxs-lookup"><span data-stu-id="b3236-107">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="b3236-108">В этой итерации мы добавляем группы контактов.</span><span class="sxs-lookup"><span data-stu-id="b3236-108">In this iteration, we add contact groups.</span></span>

## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="b3236-109">Создание приложения для управления контактами ASP.NET MVCC#()</span><span class="sxs-lookup"><span data-stu-id="b3236-109">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="b3236-110">В этой серии учебников мы создадим все приложение управления контактами от начала до конца.</span><span class="sxs-lookup"><span data-stu-id="b3236-110">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="b3236-111">Приложение диспетчера контактов позволяет хранить контактные данные, имена телефонов и адреса электронной почты. список людей.</span><span class="sxs-lookup"><span data-stu-id="b3236-111">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="b3236-112">Мы создаем приложение для нескольких итераций.</span><span class="sxs-lookup"><span data-stu-id="b3236-112">We build the application over multiple iterations.</span></span> <span data-ttu-id="b3236-113">При каждой итерации мы постепенно улучшаем приложение.</span><span class="sxs-lookup"><span data-stu-id="b3236-113">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="b3236-114">Цель этого нескольких итераций — позволить вам понять причину каждого изменения.</span><span class="sxs-lookup"><span data-stu-id="b3236-114">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="b3236-115">Итерация #1 — Создайте приложение.</span><span class="sxs-lookup"><span data-stu-id="b3236-115">Iteration #1 - Create the application.</span></span> <span data-ttu-id="b3236-116">В первой итерации мы создаем Диспетчер контактов проще всего.</span><span class="sxs-lookup"><span data-stu-id="b3236-116">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="b3236-117">Добавлена поддержка основных операций с базой данных: создание, чтение, обновление и удаление (CRUD).</span><span class="sxs-lookup"><span data-stu-id="b3236-117">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="b3236-118">Итерация #2 — сделайте приложение привлекательным.</span><span class="sxs-lookup"><span data-stu-id="b3236-118">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="b3236-119">В этой итерации мы улучшаем внешний вид приложения путем изменения главной страницы ASP.NET представления MVC по умолчанию и каскадной таблицы стилей.</span><span class="sxs-lookup"><span data-stu-id="b3236-119">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="b3236-120">Итерация #3 — Добавление проверки формы.</span><span class="sxs-lookup"><span data-stu-id="b3236-120">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="b3236-121">В третьей итерации мы добавим проверку базовой формы.</span><span class="sxs-lookup"><span data-stu-id="b3236-121">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="b3236-122">Мы запрещаем пользователям отправлять форму, не заполняя обязательные поля формы.</span><span class="sxs-lookup"><span data-stu-id="b3236-122">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="b3236-123">Мы также проверяем адреса электронной почты и номера телефонов.</span><span class="sxs-lookup"><span data-stu-id="b3236-123">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="b3236-124">Итерация #4 — сделайте приложение слабо связанным.</span><span class="sxs-lookup"><span data-stu-id="b3236-124">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="b3236-125">В этой четвертой итерации мы используем преимущества нескольких шаблонов проектирования программного обеспечения, чтобы упростить обслуживание и изменение приложения Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="b3236-125">In this fourth iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="b3236-126">Например, мы выполним рефакторинг нашего приложения для использования шаблона репозитория и шаблона внедрения зависимостей.</span><span class="sxs-lookup"><span data-stu-id="b3236-126">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="b3236-127">Итерация #5 — Создание модульных тестов.</span><span class="sxs-lookup"><span data-stu-id="b3236-127">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="b3236-128">В пятой итерации мы сделаем наше приложение проще в обслуживании и изменении, добавляя модульные тесты.</span><span class="sxs-lookup"><span data-stu-id="b3236-128">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="b3236-129">Мы размакетирования наши классы модели данных и создаем модульные тесты для наших контроллеров и логики проверки.</span><span class="sxs-lookup"><span data-stu-id="b3236-129">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="b3236-130">Итерация #6 — Используйте разработку на основе тестирования.</span><span class="sxs-lookup"><span data-stu-id="b3236-130">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="b3236-131">В этой шестой итерации мы добавим новые функции в наше приложение, создав модульные тесты в первую очередь и записав код в модульные тесты.</span><span class="sxs-lookup"><span data-stu-id="b3236-131">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="b3236-132">В этой итерации мы добавляем группы контактов.</span><span class="sxs-lookup"><span data-stu-id="b3236-132">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="b3236-133">Итерация #7 — Добавление функциональности AJAX.</span><span class="sxs-lookup"><span data-stu-id="b3236-133">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="b3236-134">В седьмой итерации мы улучшаем скорость реагирования и производительность нашего приложения, добавив поддержку AJAX.</span><span class="sxs-lookup"><span data-stu-id="b3236-134">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>

## <a name="this-iteration"></a><span data-ttu-id="b3236-135">Эта итерация</span><span class="sxs-lookup"><span data-stu-id="b3236-135">This Iteration</span></span>

<span data-ttu-id="b3236-136">В предыдущей итерации приложения диспетчера контактов мы создали модульные тесты, чтобы обеспечить безопасность для нашего кода.</span><span class="sxs-lookup"><span data-stu-id="b3236-136">In the previous iteration of the Contact Manager application, we created unit tests to provide a safety net for our code.</span></span> <span data-ttu-id="b3236-137">Мотивация при создании модульных тестов заключается в том, чтобы сделать код более устойчивым к изменению.</span><span class="sxs-lookup"><span data-stu-id="b3236-137">The motivation for creating the unit tests was to make our code more resilient to change.</span></span> <span data-ttu-id="b3236-138">С помощью модульных тестов мы можем внести любые изменения в наш код и сразу же определить, нарушены ли существующие функциональные возможности.</span><span class="sxs-lookup"><span data-stu-id="b3236-138">With unit tests in place, we can happily make any change to our code and immediately know whether we have broken existing functionality.</span></span>

<span data-ttu-id="b3236-139">В этой итерации мы используем модульные тесты для совершенно разных целей.</span><span class="sxs-lookup"><span data-stu-id="b3236-139">In this iteration, we use unit tests for an entirely different purpose.</span></span> <span data-ttu-id="b3236-140">В этой итерации мы используем модульные тесты как часть философии разработки приложений, именуемую *разработкой на основе тестирования*.</span><span class="sxs-lookup"><span data-stu-id="b3236-140">In this iteration, we use unit tests as part of an application design philosophy called *test-driven development*.</span></span> <span data-ttu-id="b3236-141">При разработке на основе тестирования вы сначала пишете тесты, а затем пишете код для тестов.</span><span class="sxs-lookup"><span data-stu-id="b3236-141">When you practice test-driven development, you write tests first and then write code against the tests.</span></span>

<span data-ttu-id="b3236-142">Точнее, при тренировке разработки на основе тестирования необходимо выполнить три шага при создании кода (красный/зеленый/рефакторинг):</span><span class="sxs-lookup"><span data-stu-id="b3236-142">More precisely, when practicing test-driven development, there are three steps that you complete when creating code (Red/ Green/Refactor):</span></span>

1. <span data-ttu-id="b3236-143">Написание непройденного модульного теста (красный)</span><span class="sxs-lookup"><span data-stu-id="b3236-143">Write a unit test that fails (Red)</span></span>
2. <span data-ttu-id="b3236-144">Написание кода, который проходит модульный тест (зеленый)</span><span class="sxs-lookup"><span data-stu-id="b3236-144">Write code that passes the unit test (Green)</span></span>
3. <span data-ttu-id="b3236-145">Рефакторинг кода (рефакторинг)</span><span class="sxs-lookup"><span data-stu-id="b3236-145">Refactor your code (Refactor)</span></span>

<span data-ttu-id="b3236-146">Во-первых, вы пишете модульный тест.</span><span class="sxs-lookup"><span data-stu-id="b3236-146">First, you write the unit test.</span></span> <span data-ttu-id="b3236-147">Модульный тест должен выражать предполагаемое поведение кода.</span><span class="sxs-lookup"><span data-stu-id="b3236-147">The unit test should express your intention for how you expect your code to behave.</span></span> <span data-ttu-id="b3236-148">При первом создании модульного теста произойдет сбой модульного теста.</span><span class="sxs-lookup"><span data-stu-id="b3236-148">When you first create the unit test, the unit test should fail.</span></span> <span data-ttu-id="b3236-149">Тест должен завершиться ошибкой, поскольку еще не написан код приложения, соответствующий тесту.</span><span class="sxs-lookup"><span data-stu-id="b3236-149">The test should fail because you have not yet written any application code that satisfies the test.</span></span>

<span data-ttu-id="b3236-150">Далее нужно написать достаточно кода, чтобы модульный тест был пройден.</span><span class="sxs-lookup"><span data-stu-id="b3236-150">Next, you write just enough code in order for the unit test to pass.</span></span> <span data-ttu-id="b3236-151">Целью является написание кода на самом ленивом, слоппиест и максимально быстром способе.</span><span class="sxs-lookup"><span data-stu-id="b3236-151">The goal is to write the code in the laziest, sloppiest and fastest possible way.</span></span> <span data-ttu-id="b3236-152">Не следует тратить время на анализ архитектуры приложения.</span><span class="sxs-lookup"><span data-stu-id="b3236-152">You should not waste time thinking about the architecture of your application.</span></span> <span data-ttu-id="b3236-153">Вместо этого необходимо сосредоточиться на написании минимального объема кода, необходимого для удовлетворения намерений, представленных модульным тестом.</span><span class="sxs-lookup"><span data-stu-id="b3236-153">Instead, you should focus on writing the minimal amount of code necessary to satisfy the intention expressed by the unit test.</span></span>

<span data-ttu-id="b3236-154">Наконец, после написания достаточного кода можно выполнить шаг назад и рассмотреть общую архитектуру приложения.</span><span class="sxs-lookup"><span data-stu-id="b3236-154">Finally, after you have written enough code, you can step back and consider the overall architecture of your application.</span></span> <span data-ttu-id="b3236-155">На этом шаге вы перепишете код (рефакторинг), используя преимущества шаблонов разработки программного обеспечения (например, шаблон репозитория), чтобы код был более удобен в обслуживании.</span><span class="sxs-lookup"><span data-stu-id="b3236-155">In this step, you rewrite (refactor) your code by taking advantage of software design patterns -- such as the repository pattern -- so that your code is more maintainable.</span></span> <span data-ttu-id="b3236-156">Вы можете феарлессли переписать код на этом шаге, так как код охватывает модульные тесты.</span><span class="sxs-lookup"><span data-stu-id="b3236-156">You can fearlessly rewrite your code in this step because your code is covered by unit tests.</span></span>

<span data-ttu-id="b3236-157">При тренировке разработки на основе тестирования существует множество преимуществ.</span><span class="sxs-lookup"><span data-stu-id="b3236-157">There are many benefits that result from practicing test-driven development.</span></span> <span data-ttu-id="b3236-158">Во-первых, Разработка на основе тестирования заставляет вас сосредоточиться на коде, который действительно необходимо написать.</span><span class="sxs-lookup"><span data-stu-id="b3236-158">First, test-driven development forces you to focus on code that actually needs to be written.</span></span> <span data-ttu-id="b3236-159">Поскольку вы постоянно занимаетесь написанием достаточного кода для передачи определенного теста, вы не блуждаете в дебрях и пишете большие объемы кода, которые никогда не будут использоваться.</span><span class="sxs-lookup"><span data-stu-id="b3236-159">Because you are constantly focused on just writing enough code to pass a particular test, you are prevented from wandering into the weeds and writing massive amounts of code that you will never use.</span></span>

<span data-ttu-id="b3236-160">Во-вторых, методология разработки "тестирование первой" заставляет писать код с той точки зрения, как будет использоваться код.</span><span class="sxs-lookup"><span data-stu-id="b3236-160">Second, a "test first" design methodology forces you to write code from the perspective of how your code will be used.</span></span> <span data-ttu-id="b3236-161">Иными словами, при тренировке разработки на основе тестирования вы постоянно пишете тесты с точки зрения пользователя.</span><span class="sxs-lookup"><span data-stu-id="b3236-161">In other words, when practicing test-driven development, you are constantly writing your tests from a user perspective.</span></span> <span data-ttu-id="b3236-162">Таким образом, Разработка на основе тестирования может привести к более четкому и более понятному интерфейсу API.</span><span class="sxs-lookup"><span data-stu-id="b3236-162">Therefore, test-driven development can result in cleaner and more understandable APIs.</span></span>

<span data-ttu-id="b3236-163">Наконец, Разработка на основе тестирования требует написания модульных тестов в рамках обычного процесса написания приложения.</span><span class="sxs-lookup"><span data-stu-id="b3236-163">Finally, test-driven development forces you to write unit tests as part of the normal process of writing an application.</span></span> <span data-ttu-id="b3236-164">По мере приближения крайнего срока проекта тестирование обычно является первым делом.</span><span class="sxs-lookup"><span data-stu-id="b3236-164">As a project deadline approaches, testing is typically the first thing that goes out the window.</span></span> <span data-ttu-id="b3236-165">С другой стороны, при тренировке разработки на основе тестирования, скорее всего, будет тем самым эффективный о написании модульных тестов, поскольку разработка на основе тестирования делает модульные тесты центральными для процесса создания приложения.</span><span class="sxs-lookup"><span data-stu-id="b3236-165">When practicing test-driven development, on the other hand, you are more likely to be virtuous about writing unit tests because test-driven development makes unit tests central to the process of building an application.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="b3236-166">Чтобы узнать больше о разработке на основе тестирования, я рекомендую ознакомиться с книгой «Растушевка Майклаs» и **эффективно работать с устаревшим кодом**.</span><span class="sxs-lookup"><span data-stu-id="b3236-166">To learn more about test-driven development, I recommend that you read Michael Feathers book **Working Effectively with Legacy Code**.</span></span>

<span data-ttu-id="b3236-167">В этой итерации мы добавляем новую функцию в приложение диспетчера контактов.</span><span class="sxs-lookup"><span data-stu-id="b3236-167">In this iteration, we add a new feature to our Contact Manager application.</span></span> <span data-ttu-id="b3236-168">Добавлена поддержка групп контактов.</span><span class="sxs-lookup"><span data-stu-id="b3236-168">We add support for Contact Groups.</span></span> <span data-ttu-id="b3236-169">Группы контактов можно использовать для упорядочения контактов по категориям, таким как деловые и дружественные группы.</span><span class="sxs-lookup"><span data-stu-id="b3236-169">You can use Contact Groups to organize your contacts into categories such as Business and Friend groups.</span></span>

<span data-ttu-id="b3236-170">Мы добавим эту новую функциональную возможность в наше приложение, следуя процедуре разработки на основе тестирования.</span><span class="sxs-lookup"><span data-stu-id="b3236-170">We'll add this new functionality to our application by following a process of test-driven development.</span></span> <span data-ttu-id="b3236-171">Сначала мы создадим наши модульные тесты, и мы напишем весь наш код в соответствии с этими тестами.</span><span class="sxs-lookup"><span data-stu-id="b3236-171">We'll write our unit tests first and we'll write all of our code against these tests.</span></span>

## <a name="what-gets-tested"></a><span data-ttu-id="b3236-172">Что проверяется</span><span class="sxs-lookup"><span data-stu-id="b3236-172">What Gets Tested</span></span>

<span data-ttu-id="b3236-173">Как мы обсуждали в предыдущей итерации, вы обычно не пишете модульные тесты для логики доступа к данным или логики представления.</span><span class="sxs-lookup"><span data-stu-id="b3236-173">As we discussed in the previous iteration, you typically do not write unit tests for data access logic or view logic.</span></span> <span data-ttu-id="b3236-174">Вы не пишете модульные тесты для логики доступа к данным, так как доступ к базе данных выполняется относительно медленная операция.</span><span class="sxs-lookup"><span data-stu-id="b3236-174">You don t write unit tests for data access logic because accessing a database is a relatively slow operation.</span></span> <span data-ttu-id="b3236-175">Вы не пишете модульные тесты для логики представления, так как для доступа к представлению требуется вращение веб-сервера относительно медленных операций.</span><span class="sxs-lookup"><span data-stu-id="b3236-175">You don t write unit tests for view logic because accessing a view requires spinning up a web server which is a relatively slow operation.</span></span> <span data-ttu-id="b3236-176">Не следует писать модульный тест, если тест не может быть выполнен повторно и снова с высокой скоростью.</span><span class="sxs-lookup"><span data-stu-id="b3236-176">You shouldn't write a unit test unless the test can be executed over and over again very fast</span></span>

<span data-ttu-id="b3236-177">Так как разработка на основе тестирования осуществляется с помощью модульных тестов, сначала основное внимание уделяется написанию контроллера и бизнес-логики.</span><span class="sxs-lookup"><span data-stu-id="b3236-177">Because test-driven development is driven by unit tests, we focus initially on writing controller and business logic.</span></span> <span data-ttu-id="b3236-178">Мы не будем касаться базы данных или представлений.</span><span class="sxs-lookup"><span data-stu-id="b3236-178">We avoid touching the database or views.</span></span> <span data-ttu-id="b3236-179">Мы не изменим базу данных или создадим наши представления до конца этого руководства.</span><span class="sxs-lookup"><span data-stu-id="b3236-179">We won't modify the database or create our views until the very end of this tutorial.</span></span> <span data-ttu-id="b3236-180">Начнем с того, что можно проверить.</span><span class="sxs-lookup"><span data-stu-id="b3236-180">We start with what can be tested.</span></span>

## <a name="creating-user-stories"></a><span data-ttu-id="b3236-181">Создание пользовательских историй</span><span class="sxs-lookup"><span data-stu-id="b3236-181">Creating User Stories</span></span>

<span data-ttu-id="b3236-182">При тренировке разработки на основе тестирования вы всегда начинаете с написания теста.</span><span class="sxs-lookup"><span data-stu-id="b3236-182">When practicing test-driven development, you always start by writing a test.</span></span> <span data-ttu-id="b3236-183">Это немедленно вызывает вопрос: как выбрать тест для записи?</span><span class="sxs-lookup"><span data-stu-id="b3236-183">This immediately raises the question: How do you decide what test to write first?</span></span> <span data-ttu-id="b3236-184">Чтобы ответить на этот вопрос, необходимо написать набор [**пользовательских историй**](http://en.wikipedia.org/wiki/User_stories).</span><span class="sxs-lookup"><span data-stu-id="b3236-184">To answer this question, you should write a set of [**user stories**](http://en.wikipedia.org/wiki/User_stories).</span></span>

<span data-ttu-id="b3236-185">Пользовательская история — это очень короткое (обычно одно предложение) описание требования к программному обеспечению.</span><span class="sxs-lookup"><span data-stu-id="b3236-185">A user story is a very brief (usually one sentence) description of a software requirement.</span></span> <span data-ttu-id="b3236-186">Это должно быть нетехническое описание требования, написанного с точки зрения пользователя.</span><span class="sxs-lookup"><span data-stu-id="b3236-186">It should be a non-technical description of a requirement written from a user perspective.</span></span>

<span data-ttu-id="b3236-187">Вот набор пользовательских историй, описывающих функции, необходимые для новых функциональных возможностей группы контактов:</span><span class="sxs-lookup"><span data-stu-id="b3236-187">Here s the set of user stories that describe the features required by the new Contact Group functionality:</span></span>

1. <span data-ttu-id="b3236-188">Пользователь может просматривать список групп контактов.</span><span class="sxs-lookup"><span data-stu-id="b3236-188">User can view a list of contact groups.</span></span>
2. <span data-ttu-id="b3236-189">Пользователь может создать новую группу контактов.</span><span class="sxs-lookup"><span data-stu-id="b3236-189">User can create a new contact group.</span></span>
3. <span data-ttu-id="b3236-190">Пользователь может удалить существующую группу контактов.</span><span class="sxs-lookup"><span data-stu-id="b3236-190">User can delete an existing contact group.</span></span>
4. <span data-ttu-id="b3236-191">Пользователь может выбрать группу контактов при создании нового контакта.</span><span class="sxs-lookup"><span data-stu-id="b3236-191">User can select a contact group when creating a new contact.</span></span>
5. <span data-ttu-id="b3236-192">Пользователь может выбрать группу контактов при редактировании существующего контакта.</span><span class="sxs-lookup"><span data-stu-id="b3236-192">User can select a contact group when editing an existing contact.</span></span>
6. <span data-ttu-id="b3236-193">В представлении индекса отображается список групп контактов.</span><span class="sxs-lookup"><span data-stu-id="b3236-193">A list of contact groups is displayed in the Index view.</span></span>
7. <span data-ttu-id="b3236-194">Когда пользователь щелкает группу контактов, отображается список соответствующих контактов.</span><span class="sxs-lookup"><span data-stu-id="b3236-194">When a user clicks a contact group, a list of matching contacts is displayed.</span></span>

<span data-ttu-id="b3236-195">Обратите внимание, что этот список пользовательских историй полностью понятен для клиента.</span><span class="sxs-lookup"><span data-stu-id="b3236-195">Notice that this list of user stories is completely understandable by a customer.</span></span> <span data-ttu-id="b3236-196">Нет упоминания о технической реализации.</span><span class="sxs-lookup"><span data-stu-id="b3236-196">There is no mention of technical implementation details.</span></span>

<span data-ttu-id="b3236-197">В процессе создания приложения набор пользовательских историй может быть более уточнен.</span><span class="sxs-lookup"><span data-stu-id="b3236-197">While in the process of building your application, the set of user stories can become more refined.</span></span> <span data-ttu-id="b3236-198">Вы можете разбить пользовательскую историю на несколько историй (требования).</span><span class="sxs-lookup"><span data-stu-id="b3236-198">You might break a user story into multiple stories (requirements).</span></span> <span data-ttu-id="b3236-199">Например, вы можете решить, что создание новой группы контактов должно содержать проверку.</span><span class="sxs-lookup"><span data-stu-id="b3236-199">For example, you might decide that creating a new contact group should involve validation.</span></span> <span data-ttu-id="b3236-200">При отправке группы контактов без имени должна возвращаться ошибка проверки.</span><span class="sxs-lookup"><span data-stu-id="b3236-200">Submitting a contact group without a name should return a validation error.</span></span>

<span data-ttu-id="b3236-201">После создания списка пользовательских историй можно приступать к написанию первого модульного теста.</span><span class="sxs-lookup"><span data-stu-id="b3236-201">After you create a list of user stories, you are ready to write your first unit test.</span></span> <span data-ttu-id="b3236-202">Начнем с создания модульного теста для просмотра списка групп контактов.</span><span class="sxs-lookup"><span data-stu-id="b3236-202">We'll start by creating a unit test for viewing the list of contact groups.</span></span>

## <a name="listing-contact-groups"></a><span data-ttu-id="b3236-203">Перечисление групп контактов</span><span class="sxs-lookup"><span data-stu-id="b3236-203">Listing Contact Groups</span></span>

<span data-ttu-id="b3236-204">Первая пользовательская история заключается в том, что пользователь должен иметь возможность просматривать список групп контактов.</span><span class="sxs-lookup"><span data-stu-id="b3236-204">Our first user story is that a user should be able to view a list of contact groups.</span></span> <span data-ttu-id="b3236-205">Нам нужно выразить эту историю с помощью теста.</span><span class="sxs-lookup"><span data-stu-id="b3236-205">We need to express this story with a test.</span></span>

<span data-ttu-id="b3236-206">Создайте новый модульный тест, щелкнув правой кнопкой мыши папку Controllers в проекте ContactManager. Tests, выбрав **Добавить, создать тест**и выбрав шаблон **модульного теста** (см. рис. 1).</span><span class="sxs-lookup"><span data-stu-id="b3236-206">Create a new unit test by right-clicking the Controllers folder in the ContactManager.Tests project, selecting **Add, New Test**, and selecting the **Unit Test** template (see Figure 1).</span></span> <span data-ttu-id="b3236-207">Назовите новый модульный тест GroupControllerTest.cs и нажмите кнопку **ОК** .</span><span class="sxs-lookup"><span data-stu-id="b3236-207">Name the new unit test GroupControllerTest.cs and click the **OK** button.</span></span>

<span data-ttu-id="b3236-208">[![Добавление модульного теста Граупконтроллертест](iteration-6-use-test-driven-development-cs/_static/image1.jpg)](iteration-6-use-test-driven-development-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b3236-208">[![Adding the GroupControllerTest unit test](iteration-6-use-test-driven-development-cs/_static/image1.jpg)](iteration-6-use-test-driven-development-cs/_static/image1.png)</span></span>

<span data-ttu-id="b3236-209">**Рис. 01**. Добавление модульного теста Граупконтроллертест ([щелкните, чтобы просмотреть изображение с полным размером](iteration-6-use-test-driven-development-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="b3236-209">**Figure 01**: Adding the GroupControllerTest unit test([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image2.png))</span></span>

<span data-ttu-id="b3236-210">Первый модульный тест содержится в листинге 1.</span><span class="sxs-lookup"><span data-stu-id="b3236-210">Our first unit test is contained in Listing 1.</span></span> <span data-ttu-id="b3236-211">Этот тест проверяет, возвращает ли метод Index () контроллера группы набор групп.</span><span class="sxs-lookup"><span data-stu-id="b3236-211">This test verifies that the Index() method of the Group controller returns a set of Groups.</span></span> <span data-ttu-id="b3236-212">Тест проверяет, что в данных представления возвращена коллекция групп.</span><span class="sxs-lookup"><span data-stu-id="b3236-212">The test verifies that a collection of Groups is returned in view data.</span></span>

<span data-ttu-id="b3236-213">**Листинг 1. Контроллерс\граупконтроллертест.КС**</span><span class="sxs-lookup"><span data-stu-id="b3236-213">**Listing 1 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample1.cs)]

<span data-ttu-id="b3236-214">При первом вводе кода в листинге 1 в Visual Studio вы получите множество красной волнистой линии.</span><span class="sxs-lookup"><span data-stu-id="b3236-214">When you first type the code in Listing 1 in Visual Studio, you'll get a lot of red squiggly lines.</span></span> <span data-ttu-id="b3236-215">Мы не создали классы Граупконтроллер или Group.</span><span class="sxs-lookup"><span data-stu-id="b3236-215">We have not created the GroupController or Group classes.</span></span>

<span data-ttu-id="b3236-216">На этом этапе мы можем даже создать наше приложение, чтобы мы могли выполнить наш первый модульный тест.</span><span class="sxs-lookup"><span data-stu-id="b3236-216">At this point, we can t even build our application so we can t execute our first unit test.</span></span> <span data-ttu-id="b3236-217">Это хорошо.</span><span class="sxs-lookup"><span data-stu-id="b3236-217">That s good.</span></span> <span data-ttu-id="b3236-218">Это считается неудачным тестированием.</span><span class="sxs-lookup"><span data-stu-id="b3236-218">That counts as a failing test.</span></span> <span data-ttu-id="b3236-219">Поэтому теперь у нас есть разрешение на написание кода приложения.</span><span class="sxs-lookup"><span data-stu-id="b3236-219">Therefore, we now have permission to start writing application code.</span></span> <span data-ttu-id="b3236-220">Нам нужно написать достаточно кода для выполнения нашего теста.</span><span class="sxs-lookup"><span data-stu-id="b3236-220">We need to write enough code to execute our test.</span></span>

<span data-ttu-id="b3236-221">Класс контроллера группы в листинге 2 содержит минимально необходимый код для передачи модульного теста.</span><span class="sxs-lookup"><span data-stu-id="b3236-221">The Group controller class in Listing 2 contains the bare minimum of code required to pass the unit test.</span></span> <span data-ttu-id="b3236-222">Действие index () возвращает статически закодированный список групп (класс Group определен в листинге 3).</span><span class="sxs-lookup"><span data-stu-id="b3236-222">The Index() action returns a statically coded list of Groups (the Group class is defined in Listing 3).</span></span>

<span data-ttu-id="b3236-223">**Листинг 2. Контроллерс\граупконтроллер.КС**</span><span class="sxs-lookup"><span data-stu-id="b3236-223">**Listing 2 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample2.cs)]

<span data-ttu-id="b3236-224">**Листинг 3. Моделс\грауп.КС**</span><span class="sxs-lookup"><span data-stu-id="b3236-224">**Listing 3 - Models\Group.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample3.cs)]

<span data-ttu-id="b3236-225">После добавления классов Граупконтроллер и Group в наш проект первый модульный тест завершается успешно (см. рис. 2).</span><span class="sxs-lookup"><span data-stu-id="b3236-225">After we add the GroupController and Group classes to our project, our first unit test completes successfully (see Figure 2).</span></span> <span data-ttu-id="b3236-226">Мы выполнили минимальную работу, необходимую для прохождения теста.</span><span class="sxs-lookup"><span data-stu-id="b3236-226">We have done the minimum work required to pass the test.</span></span> <span data-ttu-id="b3236-227">Пора отпраздновать.</span><span class="sxs-lookup"><span data-stu-id="b3236-227">It is time to celebrate.</span></span>

<span data-ttu-id="b3236-228">[![успешно.](iteration-6-use-test-driven-development-cs/_static/image2.jpg)](iteration-6-use-test-driven-development-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="b3236-228">[![Success!](iteration-6-use-test-driven-development-cs/_static/image2.jpg)](iteration-6-use-test-driven-development-cs/_static/image3.png)</span></span>

<span data-ttu-id="b3236-229">**Рис. 02**. успешное завершение! ([Щелкните, чтобы просмотреть изображение с полным размером](iteration-6-use-test-driven-development-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="b3236-229">**Figure 02**: Success!([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image4.png))</span></span>

## <a name="creating-contact-groups"></a><span data-ttu-id="b3236-230">Создание групп контактов</span><span class="sxs-lookup"><span data-stu-id="b3236-230">Creating Contact Groups</span></span>

<span data-ttu-id="b3236-231">Теперь мы можем перейти к второй пользовательской истории.</span><span class="sxs-lookup"><span data-stu-id="b3236-231">Now we can move on to the second user story.</span></span> <span data-ttu-id="b3236-232">Необходимо иметь возможность создавать новые группы контактов.</span><span class="sxs-lookup"><span data-stu-id="b3236-232">We need to be able to create new contact groups.</span></span> <span data-ttu-id="b3236-233">Нам нужно выразить эту намерение с помощью теста.</span><span class="sxs-lookup"><span data-stu-id="b3236-233">We need to express this intention with a test.</span></span>

<span data-ttu-id="b3236-234">Тест в листинге 4 проверяет, что вызов метода Create () с новой группой добавляет группу в список групп, возвращаемых методом index ().</span><span class="sxs-lookup"><span data-stu-id="b3236-234">The test in Listing 4 verifies that calling the Create() method with a new Group adds the Group to the list of Groups returned by the Index() method.</span></span> <span data-ttu-id="b3236-235">Иными словами, при создании новой группы я должен иметь возможность вернуть новую группу из списка групп, возвращенных методом index ().</span><span class="sxs-lookup"><span data-stu-id="b3236-235">In other words, if I create a new group then I should be able to get the new Group back from the list of Groups returned by the Index() method.</span></span>

<span data-ttu-id="b3236-236">**Листинг 4. Контроллерс\граупконтроллертест.КС**</span><span class="sxs-lookup"><span data-stu-id="b3236-236">**Listing 4 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample4.cs)]

<span data-ttu-id="b3236-237">Тест в листинге 4 вызывает метод Create () группы Controller с новой группой контактов.</span><span class="sxs-lookup"><span data-stu-id="b3236-237">The test in Listing 4 calls the Group controller Create() method with a new contact Group.</span></span> <span data-ttu-id="b3236-238">Затем тест проверяет, что вызов метода Index контроллера группы () возвращает новую группу в данных представления.</span><span class="sxs-lookup"><span data-stu-id="b3236-238">Next, the test verifies that calling the Group controller Index() method returns the new Group in view data.</span></span>

<span data-ttu-id="b3236-239">Измененный контроллер группы в листинге 5 содержит минимально необходимое количество изменений, необходимых для передачи нового теста.</span><span class="sxs-lookup"><span data-stu-id="b3236-239">The modified Group controller in Listing 5 contains the bare minimum of changes required to pass the new test.</span></span>

<span data-ttu-id="b3236-240">**Листинг 5. Контроллерс\граупконтроллер.КС**</span><span class="sxs-lookup"><span data-stu-id="b3236-240">**Listing 5 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample5.cs)]

## <a name="the-group-controller-in-listing-5-has-a-new-create-action-this-action-adds-a-group-to-a-collection-of-groups-notice-that-the-index-action-has-been-modified-to-return-the-contents-of-the-collection-of-groups"></a><span data-ttu-id="b3236-241">Контроллер группы в листинге 5 имеет новое действие Create ().</span><span class="sxs-lookup"><span data-stu-id="b3236-241">The Group controller in Listing 5 has a new Create() action.</span></span> <span data-ttu-id="b3236-242">Это действие добавляет группу в коллекцию групп.</span><span class="sxs-lookup"><span data-stu-id="b3236-242">This action adds a Group to a collection of Groups.</span></span> <span data-ttu-id="b3236-243">Обратите внимание, что действие index () было изменено для возврата содержимого коллекции групп.</span><span class="sxs-lookup"><span data-stu-id="b3236-243">Notice that the Index() action has been modified to return the contents of the collection of Groups.</span></span>

<span data-ttu-id="b3236-244">Опять же, мы выполнили минимальный объем работы, необходимый для передачи модульного теста.</span><span class="sxs-lookup"><span data-stu-id="b3236-244">Once again, we have performed the bare minimum amount of work required to pass the unit test.</span></span> <span data-ttu-id="b3236-245">После внесения этих изменений в контроллер группы все модульные тесты проходят успешно.</span><span class="sxs-lookup"><span data-stu-id="b3236-245">After we make these changes to the Group controller, all of our unit tests pass.</span></span>

## <a name="adding-validation"></a><span data-ttu-id="b3236-246">Добавление проверки</span><span class="sxs-lookup"><span data-stu-id="b3236-246">Adding Validation</span></span>

<span data-ttu-id="b3236-247">Это требование не было указано явно в пользовательской истории.</span><span class="sxs-lookup"><span data-stu-id="b3236-247">This requirement was not stated explicitly in the user story.</span></span> <span data-ttu-id="b3236-248">Однако разумно потребовать, чтобы группа имела имя.</span><span class="sxs-lookup"><span data-stu-id="b3236-248">However, it is reasonable to require that a Group have a name.</span></span> <span data-ttu-id="b3236-249">В противном случае Организация контактов в группы не будет очень полезной.</span><span class="sxs-lookup"><span data-stu-id="b3236-249">Otherwise, organizing contacts into Groups would not be very useful.</span></span>

<span data-ttu-id="b3236-250">В листинге 6 содержится новый тест, который выражает эту намерение.</span><span class="sxs-lookup"><span data-stu-id="b3236-250">Listing 6 contains a new test that expresses this intention.</span></span> <span data-ttu-id="b3236-251">Этот тест проверяет, что попытка создать группу без указания имени приводит к получению сообщения об ошибке проверки в состоянии модели.</span><span class="sxs-lookup"><span data-stu-id="b3236-251">This test verifies that attempting to create a Group without supplying a name results in a validation error message in model state.</span></span>

<span data-ttu-id="b3236-252">**Листинг 6. Контроллерс\граупконтроллертест.КС**</span><span class="sxs-lookup"><span data-stu-id="b3236-252">**Listing 6 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample6.cs)]

<span data-ttu-id="b3236-253">Чтобы удовлетворить этот тест, нам нужно добавить свойство Name в наш класс Group (см. листинг 7).</span><span class="sxs-lookup"><span data-stu-id="b3236-253">In order to satisfy this test, we need to add a Name property to our Group class (see Listing 7).</span></span> <span data-ttu-id="b3236-254">Кроме того, нам нужно добавить небольшой набор логики проверки к действию create () контроллера группы (см. листинг 8).</span><span class="sxs-lookup"><span data-stu-id="b3236-254">Furthermore, we need to add a tiny bit of validation logic to our Group controller s Create() action (see Listing 8).</span></span>

<span data-ttu-id="b3236-255">**Листинг 7 — Моделс\грауп.КС**</span><span class="sxs-lookup"><span data-stu-id="b3236-255">**Listing 7 - Models\Group.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample7.cs)]

<span data-ttu-id="b3236-256">**Листинг 8. Контроллерс\граупконтроллер.КС**</span><span class="sxs-lookup"><span data-stu-id="b3236-256">**Listing 8 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample8.cs)]

<span data-ttu-id="b3236-257">Обратите внимание, что действие создать () контроллера группы теперь содержит логику проверки и базы данных.</span><span class="sxs-lookup"><span data-stu-id="b3236-257">Notice that the Group controller Create() action now contains both validation and database logic.</span></span> <span data-ttu-id="b3236-258">В настоящее время база данных, используемая контроллером группы, состоит не только из коллекции в памяти.</span><span class="sxs-lookup"><span data-stu-id="b3236-258">Currently, the database used by the Group controller consists of nothing more than an in-memory collection.</span></span>

## <a name="time-to-refactor"></a><span data-ttu-id="b3236-259">Время для реструктуризации</span><span class="sxs-lookup"><span data-stu-id="b3236-259">Time to Refactor</span></span>

<span data-ttu-id="b3236-260">Третьим шагом в красном/зеленом/рефакторинг является компонент рефакторинга.</span><span class="sxs-lookup"><span data-stu-id="b3236-260">The third step in Red/Green/Refactor is the Refactor part.</span></span> <span data-ttu-id="b3236-261">На этом этапе нам нужно выполнить шаг назад из нашего кода и подумать о том, как можно выполнить рефакторинг приложения, чтобы улучшить его разработку.</span><span class="sxs-lookup"><span data-stu-id="b3236-261">At this point, we need to step back from our code and consider how we can refactor our application to improve its design.</span></span> <span data-ttu-id="b3236-262">Этап реструктуризации — это этап, на котором мы думаем о лучших способах реализации принципов разработки программного обеспечения и шаблонов.</span><span class="sxs-lookup"><span data-stu-id="b3236-262">The Refactor stage is the stage at which we think hard about the best way of implementing software design principles and patterns.</span></span>

<span data-ttu-id="b3236-263">Мы можем изменить наш код любым способом, который мы решили улучшить структуру кода.</span><span class="sxs-lookup"><span data-stu-id="b3236-263">We are free to modify our code in any way that we choose to improve the design of the code.</span></span> <span data-ttu-id="b3236-264">У нас есть средства для обеспечения безопасности модульных тестов, которые не позволяют прерывать существующую функциональность.</span><span class="sxs-lookup"><span data-stu-id="b3236-264">We have a safety net of unit tests that prevent us from breaking existing functionality.</span></span>

<span data-ttu-id="b3236-265">Сейчас наш контроллер группы очень нехорош с точки зрения хорошего проектирования программного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="b3236-265">Right now, our Group controller is a mess from the perspective of good software design.</span></span> <span data-ttu-id="b3236-266">Контроллер группы содержит запутанную неправильной проверки и кода доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="b3236-266">The Group controller contains a tangled mess of validation and data access code.</span></span> <span data-ttu-id="b3236-267">Чтобы избежать нарушения единого принципа ответственности, необходимо разделить эти задачи на разные классы.</span><span class="sxs-lookup"><span data-stu-id="b3236-267">To avoid violating the Single Responsibility Principle, we need to separate these concerns into different classes.</span></span>

<span data-ttu-id="b3236-268">Наш класс контроллера группы с рефакторингом содержится в листинге 9.</span><span class="sxs-lookup"><span data-stu-id="b3236-268">Our refactored Group controller class is contained in Listing 9.</span></span> <span data-ttu-id="b3236-269">Контроллер был изменен для использования слоя служб ContactManager.</span><span class="sxs-lookup"><span data-stu-id="b3236-269">The controller has been modified to use the ContactManager service layer.</span></span> <span data-ttu-id="b3236-270">Это тот же уровень служб, который используется с контроллером контакта.</span><span class="sxs-lookup"><span data-stu-id="b3236-270">This is the same service layer that we use with the Contact controller.</span></span>

<span data-ttu-id="b3236-271">В листинге 10 содержатся новые методы, добавленные в слой службы ContactManager для поддержки проверки, перечисления и создания групп.</span><span class="sxs-lookup"><span data-stu-id="b3236-271">Listing 10 contains the new methods added to the ContactManager service layer to support validating, listing, and creating groups.</span></span> <span data-ttu-id="b3236-272">Интерфейс Иконтактманажерсервице был обновлен для включения новых методов.</span><span class="sxs-lookup"><span data-stu-id="b3236-272">The IContactManagerService interface was updated to include the new methods.</span></span>

<span data-ttu-id="b3236-273">В листинге 11 содержится новый класс Факеконтактманажеррепоситори, реализующий интерфейс Иконтактманажеррепоситори.</span><span class="sxs-lookup"><span data-stu-id="b3236-273">Listing 11 contains a new FakeContactManagerRepository class that implements the IContactManagerRepository interface.</span></span> <span data-ttu-id="b3236-274">В отличие от класса Ентитиконтактманажеррепоситори, который также реализует интерфейс Иконтактманажеррепоситори, наш новый класс Факеконтактманажеррепоситори не взаимодействует с базой данных.</span><span class="sxs-lookup"><span data-stu-id="b3236-274">Unlike the EntityContactManagerRepository class that also implements the IContactManagerRepository interface, our new FakeContactManagerRepository class does not communicate with the database.</span></span> <span data-ttu-id="b3236-275">Класс Факеконтактманажеррепоситори использует коллекцию в памяти в качестве прокси-сервера для базы данных.</span><span class="sxs-lookup"><span data-stu-id="b3236-275">The FakeContactManagerRepository class uses an in-memory collection as a proxy for the database.</span></span> <span data-ttu-id="b3236-276">Мы будем использовать этот класс в наших модульных тестах в качестве фиктивного слоя репозитория.</span><span class="sxs-lookup"><span data-stu-id="b3236-276">We'll use this class in our unit tests as a fake repository layer.</span></span>

<span data-ttu-id="b3236-277">**Листинг 9. Контроллерс\граупконтроллер.КС**</span><span class="sxs-lookup"><span data-stu-id="b3236-277">**Listing 9 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample9.cs)]

<span data-ttu-id="b3236-278">**Листинг 10 — Контроллерс\контактманажерсервице.КС**</span><span class="sxs-lookup"><span data-stu-id="b3236-278">**Listing 10 - Controllers\ContactManagerService.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample10.cs)]

<span data-ttu-id="b3236-279">**Листинг 11 — Контроллерс\факеконтактманажеррепоситори.КС**</span><span class="sxs-lookup"><span data-stu-id="b3236-279">**Listing 11 - Controllers\FakeContactManagerRepository.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample11.cs)]

<span data-ttu-id="b3236-280">Изменение интерфейса Иконтактманажеррепоситори требует использования метода для реализации методов CreateGroup () и ListGroups () в классе Ентитиконтактманажеррепоситори.</span><span class="sxs-lookup"><span data-stu-id="b3236-280">Modifying the IContactManagerRepository interface requires use to implement the CreateGroup() and ListGroups() methods in the EntityContactManagerRepository class.</span></span> <span data-ttu-id="b3236-281">Самый неограниченный и быстрый способ сделать это — добавить методы-заглушки, которые выглядят следующим образом:</span><span class="sxs-lookup"><span data-stu-id="b3236-281">The laziest and fastest way to do this is to add stub methods that look like this:</span></span>   

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample12.cs)]

<span data-ttu-id="b3236-282">Наконец, эти изменения в проектировании нашего приложения потребовали внесения некоторых изменений в модульные тесты.</span><span class="sxs-lookup"><span data-stu-id="b3236-282">Finally, these changes to the design of our application require us to make some modifications to our unit tests.</span></span> <span data-ttu-id="b3236-283">Теперь при выполнении модульных тестов необходимо использовать Факеконтактманажеррепоситори.</span><span class="sxs-lookup"><span data-stu-id="b3236-283">We now need to use the FakeContactManagerRepository when performing the unit tests.</span></span> <span data-ttu-id="b3236-284">Обновленный класс Граупконтроллертест содержится в листинге 12.</span><span class="sxs-lookup"><span data-stu-id="b3236-284">The updated GroupControllerTest class is contained in Listing 12.</span></span>

<span data-ttu-id="b3236-285">**Листинг 12 — Контроллерс\граупконтроллертест.КС**</span><span class="sxs-lookup"><span data-stu-id="b3236-285">**Listing 12 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample13.cs)]

<span data-ttu-id="b3236-286">После внесения всех этих изменений опять же, все наши модульные тесты проходят успешно.</span><span class="sxs-lookup"><span data-stu-id="b3236-286">After we make all of these changes, once again, all of our unit tests pass.</span></span> <span data-ttu-id="b3236-287">Мы завершили весь цикл красного, зеленого и рефакторинга.</span><span class="sxs-lookup"><span data-stu-id="b3236-287">We have completed the entire cycle of Red/Green/Refactor.</span></span> <span data-ttu-id="b3236-288">Мы реализовали первые две пользовательские истории.</span><span class="sxs-lookup"><span data-stu-id="b3236-288">We have implemented the first two user stories.</span></span> <span data-ttu-id="b3236-289">Теперь у нас есть поддержка модульных тестов для требований, выраженных в пользовательских историях.</span><span class="sxs-lookup"><span data-stu-id="b3236-289">We now have supporting unit tests for the requirements expressed in the user stories.</span></span> <span data-ttu-id="b3236-290">Реализация оставшейся части пользовательских историй подразумевает повторение одного и того же цикла красного, зеленого и рефакторинга.</span><span class="sxs-lookup"><span data-stu-id="b3236-290">Implementing the remainder of the user stories involves repeating the same cycle of Red/Green/Refactor.</span></span>

## <a name="modifying-our-database"></a><span data-ttu-id="b3236-291">Изменение нашей базы данных</span><span class="sxs-lookup"><span data-stu-id="b3236-291">Modifying our Database</span></span>

<span data-ttu-id="b3236-292">К сожалению, несмотря на то, что все требования, представленные в модульных тестах, удовлетворены, наша работа не выполняется.</span><span class="sxs-lookup"><span data-stu-id="b3236-292">Unfortunately, even though we have satisfied all of the requirements expressed by our unit tests, our work is not done.</span></span> <span data-ttu-id="b3236-293">Нам по-прежнему нужно изменить нашу базу данных.</span><span class="sxs-lookup"><span data-stu-id="b3236-293">We still need to modify our database.</span></span>

<span data-ttu-id="b3236-294">Необходимо создать новую таблицу базы данных группы.</span><span class="sxs-lookup"><span data-stu-id="b3236-294">We need to create a new Group database table.</span></span> <span data-ttu-id="b3236-295">Выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="b3236-295">Follow these steps:</span></span>

1. <span data-ttu-id="b3236-296">В окне обозреватель сервера щелкните правой кнопкой мыши папку таблицы и выберите пункт меню **Добавить новую таблицу**.</span><span class="sxs-lookup"><span data-stu-id="b3236-296">In the Server Explorer window, right-click the Tables folder and select the menu option **Add New Table**.</span></span>
2. <span data-ttu-id="b3236-297">Введите два столбца, описанные ниже, в конструктор таблиц.</span><span class="sxs-lookup"><span data-stu-id="b3236-297">Enter the two columns described below in the Table Designer.</span></span>
3. <span data-ttu-id="b3236-298">Пометьте столбец Идентификатор как первичный ключ и столбец идентификаторов.</span><span class="sxs-lookup"><span data-stu-id="b3236-298">Mark the Id column as a primary key and Identity column.</span></span>
4. <span data-ttu-id="b3236-299">Сохраните новую таблицу с группами имен, щелкнув значок дискеты.</span><span class="sxs-lookup"><span data-stu-id="b3236-299">Save the new table with the name Groups by clicking the icon of the floppy.</span></span>

<a id="0.11_table01"></a>

| <span data-ttu-id="b3236-300">**Имя столбца**</span><span class="sxs-lookup"><span data-stu-id="b3236-300">**Column Name**</span></span> | <span data-ttu-id="b3236-301">**Тип данных**</span><span class="sxs-lookup"><span data-stu-id="b3236-301">**Data Type**</span></span> | <span data-ttu-id="b3236-302">**Разрешить значения NULL**</span><span class="sxs-lookup"><span data-stu-id="b3236-302">**Allow Nulls**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="b3236-303">Идентификатор</span><span class="sxs-lookup"><span data-stu-id="b3236-303">Id</span></span> | <span data-ttu-id="b3236-304">INT</span><span class="sxs-lookup"><span data-stu-id="b3236-304">int</span></span> | <span data-ttu-id="b3236-305">False</span><span class="sxs-lookup"><span data-stu-id="b3236-305">False</span></span> |
| <span data-ttu-id="b3236-306">Имя</span><span class="sxs-lookup"><span data-stu-id="b3236-306">Name</span></span> | <span data-ttu-id="b3236-307">nvarchar(50)</span><span class="sxs-lookup"><span data-stu-id="b3236-307">nvarchar(50)</span></span> | <span data-ttu-id="b3236-308">False</span><span class="sxs-lookup"><span data-stu-id="b3236-308">False</span></span> |

<span data-ttu-id="b3236-309">Далее необходимо удалить все данные из таблицы Contacts (в противном случае мы не сможем создать связь между таблицами Contacts и Groups).</span><span class="sxs-lookup"><span data-stu-id="b3236-309">Next, we need to delete all of the data from the Contacts table (otherwise, we won't be able to create a relationship between the Contacts and Groups tables).</span></span> <span data-ttu-id="b3236-310">Выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="b3236-310">Follow these steps:</span></span>

1. <span data-ttu-id="b3236-311">Щелкните правой кнопкой мыши таблицу Контакты и выберите пункт меню **отобразить данные таблицы**.</span><span class="sxs-lookup"><span data-stu-id="b3236-311">Right-click the Contacts table and select the menu option **Show Table Data**.</span></span>
2. <span data-ttu-id="b3236-312">Удалите все строки.</span><span class="sxs-lookup"><span data-stu-id="b3236-312">Delete all of the rows.</span></span>

<span data-ttu-id="b3236-313">Далее необходимо определить связь между таблицей базы данных Groups и существующей таблицей базы данных Contacts.</span><span class="sxs-lookup"><span data-stu-id="b3236-313">Next, we need to define a relationship between the Groups database table and the existing Contacts database table.</span></span> <span data-ttu-id="b3236-314">Выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="b3236-314">Follow these steps:</span></span>

1. <span data-ttu-id="b3236-315">Дважды щелкните таблицу Контакты в окне обозреватель сервера, чтобы открыть конструктор таблиц.</span><span class="sxs-lookup"><span data-stu-id="b3236-315">Double-click the Contacts table in the Server Explorer window to open the Table Designer.</span></span>
2. <span data-ttu-id="b3236-316">Добавьте новый целочисленный столбец в таблицу Contacts с именем GroupId.</span><span class="sxs-lookup"><span data-stu-id="b3236-316">Add a new integer column to the Contacts table named GroupId.</span></span>
3. <span data-ttu-id="b3236-317">Нажмите кнопку связи, чтобы открыть диалоговое окно связи внешних ключей (см. рис. 3).</span><span class="sxs-lookup"><span data-stu-id="b3236-317">Click the Relationship button to open the Foreign Key Relationships dialog (see Figure 3).</span></span>
4. <span data-ttu-id="b3236-318">Нажмите кнопку Добавить.</span><span class="sxs-lookup"><span data-stu-id="b3236-318">Click the Add button.</span></span>
5. <span data-ttu-id="b3236-319">Нажмите кнопку с многоточием рядом с кнопкой Спецификация таблицы и столбцов.</span><span class="sxs-lookup"><span data-stu-id="b3236-319">Click the ellipsis button that appears next to the Table and Columns Specification button.</span></span>
6. <span data-ttu-id="b3236-320">В диалоговом окне таблицы и столбцы выберите группы в качестве таблицы первичного ключа и идентификатор в качестве первичного ключевого столбца.</span><span class="sxs-lookup"><span data-stu-id="b3236-320">In the Tables and Columns dialog, select Groups as the primary key table and Id as the primary key column.</span></span> <span data-ttu-id="b3236-321">Выберите контакты в качестве таблицы внешнего ключа и GroupId в качестве внешнего ключевого столбца (см. рис. 4).</span><span class="sxs-lookup"><span data-stu-id="b3236-321">Select Contacts as the foreign key table and GroupId as the foreign key column (see Figure 4).</span></span> <span data-ttu-id="b3236-322">Нажмите кнопку "ОК".</span><span class="sxs-lookup"><span data-stu-id="b3236-322">Click the OK button.</span></span>
7. <span data-ttu-id="b3236-323">В разделе **Спецификация вставки и обновления**выберите значение **Каскад** для параметра **правило удаления**.</span><span class="sxs-lookup"><span data-stu-id="b3236-323">Under **INSERT and UPDATE Specification**, select the value **Cascade** for **Delete Rule**.</span></span>
8. <span data-ttu-id="b3236-324">Нажмите кнопку Закрыть, чтобы закрыть диалоговое окно связи внешних ключей.</span><span class="sxs-lookup"><span data-stu-id="b3236-324">Click the Close button to close the Foreign Key Relationships dialog.</span></span>
9. <span data-ttu-id="b3236-325">Нажмите кнопку Сохранить, чтобы сохранить изменения в таблице контакты.</span><span class="sxs-lookup"><span data-stu-id="b3236-325">Click the Save button to save the changes to the Contacts table.</span></span>

<span data-ttu-id="b3236-326">[![создания связи таблицы базы данных](iteration-6-use-test-driven-development-cs/_static/image3.jpg)](iteration-6-use-test-driven-development-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="b3236-326">[![Creating a database table relationship](iteration-6-use-test-driven-development-cs/_static/image3.jpg)](iteration-6-use-test-driven-development-cs/_static/image5.png)</span></span>

<span data-ttu-id="b3236-327">**Рис. 03**. Создание связи таблицы базы данных ([щелкните, чтобы просмотреть изображение с полным размером](iteration-6-use-test-driven-development-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b3236-327">**Figure 03**: Creating a database table relationship ([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image6.png))</span></span>

<span data-ttu-id="b3236-328">[![указание связей между таблицами](iteration-6-use-test-driven-development-cs/_static/image4.jpg)](iteration-6-use-test-driven-development-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b3236-328">[![Specifying table relationships](iteration-6-use-test-driven-development-cs/_static/image4.jpg)](iteration-6-use-test-driven-development-cs/_static/image7.png)</span></span>

<span data-ttu-id="b3236-329">**Рис. 04**. Указание связей между таблицами ([щелкните, чтобы просмотреть изображение с полным размером](iteration-6-use-test-driven-development-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="b3236-329">**Figure 04**: Specifying table relationships([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image8.png))</span></span>

### <a name="updating-our-data-model"></a><span data-ttu-id="b3236-330">Обновление нашей модели данных</span><span class="sxs-lookup"><span data-stu-id="b3236-330">Updating our Data Model</span></span>

<span data-ttu-id="b3236-331">Далее нам нужно обновить нашу модель данных, чтобы представить новую таблицу базы данных.</span><span class="sxs-lookup"><span data-stu-id="b3236-331">Next, we need to update our data model to represent the new database table.</span></span> <span data-ttu-id="b3236-332">Выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="b3236-332">Follow these steps:</span></span>

1. <span data-ttu-id="b3236-333">Дважды щелкните файл Контактманажермодел. EDMX в папке Models, чтобы открыть Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="b3236-333">Double-click the ContactManagerModel.edmx file in the Models folder to open the Entity Designer.</span></span>
2. <span data-ttu-id="b3236-334">Щелкните правой кнопкой мыши область конструктора и выберите пункт меню **Обновить модель из базы данных**.</span><span class="sxs-lookup"><span data-stu-id="b3236-334">Right-click the Designer surface and select the menu option **Update Model from Database**.</span></span>
3. <span data-ttu-id="b3236-335">В мастере обновления выберите таблицу группы и нажмите кнопку Готово (см. рис. 5).</span><span class="sxs-lookup"><span data-stu-id="b3236-335">In the Update Wizard, select the Groups table and click the Finish button (see Figure 5).</span></span>
4. <span data-ttu-id="b3236-336">Щелкните правой кнопкой мыши сущность группы и выберите пункт меню **Переименовать**.</span><span class="sxs-lookup"><span data-stu-id="b3236-336">Right-click the Groups entity and select the menu option **Rename**.</span></span> <span data-ttu-id="b3236-337">Измените имя сущности *группы* на *Group* (единственное).</span><span class="sxs-lookup"><span data-stu-id="b3236-337">Change the name of the *Groups* entity to *Group* (singular).</span></span>
5. <span data-ttu-id="b3236-338">Щелкните правой кнопкой мыши свойство навигации группы, которое отображается в нижней части сущности Contact.</span><span class="sxs-lookup"><span data-stu-id="b3236-338">Right-click the Groups navigation property that appears at the bottom of the Contact entity.</span></span> <span data-ttu-id="b3236-339">Измените имя свойства навигации по *группам* на *Group* (единственное).</span><span class="sxs-lookup"><span data-stu-id="b3236-339">Change the name of the *Groups* navigation property to *Group* (singular).</span></span>

<span data-ttu-id="b3236-340">[![обновление модели Entity Framework из базы данных](iteration-6-use-test-driven-development-cs/_static/image5.jpg)](iteration-6-use-test-driven-development-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="b3236-340">[![Updating an Entity Framework model from the database](iteration-6-use-test-driven-development-cs/_static/image5.jpg)](iteration-6-use-test-driven-development-cs/_static/image9.png)</span></span>

<span data-ttu-id="b3236-341">**Рис. 05**. обновление модели Entity Framework из базы данных ([щелкните, чтобы просмотреть изображение с полным размером](iteration-6-use-test-driven-development-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="b3236-341">**Figure 05**: Updating an Entity Framework model from the database([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image10.png))</span></span>

<span data-ttu-id="b3236-342">После выполнения этих действий модель данных будет представлять таблицы Contacts и Groups.</span><span class="sxs-lookup"><span data-stu-id="b3236-342">After you complete these steps, your data model will represent both the Contacts and Groups tables.</span></span> <span data-ttu-id="b3236-343">В Entity Designer должны отображаться обе сущности (см. рис. 6).</span><span class="sxs-lookup"><span data-stu-id="b3236-343">The Entity Designer should show both entities (see Figure 6).</span></span>

<span data-ttu-id="b3236-344">[![Entity Designer отображение группы и контакта](iteration-6-use-test-driven-development-cs/_static/image6.jpg)](iteration-6-use-test-driven-development-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="b3236-344">[![Entity Designer displaying Group and Contact](iteration-6-use-test-driven-development-cs/_static/image6.jpg)](iteration-6-use-test-driven-development-cs/_static/image11.png)</span></span>

<span data-ttu-id="b3236-345">**Рис. 06**. Entity Designer отображения группы и контакта ([щелкните, чтобы просмотреть изображение с полным размером](iteration-6-use-test-driven-development-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="b3236-345">**Figure 06**: Entity Designer displaying Group and Contact([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image12.png))</span></span>

### <a name="creating-our-repository-classes"></a><span data-ttu-id="b3236-346">Создание наших классов репозитория</span><span class="sxs-lookup"><span data-stu-id="b3236-346">Creating our Repository Classes</span></span>

<span data-ttu-id="b3236-347">Далее нам нужно реализовать наш класс репозитория.</span><span class="sxs-lookup"><span data-stu-id="b3236-347">Next, we need to implement our repository class.</span></span> <span data-ttu-id="b3236-348">В ходе этой итерации мы добавили несколько новых методов в интерфейс Иконтактманажеррепоситори при написании кода для удовлетворения наших модульных тестов.</span><span class="sxs-lookup"><span data-stu-id="b3236-348">Over the course of this iteration, we added several new methods to the IContactManagerRepository interface while writing code to satisfy our unit tests.</span></span> <span data-ttu-id="b3236-349">Окончательная версия интерфейса Иконтактманажеррепоситори содержится в листинге 14.</span><span class="sxs-lookup"><span data-stu-id="b3236-349">The final version of the IContactManagerRepository interface is contained in Listing 14.</span></span>

<span data-ttu-id="b3236-350">**Листинг 14-Моделс\иконтактманажеррепоситори.КС**</span><span class="sxs-lookup"><span data-stu-id="b3236-350">**Listing 14 - Models\IContactManagerRepository.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample14.cs)]

<span data-ttu-id="b3236-351">В действительности мы не реализовали методы, связанные с работой с группами контактов.</span><span class="sxs-lookup"><span data-stu-id="b3236-351">We haven't actually implemented any of the methods related to working with contact groups.</span></span> <span data-ttu-id="b3236-352">В настоящее время класс Ентитиконтактманажеррепоситори содержит методы-заглушки для каждого из методов группы контактов, перечисленных в интерфейсе Иконтактманажеррепоситори.</span><span class="sxs-lookup"><span data-stu-id="b3236-352">Currently, the EntityContactManagerRepository class has stub methods for each of the contact group methods listed in the IContactManagerRepository interface.</span></span> <span data-ttu-id="b3236-353">Например, метод ListGroups () в настоящее время выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="b3236-353">For example, the ListGroups() method currently looks like this:</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample15.cs)]

<span data-ttu-id="b3236-354">Методы-заглушки позволяют компилировать наше приложение и передавать модульные тесты.</span><span class="sxs-lookup"><span data-stu-id="b3236-354">The stub methods enabled us to compile our application and pass the unit tests.</span></span> <span data-ttu-id="b3236-355">Однако теперь пора реализовать эти методы.</span><span class="sxs-lookup"><span data-stu-id="b3236-355">However, now it is time to actually implement these methods.</span></span> <span data-ttu-id="b3236-356">Окончательная версия класса Ентитиконтактманажеррепоситори содержится в листинге 13.</span><span class="sxs-lookup"><span data-stu-id="b3236-356">The final version of the EntityContactManagerRepository class is contained in Listing 13.</span></span>

<span data-ttu-id="b3236-357">**Листинг 13. Моделс\ентитиконтактманажеррепоситори.КС**</span><span class="sxs-lookup"><span data-stu-id="b3236-357">**Listing 13 - Models\EntityContactManagerRepository.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample16.cs)]

### <a name="creating-the-views"></a><span data-ttu-id="b3236-358">Создание представлений</span><span class="sxs-lookup"><span data-stu-id="b3236-358">Creating the Views</span></span>

<span data-ttu-id="b3236-359">ASP.NET приложение MVC при использовании подсистемы представлений ASP.NET по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="b3236-359">ASP.NET MVC application when you use the default ASP.NET view engine.</span></span> <span data-ttu-id="b3236-360">Итак, вы не создаете представления в ответ на определенный модульный тест.</span><span class="sxs-lookup"><span data-stu-id="b3236-360">So, you don t create views in response to a particular unit test.</span></span> <span data-ttu-id="b3236-361">Однако, поскольку приложение будет бесполезным без представлений, мы можем завершить эту итерацию, не создавая и не изменяя представления, содержащиеся в приложении Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="b3236-361">However, because an application would be useless without views, we can t complete this iteration without creating and modifying the views contained in the Contact Manager application.</span></span>

<span data-ttu-id="b3236-362">Для управления группами контактов необходимо создать следующие новые представления (см. рис. 7):</span><span class="sxs-lookup"><span data-stu-id="b3236-362">We need to create the following new views for managing contact groups (see Figure 7):</span></span>

- <span data-ttu-id="b3236-363">Виевс\грауп\индекс.аспкс — отображает список групп контактов</span><span class="sxs-lookup"><span data-stu-id="b3236-363">Views\Group\Index.aspx - Displays list of contact groups</span></span>
- <span data-ttu-id="b3236-364">Виевс\грауп\делете.аспкс — отображает форму подтверждения удаления группы контактов</span><span class="sxs-lookup"><span data-stu-id="b3236-364">Views\Group\Delete.aspx - Displays confirmation form for deleting a contact group</span></span>

<span data-ttu-id="b3236-365">[![представление индекса группы](iteration-6-use-test-driven-development-cs/_static/image7.jpg)](iteration-6-use-test-driven-development-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="b3236-365">[![The Group Index view](iteration-6-use-test-driven-development-cs/_static/image7.jpg)](iteration-6-use-test-driven-development-cs/_static/image13.png)</span></span>

<span data-ttu-id="b3236-366">**Рис. 07**. представление индекса группы ([щелкните, чтобы просмотреть изображение с полным размером](iteration-6-use-test-driven-development-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="b3236-366">**Figure 07**: The Group Index view([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image14.png))</span></span>

<span data-ttu-id="b3236-367">Необходимо изменить следующие существующие представления, чтобы они включали группы контактов:</span><span class="sxs-lookup"><span data-stu-id="b3236-367">We need to modify the following existing views so that they include contact groups:</span></span>

- <span data-ttu-id="b3236-368">Views\Home\Create.aspx</span><span class="sxs-lookup"><span data-stu-id="b3236-368">Views\Home\Create.aspx</span></span>
- <span data-ttu-id="b3236-369">Views\Home\Edit.aspx</span><span class="sxs-lookup"><span data-stu-id="b3236-369">Views\Home\Edit.aspx</span></span>
- <span data-ttu-id="b3236-370">Views\Home\Index.aspx</span><span class="sxs-lookup"><span data-stu-id="b3236-370">Views\Home\Index.aspx</span></span>

<span data-ttu-id="b3236-371">Измененные представления можно просмотреть, просмотрев приложение Visual Studio, которое поставляется с этим руководством.</span><span class="sxs-lookup"><span data-stu-id="b3236-371">You can see the modified views by looking at the Visual Studio application that accompanies this tutorial.</span></span> <span data-ttu-id="b3236-372">Например, на рис. 8 показано представление индекса контактов.</span><span class="sxs-lookup"><span data-stu-id="b3236-372">For example, Figure 8 illustrates the Contact Index view.</span></span>

<span data-ttu-id="b3236-373">[![представление индекса контактов](iteration-6-use-test-driven-development-cs/_static/image8.jpg)](iteration-6-use-test-driven-development-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="b3236-373">[![The Contact Index view](iteration-6-use-test-driven-development-cs/_static/image8.jpg)](iteration-6-use-test-driven-development-cs/_static/image15.png)</span></span>

<span data-ttu-id="b3236-374">**Рис. 08**. представление индекса контактов ([щелкните, чтобы просмотреть изображение с полным размером](iteration-6-use-test-driven-development-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="b3236-374">**Figure 08**: The Contact Index view([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image16.png))</span></span>

## <a name="summary"></a><span data-ttu-id="b3236-375">Сводка</span><span class="sxs-lookup"><span data-stu-id="b3236-375">Summary</span></span>

<span data-ttu-id="b3236-376">В этой итерации мы добавили новые функции в приложение диспетчера контактов, следуя методологии разработки приложения на основе тестирования.</span><span class="sxs-lookup"><span data-stu-id="b3236-376">In this iteration, we added new functionality to our Contact Manager application by following a test-driven development application design methodology.</span></span> <span data-ttu-id="b3236-377">Мы начали с создания набора пользовательских историй.</span><span class="sxs-lookup"><span data-stu-id="b3236-377">We started by creating a set of user stories.</span></span> <span data-ttu-id="b3236-378">Мы создали набор модульных тестов, соответствующий требованиям, выраженным в пользовательских описаниях функциональности.</span><span class="sxs-lookup"><span data-stu-id="b3236-378">We created a set of unit tests that corresponds to the requirements expressed by the user stories.</span></span> <span data-ttu-id="b3236-379">Наконец, мы написали достаточно кода для удовлетворения требований, представленных модульными тестами.</span><span class="sxs-lookup"><span data-stu-id="b3236-379">Finally, we wrote just enough code to satisfy the requirements expressed by the unit tests.</span></span>

<span data-ttu-id="b3236-380">После завершения написания достаточного кода для удовлетворения требований, представленных модульными тестами, мы обновили базу данных и представления.</span><span class="sxs-lookup"><span data-stu-id="b3236-380">After we finished writing enough code to satisfy the requirements expressed by the unit tests, we updated our database and views.</span></span> <span data-ttu-id="b3236-381">Мы добавили новую таблицу Groups в нашу базу данных и обновили нашу Entity Frameworkную модель данных.</span><span class="sxs-lookup"><span data-stu-id="b3236-381">We added a new Groups table to our database and updated our Entity Framework Data Model.</span></span> <span data-ttu-id="b3236-382">Мы также создали и изменили набор представлений.</span><span class="sxs-lookup"><span data-stu-id="b3236-382">We also created and modified a set of views.</span></span>

<span data-ttu-id="b3236-383">В следующей итерации — заключительная итерация — мы перепишем наше приложение, чтобы воспользоваться преимуществами AJAX.</span><span class="sxs-lookup"><span data-stu-id="b3236-383">In the next iteration -- the final iteration -- we rewrite our application to take advantage of Ajax.</span></span> <span data-ttu-id="b3236-384">Используя преимущества AJAX, мы улучшаем скорость реагирования и производительность приложения диспетчера контактов.</span><span class="sxs-lookup"><span data-stu-id="b3236-384">By taking advantage of Ajax, we'll improve the responsiveness and performance of the Contact Manager application.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="b3236-385">[Назад](iteration-5-create-unit-tests-cs.md)
> [Вперед](iteration-7-add-ajax-functionality-cs.md)</span><span class="sxs-lookup"><span data-stu-id="b3236-385">[Previous](iteration-5-create-unit-tests-cs.md)
[Next](iteration-7-add-ajax-functionality-cs.md)</span></span>
