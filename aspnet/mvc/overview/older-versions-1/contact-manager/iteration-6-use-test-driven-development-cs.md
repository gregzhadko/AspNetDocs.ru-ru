---
uid: mvc/overview/older-versions-1/contact-manager/iteration-6-use-test-driven-development-cs
title: 'Итерация #6 - Используйте тестовую разработку (СЗ) Документы Майкрософт'
author: rick-anderson
description: В этой шестой итерации мы добавляем новую функциональность в наше приложение, написав модульные тесты сначала и написав код против модульных тестов. В этой итерации,...
ms.author: riande
ms.date: 02/20/2009
ms.assetid: 013c3c26-7dc3-41d1-8064-f233c86008b5
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-6-use-test-driven-development-cs
msc.type: authoredcontent
ms.openlocfilehash: d0e8f30a075cc79c7410ffe1b8bf02da2bd44443
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2020
ms.locfileid: "81542330"
---
# <a name="iteration-6--use-test-driven-development-c"></a><span data-ttu-id="9c486-104">Итерация 6. Использование разработки, управляемой тестами (C#)</span><span class="sxs-lookup"><span data-stu-id="9c486-104">Iteration #6 – Use test-driven development (C#)</span></span>

<span data-ttu-id="9c486-105">[корпорацией Майкрософт](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="9c486-105">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="9c486-106">Скачать код</span><span class="sxs-lookup"><span data-stu-id="9c486-106">Download Code</span></span>](iteration-6-use-test-driven-development-cs/_static/contactmanager_6_cs1.zip)

> <span data-ttu-id="9c486-107">В этой шестой итерации мы добавляем новую функциональность в наше приложение, написав модульные тесты сначала и написав код против модульных тестов.</span><span class="sxs-lookup"><span data-stu-id="9c486-107">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="9c486-108">В этой итерации мы добавляем контактные группы.</span><span class="sxs-lookup"><span data-stu-id="9c486-108">In this iteration, we add contact groups.</span></span>

## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="9c486-109">Создание приложения управления контактами ASP.NET MVC (C)</span><span class="sxs-lookup"><span data-stu-id="9c486-109">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="9c486-110">В этой серии учебников мы создаем все приложение Управления Контактами от начала до конца.</span><span class="sxs-lookup"><span data-stu-id="9c486-110">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="9c486-111">Приложение Contact Manager позволяет хранить контактную информацию - имена, номера телефонов и адреса электронной почты - для списка людей.</span><span class="sxs-lookup"><span data-stu-id="9c486-111">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="9c486-112">Мы строим приложение по нескольким итерациям.</span><span class="sxs-lookup"><span data-stu-id="9c486-112">We build the application over multiple iterations.</span></span> <span data-ttu-id="9c486-113">С каждой итерацией мы постепенно совершенствуем приложение.</span><span class="sxs-lookup"><span data-stu-id="9c486-113">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="9c486-114">Цель этого подхода с множественной итерацией состоит в том, чтобы вы могли понять причину каждого изменения.</span><span class="sxs-lookup"><span data-stu-id="9c486-114">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="9c486-115">Итерация #1 - Создайте приложение.</span><span class="sxs-lookup"><span data-stu-id="9c486-115">Iteration #1 - Create the application.</span></span> <span data-ttu-id="9c486-116">В первой итерации мы создаем Контакт-менеджер самым простым способом.</span><span class="sxs-lookup"><span data-stu-id="9c486-116">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="9c486-117">Мы добавляем поддержку для основных операций базы данных: Создание, чтение, обновление и удаление (CRUD).</span><span class="sxs-lookup"><span data-stu-id="9c486-117">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="9c486-118">Итерация #2 - Сделать приложение хорошо выглядеть.</span><span class="sxs-lookup"><span data-stu-id="9c486-118">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="9c486-119">В этой итерации мы улучшаем внешний вид приложения, изменяя страницу по умолчанию ASP.NET MVC просмотра и каскадный стиль листа.</span><span class="sxs-lookup"><span data-stu-id="9c486-119">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="9c486-120">Итерация #3 - Добавить проверку формы.</span><span class="sxs-lookup"><span data-stu-id="9c486-120">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="9c486-121">В третьей итерации мы добавляем базовую проверку формы.</span><span class="sxs-lookup"><span data-stu-id="9c486-121">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="9c486-122">Мы не позволяем людям подавать форму без заполнения требуемых полей формы.</span><span class="sxs-lookup"><span data-stu-id="9c486-122">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="9c486-123">Мы также проверяем адреса электронной почты и номера телефонов.</span><span class="sxs-lookup"><span data-stu-id="9c486-123">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="9c486-124">Итерация #4 - Сделать приложение слабо связаны.</span><span class="sxs-lookup"><span data-stu-id="9c486-124">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="9c486-125">В этой четвертой итерации мы воспользуемся несколькими шаблонами проектирования программного обеспечения, чтобы упростить обслуживание и изменение приложения Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="9c486-125">In this fourth iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="9c486-126">Например, мы рефакторизуем наше приложение, чтобы использовать шаблон репозитория и шаблон инъекций зависимостей.</span><span class="sxs-lookup"><span data-stu-id="9c486-126">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="9c486-127">Итерация #5 - Создание модульных тестов.</span><span class="sxs-lookup"><span data-stu-id="9c486-127">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="9c486-128">В пятой итерации мы упрощаем обслуживание и модификацию нашего приложения путем добавления модульных тестов.</span><span class="sxs-lookup"><span data-stu-id="9c486-128">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="9c486-129">Мы издеваемся над нашими классами моделей данных и строим модульные тесты для наших контроллеров и логики проверки.</span><span class="sxs-lookup"><span data-stu-id="9c486-129">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="9c486-130">Итерация #6 - Использование тест-ориентированной разработки.</span><span class="sxs-lookup"><span data-stu-id="9c486-130">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="9c486-131">В этой шестой итерации мы добавляем новую функциональность в наше приложение, написав модульные тесты сначала и написав код против модульных тестов.</span><span class="sxs-lookup"><span data-stu-id="9c486-131">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="9c486-132">В этой итерации мы добавляем контактные группы.</span><span class="sxs-lookup"><span data-stu-id="9c486-132">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="9c486-133">Итерация #7 - Добавить функциональность Ajax.</span><span class="sxs-lookup"><span data-stu-id="9c486-133">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="9c486-134">В седьмой итерации мы улучшаем отзывчивость и производительность нашего приложения, добавляя поддержку Ajax.</span><span class="sxs-lookup"><span data-stu-id="9c486-134">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>

## <a name="this-iteration"></a><span data-ttu-id="9c486-135">Эта итерация</span><span class="sxs-lookup"><span data-stu-id="9c486-135">This Iteration</span></span>

<span data-ttu-id="9c486-136">В предыдущей итерации приложения Contact Manager мы создали модульные тесты, чтобы обеспечить защиту нашего кода.</span><span class="sxs-lookup"><span data-stu-id="9c486-136">In the previous iteration of the Contact Manager application, we created unit tests to provide a safety net for our code.</span></span> <span data-ttu-id="9c486-137">Мотивация для создания модульных тестов заключалась в том, чтобы сделать наш код более устойчивым к изменениям.</span><span class="sxs-lookup"><span data-stu-id="9c486-137">The motivation for creating the unit tests was to make our code more resilient to change.</span></span> <span data-ttu-id="9c486-138">С модульными тестами на месте, мы можем с радостью внести какие-либо изменения в наш код и сразу же знать, нарушили ли мы существующую функциональность.</span><span class="sxs-lookup"><span data-stu-id="9c486-138">With unit tests in place, we can happily make any change to our code and immediately know whether we have broken existing functionality.</span></span>

<span data-ttu-id="9c486-139">В этой итерации мы используем модульные тесты для совершенно другой цели.</span><span class="sxs-lookup"><span data-stu-id="9c486-139">In this iteration, we use unit tests for an entirely different purpose.</span></span> <span data-ttu-id="9c486-140">В этой итерации мы используем модульные тесты как часть философии проектирования приложений, *называемой разработкой, управляемой тестами.*</span><span class="sxs-lookup"><span data-stu-id="9c486-140">In this iteration, we use unit tests as part of an application design philosophy called *test-driven development*.</span></span> <span data-ttu-id="9c486-141">Когда вы практикуете разработку, управляемую тестами, вы сначала пишете тесты, а затем пишете код против тестов.</span><span class="sxs-lookup"><span data-stu-id="9c486-141">When you practice test-driven development, you write tests first and then write code against the tests.</span></span>

<span data-ttu-id="9c486-142">Точнее, при практике разработки, управляемой тестами, есть три шага, которые вы выполняете при создании кода (Красный/Зеленый/Рефактор):</span><span class="sxs-lookup"><span data-stu-id="9c486-142">More precisely, when practicing test-driven development, there are three steps that you complete when creating code (Red/ Green/Refactor):</span></span>

1. <span data-ttu-id="9c486-143">Написать модульный тест, который не удается (красный)</span><span class="sxs-lookup"><span data-stu-id="9c486-143">Write a unit test that fails (Red)</span></span>
2. <span data-ttu-id="9c486-144">Напишите код, который проходит модульный тест (зеленый)</span><span class="sxs-lookup"><span data-stu-id="9c486-144">Write code that passes the unit test (Green)</span></span>
3. <span data-ttu-id="9c486-145">Рефактор код (Refactor)</span><span class="sxs-lookup"><span data-stu-id="9c486-145">Refactor your code (Refactor)</span></span>

<span data-ttu-id="9c486-146">Во-первых, вы пишете модульный тест.</span><span class="sxs-lookup"><span data-stu-id="9c486-146">First, you write the unit test.</span></span> <span data-ttu-id="9c486-147">Модульный тест должен выразить ваше намерение, как вы ожидаете, что ваш код будет вести себя.</span><span class="sxs-lookup"><span data-stu-id="9c486-147">The unit test should express your intention for how you expect your code to behave.</span></span> <span data-ttu-id="9c486-148">При первом создании модульного теста модульный тест должен выполнить неудачу.</span><span class="sxs-lookup"><span data-stu-id="9c486-148">When you first create the unit test, the unit test should fail.</span></span> <span data-ttu-id="9c486-149">Тест должен выполнить неудачу, поскольку вы еще не написали ни одного кода приложения, удовлетворяя тест.</span><span class="sxs-lookup"><span data-stu-id="9c486-149">The test should fail because you have not yet written any application code that satisfies the test.</span></span>

<span data-ttu-id="9c486-150">Далее, вы пишете достаточно кода для того, чтобы модульный тест прошел.</span><span class="sxs-lookup"><span data-stu-id="9c486-150">Next, you write just enough code in order for the unit test to pass.</span></span> <span data-ttu-id="9c486-151">Цель состоит в том, чтобы написать код самым ленивым, небрежным и быстрым способом.</span><span class="sxs-lookup"><span data-stu-id="9c486-151">The goal is to write the code in the laziest, sloppiest and fastest possible way.</span></span> <span data-ttu-id="9c486-152">Не следует тратить время на размышления об архитектуре приложения.</span><span class="sxs-lookup"><span data-stu-id="9c486-152">You should not waste time thinking about the architecture of your application.</span></span> <span data-ttu-id="9c486-153">Вместо этого следует сосредоточиться на написании минимального количества кода, необходимого для удовлетворения намерения, выраженного в модульном тесте.</span><span class="sxs-lookup"><span data-stu-id="9c486-153">Instead, you should focus on writing the minimal amount of code necessary to satisfy the intention expressed by the unit test.</span></span>

<span data-ttu-id="9c486-154">Наконец, после того, как вы написали достаточно кода, вы можете сделать шаг назад и рассмотреть общую архитектуру приложения.</span><span class="sxs-lookup"><span data-stu-id="9c486-154">Finally, after you have written enough code, you can step back and consider the overall architecture of your application.</span></span> <span data-ttu-id="9c486-155">На этом этапе вы переписываете (рефакторинг) свой код, пользуясь шаблонами проектирования программного обеспечения, такими как шаблон репозитория, чтобы ваш код был более обслуживаемым.</span><span class="sxs-lookup"><span data-stu-id="9c486-155">In this step, you rewrite (refactor) your code by taking advantage of software design patterns -- such as the repository pattern -- so that your code is more maintainable.</span></span> <span data-ttu-id="9c486-156">Вы можете бесстрашно переписать свой код на этом этапе, потому что ваш код покрыт модульными тестами.</span><span class="sxs-lookup"><span data-stu-id="9c486-156">You can fearlessly rewrite your code in this step because your code is covered by unit tests.</span></span>

<span data-ttu-id="9c486-157">Есть много преимуществ, которые являются результатом практики тестовых разработки.</span><span class="sxs-lookup"><span data-stu-id="9c486-157">There are many benefits that result from practicing test-driven development.</span></span> <span data-ttu-id="9c486-158">Во-первых, разработка, ориентированная на тестирование, заставляет вас сосредоточиться на коде, который на самом деле должен быть написан.</span><span class="sxs-lookup"><span data-stu-id="9c486-158">First, test-driven development forces you to focus on code that actually needs to be written.</span></span> <span data-ttu-id="9c486-159">Поскольку вы постоянно сосредоточены на том, чтобы просто написать достаточно кода, чтобы пройти определенный тест, вам не дают забродить по сорнякам и писать огромное количество кода, который вы никогда не будете использовать.</span><span class="sxs-lookup"><span data-stu-id="9c486-159">Because you are constantly focused on just writing enough code to pass a particular test, you are prevented from wandering into the weeds and writing massive amounts of code that you will never use.</span></span>

<span data-ttu-id="9c486-160">Во-вторых, методология проектирования «первый тест» вынуждает вас писать код с точки зрения того, как будет использоваться ваш код.</span><span class="sxs-lookup"><span data-stu-id="9c486-160">Second, a "test first" design methodology forces you to write code from the perspective of how your code will be used.</span></span> <span data-ttu-id="9c486-161">Другими словами, при практике разработки, управляемой тестами, вы постоянно пишете свои тесты с точки зрения пользователя.</span><span class="sxs-lookup"><span data-stu-id="9c486-161">In other words, when practicing test-driven development, you are constantly writing your tests from a user perspective.</span></span> <span data-ttu-id="9c486-162">Таким образом, разработка, основанная на тестах, может привести к созданию более чистых и понятных AA.</span><span class="sxs-lookup"><span data-stu-id="9c486-162">Therefore, test-driven development can result in cleaner and more understandable APIs.</span></span>

<span data-ttu-id="9c486-163">Наконец, тестовая разработка заставляет вас писать модульные тесты как часть нормального процесса написания приложения.</span><span class="sxs-lookup"><span data-stu-id="9c486-163">Finally, test-driven development forces you to write unit tests as part of the normal process of writing an application.</span></span> <span data-ttu-id="9c486-164">По мере приближения крайнего срока реализации проекта тестирование, как правило, является первым, что выходит из окна.</span><span class="sxs-lookup"><span data-stu-id="9c486-164">As a project deadline approaches, testing is typically the first thing that goes out the window.</span></span> <span data-ttu-id="9c486-165">С другой стороны, при практике разработки, управляемой тестами, вы, скорее всего, будете добродетельны в написании модульных тестов, поскольку разработка, управляемая тестами, делает модульные тесты центральными для процесса создания приложения.</span><span class="sxs-lookup"><span data-stu-id="9c486-165">When practicing test-driven development, on the other hand, you are more likely to be virtuous about writing unit tests because test-driven development makes unit tests central to the process of building an application.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="9c486-166">Чтобы узнать больше о разработке, управляемой тестами, я рекомендую вам прочитать книгу Майкла Перья **Работая эффективно с Наследие мною .**</span><span class="sxs-lookup"><span data-stu-id="9c486-166">To learn more about test-driven development, I recommend that you read Michael Feathers book **Working Effectively with Legacy Code**.</span></span>

<span data-ttu-id="9c486-167">В этой итерации мы добавляем новую функцию в наше приложение Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="9c486-167">In this iteration, we add a new feature to our Contact Manager application.</span></span> <span data-ttu-id="9c486-168">Мы добавляем поддержку Контактным группам.</span><span class="sxs-lookup"><span data-stu-id="9c486-168">We add support for Contact Groups.</span></span> <span data-ttu-id="9c486-169">Вы можете использовать контактные группы для организации контактов по таким категориям, как группы бизнеса и друзей.</span><span class="sxs-lookup"><span data-stu-id="9c486-169">You can use Contact Groups to organize your contacts into categories such as Business and Friend groups.</span></span>

<span data-ttu-id="9c486-170">Мы добавим эту новую функциональность в наше приложение, следуя процессу разработки на основе тестирования.</span><span class="sxs-lookup"><span data-stu-id="9c486-170">We'll add this new functionality to our application by following a process of test-driven development.</span></span> <span data-ttu-id="9c486-171">Сначала мы напишем модульные тесты и напишем весь наш код против этих тестов.</span><span class="sxs-lookup"><span data-stu-id="9c486-171">We'll write our unit tests first and we'll write all of our code against these tests.</span></span>

## <a name="what-gets-tested"></a><span data-ttu-id="9c486-172">Что проходит тестирование</span><span class="sxs-lookup"><span data-stu-id="9c486-172">What Gets Tested</span></span>

<span data-ttu-id="9c486-173">Как мы обсуждали в предыдущей итерации, обычно вы не пишете модульные тесты для логики доступа к данным или логики представления.</span><span class="sxs-lookup"><span data-stu-id="9c486-173">As we discussed in the previous iteration, you typically do not write unit tests for data access logic or view logic.</span></span> <span data-ttu-id="9c486-174">Вы не пишете модульные тесты для логики доступа к данным, поскольку доступ к базе данных является относительно медленной операцией.</span><span class="sxs-lookup"><span data-stu-id="9c486-174">You don t write unit tests for data access logic because accessing a database is a relatively slow operation.</span></span> <span data-ttu-id="9c486-175">Вы не пишете модульные тесты для логики представления, потому что доступ к представлению требует вращения веб-сервера, который является относительно медленной операцией.</span><span class="sxs-lookup"><span data-stu-id="9c486-175">You don t write unit tests for view logic because accessing a view requires spinning up a web server which is a relatively slow operation.</span></span> <span data-ttu-id="9c486-176">Вы не должны писать модульный тест, если тест не может быть выполнен снова и снова очень быстро</span><span class="sxs-lookup"><span data-stu-id="9c486-176">You shouldn't write a unit test unless the test can be executed over and over again very fast</span></span>

<span data-ttu-id="9c486-177">Поскольку разработка, основанная на тестировании, определяется модульными тестами, мы изначально фокусируемся на написании контроллера и бизнес-логики.</span><span class="sxs-lookup"><span data-stu-id="9c486-177">Because test-driven development is driven by unit tests, we focus initially on writing controller and business logic.</span></span> <span data-ttu-id="9c486-178">Мы избегаем прикосновения к базе данных или представлениям.</span><span class="sxs-lookup"><span data-stu-id="9c486-178">We avoid touching the database or views.</span></span> <span data-ttu-id="9c486-179">Мы не будем изменять базу данных или создавать наши представления до самого конца этого урока.</span><span class="sxs-lookup"><span data-stu-id="9c486-179">We won't modify the database or create our views until the very end of this tutorial.</span></span> <span data-ttu-id="9c486-180">Начнем с того, что может быть проверено.</span><span class="sxs-lookup"><span data-stu-id="9c486-180">We start with what can be tested.</span></span>

## <a name="creating-user-stories"></a><span data-ttu-id="9c486-181">Создание историй пользователей</span><span class="sxs-lookup"><span data-stu-id="9c486-181">Creating User Stories</span></span>

<span data-ttu-id="9c486-182">При практике разработки, управляемой тестами, вы всегда начинаете с написания теста.</span><span class="sxs-lookup"><span data-stu-id="9c486-182">When practicing test-driven development, you always start by writing a test.</span></span> <span data-ttu-id="9c486-183">Это сразу же поднимает вопрос: Как вы решаете, какой тест написать в первую очередь?</span><span class="sxs-lookup"><span data-stu-id="9c486-183">This immediately raises the question: How do you decide what test to write first?</span></span> <span data-ttu-id="9c486-184">Чтобы ответить на этот вопрос, вы должны написать набор [**пользовательских историй.**](http://en.wikipedia.org/wiki/User_stories)</span><span class="sxs-lookup"><span data-stu-id="9c486-184">To answer this question, you should write a set of [**user stories**](http://en.wikipedia.org/wiki/User_stories).</span></span>

<span data-ttu-id="9c486-185">История пользователя представляет собой очень краткое (обычно одно предложение) описание требования к программному обеспечению.</span><span class="sxs-lookup"><span data-stu-id="9c486-185">A user story is a very brief (usually one sentence) description of a software requirement.</span></span> <span data-ttu-id="9c486-186">Это должно быть нетехническое описание требования, написанного с точки зрения пользователя.</span><span class="sxs-lookup"><span data-stu-id="9c486-186">It should be a non-technical description of a requirement written from a user perspective.</span></span>

<span data-ttu-id="9c486-187">Вот набор пользовательских историй, описывающие функции, необходимые для новой функциональности Контактной группы:</span><span class="sxs-lookup"><span data-stu-id="9c486-187">Here s the set of user stories that describe the features required by the new Contact Group functionality:</span></span>

1. <span data-ttu-id="9c486-188">Пользователь может просматривать список контактных групп.</span><span class="sxs-lookup"><span data-stu-id="9c486-188">User can view a list of contact groups.</span></span>
2. <span data-ttu-id="9c486-189">Пользователь может создать новую контактную группу.</span><span class="sxs-lookup"><span data-stu-id="9c486-189">User can create a new contact group.</span></span>
3. <span data-ttu-id="9c486-190">Пользователь может удалить существующую контактную группу.</span><span class="sxs-lookup"><span data-stu-id="9c486-190">User can delete an existing contact group.</span></span>
4. <span data-ttu-id="9c486-191">Пользователь может выбрать контактную группу при создании нового контакта.</span><span class="sxs-lookup"><span data-stu-id="9c486-191">User can select a contact group when creating a new contact.</span></span>
5. <span data-ttu-id="9c486-192">Пользователь может выбрать контактную группу при редактировании существующего контакта.</span><span class="sxs-lookup"><span data-stu-id="9c486-192">User can select a contact group when editing an existing contact.</span></span>
6. <span data-ttu-id="9c486-193">Список контактных групп отображается в представлении Индекса.</span><span class="sxs-lookup"><span data-stu-id="9c486-193">A list of contact groups is displayed in the Index view.</span></span>
7. <span data-ttu-id="9c486-194">Когда пользователь нажимает на контактную группу, отображается список соответствующих контактов.</span><span class="sxs-lookup"><span data-stu-id="9c486-194">When a user clicks a contact group, a list of matching contacts is displayed.</span></span>

<span data-ttu-id="9c486-195">Обратите внимание, что этот список пользовательских историй полностью понятен клиенту.</span><span class="sxs-lookup"><span data-stu-id="9c486-195">Notice that this list of user stories is completely understandable by a customer.</span></span> <span data-ttu-id="9c486-196">Подробности технической реализации не упоминаются.</span><span class="sxs-lookup"><span data-stu-id="9c486-196">There is no mention of technical implementation details.</span></span>

<span data-ttu-id="9c486-197">В процессе создания приложения набор пользовательских историй может стать более изысканным.</span><span class="sxs-lookup"><span data-stu-id="9c486-197">While in the process of building your application, the set of user stories can become more refined.</span></span> <span data-ttu-id="9c486-198">Вы можете разбить историю пользователя на несколько историй (требований).</span><span class="sxs-lookup"><span data-stu-id="9c486-198">You might break a user story into multiple stories (requirements).</span></span> <span data-ttu-id="9c486-199">Например, можно решить, что создание новой контактной группы должно включать проверку.</span><span class="sxs-lookup"><span data-stu-id="9c486-199">For example, you might decide that creating a new contact group should involve validation.</span></span> <span data-ttu-id="9c486-200">Отправка контактной группы без имени должна вернуть ошибку проверки.</span><span class="sxs-lookup"><span data-stu-id="9c486-200">Submitting a contact group without a name should return a validation error.</span></span>

<span data-ttu-id="9c486-201">После создания списка пользовательских историй вы будете готовы написать свой первый модульный тест.</span><span class="sxs-lookup"><span data-stu-id="9c486-201">After you create a list of user stories, you are ready to write your first unit test.</span></span> <span data-ttu-id="9c486-202">Начнем с создания модульного теста для просмотра списка контактных групп.</span><span class="sxs-lookup"><span data-stu-id="9c486-202">We'll start by creating a unit test for viewing the list of contact groups.</span></span>

## <a name="listing-contact-groups"></a><span data-ttu-id="9c486-203">Перечисление контактных групп</span><span class="sxs-lookup"><span data-stu-id="9c486-203">Listing Contact Groups</span></span>

<span data-ttu-id="9c486-204">Наша первая история пользователя заключается в том, что пользователь должен иметь возможность просматривать список контактных групп.</span><span class="sxs-lookup"><span data-stu-id="9c486-204">Our first user story is that a user should be able to view a list of contact groups.</span></span> <span data-ttu-id="9c486-205">Мы должны выразить эту историю с тестом.</span><span class="sxs-lookup"><span data-stu-id="9c486-205">We need to express this story with a test.</span></span>

<span data-ttu-id="9c486-206">Создайте новый модульный тест, нажав на папку контроллеров в проекте ContactManager.Tests, выбрав **добавить, новый тест**и выбрав шаблон **Unit Test** (см. рисунок 1).</span><span class="sxs-lookup"><span data-stu-id="9c486-206">Create a new unit test by right-clicking the Controllers folder in the ContactManager.Tests project, selecting **Add, New Test**, and selecting the **Unit Test** template (see Figure 1).</span></span> <span data-ttu-id="9c486-207">Назовите новый модульный тест GroupControllerTest.cs и нажмите кнопку **OK.**</span><span class="sxs-lookup"><span data-stu-id="9c486-207">Name the new unit test GroupControllerTest.cs and click the **OK** button.</span></span>

<span data-ttu-id="9c486-208">[![Добавление единого теста GroupControllerTest](iteration-6-use-test-driven-development-cs/_static/image1.jpg)](iteration-6-use-test-driven-development-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="9c486-208">[![Adding the GroupControllerTest unit test](iteration-6-use-test-driven-development-cs/_static/image1.jpg)](iteration-6-use-test-driven-development-cs/_static/image1.png)</span></span>

<span data-ttu-id="9c486-209">**Рисунок 01**: Добавление модульного теста GroupControllerTest[(Нажмите, чтобы просмотреть полноразмерное изображение)](iteration-6-use-test-driven-development-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="9c486-209">**Figure 01**: Adding the GroupControllerTest unit test([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image2.png))</span></span>

<span data-ttu-id="9c486-210">Наш первый модульный тест содержится в листинге 1.</span><span class="sxs-lookup"><span data-stu-id="9c486-210">Our first unit test is contained in Listing 1.</span></span> <span data-ttu-id="9c486-211">Этот тест проверяет, что метод Индекса () контроллера группы возвращает набор групп.</span><span class="sxs-lookup"><span data-stu-id="9c486-211">This test verifies that the Index() method of the Group controller returns a set of Groups.</span></span> <span data-ttu-id="9c486-212">Тест проверяет, что коллекция групп возвращается в данные зрения.</span><span class="sxs-lookup"><span data-stu-id="9c486-212">The test verifies that a collection of Groups is returned in view data.</span></span>

<span data-ttu-id="9c486-213">**Список 1 - Контролеры**</span><span class="sxs-lookup"><span data-stu-id="9c486-213">**Listing 1 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample1.cs)]

<span data-ttu-id="9c486-214">При первом вводе кода в листинге 1 в Visual Studio, вы получите много красных линий squiggly.</span><span class="sxs-lookup"><span data-stu-id="9c486-214">When you first type the code in Listing 1 in Visual Studio, you'll get a lot of red squiggly lines.</span></span> <span data-ttu-id="9c486-215">Мы не создавали классы GroupController или Group.</span><span class="sxs-lookup"><span data-stu-id="9c486-215">We have not created the GroupController or Group classes.</span></span>

<span data-ttu-id="9c486-216">На данный момент, мы не можем даже построить наше приложение, чтобы мы не могли выполнить наш первый модульный тест.</span><span class="sxs-lookup"><span data-stu-id="9c486-216">At this point, we can t even build our application so we can t execute our first unit test.</span></span> <span data-ttu-id="9c486-217">Это хорошо.</span><span class="sxs-lookup"><span data-stu-id="9c486-217">That s good.</span></span> <span data-ttu-id="9c486-218">Это считается неудачным испытанием.</span><span class="sxs-lookup"><span data-stu-id="9c486-218">That counts as a failing test.</span></span> <span data-ttu-id="9c486-219">Поэтому теперь у нас есть разрешение начать писать код приложения.</span><span class="sxs-lookup"><span data-stu-id="9c486-219">Therefore, we now have permission to start writing application code.</span></span> <span data-ttu-id="9c486-220">Нам нужно написать достаточно кода для выполнения нашего теста.</span><span class="sxs-lookup"><span data-stu-id="9c486-220">We need to write enough code to execute our test.</span></span>

<span data-ttu-id="9c486-221">Класс контроллера группы в листинге 2 содержит минимум кода, необходимого для прохождения модульного теста.</span><span class="sxs-lookup"><span data-stu-id="9c486-221">The Group controller class in Listing 2 contains the bare minimum of code required to pass the unit test.</span></span> <span data-ttu-id="9c486-222">Действие Индекс () возвращает статический закодированный список групп (класс группы определяется в листинге 3).</span><span class="sxs-lookup"><span data-stu-id="9c486-222">The Index() action returns a statically coded list of Groups (the Group class is defined in Listing 3).</span></span>

<span data-ttu-id="9c486-223">**Список 2 - Контролеры группыКонтрол.cs**</span><span class="sxs-lookup"><span data-stu-id="9c486-223">**Listing 2 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample2.cs)]

<span data-ttu-id="9c486-224">**Список 3 - Модели-Group.cs**</span><span class="sxs-lookup"><span data-stu-id="9c486-224">**Listing 3 - Models\Group.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample3.cs)]

<span data-ttu-id="9c486-225">После добавления в наш проект классов GroupController и Group, наш первый модульный тест успешно завершается (см. рисунок 2).</span><span class="sxs-lookup"><span data-stu-id="9c486-225">After we add the GroupController and Group classes to our project, our first unit test completes successfully (see Figure 2).</span></span> <span data-ttu-id="9c486-226">Мы проделали минимальную работу, необходимую для прохождения теста.</span><span class="sxs-lookup"><span data-stu-id="9c486-226">We have done the minimum work required to pass the test.</span></span> <span data-ttu-id="9c486-227">Настало время праздновать.</span><span class="sxs-lookup"><span data-stu-id="9c486-227">It is time to celebrate.</span></span>

<span data-ttu-id="9c486-228">[![Успех!](iteration-6-use-test-driven-development-cs/_static/image2.jpg)](iteration-6-use-test-driven-development-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="9c486-228">[![Success!](iteration-6-use-test-driven-development-cs/_static/image2.jpg)](iteration-6-use-test-driven-development-cs/_static/image3.png)</span></span>

<span data-ttu-id="9c486-229">**Рисунок 02**: Успех! ([Нажмите, чтобы просмотреть полноразмерное изображение](iteration-6-use-test-driven-development-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="9c486-229">**Figure 02**: Success!([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image4.png))</span></span>

## <a name="creating-contact-groups"></a><span data-ttu-id="9c486-230">Создание контактных групп</span><span class="sxs-lookup"><span data-stu-id="9c486-230">Creating Contact Groups</span></span>

<span data-ttu-id="9c486-231">Теперь мы можем перейти ко второй истории пользователя.</span><span class="sxs-lookup"><span data-stu-id="9c486-231">Now we can move on to the second user story.</span></span> <span data-ttu-id="9c486-232">Мы должны быть в состоянии создать новые контактные группы.</span><span class="sxs-lookup"><span data-stu-id="9c486-232">We need to be able to create new contact groups.</span></span> <span data-ttu-id="9c486-233">Мы должны выразить это намерение с помощью теста.</span><span class="sxs-lookup"><span data-stu-id="9c486-233">We need to express this intention with a test.</span></span>

<span data-ttu-id="9c486-234">Тест в листинге 4 проверяет, что вызов метода Create() с новой группой добавляет Группу в список групп, возвращенных методом Index() .</span><span class="sxs-lookup"><span data-stu-id="9c486-234">The test in Listing 4 verifies that calling the Create() method with a new Group adds the Group to the list of Groups returned by the Index() method.</span></span> <span data-ttu-id="9c486-235">Другими словами, если я создаю новую группу, то я смогу получить новую группу обратно из списка групп, возвращенных методом Индекса () .</span><span class="sxs-lookup"><span data-stu-id="9c486-235">In other words, if I create a new group then I should be able to get the new Group back from the list of Groups returned by the Index() method.</span></span>

<span data-ttu-id="9c486-236">**Список 4 - Контролеры**</span><span class="sxs-lookup"><span data-stu-id="9c486-236">**Listing 4 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample4.cs)]

<span data-ttu-id="9c486-237">Тест в листинге 4 вызывает метод создания контроллера группы с новой контактной группой.</span><span class="sxs-lookup"><span data-stu-id="9c486-237">The test in Listing 4 calls the Group controller Create() method with a new contact Group.</span></span> <span data-ttu-id="9c486-238">Далее тест проверяет, что вызов метода контроллера группы () возвращает новую группу в виде данных.</span><span class="sxs-lookup"><span data-stu-id="9c486-238">Next, the test verifies that calling the Group controller Index() method returns the new Group in view data.</span></span>

<span data-ttu-id="9c486-239">Модифицированный контроллер группы в листинге 5 содержит минимум изменений, необходимых для прохождения нового теста.</span><span class="sxs-lookup"><span data-stu-id="9c486-239">The modified Group controller in Listing 5 contains the bare minimum of changes required to pass the new test.</span></span>

<span data-ttu-id="9c486-240">**Список 5 - Контролеры группыКонтрол.cs**</span><span class="sxs-lookup"><span data-stu-id="9c486-240">**Listing 5 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample5.cs)]

## <a name="the-group-controller-in-listing-5-has-a-new-create-action-this-action-adds-a-group-to-a-collection-of-groups-notice-that-the-index-action-has-been-modified-to-return-the-contents-of-the-collection-of-groups"></a><span data-ttu-id="9c486-241">Контроллер группы в листинге 5 имеет новое действие Create().</span><span class="sxs-lookup"><span data-stu-id="9c486-241">The Group controller in Listing 5 has a new Create() action.</span></span> <span data-ttu-id="9c486-242">Это действие добавляет группу в коллекцию групп.</span><span class="sxs-lookup"><span data-stu-id="9c486-242">This action adds a Group to a collection of Groups.</span></span> <span data-ttu-id="9c486-243">Обратите внимание, что действие Index () было изменено, чтобы вернуть содержимое коллекции групп.</span><span class="sxs-lookup"><span data-stu-id="9c486-243">Notice that the Index() action has been modified to return the contents of the collection of Groups.</span></span>

<span data-ttu-id="9c486-244">Еще раз, мы выполнили минимальный объем работы, необходимой для прохождения модульного теста.</span><span class="sxs-lookup"><span data-stu-id="9c486-244">Once again, we have performed the bare minimum amount of work required to pass the unit test.</span></span> <span data-ttu-id="9c486-245">После внесения этих изменений в контроллер Группы все наши модульные тесты проходят.</span><span class="sxs-lookup"><span data-stu-id="9c486-245">After we make these changes to the Group controller, all of our unit tests pass.</span></span>

## <a name="adding-validation"></a><span data-ttu-id="9c486-246">Добавление проверки</span><span class="sxs-lookup"><span data-stu-id="9c486-246">Adding Validation</span></span>

<span data-ttu-id="9c486-247">Это требование не было четко указано в истории пользователя.</span><span class="sxs-lookup"><span data-stu-id="9c486-247">This requirement was not stated explicitly in the user story.</span></span> <span data-ttu-id="9c486-248">Тем не менее, разумно требовать, чтобы Группа имеет имя.</span><span class="sxs-lookup"><span data-stu-id="9c486-248">However, it is reasonable to require that a Group have a name.</span></span> <span data-ttu-id="9c486-249">В противном случае организация контактов в группы была бы не очень полезной.</span><span class="sxs-lookup"><span data-stu-id="9c486-249">Otherwise, organizing contacts into Groups would not be very useful.</span></span>

<span data-ttu-id="9c486-250">Список 6 содержит новый тест, который выражает это намерение.</span><span class="sxs-lookup"><span data-stu-id="9c486-250">Listing 6 contains a new test that expresses this intention.</span></span> <span data-ttu-id="9c486-251">Этот тест проверяет, что попытка создания группы без предоставления имени приводит к сообщению об ошибке проверки в состоянии модели.</span><span class="sxs-lookup"><span data-stu-id="9c486-251">This test verifies that attempting to create a Group without supplying a name results in a validation error message in model state.</span></span>

<span data-ttu-id="9c486-252">**Список 6 - Контролеры**</span><span class="sxs-lookup"><span data-stu-id="9c486-252">**Listing 6 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample6.cs)]

<span data-ttu-id="9c486-253">Для того, чтобы выполнить этот тест, нам необходимо добавить свойство Name в наш класс группы (см. листинг 7).</span><span class="sxs-lookup"><span data-stu-id="9c486-253">In order to satisfy this test, we need to add a Name property to our Group class (see Listing 7).</span></span> <span data-ttu-id="9c486-254">Кроме того, нам нужно добавить немного логики проверки в наше действие контроллера группы Create() (см. список 8).</span><span class="sxs-lookup"><span data-stu-id="9c486-254">Furthermore, we need to add a tiny bit of validation logic to our Group controller s Create() action (see Listing 8).</span></span>

<span data-ttu-id="9c486-255">**Листинг 7 - Модели-Group.cs**</span><span class="sxs-lookup"><span data-stu-id="9c486-255">**Listing 7 - Models\Group.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample7.cs)]

<span data-ttu-id="9c486-256">**Список 8 - Контролеры группыКонтрол.cs**</span><span class="sxs-lookup"><span data-stu-id="9c486-256">**Listing 8 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample8.cs)]

<span data-ttu-id="9c486-257">Обратите внимание, что действие контроллера группы Create() теперь содержит как валидацию, так и логику базы данных.</span><span class="sxs-lookup"><span data-stu-id="9c486-257">Notice that the Group controller Create() action now contains both validation and database logic.</span></span> <span data-ttu-id="9c486-258">В настоящее время база данных, используемая контроллером Группы, состоит не более чем из коллекции в памяти.</span><span class="sxs-lookup"><span data-stu-id="9c486-258">Currently, the database used by the Group controller consists of nothing more than an in-memory collection.</span></span>

## <a name="time-to-refactor"></a><span data-ttu-id="9c486-259">Время рефакторинга</span><span class="sxs-lookup"><span data-stu-id="9c486-259">Time to Refactor</span></span>

<span data-ttu-id="9c486-260">Третьим шагом в Red/Green/Refactor является рефакторная часть.</span><span class="sxs-lookup"><span data-stu-id="9c486-260">The third step in Red/Green/Refactor is the Refactor part.</span></span> <span data-ttu-id="9c486-261">На этом этапе мы должны отойти от нашего кода и подумать о том, как мы можем рефакторинг нашего приложения, чтобы улучшить его дизайн.</span><span class="sxs-lookup"><span data-stu-id="9c486-261">At this point, we need to step back from our code and consider how we can refactor our application to improve its design.</span></span> <span data-ttu-id="9c486-262">Этап Refactor – это этап, на котором мы тщательно думаем о наилучшем способе реализации принципов и шаблонов разработки программного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="9c486-262">The Refactor stage is the stage at which we think hard about the best way of implementing software design principles and patterns.</span></span>

<span data-ttu-id="9c486-263">Мы можем изменить наш код любым способом, который мы выбираем для улучшения дизайна кода.</span><span class="sxs-lookup"><span data-stu-id="9c486-263">We are free to modify our code in any way that we choose to improve the design of the code.</span></span> <span data-ttu-id="9c486-264">У нас есть сеть безопасности модульных тестов, которые мешают нам нарушать существующую функциональность.</span><span class="sxs-lookup"><span data-stu-id="9c486-264">We have a safety net of unit tests that prevent us from breaking existing functionality.</span></span>

<span data-ttu-id="9c486-265">Прямо сейчас, наш контроллер группы беспорядок с точки зрения хорошего дизайна программного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="9c486-265">Right now, our Group controller is a mess from the perspective of good software design.</span></span> <span data-ttu-id="9c486-266">Контроллер группы содержит запутанный беспорядок проверки и кода доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="9c486-266">The Group controller contains a tangled mess of validation and data access code.</span></span> <span data-ttu-id="9c486-267">Чтобы не нарушать принцип единой ответственности, мы должны разделить эти проблемы на разные классы.</span><span class="sxs-lookup"><span data-stu-id="9c486-267">To avoid violating the Single Responsibility Principle, we need to separate these concerns into different classes.</span></span>

<span data-ttu-id="9c486-268">Наш рефакторинговый класс контроллера группы содержится в листинге 9.</span><span class="sxs-lookup"><span data-stu-id="9c486-268">Our refactored Group controller class is contained in Listing 9.</span></span> <span data-ttu-id="9c486-269">Контроллер был изменен, чтобы использовать уровень обслуживания ContactManager.</span><span class="sxs-lookup"><span data-stu-id="9c486-269">The controller has been modified to use the ContactManager service layer.</span></span> <span data-ttu-id="9c486-270">Это тот же уровень обслуживания, который мы используем с контроллером Контакта.</span><span class="sxs-lookup"><span data-stu-id="9c486-270">This is the same service layer that we use with the Contact controller.</span></span>

<span data-ttu-id="9c486-271">Список 10 содержит новые методы, добавленные в уровень службы ContactManager для поддержки проверки, листинга и создания групп.</span><span class="sxs-lookup"><span data-stu-id="9c486-271">Listing 10 contains the new methods added to the ContactManager service layer to support validating, listing, and creating groups.</span></span> <span data-ttu-id="9c486-272">Интерфейс IContactManagerService был обновлен, чтобы включить новые методы.</span><span class="sxs-lookup"><span data-stu-id="9c486-272">The IContactManagerService interface was updated to include the new methods.</span></span>

<span data-ttu-id="9c486-273">Список 11 содержит новый класс FakeContactManagerRepository, который реализует интерфейс IContactManagerRepository.</span><span class="sxs-lookup"><span data-stu-id="9c486-273">Listing 11 contains a new FakeContactManagerRepository class that implements the IContactManagerRepository interface.</span></span> <span data-ttu-id="9c486-274">В отличие от класса EntityContactManagerRepository, который также реализует интерфейс IContactManagerRepository, наш новый класс FakeContactManagerRepository не общается с базой данных.</span><span class="sxs-lookup"><span data-stu-id="9c486-274">Unlike the EntityContactManagerRepository class that also implements the IContactManagerRepository interface, our new FakeContactManagerRepository class does not communicate with the database.</span></span> <span data-ttu-id="9c486-275">Класс FakeContactManagerRepository использует коллекцию в памяти в качестве прокси для базы данных.</span><span class="sxs-lookup"><span data-stu-id="9c486-275">The FakeContactManagerRepository class uses an in-memory collection as a proxy for the database.</span></span> <span data-ttu-id="9c486-276">Мы будем использовать этот класс в наших модульных тестах в качестве поддельного слоя репозитория.</span><span class="sxs-lookup"><span data-stu-id="9c486-276">We'll use this class in our unit tests as a fake repository layer.</span></span>

<span data-ttu-id="9c486-277">**Список 9 - Контролеры группыКонтрол.cs**</span><span class="sxs-lookup"><span data-stu-id="9c486-277">**Listing 9 - Controllers\GroupController.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample9.cs)]

<span data-ttu-id="9c486-278">**Список 10 - Контролеры/ContactManagerService.cs**</span><span class="sxs-lookup"><span data-stu-id="9c486-278">**Listing 10 - Controllers\ContactManagerService.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample10.cs)]

<span data-ttu-id="9c486-279">**Список 11 - Контроллеры-FakeContactManagerRepository.cs**</span><span class="sxs-lookup"><span data-stu-id="9c486-279">**Listing 11 - Controllers\FakeContactManagerRepository.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample11.cs)]

<span data-ttu-id="9c486-280">Изменение интерфейса IContactManagerRepository требует использования для реализации методов CreateGroup() и ListGroups() в классе EntityContactManagerRepository.</span><span class="sxs-lookup"><span data-stu-id="9c486-280">Modifying the IContactManagerRepository interface requires use to implement the CreateGroup() and ListGroups() methods in the EntityContactManagerRepository class.</span></span> <span data-ttu-id="9c486-281">Самый ленивый и быстрый способ сделать это, чтобы добавить заглушки методы, которые выглядят следующим образом:</span><span class="sxs-lookup"><span data-stu-id="9c486-281">The laziest and fastest way to do this is to add stub methods that look like this:</span></span>   

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample12.cs)]

<span data-ttu-id="9c486-282">Наконец, эти изменения в дизайне нашего приложения требуют от нас внесения некоторых изменений в наши модульные тесты.</span><span class="sxs-lookup"><span data-stu-id="9c486-282">Finally, these changes to the design of our application require us to make some modifications to our unit tests.</span></span> <span data-ttu-id="9c486-283">Теперь нам нужно использовать FakeContactManagerRepository при выполнении модульных тестов.</span><span class="sxs-lookup"><span data-stu-id="9c486-283">We now need to use the FakeContactManagerRepository when performing the unit tests.</span></span> <span data-ttu-id="9c486-284">Обновленный класс GroupControllerTest содержится в списке 12.</span><span class="sxs-lookup"><span data-stu-id="9c486-284">The updated GroupControllerTest class is contained in Listing 12.</span></span>

<span data-ttu-id="9c486-285">**Список 12 - Контролеры**</span><span class="sxs-lookup"><span data-stu-id="9c486-285">**Listing 12 - Controllers\GroupControllerTest.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample13.cs)]

<span data-ttu-id="9c486-286">После того, как мы сделаем все эти изменения, еще раз, все наши модульные тесты проходят.</span><span class="sxs-lookup"><span data-stu-id="9c486-286">After we make all of these changes, once again, all of our unit tests pass.</span></span> <span data-ttu-id="9c486-287">Мы завершили весь цикл Red/Green/Refactor.</span><span class="sxs-lookup"><span data-stu-id="9c486-287">We have completed the entire cycle of Red/Green/Refactor.</span></span> <span data-ttu-id="9c486-288">Мы реализовали первые две истории пользователей.</span><span class="sxs-lookup"><span data-stu-id="9c486-288">We have implemented the first two user stories.</span></span> <span data-ttu-id="9c486-289">Теперь у нас есть вспомогательные модульные тесты для требований, выраженных в пользовательских историях.</span><span class="sxs-lookup"><span data-stu-id="9c486-289">We now have supporting unit tests for the requirements expressed in the user stories.</span></span> <span data-ttu-id="9c486-290">Реализация оставшейся части пользовательских историй включает повторение одного и того же цикла Red/Green/Refactor.</span><span class="sxs-lookup"><span data-stu-id="9c486-290">Implementing the remainder of the user stories involves repeating the same cycle of Red/Green/Refactor.</span></span>

## <a name="modifying-our-database"></a><span data-ttu-id="9c486-291">Изменение нашей базы данных</span><span class="sxs-lookup"><span data-stu-id="9c486-291">Modifying our Database</span></span>

<span data-ttu-id="9c486-292">К сожалению, несмотря на то, что мы выполнили все требования, выраженные нашими модульными испытаниями, наша работа не завершена.</span><span class="sxs-lookup"><span data-stu-id="9c486-292">Unfortunately, even though we have satisfied all of the requirements expressed by our unit tests, our work is not done.</span></span> <span data-ttu-id="9c486-293">Нам все еще нужно изменить нашу базу данных.</span><span class="sxs-lookup"><span data-stu-id="9c486-293">We still need to modify our database.</span></span>

<span data-ttu-id="9c486-294">Нам необходимо создать новую таблицу баз данных Группы.</span><span class="sxs-lookup"><span data-stu-id="9c486-294">We need to create a new Group database table.</span></span> <span data-ttu-id="9c486-295">Выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="9c486-295">Follow these steps:</span></span>

1. <span data-ttu-id="9c486-296">В окне Server Explorer щелкните по папке Таблицы и выберите вариант меню **Добавить новую таблицу.**</span><span class="sxs-lookup"><span data-stu-id="9c486-296">In the Server Explorer window, right-click the Tables folder and select the menu option **Add New Table**.</span></span>
2. <span data-ttu-id="9c486-297">Введите две колонки, описанные ниже в таблице Designer.</span><span class="sxs-lookup"><span data-stu-id="9c486-297">Enter the two columns described below in the Table Designer.</span></span>
3. <span data-ttu-id="9c486-298">Отметьте столбец Id в качестве основного ключа и столбца identity.</span><span class="sxs-lookup"><span data-stu-id="9c486-298">Mark the Id column as a primary key and Identity column.</span></span>
4. <span data-ttu-id="9c486-299">Сохраните новую таблицу с именем Группы, нажав значок дискеты.</span><span class="sxs-lookup"><span data-stu-id="9c486-299">Save the new table with the name Groups by clicking the icon of the floppy.</span></span>

<a id="0.11_table01"></a>

| <span data-ttu-id="9c486-300">**Имя столбца**</span><span class="sxs-lookup"><span data-stu-id="9c486-300">**Column Name**</span></span> | <span data-ttu-id="9c486-301">**Тип данных**</span><span class="sxs-lookup"><span data-stu-id="9c486-301">**Data Type**</span></span> | <span data-ttu-id="9c486-302">**Разрешить значения NULL**</span><span class="sxs-lookup"><span data-stu-id="9c486-302">**Allow Nulls**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="9c486-303">Идентификатор</span><span class="sxs-lookup"><span data-stu-id="9c486-303">Id</span></span> | <span data-ttu-id="9c486-304">INT</span><span class="sxs-lookup"><span data-stu-id="9c486-304">int</span></span> | <span data-ttu-id="9c486-305">False</span><span class="sxs-lookup"><span data-stu-id="9c486-305">False</span></span> |
| <span data-ttu-id="9c486-306">name</span><span class="sxs-lookup"><span data-stu-id="9c486-306">Name</span></span> | <span data-ttu-id="9c486-307">nvarchar(50)</span><span class="sxs-lookup"><span data-stu-id="9c486-307">nvarchar(50)</span></span> | <span data-ttu-id="9c486-308">False</span><span class="sxs-lookup"><span data-stu-id="9c486-308">False</span></span> |

<span data-ttu-id="9c486-309">Далее нам нужно удалить все данные из таблицы Контактов (в противном случае мы не сможем создать связь между таблицами Контактов и Групп).</span><span class="sxs-lookup"><span data-stu-id="9c486-309">Next, we need to delete all of the data from the Contacts table (otherwise, we won't be able to create a relationship between the Contacts and Groups tables).</span></span> <span data-ttu-id="9c486-310">Выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="9c486-310">Follow these steps:</span></span>

1. <span data-ttu-id="9c486-311">Нажмите правой кнопкой мыши таблицы Контакты и выберите вариант меню **Показать таблицы данных**.</span><span class="sxs-lookup"><span data-stu-id="9c486-311">Right-click the Contacts table and select the menu option **Show Table Data**.</span></span>
2. <span data-ttu-id="9c486-312">Удалите все строки.</span><span class="sxs-lookup"><span data-stu-id="9c486-312">Delete all of the rows.</span></span>

<span data-ttu-id="9c486-313">Далее нам необходимо определить взаимосвязь между таблицей базы данных групп и существующей таблицей базы данных Контактов.</span><span class="sxs-lookup"><span data-stu-id="9c486-313">Next, we need to define a relationship between the Groups database table and the existing Contacts database table.</span></span> <span data-ttu-id="9c486-314">Выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="9c486-314">Follow these steps:</span></span>

1. <span data-ttu-id="9c486-315">Дважды щелкните таблицу Контактов в окне Server Explorer, чтобы открыть конструктор таблицы.</span><span class="sxs-lookup"><span data-stu-id="9c486-315">Double-click the Contacts table in the Server Explorer window to open the Table Designer.</span></span>
2. <span data-ttu-id="9c486-316">Добавьте новую колонку integer в таблицу Контактов под названием GroupId.</span><span class="sxs-lookup"><span data-stu-id="9c486-316">Add a new integer column to the Contacts table named GroupId.</span></span>
3. <span data-ttu-id="9c486-317">Нажмите кнопку «Отношения», чтобы открыть диалог по ключевым отношениям с иностранными отношениями (см. рисунок 3).</span><span class="sxs-lookup"><span data-stu-id="9c486-317">Click the Relationship button to open the Foreign Key Relationships dialog (see Figure 3).</span></span>
4. <span data-ttu-id="9c486-318">Нажмите кнопку Добавить.</span><span class="sxs-lookup"><span data-stu-id="9c486-318">Click the Add button.</span></span>
5. <span data-ttu-id="9c486-319">Нажмите кнопку ellipsis, которая отображается рядом с кнопкой спецификации таблицы и столбцов.</span><span class="sxs-lookup"><span data-stu-id="9c486-319">Click the ellipsis button that appears next to the Table and Columns Specification button.</span></span>
6. <span data-ttu-id="9c486-320">В диалоге таблиц и столбцов выберите группы в качестве основной ключевой таблицы и Id в качестве основного ключевого столбца.</span><span class="sxs-lookup"><span data-stu-id="9c486-320">In the Tables and Columns dialog, select Groups as the primary key table and Id as the primary key column.</span></span> <span data-ttu-id="9c486-321">Выберите Контакты в качестве иностранной ключевой таблицы и GroupId в качестве иностранной ключевой колонки (см. рисунок 4).</span><span class="sxs-lookup"><span data-stu-id="9c486-321">Select Contacts as the foreign key table and GroupId as the foreign key column (see Figure 4).</span></span> <span data-ttu-id="9c486-322">Нажмите кнопку "ОК".</span><span class="sxs-lookup"><span data-stu-id="9c486-322">Click the OK button.</span></span>
7. <span data-ttu-id="9c486-323">В соответствии со **спецификацией INSERT и UPDATE**выберите значение **Каскад** для **Правила Удаления.**</span><span class="sxs-lookup"><span data-stu-id="9c486-323">Under **INSERT and UPDATE Specification**, select the value **Cascade** for **Delete Rule**.</span></span>
8. <span data-ttu-id="9c486-324">Нажмите кнопку "Закрыть", чтобы закрыть диалог по отношениям с иностранными ключевыми отношениями.</span><span class="sxs-lookup"><span data-stu-id="9c486-324">Click the Close button to close the Foreign Key Relationships dialog.</span></span>
9. <span data-ttu-id="9c486-325">Нажмите кнопку «Сохранить», чтобы сохранить изменения в таблице Контактов.</span><span class="sxs-lookup"><span data-stu-id="9c486-325">Click the Save button to save the changes to the Contacts table.</span></span>

<span data-ttu-id="9c486-326">[![Создание отношения таблицы базы данных](iteration-6-use-test-driven-development-cs/_static/image3.jpg)](iteration-6-use-test-driven-development-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="9c486-326">[![Creating a database table relationship](iteration-6-use-test-driven-development-cs/_static/image3.jpg)](iteration-6-use-test-driven-development-cs/_static/image5.png)</span></span>

<span data-ttu-id="9c486-327">**Рисунок 03**: Создание отношения таблицы базы данных ([Нажмите, чтобы просмотреть полноразмерное изображение](iteration-6-use-test-driven-development-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="9c486-327">**Figure 03**: Creating a database table relationship ([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image6.png))</span></span>

<span data-ttu-id="9c486-328">[![Определение отношений таблицы](iteration-6-use-test-driven-development-cs/_static/image4.jpg)](iteration-6-use-test-driven-development-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="9c486-328">[![Specifying table relationships](iteration-6-use-test-driven-development-cs/_static/image4.jpg)](iteration-6-use-test-driven-development-cs/_static/image7.png)</span></span>

<span data-ttu-id="9c486-329">**Рисунок 04**: Указание отношений таблицы[(Нажмите, чтобы просмотреть полноразмерное изображение)](iteration-6-use-test-driven-development-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="9c486-329">**Figure 04**: Specifying table relationships([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image8.png))</span></span>

### <a name="updating-our-data-model"></a><span data-ttu-id="9c486-330">Обновление нашей модели данных</span><span class="sxs-lookup"><span data-stu-id="9c486-330">Updating our Data Model</span></span>

<span data-ttu-id="9c486-331">Далее нам необходимо обновить нашу модель данных, чтобы представить новую таблицу баз данных.</span><span class="sxs-lookup"><span data-stu-id="9c486-331">Next, we need to update our data model to represent the new database table.</span></span> <span data-ttu-id="9c486-332">Выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="9c486-332">Follow these steps:</span></span>

1. <span data-ttu-id="9c486-333">Дважды щелкните файл ContactManagerModel.edmx в папке Модели, чтобы открыть Entity Designer.</span><span class="sxs-lookup"><span data-stu-id="9c486-333">Double-click the ContactManagerModel.edmx file in the Models folder to open the Entity Designer.</span></span>
2. <span data-ttu-id="9c486-334">Нажмите правой щелкните поверхность конструктора и выберите вариант меню **Модель обновления из базы данных.**</span><span class="sxs-lookup"><span data-stu-id="9c486-334">Right-click the Designer surface and select the menu option **Update Model from Database**.</span></span>
3. <span data-ttu-id="9c486-335">В «Мастере обновления» выберите таблицу групп и нажмите кнопку «Завершение» (см. рисунок 5).</span><span class="sxs-lookup"><span data-stu-id="9c486-335">In the Update Wizard, select the Groups table and click the Finish button (see Figure 5).</span></span>
4. <span data-ttu-id="9c486-336">Нажмите правой кнопкой мыши сущность группы и выберите вариант меню **Переименовать**.</span><span class="sxs-lookup"><span data-stu-id="9c486-336">Right-click the Groups entity and select the menu option **Rename**.</span></span> <span data-ttu-id="9c486-337">Измените название сущности *групп* ы на *группу* (единственное).</span><span class="sxs-lookup"><span data-stu-id="9c486-337">Change the name of the *Groups* entity to *Group* (singular).</span></span>
5. <span data-ttu-id="9c486-338">Нажмите справа на навигационное свойство групп, которое отображается в нижней части объекта Контакт.</span><span class="sxs-lookup"><span data-stu-id="9c486-338">Right-click the Groups navigation property that appears at the bottom of the Contact entity.</span></span> <span data-ttu-id="9c486-339">Измените название навигационного свойства *групп* на *группу* (единственное).</span><span class="sxs-lookup"><span data-stu-id="9c486-339">Change the name of the *Groups* navigation property to *Group* (singular).</span></span>

<span data-ttu-id="9c486-340">[![Обновление модели рамочной базы из базы данных](iteration-6-use-test-driven-development-cs/_static/image5.jpg)](iteration-6-use-test-driven-development-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="9c486-340">[![Updating an Entity Framework model from the database](iteration-6-use-test-driven-development-cs/_static/image5.jpg)](iteration-6-use-test-driven-development-cs/_static/image9.png)</span></span>

<span data-ttu-id="9c486-341">**Рисунок 05**: Обновление модели рамочной сущности из базы данных[(Нажмите, чтобы просмотреть полноразмерное изображение)](iteration-6-use-test-driven-development-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="9c486-341">**Figure 05**: Updating an Entity Framework model from the database([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image10.png))</span></span>

<span data-ttu-id="9c486-342">После завершения этих шагов модель данных будет представлять таблицы контактов и групп.</span><span class="sxs-lookup"><span data-stu-id="9c486-342">After you complete these steps, your data model will represent both the Contacts and Groups tables.</span></span> <span data-ttu-id="9c486-343">Дизайнер сущности должен показать оба объекта (см. рисунок 6).</span><span class="sxs-lookup"><span data-stu-id="9c486-343">The Entity Designer should show both entities (see Figure 6).</span></span>

<span data-ttu-id="9c486-344">[![Сущность Дизайнер отображения группы и контакта](iteration-6-use-test-driven-development-cs/_static/image6.jpg)](iteration-6-use-test-driven-development-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="9c486-344">[![Entity Designer displaying Group and Contact](iteration-6-use-test-driven-development-cs/_static/image6.jpg)](iteration-6-use-test-driven-development-cs/_static/image11.png)</span></span>

<span data-ttu-id="9c486-345">**Рисунок 06**: Сущность Дизайнер отображения группы и контакта[(Нажмите, чтобы посмотреть полноразмерное изображение](iteration-6-use-test-driven-development-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="9c486-345">**Figure 06**: Entity Designer displaying Group and Contact([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image12.png))</span></span>

### <a name="creating-our-repository-classes"></a><span data-ttu-id="9c486-346">Создание наших классов репозитория</span><span class="sxs-lookup"><span data-stu-id="9c486-346">Creating our Repository Classes</span></span>

<span data-ttu-id="9c486-347">Далее нам необходимо реализовать наш класс репозитория.</span><span class="sxs-lookup"><span data-stu-id="9c486-347">Next, we need to implement our repository class.</span></span> <span data-ttu-id="9c486-348">В течение этой итерации мы добавили несколько новых методов в интерфейс IContactManagerRepository при написании кода, чтобы удовлетворить наши модульные тесты.</span><span class="sxs-lookup"><span data-stu-id="9c486-348">Over the course of this iteration, we added several new methods to the IContactManagerRepository interface while writing code to satisfy our unit tests.</span></span> <span data-ttu-id="9c486-349">Окончательная версия интерфейса IContactManagerRepository содержится в листинге 14.</span><span class="sxs-lookup"><span data-stu-id="9c486-349">The final version of the IContactManagerRepository interface is contained in Listing 14.</span></span>

<span data-ttu-id="9c486-350">**Список 14 - Модели-IContactManagerRepository.cs**</span><span class="sxs-lookup"><span data-stu-id="9c486-350">**Listing 14 - Models\IContactManagerRepository.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample14.cs)]

<span data-ttu-id="9c486-351">На самом деле мы не реализовали ни одного из методов, связанных с работой с контактными группами.</span><span class="sxs-lookup"><span data-stu-id="9c486-351">We haven't actually implemented any of the methods related to working with contact groups.</span></span> <span data-ttu-id="9c486-352">В настоящее время класс EntityContactManagerRepository имеет методы заглушки для каждого из методов контактной группы, перечисленных в интерфейсе IContactManagerRepository.</span><span class="sxs-lookup"><span data-stu-id="9c486-352">Currently, the EntityContactManagerRepository class has stub methods for each of the contact group methods listed in the IContactManagerRepository interface.</span></span> <span data-ttu-id="9c486-353">Например, метод ListGroups() в настоящее время выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="9c486-353">For example, the ListGroups() method currently looks like this:</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample15.cs)]

<span data-ttu-id="9c486-354">Методы заглушки позволили нам компилировать наше приложение и пройти модульные тесты.</span><span class="sxs-lookup"><span data-stu-id="9c486-354">The stub methods enabled us to compile our application and pass the unit tests.</span></span> <span data-ttu-id="9c486-355">Однако сейчас настало время реально реализовать эти методы.</span><span class="sxs-lookup"><span data-stu-id="9c486-355">However, now it is time to actually implement these methods.</span></span> <span data-ttu-id="9c486-356">Окончательная версия класса EntityContactManagerRepository содержится в листинге 13.</span><span class="sxs-lookup"><span data-stu-id="9c486-356">The final version of the EntityContactManagerRepository class is contained in Listing 13.</span></span>

<span data-ttu-id="9c486-357">**Листинг 13 - Модели-EntityContactManagerRepository.cs**</span><span class="sxs-lookup"><span data-stu-id="9c486-357">**Listing 13 - Models\EntityContactManagerRepository.cs**</span></span>

[!code-csharp[Main](iteration-6-use-test-driven-development-cs/samples/sample16.cs)]

### <a name="creating-the-views"></a><span data-ttu-id="9c486-358">Создание представлений</span><span class="sxs-lookup"><span data-stu-id="9c486-358">Creating the Views</span></span>

<span data-ttu-id="9c486-359">ASP.NET приложение MVC при использовании движка представления ASP.NET по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="9c486-359">ASP.NET MVC application when you use the default ASP.NET view engine.</span></span> <span data-ttu-id="9c486-360">Таким образом, вы не создаете представления в ответ на определенный модульный тест.</span><span class="sxs-lookup"><span data-stu-id="9c486-360">So, you don t create views in response to a particular unit test.</span></span> <span data-ttu-id="9c486-361">Однако, поскольку приложение было бы бесполезным без представлений, мы не можем завершить эту итерацию без создания и изменения представлений, содержащихся в приложении Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="9c486-361">However, because an application would be useless without views, we can t complete this iteration without creating and modifying the views contained in the Contact Manager application.</span></span>

<span data-ttu-id="9c486-362">Нам необходимо создать следующие новые представления для управления контакт-группами (см. рисунок 7):</span><span class="sxs-lookup"><span data-stu-id="9c486-362">We need to create the following new views for managing contact groups (see Figure 7):</span></span>

- <span data-ttu-id="9c486-363">Views'Group-Index.aspx - Отображает список контактных групп</span><span class="sxs-lookup"><span data-stu-id="9c486-363">Views\Group\Index.aspx - Displays list of contact groups</span></span>
- <span data-ttu-id="9c486-364">Views-Group-Delete.aspx - Отображает форму подтверждения для удаления контактной группы</span><span class="sxs-lookup"><span data-stu-id="9c486-364">Views\Group\Delete.aspx - Displays confirmation form for deleting a contact group</span></span>

<span data-ttu-id="9c486-365">[![Представление индекса группы](iteration-6-use-test-driven-development-cs/_static/image7.jpg)](iteration-6-use-test-driven-development-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="9c486-365">[![The Group Index view](iteration-6-use-test-driven-development-cs/_static/image7.jpg)](iteration-6-use-test-driven-development-cs/_static/image13.png)</span></span>

<span data-ttu-id="9c486-366">**Рисунок 07**: Представление индекса группы[(Нажмите, чтобы посмотреть полноразмерное изображение)](iteration-6-use-test-driven-development-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="9c486-366">**Figure 07**: The Group Index view([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image14.png))</span></span>

<span data-ttu-id="9c486-367">Нам необходимо изменить следующие существующие представления, чтобы они включали контактные группы:</span><span class="sxs-lookup"><span data-stu-id="9c486-367">We need to modify the following existing views so that they include contact groups:</span></span>

- <span data-ttu-id="9c486-368">Просмотры:Home'Create.aspx</span><span class="sxs-lookup"><span data-stu-id="9c486-368">Views\Home\Create.aspx</span></span>
- <span data-ttu-id="9c486-369">Просмотры-Home-Edit.aspx</span><span class="sxs-lookup"><span data-stu-id="9c486-369">Views\Home\Edit.aspx</span></span>
- <span data-ttu-id="9c486-370">Просмотры»Home-Index.aspx</span><span class="sxs-lookup"><span data-stu-id="9c486-370">Views\Home\Index.aspx</span></span>

<span data-ttu-id="9c486-371">Вы можете увидеть измененные представления, посмотрев приложение Visual Studio, которое сопровождает этот учебник.</span><span class="sxs-lookup"><span data-stu-id="9c486-371">You can see the modified views by looking at the Visual Studio application that accompanies this tutorial.</span></span> <span data-ttu-id="9c486-372">Например, на рисунке 8 показано представление индекса контакта.</span><span class="sxs-lookup"><span data-stu-id="9c486-372">For example, Figure 8 illustrates the Contact Index view.</span></span>

<span data-ttu-id="9c486-373">[![Представление индекса контакта](iteration-6-use-test-driven-development-cs/_static/image8.jpg)](iteration-6-use-test-driven-development-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="9c486-373">[![The Contact Index view](iteration-6-use-test-driven-development-cs/_static/image8.jpg)](iteration-6-use-test-driven-development-cs/_static/image15.png)</span></span>

<span data-ttu-id="9c486-374">**Рисунок 08**: Представление контактного индекса[(Нажмите, чтобы посмотреть полноразмерное изображение)](iteration-6-use-test-driven-development-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="9c486-374">**Figure 08**: The Contact Index view([Click to view full-size image](iteration-6-use-test-driven-development-cs/_static/image16.png))</span></span>

## <a name="summary"></a><span data-ttu-id="9c486-375">Сводка</span><span class="sxs-lookup"><span data-stu-id="9c486-375">Summary</span></span>

<span data-ttu-id="9c486-376">В этой итерации мы добавили новую функциональность в наше приложение Contact Manager, следуя методологии проектирования приложений, разработанной на основе тестов.</span><span class="sxs-lookup"><span data-stu-id="9c486-376">In this iteration, we added new functionality to our Contact Manager application by following a test-driven development application design methodology.</span></span> <span data-ttu-id="9c486-377">Мы начали с создания набора пользовательских историй.</span><span class="sxs-lookup"><span data-stu-id="9c486-377">We started by creating a set of user stories.</span></span> <span data-ttu-id="9c486-378">Мы создали набор модульных тестов, соответствующих требованиям, выраженным историями пользователей.</span><span class="sxs-lookup"><span data-stu-id="9c486-378">We created a set of unit tests that corresponds to the requirements expressed by the user stories.</span></span> <span data-ttu-id="9c486-379">Наконец, мы написали достаточно кода, чтобы удовлетворить требования, выраженные модульными тестами.</span><span class="sxs-lookup"><span data-stu-id="9c486-379">Finally, we wrote just enough code to satisfy the requirements expressed by the unit tests.</span></span>

<span data-ttu-id="9c486-380">После того, как мы закончили писать достаточно кода, чтобы удовлетворить требования, выраженные модульными тестами, мы обновили нашу базу данных и представления.</span><span class="sxs-lookup"><span data-stu-id="9c486-380">After we finished writing enough code to satisfy the requirements expressed by the unit tests, we updated our database and views.</span></span> <span data-ttu-id="9c486-381">Мы добавили новую таблицу групп в нашу базу данных и обновили нашу модель рамочных данных entity.</span><span class="sxs-lookup"><span data-stu-id="9c486-381">We added a new Groups table to our database and updated our Entity Framework Data Model.</span></span> <span data-ttu-id="9c486-382">Мы также создали и изменили набор представлений.</span><span class="sxs-lookup"><span data-stu-id="9c486-382">We also created and modified a set of views.</span></span>

<span data-ttu-id="9c486-383">В следующей итерации - окончательной итерации - мы переписываем наше приложение, чтобы воспользоваться преимуществами Ajax.</span><span class="sxs-lookup"><span data-stu-id="9c486-383">In the next iteration -- the final iteration -- we rewrite our application to take advantage of Ajax.</span></span> <span data-ttu-id="9c486-384">Воспользовавшись преимуществами Ajax, мы улучшим отзывчивость и производительность приложения Contact Manager.</span><span class="sxs-lookup"><span data-stu-id="9c486-384">By taking advantage of Ajax, we'll improve the responsiveness and performance of the Contact Manager application.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="9c486-385">[Назад](iteration-5-create-unit-tests-cs.md)
> [Вперед](iteration-7-add-ajax-functionality-cs.md)</span><span class="sxs-lookup"><span data-stu-id="9c486-385">[Previous](iteration-5-create-unit-tests-cs.md)
[Next](iteration-7-add-ajax-functionality-cs.md)</span></span>
