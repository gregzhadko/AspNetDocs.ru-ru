---
uid: mvc/overview/older-versions-1/contact-manager/iteration-2-make-the-application-look-nice-vb
title: 'Итерация #2 — Создание вида неплохо (VB) приложения | Документация Майкрософт'
author: microsoft
description: В этой итерации мы улучшить внешний вид приложения, изменив значение по умолчанию master страница представления ASP.NET MVC и каскадные таблицы стилей.
ms.author: riande
ms.date: 02/20/2009
ms.assetid: f65cb436-e493-46fd-9608-384b27385aa1
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-2-make-the-application-look-nice-vb
msc.type: authoredcontent
ms.openlocfilehash: 9cda4153c4e4883586a83ac7f89b2f369f8157e5
ms.sourcegitcommit: 289e051cc8a90e8f7127e239fda73047bde4de12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2019
ms.locfileid: "58422271"
---
<a name="iteration-2--make-the-application-look-nice-vb"></a>Итерация #2 — Создание вида неплохо (VB) приложения
====================
по [Microsoft](https://github.com/microsoft)

[Скачать код](iteration-2-make-the-application-look-nice-vb/_static/contactmanager_2_vb1.zip)

> В этой итерации мы улучшить внешний вид приложения, изменив значение по умолчанию master страница представления ASP.NET MVC и каскадные таблицы стилей.


## <a name="building-a-contact-management-aspnet-mvc-application-vb"></a>Создание приложения управления контактами ASP.NET MVC (VB)
  

В этой серии руководств мы создаем всего приложения управления контактами от начала до конца. Приложение диспетчера контактов позволяет хранить контактные данные — имена, телефонных номеров и адресов электронной почты — список людей.

Мы создаем приложение через несколько итераций. С каждой итерацией мы постепенно улучшить приложение. Этот подход с несколькими итерации предназначена для того, чтобы можно было понять причину для каждого изменения.

- Итерация #1 – Создание приложения. В первой итерации мы создадим Contact Manager простейшим способом невозможно. Мы добавили поддержку для основных операций базы данных: Создание, чтение, обновление и удаление (CRUD).

- #2 — итерация приложения красиво выглядеть. В этой итерации мы улучшить внешний вид приложения, изменив значение по умолчанию master страница представления ASP.NET MVC и каскадные таблицы стилей.

- Итерация #3 – Добавление проверки форм. В третьей итерации мы добавим проверки базовой форме. Мы запретить Отправка формы без завершения обязательные поля. Кроме того, мы проверяем, адреса электронной почты и номера телефонов.

- Итерация #4 – Создание слабых связей в приложении. В этой четвертой итерации мы воспользоваться преимуществами нескольких шаблонов дизайна программного обеспечения, чтобы упростить обслуживании и изменении приложения диспетчера контактов. Например мы выполнили рефакторинг наше приложение, чтобы использовать шаблон репозитория и шаблон внедрения зависимостей.

- Итерация #5 – Создание модульных тестов. В пятой итерации мы вам наше приложение проще обслуживании и изменении путем добавления модульных тестов. Мы макетирование наших классов модели данных и создания модульных тестов для контроллеров и логику проверки.

- Итерация #6 – использование управляемой тестами разработки. В этой шестой итерации мы добавляем новые функциональные возможности в наше приложение, сначала написание модульных тестов и написании кода в отношении модульные тесты. В этой итерации мы добавляем групп контактов.

- Итерация #7 – Добавление функций Ajax. В седьмой итерации мы повысить скорость реагирования и производительность приложения, добавляя поддержку Ajax.

## <a name="this-iteration"></a>Эта итерация

Цель этой итерации — улучшить внешний вид приложения диспетчера контактов. В настоящее время Contact Manager использует по умолчанию ASP.NET MVC представления главной страницы и таблицы каскадных стилей (см. рис. 1). Эти Дон t выглядеть неправильный, но нигде t want Contact Manager для поиска так же, как каждый другой ASP.NET MVC веб-сайт. Я хочу заменить эти файлы пользовательских файлов.


[![В диалоговом окне нового проекта](iteration-2-make-the-application-look-nice-vb/_static/image1.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image1.png)

**Рис 01**: По умолчанию внешний вид приложения ASP.NET MVC ([Просмотр полноразмерного изображения](iteration-2-make-the-application-look-nice-vb/_static/image2.png))


В этой итерации обсуждаются два подхода к улучшает Графический дизайн нашего приложения. Во-первых мне Показать, как использовать преимущества ASP.NET MVC макетов для загрузки бесплатной шаблона проектирования ASP.NET MVC. ASP.NET MVC макетов позволяет создавать профессиональные веб-приложения без выполнения действий.

Я решил не использовать шаблон из коллекции проектов MVC для ASP.NET для приложения диспетчера контактов. Вместо этого мне нужно было пользовательским дизайном, созданные фирма профессионального дизайна. Во второй части этого учебника я объясню, как я работал с компанией профессионального дизайна для создания в окончательном проекте ASP.NET MVC.

## <a name="the-aspnet-mvc-design-gallery"></a>ASP.NET MVC макетов

Макетов ASP.NET MVC — это бесплатный ресурс, предоставляемые корпорацией Майкрософт. MVC ASP.NET она расположена по следующему адресу:

[https://www.asp.net/mvc/gallery](https://www.asp.net/mvc/gallery)

ASP.NET MVC макетов размещает коллекцию схем бесплатный веб-сайт, которые были созданы специально для использования в проекте ASP.NET MVC. Макеты, передаются по членами сообщества. Посетителям коллекции смогут проголосовать за свои избранные модели (см. рис. 2).


[![В диалоговом окне нового проекта](iteration-2-make-the-application-look-nice-vb/_static/image2.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image3.png)

**Рис. 02**: ASP.NET MVC макетов ([Просмотр полноразмерного изображения](iteration-2-make-the-application-look-nice-vb/_static/image4.png))


Пока я пишу этот учебник, наиболее популярных разработки в коллекции — это Дизайн, с именем октября, Дэвид Hauser. Такой подход можно использовать для проекта ASP.NET MVC, выполнив следующие действия:

1. Нажмите кнопку **загрузить** кнопку, чтобы загрузить файл October.zip на компьютер.
2. Щелкните правой кнопкой мыши загруженный файл October.zip и нажмите кнопку **Unblock** кнопку (см. рис. 3).
3. Распакуйте файл в папку с именем октября.
4. Выберите все файлы в папке DesignTemplate, содержащиеся в папке октября, правой кнопкой мыши и выберите пункт меню **копирования**.
5. Щелкните правой кнопкой мыши узел проекта ContactManager в окне обозревателя решений Visual Studio и выберите пункт меню **вставить** (см. рис. 4).
6. Выберите пункт меню в Visual Studio **Правка, найти и заменить, Быстрая замена** и замените *[MyProjectName]* с *ContactManager* (см. рис. 5).


[![В диалоговом окне нового проекта](iteration-2-make-the-application-look-nice-vb/_static/image3.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image5.png)

**Рис 03**: Разблокировка файла загруженных из Интернета ([Просмотр полноразмерного изображения](iteration-2-make-the-application-look-nice-vb/_static/image6.png))


[![В диалоговом окне нового проекта](iteration-2-make-the-application-look-nice-vb/_static/image4.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image7.png)

**Рис. 04**: Перезапись файлов в обозревателе решений ([Просмотр полноразмерного изображения](iteration-2-make-the-application-look-nice-vb/_static/image8.png))


[![В диалоговом окне нового проекта](iteration-2-make-the-application-look-nice-vb/_static/image5.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image9.png)

**05 рис**: Заменив ContactManager [имя_проекта] ([Просмотр полноразмерного изображения](iteration-2-make-the-application-look-nice-vb/_static/image10.png))


После выполнения этих действий веб-приложение будет использовать новый дизайн. Страница, на рис. 6 показан внешний вид приложения диспетчера контактов и дизайна октября.


[![В диалоговом окне нового проекта](iteration-2-make-the-application-look-nice-vb/_static/image6.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image11.png)

**Рис 06**: ContactManager с шаблоном октября ([Просмотр полноразмерного изображения](iteration-2-make-the-application-look-nice-vb/_static/image12.png))


## <a name="creating-a-custom-aspnet-mvc-design"></a>Создание проекта пользовательского ASP.NET MVC

ASP.NET MVC макетов имеет хорошего выбора разных структур стили. Коллекции вы найдете безболезненным способ настройки внешнего вида ваших приложений ASP.NET MVC. И, конечно, в коллекции есть существенное преимущество бесплатности полностью.

Тем не менее может потребоваться создать полностью уникального дизайна для веб-сайта. В этом случае имеет смысл работать с веб-сайта компании по проектированию. Я решил применить такой подход по проектированию для приложения диспетчера контактов.

Я ZIP-архив копии диспетчера контактов из итерации 1 и отправляемые компании по проектированию проекта. Они не было Visual Studio (корпорации на них!), но которая не является проблемой. Они смогут бесплатно скачайте Microsoft Visual Web Developer из [ https://www.asp.net ](https://www.asp.net) веб-сайта и откройте приложение диспетчера контактов в Visual Web Developer. За несколько дней они вернуло разработки на рис. 7.


[![В диалоговом окне нового проекта](iteration-2-make-the-application-look-nice-vb/_static/image7.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image13.png)

**07 рис**: Проект ASP.NET MVC Contact Manager ([Просмотр полноразмерного изображения](iteration-2-make-the-application-look-nice-vb/_static/image14.png))


Новый дизайн состоял из двух файлов: новый CSS-файла и новый файл главной страницы представления. Главная страница представления содержит макет и общего содержимого для представления приложения ASP.NET MVC. Например главной страницы представления включает в себя заголовок, вкладки навигации и нижний колонтитул, отображаются на рис. 7. Я переписал существующего представления страницей Site.Master в папке Views\Shared с новым файлом Site.Master из компании по проектированию

Компания разработки, также создается новый таблицы каскадных стилей и набор изображений. Поместить эти новые файлы в папке Content я переписал существующий файл Site.css. В папке содержимого необходимо поместить все статическое содержимое.

Обратите внимание на то, что новый дизайн для Contact Manager включает в себя образы для редактирования и удаления контактов. Изменение и удаление образа отображаются рядом с каждого контакта в HTML-таблицы контактов.

Изначально ссылкам, которые были отображены с HTML-код. Вспомогательный ActionLink() следующим образом:

[!code-aspx[Main](iteration-2-make-the-application-look-nice-vb/samples/sample1.aspx)]

Метод Html.ActionLink() не поддерживает образы (метод HTML кодирует текст ссылки, по соображениям безопасности). Поэтому я заменены вызовы Html.ActionLink() вызовы Url.Action() следующим образом:

[!code-aspx[Main](iteration-2-make-the-application-look-nice-vb/samples/sample2.aspx)]

Метод Html.ActionLink() отображает весь HTML-гиперссылка. Метод Url.Action(), с другой стороны, выводит только URL-адрес без &lt;&gt; тега.

Кроме того, обратите внимание, что новый формат содержит выбранном и невыбранном вкладки. Например, на рис. 8 **создать новый контакт** выбрана вкладка и **контактов** не выбрана вкладка.


[![В диалоговом окне нового проекта](iteration-2-make-the-application-look-nice-vb/_static/image8.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image15.png)

**Рис 08**: Выбранной или невыбранной вкладок ([Просмотр полноразмерного изображения](iteration-2-make-the-application-look-nice-vb/_static/image16.png))


Для поддержки визуализации выбранном и невыбранном вкладки, я создал пользовательский вспомогательный метод HTML, с именем MenuItemHelper. Этот вспомогательный метод отображает либо &lt;li&gt; тега или &lt;класс li = «selected»&gt; тега в зависимости от ли текущий контроллер и действие соответствует имени контроллера и действия, передаваемые вспомогательное приложение. Код для MenuItemHelper содержится в листинге 1.

**В листинге 1 — Helpers\MenuItemHelper.vb**

[!code-vb[Main](iteration-2-make-the-application-look-nice-vb/samples/sample3.vb)]

MenuItemHelper использует класс TagBuilder для внутренних целей для построения &lt;li&gt; HTML-тега. Класс TagBuilder является очень полезным служебный класс, который можно использовать всякий раз, когда вам нужно создать новый тег HTML. Он включает методы для добавления атрибутов, добавив классы CSS, генерации идентификаторов и изменение тега s внутренний HTML-код.

## <a name="summary"></a>Сводка

В этой итерации мы улучшили визуальную структуру наше приложение ASP.NET MVC. Во-первых вы ознакомились с ASP.NET MVC макетов. Вы узнали, как скачать бесплатные шаблоны из библиотеки макетов ASP.NET MVC, который можно использовать в приложениях ASP.NET MVC.

Далее мы рассмотрели создание пользовательской системы путем изменения по умолчанию CSS-файла и файла подкачки главному представлению. Чтобы обеспечить поддержку новых методов разработки, нам пришлось внести некоторые незначительные изменения в наше приложение диспетчера контактов. Например мы добавили новый вспомогательный метод HTML, с именем MenuItemHelper, выбранном и невыбранном вкладок.

В следующей итерации мы разберем очень важным предметом проверки. Мы добавьте код проверки в наше приложение, чтобы пользователь не может создать контакт без указания необходимые значения, например человека s сначала имени и фамилии.

> [!div class="step-by-step"]
> [Назад](iteration-1-create-the-application-vb.md)
> [Вперед](iteration-3-add-form-validation-vb.md)
