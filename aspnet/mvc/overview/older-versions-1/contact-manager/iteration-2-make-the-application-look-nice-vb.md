---
uid: mvc/overview/older-versions-1/contact-manager/iteration-2-make-the-application-look-nice-vb
title: 'Итерация #2 — сделайте приложение привлекательным (VB) | Документация Майкрософт'
author: microsoft
description: В этой итерации мы улучшаем внешний вид приложения путем изменения главной страницы ASP.NET представления MVC по умолчанию и каскадной таблицы стилей.
ms.author: riande
ms.date: 02/20/2009
ms.assetid: f65cb436-e493-46fd-9608-384b27385aa1
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-2-make-the-application-look-nice-vb
msc.type: authoredcontent
ms.openlocfilehash: cd392baaefcfc9eef3551bc534e0b912ccd349cc
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78487284"
---
# <a name="iteration-2--make-the-application-look-nice-vb"></a>Итерация #2 — сделайте приложение привлекательным (VB)

по [Майкрософт](https://github.com/microsoft)

[Скачать код](iteration-2-make-the-application-look-nice-vb/_static/contactmanager_2_vb1.zip)

> В этой итерации мы улучшаем внешний вид приложения путем изменения главной страницы ASP.NET представления MVC по умолчанию и каскадной таблицы стилей.

## <a name="building-a-contact-management-aspnet-mvc-application-vb"></a>Создание приложения для управления контактами ASP.NET MVC (VB)

В этой серии учебников мы создадим все приложение управления контактами от начала до конца. Приложение диспетчера контактов позволяет хранить контактные данные — имена, Номера телефонов и адреса электронной почты, чтобы получить список людей.

Мы создаем приложение для нескольких итераций. При каждой итерации мы постепенно улучшаем приложение. Цель этого нескольких итераций — позволить вам понять причину каждого изменения.

- Итерация #1 — Создайте приложение. В первой итерации мы создаем Диспетчер контактов проще всего. Добавлена поддержка основных операций с базой данных: создание, чтение, обновление и удаление (CRUD).

- Итерация #2 — сделайте приложение привлекательным. В этой итерации мы улучшаем внешний вид приложения путем изменения главной страницы ASP.NET представления MVC по умолчанию и каскадной таблицы стилей.

- #3 итерации — Добавление проверки формы. В третьей итерации мы добавим проверку базовой формы. Мы запрещаем пользователям отправлять форму, не заполняя обязательные поля формы. Мы также проверяем адреса электронной почты и номера телефонов.

- Итерация #4 — сделайте приложение слабо связанным. В этой четвертой итерации мы используем преимущества нескольких шаблонов проектирования программного обеспечения, чтобы упростить обслуживание и изменение приложения Contact Manager. Например, мы выполним рефакторинг нашего приложения для использования шаблона репозитория и шаблона внедрения зависимостей.

- #5 итерации — создание модульных тестов. В пятой итерации мы сделаем наше приложение проще в обслуживании и изменении, добавляя модульные тесты. Мы размакетирования наши классы модели данных и создаем модульные тесты для наших контроллеров и логики проверки.

- #6 итерации — используйте разработку на основе тестирования. В этой шестой итерации мы добавим новые функции в наше приложение, создав модульные тесты в первую очередь и записав код в модульные тесты. В этой итерации мы добавляем группы контактов.

- #7 итерации — Добавление функций AJAX. В седьмой итерации мы улучшаем скорость реагирования и производительность нашего приложения, добавив поддержку AJAX.

## <a name="this-iteration"></a>Эта итерация

Цель этой итерации — улучшить внешний вид приложения диспетчера контактов. В настоящее время Диспетчер контактов использует эталонную страницу ASP.NET представления MVC по умолчанию и каскадную таблицу стилей (см. рис. 1). Они выглядят плохо, но я не хочу, чтобы диспетчер контактов выглядел так же, как и каждый другой веб-сайт ASP.NET MVC. Я хочу заменить эти файлы пользовательскими файлами.

[![диалоговом окне «Создание проекта»](iteration-2-make-the-application-look-nice-vb/_static/image1.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image1.png)

**Рис. 01**. внешний вид по умолчанию приложения ASP.NET MVC ([щелкните, чтобы просмотреть изображение с полным размером](iteration-2-make-the-application-look-nice-vb/_static/image2.png))

В этой итерации я расскажу о двух подходах к улучшению визуальной разработки нашего приложения. Во-первых, я покажу, как воспользоваться преимуществами коллекции проектирования ASP.NET MVC, чтобы скачать бесплатный шаблон проектирования ASP.NET MVC. Галерея конструирования ASP.NET MVC позволяет создавать профессиональные веб-приложения, не выполняя никаких действий.

Я решил не использовать шаблон из галереи проектирования ASP.NET MVC для приложения диспетчера контактов. Вместо этого у меня была пользовательская структура, созданная профессиональным дизайном. Во второй части этого руководства я объясню, как я работал с компанией профессионального проектирования для создания окончательной ASP.NET проектирования MVC.

## <a name="the-aspnet-mvc-design-gallery"></a>Галерея проектирования MVC ASP.NET

Галерея конструирования ASP.NET MVC — это бесплатный ресурс, предоставляемый корпорацией Майкрософт. Коллекция ASP.NET MVC находится по следующему адресу:

[https://www.asp.net/mvc/gallery](https://www.asp.net/mvc/gallery)

В галерее конструирования ASP.NET MVC размещается набор бесплатных дизайнов веб-сайтов, созданных специально для использования в проекте ASP.NET MVC. Макеты отправляются членами сообщества. Посетители коллекции могут проголосовать за избранные макеты (см. рис. 2).

[![диалоговом окне «Создание проекта»](iteration-2-make-the-application-look-nice-vb/_static/image2.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image3.png)

**Рис. 02**. Галерея конструирования ASP.NET MVC ([щелкните, чтобы просмотреть изображение с полным размером](iteration-2-make-the-application-look-nice-vb/_static/image4.png))

При написании этого учебника наиболее популярная схема в галерее — это проект с именем "Октябрь" Дэвид Хаусер. Эту конструкцию можно использовать для проекта ASP.NET MVC, выполнив следующие действия.

1. Нажмите кнопку **скачать** , чтобы загрузить ZIP-файл Октябрь на компьютер.
2. Щелкните правой кнопкой мыши скачанный ZIP-файл октября и нажмите кнопку **разблокировать** (см. рис. 3).
3. Распакуйте файл в папку с именем Октябрь.
4. Выберите все файлы из папки Десигнтемплате, содержащейся в папке Октябрь, щелкните файлы правой кнопкой мыши и выберите пункт меню **Копировать**.
5. Щелкните правой кнопкой мыши узел проекта ContactManager в окне обозреватель решений Visual Studio и выберите пункт меню **Вставить** (см. рис. 4).
6. Выберите меню Visual Studio пункт **изменить, найти и заменить, Быстрая замена** и заменить *[MyProjectName]* на *ContactManager* (см. рис. 5).

[![диалоговом окне «Создание проекта»](iteration-2-make-the-application-look-nice-vb/_static/image3.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image5.png)

**Рис. 03**. разблокирование файла, скачанного из Интернета ([щелкните, чтобы просмотреть изображение с полным размером](iteration-2-make-the-application-look-nice-vb/_static/image6.png))

[![диалоговом окне «Создание проекта»](iteration-2-make-the-application-look-nice-vb/_static/image4.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image7.png)

**Рис. 04**. перезапись файлов в Обозреватель решений ([щелкните, чтобы просмотреть изображение с полным размером](iteration-2-make-the-application-look-nice-vb/_static/image8.png))

[![диалоговом окне «Создание проекта»](iteration-2-make-the-application-look-nice-vb/_static/image5.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image9.png)

**Рис. 05**. Замена [имя_проекта] на ContactManager ([щелкните, чтобы просмотреть изображение с полным размером](iteration-2-make-the-application-look-nice-vb/_static/image10.png))

После выполнения этих действий веб-приложение будет использовать новую конструкцию. На странице на рис. 6 показан внешний вид приложения диспетчера контактов в октябре.

[![диалоговом окне «Создание проекта»](iteration-2-make-the-application-look-nice-vb/_static/image6.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image11.png)

**Рис. 06**. ContactManager с шаблоном Октябрь ([щелкните, чтобы просмотреть изображение с полным размером](iteration-2-make-the-application-look-nice-vb/_static/image12.png))

## <a name="creating-a-custom-aspnet-mvc-design"></a>Создание настраиваемой структуры MVC ASP.NET

В галерее конструирования ASP.NET MVC есть хороший выбор различных стилей проектирования. Коллекция обеспечивает неограниченный способ настройки внешнего вида приложений ASP.NET MVC. И, конечно же, коллекция имеет большое преимущество в полном объеме.

Однако может потребоваться создать совершенно уникальную структуру веб-сайта. В этом случае имеет смысл работать с компанией-конструктором Web. Я решил использовать этот подход для проектирования приложения Contact Manager.

Я заархивирован Диспетчер контактов из итерации #1 и отправил проект в компанию проектирования. Они не владеют Visual Studio (стыдно!), но в них отсутствовала проблема. Они смогли загрузить Microsoft Visual Web Developer бесплатно с веб-сайта [https://www.asp.net](https://www.asp.net) и открыть приложение диспетчера контактов в Visual Web Developer. В течение нескольких дней они создавали конструкцию на рис. 7.

[![диалоговом окне «Создание проекта»](iteration-2-make-the-application-look-nice-vb/_static/image7.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image13.png)

**Рис. 07**. Проектирование диспетчера контактов ASP.NET MVC ([щелкните, чтобы просмотреть изображение с полным размером](iteration-2-make-the-application-look-nice-vb/_static/image14.png))

Новый проект состоит из двух основных файлов: нового файла каскадной таблицы стилей и нового файла главной страницы представления. Главная страница представления содержит макет и общее содержимое для представлений в приложении ASP.NET MVC. Например, Главная страница представления содержит заголовок, вкладки навигации и нижний колонтитул, которые отображаются на рис. 7. Я перезаписал существующую главную страницу site. master представления в папке Views\Shared, используя новый файл Site. master из компании-разработчика,

Компания-конструктор также создала новую каскадную таблицу стилей и набор изображений. Я поместил эти новые файлы в папку Content и перезаписал существующий файл Site. CSS. Все статическое содержимое следует размещать в папке содержимого.

Обратите внимание, что новый проект диспетчера контактов содержит изображения для редактирования и удаления контактов. Рядом с каждым контактным сообщением в HTML-таблице контактов появится изображение для редактирования и удаления.

Изначально эти ссылки были визуализированы с помощью HTML. Вспомогательный метод ActionLink ():

[!code-aspx[Main](iteration-2-make-the-application-look-nice-vb/samples/sample1.aspx)]

Метод HTML. ActionLink () не поддерживает изображения (метод HTML кодирует текст ссылки по соображениям безопасности). Поэтому я заменил вызовы HTML. ActionLink () вызовами метода URL. Action () следующим образом:

[!code-aspx[Main](iteration-2-make-the-application-look-nice-vb/samples/sample2.aspx)]

Метод HTML. ActionLink () визуализирует всю HTML-гиперссылку. С другой стороны, метод URL. Action () отображает только URL-адрес без &lt;тега&gt;.

Кроме того, обратите внимание, что новый проект включает как выбранные, так и невыбранные вкладки. Например, на рис. 8 выбрана вкладка **Создание нового контакта** , а вкладка **Мои контакты** не выбрана.

[![диалоговом окне «Создание проекта»](iteration-2-make-the-application-look-nice-vb/_static/image8.jpg)](iteration-2-make-the-application-look-nice-vb/_static/image15.png)

**Рис. 08**. выбранные и невыбранные вкладки ([щелкните, чтобы просмотреть изображение с полным размером](iteration-2-make-the-application-look-nice-vb/_static/image16.png))

Для поддержки отрисовки как выбранных, так и невыбранных вкладок я создал пользовательский вспомогательный метод HTML с именем Менуитемхелпер. Этот вспомогательный метод визуализирует тег &lt;Li&gt; или &lt;Li Class = "Selected"&gt;, в зависимости от того, соответствует ли текущий контроллер и действие контроллеру и имени действия, переданным вспомогательному модулю. Код для Менуитемхелпер содержится в листинге 1.

**Листинг 1 — Хелперс\менуитемхелпер.ВБ**

[!code-vb[Main](iteration-2-make-the-application-look-nice-vb/samples/sample3.vb)]

Менуитемхелпер использует внутренний класс TagBuilder для создания &lt;Li&gt; тега HTML. Класс TagBuilder — очень полезный служебный класс, который можно использовать всякий раз, когда необходимо создать новый HTML-тег. Он содержит методы для добавления атрибутов, добавления классов CSS, создания идентификаторов и изменения внутреннего HTML-кода тега.

## <a name="summary"></a>Сводка

В этой итерации мы улучшили визуальное проектирование нашего приложения ASP.NET MVC. Во первых, вы впервые появились в галерее конструирования ASP.NET MVC. Вы узнали, как загружать бесплатные шаблоны проектирования из коллекции ASP.NET Design Gallery, которые можно использовать в приложениях ASP.NET MVC.

Далее мы рассмотрели, как можно создать пользовательский макет, изменив файл таблицы каскадных стилей и файл страницы главного представления по умолчанию. Чтобы обеспечить поддержку новой структуры, нам пришлось внести небольшие изменения в приложение диспетчера контактов. Например, мы добавили новый вспомогательный метод HTML с именем Менуитемхелпер, который отображает выбранные и невыбранные вкладки.

В следующей итерации мы рассмотрим очень важную тему проверки. Мы добавляем код проверки в наше приложение, чтобы пользователь не смог создать новый контакт, не указывая необходимые значения, такие как имя и фамилия пользователя.

> [!div class="step-by-step"]
> [Назад](iteration-1-create-the-application-vb.md)
> [Вперед](iteration-3-add-form-validation-vb.md)
