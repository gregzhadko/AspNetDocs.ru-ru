---
uid: mvc/overview/older-versions-1/unit-testing/creating-unit-tests-for-asp-net-mvc-applications-vb
title: Создание модульных тестов для приложений ASP.NET MVC (VB) | Документация Майкрософт
author: StephenWalther
description: Сведения о создании модульных тестов для действий контроллера. Стивен Вальтер в этом руководстве показано, как протестировать действия контроллера возвращает parti ли...
ms.author: riande
ms.date: 08/19/2008
ms.assetid: eb35710d-1d99-44ac-b61f-e50af8cb328a
msc.legacyurl: /mvc/overview/older-versions-1/unit-testing/creating-unit-tests-for-asp-net-mvc-applications-vb
msc.type: authoredcontent
ms.openlocfilehash: c97d202c702253f2ff79a70c1d6e43b11999ea14
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65117266"
---
# <a name="creating-unit-tests-for-aspnet-mvc-applications-vb"></a>Создание модульных тестов для приложений ASP.NET MVC (VB)

по [Стивен Вальтер](https://github.com/StephenWalther)

[Загрузить PDF-файл](http://download.microsoft.com/download/8/4/8/84843d8d-1575-426c-bcb5-9d0c42e51416/ASPNET_MVC_Tutorial_07_VB.pdf)

> Сведения о создании модульных тестов для действий контроллера. В этом руководстве Стивен Вальтер показано, как проверить ли действие контроллера возвращает конкретное представление, возвращает определенный набор данных или другой тип результата действия.

Целью данного учебника — продемонстрировать, как можно создавать модульные тесты для контроллеров в your ASP.NET MVC приложений. Мы обсудим, как создать три разных типа модульных тестов. Вы узнаете, как для представления, возвращаемого действием контроллера тестирования, как проверить данные представления, возвращаемое в результате действия контроллера и способы тестирования независимо от того, имеется ли одно действие контроллера перенаправит вас на второе действие контроллера.

## <a name="creating-the-controller-under-test"></a>Создание контроллера при тестировании

Начнем с создания контроллера, к которому мы намерены протестировать. Контроллер, с именем `ProductController`, содержащийся в листинге 1.

**Листинг 1. `ProductController.vb`**

[!code-vb[Main](creating-unit-tests-for-asp-net-mvc-applications-vb/samples/sample1.vb)]

`ProductController` Содержит два метода действия с именем `Index()` и `Details()`. Оба метода действия возвращают представления. Обратите внимание, что `Details()` действие принимает параметр с именем Id.

## <a name="testing-the-view-returned-by-a-controller"></a>Тестирование представления возвращаемые контроллера

Представьте, что нам нужно протестировать ли `ProductController` возвращает правильное представление. Мы хотим, чтобы убедиться, что при `ProductController.Details()` вызывается действие, возвращается в представлении сведений. Класс test в листинге 2 содержит модульного теста для тестирования представления, возвращаемого с `ProductController.Details()` действие.

**Листинг 2. `ProductControllerTest.vb`**

[!code-vb[Main](creating-unit-tests-for-asp-net-mvc-applications-vb/samples/sample2.vb)]

Класс в листинге 2 включает метод теста с именем `TestDetailsView()`. Этот метод содержит три строки кода. В первой строке кода создается новый экземпляр класса `ProductController` класса. Вторая строка кода вызывает контроллера `Details()` метода действия. Наконец, последняя строка ли возвращаемый представление проверки кода `Details()` действие является представлением сведений.

`ViewResult.ViewName` Свойство представляет имя представления, возвращаемого с помощью контроллера. Одно важное предупреждение о тестировании это свойство. Существует два способа, что контроллер может возвратить представление. Контроллер может явным образом вернуть представление следующим образом:

[!code-vb[Main](creating-unit-tests-for-asp-net-mvc-applications-vb/samples/sample3.vb)]

Кроме того имя представления можно быть выведены из имени действия контроллера следующим образом:

[!code-vb[Main](creating-unit-tests-for-asp-net-mvc-applications-vb/samples/sample4.vb)]

Это действие контроллера также возвращает представление с именем `Details`. Тем не менее имя представления выводится из имени действия. Если вы хотите протестировать имя представления, вы должны явно возвращается имя представления из действия контроллера.

Запуском модульного теста в листинге 2, либо введя сочетание **Ctrl + R, A** или щелкнув **запустить все тесты в решении** кнопку (см. рис. 1). Если тест проходит успешно, вы увидите в окне результатов теста на рис. 2.

[![Выполнение всех тестов в решении](creating-unit-tests-for-asp-net-mvc-applications-vb/_static/image2.png)](creating-unit-tests-for-asp-net-mvc-applications-vb/_static/image1.png)

**Рис 01**: Выполнение всех тестов в решении ([Просмотр полноразмерного изображения](creating-unit-tests-for-asp-net-mvc-applications-vb/_static/image3.png))

[![Успех!](creating-unit-tests-for-asp-net-mvc-applications-vb/_static/image5.png)](creating-unit-tests-for-asp-net-mvc-applications-vb/_static/image4.png)

**Рис. 02**: Готово! ([Просмотр полноразмерного изображения](creating-unit-tests-for-asp-net-mvc-applications-vb/_static/image6.png))

## <a name="testing-the-view-data-returned-by-a-controller"></a>Тестирование представления данных возвращается с помощью контроллера

Контроллер MVC передает данные для представления, используя такую вещь *`View Data`*. Например, представьте, что вы хотите отобразить сведения для конкретного продукта, при вызове `ProductController Details()` действие. В этом случае можно создать экземпляр `Product` класс (определенный в модели) и передать экземпляр для `Details` представление, используя преимущества `View Data`.

Измененный `ProductController` в листинге 3 включает в себя обновленный `Details()` действие, которое возвращает продукт.

**Листинг 3. `ProductController.vb`**

[!code-vb[Main](creating-unit-tests-for-asp-net-mvc-applications-vb/samples/sample5.vb)]

Во-первых, `Details()` действие создает новый экземпляр класса `Product` класс, представляющий переносного компьютера. Далее, экземпляр `Product` класса передается в качестве второго параметра `View()` метод.

Можно написать модульные тесты для проверки ожидаемых данных содержатся в представлении данных. Модульный тест в листинге 4 тестах, независимо от того, имеется ли продукт, представляющий переносной компьютер возвращается при вызове `ProductController Details()` метода действия.

**Листинг 4. `ProductControllerTest.vb`**

[!code-vb[Main](creating-unit-tests-for-asp-net-mvc-applications-vb/samples/sample6.vb)]

В листинге 4 `TestDetailsView()` метод проверяет данные представления, возвращаемые при вызове `Details()` метод. `ViewData` Предоставляется как свойство `ViewResult` возвращенные вызовом `Details()` метод. `ViewData.Model` Свойство содержит результат передается в представление. Тест просто продукта, содержащиеся в представлении данных проверяет, имеет ли имя ноутбука.

## <a name="testing-the-action-result-returned-by-a-controller"></a>Тестирование результата действия возвращается с помощью контроллера

Более сложные действия контроллера могут возвращать различные типы результатов действий в зависимости от значений параметров, передаваемых действия контроллера. Действие контроллера могут возвращать различные типы результатов действий, в том числе `ViewResult`, `RedirectToRouteResult`, или `JsonResult`.

Например, измененный `Details()` в листинге 5 вы возвращаетесь `Details` просмотра при передаче допустимый код продукта в действие. Если передается недопустимый продуктом Id — идентификатор со значением меньше 1, то вы будете перенаправлены на `Index()` действие.

**Листинг 5. `ProductController.vb`**

[!code-vb[Main](creating-unit-tests-for-asp-net-mvc-applications-vb/samples/sample7.vb)]

Можно тестировать реакцию на событие `Details()` действие с модульным тестом в листинге 6. В листинге 6 модульный тест проверяет, что вы будете перенаправлены на `Index` просмотра при передаче идентификатора значение -1 `Details()` метод.

**Листинг 6. `ProductControllerTest.vb`**

[!code-vb[Main](creating-unit-tests-for-asp-net-mvc-applications-vb/samples/sample8.vb)]

При вызове `RedirectToAction()` в действие контроллера, действия контроллера методом `RedirectToRouteResult`. Тест проверки ли `RedirectToRouteResult` перенаправляет пользователя на выполнение действия контроллера с именем `Index`.

## <a name="summary"></a>Сводка

В этом руководстве вы узнали, как для создания модульных тестов для действий контроллеров MVC. Во-первых вы узнали, как проверить, возвращается ли правильное представление с помощью действия контроллера. Вы узнали, как использовать `ViewResult.ViewName` свойство для проверки имени представления.

Далее мы рассмотрели, как можно проверить содержимое `View Data`. Вы узнали, как проверить, возвращаются ли оптимальный продукт в `View Data` после вызова действия контроллера.

Наконец мы рассмотрели, как вы можете протестировать различные типы результатов действий возвращаются из действия контроллера. Вы узнали, как проверить ли контроллер возвращает `ViewResult` или `RedirectToRouteResult`.

> [!div class="step-by-step"]
> [Назад](creating-unit-tests-for-asp-net-mvc-applications-cs.md)
