---
uid: mvc/overview/older-versions-1/models-data/performing-simple-validation-vb
title: Выполнение простой проверки (Visual Basic) | Документация Майкрософт
author: StephenWalther
description: Узнайте, как для выполнения проверки в приложении ASP.NET MVC. В этом руководстве Стивен Вальтер вводит вы состояние модели, а также вспомогательные проверки HTML...
ms.author: riande
ms.date: 03/02/2009
ms.assetid: df6cf4b7-0bb3-4c4e-b17a-bd78a759a6bc
msc.legacyurl: /mvc/overview/older-versions-1/models-data/performing-simple-validation-vb
msc.type: authoredcontent
ms.openlocfilehash: c7a1b9e82defaae71f0a911e5e4321f6e15ad8bf
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59422620"
---
# <a name="performing-simple-validation-vb"></a>Выполнение простой проверки (VB)

по [Стивен Вальтер](https://github.com/StephenWalther)

> Узнайте, как для выполнения проверки в приложении ASP.NET MVC. В этом руководстве Стивен Вальтер вводит для состояния модели и вспомогательные функции проверки HTML.


Этот учебник призван объяснить, как выполнять проверки в приложении ASP.NET MVC. Например вы узнаете, как запретить кто-то отправка формы, который не содержит значение для обязательного поля. Вы узнаете, как использовать состояние модели и вспомогательных методов HTML проверки.

## <a name="understanding-model-state"></a>Общие сведения о состоянии модели

Состояние модели — или, точнее, в словарь состояния модели — использовать для представления ошибок проверки. Например действие Create() в листинге 1 проверяет свойства класса Product перед добавлением класс Product в базе данных.


Я не рекомендую что нужно добавить логику проверки или базы данных, к контроллеру. Контроллер должен содержать только логику, относящуюся к управляют потоком данных приложения. Мы говорим об ярлык для простоты.


**В листинге 1 - Controllers\ProductController.vb**

[!code-vb[Main](performing-simple-validation-vb/samples/sample1.vb)]

В листинге 1 проверяются имя, описание и UnitsInStock свойства класса продукта. Если любое из этих свойств не прошли проверку ошибка добавляется в словарь состояния модели (представленного свойством ModelState класса Controller).

Если имеются ошибки в состояние модели, свойству ModelState.IsValid возвращает false. В этом случае отобразится форма HTML для создания нового продукта. В противном случае при возникновении ошибки проверки, добавляется новый продукт в базу данных.

## <a name="using-the-validation-helpers"></a>Используя вспомогательные функции проверки

Платформа ASP.NET MVC включает в себя две вспомогательные функции проверки: Html.ValidationMessage() вспомогательного приложения, а также вспомогательные Html.ValidationSummary(). Используйте эти две вспомогательные функции в виде для отображения сообщений об ошибках проверки.

Вспомогательные функции Html.ValidationMessage() и Html.ValidationSummary() используются в представлениях Create и Edit, автоматически создаваемых формирование шаблонов ASP.NET MVC. Выполните следующие действия для создания представления создания.

1. Щелкните правой кнопкой мыши действие Create() в контроллере продукта и выберите пункт меню **Добавление представления** (см. рис. 1).
2. В **Добавление представления** диалоговом окне установите флажок "с меткой" **создать строго типизированное представление** (см. рис. 2).
3. Из **просмотреть класс данных** раскрывающегося списка выберите класс Product.
4. Из **просматривать содержимое** раскрывающемся списке выберите создать.
5. Нажмите кнопку **Добавить**.


Убедитесь, что сборка приложения осуществляется перед добавлением представления. В противном случае список классов не будет отображаться на **просмотреть класс данных** раскрывающегося списка.


[![В диалоговом окне нового проекта](performing-simple-validation-vb/_static/image1.jpg)](performing-simple-validation-vb/_static/image1.png)

**Рис 01**: Добавление представления ([Просмотр полноразмерного изображения](performing-simple-validation-vb/_static/image2.png))


[![В диалоговом окне нового проекта](performing-simple-validation-vb/_static/image2.jpg)](performing-simple-validation-vb/_static/image3.png)

**Рис. 02**: Создание представления со строгой типизацией ([Просмотр полноразмерного изображения](performing-simple-validation-vb/_static/image4.png))


После выполнения этих действий вы получаете представления создания в листинге 2.

**В листинге 2 - Views\Product\Create.aspx**

[!code-aspx[Main](performing-simple-validation-vb/samples/sample2.aspx)]

В листинге 2 Html.ValidationSummary() вспомогательного приложения сразу же вызывается выше HTML-формы. Этого вспомогательного объекта используется для отображения списка сообщений об ошибках проверки. Вспомогательный метод Html.ValidationSummary() отображает ошибки в виде маркированного списка.

Вспомогательный метод Html.ValidationMessage() называется рядом с каждым из полей формы HTML. Этого вспомогательного объекта используется для отображения сообщения об ошибке, рядом с полем формы. В случае листинга 2 вспомогательный Html.ValidationMessage() отображается звездочка, когда возникает ошибка.

Страница, на рис. 3 показано сообщения об ошибках, преобразовываемый вспомогательные функции проверки при отправке формы с отсутствующих полей и недопустимые значения.


[![В диалоговом окне нового проекта](performing-simple-validation-vb/_static/image3.jpg)](performing-simple-validation-vb/_static/image5.png)

**Рис 03**: Создать представление, отправленных с проблемами ([Просмотр полноразмерного изображения](performing-simple-validation-vb/_static/image6.png))


Обратите внимание, внешний вид HTML входные данные, что поля также изменяются при ошибке проверки. Отображает вспомогательные Html.TextBox() *класс = «ошибка ввода проверки»* атрибута при ошибке проверки, связанного со свойством, преобразовываемый для просмотра Html.TextBox() вспомогательное приложение.

Существует три класса каскадных таблицы стилей стиль, используемый для управления внешним видом ошибки проверки:

- входные данные —-ошибка проверки — применяется к &lt;ввода&gt; к просмотру Html.TextBox() вспомогательной функцией тега.
- поле--Ошибка проверки — применяется к &lt;span&gt; к просмотру Html.ValidationMessage() вспомогательной функцией тега.
- Сводка ошибки проверки - применяется к &lt;ul&gt; к просмотру Html.ValidationSummary() вспомогательной функцией тега.

Можно изменить эти каскадные таблицы стилей классы стилей и таким образом изменить внешний вид ошибки проверки, изменив файл Site.css, расположенный в папке Content.

> [!NOTE] 
> 
> Класс HtmlHelper включает в себя статических свойств только для чтения для CSS, получение имен проверки связанных классов. Эти статические свойства называются ValidationInputCssClassName ValidationFieldCssClassName и ValidationSummaryCssClassName.


## <a name="prebinding-validation-and-postbinding-validation"></a>Prebinding проверки и проверки Postbinding

Если введено недопустимое значение для поля Цена и нет значения для поля UnitsInStock отправки формы HTML для создания продукта, вы получите сообщения проверки, отображаемый на рис. 4. Откуда берутся эти сообщения об ошибках проверки?


[![В диалоговом окне нового проекта](performing-simple-validation-vb/_static/image4.jpg)](performing-simple-validation-vb/_static/image7.png)

**Рис. 04**: Prebinding ошибки проверки ([Просмотр полноразмерного изображения](performing-simple-validation-vb/_static/image8.png))


Существует фактически используется два типа сообщений об ошибках проверки - созданные перед поля формы HTML привязаны к классу и их сформировано после поля формы привязываются к классу. Другими словами, есть prebinding ошибки проверки и postbinding ошибки проверки.

Create() действию, предоставляемым контроллером продукта в листинге 1 принимает экземпляр класса Product. Подпись метода Create выглядит следующим образом:

[!code-vb[Main](performing-simple-validation-vb/samples/sample3.vb)]

Значения поля формы HTML в форме создать привязаны к классу productToCreate благодаря существованию так называемых связыватель модели. Связыватель модели по умолчанию добавляет сообщение об ошибке состояние модели автоматически при ее не удается привязать поле формы со свойством формы.

Связыватель модели по умолчанию невозможно привязать свойство цена продукта класса строка «apple». Строка не может назначить свойства десятичного типа. Таким образом связыватель модели добавляет ошибку состояния модели.

Связыватель модели по умолчанию также невозможно присвоить значение Nothing свойство, которое не принимает значение Nothing. В частности связывателя модели нельзя присвоить значение Nothing UnitsInStock свойству. Опять же связыватель модели отдает и добавляет сообщение об ошибке в состояние модели.

Если вы хотите настроить внешний вид этих prebinding сообщения об ошибках, необходимо создать ресурс строки для этих сообщений.

## <a name="summary"></a>Сводка

Цель этого учебника было описаны основные принципы работы проверки в ASP.NET MVC. Вы узнали, как использовать состояние модели и вспомогательных методов HTML проверки. Мы также рассмотрели различие между prebinding и postbinding проверки. В других руководствах мы обсудим различные стратегии перемещения код проверки из контроллеров в классах модели.

> [!div class="step-by-step"]
> [Назад](displaying-a-table-of-database-data-vb.md)
> [Вперед](validating-with-the-idataerrorinfo-interface-vb.md)
