---
uid: mvc/overview/older-versions-1/models-data/validation-with-the-data-annotation-validators-cs
title: Проверка с помощью модулях проверки заметок к данным (C#) | Документация Майкрософт
author: microsoft
description: Воспользуйтесь преимуществами связывателя модели аннотации данных для выполнения проверки в приложении ASP.NET MVC. Узнайте, как использовать различные виды проверяющий элемент управления...
ms.author: riande
ms.date: 05/29/2009
ms.assetid: 7ca8013e-9dfc-4e33-8336-cdccfd5f9414
msc.legacyurl: /mvc/overview/older-versions-1/models-data/validation-with-the-data-annotation-validators-cs
msc.type: authoredcontent
ms.openlocfilehash: 300fc9f7e82fe8201b083de9e740e1620f5d09b9
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59411817"
---
# <a name="validation-with-the-data-annotation-validators-c"></a>Проверка с помощью проверяющих элементов управления заметок к данным (C#)

по [Microsoft](https://github.com/microsoft)

> Воспользуйтесь преимуществами связывателя модели аннотации данных для выполнения проверки в приложении ASP.NET MVC. Узнайте, как использовать различные типы атрибутов проверяющего элемента управления и работы с ними в Microsoft Entity Framework.


В этом руководстве вы узнаете, как использовать средства проверки заметок к данным для выполнения проверки в приложении ASP.NET MVC. Преимущество использования средства проверки заметок к данным является то, что они позволяют выполнять проверки путем простого добавления одного или нескольких атрибутов — например обязательный или атрибут StringLength – к свойству класса.

Перед использованием средства проверки заметок к данным, необходимо загрузить связывателя модели данных заметок. В образце связывателя модели данных заметок можно загрузить с веб-сайта CodePlex, щелкнув [здесь](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471).


Важно понимать, что связывателя модели данных заметок, не является официальной частью платформы Microsoft ASP.NET MVC. Несмотря на то, что связывателя модели данных заметок был создан группой Microsoft ASP.NET MVC, Майкрософт предлагает Официальная поддержка для связывателя модели данных заметок описано и используемые в этом руководстве.


## <a name="using-the-data-annotation-model-binder"></a>С помощью связывателя модели данных заметок

Чтобы использовать связывателя модели данных заметок в приложении ASP.NET MVC, необходимо сначала добавить ссылку на эту сборку Microsoft.Web.Mvc.DataAnnotations.dll и сборки библиотеку System.ComponentModel.DataAnnotations.dll. Выберите пункт меню **проект, добавить ссылку**. Далее щелкните **Обзор** вкладку и перейдите в расположение, в которую был загружен (и распаковываются) в примере привязка модели данных заметок (см. в разделе **рис.1**).

[![](validation-with-the-data-annotation-validators-cs/_static/image2.png)](validation-with-the-data-annotation-validators-cs/_static/image1.png)

**Рис. 1**: Добавить ссылку на связыватель модели данных заметок ([Просмотр полноразмерного изображения](validation-with-the-data-annotation-validators-cs/_static/image3.png))

Выберите сборку Microsoft.Web.Mvc.DataAnnotations.dll и библиотеку System.ComponentModel.DataAnnotations.dll сборки и нажмите кнопку **ОК** кнопки.


Нельзя использовать библиотеку System.ComponentModel.DataAnnotations.dll сборки, включенные в .NET Framework с пакетом обновления 1 связывателя модели данных заметок. Необходимо использовать версию сборки библиотеку System.ComponentModel.DataAnnotations.dll, загружаемый образец связывателя модели данных заметок.


Наконец необходимо зарегистрировать связывателя модели DataAnnotations в файле Global.asax. Добавьте следующую строку кода в приложение\_Start() обработчик событий, чтобы приложение\_метод Start() выглядит следующим образом:

[!code-csharp[Main](validation-with-the-data-annotation-validators-cs/samples/sample1.cs)]

Эта строка кода регистрирует ataAnnotationsModelBinder как связывателя модели по умолчанию для всего приложения ASP.NET MVC.

## <a name="using-the-data-annotation-validator-attributes"></a>С помощью проверяющего элемента управления атрибуты примечаний к данным

При использовании связывателя модели данных заметок, используются атрибуты проверяющий элемент управления для выполнения проверки. Пространство имен System.ComponentModel.DataAnnotations включает следующие атрибуты проверяющий элемент управления:

- Диапазон — позволяет проверить, является ли значение свойства выходит из указанного диапазона значений.
- Регулярное выражение – позволяет проверить, соответствует ли значение свойства заданного шаблона регулярного выражения.
- Требуется – позволяет помечать свойство как обязательное.
- StringLength — позволяет указать максимальную длину для строкового свойства.
- Проверки — базовый класс для всех атрибутов проверяющего элемента управления.

> [!NOTE] 
> 
> Если вашим потребностям проверки не совместимы с любой из стандартных проверяющие элементы управления затем всегда имеется возможность создания атрибута пользовательский проверяющий элемент управления путем наследования от базового атрибута проверки нового атрибута проверяющего элемента управления.


Класс Product в **листинге 1** показано, как использовать эти атрибуты проверяющего элемента управления. Имя, описание и цена свойства отмечены как требуется. Свойство Name должно иметь строку, длина которой составляет менее 10 символов. Наконец свойство UnitPrice должно соответствовать шаблону регулярного выражения, представляющее сумму в некоторой валюте.

[!code-csharp[Main](validation-with-the-data-annotation-validators-cs/samples/sample2.cs)]

**В листинге 1**: Models\Product.cs

Класс Product показано, как использовать один дополнительный атрибут: атрибут DisplayName. Атрибут DisplayName позволяет изменить имя свойства, когда свойство отображается сообщение об ошибке. Вместо отображения сообщение об ошибке «это обязательное поле UnitPrice» можно отобразить сообщение об ошибке «это обязательное поле цены».

> [!NOTE] 
> 
> Если вы хотите полностью настроить сообщение об ошибке, проверяющий элемент управления можно назначить пользовательское сообщение об ошибке в свойство ErrorMessage проверяющего элемента управления следующим образом: `<Required(ErrorMessage:="This field needs a value!")>`


Можно использовать класс Product в **листинге 1** с действием контроллера Create() в **листинга 2**. Это действие контроллера повторно отображает представления создания, если состояние модели содержит все ошибки.

[!code-csharp[Main](validation-with-the-data-annotation-validators-cs/samples/sample3.cs)]

**В листинге 2**: Controllers\ProductController.vb

Наконец, можно создать представление в **листинге 3** , щелкнув правой кнопкой мыши действие Create() и выбрав пункт меню **Добавление представления**. Создайте представление со строгой типизацией с помощью класса продукта как класс модели. Выберите **создать** из представления содержимого раскрывающегося списка (см. в разделе **рис. 2**).

[![](validation-with-the-data-annotation-validators-cs/_static/image5.png)](validation-with-the-data-annotation-validators-cs/_static/image4.png)

**Рис. 2**: Добавление представления создания

[!code-aspx[Main](validation-with-the-data-annotation-validators-cs/samples/sample4.aspx)]

**Листинг 3**: Views\Product\Create.aspx

> [!NOTE] 
> 
> Удалить поле из создать форму, созданную командой **Добавление представления** пункт меню. Так как поле идентификатора соответствует столбец идентификаторов, вы не хотите разрешить пользователям вводить значение для этого поля.


Если отправить форму для создания продукта и вы не вводите значения для обязательных полей, то ошибка проверки сообщений в **рис. 3** отображаются.

[![](validation-with-the-data-annotation-validators-cs/_static/image7.png)](validation-with-the-data-annotation-validators-cs/_static/image6.png)

**Рис. 3**: Отсутствуют обязательные поля

Если ввести недопустимые денежную сумму, а затем сообщение об ошибке в **рис. 4** отображается.

[![](validation-with-the-data-annotation-validators-cs/_static/image9.png)](validation-with-the-data-annotation-validators-cs/_static/image8.png)

**Рис. 4**: Недопустимый денежную сумму

## <a name="using-data-annotation-validators-with-the-entity-framework"></a>С помощью проверяющих элементов управления заметок данных с Entity Framework

Если вы используете Microsoft Entity Framework для создания классов модели данных не может применить атрибуты проверяющий элемент управления непосредственно в пользовательские классы. Поскольку Entity Framework Designer создает классы моделей, любые изменения, внесенные в классы моделей перезаписывается в следующий раз внесением изменений в конструкторе.

Если вы хотите использовать проверяющие элементы управления с классы, сформированные платформой Entity Framework, необходимо создать классы данных метаданных. Проверяющие элементы управления применяются к классу данных meta вместо применения проверяющие элементы управления на фактический класс.

Например, представьте, что вы создали класс Movie, использующий Entity Framework (см. в разделе **рис. 5**). Представьте, кроме того, что вы хотите сделать название фильма и директор обязательные свойства для свойства. В этом случае можно создать разделяемый класс и класс данных метаданных в **листинге 4**.

[![](validation-with-the-data-annotation-validators-cs/_static/image11.png)](validation-with-the-data-annotation-validators-cs/_static/image10.png)

**Рис. 5**: Класс Movie, созданным Entity Framework

[!code-csharp[Main](validation-with-the-data-annotation-validators-cs/samples/sample5.cs)]

**Листинг 4**: Models\Movie.cs

Файл в **листинге 4** содержит два класса фильма и MovieMetaData. Класс Movie — это разделяемый класс. Он соответствует в разделяемый класс, созданный платформой Entity Framework, содержащийся в файле DataModel.Designer.vb.

В настоящее время платформа .NET framework не поддерживает частичные свойства. Таким образом, нет способа для применения атрибутов проверяющего элемента управления к свойствам класса фильма, определенного в файле DataModel.Designer.vb путем применения атрибутов проверяющего элемента управления к свойствам класса фильма, определенного в файле в **листинге 4**.

Обратите внимание на то, что в разделяемый класс Movie дополнен атрибутом MetadataType, который указывает на класс MovieMetaData. Класс MovieMetaData содержит прокси-свойств для свойств класса фильма.

Проверяющий элемент управления атрибуты применяются к свойствам класса MovieMetaData. Свойства Title, имя режиссера и DateReleased отмечены как обязательные свойства. Свойство директор должна быть назначена строка, содержащая не более 5 символов. Наконец атрибут DisplayName применяется к DateReleased свойство отображения сообщение об ошибке наподобие «поле даты выпуска обязателен.» вместо ошибки «DateReleased поле является обязательным.»

> [!NOTE] 
> 
> Обратите внимание на то, что прокси-свойства в классе MovieMetaData не обязательно должны представлять те же типы, что соответствующие свойства в класс Movie. Например свойство директор является строкового свойства в класс Movie и свойства объекта в классе MovieMetaData.


На странице в **рис. 6** иллюстрирует сообщения об ошибках при вводе недопустимых значений для свойства фильма.

[![](validation-with-the-data-annotation-validators-cs/_static/image13.png)](validation-with-the-data-annotation-validators-cs/_static/image12.png)

**Рис. 6**: С помощью проверяющих элементов управления с Entity Framework ([Просмотр полноразмерного изображения](validation-with-the-data-annotation-validators-cs/_static/image14.png))

## <a name="summary"></a>Сводка

В этом руководстве вы узнали, как пользоваться преимуществами связывателя модели аннотации данных для выполнения проверки в приложении ASP.NET MVC. Вы узнали, как использовать различные виды проверяющий элемент управления атрибуты, такие как обязательный и StringLength атрибуты. Вы также узнали, как использовать эти атрибуты при работе с Microsoft Entity Framework.

> [!div class="step-by-step"]
> [Назад](validating-with-a-service-layer-cs.md)
> [Вперед](creating-model-classes-with-the-entity-framework-vb.md)
