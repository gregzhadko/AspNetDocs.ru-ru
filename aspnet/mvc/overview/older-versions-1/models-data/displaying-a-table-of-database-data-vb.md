---
uid: mvc/overview/older-versions-1/models-data/displaying-a-table-of-database-data-vb
title: Отображение таблицы данных базы данных (VB) Документы Майкрософт
author: rick-anderson
description: В этом уроке я демонстрирую два метода отображения набора записей баз данных. Я показываю два способа форматирования набора записей баз данных в HTML ta...
ms.author: riande
ms.date: 10/07/2008
ms.assetid: 5bb4587f-5bcd-44f5-b368-3c1709162b35
msc.legacyurl: /mvc/overview/older-versions-1/models-data/displaying-a-table-of-database-data-vb
msc.type: authoredcontent
ms.openlocfilehash: 9b03e6a0d2bf7d2bf59ba4dca3076fa306d3fed4
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2020
ms.locfileid: "81541901"
---
# <a name="displaying-a-table-of-database-data-vb"></a>Отображение таблицы данных в базе данных (VB)

[корпорацией Майкрософт](https://github.com/microsoft)

[Скачать PDF](https://download.microsoft.com/download/1/1/f/11f721aa-d749-4ed7-bb89-a681b68894e6/ASPNET_MVC_Tutorial_11_VB.pdf)

> В этом уроке я демонстрирую два метода отображения набора записей баз данных. Я показываю два способа форматирования набора записей баз данных в таблице HTML. Во-первых, я показываю, как можно форматировать записи баз данных непосредственно в представлении. Далее, я демонстрирую, как вы можете воспользоваться частичности при форматировании записей баз данных.

Цель этого руководства состоит в том, чтобы объяснить, как можно отобразить HTML таблицу данных базы данных в ASP.NET mVC-приложении. Во-первых, вы узнаете, как использовать строительные леса инструменты, включенные в Visual Studio для создания представления, которое отображает набор записей автоматически. Далее вы узнаете, как использовать частичное в качестве шаблона при форматировании записей баз данных.

## <a name="create-the-model-classes"></a>Создание типовых классов

Мы отображим набор записей из таблицы базы данных Movies. Таблица базы данных Movies содержит следующие столбцы:

<a id="0.4_table01"></a>

| **Имя столбца** | **Тип данных** | **Разрешить значения NULL** |
| --- | --- | --- |
| Идентификатор | Int | False |
| Title | Нварчар (200) | False |
| Директор | НВарчар (50) | False |
| ДатаОпубликовано | Дата и время | False |

Для того, чтобы представить таблицу фильмов в нашем ASP.NET mVC-приложении, нам необходимо создать модельный класс. В этом уроке мы используем рамочную программу Microsoft Entity для создания наших типов моделей.

> [!NOTE] 
> 
> В этом уроке мы используем рамку сущности Майкрософт. Тем не менее, важно понимать, что вы можете использовать различные технологии для взаимодействия с базой данных от ASP.NET mVC-приложения, включая LIN-l, NHibernate или ADO.NET.

Выполните следующие действия, чтобы запустить волшебник модели данных Entity:

1. Нажмите правой кнопкой папку Модели в окне Solution Explorer и выберите вариант меню **Добавить, Новый пункт**.
2. Выберите категорию **данных** и выберите шаблон **модели ADO.NET данных entity.**
3. Дайте модели данных имя *MoviesDBModel.edmx* и нажмите кнопку **Добавить.**

После нажатия кнопки «Добавить» появляется мастер модели данных Entity (см. рисунок 1). Выполните следующие действия, чтобы завершить мастера:

1. На этапе **«Выбрать содержимое модели»** выберите **вариант «Создание из базы данных».**
2. На этапе **«Выберите подключение к данным»** используйте подключение к данным *MoviesDB.mdf* и имя *MoviesDBEntities* для настроек соединения. Нажмите кнопку **Далее**.
3. На этапе **«Выберите объекты базы данных»** расширьте узло таблицы таблицы Таблицы. Введите *модели* пространства имен и нажмите кнопку **Отделка.**

[![Создание классов LIN-in s-L](displaying-a-table-of-database-data-vb/_static/image1.jpg)](displaying-a-table-of-database-data-vb/_static/image1.png)

**Рисунок 01**: Создание LIN-класса для классов S'L[(Нажмите, чтобы просмотреть полноразмерное изображение)](displaying-a-table-of-database-data-vb/_static/image2.png)

После завершения мастера модели данных Entity открывается модель Entity Model Designer. Дизайнер должен отображать объект «Фильмы» (см. рисунок 2).

[![Конструктор модели данных сущности](displaying-a-table-of-database-data-vb/_static/image2.jpg)](displaying-a-table-of-database-data-vb/_static/image3.png)

**Рисунок 02**: Модель модели данных entity[(Нажмите, чтобы просмотреть полноразмерное изображение)](displaying-a-table-of-database-data-vb/_static/image4.png)

Мы должны сделать одно изменение, прежде чем мы продолжим. Волшебник данных entity генерирует класс модели под названием *Movies,* представляющий таблицу базы данных Movies. Поскольку мы будем использовать класс «Фильмы» для представления конкретного фильма, нам необходимо изменить название класса, чтобы быть *Movie* instead of *Movies* (единственное, а не множественное число).

Дважды щелкните название класса на поверхности дизайнера и измените название класса с фильмов на фильм. После внесения этого изменения нажмите кнопку **«Сохранить»** (значок дискеты) для генерации класса Movie.

## <a name="create-the-movies-controller"></a>Создать контроллер фильмов

Теперь, когда у нас есть способ представлять наши записи баз данных, мы можем создать контроллер, который возвращает коллекцию фильмов. В окне Visual Studio Solution Explorer щелкните по папке Контроллеров и выберите **опцию «Добавить» —«Контроллер»** (см. рисунок 3).

[![Меню контроллера добавления](displaying-a-table-of-database-data-vb/_static/image3.jpg)](displaying-a-table-of-database-data-vb/_static/image5.png)

**Рисунок 03**: Меню контроллера добавления ([Нажмите, чтобы просмотреть полноразмерное изображение](displaying-a-table-of-database-data-vb/_static/image6.png))

При пояснении диалога **Add Controller** введите имя контроллера контроллера контроллера (см. рисунок 4). Нажмите кнопку **Добавить,** чтобы добавить новый контроллер.

[![Диалог добавления контроллера](displaying-a-table-of-database-data-vb/_static/image4.jpg)](displaying-a-table-of-database-data-vb/_static/image7.png)

**Рисунок 04**: Диалог контроллера добавления[(Нажмите, чтобы просмотреть полноразмерное изображение)](displaying-a-table-of-database-data-vb/_static/image8.png)

Нам нужно изменить действие Index(), выставленное контроллером Movie, чтобы он возвращал набор записей баз данных. Измените контроллер таким образом, чтобы он выглядел как контроллер в листинге 1.

**Список 1 - Контролеры**

[!code-vb[Main](displaying-a-table-of-database-data-vb/samples/sample1.vb)]

В листинге 1 класс MoviesDBEntities используется для представления базы данных MoviesDB. Сущности *выражения. MovieSet.ToList ()* возвращает набор всех фильмов из таблицы базы данных Movies.

## <a name="create-the-view"></a>Создание представления

Самый простой способ отображения набора записей баз данных в таблице HTML — воспользоваться преимуществами строительных лесов, предоставляемых Visual Studio.

Создайте приложение, выбрав вариант меню **Build, Build Solution.** Необходимо создать приложение до открытия диалога **Add View** или классы данных не будут отображаться в диалоге.

Нажмите правой кнопкой мыши «Индекс() действие и выберите вариант меню **Добавить вид** (см. рисунок 5).

[![Добавление представления](displaying-a-table-of-database-data-vb/_static/image5.jpg)](displaying-a-table-of-database-data-vb/_static/image9.png)

**Рисунок 05**: Добавление представления[(Нажмите, чтобы просмотреть полноразмерное изображение)](displaying-a-table-of-database-data-vb/_static/image10.png)

В диалоге **Add View** проверьте флажок с пометкой Создать **сильно набранное представление.** Выберите класс Movie в качестве **класса данных представления.** Выберите *список* в качестве **содержимого представления** (см. рисунок 6). Выбор этих параметров будет генерировать сильно типидируемое представление, отображающее список фильмов.

[![Диалог «Добавить представление»](displaying-a-table-of-database-data-vb/_static/image6.jpg)](displaying-a-table-of-database-data-vb/_static/image11.png)

**Рисунок 06**: Диалог добавления просмотра[(Нажмите, чтобы просмотреть полноразмерное изображение)](displaying-a-table-of-database-data-vb/_static/image12.png)

После нажатия кнопки **Добавить** представление в листинге 2 генерируется автоматически. Это представление содержит код, необходимый для итерирования через коллекцию фильмов и отображения каждого из свойств фильма.

**Список 2 - Просмотры »Кино»Индекс.aspx**

[!code-aspx[Main](displaying-a-table-of-database-data-vb/samples/sample2.aspx)]

Вы можете запустить приложение, выбрав вариант меню **Debug, Start Debugging** (или ударяя ключ F5). Запуск приложения запускает Internet Explorer. Если вы переходите к /Movie URL, то вы увидите страницу на рисунке 7.

[![Таблица фильмов](displaying-a-table-of-database-data-vb/_static/image7.jpg)](displaying-a-table-of-database-data-vb/_static/image13.png)

**Рисунок 07**: Таблица фильмов[(Нажмите, чтобы посмотреть полноразмерное изображение](displaying-a-table-of-database-data-vb/_static/image14.png))

Если вам ничего не нравится в появлении сетки записей баз данных на рисунке 7, то вы можете просто изменить представление Индекса. Например, можно изменить заголовок *DateReleased* на *Дату, выпущенную* путем изменения представления индекса.

## <a name="create-a-template-with-a-partial"></a>Создание шаблона с частичным

Когда представление становится слишком сложным, рекомендуется начать разбивка представления на частичные. Использование частичных позволяет упростить понимание и обслуживание представлений. Мы создадим частичный, который мы можем использовать в качестве шаблона для формата каждой из записей базы данных фильмов.

Выполните следующие действия, чтобы создать частичное:

1. Нажмите правой кнопкой мыши папку «Просмотры» и выберите вариант меню **Добавить вид.**
2. Проверьте флажок с пометкой *Создайте частичное представление (.ascx).*
3. Назовите частичное *MovieTemplate*.
4. Проверьте флажок с пометкой **Создать сильно типизированное представление.**
5. Выберите Movie в качестве *класса данных представления.*
6. Выберите Пустое содержимое *представления.*
7. Нажмите кнопку **Добавить,** чтобы добавить частичное к вашему проекту.

После выполнения этих шагов измените частичное изменение MovieTemplate, чтобы выглядеть как листинг 3.

**Список 3 - Просмотры Фильма**

[!code-aspx[Main](displaying-a-table-of-database-data-vb/samples/sample3.aspx)]

Частичное в листинге 3 содержит шаблон для одного ряда записей.

В измененном представлении индекса в листинге 4 используется частичное использование MovieTemplate.

**Список 4 - Просмотры »Кино»Индекс.aspx**

[!code-aspx[Main](displaying-a-table-of-database-data-vb/samples/sample4.aspx)]

Представление в листинге 4 содержит цикл For Each, который итерируется во всех фильмах. Для каждого фильма частичное название MovieTemplate используется для формата фильма. MovieTemplate отображается путем вызова метода помощи RenderPartial()

Измененное представление Индекса отображает ту же таблицу HTML записей баз данных. Тем не менее, представление было значительно упрощено.

Метод RenderPartial() отличается от большинства других методов помощника, поскольку он не возвращает строку. Таким образом, необходимо позвонить в &lt;метод RenderPartial() с&gt; использованием % Html.RenderPartial() % вместо &lt;% HTML.RenderPartial() %&gt;.

## <a name="summary"></a>Сводка

Цель этого руководства состояла в том, чтобы объяснить, как можно отображать набор записей баз данных в таблице HTML. Во-первых, вы узнали, как вернуть набор записей баз данных из действия контроллера, воспользовавшись рамочной системой сущности Майкрософт. Далее вы узнали, как использовать visual Studio леса для создания представления, которое отображает коллекцию элементов автоматически. Наконец, вы узнали, как упростить представление, воспользовавшись частичным. Вы узнали, как использовать частичное в качестве шаблона, так что вы можете форматировать каждую запись базы данных.

> [!div class="step-by-step"]
> [Назад](creating-model-classes-with-linq-to-sql-vb.md)
> [Вперед](performing-simple-validation-vb.md)
