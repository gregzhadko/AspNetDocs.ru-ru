---
uid: mvc/overview/older-versions-1/models-data/performing-simple-validation-cs
title: Выполнение простой проверки (C#) | Документация Майкрософт
author: StephenWalther
description: Узнайте, как выполнить проверку в приложении ASP.NET MVC. В этом руководстве Стивен Вальтер содержит сведения о состоянии модели и вспомогательном коде HTML проверки...
ms.author: riande
ms.date: 03/02/2009
ms.assetid: 21383c9d-6aea-4bad-a99b-b5f2c9d6503f
msc.legacyurl: /mvc/overview/older-versions-1/models-data/performing-simple-validation-cs
msc.type: authoredcontent
ms.openlocfilehash: e33f522af74efe97b5a245e956bc0b918ea769af
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78436722"
---
# <a name="performing-simple-validation-c"></a>Выполнение простой проверки (C#)

по [Стивен Вальтер](https://github.com/StephenWalther)

> Узнайте, как выполнить проверку в приложении ASP.NET MVC. В этом руководстве Стивен Вальтер содержит сведения о состоянии модели и проверочных вспомогательных элементах HTML проверки.

Цель этого руководства — объяснить, как можно выполнить проверку в приложении ASP.NET MVC. Например, вы узнаете, как предотвратить отправку формы, которая не содержит значения для обязательного поля. Вы узнаете, как использовать состояние модели и вспомогательные методы HTML для проверки.

## <a name="understanding-model-state"></a>Основные сведения о состоянии модели

Вы используете состояние модели или точнее, словарь состояния модели — для представления ошибок проверки. Например, действие Create () в листинге 1 проверяет свойства класса Product перед добавлением класса Product в базу данных.

Я не рекомендую добавлять логику проверки или базы данных к контроллеру. Контроллер должен содержать только логику, связанную с управлением потоком приложения. Мы используем ярлык, чтобы не усложнять.

**Листинг 1. Контроллерс\продуктконтроллер.КС**

[!code-csharp[Main](performing-simple-validation-cs/samples/sample1.cs)]

В листинге 1 проверяются свойства Name, Description и UnitsInStock класса Product. Если какое-либо из этих свойств не проходит проверку, добавляется ошибка в словарь состояния модели (представленный свойством ModelState класса Controller).

Если в состоянии модели есть ошибки, свойство ModelState. IsValid возвращает значение false. В этом случае повторно отображается HTML-форма для создания нового продукта. В противном случае при отсутствии ошибок проверки новый продукт добавляется в базу данных.

## <a name="using-the-validation-helpers"></a>Использование вспомогательных функций проверки

Платформа ASP.NET MVC содержит два вспомогательных метода проверки: вспомогательный метод HTML. Валидатионмессаже () и HTML. ValidationSummary (). Эти два вспомогательных элемента используются в представлении для отображения сообщений об ошибках проверки.

Вспомогательные элементы HTML. Валидатионмессаже () и HTML. ValidationSummary () используются в представлениях создания и редактирования, создаваемых автоматически с помощью формирования шаблонов ASP.NET MVC. Чтобы создать представление создания, выполните следующие действия.

1. Щелкните правой кнопкой мыши действие создать () в контроллере продукта и выберите пункт меню **Добавить представление** (см. рис. 1).
2. В диалоговом окне **Добавление представления** установите флажок **создать строго типизированное представление** (см. рис. 2).
3. В раскрывающемся списке **класс представления данных** выберите класс Product.
4. В раскрывающемся списке **Просмотр содержимого** выберите Создать.
5. Нажмите кнопку **Добавить** .

Убедитесь, что сборка приложения выполняется перед добавлением представления. В противном случае список классов не будет отображаться в раскрывающемся списке **класс представления данных** .

[![диалоговом окне «Создание проекта»](performing-simple-validation-cs/_static/image1.jpg)](performing-simple-validation-cs/_static/image1.png)

**Рис. 01**. Добавление представления ([щелкните, чтобы просмотреть изображение с полным размером](performing-simple-validation-cs/_static/image2.png))

[![диалоговом окне «Создание проекта»](performing-simple-validation-cs/_static/image2.jpg)](performing-simple-validation-cs/_static/image3.png)

**Рис. 02**. Создание строго типизированного представления ([щелкните, чтобы просмотреть изображение с полным размером](performing-simple-validation-cs/_static/image4.png))

После выполнения этих действий вы получите представление Create в листинге 2.

**Листинг 2. Виевс\продукт\креате.аспкс**

[!code-aspx[Main](performing-simple-validation-cs/samples/sample2.aspx)]

В листинге 2 вспомогательный метод HTML. ValidationSummary () вызывается непосредственно над HTML-формой. Этот вспомогательный объект используется для вывода списка сообщений об ошибках проверки. Вспомогательный метод HTML. ValidationSummary () отображает ошибки в маркированном списке.

Вспомогательный метод HTML. Валидатионмессаже () вызывается рядом с каждым из полей HTML-формы. Этот вспомогательный объект используется для вывода сообщения об ошибке непосредственно рядом с полем формы. В случае листинга 2 вспомогательный объект HTML. Валидатионмессаже () отображает звездочку при возникновении ошибки.

На странице на рис. 3 показаны сообщения об ошибках, отображаемые вспомогательными службами проверки при отправке формы с отсутствующими полями и недопустимыми значениями.

[![диалоговом окне «Создание проекта»](performing-simple-validation-cs/_static/image3.jpg)](performing-simple-validation-cs/_static/image5.png)

**Рис. 03**. представление "создание", отправленное с проблемами ([щелкните, чтобы просмотреть изображение с полным размером](performing-simple-validation-cs/_static/image6.png))

Обратите внимание, что внешний вид HTML-полей ввода также изменяется при возникновении ошибки проверки. Вспомогательный объект HTML. TextBox () визуализирует атрибут *class = "input-Validation-Error"* при ошибке проверки, связанной со свойством, отображаемым вспомогательным приложением HTML. TextBox ().

Существует три класса каскадных таблиц стилей, используемых для управления внешним видом ошибок проверки.

- input-Validation-Error — применяется к &lt;входного тега&gt;, отображаемого вспомогательным приложением HTML. TextBox ().
- поле-Проверка-ошибка — применяется к тегу &lt;span&gt;, отображаемому вспомогательным приложением HTML. Валидатионмессаже ().
- Проверка-сводка-ошибки — применяются к тегу &lt;UL&gt;, отображаемому вспомогательным приложением HTML. ValidationSummary ().

Можно изменить эти классы каскадных таблиц стилей и, таким образом, изменить внешний вид ошибок проверки, изменив файл Site. CSS, расположенный в папке Content.

> [!NOTE] 
> 
> Класс HtmlHelper включает статические свойства только для чтения для получения имен связанных с проверкой классов CSS. Эти статические свойства называются Валидатионинпутксскласснаме, Валидатионфиелдксскласснаме и Валидатионсуммариксскласснаме.

## <a name="prebinding-validation-and-postbinding-validation"></a>Проверка предпривязки и проверка перепривязки

При отправке HTML-формы для создания продукта и вводе недопустимого значения поля price и отсутствия значения для поля UnitsInStock вы получите сообщения о проверке, показанные на рис. 4. Откуда берутся эти сообщения об ошибках проверки?

[![диалоговом окне «Создание проекта»](performing-simple-validation-cs/_static/image4.jpg)](performing-simple-validation-cs/_static/image7.png)

**Рис. 04**. Предварительная привязка ошибок проверки ([щелкните, чтобы просмотреть изображение с полным размером](performing-simple-validation-cs/_static/image8.png))

Фактически существует два типа сообщений об ошибках проверки — созданные до привязки полей формы HTML к классу и созданные после привязки полей формы к классу. Иными словами, возникают ошибки проверки перед связыванием и ошибки проверки привязки.

Действие Create (), предоставляемое контроллером продукта в листинге 1, принимает экземпляр класса Product. Сигнатура метода Create выглядит следующим образом:

[!code-csharp[Main](performing-simple-validation-cs/samples/sample3.cs)]

Значения полей HTML-форм из формы создания привязываются к классу Продукттокреате, который называется связывателем модели. Связыватель модели по умолчанию автоматически добавляет сообщение об ошибке в состояние модели, если не удается привязать поле формы к свойству формы.

Связыватель модели по умолчанию не может привязать строку "Apple" к свойству Price класса Product. Нельзя присвоить строку свойству Decimal. Поэтому связыватель модели добавляет ошибку в состояние модели.

Связыватель модели по умолчанию также не может присвоить значение NULL свойству, которое не принимает значения NULL. В частности, связыватель модели не может присвоить значение NULL свойству UnitsInStock. Опять же, связыватель модели предоставляет и добавляет сообщение об ошибке в состояние модели.

Если вы хотите настроить внешний вид этих сообщений об ошибках, необходимо создать строки ресурсов для этих сообщений.

## <a name="summary"></a>Сводка

Цель этого учебника — описать базовый механизм проверки в платформе ASP.NET MVC. Вы узнали, как использовать состояние модели и вспомогательные методы HTML для проверки. Кроме того, мы рассмотрели различие между проверкой подлинности и вывязкой. В других руководствах обсуждаются различные стратегии переноса кода проверки из контроллеров и в классы модели.

> [!div class="step-by-step"]
> [Назад](displaying-a-table-of-database-data-cs.md)
> [Вперед](validating-with-the-idataerrorinfo-interface-cs.md)
