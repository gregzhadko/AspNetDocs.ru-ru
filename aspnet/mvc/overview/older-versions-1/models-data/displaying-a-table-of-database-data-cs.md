---
uid: mvc/overview/older-versions-1/models-data/displaying-a-table-of-database-data-cs
title: Отображение таблицы данных базы данных (C#) | Документация Майкрософт
author: microsoft
description: В этом руководстве я продемонстрирую два метода отображения набора записей базы данных. Я покажу два метода форматирования набора записей базы данных в HTML TA...
ms.author: riande
ms.date: 10/07/2008
ms.assetid: d6e758b6-6571-484d-a132-34ee6c47747a
msc.legacyurl: /mvc/overview/older-versions-1/models-data/displaying-a-table-of-database-data-cs
msc.type: authoredcontent
ms.openlocfilehash: 3c908d030076fc8400190ef3cf1672632ac1ed6b
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78436848"
---
# <a name="displaying-a-table-of-database-data-c"></a>Отображение таблицы данных в базе данных (C#)

по [Майкрософт](https://github.com/microsoft)

[Скачать в формате PDF](https://download.microsoft.com/download/1/1/f/11f721aa-d749-4ed7-bb89-a681b68894e6/ASPNET_MVC_Tutorial_11_CS.pdf)

> В этом руководстве я продемонстрирую два метода отображения набора записей базы данных. Я покажу два метода форматирования набора записей базы данных в таблице HTML. Во-первых, я покажу, как можно отформатировать записи базы данных непосредственно в представлении. Далее я продемонстрирую, как можно воспользоваться частичными возможностями при форматировании записей базы данных.

Цель этого руководства — объяснить, как можно отобразить HTML-таблицу данных базы данных в приложении ASP.NET MVC. Во-первых, вы узнаете, как использовать средства формирования шаблонов, входящие в Visual Studio, для создания представления, которое автоматически отображает набор записей. Далее вы узнаете, как использовать частичный шаблон в качестве шаблона при форматировании записей базы данных.

## <a name="create-the-model-classes"></a>Создание классов модели

Будет отображен набор записей из таблицы базы данных фильмов. Таблица фильмов базы данных содержит следующие столбцы.

<a id="0.3_table01"></a>

| **Имя столбца** | **Тип данных** | **Разрешить значения NULL** |
| --- | --- | --- |
| Идентификатор | Int | False |
| Title | Nvarchar (200) | False |
| Директор | NVarchar (50) | False |
| датерелеасед | Дата и время | False |

Чтобы представить таблицу movies в нашем приложении MVC ASP.NET, необходимо создать класс Model. В этом руководстве мы используем Entity Framework Майкрософт для создания наших классов модели.

> [!NOTE] 
> 
> В этом руководстве мы используем Entity Framework Майкрософт. Однако важно понимать, что для взаимодействия с базой данных из приложения ASP.NET MVC, в том числе LINQ to SQL, NHibernate или ADO.NET, можно использовать различные технологии.

Выполните следующие действия, чтобы запустить мастер EDM.

1. Щелкните правой кнопкой мыши папку модели в окне обозреватель решений и выберите пункт меню **Добавить, новый элемент**.
2. Выберите категорию **данных** и выберите шаблон **EDM ADO.NET** .
3. Присвойте модели данных имя *мовиесдбмодел. EDMX* и нажмите кнопку **Добавить** .

После нажатия кнопки "Добавить" появится мастер EDM (см. рис. 1). Чтобы завершить работу мастера, выполните следующие действия.

1. На шаге **Выбор содержимого модели** выберите параметр **создать из базы данных** .
2. На шаге **Выбор подключения к данным** используйте подключение к данным *мовиесдб. mdf* и имя *мовиесдбентитиес* для параметров подключения. Нажмите кнопку **Далее**.
3. На шаге **Выбор объектов базы данных** разверните узел таблицы и выберите таблицу фильмы. Введите *модели* пространства имен и нажмите кнопку **Готово** .

[![создания классов LINQ to SQL](displaying-a-table-of-database-data-cs/_static/image1.jpg)](displaying-a-table-of-database-data-cs/_static/image1.png)

**Рис. 01**. Создание LINQ to SQL классов ([щелкните, чтобы просмотреть изображение с полным размером](displaying-a-table-of-database-data-cs/_static/image2.png))

После завершения работы мастера EDM откроется конструктор EDM. Конструктор должен отображать сущность «фильмы» (см. рис. 2).

[![конструктора EDM](displaying-a-table-of-database-data-cs/_static/image2.jpg)](displaying-a-table-of-database-data-cs/_static/image3.png)

**Рис. 02**. конструктор EDM ([щелкните, чтобы просмотреть изображение с полным размером](displaying-a-table-of-database-data-cs/_static/image4.png))

Прежде чем продолжить, необходимо внести одно изменение. Мастер сущностей данных создает класс модели с именем *Movies* , который представляет таблицу базы данных фильмов. Так как мы будем использовать класс Movies для представления конкретного фильма, нам нужно изменить имя класса на *Movie* вместо *фильмов* (единственное, а не множественное число).

Дважды щелкните имя класса в области конструктора и измените имя класса с кино на Movie. После внесения этого изменения нажмите кнопку **сохранить** (значок гибкого диска), чтобы создать класс Movie.

## <a name="create-the-movies-controller"></a>Создание контроллера фильмов

Теперь, когда у нас есть способ представления записей базы данных, можно создать контроллер, возвращающий коллекцию фильмов. В окне обозреватель решений Visual Studio щелкните правой кнопкой мыши папку Controllers и выберите пункт меню **Добавить, контроллер** (см. рис. 3).

[![меню добавления контроллера](displaying-a-table-of-database-data-cs/_static/image3.jpg)](displaying-a-table-of-database-data-cs/_static/image5.png)

**Рис. 03**. меню "добавить контроллер" ([щелкните, чтобы просмотреть изображение с полным размером](displaying-a-table-of-database-data-cs/_static/image6.png))

Когда появится диалоговое окно **Добавление контроллера** , введите имя контроллера мовиеконтроллер (см. рис. 4). Нажмите кнопку **Добавить** , чтобы добавить новый контроллер.

[![диалогового окна "Добавление контроллера"](displaying-a-table-of-database-data-cs/_static/image4.jpg)](displaying-a-table-of-database-data-cs/_static/image7.png)

**Рис. 04**. диалоговое окно добавления контроллера ([щелкните, чтобы просмотреть изображение с полным размером](displaying-a-table-of-database-data-cs/_static/image8.png))

Необходимо изменить действие index (), предоставляемое контроллером Movie, чтобы он возвращал набор записей базы данных. Измените контроллер, чтобы он выглядел как контроллер в листинге 1.

**Листинг 1 — Контроллерс\мовиеконтроллер.КС**

[!code-csharp[Main](displaying-a-table-of-database-data-cs/samples/sample1.cs)]

В листинге 1 класс Мовиесдбентитиес используется для представления базы данных Мовиесдб. Чтобы использовать этот класс, необходимо импортировать пространство имен MvcApplication1. Models следующим образом:

Использование MvcApplication1. Models;

Сущности выражений *. Movie. ToList ()* возвращает набор всех фильмов из таблицы базы данных фильмов.

## <a name="create-the-view"></a>Создание представления

Самый простой способ отобразить набор записей базы данных в таблице HTML — воспользоваться преимуществами шаблонов, предоставляемыми Visual Studio.

Создайте приложение, выбрав пункт меню **Сборка, построить решение**. Необходимо построить приложение перед открытием диалогового окна **Добавление представления** , иначе классы данных не будут отображаться в диалоговом окне.

Щелкните правой кнопкой мыши действие индекс () и выберите пункт меню **Добавить представление** (см. рис. 5).

[![Добавление представления](displaying-a-table-of-database-data-cs/_static/image5.jpg)](displaying-a-table-of-database-data-cs/_static/image9.png)

**Рис. 05**. Добавление представления ([щелкните, чтобы просмотреть изображение с полным размером](displaying-a-table-of-database-data-cs/_static/image10.png))

В диалоговом окне **Добавление представления** установите флажок **создать строго типизированное представление**. Выберите класс Movie в качестве **класса данных View**. Выберите *список* в качестве **содержимого представления** (см. рис. 6). При выборе этих параметров создается строго типизированное представление, в котором отображается список фильмов.

[![диалогового окна добавления представления](displaying-a-table-of-database-data-cs/_static/image6.jpg)](displaying-a-table-of-database-data-cs/_static/image11.png)

**Рис. 06**. диалоговое окно добавления представления ([щелкните, чтобы просмотреть изображение с полным размером](displaying-a-table-of-database-data-cs/_static/image12.png))

После нажатия кнопки **Добавить** представление в листинге 2 создается автоматически. Это представление содержит код, необходимый для прохода по коллекции фильмов и отображения каждого из свойств фильма.

**Листинг 2 — Виевс\мовие\индекс.аспкс**

[!code-aspx[Main](displaying-a-table-of-database-data-cs/samples/sample2.aspx)]

Приложение можно запустить, выбрав пункт меню **Отладка, начать отладку** (или нажав клавишу F5). При запуске приложения запускается Internet Explorer. При переходе по URL-адресу/Мовие вы увидите страницу на рис. 7.

[![таблицы фильмов](displaying-a-table-of-database-data-cs/_static/image7.jpg)](displaying-a-table-of-database-data-cs/_static/image13.png)

**Рис. 07**. Таблица фильмов ([щелкните, чтобы просмотреть изображение с полным размером](displaying-a-table-of-database-data-cs/_static/image14.png))

Если вы не хотите ничего делать с видом сетки записей базы данных на рис. 7, можно просто изменить представление индекса. Например, можно изменить заголовок *датерелеасед* на *Дата выпуска* , изменив представление индекса.

## <a name="create-a-template-with-a-partial"></a>Создание шаблона с частичным

Когда представление становится слишком сложным, рекомендуется начать разбить представление на части. Использование частичных средств облегчает понимание и обслуживание представлений. Мы создадим частичный, который можно использовать в качестве шаблона для форматирования каждой записи базы данных фильмов.

Чтобы создать частичную часть, выполните следующие действия.

1. Щелкните правой кнопкой мыши папку Виевс\мовие и выберите пункт меню **Добавить представление**.
2. Установите флажок *создать частичное представление (ASCX)* .
3. Назовите разделяемый *мовиетемплате*.
4. Установите флажок **создать строго типизированное представление**.
5. Выберите Movie в качестве *класса данных View*.
6. В качестве *содержимого представления*выберите пустое.
7. Нажмите кнопку **Добавить** , чтобы добавить частичную подразделение в проект.

После выполнения этих действий измените Мовиетемплате partial, чтобы он выглядел как листинг 3.

**Листинг 3 — Виевс\мовие\мовиетемплате.асккс**

[!code-aspx[Main](displaying-a-table-of-database-data-cs/samples/sample3.aspx)]

Часть в листинге 3 содержит шаблон для одной строки записей.

Измененное представление индекса в листинге 4 использует Мовиетемплате partial.

**Листинг 4 — Виевс\мовие\индекс.аспкс**

[!code-aspx[Main](displaying-a-table-of-database-data-cs/samples/sample4.aspx)]

Представление в листинге 4 содержит цикл foreach, который выполняет итерацию по всем фильмам. Для каждого фильма Мовиетемплате частично используется для форматирования фильма. Мовиетемплате отображается путем вызова вспомогательного метода Рендерпартиал ().

Измененное представление индекса отображает очень ту же таблицу HTML записей базы данных. Однако представление было значительно упрощено.

Метод Рендерпартиал () отличается от большинства других вспомогательных методов, поскольку он не возвращает строку. Поэтому необходимо вызвать метод Рендерпартиал () с помощью &lt;% HTML. Рендерпартиал (); %&gt; вместо &lt;% = HTML. Рендерпартиал (); %&gt;.

## <a name="summary"></a>Сводка

Цель этого учебника — объяснить, как можно отобразить набор записей базы данных в таблице HTML. Во-первых, вы узнали, как вернуть набор записей базы данных из действия контроллера, используя преимущества Microsoft Entity Framework. Далее вы узнали, как использовать формирование шаблонов Visual Studio для создания представления, которое автоматически отображает коллекцию элементов. Наконец, вы узнали, как упростить представление, используя преимущества частичного представления. Вы узнали, как использовать partial в качестве шаблона, чтобы можно было отформатировать каждую запись базы данных.

> [!div class="step-by-step"]
> [Назад](creating-model-classes-with-linq-to-sql-cs.md)
> [Вперед](performing-simple-validation-cs.md)
