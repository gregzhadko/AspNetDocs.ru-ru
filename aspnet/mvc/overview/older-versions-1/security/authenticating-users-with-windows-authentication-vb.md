---
uid: mvc/overview/older-versions-1/security/authenticating-users-with-windows-authentication-vb
title: Аутентификация пользователей с помощью проверки подлинности Windows (VB) | Документация Майкрософт
author: microsoft
description: Узнайте, как использовать проверку подлинности Windows в контексте приложения MVC. Вы узнаете, как включить проверку подлинности Windows в веб-приложении Co...
ms.author: riande
ms.date: 01/27/2009
ms.assetid: 532fa051-7d5c-4d6d-87f6-339ce4b84c44
msc.legacyurl: /mvc/overview/older-versions-1/security/authenticating-users-with-windows-authentication-vb
msc.type: authoredcontent
ms.openlocfilehash: aa64b1f9ef6461a81611ca066310dca2d545baa3
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78506244"
---
# <a name="authenticating-users-with-windows-authentication-vb"></a>Проверка подлинности пользователей с помощью проверки подлинности Windows (VB)

по [Майкрософт](https://github.com/microsoft)

> Узнайте, как использовать проверку подлинности Windows в контексте приложения MVC. Вы узнаете, как включить проверку подлинности Windows в файле веб-конфигурации приложения и как настроить проверку подлинности с помощью служб IIS. Наконец, вы узнаете, как использовать атрибут [авторизовать] для ограничения доступа к действиям контроллера определенным пользователям или группам Windows.

Цель этого учебника — объяснить, как можно воспользоваться преимуществами функций безопасности, встроенных в службы IIS, для защиты представлений в приложениях MVC. Вы узнаете, как разрешить вызов действий контроллера только определенными пользователями Windows или пользователями, входящими в определенные группы Windows.

Проверка подлинности Windows имеет смысл, если вы создаете веб-сайт внутренней компании (сайт интрасети) и хотите, чтобы пользователи могли использовать стандартные имена пользователей Windows и пароли при доступе к веб-сайту. Если вы создаете веб-сайт с повышенным доступом (веб-сайт), вместо этого рекомендуется использовать проверку подлинности с помощью форм.

#### <a name="enabling-windows-authentication"></a>Включение проверки подлинности Windows

При создании нового приложения ASP.NET MVC проверка подлинности Windows не включена по умолчанию. Проверка подлинности по формам — это тип проверки подлинности по умолчанию для приложений MVC. Необходимо включить проверку подлинности Windows, изменив файл конфигурации веб-приложения MVC (Web. config). Найдите раздел&gt; проверки подлинности &lt;и измените его, чтобы использовать Windows вместо проверки подлинности с помощью форм следующим образом:

[!code-xml[Main](authenticating-users-with-windows-authentication-vb/samples/sample1.xml)]

При включении проверки подлинности Windows веб-сервер будет отвечать за проверку подлинности пользователей. Как правило, существует два разных типа веб-серверов, которые используются при создании и развертывании приложения ASP.NET MVC.

Во-первых, при разработке приложения MVC вы используете ASP.NET Development Web Server, входящий в состав Visual Studio. По умолчанию веб-сервер разработки ASP.NET выполняет все страницы в контексте текущей учетной записи Windows (любая учетная запись, используемая для входа в Windows).

Веб-сервер разработки ASP.NET также поддерживает проверку подлинности NTLM. Вы можете включить проверку подлинности NTLM, щелкнув правой кнопкой мыши имя проекта в окне обозреватель решений и выбрав пункт Свойства. Затем перейдите на вкладку веб и установите флажок NTLM (см. рис. 1).

**Рис. 1. Включение проверки подлинности NTLM для веб-сервера разработки ASP.NET**

![clip_image002](authenticating-users-with-windows-authentication-vb/_static/image1.jpg)

Для рабочего веб-приложения в качестве веб-сервера используются службы IIS. Службы IIS поддерживают несколько типов проверки подлинности, в том числе:

- Обычная проверка подлинности — определяется как часть протокола HTTP 1,0. Отправляет имена пользователей и пароли в виде открытого текста (в кодировке Base64) через Интернет. — Дайджест-проверка подлинности — отправляет хэш пароля вместо самого пароля через Интернет. — Встроенная проверка подлинности Windows (NTLM) — лучший тип проверки подлинности, используемый в средах интрасети, использующих Windows. — Проверка подлинности на основе сертификата — включает проверку подлинности с помощью клиентского сертификата. Сертификат сопоставляется с учетной записью пользователя Windows.

> [!NOTE] 
> 
> Более подробные сведения о различных типах проверки подлинности см. в разделе [https://msdn.microsoft.com/library/aa292114(VS.71).aspx](https://msdn.microsoft.com/library/aa292114(VS.71).aspx).

Для включения определенного типа проверки подлинности можно использовать диспетчер службы IIS. Имейте в виду, что все типы проверки подлинности недоступны в случае каждой операционной системы. Кроме того, при использовании IIS 7,0 с Windows Vista необходимо включить различные типы проверки подлинности Windows, прежде чем они появятся в диспетчере службы IIS. Откройте **Панель управления, программы, программы и компоненты, включите или отключите компоненты Windows**и разверните узел службы IIS (см. рис. 2).

**Рис. 2. Включение компонентов Windows IIS**

![clip_image004](authenticating-users-with-windows-authentication-vb/_static/image2.jpg)

С помощью службы IIS можно включить или отключить различные типы проверки подлинности. Например, на рис. 3 показано, как отключить анонимную проверку подлинности и включить встроенную проверку подлинности Windows (NTLM) при использовании IIS 7,0.

**Рис. 3. Включение встроенной проверки подлинности Windows**

![clip_image006](authenticating-users-with-windows-authentication-vb/_static/image3.jpg)

#### <a name="authorizing-windows-users-and-groups"></a>Авторизация пользователей и групп Windows

После включения проверки подлинности Windows можно использовать атрибут &lt;авторизовать&gt; для управления доступом к контроллерам или действиям контроллера. Этот атрибут может применяться ко всему контроллеру MVC или к конкретному действию контроллера.

Например, контроллер Home в листинге 1 предоставляет три действия с именами index (), Компанисекретс () и Стефенсекретс (). Любой пользователь может вызвать действие index (). Однако только члены группы локальных руководителей Windows могут вызывать действие Компанисекретс (). Наконец, только пользователь домена Windows с именем Стивен (в домене Redmond) может вызвать действие Стефенсекретс ().

**Листинг 1 — Контроллерс\хомеконтроллер.ВБ**

[!code-vb[Main](authenticating-users-with-windows-authentication-vb/samples/sample2.vb)]

> [!NOTE]
> Из-за контроля учетных записей Windows (UAC) при работе с Windows Vista или Windows Server 2008 локальная группа администраторов работает иначе, чем другие группы. Атрибут &lt;авторизовать&gt; не сможет правильно распознать члена локальной группы администраторов, если не изменить параметры UAC компьютера.

Именно то, что происходит при попытке вызвать действие контроллера без прав доступа, зависит от типа включенной проверки подлинности. По умолчанию при использовании ASP.NET Development Server просто появляется пустая страница. Страница обслуживается с состоянием HTTP-ответа, **не прошедшим авторизацию 401** .

С другой стороны, если вы используете службы IIS с отключенной анонимной проверкой подлинности и включена обычная проверка подлинности, то при каждом запросе защищенной страницы вы продолжаете выводить диалоговое окно входа (см. рис. 4).

**Рис. 4. диалоговое окно входа с обычной аутентификацией**

![clip_image008](authenticating-users-with-windows-authentication-vb/_static/image4.jpg)

#### <a name="summary"></a>Сводка

В этом руководстве описано, как использовать проверку подлинности Windows в контексте приложения ASP.NET MVC. Вы узнали, как включить проверку подлинности Windows в файле веб-конфигурации приложения и как настроить проверку подлинности с помощью служб IIS. Наконец, вы узнали, как использовать атрибут &lt;авторизовать&gt;, чтобы ограничить доступ к действиям контроллера определенным пользователям или группам Windows.

> [!div class="step-by-step"]
> [Назад](authenticating-users-with-forms-authentication-vb.md)
> [Вперед](preventing-javascript-injection-attacks-vb.md)
