---
uid: mvc/overview/older-versions-1/security/authenticating-users-with-forms-authentication-vb
title: Аутентификация пользователей с помощью аутентификации форм (VB) Документы Майкрософт
author: rick-anderson
description: Узнайте, как использовать атрибут «Авторизовать» для защиты паролем в приложении MVC. Вы узнаете, как использовать администрацию веб-сайта слишком ...
ms.author: riande
ms.date: 01/27/2009
ms.assetid: 4341f5b1-6fe5-44c5-8b8a-18fa84f80177
msc.legacyurl: /mvc/overview/older-versions-1/security/authenticating-users-with-forms-authentication-vb
msc.type: authoredcontent
ms.openlocfilehash: 9e3117af55db2effed20b6421c2322f1c265f1c7
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2020
ms.locfileid: "81540822"
---
# <a name="authenticating-users-with-forms-authentication-vb"></a><span data-ttu-id="f73e2-104">Проверка подлинности пользователей с помощью проверки подлинности на основе форм (VB)</span><span class="sxs-lookup"><span data-stu-id="f73e2-104">Authenticating Users with Forms Authentication (VB)</span></span>

<span data-ttu-id="f73e2-105">[корпорацией Майкрософт](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="f73e2-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="f73e2-106">Узнайте, как использовать атрибут «Авторизовать» для защиты паролем в приложении MVC.</span><span class="sxs-lookup"><span data-stu-id="f73e2-106">Learn how to use the [Authorize] attribute to password protect particular pages in your MVC application.</span></span> <span data-ttu-id="f73e2-107">Вы узнаете, как использовать инструмент администрирования веб-узла для создания и управления пользователями и ролями.</span><span class="sxs-lookup"><span data-stu-id="f73e2-107">You learn how to use the Web Site Administration Tool to create and manage users and roles.</span></span> <span data-ttu-id="f73e2-108">Вы также узнаете, как настроить, где хранится учетная запись пользователя и информация о роли.</span><span class="sxs-lookup"><span data-stu-id="f73e2-108">You also learn how to configure where user account and role information is stored.</span></span>

<span data-ttu-id="f73e2-109">Цель этого руководства состоит в том, чтобы объяснить, как можно использовать проверку подлинности Forms для защиты паролем в ASP.NET приложениях MVC.</span><span class="sxs-lookup"><span data-stu-id="f73e2-109">The goal of this tutorial is to explain how you can use Forms authentication to password protect the views in your ASP.NET MVC applications.</span></span> <span data-ttu-id="f73e2-110">Вы узнаете, как использовать инструмент администрирования веб-узла для создания пользователей и ролей.</span><span class="sxs-lookup"><span data-stu-id="f73e2-110">You learn how to use the Web Site Administration Tool to create users and roles.</span></span> <span data-ttu-id="f73e2-111">Вы также узнаете, как предотвратить несанкционированные пользователи от вызывая действия контроллера.</span><span class="sxs-lookup"><span data-stu-id="f73e2-111">You also learn how to prevent unauthorized users from invoking controller actions.</span></span> <span data-ttu-id="f73e2-112">Наконец, вы узнаете, как настроить, где хранятся имена пользователей и пароли.</span><span class="sxs-lookup"><span data-stu-id="f73e2-112">Finally, you learn how to configure where user names and passwords are stored.</span></span>

#### <a name="using-the-web-site-administration-tool"></a><span data-ttu-id="f73e2-113">Использование инструмента администрирования веб-сайта</span><span class="sxs-lookup"><span data-stu-id="f73e2-113">Using the Web Site Administration Tool</span></span>

<span data-ttu-id="f73e2-114">Прежде чем делать что-либо еще, мы должны начать с создания некоторых пользователей и ролей.</span><span class="sxs-lookup"><span data-stu-id="f73e2-114">Before we do anything else, we should start by creating some users and roles.</span></span> <span data-ttu-id="f73e2-115">Самый простой способ создания новых пользователей и ролей, чтобы воспользоваться Visual Studio 2008 Веб-сайт администрации инструмента.</span><span class="sxs-lookup"><span data-stu-id="f73e2-115">The easiest way to create new users and roles is to take advantage of the Visual Studio 2008 Web Site Administration Tool.</span></span> <span data-ttu-id="f73e2-116">Вы можете запустить этот инструмент, выбрав вариант меню **Project, ASP.NET Configuration.**</span><span class="sxs-lookup"><span data-stu-id="f73e2-116">You can launch this tool by selecting the menu option **Project, ASP.NET Configuration**.</span></span> <span data-ttu-id="f73e2-117">Кроме того, вы можете запустить инструмент администрации веб-сайта, нажав на (несколько страшно) значок молотка удара мира, который появляется в верхней части окна Solution Explorer (см. Рисунок 1).</span><span class="sxs-lookup"><span data-stu-id="f73e2-117">Alternatively, you can launch the Web Site Administration Tool by clicking the (somewhat scary) icon of the hammer hitting the world that appears at the top of the Solution Explorer window (see Figure 1).</span></span>

<span data-ttu-id="f73e2-118">**Рисунок 1 - Запуск инструмента администрирования веб-сайта**</span><span class="sxs-lookup"><span data-stu-id="f73e2-118">**Figure 1 – Launching the Web Site Administration Tool**</span></span>

![clip_image002](authenticating-users-with-forms-authentication-vb/_static/image1.jpg)

<span data-ttu-id="f73e2-120">В инструменте администрации веб-узла вы создаете новых пользователей и роли, выбирая вкладку безопасности. Нажмите на ссылку **пользователя Create** для создания нового пользователя по имени Стивен (см. рисунок 2).</span><span class="sxs-lookup"><span data-stu-id="f73e2-120">Within the Web Site Administration Tool, you create new users and roles by selecting the Security tab. Click the **Create user** link to create a new user named Stephen (see Figure 2).</span></span> <span data-ttu-id="f73e2-121">Предоставьте пользователю Stephen любой пароль, который вы хотите (например, *секрет).*</span><span class="sxs-lookup"><span data-stu-id="f73e2-121">Provide the Stephen user with any password that you want (for example, *secret*).</span></span>

<span data-ttu-id="f73e2-122">**Рисунок 2 - Создание нового пользователя**</span><span class="sxs-lookup"><span data-stu-id="f73e2-122">**Figure 2 – Creating a new user**</span></span>

![clip_image004](authenticating-users-with-forms-authentication-vb/_static/image2.jpg)

<span data-ttu-id="f73e2-124">Вы создаете новые роли, сначала включив роли и определив одну или несколько ролей.</span><span class="sxs-lookup"><span data-stu-id="f73e2-124">You create new roles by first enabling roles and defining one or more roles.</span></span> <span data-ttu-id="f73e2-125">Включить роли, нажав на ссылку **ролей Включить.**</span><span class="sxs-lookup"><span data-stu-id="f73e2-125">Enable roles by clicking the **Enable roles** link.</span></span> <span data-ttu-id="f73e2-126">Затем создайте роль, названную *Администраторами,* нажав ссылку **на роли «Создать или управлять»** (см. рисунок 3).</span><span class="sxs-lookup"><span data-stu-id="f73e2-126">Next, create a role named *Administrators* by clicking the **Create or Manage roles** link (see Figure 3).</span></span>

<span data-ttu-id="f73e2-127">**Рисунок 3 - Создание новой роли**</span><span class="sxs-lookup"><span data-stu-id="f73e2-127">**Figure 3 – Creating a new role**</span></span>

![clip_image006](authenticating-users-with-forms-authentication-vb/_static/image3.jpg)

<span data-ttu-id="f73e2-129">Наконец, создайте нового пользователя по имени Салли и свяжите Салли с ролью администраторов, нажав на ссылку Create User и выбрав администраторов при создании Салли (см. рисунок 4).</span><span class="sxs-lookup"><span data-stu-id="f73e2-129">Finally, create a new user named Sally and associate Sally with the Administrators role by clicking the Create User link and selecting Administrators when creating Sally (see Figure 4).</span></span>

<span data-ttu-id="f73e2-130">**Рисунок 4 - Добавление пользователя к роли**</span><span class="sxs-lookup"><span data-stu-id="f73e2-130">**Figure 4 – Adding a user to a role**</span></span>

![clip_image008](authenticating-users-with-forms-authentication-vb/_static/image4.jpg)

<span data-ttu-id="f73e2-132">Когда все сказано и сделано, вы должны иметь два новых пользователей по имени Стивен и Салли.</span><span class="sxs-lookup"><span data-stu-id="f73e2-132">When all is said and done, you should have two new users named Stephen and Sally.</span></span> <span data-ttu-id="f73e2-133">Вы также должны иметь новую роль под названием Администраторы.</span><span class="sxs-lookup"><span data-stu-id="f73e2-133">You should also have a new role named Administrators.</span></span> <span data-ttu-id="f73e2-134">Салли является членом роли администраторов и Стивен не является.</span><span class="sxs-lookup"><span data-stu-id="f73e2-134">Sally is a member of the Administrators role and Stephen is not.</span></span>

#### <a name="requiring-authorization"></a><span data-ttu-id="f73e2-135">Требование авторизации</span><span class="sxs-lookup"><span data-stu-id="f73e2-135">Requiring Authorization</span></span>

<span data-ttu-id="f73e2-136">Вы можете потребовать, чтобы пользователь был проверен до того, как пользователь выссылает действие контроллера, добавляя атрибут «Авторизовать» в действие.</span><span class="sxs-lookup"><span data-stu-id="f73e2-136">You can require a user to be authenticated before the user invokes a controller action by adding the [Authorize] attribute to the action.</span></span> <span data-ttu-id="f73e2-137">Вы можете применить атрибут «Authorize» к индивидуальному действию контроллера или применить этот атрибут ко всему классу контроллера.</span><span class="sxs-lookup"><span data-stu-id="f73e2-137">You can apply the [Authorize] attribute to an individual controller action or you can apply this attribute to an entire controller class.</span></span>

<span data-ttu-id="f73e2-138">Например, контроллер в листинге 1 предоставляет действие под названием CompanySecrets().</span><span class="sxs-lookup"><span data-stu-id="f73e2-138">For example, the controller in Listing 1 exposes an action named CompanySecrets().</span></span> <span data-ttu-id="f73e2-139">Поскольку это действие украшено атрибутом «Authorize», это действие не может быть вызвано, если пользователь не проверен.</span><span class="sxs-lookup"><span data-stu-id="f73e2-139">Because this action is decorated with the [Authorize] attribute, this action cannot be invoked unless a user is authenticated.</span></span>

<span data-ttu-id="f73e2-140">**Список 1 - Контролеры**</span><span class="sxs-lookup"><span data-stu-id="f73e2-140">**Listing 1 – Controllers\HomeController.vb**</span></span>

[!code-vb[Main](authenticating-users-with-forms-authentication-vb/samples/sample1.vb)]

<span data-ttu-id="f73e2-141">Если вы вызываете действие CompanySecrets() путем ввода URL /Home/CompanySecrets в адресной строке вашего браузера, и вы не являетесь аутентифицированным пользователем, то вы будете перенаправлены на представление входа автоматически (см. рисунок 5).</span><span class="sxs-lookup"><span data-stu-id="f73e2-141">If you invoke the CompanySecrets() action by entering the URL /Home/CompanySecrets in the address bar of your browser, and you are not an authenticated user, then you will be redirected to the Login view automatically (see Figure 5).</span></span>

<span data-ttu-id="f73e2-142">**Рисунок 5 - Вид входа**</span><span class="sxs-lookup"><span data-stu-id="f73e2-142">**Figure 5 – The Login view**</span></span>

![clip_image010](authenticating-users-with-forms-authentication-vb/_static/image5.jpg)

<span data-ttu-id="f73e2-144">Вы можете использовать представление Login для ввода имени пользователя и пароля.</span><span class="sxs-lookup"><span data-stu-id="f73e2-144">You can use the Login view to enter your user name and password.</span></span> <span data-ttu-id="f73e2-145">Если вы не являетесь зарегистрированным пользователем, то вы можете нажать на ссылку **регистра** для навигации по представлению Регистра (см. рисунок 6).</span><span class="sxs-lookup"><span data-stu-id="f73e2-145">If you are not a registered user then you can click the **register** link to navigate to the Register view (see Figure 6).</span></span> <span data-ttu-id="f73e2-146">Для создания новой учетной записи пользователя можно использовать представление Регистра.</span><span class="sxs-lookup"><span data-stu-id="f73e2-146">You can use the Register view to create a new user account.</span></span>

<span data-ttu-id="f73e2-147">**Рисунок 6 - Представление Регистра**</span><span class="sxs-lookup"><span data-stu-id="f73e2-147">**Figure 6 – The Register view**</span></span>

![clip_image012](authenticating-users-with-forms-authentication-vb/_static/image6.jpg)

<span data-ttu-id="f73e2-149">После успешного входа в систему можно увидеть представление CompanySecrets (см. рисунок 7).</span><span class="sxs-lookup"><span data-stu-id="f73e2-149">After you successfully log in, you can see the CompanySecrets view (see Figure 7).</span></span> <span data-ttu-id="f73e2-150">По умолчанию вы будете продолжать входить в систему до тех пор, пока не закроете окно браузера.</span><span class="sxs-lookup"><span data-stu-id="f73e2-150">By default, you will continue to be logged in until you close your browser window.</span></span>

<span data-ttu-id="f73e2-151">**Рисунок 7 - Представление CompanySecrets**</span><span class="sxs-lookup"><span data-stu-id="f73e2-151">**Figure 7 – The CompanySecrets view**</span></span>

![clip_image014](authenticating-users-with-forms-authentication-vb/_static/image7.jpg)

#### <a name="authorizing-by-user-name-or-user-role"></a><span data-ttu-id="f73e2-153">Авторизация по имени пользователя или роли пользователя</span><span class="sxs-lookup"><span data-stu-id="f73e2-153">Authorizing by User Name or User Role</span></span>

<span data-ttu-id="f73e2-154">Вы можете использовать атрибут «Authorize», чтобы ограничить доступ к действию контроллера определенному набору пользователей или определенному набору ролей пользователей.</span><span class="sxs-lookup"><span data-stu-id="f73e2-154">You can use the [Authorize] attribute to restrict access to a controller action to a particular set of users or a particular set of user roles.</span></span> <span data-ttu-id="f73e2-155">Например, модифицированный контроллер Home в листинге 2 содержит два новых действия под названием StephenSecrets() и AdministratorSecrets().</span><span class="sxs-lookup"><span data-stu-id="f73e2-155">For example, the modified Home controller in Listing 2 contains two new actions named StephenSecrets() and AdministratorSecrets().</span></span>

<span data-ttu-id="f73e2-156">**Список 2 - Контролеры»HomeController.vb**</span><span class="sxs-lookup"><span data-stu-id="f73e2-156">**Listing 2 – Controllers\HomeController.vb**</span></span>

[!code-vb[Main](authenticating-users-with-forms-authentication-vb/samples/sample2.vb)]

<span data-ttu-id="f73e2-157">Только пользователь с именем пользователя Стивен может вызвать действие StephenSecrets ()</span><span class="sxs-lookup"><span data-stu-id="f73e2-157">Only a user with the user name Stephen can invoke the StephenSecrets() action.</span></span> <span data-ttu-id="f73e2-158">Все остальные пользователи перенаправляются на представление входа.</span><span class="sxs-lookup"><span data-stu-id="f73e2-158">All other users get redirected to the Login view.</span></span> <span data-ttu-id="f73e2-159">Свойство пользователей принимает запятую разделенный список имен учетных записей пользователя.</span><span class="sxs-lookup"><span data-stu-id="f73e2-159">The Users property accepts a comma separated list of user account names.</span></span>

<span data-ttu-id="f73e2-160">Только пользователи в роли Администратора могут вызывать действия AdministratorSecrets()</span><span class="sxs-lookup"><span data-stu-id="f73e2-160">Only users in the Administrators role can invoke the AdministratorSecrets() action.</span></span> <span data-ttu-id="f73e2-161">Например, поскольку Салли является членом группы администраторов, она может вызвать действие AdministratorSecrets() .</span><span class="sxs-lookup"><span data-stu-id="f73e2-161">For example, because Sally is a member of the Administrators group, she can invoke the AdministratorSecrets() action.</span></span> <span data-ttu-id="f73e2-162">Все остальные пользователи перенаправляются на представление входа.</span><span class="sxs-lookup"><span data-stu-id="f73e2-162">All other users get redirected to the Login view.</span></span> <span data-ttu-id="f73e2-163">Свойство Роли принимает запятый разделенный список имен ролей.</span><span class="sxs-lookup"><span data-stu-id="f73e2-163">The Roles property accepts a comma separated list of role names.</span></span>

#### <a name="configuring-authentication"></a><span data-ttu-id="f73e2-164">Настройка аутентификации</span><span class="sxs-lookup"><span data-stu-id="f73e2-164">Configuring Authentication</span></span>

<span data-ttu-id="f73e2-165">На этом этапе может возникнуть вопрос о том, где хранится учетная запись пользователя и информация о роли.</span><span class="sxs-lookup"><span data-stu-id="f73e2-165">At this point, you might be wondering where the user account and role information is being stored.</span></span> <span data-ttu-id="f73e2-166">По умолчанию информация хранится в базе данных ASPNETDB.mdf( которая хранится в\_папке App Data вашего приложения MVC.</span><span class="sxs-lookup"><span data-stu-id="f73e2-166">By default, the information is stored in a (RANU) SQL Express database named ASPNETDB.mdf located in your MVC application's App\_Data folder.</span></span> <span data-ttu-id="f73e2-167">Эта база данных генерируется ASP.NET инфраструктурой автоматически, когда вы начинаете использовать членство.</span><span class="sxs-lookup"><span data-stu-id="f73e2-167">This database is generated by the ASP.NET framework automatically when you start using membership.</span></span>

<span data-ttu-id="f73e2-168">Для того, чтобы увидеть базу данных ASPNETDB.mdf в окне Solution Explorer, сначала необходимо выбрать вариант меню Project, показать все файлы.</span><span class="sxs-lookup"><span data-stu-id="f73e2-168">In order to see the ASPNETDB.mdf database in the Solution Explorer window, you first need to select the menu option Project, Show All Files.</span></span>

<span data-ttu-id="f73e2-169">При разработке приложения использование базы данных по умолчанию s-L Express является прекрасным.</span><span class="sxs-lookup"><span data-stu-id="f73e2-169">Using the default SQL Express database is fine when developing an application.</span></span> <span data-ttu-id="f73e2-170">Однако, скорее всего, вы не захотите использовать базу данных ASPNETDB.mdf по умолчанию для производственного приложения.</span><span class="sxs-lookup"><span data-stu-id="f73e2-170">Most likely, however, you won't want to use the default ASPNETDB.mdf database for a production application.</span></span> <span data-ttu-id="f73e2-171">В этом случае вы можете изменить, где хранится информация об учетной записи пользователя, выполнив следующие два шага:</span><span class="sxs-lookup"><span data-stu-id="f73e2-171">In that case, you can change where user account information is stored by completing the following two steps:</span></span>

1. <span data-ttu-id="f73e2-172">Добавление объектов базы данных служб приложений в базу данных производства - Изменение строки подключения приложения, чтобы указать на производственную базу данных</span><span class="sxs-lookup"><span data-stu-id="f73e2-172">Add the Application Services database objects to your production database - Change your application connection string to point to your production database</span></span>

<span data-ttu-id="f73e2-173">Первым шагом является добавление всех необходимых объектов базы данных (таблиц и сохраненных процедур) в производственную базу данных.</span><span class="sxs-lookup"><span data-stu-id="f73e2-173">The first step is to add all of the necessary database objects (tables and stored procedures) to your production database.</span></span> <span data-ttu-id="f73e2-174">Самый простой способ добавить эти объекты в новую базу данных — воспользоваться преимуществами ASP.NET мастером настройки сервера S'L (см. рисунок 8).</span><span class="sxs-lookup"><span data-stu-id="f73e2-174">The easiest way to add these objects to a new database is to take advantage of the ASP.NET SQL Server Setup Wizard (see Figure 8).</span></span> <span data-ttu-id="f73e2-175">Вы можете запустить этот инструмент, открыв Visual Studio 2008 Командный запрос от группы программы Microsoft Visual Studio 2008 и выполняя следующую команду из команды запроса:</span><span class="sxs-lookup"><span data-stu-id="f73e2-175">You can launch this tool by opening the Visual Studio 2008 Command Prompt from the Microsoft Visual Studio 2008 program group and executing the following command from the command prompt:</span></span>

<span data-ttu-id="f73e2-176">aspnet\_regsql</span><span class="sxs-lookup"><span data-stu-id="f73e2-176">aspnet\_regsql</span></span>

<span data-ttu-id="f73e2-177">**Рисунок 8 - Мастер ASP.NET настройки сервера S'L**</span><span class="sxs-lookup"><span data-stu-id="f73e2-177">**Figure 8 – The ASP.NET SQL Server Setup Wizard**</span></span>

![clip_image016](authenticating-users-with-forms-authentication-vb/_static/image8.jpg)

<span data-ttu-id="f73e2-179">Мастер ASP.NET настройки сервера S'L позволяет выбрать базу данных сервера S'L в вашей сети и установить все объекты базы данных, требуемые службами ASP.NET приложений.</span><span class="sxs-lookup"><span data-stu-id="f73e2-179">The ASP.NET SQL Server Setup Wizard enables you to select a SQL Server database on your network and install all of the database objects required by the ASP.NET application services.</span></span> <span data-ttu-id="f73e2-180">Сервер базы данных не требуется для расположения на локальной машине.</span><span class="sxs-lookup"><span data-stu-id="f73e2-180">The database server is not required to be located on your local machine.</span></span>

> [!NOTE]
> <span data-ttu-id="f73e2-181">Если вы не хотите использовать ASP.NET мастере настройки сервера S'L, то вы можете найти скрипты для добавления объектов базы данных служб приложений в следующую папку:</span><span class="sxs-lookup"><span data-stu-id="f73e2-181">If you don't want to use the ASP.NET SQL Server Setup Wizard, then you can find SQL scripts for adding the application services database objects in the following folder:</span></span>
> 
> 
> <span data-ttu-id="f73e2-182">C:»Окна»Microsoft.NET-Framework-v2.0.50727</span><span class="sxs-lookup"><span data-stu-id="f73e2-182">C:\Windows\Microsoft.NET\Framework\v2.0.50727</span></span>

<span data-ttu-id="f73e2-183">После создания необходимых объектов базы данных необходимо изменить соединение базы данных, используемое вашим приложением MVC.</span><span class="sxs-lookup"><span data-stu-id="f73e2-183">After you create the necessary database objects, you need to modify the database connection used by your MVC application.</span></span> <span data-ttu-id="f73e2-184">Измените строку подключения ApplicationServices в файле веб-конфигурации (web.config), чтобы она указала на производственную базу данных.</span><span class="sxs-lookup"><span data-stu-id="f73e2-184">Modify the ApplicationServices connection string in your web configuration (web.config) file so that it points to the production database.</span></span> <span data-ttu-id="f73e2-185">Например, измененное соединение в листинге 3 указывает на базу данных под названием MyProductionDB (оригинальная строка подключения ApplicationServices была прокомментирована).</span><span class="sxs-lookup"><span data-stu-id="f73e2-185">For example, the modified connection in Listing 3 points to a database named MyProductionDB (the original ApplicationServices connection string has been commented out).</span></span>

<span data-ttu-id="f73e2-186">**Список 3 - Web.config**</span><span class="sxs-lookup"><span data-stu-id="f73e2-186">**Listing 3 – Web.config**</span></span>

[!code-xml[Main](authenticating-users-with-forms-authentication-vb/samples/sample3.xml)]

#### <a name="configuring-database-permissions"></a><span data-ttu-id="f73e2-187">Настройка разрешений на базу данных</span><span class="sxs-lookup"><span data-stu-id="f73e2-187">Configuring Database Permissions</span></span>

<span data-ttu-id="f73e2-188">Если вы используете Integrated Security для подключения к базе данных, то вам нужно будет добавить правильную учетную запись пользователя Windows в качестве входа в базу данных.</span><span class="sxs-lookup"><span data-stu-id="f73e2-188">If you use Integrated Security to connect to your database then you will need to add the correct Windows user account as a login to your database.</span></span> <span data-ttu-id="f73e2-189">Правильная учетная запись зависит от того, используете ли вы сервер ASP.NET развития или Интернет-информационные службы в качестве веб-сервера.</span><span class="sxs-lookup"><span data-stu-id="f73e2-189">The correct account depends on whether you are using the ASP.NET Development Server or Internet Information Services as your web server.</span></span> <span data-ttu-id="f73e2-190">Правильная учетная запись пользователя также зависит от вашей операционной системы.</span><span class="sxs-lookup"><span data-stu-id="f73e2-190">The correct user account also depends on your operating system.</span></span>

<span data-ttu-id="f73e2-191">Если вы используете ASP.NET Development Server (веб-сервер по умолчанию, используемый Visual Studio), то приложение выполняется в контексте вашей учетной записи пользователя Windows.</span><span class="sxs-lookup"><span data-stu-id="f73e2-191">If you are using the ASP.NET Development Server (the default web server used by Visual Studio) then your application executes within the context of your Windows user account.</span></span> <span data-ttu-id="f73e2-192">В этом случае необходимо добавить учетную запись пользователя Windows в качестве входа в систему данных сервера.</span><span class="sxs-lookup"><span data-stu-id="f73e2-192">In that case, you need to add your Windows user account as a database server login.</span></span>

<span data-ttu-id="f73e2-193">Кроме того, если вы используете Информационные службы Интернета, то вам нужно добавить либо учетную запись ASPNET или NT AUTHORITY/NETWORK SERVICE в качестве входа в систему данных сервера.</span><span class="sxs-lookup"><span data-stu-id="f73e2-193">Alternatively, if you are using Internet Information Services then you need to add either the ASPNET account or the NT AUTHORITY/NETWORK SERVICE account as a database server login.</span></span> <span data-ttu-id="f73e2-194">Если вы используете Windows XP, добавьте учетную запись ASPNET в качестве входа в базу данных.</span><span class="sxs-lookup"><span data-stu-id="f73e2-194">If you are using Windows XP then add the ASPNET account as a login to your database.</span></span> <span data-ttu-id="f73e2-195">Если вы используете более позднюю операционную систему, такую как Windows Vista или Windows Server 2008, добавьте учетную запись NT AUTHORITY/NETWORK SERVICE в качестве входа в базу данных.</span><span class="sxs-lookup"><span data-stu-id="f73e2-195">If you are using a more recent operating system, such as Windows Vista or Windows Server 2008, then add the NT AUTHORITY/NETWORK SERVICE account as the database login.</span></span>

<span data-ttu-id="f73e2-196">Вы можете добавить новую учетную запись пользователя в базу данных с помощью студии управления серверами Microsoft S'L (см. рисунок 9).</span><span class="sxs-lookup"><span data-stu-id="f73e2-196">You can add a new user account to your database by using Microsoft SQL Server Management Studio (see Figure 9).</span></span>

<span data-ttu-id="f73e2-197">**Рисунок 9 - Создание нового входа в систему Microsoft S'L Server**</span><span class="sxs-lookup"><span data-stu-id="f73e2-197">**Figure 9 – Creating a new Microsoft SQL Server login**</span></span>

![clip_image018](authenticating-users-with-forms-authentication-vb/_static/image9.jpg)

<span data-ttu-id="f73e2-199">После создания необходимого входа необходимо сопоставить логин с пользователем базы данных с правильными ролями базы данных.</span><span class="sxs-lookup"><span data-stu-id="f73e2-199">After you create the required login, you need to map the login to a database user with the right database roles.</span></span> <span data-ttu-id="f73e2-200">Дважды щелкните логин и выберите вкладку «Карта пользователя».</span><span class="sxs-lookup"><span data-stu-id="f73e2-200">Double-click the login and select the User Mapping tab. Select one or more application services database roles.</span></span> <span data-ttu-id="f73e2-201">Например, для проверки подлинности пользователей необходимо включить\_роль\_базы данных aspnet Membership BasicAccess.</span><span class="sxs-lookup"><span data-stu-id="f73e2-201">For example, in order to authenticate users, you need to enable the aspnet\_Membership\_BasicAccess database role.</span></span> <span data-ttu-id="f73e2-202">Для создания новых пользователей необходимо включить роль\_базы\_данных aspnet Membership FullAccess (см. рисунок 10).</span><span class="sxs-lookup"><span data-stu-id="f73e2-202">In order to create new users, you need to enable the aspnet\_Membership\_FullAccess database role (see Figure 10).</span></span>

<span data-ttu-id="f73e2-203">**Рисунок 10 - Добавление ролей в базе данных служб приложений**</span><span class="sxs-lookup"><span data-stu-id="f73e2-203">**Figure 10 – Adding Application Services database roles**</span></span>

![clip_image020](authenticating-users-with-forms-authentication-vb/_static/image10.jpg)

#### <a name="summary"></a><span data-ttu-id="f73e2-205">Сводка</span><span class="sxs-lookup"><span data-stu-id="f73e2-205">Summary</span></span>

<span data-ttu-id="f73e2-206">В этом уроке вы узнали, как использовать проверку подлинности Форм при создании приложения MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="f73e2-206">In this tutorial, you learned how to use Forms authentication when building an ASP.NET MVC application.</span></span> <span data-ttu-id="f73e2-207">Во-первых, вы узнали, как создавать новых пользователей и роли, воспользовавшись инструментом администрирования веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="f73e2-207">First, you learned how to create new users and roles by taking advantage of the Web Site Administration Tool.</span></span> <span data-ttu-id="f73e2-208">Затем вы узнали, как использовать атрибут «Authorize» для предотвращения несанкционированных пользователей от использования действий контроллера.</span><span class="sxs-lookup"><span data-stu-id="f73e2-208">Next, you learned how to use the [Authorize] attribute to prevent unauthorized users from invoking controller actions.</span></span> <span data-ttu-id="f73e2-209">Наконец, вы узнали, как настроить приложение MVC для хранения пользовательской и ролевой информации в производственной базе данных.</span><span class="sxs-lookup"><span data-stu-id="f73e2-209">Finally, you learned how to configure your MVC application to store user and role information in a production database.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f73e2-210">[Назад](preventing-javascript-injection-attacks-cs.md)
> [Вперед](authenticating-users-with-windows-authentication-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f73e2-210">[Previous](preventing-javascript-injection-attacks-cs.md)
[Next](authenticating-users-with-windows-authentication-vb.md)</span></span>
