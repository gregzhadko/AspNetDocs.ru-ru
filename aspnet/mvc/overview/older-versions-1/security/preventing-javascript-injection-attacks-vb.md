---
uid: mvc/overview/older-versions-1/security/preventing-javascript-injection-attacks-vb
title: Предотвращение атак путем внедрения кода JavaScript (Visual Basic) | Документация Майкрософт
author: StephenWalther
description: Предотвратить атаки путем внедрения кода JavaScript и Cross-Site Scripting атаки для вас. В этом руководстве Стивен Вальтер объясняется, как вы можете легко de...
ms.author: riande
ms.date: 08/19/2008
ms.assetid: 9274a72e-34dd-4dae-8452-ed733ae71377
msc.legacyurl: /mvc/overview/older-versions-1/security/preventing-javascript-injection-attacks-vb
msc.type: authoredcontent
ms.openlocfilehash: d988b2ed6b7d1760557cbfbb543afa85b320c984
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59402444"
---
# <a name="preventing-javascript-injection-attacks-vb"></a>Предотвращение атак, осуществляемых путем внедрения кода JavaScript (VB)

по [Стивен Вальтер](https://github.com/StephenWalther)

[Скачать PDF](http://download.microsoft.com/download/8/4/8/84843d8d-1575-426c-bcb5-9d0c42e51416/ASPNET_MVC_Tutorial_06_VB.pdf)

> Предотвратить атаки путем внедрения кода JavaScript и Cross-Site Scripting атаки для вас. В этом руководстве Стивен Вальтер объясняется, как можно легко обойти эти типы атак с HTML-кодирование содержимого.


Чтобы объяснить, как предотвратить атаки путем внедрения кода JavaScript в приложениях ASP.NET MVC является целью данного учебника. В этом руководстве рассматриваются два подхода к защите веб-сайта от атак путем внедрения кода JavaScript. Вы узнаете, как для предотвращения атак путем внедрения кода JavaScript путем кодирования данных, которые можно просматривать. Кроме того, вы узнаете, как для предотвращения атак путем внедрения кода JavaScript путем кодирования данных, вы принимаете.

## <a name="what-is-a-javascript-injection-attack"></a>Что такое атака путем внедрения кода JavaScript?

Всякий раз, когда вы принимают пользовательский ввод и снова отобразить данные, введенные пользователем, можно открыть веб-сайт для атак путем внедрения кода JavaScript. Давайте рассмотрим конкретные приложения, открытую для атак путем внедрения кода JavaScript.

Представьте, что вы создали веб-сайт клиентов обратной связи (см. рис. 1). Клиенты могут посетить веб-сайт и введите отзыв на обсуждают опыт использования ваших продуктов. Когда клиент отправляет свои отзывы, отзывы и предложения отобразится на странице обратной связи.


[![Cклиент веб-сайт обратной связи](preventing-javascript-injection-attacks-vb/_static/image2.png)](preventing-javascript-injection-attacks-vb/_static/image1.png)

**Рис 01**: Веб-сайт отзывов клиентов ([Просмотр полноразмерного изображения](preventing-javascript-injection-attacks-vb/_static/image3.png))


Использует веб-сайт отзывов клиентов `controller` в листинге 1. Это `controller` содержит два действия с именем `Index()` и `Create()`.

**Листинг 1. `HomeController.vb`**

[!code-vb[Main](preventing-javascript-injection-attacks-vb/samples/sample1.vb)]

`Index()` Метод выводит `Index` представления. Этот метод передает все предыдущие отзывов клиентов к `Index` представления путем получения обратной связи из базы данных (с помощью LINQ to SQL-запроса).

`Create()` Метод создает новый элемент обратной связи и добавляет его к базе данных. Сообщение, которое клиент вводит в форме передается `Create()` метода в параметр сообщения. Создается элемент для отзывов и сообщение назначен элемент отзыва `Message` свойство. Элемент отзыва отправляется в базу данных с помощью `DataContext.SubmitChanges()` вызова метода. Наконец, пользователь перенаправляется в `Index` представление, где отображаются все отзывы.

`Index` Представление содержится в листинге 2.

**Листинг 2. `Index.aspx`**

[!code-aspx[Main](preventing-javascript-injection-attacks-vb/samples/sample2.aspx)]

`Index` Представление состоит из двух разделов. Верхний раздел содержит форму обратно связи клиента. В нижней части содержит For.. Каждый цикл, который перебирает все предыдущие элементы отзывов клиентов и отображает свойства EntryDate и сообщение для каждого элемента обратной связи.

Веб-сайт отзывов клиентов — это простой веб-сайт. К сожалению веб-сайт доступен для атак путем внедрения кода JavaScript.

Представьте, что введите следующий текст в форме обратной связи клиента:

[!code-html[Main](preventing-javascript-injection-attacks-vb/samples/sample3.html)]

Этот текст представляет сценарий JavaScript, который выводит окно предупреждающего сообщения. Когда кто-то отправляет этот сценарий в отзыв форме сообщения <em>Boo!</em> будет отображаться всякий раз, когда любой пользователь посещает веб-сайт отзывов клиентов в будущем (см. рис. 2).


[![JavaScript путем внедрения кода](preventing-javascript-injection-attacks-vb/_static/image5.png)](preventing-javascript-injection-attacks-vb/_static/image4.png)

**Рис. 02**: Путем внедрения кода JavaScript ([Просмотр полноразмерного изображения](preventing-javascript-injection-attacks-vb/_static/image6.png))


Теперь вашего первого ответа для атак путем внедрения кода JavaScript может быть безразличие. Можно подумать, что атаки путем внедрения кода JavaScript являются просто *вандализм* атаки. Разработчик может посчитать, что никто не можем всё по-настоящему злой путем фиксации атака путем внедрения кода JavaScript.

К сожалению, злоумышленник может выполнить некоторые, действительно зло вещи, внедряя JavaScript в веб-сайта. Атака путем внедрения кода JavaScript можно использовать для выполнения атаки межузловых сценариев (XSS). Атаки межузловых сценариев кражи информации пользователей и отправить их в другой веб-сайта.

Например злоумышленник можно использовать на атаку путем внедрения кода JavaScript для кражи значения файлов cookie браузера, у других пользователей. Если конфиденциальные сведения — например пароли, номера кредитных карт или номера социального страхования — хранится в файлах cookie браузера, злоумышленник используется атака путем внедрения кода JavaScript для кражи этой информации. Или, если пользователь вводит конфиденциальные сведения в поля формы, содержащихся в страницу, которая была скомпрометирована с помощью атак на основе JavaScript, затем злоумышленник может использовать подставляемый код JavaScript для получения данных формы и отправить его на другой веб-сайт.

*Следует попробовать совместить их*. Серьезно атаки путем внедрения кода JavaScript и защите конфиденциальной информации пользователя. В следующих двух разделах мы рассмотрим два способа, которые можно использовать для защиты ваших приложений ASP.NET MVC от атак путем внедрения кода JavaScript.

## <a name="approach-1-html-encode-in-the-view"></a>Способ #1. Кодировать в HTML в представлении

Один простой метод предотвращает атаки путем внедрения кода JavaScript в виде HTML кодирования любые данные, введенные пользователями веб-сайта, при отображении данных в представлении. Обновленный `Index` представления в листинге 3 использует именно этот подход.

**Листинг 3. `Index.aspx` (кодировки HTML)**

[!code-aspx[Main](preventing-javascript-injection-attacks-vb/samples/sample4.aspx)]

Обратите внимание, что значение `feedback.Message` кодировки прежде, чем значение отображается на следующий код HTML:

[!code-aspx[Main](preventing-javascript-injection-attacks-vb/samples/sample5.aspx)]

Что означает для HTML-кодирования строки? Когда вы HTML кодирования строки, опасные символы, такие как `<` и `>` заменяются ссылки на сущности HTML, такие как `&lt;` и `&gt;`. Поэтому если строка `<script>alert("Boo!")</script>` HTML-код в кодировке, они преобразуются в нумерованные `&lt;script&gt;alert(&quot;Boo!&quot;)&lt;/script&gt;`. Закодированной строки больше не выполняется как сценарий JavaScript при интерпретации браузером. Вместо этого вы получите безвредным страницы на рис. 3.


[![Defeated атаки JavaScript](preventing-javascript-injection-attacks-vb/_static/image8.png)](preventing-javascript-injection-attacks-vb/_static/image7.png)

**Рис 03**: Изменило атаки JavaScript ([Просмотр полноразмерного изображения](preventing-javascript-injection-attacks-vb/_static/image9.png))


Обратите внимание, что в `Index` просматривать в листинге 3 только значение `feedback.Message` кодируется. Значение `feedback.EntryDate` не кодируется. Необходимо только кодировать данные, введенные пользователем. Так как значение EntryDate был создан в контроллере, не требуются для HTML кодирования это значение.

## <a name="approach-2-html-encode-in-the-controller"></a>Способ #2. Кодировать в HTML в контроллере

Вместо кодировки данных при отображении данных в представлении HTML, вы можете HTML кодирования данных, непосредственно перед отправкой данных в базу данных. Этот второй подход применяется в случае использования `controller` в листинге 4.

**Листинг 4 — `HomeController.cs` (кодировки HTML)**

[!code-vb[Main](preventing-javascript-injection-attacks-vb/samples/sample6.vb)]

Обратите внимание, что значение сообщения перед отправкой в базу данных в значение в кодировке HTML `Create()` действие. Когда сообщение отобразится в представлении, сообщения — в кодировке HTML и любой JavaScript, внедрены в сообщении не выполняется.

Как правило должны предпочесть первый подход, описанный в этом руководстве по второго подхода. Проблема с помощью второго подхода в том, что может получиться кодируется в HTML-данных в базе данных. Другими словами в базе данных является измененных забавно выглядящие знаками.

Почему это неправильный? Если в дальнейшем для отображения данных базы данных в отличные от веб-страницы, вы получите проблем. Например можно отобразить больше не просто данные в приложении Windows Forms.

## <a name="summary"></a>Сводка

Цель этого руководства мы хотели пугают вас о потенциальных атак путем внедрения кода JavaScript. Этом руководстве рассматриваются два подхода для защиты ваших приложений ASP.NET MVC от атак путем внедрения кода JavaScript: вы можете либо HTML кодирования пользователя при отправке данных в представлении, или вы можете HTML кодирования пользователя при отправке данных в контроллере.

> [!div class="step-by-step"]
> [Назад](authenticating-users-with-windows-authentication-vb.md)
