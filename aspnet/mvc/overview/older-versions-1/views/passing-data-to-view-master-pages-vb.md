---
uid: mvc/overview/older-versions-1/views/passing-data-to-view-master-pages-vb
title: Передача данных для просмотра главных страниц (VB) | Документация Майкрософт
author: microsoft
description: Цель этого руководства — объяснить, как передавать данные из контроллера на главную страницу представления. Мы рассмотрим две стратегии передачи данных в представление m...
ms.author: riande
ms.date: 10/16/2008
ms.assetid: 37a1ebae-8773-408f-8645-d21da7ff9ae1
msc.legacyurl: /mvc/overview/older-versions-1/views/passing-data-to-view-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 9f768f47557adedc43cebfa2c092014bba5842de
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78485676"
---
# <a name="passing-data-to-view-master-pages-vb"></a>Передача данных на эталонные страницы представлений (VB)

по [Майкрософт](https://github.com/microsoft)

[Скачать в формате PDF](https://download.microsoft.com/download/e/f/3/ef3f2ff6-7424-48f7-bdaa-180ef64c3490/ASPNET_MVC_Tutorial_13_VB.pdf)

> Цель этого руководства — объяснить, как передавать данные из контроллера на главную страницу представления. Мы рассмотрим две стратегии передачи данных на главную страницу представления. Во-первых, мы обсудим простое решение, которое приводит к несложному обслуживанию приложения. Далее мы рассмотрим гораздо лучшее решение, которое требует немного более начальной работы, но приводит к значительному обслуживанию приложения.

## <a name="passing-data-to-view-master-pages"></a>Передача данных для просмотра главных страниц

Цель этого руководства — объяснить, как передавать данные из контроллера на главную страницу представления. Мы рассмотрим две стратегии передачи данных на главную страницу представления. Во-первых, мы обсудим простое решение, которое приводит к несложному обслуживанию приложения. Далее мы рассмотрим гораздо лучшее решение, которое требует немного более начальной работы, но приводит к значительному обслуживанию приложения.

### <a name="the-problem"></a>Проблема

Представьте, что вы создаете приложение базы данных фильмов и хотите отобразить список категорий фильмов на каждой странице приложения (см. рис. 1). Кроме того, представьте, что список категорий фильмов хранится в таблице базы данных. В этом случае имеет смысл извлечь категории из базы данных и отобразить список категорий фильмов на главной странице представления.

[![отображение категорий фильмов на главной странице представления](passing-data-to-view-master-pages-vb/_static/image2.png)](passing-data-to-view-master-pages-vb/_static/image1.png)

**Рис. 01**. Отображение категорий фильмов на главной странице представления ([щелкните, чтобы просмотреть изображение с полным размером](passing-data-to-view-master-pages-vb/_static/image3.png))

Вот эта проблема. Как получить список категорий фильмов на главной странице? Вызывайте методы классов модели на главной странице напрямую. Иными словами, можно добавить код для получения данных из базы данных непосредственно на главной странице. Однако обход контроллеров MVC для доступа к базе данных нарушает четкое разделение проблем, которые являются одним из основных преимуществ создания приложения MVC.

В приложении MVC требуется, чтобы все взаимодействия между представлениями MVC и модели MVC были обработаны контроллерами MVC. Такое разделение вопросов приводит к более удобному обслуживанию, адаптируемому и тестируемому приложению.

В MVC-приложении все данные, передаваемые в представление, включая главную страницу представления, должны передаваться в представление действием контроллера. Более того, данные следует передавать, используя преимущества представления данных. В оставшейся части этого руководства я рассмотрю два метода передачи данных представления на главную страницу представления.

### <a name="the-simple-solution"></a>Простое решение

Начнем с простейшего решения для передачи данных просмотра с контроллера на главную страницу представления. Самым простым решением является передача данных представления для главной страницы в каждом и каждом действии контроллера.

Рассмотрим контроллер в листинге 1. Он предоставляет два действия с именами `Index()` и `Details()`. Метод действия `Index()` возвращает каждый фильм в таблице базы данных фильмов. Метод действия `Details()` возвращает каждый фильм в определенной категории фильмов.

**Листинг 1 — `Controllers\HomeController.vb`**

[!code-vb[Main](passing-data-to-view-master-pages-vb/samples/sample1.vb)]

Обратите внимание, что действия `Index()` и `Details()` добавляют два элемента для просмотра данных. Действие `Index()` добавляет два ключа: категории и фильмы. Ключ категории представляет список категорий фильмов, отображаемых на главной странице представления. Раздел фильмов представляет список фильмов, отображаемых на странице представление индекса.

Действие `Details()` также добавляет два ключа с именами Categories и movies. Ключ категорий, опять же, представляет список категорий фильмов, отображаемых на главной странице представления. Раздел фильмов представляет список фильмов в определенной категории, отображаемый на странице представление сведений (см. рис. 2).

[![представление сведений](passing-data-to-view-master-pages-vb/_static/image5.png)](passing-data-to-view-master-pages-vb/_static/image4.png)

**Рис. 02**. представление сведений ([щелкните, чтобы просмотреть изображение с полным размером](passing-data-to-view-master-pages-vb/_static/image6.png))

Представление индекса содержится в листинге 2. Он просто просматривает список фильмов, представленных элементом «фильмы» в представлении данных.

**Листинг 2 — `Views\Home\Index.aspx`**

[!code-aspx[Main](passing-data-to-view-master-pages-vb/samples/sample2.aspx)]

Главная страница представления содержится в листинге 3. Главная страница представления выполняет перебор и визуализацию всех категорий фильмов, представленных элементом категории, из данных представления.

**Листинг 3 — `Views\Shared\Site.master`**

[!code-aspx[Main](passing-data-to-view-master-pages-vb/samples/sample3.aspx)]

Все данные передаются в представление и на главную страницу представления через данные представления. Это правильный способ передачи данных на главную страницу.

Итак, что же с этим решением не так? Проблема заключается в том, что это решение нарушает принцип сухой (принцип "Не повторяйся"). Каждый и все действия контроллера должны добавить один и тот же список категорий фильмов для просмотра данных. Наличие повторяющегося кода в приложении значительно усложняет обслуживание, адаптацию и изменение приложения.

### <a name="the-good-solution"></a>Хорошее решение

В этом разделе мы рассмотрим альтернативное и лучшее решение для передачи данных из действия контроллера на главную страницу представления. Вместо того чтобы добавлять категории фильмов для главной страницы в каждом действии контроллера, мы добавляем категории фильмов в данные представления только один раз. Все данные представления, используемые главной страницей представления, добавляются в контроллер приложения.

Класс ApplicationController содержится в листинге 4.

Класс ApplicationController содержится в листинге 4.

**Листинг 4 — `Controllers\ApplicationController.vb`**

[!code-vb[Main](passing-data-to-view-master-pages-vb/samples/sample4.vb)]

В листинге 4 вы должны заметить три вещи. Во-первых, обратите внимание, что класс наследует от базового класса System. Web. MVC. Controller. Контроллер приложения является классом контроллера.

Во-вторых, обратите внимание, что класс контроллера приложения является классом MustInherit. Класс MustInherit — это класс, который должен быть реализован конкретным классом. Поскольку контроллер приложения является классом MustInherit, нельзя вызывать методы, определенные непосредственно в классе. При попытке вызвать класс приложения напрямую вы получите сообщение об ошибке.

В-третьих, обратите внимание, что контроллер приложения содержит конструктор, который добавляет список категорий фильмов для просмотра данных. Каждый класс контроллера, наследующий от контроллера приложения, вызывает конструктор контроллера приложения автоматически. При каждом вызове какого-либо действия на любом контроллере, наследующем от контроллера приложения, категории фильмов включаются в данные представления автоматически.

Контроллер фильмов, приведенный в листинге 5, наследуется от контроллера приложения.

**Листинг 5 — `Controllers\MoviesController.vb`**

[!code-vb[Main](passing-data-to-view-master-pages-vb/samples/sample5.vb)]

Контроллер фильмов, как и контроллер Home, описанный в предыдущем разделе, предоставляет два метода действий с именами `Index()` и `Details()`. Обратите внимание, что список категорий фильмов, отображаемых на главной странице представления, не добавляется для просмотра данных в методе `Index()` или `Details()`. Так как контроллер фильмов наследуется от контроллера приложения, список категорий фильмов добавляется для автоматического просмотра данных.

Обратите внимание, что это решение для добавления данных представления для главной страницы представления не нарушает принцип сухой (принцип "Не повторяйся"). Код для добавления списка категорий фильмов для просмотра данных содержится только в одном расположении: конструктор для контроллера приложения.

### <a name="summary"></a>Сводка

В этом учебнике мы обсуждали два подхода к передаче данных просмотра с контроллера на главную страницу представления. Во-первых, мы рассматривали простой, но сложный подход к поддержке. В первом разделе мы рассмотрели, как можно добавить данные представления для главной страницы представления в каждом действии контроллера в приложении. Мы составили, что это плохой подход, так как он нарушает принцип сухой (принцип "Не повторяйся").

Далее мы рассмотрели гораздо более лучшую стратегию добавления данных, необходимых главной страницей представления для просмотра данных. Вместо добавления данных представления в каждом из действий контроллера, мы добавили данные представления только один раз в пределах контроллера приложения. Таким образом, можно избежать дублирования кода при передаче данных на главную страницу представления в приложении ASP.NET MVC.

> [!div class="step-by-step"]
> [Назад](creating-page-layouts-with-view-master-pages-vb.md)
