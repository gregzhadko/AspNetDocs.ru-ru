---
uid: mvc/overview/older-versions-1/views/passing-data-to-view-master-pages-vb
title: Передача данных для просмотра страниц master (VB) Документы Майкрософт
author: rick-anderson
description: Цель этого учебника состоит в том, чтобы объяснить, как вы можете передать данные от контроллера на главную страницу представления. Мы рассмотрим две стратегии передачи данных в представление m. .
ms.author: riande
ms.date: 10/16/2008
ms.assetid: 37a1ebae-8773-408f-8645-d21da7ff9ae1
msc.legacyurl: /mvc/overview/older-versions-1/views/passing-data-to-view-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: ef65541a5f2297414f923e2f8108a14de67531e5
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2020
ms.locfileid: "81542473"
---
# <a name="passing-data-to-view-master-pages-vb"></a>Передача данных на эталонные страницы представлений (VB)

[корпорацией Майкрософт](https://github.com/microsoft)

[Скачать PDF](https://download.microsoft.com/download/e/f/3/ef3f2ff6-7424-48f7-bdaa-180ef64c3490/ASPNET_MVC_Tutorial_13_VB.pdf)

> Цель этого учебника состоит в том, чтобы объяснить, как вы можете передать данные от контроллера на главную страницу представления. Мы рассмотрим две стратегии передачи данных на главную страницу представления. Во-первых, мы обсуждаем простое решение, которое приводит к приложению, которое трудно поддерживать. Далее, мы рассмотрим гораздо лучшее решение, которое требует немного больше первоначальной работы, но приводит к гораздо более обслуживаемым приложениям.

## <a name="passing-data-to-view-master-pages"></a>Передача данных для просмотра страниц master

Цель этого учебника состоит в том, чтобы объяснить, как вы можете передать данные от контроллера на главную страницу представления. Мы рассмотрим две стратегии передачи данных на главную страницу представления. Во-первых, мы обсуждаем простое решение, которое приводит к приложению, которое трудно поддерживать. Далее, мы рассмотрим гораздо лучшее решение, которое требует немного больше первоначальной работы, но приводит к гораздо более обслуживаемым приложениям.

### <a name="the-problem"></a>Проблема

Представьте, что вы строите приложение базы данных фильмов и хотите отображать список категорий фильмов на каждой странице приложения (см. рисунок 1). Кроме того, представьте, что список категорий фильмов хранится в таблице базы данных. В этом случае имеет смысл извлечь категории из базы данных и сделать список категорий фильмов на главной странице представления.

[![Отображение категорий фильмов на главной странице представления](passing-data-to-view-master-pages-vb/_static/image2.png)](passing-data-to-view-master-pages-vb/_static/image1.png)

**Рисунок 01**: Отображение категорий фильмов на главной странице просмотра ([Нажмите, чтобы просмотреть полноразмерное изображение](passing-data-to-view-master-pages-vb/_static/image3.png))

Вот в чем проблема. Как получить список категорий фильмов на главной странице? Заманчиво называть методы классов моделей на главной странице напрямую. Другими словами, заманчиво включить код для извлечения данных из базы данных прямо на главной странице. Однако обход контроллеров MVC для доступа к базе данных нарушает четкое разделение проблем, что является одним из основных преимуществ создания приложения MVC.

В приложении MVC необходимо, чтобы все взаимодействие между представлениями MVC и моделью MVC осуществлялось контроллерами MVC. Такое разделение проблем приводит к более обслуживаемому, адаптируемому и проверяемому приложению.

В приложении MVC все данные, передаваемые в представление, включая страницу master view, должны передаваться в представление действием контроллера. Кроме того, данные должны передаваться с помощью данных о представлении. В остальной части этого учебника я изучаю два метода передачи данных представления на главную страницу представления.

### <a name="the-simple-solution"></a>Простое решение

Начнем с простейшого решения для передачи данных просмотра от контроллера к главной странице представления. Простейших решений является передача данных представления для главной страницы в каждом действии контроллера.

Рассмотрим контроллер в листинге 1. Он разоблачает два действия, названные `Index()` и `Details()`. Метод `Index()` действия возвращает каждый фильм в таблицу базы данных Movies. Метод `Details()` действия возвращает каждый фильм в определенной категории фильма.

**Список 1 -`Controllers\HomeController.vb`**

[!code-vb[Main](passing-data-to-view-master-pages-vb/samples/sample1.vb)]

Обратите внимание, `Index()` что `Details()` и действия, и действия добавляют два элемента для просмотра данных. Действие `Index()` добавляет два ключа: категории и фильмы. Ключ категорий представляет список категорий фильмов, отображаемых на странице просмотра. Ключ фильмов представляет список фильмов, отображаемых на странице представления индекса.

Действие `Details()` также добавляет два ключа названных категорий и фильмов. Ключ категорий, еще раз, представляет список категорий фильмов, отображаемых на странице просмотра. Ключ фильмов представляет список фильмов в определенной категории, отображаемый страницей просмотра деталей (см. рисунок 2).

[![Представление подробностей](passing-data-to-view-master-pages-vb/_static/image5.png)](passing-data-to-view-master-pages-vb/_static/image4.png)

**Рисунок 02**: Подробная информация зрения ([Нажмите, чтобы посмотреть полноразмерное изображение](passing-data-to-view-master-pages-vb/_static/image6.png))

Представление индекса содержится в листинге 2. Он просто итерирует через список фильмов, представленных фильмами элемент в просмотре данных.

**Список 2 -`Views\Home\Index.aspx`**

[!code-aspx[Main](passing-data-to-view-master-pages-vb/samples/sample2.aspx)]

Страница "Мастер-страницы представления" содержится в листинге 3. Страница "Мастер-страница представления итерирует" и отображает все категории фильмов, представленные элементом категорий, из данных представления.

**Список 3 -`Views\Shared\Site.master`**

[!code-aspx[Main](passing-data-to-view-master-pages-vb/samples/sample3.aspx)]

Все данные передаются в представление и на главную страницу представления через данные представления. Это правильный способ передачи данных на главную страницу.

Итак, что не так с этим решением? Проблема в том, что это решение нарушает принцип DRY (Не повторяй себя). Каждое действие контроллера должно добавлять один и тот же список категорий фильмов для просмотра данных. Дублирование кода в приложении значительно затрудняет обслуживание, адаптацию и изменение приложения.

### <a name="the-good-solution"></a>Хорошее решение

В этом разделе мы рассмотрим альтернативное и лучшее решение для передачи данных от действия контроллера к главной странице представления. Вместо добавления категорий фильмов для главной страницы в каждом действии контроллера, мы добавляем категории фильмов в данные представления только один раз. Все данные представления, используемые на странице master view, добавляются в контроллер приложения.

Класс ApplicationController содержится в листинге 4.

Класс ApplicationController содержится в листинге 4.

**Список 4 -`Controllers\ApplicationController.vb`**

[!code-vb[Main](passing-data-to-view-master-pages-vb/samples/sample4.vb)]

Есть три вещи, которые вы должны заметить о контроллере приложения в листинге 4. Во-первых, обратите внимание, что класс наследует от базового класса System.Web.Mvc.Controller. Контроллер приложения — это класс контроллера.

Во-вторых, обратите внимание, что класс контроллера приложений является классом MustInherit. Класс MustInherit — это класс, который должен быть реализован конкретным классом. Поскольку контроллер приложения является классом MustInherit, вы не можете вызывать какие-либо методы, определенные в классе напрямую. Если вы попытаетесь вызвать класс приложения напрямую, то вы получите сообщение об ошибке Ресурса не может быть найдено.

В-третьих, обратите внимание, что контроллер приложения содержит конструктор, который добавляет список категорий фильмов для просмотра данных. Каждый класс контроллера, наследуемый от контроллера приложения, автоматически вызывает конструктор контроллера приложения. Всякий раз, когда вы называете какие-либо действия на любой контроллер, который наследует от контроллера приложения, категории фильмов включены в данные представления автоматически.

Контроллер Фильмов в листинге 5 наследует от контроллера приложения.

**Список 5 -`Controllers\MoviesController.vb`**

[!code-vb[Main](passing-data-to-view-master-pages-vb/samples/sample5.vb)]

Контроллер Фильмов, так же, как контроллер Home обсуждается в предыдущем `Index()` `Details()`разделе, предоставляет два метода действия имени и . Обратите внимание, что список категорий фильмов, отображаемых `Index()` `Details()` на главной странице представления, не добавляется для просмотра данных ни в методе. Поскольку контроллер Movies наследует от контроллера приложения, список категорий фильмов добавляется к данным просмотра автоматически.

Обратите внимание, что это решение для добавления данных представления для главной страницы представления не нарушает принцип DRY (Don't Repeat Yourself). Код для добавления списка категорий фильмов для просмотра данных содержится только в одном месте: конструктор для контроллера приложения.

### <a name="summary"></a>Сводка

В этом уроке мы обсудили два подхода к передаче данных представления от контроллера к главной странице представления. Во-первых, мы рассмотрели простой, но трудно поддерживать подход. В первом разделе мы обсудили, как можно добавлять данные просмотра для главной страницы представления в каждом действии контроллера в приложении. Мы пришли к выводу, что это был плохой подход, поскольку он нарушает принцип DRY (Не повторяй себя).

Затем мы рассмотрели гораздо лучшую стратегию добавления данных, необходимых на главной странице представления для просмотра данных. Вместо добавления данных представления в каждое действие контроллера мы добавляли данные представления только один раз в контроллер приложения. Таким образом, можно избежать дублирования кода при передаче данных на главную страницу представления в ASP.NET mVC-приложении.

> [!div class="step-by-step"]
> [Назад](creating-page-layouts-with-view-master-pages-vb.md)
