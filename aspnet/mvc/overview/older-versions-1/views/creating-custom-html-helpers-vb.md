---
uid: mvc/overview/older-versions-1/views/creating-custom-html-helpers-vb
title: Создание пользовательских HTML-помощников (VB) Документы Майкрософт
author: rick-anderson
description: Цель этого учебника состоит в том, чтобы продемонстрировать, как вы можете создавать пользовательские HTML Helpers, которые можно использовать в своих представлениях MVC. Воспользовавшись HTML Helper...
ms.author: riande
ms.date: 10/07/2008
ms.assetid: f96f4800-19ef-44c0-b457-55e777eb5de8
msc.legacyurl: /mvc/overview/older-versions-1/views/creating-custom-html-helpers-vb
msc.type: authoredcontent
ms.openlocfilehash: 52f16bf666edc9f1c95c01faf004e303fcb6a0b2
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2020
ms.locfileid: "81542512"
---
# <a name="creating-custom-html-helpers-vb"></a>Создание настраиваемых вспомогательных методов HTML (VB)

[корпорацией Майкрософт](https://github.com/microsoft)

[Скачать PDF](https://download.microsoft.com/download/1/1/f/11f721aa-d749-4ed7-bb89-a681b68894e6/ASPNET_MVC_Tutorial_9_VB.pdf)

> Цель этого учебника состоит в том, чтобы продемонстрировать, как вы можете создавать пользовательские HTML Helpers, которые можно использовать в своих представлениях MVC. Воспользовавшись HTML Helpers, вы можете уменьшить количество утомительного ввода HTML-тегов, которые необходимо выполнить для создания стандартной страницы HTML.

Цель этого учебника состоит в том, чтобы продемонстрировать, как вы можете создавать пользовательские HTML Helpers, которые можно использовать в своих представлениях MVC. Воспользовавшись HTML Helpers, вы можете уменьшить количество утомительного ввода HTML-тегов, которые необходимо выполнить для создания стандартной страницы HTML.

В первой части этого урока я описываю некоторые из существующих HTML Помощников, включенных в ASP.NET платформу MVC. Далее я описываю два способа создания пользовательских HTML Helpers: я объясняю, как создавать пользовательские HTML Helpers, создавая общий метод и создавая метод расширения.

## <a name="understanding-html-helpers"></a>Понимание HTML Помощники

HTML Helper — это всего лишь метод, который возвращает строку. Строка может представлять любой тип содержимого, который вы хотите. Например, можно использовать HTML Helpers для визуализации `<input>` `<img>` стандартных HTML-тегов, таких как HTML и теги. Вы также можете использовать HTML Helpers для визуализации более сложного содержимого, такого как полоса вкладок или HTML-таблица данных базы данных.

Платформа ASP.NET MVC включает в себя следующий набор стандартных HTML Помощников (это не полный список):

- Html.ActionLink()
- Html.BeginForm()
- Html.CheckBox()
- Html.DropDownList()
- Html.EndForm()
- Html.Скрытые()
- Html.ListBox()
- Html.Password()
- Html.RadioButton()
- Html.TextArea()
- Html.TextBox()

Например, рассмотрим форму в листинге 1. Эта форма отображается с помощью двух стандартных HTML Помощников (см. рисунок 1). Эта форма `Html.BeginForm()` использует `Html.TextBox()` методы и помощник.

[![Страница, отрисована с помощью HTML-помощников](creating-custom-html-helpers-vb/_static/image2.png)](creating-custom-html-helpers-vb/_static/image1.png)

**Рисунок 01**: Страница, отрисована с помощью HTML Помощников[(Нажмите, чтобы просмотреть полноразмерное изображение)](creating-custom-html-helpers-vb/_static/image3.png)

**Список 1 -`Views\Home\Index.aspx`**

[!code-aspx[Main](creating-custom-html-helpers-vb/samples/sample1.aspx)]

Метод `Html.BeginForm()` Helper используется для создания открытия `<form>` и закрытия HTML-тегов. Обратите внимание, что `Html.BeginForm()` метод вызывается в использовании оператора. Использование оператора гарантирует, `<form>` что тег закрывается в конце блока использования.

Если вы предпочитаете, вместо создания блока использования, вы можете вызвать html.EndForm() Метод помощника, чтобы закрыть `<form>` тег. Используйте какой бы подход `<form>` к созданию тега открытия и закрытия, который кажется вам наиболее интуитивным.

Методы `Html.TextBox()` Helper используются в листинге `<input>` 1 для визуализации HTML-тегов. Если вы выберете источник просмотра в браузере, то вы увидите источник HTML в листинге 2. Обратите внимание, что источник содержит стандартные HTML-теги.

> [!IMPORTANT]
> обратите внимание, что `Html.TextBox()`помощник -HTML `<%= %>` отображается `<% %>` с тегами вместо тегов. Если вы не включаете равный знак, то ничего не отображается в браузере.

Платформа mVC ASP.NET содержит небольшой набор помощников. Скорее всего, вам нужно будет расширить платформу MVC с пользовательскими HTML Helpers. В оставшейся части этого урока вы узнаете два метода создания пользовательских HTML Помощников.

**Список 2 -`Index.aspx Source`**

[!code-aspx[Main](creating-custom-html-helpers-vb/samples/sample2.aspx)]

### <a name="creating-html-helpers-with-shared-methods"></a>Создание HTML-помощников с помощью общих методов

Самый простой способ создать новый HTML Helper — создать общий метод, который возвращает строку. Представьте, например, что вы решили создать новый HTML `<label>` Helper, который отображает HTML-тег. Вы можете использовать класс в листинге 2 для визуализации `<label>`.

**Список 2 -`Helpers\LabelHelper.vb`**

[!code-vb[Main](creating-custom-html-helpers-vb/samples/sample3.vb)]

В листинге 2 нет ничего особенного в классе. Метод `Label()` просто возвращает строку.

В измененном представлении индекса в листинге 3 используется для визуализации `LabelHelper` HTML-тегов. `<label>` Обратите внимание, что `<%@ imports %>` представление содержит директиву, которая импортирует пространство имен Application1.Helpers.

**Список 2 -`Views\Home\Index2.aspx`**

[!code-aspx[Main](creating-custom-html-helpers-vb/samples/sample4.aspx)]

### <a name="creating-html-helpers-with-extension-methods"></a>Создание HTML-помощников с помощью методов расширения

Если вы хотите создать HTML Helpers, которые работают так же, как стандартные HTML Helpers, включенные в ASP.NET mVC, то вам нужно создать методы расширения. Методы расширения позволяют добавлять новые методы в существующий класс. При создании метода HTML Helper вы добавляете новые методы в `HtmlHelper` класс, представленный свойством Html представления.

Модуль Visual Basic в листинге 3 `Label()` добавляет `HtmlHelper` метод расширения, названный классом. Есть несколько вещей, которые вы должны заметить об этом модуле. Во-первых, обратите внимание, `<Extension()>` что модуль украшен атрибутом. Для использования этого атрибута необходимо `System.Runtime.CompilerServices` импортировать пространство имен

Во-вторых, обратите внимание, что первый параметр метода `Label()` представляет `HtmlHelper` класс. Первый параметр метода расширения указывает на класс, который расширяет сятвик.

**Список 3 -`Helpers\LabelExtensions.vb`**

[!code-vb[Main](creating-custom-html-helpers-vb/samples/sample5.vb)]

После создания метода расширения и успешного создания приложения метод расширения появляется в Visual Studio Intellisense, как и все другие методы класса (см. рисунок 2). Разница лишь в том, что методы расширения появляются со специальным символом рядом с ними (иконка нисходящей стрелки).

[![Использование метода расширения Html.Label()](creating-custom-html-helpers-vb/_static/image5.png)](creating-custom-html-helpers-vb/_static/image4.png)

**Рисунок 02**: Использование метода расширения Html.Label()[(Нажмите, чтобы просмотреть полноразмерное изображение)](creating-custom-html-helpers-vb/_static/image6.png)

В измененном представлении индекса в листинге 4 используется метод &lt;&gt; расширения Html.Label() для визуализации всех меток.

**Список 4 -`Views\Home\Index3.aspx`**

[!code-aspx[Main](creating-custom-html-helpers-vb/samples/sample6.aspx)]

## <a name="summary"></a>Сводка

В этом уроке вы узнали два способа создания пользовательских HTML Помощники. Во-первых, вы узнали, как создать пользовательский `Label()` HTML Helper, создав общий метод, который возвращает строку. Далее вы узнали, `Label()` как создать пользовательский метод HTML `HtmlHelper` Helper, создав метод расширения в классе.

В этом учебнике я сосредоточился на создании чрезвычайно простого метода HTML Helper. Поймите, что HTML Helper может быть настолько сложным, насколько вы хотите. Можно создавать HTML-помощники, которые визуализировать богатое содержимое, такое как представления деревьев, меню или таблицы данных базы данных.

> [!div class="step-by-step"]
> [Назад](asp-net-mvc-views-overview-vb.md)
> [Вперед](using-the-tagbuilder-class-to-build-html-helpers-vb.md)
