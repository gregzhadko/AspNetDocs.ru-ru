---
uid: mvc/overview/older-versions-1/views/creating-custom-html-helpers-vb
title: Создание настраиваемых вспомогательных функций HTML (VB) | Документация Майкрософт
author: microsoft
description: Цель этого руководства — показать, как можно создавать пользовательские вспомогательные методы HTML, которые можно использовать в представлениях MVC. Используя преимущества вспомогательного метода HTML...
ms.author: riande
ms.date: 10/07/2008
ms.assetid: f96f4800-19ef-44c0-b457-55e777eb5de8
msc.legacyurl: /mvc/overview/older-versions-1/views/creating-custom-html-helpers-vb
msc.type: authoredcontent
ms.openlocfilehash: aaeadde258a2855343a5bfb1e5ee76000e04f6bd
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74593878"
---
# <a name="creating-custom-html-helpers-vb"></a>Создание настраиваемых вспомогательных методов HTML (VB)

по [Майкрософт](https://github.com/microsoft)

[Загрузить PDF-файл](https://download.microsoft.com/download/1/1/f/11f721aa-d749-4ed7-bb89-a681b68894e6/ASPNET_MVC_Tutorial_9_VB.pdf)

> Цель этого руководства — показать, как можно создавать пользовательские вспомогательные методы HTML, которые можно использовать в представлениях MVC. Благодаря преимуществам вспомогательных функций HTML можно уменьшить объем утомительного ввода тегов HTML, которые необходимо выполнить для создания стандартной HTML-страницы.

Цель этого руководства — показать, как можно создавать пользовательские вспомогательные методы HTML, которые можно использовать в представлениях MVC. Благодаря преимуществам вспомогательных функций HTML можно уменьшить объем утомительного ввода тегов HTML, которые необходимо выполнить для создания стандартной HTML-страницы.

В первой части этого руководства я опишу некоторые из существующих вспомогательных функций HTML, входящих в состав платформы MVC ASP.NET. Далее я опишу два метода создания настраиваемых вспомогательных методов HTML: я объясню, как создавать настраиваемые вспомогательные методы HTML, создав общий метод и создав метод расширения.

## <a name="understanding-html-helpers"></a>Основные сведения о вспомогательных возможностях HTML

Вспомогательный объект HTML — это просто метод, который возвращает строку. Строка может представлять любой требуемый тип содержимого. Например, с помощью вспомогательных функций HTML можно визуализировать стандартные HTML-теги, такие как HTML `<input>` и теги `<img>`. Кроме того, можно использовать вспомогательные средства HTML для визуализации более сложного содержимого, такого как полоса вкладок или таблица HTML данных базы данных.

Платформа ASP.NET MVC включает следующий набор стандартных вспомогательных функций HTML (это не полный список):

- HTML. ActionLink ()
- HTML. Бегинформ ()
- HTML. CheckBox ()
- HTML. DropDownList ()
- HTML. Ендформ ()
- HTML. Hidden ()
- HTML. ListBox ()
- HTML. Password ()
- HTML. RadioButton ()
- HTML. TextArea ()
- HTML. TextBox ()

Например, рассмотрим форму в листинге 1. Эта форма отображается с помощью двух стандартных вспомогательных функций HTML (см. рис. 1). В этой форме используются вспомогательные методы `Html.BeginForm()` и `Html.TextBox()`.

[Страница ![, отображаемая с помощью вспомогательных функций HTML](creating-custom-html-helpers-vb/_static/image2.png)](creating-custom-html-helpers-vb/_static/image1.png)

**Рис. 01**. страница, отображаемая с помощью вспомогательных функций HTML ([щелкните, чтобы просмотреть изображение с полным размером](creating-custom-html-helpers-vb/_static/image3.png))

**Листинг 1 — `Views\Home\Index.aspx`**

[!code-aspx[Main](creating-custom-html-helpers-vb/samples/sample1.aspx)]

Вспомогательный метод `Html.BeginForm()` используется для создания открывающих и закрывающих тегов HTML `<form>`. Обратите внимание, что метод `Html.BeginForm()` вызывается в операторе using. Оператор using гарантирует, что тег `<form>` закрывается в конце блока using.

При желании вместо создания блока using можно вызвать вспомогательный метод HTML. Ендформ (), чтобы закрыть тег `<form>`. Используйте любой из подходов к созданию открывающего и закрывающего тега `<form>`, который кажется наиболее интуитивно понятным для вас.

Вспомогательные методы `Html.TextBox()` используются в листинге 1 для отрисовки HTML-тегов `<input>`. Если в браузере выбрать пункт Просмотреть источник, появится источник HTML в листинге 2. Обратите внимание, что источник содержит стандартные теги HTML.

> [!IMPORTANT]
> Обратите внимание, что вспомогательный модуль `Html.TextBox()`-HTML подготавливается к просмотру с помощью тегов `<%= %>`, а не `<% %>` тегов. Если не указать знак равенства, в браузере ничего не отображается.

Платформа ASP.NET MVC содержит небольшой набор вспомогательных функций. Скорее всего, вам потребуется расширить платформу MVC с помощью настраиваемых вспомогательных функций HTML. В оставшейся части этого руководства вы узнаете о двух методах создания пользовательских вспомогательных методов HTML.

**Листинг 2 — `Index.aspx Source`**

[!code-aspx[Main](creating-custom-html-helpers-vb/samples/sample2.aspx)]

### <a name="creating-html-helpers-with-shared-methods"></a>Создание вспомогательных методов HTML с общими методами

Самый простой способ создания нового вспомогательного метода HTML — создать общий метод, возвращающий строку. Представьте, например, что вы решили создать новый вспомогательный метод HTML, который визуализирует HTML-`<label>` тег. Для отображения `<label>`можно использовать класс в листинге 2.

**Листинг 2 — `Helpers\LabelHelper.vb`**

[!code-vb[Main](creating-custom-html-helpers-vb/samples/sample3.vb)]

В листинге 2 нет ничего особенного о классе. Метод `Label()` просто возвращает строку.

Измененное представление индекса в листинге 3 использует `LabelHelper` для визуализации тегов HTML `<label>`. Обратите внимание, что представление содержит директиву `<%@ imports %>`, которая импортирует пространство имен Application1. Вспомогательныеs.

**Листинг 2 — `Views\Home\Index2.aspx`**

[!code-aspx[Main](creating-custom-html-helpers-vb/samples/sample4.aspx)]

### <a name="creating-html-helpers-with-extension-methods"></a>Создание вспомогательных функций HTML с помощью методов расширения

Если вы хотите создать вспомогательные методы HTML, которые работают точно так же, как стандартные вспомогательные методы HTML, входящие в платформу ASP.NET MVC, то вам нужно создать метод расширения. Методы расширения позволяют добавлять новые методы в существующий класс. При создании вспомогательного метода HTML в класс `HtmlHelper` добавляются новые методы, представленные свойством HTML представления.

Модуль Visual Basic в листинге 3 добавляет метод расширения с именем `Label()` в класс `HtmlHelper`. Есть несколько вещей, которые следует заметить при работе с этим модулем. Во-первых, обратите внимание, что модуль снабжен атрибутом `<Extension()>`. Чтобы использовать этот атрибут, необходимо импортировать пространство имен `System.Runtime.CompilerServices`

Во вторых, обратите внимание, что первый параметр метода `Label()` представляет класс `HtmlHelper`. Первый параметр метода расширения указывает класс, который расширяет метод расширения.

**Листинг 3 — `Helpers\LabelExtensions.vb`**

[!code-vb[Main](creating-custom-html-helpers-vb/samples/sample5.vb)]

После создания метода расширения и успешного построения приложения метод расширения отображается в IntelliSense Visual Studio, как и все другие методы класса (см. рис. 2). Единственное отличие заключается в том, что методы расширения отображаются с специальным символом рядом с ними (значок со стрелкой вниз).

[![с помощью метода расширения HTML. Label ()](creating-custom-html-helpers-vb/_static/image5.png)](creating-custom-html-helpers-vb/_static/image4.png)

**Рис. 02**. использование метода расширения HTML. Label () ([щелкните, чтобы просмотреть изображение с полным размером](creating-custom-html-helpers-vb/_static/image6.png))

Измененное представление индекса в листинге 4 использует метод расширения HTML. Label () для отображения всех &lt;меток&gt; тегов.

**Листинг 4 — `Views\Home\Index3.aspx`**

[!code-aspx[Main](creating-custom-html-helpers-vb/samples/sample6.aspx)]

## <a name="summary"></a>Сводка

В этом руководстве вы узнали два метода создания пользовательских вспомогательных методов HTML. Во-первых, вы узнали, как создать пользовательский вспомогательный модуль HTML `Label()`, создав общий метод, возвращающий строку. Далее вы узнали, как создать пользовательский вспомогательный метод HTML `Label()`, создав метод расширения для класса `HtmlHelper`.

В этом учебнике мы посвящены созданию чрезвычайно простого вспомогательного метода HTML. Следует понимать, что вспомогательный метод HTML может быть сложным. Можно создавать вспомогательные средства HTML, которые отображают форматированное содержимое, например представления в виде дерева, меню или таблицы данных базы данных.

> [!div class="step-by-step"]
> [Назад](asp-net-mvc-views-overview-vb.md)
> [Вперед](using-the-tagbuilder-class-to-build-html-helpers-vb.md)
