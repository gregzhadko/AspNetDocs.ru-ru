---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/data-storage-options
title: Варианты хранения данных (Создание реальных облачных приложений в Azure) | Документация Майкрософт
author: MikeWasson
description: Создание реальных облачных приложений в условиях электронная книга основана на презентацию, разработанная Скоттом Гатри. Здесь объясняется, 13 шаблонов и практических рекомендаций, которые он может...
ms.author: riande
ms.date: 06/12/2014
ms.assetid: e51fcecb-cb33-4f9e-8428-6d2b3d0fe1bf
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/data-storage-options
msc.type: authoredcontent
ms.openlocfilehash: 9969a68a3e1aa043845fb5affd6d3b73dec4136d
ms.sourcegitcommit: 289e051cc8a90e8f7127e239fda73047bde4de12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2019
ms.locfileid: "58425396"
---
# <a name="data-storage-options-building-real-world-cloud-apps-with-azure"></a>Варианты хранения данных (Создание реальных облачных приложений в Azure)

по [Майк Уоссон](https://github.com/MikeWasson), [Рик Андерсон]((https://twitter.com/RickAndMSFT)), [том Дайкстра](https://github.com/tdykstra)

[Загрузить решение проект](http://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) или [скачайте электронную книгу](http://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)

> **Создание реальных облачных приложений в условиях Azure** электронная книга основана на презентацию, разработанная Скоттом Гатри. Здесь объясняется 13 шаблоны и рекомендации, которые помогут вам быть в успешном развертывании веб-приложений для облака. Сведения о книге, см. в разделе [первой главы](introduction.md).


Большинство людей, используются для реляционных баз данных, и они стремятся не заметить другие параметры хранения данных при их разработке облачного приложения. Результат может быть неоптимальную производительность, высокий уровень расходов или что еще хуже, так как [NoSQL](http://en.wikipedia.org/wiki/NoSQL) (нереляционных) баз данных может обрабатывать некоторые задачи более эффективно, чем реляционные базы данных. Когда клиенты обратиться за помощью в решении проблемы хранения важных данных, часто бывает так, как они имеют реляционную базу данных, где один из вариантов NoSQL работали бы лучше. В таких ситуациях клиента было бы лучше, если они уже реализована решение NoSQL, перед развертыванием приложения в рабочей среде.

С другой стороны также будет ошибка предположить, что база данных NoSQL может выполнять любые действия хорошо или достаточно хорошо. Выбора не предоставляется единый лучшие данные управления для любых задач хранения данных; для разных задач оптимизированы разные решения управления данными. Большинство реальных облачных приложений имеют различные требования к хранилищу данных и обслуживаются наиболее часто с помощью сочетания нескольких решений для хранения данных.

В этой главе предназначена для того, для предоставления более широком смысле варианты хранения данных, доступные для облачного приложения, а также представлены основные рекомендации по выбору, в соответствии со своим сценарием. Рекомендуется учитывать доступные параметры и подумать о свои сильные и слабые стороны, перед началом разработки приложения. Изменение параметров хранения данных в рабочем приложении могут быть весьма сложны, как изменить реактивного двигателя, пока плоскость рейсов.

## <a name="data-storage-options-on-azure"></a>Варианты хранения данных в Azure

Облаке относительно упрощает использование разнообразных реляционных и хранилищ данных NoSQL. Ниже приведены некоторые платформы хранения данных, которые можно использовать в Azure.

![](data-storage-options/_static/image1.png)

В таблице показаны четыре типа базы данных NoSQL.

- [Ключ/значение баз данных](https://msdn.microsoft.com/library/dn313285.aspx#sec7) хранить один сериализованный объект для каждого значения ключа. Они хорошо подходят для хранения больших объемов данных, где можно получить один элемент для определенного значения ключа, и у вас нет к запросу на основе других свойств элемента.

    [Хранилище BLOB-объектов](https://azure.microsoft.com/documentation/articles/storage-dotnet-how-to-use-blobs/) — это база данных ключ/значение, работающая как хранилища файлов в облаке, со значениями ключа, которые соответствуют именам файлов и папок. Полученный файл, папку и имя файла, а не приложением для поиска значений в содержимое файла.

    [Хранилище таблиц Azure](https://azure.microsoft.com/documentation/articles/storage-dotnet-how-to-use-tables/) также является базой данных ключ/значение. Каждое значение называется *сущности* (как строки, определяемая ключом раздела и ключ строки) и содержит несколько *свойства* (схожие с именами столбцов, но не всех сущностей в таблице должны иметь одинаковый столбцы). Запрос по столбцам, не являющегося ключом является крайне неэффективным и следует избегать. Например можно хранить данные профиля пользователя, с одной секцией, хранения информации о одного пользователя. Данные, такие как имя пользователя, хэш пароля, Дата рождения и т. д., можно хранить в отдельных свойств или в отдельных сущностях в одной секции. Но не требуется выполнять запросы для всех пользователей с помощью заданного диапазона дат рождения и не может выполнить запрос соединения между таблицей вашего профиля и другой таблицей. Хранилище таблиц является более масштабируемым и дешевле, чем реляционной базы данных, но он не позволяет использовать сложные запросы или соединения.
- [Documentdatabases](https://msdn.microsoft.com/library/dn313285.aspx#sec8) являются базами данных ключ/значение, в которых значения являются *документов*. «Документ» здесь не используется в том смысле, документа Word или Excel, но означает, что коллекция именованных полей и значений, в которых может быть дочернего документа. К примеру в таблицу журнала порядок документа заказа может быть номер заказа, дата заказа и поля клиентов; и поле «Клиент» может иметь имя и адрес поля. Базы данных выполняется поля данных в формате, например XML, YAML, JSON или BSON; или можно использовать обычный текст. Один компонент, который задает баз данных документов, помимо ключей и значений баз данных является возможность выполнять запросы для не содержащих ключи полей и определять дополнительные индексы, чтобы сделать запрос более эффективно. Эта возможность позволяет базу данных документов больше подходят для приложений, которые используются для извлечения данных, на основе критериев, сложнее, чем значение ключа документа. Например в базу данных документов История заказа на продажу создать запрос на различных факторов, включая идентификатор продукта, код клиента, имя клиента и т. д. [MongoDB](http://www.mongodb.org/) — это база данных документов.
- [Базы данных столбцов](https://msdn.microsoft.com/library/dn313285.aspx#sec9) содержат данные типа ключ значение данных, которые позволяют создавать структуру хранения данных в несколько коллекций связанных столбцов, называемых семействами столбцов. Например, база данных переписи населения может иметь одну группу столбцов для имени человека (во-первых, средний, последнего), одна группа для адрес пользователя и одной группой сведения профиля пользователя (DOB, пол и т. д.). Базы данных можно хранить каждое семейство столбцов в отдельной секции сохраняя все данные об определенном человеке и тому же ключу. Затем можно считывать все данные профиля без необходимости читать весь подобных сведений имя и адрес. [Cassandra](http://cassandra.apache.org/) — популярная база данных семейства столбцов.
- [Диаграммы баз данных](https://msdn.microsoft.com/library/dn313285.aspx#sec10) хранения информации в виде коллекции объектов и отношений. Базу данных графов предназначена для того, чтобы приложение могло эффективно выполнять запросы, которые проходят через сеть объектов и связей между ними. Например объекты могут являться сотрудники отдела кадров базы данных, и можно для упрощения запросов такие как «найти всех сотрудников, работающих непосредственно или косвенно Скотту.» [Neo4j](http://www.neo4j.org/) является популярным графовой базы данных.

По сравнению с реляционными базами данных, параметры NoSQL обеспечивают гораздо более высокую масштабируемость и экономическую эффективность хранения и анализа неструктурированных данных. Недостаток заключается в том, что они не предоставляют широкие возможности queryability и возможности обеспечения целостности данных, реляционных баз данных. NoSQL будет хорошо подходят для данных журнала IIS, который включает в себя большого объема без необходимости для запросов на соединение. NoSQL не будет работать надлежащим образом для банковских транзакций, который требуется абсолютный целостности и включает в себя много связей с другими данными, связанные с учетной записью.

Имеется также новая категория платформе базы данных с названием [NewSQL](http://en.wikipedia.org/wiki/NewSQL) , сочетает масштабируемость базы данных NoSQL с queryability и целостность транзакций реляционной базы данных. NewSQL баз данных предназначены для распределенного хранилища и обработки запросов, это часто бывает трудно реализовать в базах данных «OldSQL». [NuoDB](http://www.nuodb.com/) является примером NewSQL базы данных, который может использоваться в Azure.

<a id="hadoop"></a>
## <a name="hadoop-and-mapreduce"></a>Hadoop и MapReduce

Большие объемы данных, которые можно хранить в базах данных NoSQL может быть сложно эффективно анализировать своевременно. Для этого можно выполнить платформы вроде [Hadoop](http://hadoop.apache.org/) реализующий [MapReduce](http://en.wikipedia.org/wiki/MapReduce) функциональные возможности. По существу выполняет какие MapReduce процесс выглядит так:

- Ограничение объема данных, необходимо обработать, выбрав из данных хранить только данные, которые необходимо фактически выполнить анализ. К примеру вы хотите узнать состав базы за год рождения пользователей, чтобы выбрать только рождения лет из вашего хранилища данных профиля пользователя.
- Разбить данные на части и отправить их на разных компьютерах, для обработки. Компьютер A вычисляет количество людей, с датами 1950 1959, компьютер B выполняет 1960-1969, и т.д. Эта группа компьютеров называется *кластера Hadoop*.
- После завершения обработки на детали переключается результаты каждой части единое целое. Теперь у вас есть относительно короткий список сколько людей за каждый год рождения и вычислении процентных долей в этот список общей задачей является управляемой.

В Azure [HDInsight](https://azure.microsoft.com/services/hdinsight/) позволяет обрабатывать, анализировать и получить новую ценную информацию из больших данных, используя мощь Hadoop. Например можно использовать его для анализа журналов веб-сервера:

- Включите журналы веб-сервера для вашей учетной записи хранения. Это настраивает Azure для записи журналов в службе BLOB-объектов для каждого HTTP-запроса в приложение. Служба BLOB-объектов по сути является Облачное хранилище файлов, и она отлично интегрируется с HDInsight.

    ![Журналы хранилища больших двоичных объектов](data-storage-options/_static/image2.png)
- Как приложение получает трафик, журналы IIS веб-сервера, записываются в хранилище BLOB-объектов.

    ![Журналы веб-сервера](data-storage-options/_static/image3.png)
- На портале, щелкните **New** - **Data Services** - **HDInsight** - **быстрое создание**, и укажите имя кластера HDInsight, размер кластера (количество узлов данных HDInsight кластера) и имя пользователя и пароль для кластера HDInsight.

    ![HDInsight](data-storage-options/_static/image4.png)

Теперь можно настроить задания MapReduce для анализа журналов и получите ответы на вопросы, например:

- Какое время дня Мое приложение получить большинство или как минимум трафик?
- Мой трафик, поступающий из каких стран такое
- Каково среднее окружение доход областей, которые ли трафик поступает из. (Нет общедоступного набора данных, которая позволит вам окружение доход, IP-адрес, и совпадает с IP-адрес в журналы веб-сервера).
- Как доход окружение корреляция к конкретным страницам или продуктов на сайте?

Затем можно использовать ответы на вопросы, например для целевой рекламы, есть вероятность того, клиент может оказаться интересным или высокую вероятность приобретения конкретного продукта.

Как описано в [автоматизировать все, что глава](automate-everything.md), большинство функций, которые можно выполнять на портале можно автоматизировать и включающий в себя настройке и выполнении заданий HDInsight анализа. Типичный сценарий HDInsight может содержать следующие действия:

- Подготовка кластера HDInsight и свяжите его с вашей учетной записи хранения для входных данных хранилища BLOB-объектов.
- Отправка задания MapReduce исполняемые файлы (файлы .exe или .jar) в кластер HDInsight.
- Отправьте MapReduce, которая сохраняет выходные данные в хранилище BLOB-объектов.
- Дождитесь завершения задания.
- Удаление кластера HDInsight.
- Доступ к выходные данные из хранилища BLOB-объектов.

Запустив сценарий, который выполняет все это, можно свести к минимуму количество времени, подготовки кластера HDInsight, что сводит к минимуму затраты.

<a id="paasiaas"></a>
## <a name="platform-as-a-service-paas-versus-infrastructure-as-a-service-iaas"></a>Платформа как услуга (PaaS) и инфраструктуры как услуги (IaaS)

Варианты хранения данных, указанным выше типам относятся платформа как услуга (PaaS) и решений инфраструктуры как услуга (IaaS). PaaS означает, что мы управления инфраструктурой оборудования и программного обеспечения, и вы просто использовать службу. База данных SQL — это функция Azure PaaS. Задавать для баз данных, и за кулисами Azure устанавливает и настраивает виртуальные машины и настраивает базы данных на них. У вас нет прямого доступа к виртуальным машинам и нет необходимости управлять ими. IaaS означает, что настройка, Настройка и управление виртуальными машинами, которые работают в нашей инфраструктуры центров обработки данных и поместить незавершенной на них. Мы предоставляем коллекция предварительно настроенных образов виртуальных Машин для распространенных конфигураций виртуальной Машины. Например можно установить предварительно настроенных образов виртуальных Машин для Windows Server 2008, Windows Server 2012, BizTalk Server, Oracle WebLogic Server, базы данных Oracle, и т.д.

Представлены решения PaaS данные, которые предоставляет Azure.

- База данных SQL Azure (которая ранее называлась SQL Azure). Облачная реляционная база данных, на основе SQL Server.
- Хранилище таблиц Azure. Ключ/значение базы данных NoSQL.
- Хранилище BLOB-объектов. Хранилище файлов в облаке.

IaaS вы можете запустить все, что можно загрузить в виртуальную Машину, например:

- Реляционные базы данных, например SQL Server, Oracle, MySQL, SQL Compact, SQLite или Postgres.
- Например, Memcached, Redis, Cassandra и Riak хранилища данных ключ/значение.
- Хранилищ данных столбцов, таких как HBase.
- Базы данных документов MongoDB, CouchDB и RavenDB.
- Базы данных графов, таких как Neo4j.

![Варианты хранения данных в Azure](data-storage-options/_static/image5.png)

Параметр IaaS дает возможности хранения практически неограниченное количество данных, и многие из них являются особенно прост в использовании, так как можно создать с помощью предварительно настроенных образов виртуальных машин. Например, на портале управления перейдите к **виртуальных машин**, нажмите кнопку **образы** , а щелкните **Обзор VM Depot**.

![Обзор VM Depot](data-storage-options/_static/image6.png)

Появится список [сотни предварительно настроенных образов виртуальных Машин](http://www.hanselman.com/blog/Over400VirtualMachineImagesOfOpenSourceSoftwareStacksInTheVMDepotAzureGallery.aspx), и вы можете создать виртуальную Машину из образа с предварительно установленной системой управления базы данных, такие как MongoDB, Neo4J, Redis, Cassandra или CouchDB:

![MongoDB в хранилище виртуальных Машин](data-storage-options/_static/image7.png)

Azure позволяет же успехом можно использовать как возможные варианты хранения данных IaaS, но предложения PaaS имеют много преимуществ, которые делают их более экономичным и практические во многих сценариях:

- Не нужно создавать виртуальные машины, просто используйте портал или сценарий для настройки хранилища данных. Если требуется хранилище 200 ТБ данных, можно просто нажать кнопку или выполните команду, и в секундах она готова для использования.
- Не нужно контролировать или обновлять виртуальные машины, используемые службой; Майкрософт выполняет это автоматически.-не нужно беспокоиться о настройке инфраструктуры для масштабирования и высокого уровня доступности; Корпорация Майкрософт обеспечивает все, что для вас.
- Вам не нужно покупать лицензии; платы за лицензию на включены в плату за использование службы.
- Вы платите только за использование.

Варианты хранения данных PaaS в Azure включают предложения по сторонних поставщиков. Например, вы можете [надстройки MongoLab](https://azure.microsoft.com/documentation/articles/store-mongolab-web-sites-dotnet-store-data-mongodb/) из Azure Store, чтобы подготовить базу данных MongoDB как услуга.

## <a name="choosing-a-data-storage-option"></a>Выбор способа хранения данных

Не один подход подойдет для всех сценариев. Любой пользователь говорит, что эта технология является ответ, в первую очередь необходимо задать при «What is вопрос?», так как различные решения оптимизированы для выполнения различных задач. Существуют очевидные преимущества реляционной модели; Вот почему ее вокруг так долго. Но существуют также вниз сторон SQL, которые могут быть исправлены с помощью решения NoSQL.

Часто что мы видим, лучше всего работают это композиционный подход, где используется SQL и NoSQL, в рамках одного решения. Даже когда говорят, они принятии NoSQL, если вы более подробно действиями можно часто найти, что они используют несколько разных инфраструктур NoSQL: они используют [CouchDB](http://wiki.apache.org/couchdb/Introduction), и [Redis](http://redis.io/)и [ Riak](http://basho.com/riak/) для выполнения различных задач. Даже Facebook, который широко использует NoSQL, использует разные платформы NoSQL для разных частей службы. Возможность смешивать и сочетать подходах к хранению данных — одна из вещей, которые хорошо об облаке, так как он является удобство использования нескольких решений данных и интегрировать их в одном приложении.

Ниже приведены некоторые вопросы, рассматривать при выборе подхода:

| Данные семантической | -Новые возможности ядра хранения данных и доступа к данным семантической (вы храните реляционной или неструктурированными данными)? Неструктурированные данные, такие как файлы мультимедиа подходит в хранилище BLOB-объектов; Коллекция связанных данных, такие как продукты, инвентаризация, поставщики, заказов клиентов, и т.д., лучше всего подходит в реляционной базе данных. |
| --- | --- |
| Поддержка запросов | -Насколько это просто для обращения к данным? -Новые типы вопросов можно эффективно задаваемые? Хранилище ключей и значений данных являются очень удобен для получения одной строки, учитывая значение ключа, но не так хорошо для сложных запросов. Для пользователя профиля хранилища данных где вы всегда получаете данные для одного конкретного пользователя в хранилище данных "ключ значение" могла работать каталог продукции, где можно получить разные группы на основе различных атрибутов продукта реляционной базы данных может работать лучше. Базы данных NoSQL может хранить большие объемы данных, эффективно, но имеется структурировать базе вокруг как приложение запрашивает данные, и это делает труднее выполнять нерегламентированные запросы. В реляционной базе данных можно создавать практически любой тип запроса. |
| Функциональное проекции | — Может вопросы, агрегаты и др., выполненных на стороне сервера? Если я использую SELECT COUNT (\*) из таблицы в SQL, она будет очень эффективно всю работу на сервере и возвращать число, я ищу. Если я хочу такой же расчет с хранилищем данных NoSQL, которое не поддерживает агрегирование, это неэффективным «unbounded запрос» и, вероятно, выдаст ошибку времени ожидания. Даже если запрос выполнен успешно, мне нужно получить все данные с сервера на клиент и подсчета количества строк на стороне клиента. — Какие языки или типы выражений можно использовать? В реляционной базе данных используется SQL. В некоторых базах данных NoSQL, таких как хранилище таблиц Azure, я буду использовать [OData](http://www.odata.org/), и я могу сделать всего фильтрации на первичный ключ и получить проекции (Выбор подмножества доступных полей). |
| Простота масштабирования | — Как часто и как будет много данных требуется масштабирование? — Не платформы в собственном коде реализовать горизонтальное масштабирование? -Насколько это просто добавить или удалить емкость (размер и пропускной способности)? Реляционных баз данных и таблиц не секционирована автоматически чтобы сделать их масштабируемости, так, чтобы они тяжело поддающихся масштабированию за определенные ограничения. Все, что по своей природе разбивать хранилищ данных NoSQL, такие как хранилище таблиц Azure и почти не ограничено для добавления секций. Вы можете легко изменять хранилище таблиц до 200 ТБ, но ее максимальный размер для базы данных SQL Azure — 500 ГБ. Вы можете масштабировать реляционные данные, разделяя их на несколько баз данных, но настройка приложения для поддержки этой модели состоит из массу программирования работы. |
| Инструментирование и управляемость | -Насколько просто платформы инструментирования, отслеживать и управлять ими? Вам потребуется получайте информацию о работоспособности и производительности хранилища данных, поэтому необходимо заранее знать, какие метрики платформы позволяет бесплатно, а какие необходимо разработать самостоятельно. |
| Операции | -Как просто — это платформа для развертывания и запуска в Azure? PaaS? IaaS? Linux? Хранилище таблиц и базы данных SQL можно легко настроить в Azure. Платформы, которые не являются встроенными решениями Azure PaaS требует больших усилий. |
| Поддержка API | — Это доступных API, который позволяет легко работать с платформой? Для службы таблиц Azure есть пакет SDK с помощью API .NET, который поддерживает асинхронную модель программирования .NET 4.5. Если вы создаете приложение .NET, окажется гораздо проще писать и тестировать код для службы таблиц Azure, по сравнению с другой ключ/значение столбца данных платформа для магазина с интерфейс API или менее комплексное один. |
| Транзакционная целостность и согласованность данных | -Это критическое, что платформа поддерживает транзакции для обеспечения согласованности данных? Для отслеживания массового отправляемым, производительность и затраты на хранение данных может быть важнее, чем поддержка автоматического для транзакции или целостность платформы данных, что делает службу таблиц Azure хорошим выбором. Для отслеживания банковского счета, сальдо или платформы реляционных баз данных, который предоставляет надежные гарантии транзакций будет лучшим выбором заказы на покупку. |
| Непрерывность бизнес-процессов | — Резервное копирование, восстановление и аварийное восстановление как просто? Рано или поздно рабочие данные будут повреждены, и вам потребуется функция отмены. Реляционные базы данных часто имеют дополнительные возможности точного восстановления, такие как возможность восстановления до точки во времени. Основные сведения о функциях восстановления, доступных в каждой платформы, которую вы рассматриваете является важным фактором, которые следует учитывать. |
| Стоимость | — Если более чем одна платформа может поддерживать данные рабочей нагрузки, чем они отличаются в затрат? Например если вы используете ASP.NET Identity, можно хранить данные профиля пользователя в службу таблиц Azure или базы данных SQL Azure. Если вам не нужны средства базы данных SQL запроса широкий набор функций, можно выбрать таблицы Azure отчасти потому, что это стоит большую меньше заданного объема хранилища. |

Что обычно рекомендуется изучать ответов на вопросы в каждой из этих категорий, прежде чем выбрать решений для хранения данных.

Кроме того рабочая нагрузка может иметь особые требования, некоторые платформы может поддерживать лучше, чем другие. Пример:

- Выполняет требования вашего приложения, аудит возможности?
- Каковы требования к долговечности данных — нужен возможности автоматизированной архивации или очистки?
- У вас есть особые параметры безопасности потребности? Например они включают в себя PII (персональные данные), но у вас есть возможность убедитесь в том, что персональных данных исключается из результатов запроса.
- Если у вас есть некоторые данные, которые не могут храниться в облаке в целях соответствия требованиям или технологий, может потребоваться облачная платформа хранилища данных, которая облегчает интеграцию с локальным хранилищем.

## <a name="demo--using-sql-database-in-azure"></a>Демонстрация — с помощью базы данных SQL в Azure

Приложение Fix It использует реляционную базу данных для хранения задач. Сценарий Windows PowerShell создание среды, показанный на [автоматизировать все, что глава](automate-everything.md) создает два экземпляра базы данных SQL. В портале можно увидеть, щелкнув **баз данных SQL** вкладки.

![Базы данных SQL на портале](data-storage-options/_static/image8.png)

Это также облегчает создание баз данных с помощью портала.

Нажмите кнопку **новые--Data Services** -- **базы данных SQL** -- **быстрое создание**, введите имя базы данных, выберите сервер, у вас уже есть в вашей учетной записи или создайте новую, а затем нажмите кнопку **создать базу данных SQL**.

![Новая база данных SQL](data-storage-options/_static/image9.png)

Подождите несколько секунд, и имеется база данных в Azure, вы сможете использовать.

![Создать новую базу данных SQL](data-storage-options/_static/image10.png)

Поэтому Azure в несколько секунд, что потребуется день или в неделю или больше времени для выполнения в локальной среде. И поскольку баз данных можно легко создать автоматически, в скрипте или с помощью API управления, вы можете динамически масштабировать за счет распределения данных по нескольким базам данных, до тех пор, пока для этого приложения был запрограммирован.

Ниже приведен пример нашей модели платформы как службы. Не нужно управлять серверами, мы сделали это. Вам не нужно беспокоиться о резервных копиях, мы сделали это. Он работает в высокого уровня доступности данных в базе данных автоматически реплицируется на трех серверах. Если компьютер выходит из строя, мы автоматически выполнить отработку отказа, и вы потеряете данные. Сервер будет заполнена регулярно, не нужно беспокоиться об этом.

Нажмите кнопку и получить строку подключения, точное и немедленно приступите с помощью новой базы данных.

![Строки подключения](data-storage-options/_static/image11.png)

На панели мониторинга отображаются, историю соединений и объем используемого хранилища.

![Панель мониторинга базы данных SQL](data-storage-options/_static/image12.png)

Вы можете управлять базами данных на портале или с помощью средств SQL Server вы уже знакомы, в том числе SQL Server Management Studio (SSMS) и инструменты Visual Studio, обозреватель объектов SQL Server (SSOX) и обозревателя сервера.

![SSOX](data-storage-options/_static/image13.png)

Еще одно достоинство используется модель ценообразования. Вы можете начать разработку с бесплатную базу данных 20 МБ, а производственной базы данных начинается около 5 долл. США в месяц. Вы платите только за объем данных, которые хранятся в базе данных, не максимальной емкости. Не нужно покупать лицензию.

База данных SQL — легко масштабировать. Fix It приложения базы данных, которые будут созданы в наш сценарий автоматизации составляет 1 ГБ ОЗУ. Если вы хотите масштабировать его до 150 ГБ ОЗУ, вы можете перейти на портал и измените значение этого параметра или выполнение команды REST API, и в секундах имеется 150 ГБ базы данных, которую можно развернуть данные.

![Размеры и выпусках базы данных SQL](data-storage-options/_static/image14.png)

Это возможности облака для инфраструктуры быстро и легко, а также начали ее немедленно.

Приложение Fix It использует две базы данных SQL, один для членства (проверка подлинности и авторизации) и один для данных, и это все, что нужно сделать, чтобы подготовить их к работе и масштабировать его. Вы уже видели как подготовить базы данных посредством сценариев Windows PowerShell, и теперь вы также знаете, насколько это просто сделать на портале.

## <a name="entity-framework-versus-direct-database-access-using-adonet"></a>Entity Framework и прямой базы данных access с помощью ADO.NET

Приложение Fix It получает доступ к этим базам данных с помощью Entity Framework, рекомендованное корпорацией Майкрософт ORM (объектно реляционного сопоставления) для приложений .NET. ORM — отличный инструмент, упрощающий производительности труда разработчиков, но производительность достигается за счет снижение производительности в некоторых сценариях. В реальном облачном приложении вы не будете вносить Выбор между EF или напрямую с помощью ADO.NET (вы используете оба). В большинстве случаев при написании кода, который работает с базой данных, достижении максимальной производительности не является критически важным, и вы можете воспользоваться преимуществами упрощенное создание кода и тестирования, что вы получаете с Entity Framework. В ситуациях, где издержки EF вызовет снижение производительности можно написать и выполнить запросы с помощью ADO.NET, в идеале, вызывая хранимые процедуры.

Любой метод, который позволяет получить доступ к базе данных, необходимо свести к минимуму насколько он «разговорчивый» как можно больше. Другими словами Если можно получить все необходимые данные в один большего размера результирующего набора запроса вместо того чтобы десятки и сотни более мелкие варианты, это обычно предпочтительнее, чем. Например если требуется список учащихся и курсы, которые их регистрации в, обычно лучше для получения всех данных в запрос одного соединения, а не начало студентов в одном запросе и выполнение отдельных запросов для каждого учащегося курсов.

## <a name="sql-databases-and-the-entity-framework-in-the-fix-it-app"></a>Базы данных SQL и Entity Framework в приложении Fix It

В приложении Fix It `FixItContext` класс, который является производным от Entity Framework `DbContext` класса, определяющий базу данных и указывает таблицы в базе данных. Контекст задает набор сущностей (таблица), для выполнения задач, а код передает в контексте имя строки подключения. Это имя ссылается на строку подключения, которая определена в файле Web.config.

[!code-csharp[Main](data-storage-options/samples/sample1.cs?highlight=4,8)]

Строку подключения в *Web.config* файл называется appdb (здесь это значение указывает на базе локальной разработки):

[!code-xml[Main](data-storage-options/samples/sample2.xml?highlight=3)]

Entity Framework создает *FixItTasks* таблицы на основе свойств, включенных в `FixItTask` класс сущностей. Это простой класс POCO (обычные старые объекты среды CLR), который означает, что он не наследует или используете зависимости от платформы Entity Framework. Но известно, как создать таблицу, на его основе Entity Framework и выполнения операций CRUD (создать прочитать обновить удалить), с ним.

[!code-csharp[Main](data-storage-options/samples/sample3.cs)]

![Таблица FixItTasks](data-storage-options/_static/image15.png)

Приложение Fix It включает интерфейс репозитория, который будет использован для операций CRUD, работе с хранилищем данных.

[!code-csharp[Main](data-storage-options/samples/sample4.cs)]

Обратите внимание, что методы репозитория все async для доступа ко всем данным можно сделать полностью асинхронным образом.

Реализация вызывает репозитория Entity Framework асинхронные методы для работы с данными, включая запросы LINQ, а также как и для вставки, обновления и удаления операций. Ниже приведен пример кода для поиска задачу Fix It.

[!code-csharp[Main](data-storage-options/samples/sample5.cs)]

Можно заметить, есть также некоторые времени и коду ведения журнала ошибок, мы рассмотрим, позже на [мониторинг и данные телеметрии глава](monitoring-and-telemetry.md).

<a id="sqliaas"></a>
## <a name="choosing-sql-database-paas-versus-sql-server-in-a-vm-iaas-in-azure"></a>Выбор базы данных SQL (PaaS) и SQL Server на виртуальной Машине (IaaS) в Azure

Приятная особенность SQL Server и базы данных SQL Azure является базовой модели программирования для них идентичны. В обеих средах могут использовать большую часть тех же навыков. Можно даже использовать базу данных SQL Server в разработке и экземпляр базы данных SQL в облаке, который является настройка приложения ее исправить.

Кроме того можно запустить же SQL Server в облаке запустить в локальной, установив его на виртуальных машинах IaaS. Для некоторых старых приложениях под управлением SQL Server на виртуальной Машине может быть более удачное решение. Так как базы данных SQL Server выполняется на выделенной виртуальной Машине, он имеет несколько ресурсов, доступных для его чем в базе данных базы данных SQL, который выполняется на сервере с общим доступом. Это означает, что базы данных SQL Server может быть больше и по-прежнему выполняются надлежащим образом. Как правило чем меньше размер базы данных и размер таблицы, тем лучше варианта использования работает для базы данных SQL (PaaS).

Ниже приведены некоторые рекомендации по выбору между двумя моделями.

| База данных Azure SQL (PaaS) | SQL Server на виртуальной машине (IaaS) |
| --- | --- |
| **Специалисты** -нет необходимости создания или управлять виртуальными машинами, обновления или исправления ОС или SQL; Azure делает это для вас. -Встроенный высокий уровень доступности, для соглашения об уровне ОБСЛУЖИВАНИЯ на уровне базы данных. -Низкой совокупной стоимости владения (TCO), так как вы платите только за используемые (лицензия не требуется). -Хорошо подходит для обработки большого количества небольших баз данных (&lt;= 500 ГБ). -Простой для динамического создания новых баз данных, чтобы включить горизонтального масштабирования. | ***Специалисты*** - функция совместимой с локального сервера SQL. — Может реализовывать SQL Server [высокого уровня доступности с помощью AlwaysOn](https://www.microsoft.com/sqlserver/solutions-technologies/mission-critical-operations/high-availability.aspx) в 2 + виртуальными машинами с уровня виртуальной Машины соглашение об уровне ОБСЛУЖИВАНИЯ. — Вы получаете полный контроль над управлении SQL. -Можно повторно использовать лицензии SQL, вы уже владеете, или платите по часам для одного. -Хорошо подходит для обработки меньше, но большего размера (1 ТБ +) баз данных. |
| **Недостатки** -некоторые условия пропуски, по сравнению с локальным SQL Server (отсутствия [интеграция со средой CLR](https://technet.microsoft.com/library/ms131102.aspx), [TDE](https://technet.microsoft.com/library/bb934049.aspx), [поддержка сжатия](https://technet.microsoft.com/library/cc280449.aspx), [SQL Server Службы Reporting Services](https://technet.microsoft.com/library/ms159106.aspx)т. д.) — максимальный размер базы данных в 500 ГБ. | ***Недостатки*** - исправлений или обновлений (операционной системы и SQL) вы несете ответственность за - создание и управление баз данных SQL вы несете ответственность за - диск операций ввода-ВЫВОДА (операции ввода вывода в секунду) ограничен около 8000 (с помощью дисков с данными 16). |

Если вы хотите использовать SQL Server на виртуальной Машине, можно использовать собственную лицензию SQL Server или оплата может производиться по одной по часам. Например на портале или с помощью REST API можно создать новую виртуальную Машину с помощью образа SQL Server.

![Создание виртуальной Машины с SQL Server](data-storage-options/_static/image16.png)

![Список образов виртуальных Машин SQL Server](data-storage-options/_static/image17.png)

При создании виртуальной Машины с помощью образа SQL Server, тарифа мы делим стоимость лицензии SQL Server по часам, в зависимости от использования виртуальной машины. Если у вас есть проект, если он будет работать в течение несколько месяцев, дешевле для оплаты по часам. Если вы считаете, что проект собирается последнего года, это недорого купить лицензии так, как в обычном режиме.

## <a name="summary"></a>Сводка

Облачные вычисления, делающую целесообразным смешивать и подходах к хранению данных совпадения наиболее соответствует потребностям приложения. Если вы создаете новое приложение, тщательно продумайте вопросы, перечисленные здесь, чтобы выбрать подходы, которые будут работать также в том случае, когда увеличения объема данных приложения. [Следующей главе](data-partitioning-strategies.md) объясню некоторые стратегии секционирования, которые можно использовать для объединения нескольких подходах к хранению данных.

## <a name="resources"></a>Ресурсы

Дополнительные сведения см. в следующих ресурсах.

Выбор платформы базы данных:

- [Доступ к данным для масштабируемых решений: С помощью SQL, NoSQL и Polyglot Persistence](https://aka.ms/dag-doc). Электронная книга Microsoft Patterns and Practices подробно разбирает различные виды данных хранит доступны для облачных приложений.
- [Microsoft Patterns and Practices — руководство по Azure](https://msdn.microsoft.com/library/ff898430.aspx). См. руководство по согласованности данных, репликация данных и синхронизации рекомендации, шаблон таблицы индексов, шаблон материализованного представления.
- [БАЗОВЫЙ: Альтернативы Acid](http://queue.acm.org/detail.cfm?id=1394128). Статьи о компромиссы между согласованностью данных и масштабируемости.
- [Семь баз данных через семь недель: Руководство по современных баз данных и перемещение NoSQL](https://www.amazon.com/Seven-Databases-Weeks-Modern-Movement/dp/1934356921). Книги, Эрик Redmond и Jim R. Wilson. Настоятельно рекомендуется для премьера спектр современных платформ хранилища данных.

Выбор между SQL Server и базы данных SQL:

- [Руководство по базе данных SQL предварительной версии "премиум"](https://msdn.microsoft.com/library/windowsazure/dn369873.aspx). Введение в базы данных SQL уровня "премиум", а также рекомендации по выбору его над выпусками базы данных SQL Web и Business.
- [Рекомендации и ограничения (база данных Azure SQL)](https://msdn.microsoft.com/library/windowsazure/ff394102.aspx). Страница портала, ссылки на документацию об ограничениях базы данных SQL, включая те, что рассматриваются возможности SQL Server этой базы данных SQL не поддерживает.
- [SQL Server в виртуальных машинах](https://msdn.microsoft.com/library/windowsazure/jj823132.aspx). Страница портала, ссылки на документацию о запуске SQL Server в Azure.
- [Скотт Гатри объясняет базах данных SQL Azure](https://azure.microsoft.com/documentation/videos/sql-in-azure-scottgu/). 6-минутное видео с введением в базу данных SQL с (Scott Guthrie).
- [Шаблоны приложений и стратегии разработки для SQL Server в виртуальных машинах](https://msdn.microsoft.com/library/windowsazure/dn574746.aspx).

С помощью Entity Framework и базы данных SQL в веб-приложение ASP.NET

- [Начало работы с EF 6 с помощью MVC 5](../../../../mvc/overview/getting-started/getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application.md). Девять серии руководств, подробно рассматривается создание приложения MVC, который использует EF и развертывание базы данных Azure и базы данных SQL.
- [Веб-развертывание ASP.NET с помощью Visual Studio](../../../../web-forms/overview/deployment/visual-studio-web-deployment/introduction.md). 12 серии руководств, идущий подробными сведениями о том, как развернуть базу данных с использованием EF Code First.
- [Развертывание безопасного приложения ASP.NET MVC 5 с членством, OAuth и базой данных SQL Azure веб-узел](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-deploy-aspnet-mvc-app-membership-oauth-sql-database/). Пошаговое руководство, в котором рассматривается создание веб-приложения, которое использует проверку подлинности, сохраняет приложения таблиц в базе данных членства, изменяет схему базы данных и развертывает приложение в Azure.
- [Схема содержимого для доступа к данным ASP.NET](https://go.microsoft.com/fwlink/p/?LinkId=282414). Ссылки на ресурсы для работы с EF и базы данных SQL.

С помощью MongoDB в Azure:

- [MongoLab - MongoDB в Azure](http://msopentech.com/opentech-projects/mongolab-mongodb-on-windows-azure/). Страница портала документацию об использовании MongoDB на платформе Azure.
- [Создание веб-сайта, который подключается к MongoDB, работающей на виртуальной машине в Azure в Azure](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-store-data-mongodb-vm/). Пошаговое руководство, где показано, как использовать базу данных MongoDB в веб-приложения ASP.NET.

HDInsight (Hadoop в Azure):

- [HDInsight](https://azure.microsoft.com/documentation/services/hdinsight/). Портала в документации HDInsight [Azure](https://azure.microsoft.com/) веб-сайта.
- [Hadoop и HDInsight: Большие данные в Azure](https://msdn.microsoft.com/magazine/dn385705.aspx). Статья журнала MSDN Magazine, Бруно Теркали и Рикардо Виллалобос, знакомство с Hadoop в Azure.
- [Microsoft Patterns and Practices — руководство по Azure](https://msdn.microsoft.com/library/dn568099.aspx). Шаблон MapReduce см. в разделе.

> [!div class="step-by-step"]
> [Назад](single-sign-on.md)
> [Вперед](data-partitioning-strategies.md)
