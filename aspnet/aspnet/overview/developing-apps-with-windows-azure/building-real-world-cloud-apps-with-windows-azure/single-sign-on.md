---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/single-sign-on
title: Единый вход (создание облачных приложений в реальном мире с помощью Azure) | Документация Майкрософт
author: MikeWasson
description: Создание реальных облачных приложений с помощью электронной книги Azure основано на презентации, разработанной Скотт Гатри (. В нем объясняются 13 шаблонов и методик, которые могут...
ms.author: riande
ms.date: 06/12/2014
ms.assetid: 7d82d5e9-0619-4f22-9e03-32a6d52940a5
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/single-sign-on
msc.type: authoredcontent
ms.openlocfilehash: 7e32f444dc38132296cffd45ac658f5abf51f314
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74585284"
---
# <a name="single-sign-on-building-real-world-cloud-apps-with-azure"></a><span data-ttu-id="ef7e4-104">Единый вход (создание облачных приложений в реальном мире с помощью Azure)</span><span class="sxs-lookup"><span data-stu-id="ef7e4-104">Single Sign-On (Building Real-World Cloud Apps with Azure)</span></span>

<span data-ttu-id="ef7e4-105">[Майк Уоссон](https://github.com/MikeWasson), [Рик Андерсон (]((https://twitter.com/RickAndMSFT)), том [Dykstra)](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="ef7e4-105">by [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson]((https://twitter.com/RickAndMSFT)), [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="ef7e4-106">[Скачивание решения ИТ-проекта](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) или [Загрузка электронной книги](https://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span><span class="sxs-lookup"><span data-stu-id="ef7e4-106">[Download Fix It Project](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) or [Download E-book](https://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span></span>

> <span data-ttu-id="ef7e4-107">**Создание реальных облачных приложений с помощью** электронной книги Azure основано на презентации, разработанной Скотт Гатри (.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-107">The **Building Real World Cloud Apps with Azure** e-book is based on a presentation developed by Scott Guthrie.</span></span> <span data-ttu-id="ef7e4-108">В нем объясняются 13 шаблонов и методик, которые могут помочь в успешной разработке веб-приложений для облака.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-108">It explains 13 patterns and practices that can help you be successful developing web apps for the cloud.</span></span> <span data-ttu-id="ef7e4-109">Сведения о электронной книге см. [в первой главе](introduction.md).</span><span class="sxs-lookup"><span data-stu-id="ef7e4-109">For information about the e-book, see [the first chapter](introduction.md).</span></span>

<span data-ttu-id="ef7e4-110">При разработке облачного приложения существует множество проблем безопасности, но в этой серии мы рассмотрим только один вход.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-110">There are many security issues to think about when you're developing a cloud app, but for this series we'll focus on just one: single sign-on.</span></span> <span data-ttu-id="ef7e4-111">Вопрос часто спрашивают: «я в основном создаю приложения для сотрудников моей компании; как разместить эти приложения в облаке и по-прежнему позволить им использовать ту же модель безопасности, которую мои сотрудники узнают и используете в локальной среде, когда они работают с приложениями, размещенными в брандмауэре?</span><span class="sxs-lookup"><span data-stu-id="ef7e4-111">A question people often ask is this: "I'm primarily building apps for the employees of my company; how do I host these apps in the cloud and still enable them to use the same security model that my employees know and use in the on-premises environment when they're running apps that are hosted inside the firewall?"</span></span> <span data-ttu-id="ef7e4-112">Один из способов включения этого сценария называется Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="ef7e4-112">One of the ways we enable this scenario is called Azure Active Directory (Azure AD).</span></span> <span data-ttu-id="ef7e4-113">Azure AD позволяет делать корпоративные бизнес-приложения, доступные через Интернет, а также предоставлять доступ к этим приложениям для бизнес-партнеров.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-113">Azure AD enables you to make enterprise line-of-business (LOB) apps available over the Internet, and it enables you to make these apps available to business partners as well.</span></span>

## <a name="introduction-to-azure-ad"></a><span data-ttu-id="ef7e4-114">Введение в Azure AD</span><span class="sxs-lookup"><span data-stu-id="ef7e4-114">Introduction to Azure AD</span></span>

<span data-ttu-id="ef7e4-115">[Azure AD](https://docs.microsoft.com/azure/active-directory/) предоставляет [Active Directory](https://msdn.microsoft.com/library/windows/desktop/aa746492.aspx) в облаке.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-115">[Azure AD](https://docs.microsoft.com/azure/active-directory/) provides [Active Directory](https://msdn.microsoft.com/library/windows/desktop/aa746492.aspx) in the cloud.</span></span> <span data-ttu-id="ef7e4-116">К основным функциям относятся следующие.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-116">Key features include the following:</span></span>

- <span data-ttu-id="ef7e4-117">Она интегрируется с локальными Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-117">It integrates with on-premises Active Directory.</span></span>
- <span data-ttu-id="ef7e4-118">Он обеспечивает единый вход в приложения.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-118">It enables single sign-on with your apps.</span></span>
- <span data-ttu-id="ef7e4-119">Он поддерживает открытые стандарты, такие как [SAML](http://en.wikipedia.org/wiki/SAML_2.0), [WS-подача](http://en.wikipedia.org/wiki/WS-Federation)и [OAuth 2,0](http://oauth.net/2/).</span><span class="sxs-lookup"><span data-stu-id="ef7e4-119">It supports open standards such as [SAML](http://en.wikipedia.org/wiki/SAML_2.0), [WS-Fed](http://en.wikipedia.org/wiki/WS-Federation), and [OAuth 2.0](http://oauth.net/2/).</span></span>
- <span data-ttu-id="ef7e4-120">Он поддерживает корпоративный [график REST API](https://msdn.microsoft.com/library/hh974476.aspx).</span><span class="sxs-lookup"><span data-stu-id="ef7e4-120">It supports Enterprise [Graph REST API](https://msdn.microsoft.com/library/hh974476.aspx).</span></span>

<span data-ttu-id="ef7e4-121">Предположим, что у вас есть локальная среда Windows Server Active Directory, с помощью которой сотрудники смогут входить в приложения интрасети:</span><span class="sxs-lookup"><span data-stu-id="ef7e4-121">Suppose you have an on-premises Windows Server Active Directory environment that you use to enable employees to sign on to Intranet apps:</span></span>

![](single-sign-on/_static/image1.png)

<span data-ttu-id="ef7e4-122">Что позволяет Azure AD создать каталог в облаке.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-122">What Azure AD enables you to do is create a directory in the cloud.</span></span> <span data-ttu-id="ef7e4-123">Это бесплатная функция, которую можно легко настроить.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-123">It's a free feature and easy to set up.</span></span>

<span data-ttu-id="ef7e4-124">Оно может быть полностью независимым от локального Active Directory; Вы можете поместить в него всех пользователей и проверить их подлинность в приложениях Интернета.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-124">It can be entirely independent from your on-premises Active Directory; you can put anyone you want in it and authenticate them in Internet apps.</span></span>

![Active Directory в Windows Azure](single-sign-on/_static/image2.png)

<span data-ttu-id="ef7e4-126">Вы также можете интегрировать его с локальной службой AD.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-126">Or you can integrate it with your on-premises AD.</span></span>

![Интеграция AD и WAAD](single-sign-on/_static/image3.png)

<span data-ttu-id="ef7e4-128">Теперь все сотрудники, которые могут проходить проверку подлинности в локальной среде, также могут пройти проверку подлинности через Интернет — без необходимости открывать брандмауэр или развертывать новые серверы в центре обработки данных.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-128">Now all the employees who can authenticate on-premises can also authenticate over the Internet – without you having to open up a firewall or deploy any new servers in your data center.</span></span> <span data-ttu-id="ef7e4-129">Вы можете продолжить использовать всю имеющуюся среду Active Directory, которую вы узнаете и используете сегодня, чтобы предоставить внутренним приложениям возможность единого входа.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-129">You can continue to leverage all the existing Active Directory environment that you know and use today to give your internal apps single-sign on capability.</span></span>

<span data-ttu-id="ef7e4-130">После создания подключения между AD и Azure AD можно также включить веб-приложения и мобильные устройства для проверки подлинности сотрудников в облаке. Кроме того, вы можете включить сторонние приложения, такие как Office 365, SalesForce.com или Google Apps, чтобы принять ваши учетные данные сотрудников.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-130">Once you've made this connection between AD and Azure AD, you can also enable your web apps and your mobile devices to authenticate your employees in the cloud, and you can enable third-party apps, such as Office 365, SalesForce.com, or Google apps, to accept your employees' credentials.</span></span> <span data-ttu-id="ef7e4-131">Если вы используете Office 365, вы уже настроили Azure AD, так как Office 365 использует Azure AD для проверки подлинности и авторизации.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-131">If you're using Office 365, you're already set up with Azure AD because Office 365 uses Azure AD for authentication and authorization.</span></span>

![сторонние приложения](single-sign-on/_static/image4.png)

<span data-ttu-id="ef7e4-133">Преимуществом этого подхода является то, что каждый раз, когда ваша организация добавляет или удаляет пользователя или изменяет пароль, вы используете тот же процесс, который используется в локальной среде в настоящее время.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-133">The beauty of this approach is that any time your organization adds or deletes a user, or a user changes a password, you use the same process that you use today in your on-premises environment.</span></span> <span data-ttu-id="ef7e4-134">Все локальные изменения AD автоматически распространяются в облачную среду.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-134">All of your on-premises AD changes are automatically propagated to the cloud environment.</span></span>

<span data-ttu-id="ef7e4-135">Если ваша компания использует или переходит на Office 365, хорошая новость заключается в том, что Azure AD настроен автоматически, так как Office 365 использует Azure AD для проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-135">If your company is using or moving to Office 365, the good news is that you'll have Azure AD set up automatically because Office 365 uses Azure AD for authentication.</span></span> <span data-ttu-id="ef7e4-136">Поэтому вы можете легко использовать в собственных приложениях ту же проверку подлинности, которую использует Office 365.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-136">So you can easily use in your own apps the same authentication that Office 365 uses.</span></span>

## <a name="set-up-an-azure-ad-tenant"></a><span data-ttu-id="ef7e4-137">Настройка клиента Azure AD</span><span class="sxs-lookup"><span data-stu-id="ef7e4-137">Set up an Azure AD tenant</span></span>

<span data-ttu-id="ef7e4-138">Каталог Azure AD называется [клиентом](https://technet.microsoft.com/library/jj573650.aspx)Azure AD, и Настройка клиента довольно проста.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-138">an Azure AD directory is called an Azure AD [tenant](https://technet.microsoft.com/library/jj573650.aspx), and setting up a tenant is pretty easy.</span></span> <span data-ttu-id="ef7e4-139">Мы покажем, как это делается в портал управления Azure, чтобы продемонстрировать основные понятия, но, конечно же, с другими функциями портала, можно также использовать скрипт или API управления.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-139">We'll show you how it's done in the Azure Management Portal in order to illustrate the concepts, but of course like the other portal functions you can also do it by using a script or management API.</span></span>

<span data-ttu-id="ef7e4-140">На портале управления перейдите на вкладку Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-140">In the management portal click the Active Directory tab.</span></span>

![WAAD на портале](single-sign-on/_static/image5.png)

<span data-ttu-id="ef7e4-142">Вы автоматически используете один клиент Azure AD для своей учетной записи Azure, и вы можете нажать кнопку **Добавить** в нижней части страницы, чтобы создать дополнительные каталоги.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-142">You automatically have one Azure AD tenant for your Azure account, and you can click the **Add** button at the bottom of the page to create additional directories.</span></span> <span data-ttu-id="ef7e4-143">Например, вам может потребоваться одна из них для тестовой среды, а другая — для рабочей.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-143">You might want one for a test environment and one for production, for example.</span></span> <span data-ttu-id="ef7e4-144">Подумайте о том, что вы назначите имя нового каталога.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-144">Think carefully about what you name a new directory.</span></span> <span data-ttu-id="ef7e4-145">Если вы используете имя каталога, а затем снова используете его имя для одного из пользователей, это может привести к путанице.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-145">If you use your name for the directory and then you use your name again for one of the users, that can be confusing.</span></span>

![Добавление каталога](single-sign-on/_static/image6.png)

<span data-ttu-id="ef7e4-147">Портал полностью поддерживает создание, удаление пользователей и управление ими в этой среде.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-147">The portal has full support for creating, deleting, and managing users within this environment.</span></span> <span data-ttu-id="ef7e4-148">Например, чтобы добавить пользователя, перейдите на вкладку **Пользователи** и нажмите кнопку **Добавить пользователя** .</span><span class="sxs-lookup"><span data-stu-id="ef7e4-148">For example, to add a user go to the **Users** tab and click the **Add User** button.</span></span>

![Кнопка "Добавить пользователя"](single-sign-on/_static/image7.png)

![Диалоговое окно добавления пользователя](single-sign-on/_static/image8.png)

<span data-ttu-id="ef7e4-151">Можно создать нового пользователя, который существует только в этом каталоге, или зарегистрировать учетную запись Майкрософт в качестве пользователя в этом каталоге или зарегистрировать пользователя из другого каталога Azure AD в качестве пользователя в этом каталоге.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-151">You can create a new user who exists only in this directory, or you can register a Microsoft Account as a user in this directory, or register or a user from another Azure AD directory as a user in this directory.</span></span> <span data-ttu-id="ef7e4-152">(В реальном каталоге домен по умолчанию будет ContosoTest.onmicrosoft.com.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-152">(In a real directory, the default domain would be ContosoTest.onmicrosoft.com.</span></span> <span data-ttu-id="ef7e4-153">Вы также можете использовать собственный домен, например contoso.com.)</span><span class="sxs-lookup"><span data-stu-id="ef7e4-153">You can also use a domain of your own choosing, like contoso.com.)</span></span>

![Пользовательские типы](single-sign-on/_static/image9.png)

![Диалоговое окно добавления пользователя](single-sign-on/_static/image10.png)

<span data-ttu-id="ef7e4-156">Пользователю можно назначить роль.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-156">You can assign the user to a role.</span></span>

![Профиль пользователя](single-sign-on/_static/image11.png)

<span data-ttu-id="ef7e4-158">Учетная запись создается с временным паролем.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-158">And the account is created with a temporary password.</span></span>

![Временный пароль](single-sign-on/_static/image12.png)

<span data-ttu-id="ef7e4-160">Пользователи, которые вы создаете таким образом, могут немедленно войти в веб-приложения с помощью этого облачного каталога.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-160">The users you create this way can immediately log in to your web apps using this cloud directory.</span></span>

<span data-ttu-id="ef7e4-161">Но что замечательно для корпоративного единого входа, на вкладке **Интеграция каталогов** :</span><span class="sxs-lookup"><span data-stu-id="ef7e4-161">What's great for enterprise single sign-on, though, is the **Directory Integration** tab:</span></span>

![Вкладка "Интеграция каталогов"](single-sign-on/_static/image13.png)

<span data-ttu-id="ef7e4-163">Если включить интеграцию каталогов и [скачать средство](https://social.technet.microsoft.com/wiki/contents/articles/19098.howto-install-the-windows-azure-active-directory-sync-tool-now-with-pictures.aspx), вы можете синхронизировать этот облачный каталог с существующими локальными Active Directory, которые вы уже используете в вашей организации.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-163">If you enable directory integration, and [download a tool](https://social.technet.microsoft.com/wiki/contents/articles/19098.howto-install-the-windows-azure-active-directory-sync-tool-now-with-pictures.aspx), you can sync this cloud directory with your existing on-premises Active Directory that you're already using inside your organization.</span></span> <span data-ttu-id="ef7e4-164">Затем все пользователи, хранящиеся в каталоге, будут отображаться в этом облачном каталоге.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-164">Then all of the users stored in your directory will show up in this cloud directory.</span></span> <span data-ttu-id="ef7e4-165">Ваши облачные приложения теперь могут проходить проверку подлинности всех сотрудников, используя существующие учетные данные Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-165">Your cloud apps can now authenticate all of your employees using their existing Active Directory credentials.</span></span> <span data-ttu-id="ef7e4-166">И все это бесплатно — как средство синхронизации, так и Azure AD.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-166">And all this is free – both the sync tool and Azure AD itself.</span></span>

<span data-ttu-id="ef7e4-167">Средство — это простой в использовании мастер, как видно из этих снимков экрана.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-167">The tool is a wizard that is easy to use, as you can see from these screen shots.</span></span> <span data-ttu-id="ef7e4-168">Эти инструкции не являются полными, просто пример, демонстрирующий базовый процесс.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-168">These are not complete instructions, just an example showing you the basic process.</span></span> <span data-ttu-id="ef7e4-169">Более подробные сведения о том, как это сделать, см. по ссылкам в разделе [ресурсов](#resources) в конце главы.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-169">For more detailed how-to-do-it information, see the links in the [Resources](#resources) section at the end of the chapter.</span></span>

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image14.png)

<span data-ttu-id="ef7e4-171">Нажмите кнопку **Далее**, а затем введите учетные данные Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-171">Click **Next**, and then enter your Azure Active Directory credentials.</span></span>

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image15.png)

<span data-ttu-id="ef7e4-173">Нажмите кнопку **Далее**, а затем введите локальные учетные данные AD.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-173">Click **Next**, and then enter your on-premises AD credentials.</span></span>

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image16.png)

<span data-ttu-id="ef7e4-175">Нажмите кнопку **Далее**, а затем укажите, хотите ли вы сохранить хэш паролей AD в облаке.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-175">Click **Next**, and then indicate if you want to store a hash of your AD passwords in the cloud.</span></span>

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image17.png)

<span data-ttu-id="ef7e4-177">Хэш пароля, который можно хранить в облаке, является односторонним. фактические пароли никогда не хранятся в Azure AD.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-177">The password hash that you can store in the cloud is a one-way hash; actual passwords are never stored in Azure AD.</span></span> <span data-ttu-id="ef7e4-178">Если вы решили хранить хэши в облаке, необходимо использовать [службы федерации Active Directory (AD FS)](https://technet.microsoft.com/library/hh831502.aspx) (ADFS).</span><span class="sxs-lookup"><span data-stu-id="ef7e4-178">If you decide against storing hashes in the cloud, you'll have to use [Active Directory Federation Services](https://technet.microsoft.com/library/hh831502.aspx) (ADFS).</span></span> <span data-ttu-id="ef7e4-179">Существуют также другие факторы, которые следует [учитывать при выборе того, следует ли использовать ADFS](https://technet.microsoft.com/library/jj573653.aspx).</span><span class="sxs-lookup"><span data-stu-id="ef7e4-179">There are also [other factors to consider when choosing whether or not to use ADFS](https://technet.microsoft.com/library/jj573653.aspx).</span></span> <span data-ttu-id="ef7e4-180">Параметр ADFS требует выполнения нескольких дополнительных действий по настройке.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-180">The ADFS option requires a few additional configuration steps.</span></span>

<span data-ttu-id="ef7e4-181">Если вы решили сохранить хэши в облаке, то все готово, и средство начнет синхронизацию каталогов при нажатии кнопки **Далее**.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-181">If you choose to store hashes in the cloud, you're done, and the tool starts synchronizing directories when you click **Next**.</span></span>

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image18.png)

<span data-ttu-id="ef7e4-183">И через несколько минут вы уже сделали это.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-183">And in a few minutes you're done.</span></span>

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image19.png)

<span data-ttu-id="ef7e4-185">Это необходимо выполнить только на одном контроллере домена в Организации, в Windows 2003 или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-185">You only have to run this on one domain controller in the organization, on Windows 2003 or higher.</span></span> <span data-ttu-id="ef7e4-186">И перезагружаться не нужно.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-186">And no need to reboot.</span></span> <span data-ttu-id="ef7e4-187">Когда все будет готово, все пользователи будут находиться в облаке, и вы сможете выполнить единый вход из любого веб-или мобильного приложения с помощью SAML, OAuth или WS-подач.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-187">When you're done, all of your users are in the cloud and you can do single sign-on from any web or mobile application, using SAML, OAuth, or WS-Fed.</span></span>

<span data-ttu-id="ef7e4-188">Иногда мы попросят о том, насколько безопасно это сделать — Корпорация Майкрософт использует ее для своих конфиденциальных бизнес-данных?</span><span class="sxs-lookup"><span data-stu-id="ef7e4-188">Sometimes we get asked about how secure this is – does Microsoft use it for their own sensitive business data?</span></span> <span data-ttu-id="ef7e4-189">И ответ — Да.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-189">And the answer is yes we do.</span></span> <span data-ttu-id="ef7e4-190">Например, если вы переходите на внутренний сайт Microsoft SharePoint по адресу [https://microsoft.sharepoint.com/](https://microsoft.sharepoint.com/), вам будет предложено войти в систему.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-190">For example, if you go to the internal Microsoft SharePoint site at [https://microsoft.sharepoint.com/](https://microsoft.sharepoint.com/), you get prompted to log in.</span></span>

![Вход в Office 365](single-sign-on/_static/image20.png)

<span data-ttu-id="ef7e4-192">Корпорация Майкрософт включила ADFS, поэтому при вводе идентификатора Майкрософт вы будете перенаправлены на страницу входа в ADFS.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-192">Microsoft has enabled ADFS, so when you enter a Microsoft ID, you get redirected to an ADFS log-in page.</span></span>

![Вход в ADFS](single-sign-on/_static/image21.png)

<span data-ttu-id="ef7e4-194">После ввода учетных данных, хранящихся во внутренней учетной записи Microsoft AD, вы получите доступ к этому внутреннему приложению.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-194">And once you enter credentials stored in an internal Microsoft AD account, you have access to this internal application.</span></span>

![Сайт MS SharePoint](single-sign-on/_static/image22.png)

<span data-ttu-id="ef7e4-196">В основном мы используем сервер входа в систему Active Directory, так как мы уже настроили ADFS до того, как Azure AD стала доступной, но процесс входа проходит через каталог Azure AD в облаке.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-196">We're using an AD sign-in server mainly because we already had ADFS set up before Azure AD became available, but the log-in process is going through an Azure AD directory in the cloud.</span></span> <span data-ttu-id="ef7e4-197">Мы поместили важные документы, систему управления версиями, файлы управления производительностью, отчеты о продажах и многое другое, в облаке и используем это точное же решение для их защиты.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-197">We put our important documents, source control, performance management files, sales reports, and more, in the cloud and are using this exact same solution to secure them.</span></span>

## <a name="create-an-aspnet-app-that-uses-azure-ad-for-single-sign-on"></a><span data-ttu-id="ef7e4-198">Создание приложения ASP.NET, использующего Azure AD для единого входа</span><span class="sxs-lookup"><span data-stu-id="ef7e4-198">Create an ASP.NET app that uses Azure AD for single sign-on</span></span>

<span data-ttu-id="ef7e4-199">Visual Studio позволяет очень легко создать приложение, использующее Azure AD для единого входа, как видно из нескольких снимков экрана.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-199">Visual Studio makes it really easy to create an app that uses Azure AD for single sign-on, as you can see from a few screen shots.</span></span>

<span data-ttu-id="ef7e4-200">При создании нового приложения ASP.NET (MVC или Web Forms) по умолчанию используется метод проверки подлинности ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-200">When you create a new ASP.NET application, either MVC or Web Forms, the default authentication method is ASP.NET Identity.</span></span> <span data-ttu-id="ef7e4-201">Чтобы изменить это в Azure AD, нажмите кнопку **изменить проверку подлинности** .</span><span class="sxs-lookup"><span data-stu-id="ef7e4-201">To change that to Azure AD, you click a **Change Authentication** button.</span></span>

![Изменение проверки подлинности](single-sign-on/_static/image23.png)

<span data-ttu-id="ef7e4-203">Выберите учетные записи организации, введите свое имя домена, а затем выберите единый вход.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-203">Select Organizational Accounts, enter your domain name, and then select Single Sign On.</span></span>

![Диалоговое окно настройки проверки подлинности](single-sign-on/_static/image24.png)

<span data-ttu-id="ef7e4-205">Можно также предоставить приложению разрешение на чтение или чтение и запись для данных каталога.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-205">You can also give the app read or read/write permission for directory data.</span></span> <span data-ttu-id="ef7e4-206">В этом случае можно использовать [REST API Azure Graph](https://msdn.microsoft.com/library/windowsazure/hh974476.aspx) для поиска номера телефона пользователей, узнать, находятся ли они в офисе, когда они последний вошел в систему и т. д.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-206">If you do that, it can use the [Azure Graph REST API](https://msdn.microsoft.com/library/windowsazure/hh974476.aspx) to look up users' phone number, find out if they're in the office, when they last logged on, etc.</span></span>

<span data-ttu-id="ef7e4-207">Это все, что нужно сделать — Visual Studio запрашивает учетные данные для администратора клиента Azure AD, а затем настраивает проект и клиент Azure AD для нового приложения.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-207">That's all you have to do - Visual Studio asks for the credentials for an administrator for your Azure AD tenant, and then it configures both your project and your Azure AD tenant for the new application.</span></span>

<span data-ttu-id="ef7e4-208">При запуске проекта вы увидите страницу входа и можете войти в систему, используя учетные данные пользователя в каталоге Azure AD.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-208">When you run the project, you'll see a sign-in page, and you can sign in with credentials of a user in your Azure AD directory.</span></span>

![Вход в учетную запись Организации](single-sign-on/_static/image25.png)

![Вход выполнен](single-sign-on/_static/image26.png)

<span data-ttu-id="ef7e4-211">При развертывании приложения в Azure все, что нужно сделать, — это установить флажок **включить проверку подлинности организации** , и снова Visual Studio позаботится о настройке.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-211">When you deploy the app to Azure, all you have to do is select an **Enable Organizational Authentication** check box, and once again Visual Studio takes care of all the configuration for you.</span></span>

![Веб-публикация](single-sign-on/_static/image27.png)

<span data-ttu-id="ef7e4-213">Эти снимки экрана посвящены полному пошаговому руководству, в котором показано, как создать приложение, использующее проверку подлинности Azure AD: [Разработка приложений ASP.NET с помощью Azure Active Directory](../../../../identity/overview/getting-started/developing-aspnet-apps-with-windows-azure-active-directory.md).</span><span class="sxs-lookup"><span data-stu-id="ef7e4-213">These screen shots come from a complete step-by-step tutorial that shows how to build an app that uses Azure AD authentication: [Developing ASP.NET Apps with Azure Active Directory](../../../../identity/overview/getting-started/developing-aspnet-apps-with-windows-azure-active-directory.md).</span></span>

## <a name="summary"></a><span data-ttu-id="ef7e4-214">Сводка</span><span class="sxs-lookup"><span data-stu-id="ef7e4-214">Summary</span></span>

<span data-ttu-id="ef7e4-215">В этой главе вы видели, что Azure Active Directory, Visual Studio и ASP.NET, упрощают настройку единого входа в Интернет-приложениях для пользователей вашей организации.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-215">In this chapter you saw that Azure Active Directory, Visual Studio, and ASP.NET, make it easy to set up single sign-on in Internet applications for your organization's users.</span></span> <span data-ttu-id="ef7e4-216">Пользователи могут входить в Интернет приложения, используя те же учетные данные, которые используются для входа в систему с помощью Active Directory во внутренней сети.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-216">Your users can sign on in Internet apps using the same credentials they use to sign on using Active Directory in your internal network.</span></span>

<span data-ttu-id="ef7e4-217">В [следующей главе](data-storage-options.md) рассматриваются варианты хранения данных, доступные для облачного приложения.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-217">The [next chapter](data-storage-options.md) looks at the data storage options available for a cloud app.</span></span>

<a id="resources"></a>
## <a name="resources"></a><span data-ttu-id="ef7e4-218">Ресурсы</span><span class="sxs-lookup"><span data-stu-id="ef7e4-218">Resources</span></span>

<span data-ttu-id="ef7e4-219">Дополнительные сведения см. в следующих источниках.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-219">For more information, see the following resources:</span></span>

- <span data-ttu-id="ef7e4-220">[Azure Active Directory документация](https://docs.microsoft.com/azure/active-directory/).</span><span class="sxs-lookup"><span data-stu-id="ef7e4-220">[Azure Active Directory Documentation](https://docs.microsoft.com/azure/active-directory/).</span></span> <span data-ttu-id="ef7e4-221">Страница портала для документации по Azure AD на сайте windowsazure.com.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-221">Portal page for Azure AD documentation on the windowsazure.com site.</span></span> <span data-ttu-id="ef7e4-222">Пошаговые учебники см. в разделе **Разработка** .</span><span class="sxs-lookup"><span data-stu-id="ef7e4-222">For step by step tutorials, see the **Develop** section.</span></span>
- <span data-ttu-id="ef7e4-223">[Многофакторная идентификация Azure](https://docs.microsoft.com/azure/multi-factor-authentication/).</span><span class="sxs-lookup"><span data-stu-id="ef7e4-223">[Azure Multi-Factor Authentication](https://docs.microsoft.com/azure/multi-factor-authentication/).</span></span> <span data-ttu-id="ef7e4-224">Страница портала для документации по многофакторной проверке подлинности в Azure.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-224">Portal page for documentation about multi-factor authentication in Azure.</span></span>
- <span data-ttu-id="ef7e4-225">[Параметры проверки подлинности учетной записи организации](../../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#orgauthoptions).</span><span class="sxs-lookup"><span data-stu-id="ef7e4-225">[Organizational account authentication options](../../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#orgauthoptions).</span></span> <span data-ttu-id="ef7e4-226">Описание параметров проверки подлинности Azure AD в диалоговом окне Visual Studio 2013 New-Project.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-226">Explanation of the Azure AD authentication options in the Visual Studio 2013 new-project dialog.</span></span>
- <span data-ttu-id="ef7e4-227">[Шаблоны и методики Майкрософт — федеративный шаблон удостоверений](https://msdn.microsoft.com/library/dn589790.aspx).</span><span class="sxs-lookup"><span data-stu-id="ef7e4-227">[Microsoft Patterns and Practices - Federated Identity Pattern](https://msdn.microsoft.com/library/dn589790.aspx).</span></span>
- <span data-ttu-id="ef7e4-228">[Практическое руководство. Установка средства синхронизации Azure Active Directory](https://social.technet.microsoft.com/wiki/contents/articles/19098.howto-install-the-windows-azure-active-directory-sync-tool-now-with-pictures.aspx).</span><span class="sxs-lookup"><span data-stu-id="ef7e4-228">[HowTo: Install the Azure Active Directory Sync Tool](https://social.technet.microsoft.com/wiki/contents/articles/19098.howto-install-the-windows-azure-active-directory-sync-tool-now-with-pictures.aspx).</span></span>
- <span data-ttu-id="ef7e4-229">[Службы федерации Active Directory (AD FS) 2,0. Таблица содержимого](https://social.technet.microsoft.com/wiki/contents/articles/2735.ad-fs-2-0-content-map.aspx).</span><span class="sxs-lookup"><span data-stu-id="ef7e4-229">[Active Directory Federation Services 2.0 Content Map](https://social.technet.microsoft.com/wiki/contents/articles/2735.ad-fs-2-0-content-map.aspx).</span></span> <span data-ttu-id="ef7e4-230">Ссылки на документацию по ADFS 2,0.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-230">Links to documentation about ADFS 2.0.</span></span>
- <span data-ttu-id="ef7e4-231">[Авторизация на основе ролей и списков управления доступом в приложении Windows Azure AD](https://code.msdn.microsoft.com/Role-Based-and-ACL-Based-86ad71a1).</span><span class="sxs-lookup"><span data-stu-id="ef7e4-231">[Role-Based and ACL-Based Authorization in a Windows Azure AD Application](https://code.msdn.microsoft.com/Role-Based-and-ACL-Based-86ad71a1).</span></span> <span data-ttu-id="ef7e4-232">Пример приложения.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-232">Sample application.</span></span>
- <span data-ttu-id="ef7e4-233">[Блог Azure Active Directory API Graph](https://blogs.msdn.com/b/aadgraphteam/).</span><span class="sxs-lookup"><span data-stu-id="ef7e4-233">[Azure Active Directory Graph API blog](https://blogs.msdn.com/b/aadgraphteam/).</span></span>
- <span data-ttu-id="ef7e4-234">[Управление доступом в BYOD и интеграции каталогов в гибридной инфраструктуре идентификации](https://channel9.msdn.com/Events/TechEd/NorthAmerica/2014/PCIT-B213#fbid=).</span><span class="sxs-lookup"><span data-stu-id="ef7e4-234">[Access Control in BYOD and Directory Integration in a Hybrid Identity Infrastructure](https://channel9.msdn.com/Events/TechEd/NorthAmerica/2014/PCIT-B213#fbid=).</span></span> <span data-ttu-id="ef7e4-235">Видеоролик о конференции Tech Ed 2014, Гайана Багдасарян.</span><span class="sxs-lookup"><span data-stu-id="ef7e4-235">Tech Ed 2014 session video by Gayana Bagdasaryan.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ef7e4-236">[Назад](web-development-best-practices.md)
> [Вперед](data-storage-options.md)</span><span class="sxs-lookup"><span data-stu-id="ef7e4-236">[Previous](web-development-best-practices.md)
[Next](data-storage-options.md)</span></span>
