---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/single-sign-on
title: Single Sign-On (Создание реальных облачных приложений в Azure) | Документация Майкрософт
author: MikeWasson
description: Создание реальных облачных приложений в условиях электронная книга основана на презентацию, разработанная Скоттом Гатри. Здесь объясняется, 13 шаблонов и практических рекомендаций, которые он может...
ms.author: riande
ms.date: 06/12/2014
ms.assetid: 7d82d5e9-0619-4f22-9e03-32a6d52940a5
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/single-sign-on
msc.type: authoredcontent
ms.openlocfilehash: 8f6c23eb71ea323b6ab06943097f927f717a8099
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65118747"
---
# <a name="single-sign-on-building-real-world-cloud-apps-with-azure"></a>Единый вход (Создание реальных облачных приложений в Azure)

по [Майк Уоссон](https://github.com/MikeWasson), [Рик Андерсон]((https://twitter.com/RickAndMSFT)), [том Дайкстра](https://github.com/tdykstra)

[Загрузить решение проект](http://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) или [скачайте электронную книгу](http://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)

> **Создание реальных облачных приложений в условиях Azure** электронная книга основана на презентацию, разработанная Скоттом Гатри. Здесь объясняется 13 шаблоны и рекомендации, которые помогут вам быть в успешном развертывании веб-приложений для облака. Сведения о книге, см. в разделе [первой главы](introduction.md).

Существует много проблем безопасности будет учесть при разработке облачных приложений, но в этой серии статей мы сосредоточимся только на одном: единый вход. Вопрос, на который часто спрашивают такова: «Я в первую очередь создаю приложения для сотрудников, моей компании; как разместить эти приложения в облаке и по-прежнему разрешить им использовать ту же модель безопасности, Мои сотрудники знают и используют в локальной среде, когда они выполняются приложения, размещены за брандмауэром?» Одним из способов, мы реализовать этот сценарий называется Azure Active Directory (Azure AD). Azure AD позволяет вам выбрать корпоративных бизнес приложений (LOB) доступны в Интернете, и это дает возможность предоставлять эти приложения также деловым партнерам.

## <a name="introduction-to-azure-ad"></a>Введение в Azure AD

[Azure AD](https://docs.microsoft.com/azure/active-directory/) предоставляет [Active Directory](https://msdn.microsoft.com/library/windows/desktop/aa746492.aspx) в облаке. Ниже приведены основные функции:

- Он интегрируется с локальной Active Directory.
- Он обеспечивает единый вход со своими приложениями.
- Он поддерживает открытых стандартов, таких как [SAML](http://en.wikipedia.org/wiki/SAML_2.0), [WS-Fed](http://en.wikipedia.org/wiki/WS-Federation), и [OAuth 2.0](http://oauth.net/2/).
- Он поддерживает Enterprise [Graph REST API](https://msdn.microsoft.com/library/hh974476.aspx).

Предположим, что у вас есть в локальной среде Windows Server Active Directory, используемую для сотрудников, которые должны входить в приложениях интрасети:

![](single-sign-on/_static/image1.png)

Azure AD позволяет сделать — это создать каталог в облаке. Это бесплатный компонент и легко настроить.

Он может быть полностью независимы, из локальной службы Active Directory; Читатель может любой пользователь в его и выполнять проверку подлинности в Интернет-приложений.

![Windows Azure Active Directory](single-sign-on/_static/image2.png)

Или вы можете интегрировать ее с локальным AD.

![AD и интеграции WAAD](single-sign-on/_static/image3.png)

Теперь все сотрудники, прошедшие проверку подлинности в локальной также позволяет проверять подлинность в Интернете — вам не нужно открывать брандмауэр или развернуть новые серверы в вашем центре обработки данных. Вы можете использовать все существующие среды Active Directory, вы знаете и используйте уже сегодня, чтобы предоставить ваши внутренние приложения единого входа на возможность.

После внесения этого подключения между AD и Azure AD, вы можете также включить веб-приложений и мобильных устройств для проверки подлинности сотрудников в облаке и вы можете включить сторонние приложения, например приложения Office 365, SalesForce.com и Google, чтобы принять вашей учетные данные сотрудников. Если вы используете Office 365, вы вы уже настроили с Azure AD так, как Office 365 использует Azure AD для проверки подлинности и авторизации.

![сторонние приложения](single-sign-on/_static/image4.png)

Преимуществом этого подхода является то, что каждый раз, ваша организация добавляет или удаляет пользователя, или пользователь изменяет пароль, использовать такой же процесс, используемых в настоящее время в вашей локальной среде. Все из локальной AD изменения автоматически распространяются на облачной среде.

Если ваша компания с помощью или переход на Office 365, хорошая новость в том, что у вас будет настроено автоматически, так как Office 365 использует Azure AD для проверки подлинности Azure AD. Поэтому можно легко использовать в своих приложениях ту же проверку подлинности, который использует Office 365.

## <a name="set-up-an-azure-ad-tenant"></a>Настройка клиента Azure AD

каталог Azure AD называется Azure AD [клиента](https://technet.microsoft.com/library/jj573650.aspx), и настройка клиента выполняется довольно просто. Мы покажем вам, как это можно сделать на портале управления Azure, чтобы продемонстрировать основные понятия, но само собой подобно другим функциям портала это можно также сделать с помощью сценария или API управления.

На портале управления перейдите на вкладку Active Directory.

![WAAD на портале](single-sign-on/_static/image5.png)

Вы автоматически получаете одним клиентом Azure AD для учетной записи Azure, а также можно щелкнуть **добавить** кнопки в нижней части страницы, чтобы создать дополнительные каталоги. Может потребоваться один для тестовой среды и один для рабочей среды, например. Тщательно продумайте назовите новый каталог. Если вы используете имена для каталога и затем использовать имя для одного из пользователей, которые могут запутать новичков.

![Добавить каталог](single-sign-on/_static/image6.png)

На портале есть полная поддержка создание, удаление и управление пользователями в этой среде. Например, чтобы добавить пользователя перейдите **пользователей** вкладку и нажмите кнопку **добавить пользователя** кнопки.

![Пользователь кнопка "Добавить"](single-sign-on/_static/image7.png)

![Добавить диалоговое окно пользователя](single-sign-on/_static/image8.png)

Можно создать нового пользователя, который существует только в этом каталоге или учетной записи Майкрософт можно зарегистрировать как в этом каталоге или регистра и пользователь из другого каталога Azure AD от имени пользователя в этом каталоге. (В каталог, а реальные домен по умолчанию будет иметь ContosoTest.onmicrosoft.com. Можно также использовать домен по собственному выбору, например contoso.com.)

![Пользовательские типы](single-sign-on/_static/image9.png)

![Добавить диалоговое окно пользователя](single-sign-on/_static/image10.png)

Пользователю можно назначить роль.

![Профиль пользователя](single-sign-on/_static/image11.png)

И учетная запись создается временный пароль.

![Временный пароль](single-sign-on/_static/image12.png)

Пользователей, создании таким образом немедленно могут войти в веб-приложениях, используя этот облачный каталог.

Отлично подходит для корпоративного единого входа, однако является **Интеграция каталогов** вкладке:

![Вкладка "каталог интеграции"](single-sign-on/_static/image13.png)

При включении интеграции каталогов и [Загрузите средство](https://social.technet.microsoft.com/wiki/contents/articles/19098.howto-install-the-windows-azure-active-directory-sync-tool-now-with-pictures.aspx), вы можете синхронизировать этот облачный каталог с существующей локальной Active Directory, вы уже используете в вашей организации. Затем все пользователи, которые хранятся в каталоге будут отображаться в этот облачный каталог. Облачные приложения теперь могут проходить проверку подлинности всех сотрудников с помощью существующих учетных данных Active Directory. И все это бесплатно — средства синхронизации и Azure AD.

Средство входит мастер, который очень прост в использовании, как видно из этих снимков экрана. Они не полные инструкции, просто пример, показывающий, основной процесс. Более подробные сведения практические-в-it, см. по ссылкам в [ресурсы](#resources) в конце раздела.

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image14.png)

Нажмите кнопку **Далее**, а затем введите учетные данные Azure Active Directory.

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image15.png)

Нажмите кнопку **Далее**, а затем введите локальные учетные данные AD.

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image16.png)

Нажмите кнопку **Далее**и укажите, следует ли хранить хэш паролей AD в облаке.

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image17.png)

Хэш пароля, которые можно хранить в облаке имеют одностороннее хэширование; Фактические пароли никогда не хранятся в Azure AD. Если принято решение для хранения хеш-коды в облаке, необходимо будет использовать [служб федерации Active Directory](https://technet.microsoft.com/library/hh831502.aspx) (ADFS). Существуют также [других факторов, влияющих на выбор, следует ли использовать ADFS](https://technet.microsoft.com/library/jj573653.aspx). ADFS требуется несколько дополнительных действий по настройке.

Если вы решили хранить хэши в облаке, все будет готово и запускает средство синхронизации каталогов, при нажатии кнопки **Далее**.

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image18.png)

И через несколько минут все будет готово.

![Мастер настройки средства синхронизации WAAD](single-sign-on/_static/image19.png)

Необходимо выполнять на одном контроллере домена в организации, в Windows 2003 или более поздней версии. И перезагрузки. Когда все будет готово, все пользователи находятся в облаке, и можно сделать единого входа из любой веб- или мобильное приложение, используя SAML, OAuth и WS-Fed.

Иногда мы задают следующий вопрос о том, как безопасных, это — корпорация Майкрософт использует собственные конфиденциальных деловых данных? И Да, что мы делаем. Например, при переходе на внутренний сайт Microsoft SharePoint [ https://microsoft.sharepoint.com/ ](https://microsoft.sharepoint.com/), получить запрос на вход.

![Входа в Office 365](single-sign-on/_static/image20.png)

Microsoft включил ADFS, поэтому при вводе идентификатора Майкрософт, вы перейдете на страницу входа служб федерации Active Directory.

![Входа служб федерации Active Directory](single-sign-on/_static/image21.png)

И после ввода учетных данных, хранящихся в учетной записи внутренней Microsoft AD, у вас есть доступ к этому приложению внутренней.

![Сайт MS SharePoint](single-sign-on/_static/image22.png)

Мы используем сервер входа в AD, главным образом потому, что у нас уже были служб федерации Active Directory, прежде чем Azure AD стала доступной, но процесс входа проходит через каталог Azure AD в облаке. Мы поместим наши важные документы, системы управления версиями, файлы управления производительности, отчеты по продажам и многое другое, в облаке, а при использовании же точное решение для их защиты.

## <a name="create-an-aspnet-app-that-uses-azure-ad-for-single-sign-on"></a>Создание приложения ASP.NET, использующей Azure AD для единого входа

Visual Studio упрощает очень просто создать приложение, которое использует Azure AD для единого входа, как видно из несколько снимков экрана.

При создании нового приложения ASP.NET, MVC или веб-формы, метод проверки подлинности по умолчанию — ASP.NET Identity. Чтобы изменить его на Azure AD, нажмите кнопку **изменить проверку подлинности** кнопки.

![Изменить способ проверки подлинности](single-sign-on/_static/image23.png)

Выберите учетные записи организации, введите имя домена и выберите единого входа.

![Настройка диалогового окна проверки подлинности](single-sign-on/_static/image24.png)

Можно также предоставить приложения чтения или чтения и записи разрешений для каталога данных. Если сделать это, можно использовать [Azure Graph REST API](https://msdn.microsoft.com/library/windowsazure/hh974476.aspx) чтобы найти номер телефона пользователя, узнайте ли они в офисе, когда они последнего входа на и т. д.

Это все, что вам нужно выполнить следующую команду: Visual Studio запросит ввести учетные данные администратора для вашего клиента Azure AD, и затем настраивает проект и новое приложение в клиенте Azure AD.

При запуске проекта, вы увидите страницу входа в систему, и вы можете войти в систему с учетными данными пользователя в каталоге Azure AD.

![Организационной учетной записи входа в систему](single-sign-on/_static/image25.png)

![Вход](single-sign-on/_static/image26.png)

При развертывании приложения в Azure, что необходимо сделать всего выберите **Включение аутентификации в организации** и еще раз Visual Studio берет на себя все конфигурации для вас.

![Публикация веб-проекта](single-sign-on/_static/image27.png)

Эти снимки экрана иметь полное Пошаговое руководство, где показано, как создать приложение, которое использует проверку подлинности Azure AD: [Разработка приложений ASP.NET с Azure Active Directory](../../../../identity/overview/getting-started/developing-aspnet-apps-with-windows-azure-active-directory.md).

## <a name="summary"></a>Сводка

В этой главе вы увидели, что Azure Active Directory, Visual Studio и ASP.NET, позволяют легко настроить единый вход в веб-приложений для пользователей вашей организации. Пользователи могут входить Интернет-приложений, используя те же учетные данные, которые они используют для входа с помощью Active Directory в вашей внутренней сети.

[Следующей главе](data-storage-options.md) рассматривает вариантах хранения данных, доступных для облачного приложения.

<a id="resources"></a>
## <a name="resources"></a>Ресурсы

Дополнительные сведения см. в следующих ресурсах:

- [Документация по Azure Active Directory](https://docs.microsoft.com/azure/active-directory/). Страница портала для документации по Azure AD на сайте windowsazure.com. Пошаговые руководства, см. в разделе **разработка** раздел.
- [Многофакторная Идентификация Azure](https://docs.microsoft.com/azure/multi-factor-authentication/). Страница портала документацию по многофакторной проверки подлинности в Azure.
- [Параметры проверки подлинности учетной записи организации](../../../../visual-studio/overview/2013/creating-web-projects-in-visual-studio.md#orgauthoptions). Объяснение параметров проверки подлинности Azure AD в диалоговом окне нового проекта Visual Studio 2013.
- [Microsoft Patterns and Practices — федеративные удостоверения шаблон](https://msdn.microsoft.com/library/dn589790.aspx).
- [Инструкции: Установите средство Azure Active Directory Sync](https://social.technet.microsoft.com/wiki/contents/articles/19098.howto-install-the-windows-azure-active-directory-sync-tool-now-with-pictures.aspx).
- [Службы федерации Active Directory 2.0 Карта содержимого](https://social.technet.microsoft.com/wiki/contents/articles/2735.ad-fs-2-0-content-map.aspx). Ссылки на документацию о ADFS 2.0.
- [Авторизация на основе ролей и доступом в приложения Windows Azure AD](https://code.msdn.microsoft.com/Role-Based-and-ACL-Based-86ad71a1). Образец приложения.
- [Блог по Azure Active Directory Graph API](https://blogs.msdn.com/b/aadgraphteam/).
- [Управление доступом в BYOD и Интеграция каталогов в гибридной инфраструктурой идентификации](https://channel9.msdn.com/Events/TechEd/NorthAmerica/2014/PCIT-B213#fbid=). Tech Ed 2014 сеанс видео по Bagdasaryan Гаяне.

> [!div class="step-by-step"]
> [Назад](web-development-best-practices.md)
> [Вперед](data-storage-options.md)
