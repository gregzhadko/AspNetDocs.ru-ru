---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/source-control
title: Система управления версиями (Создание реальных облачных приложений в Azure) | Документация Майкрософт
author: MikeWasson
description: Создание реальных облачных приложений в условиях электронная книга основана на презентацию, разработанная Скоттом Гатри. Здесь объясняется, 13 шаблонов и практических рекомендаций, которые он может...
ms.author: riande
ms.date: 06/23/2015
ms.assetid: 2a0370d3-c2fb-4bf3-88b8-aad5a736c793
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/source-control
msc.type: authoredcontent
ms.openlocfilehash: 7effc0194541afe766a6202f527d36d96f3007f2
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59381371"
---
# <a name="source-control-building-real-world-cloud-apps-with-azure"></a>Системы управления версиями (Создание реальных облачных приложений в Azure)

по [Майк Уоссон](https://github.com/MikeWasson), [Рик Андерсон]((https://twitter.com/RickAndMSFT)), [том Дайкстра](https://github.com/tdykstra)

[Загрузить решение проект](http://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) или [скачайте электронную книгу](http://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)

> **Создание реальных облачных приложений в условиях Azure** электронная книга основана на презентацию, разработанная Скоттом Гатри. Здесь объясняется 13 шаблоны и рекомендации, которые помогут вам быть в успешном развертывании веб-приложений для облака. Сведения о книге, см. в разделе [первой главы](introduction.md).

Контроль источника очень важен для всех проектов облачной разработки, не только в средах рабочих групп. Не считаете редактирования исходного кода или даже документ Word без функция отмены и автоматическое создание резервных копий и система управления версиями дает этих функций на уровне проекта, где они могут сохранять еще больше времени, когда что-то пойдет не так. Службы системы управления версиями cloud вам больше не нужно беспокоиться о сложной настройки и бесплатной системы управления версиями репозитории Azure можно использовать до 5 пользователей.

В первой части этой главе описывается три основных лучших решений, необходимо иметь в виду:

- [Исходный код следует считать сценарии автоматизации](#scripts) и версии их вместе с кодом приложения.
- [Никогда не проверять в секретах](#secrets) (конфиденциальные данные, например учетные данные) в репозитории исходного кода.
- [Настройка исходных ветвей](#devops) включить рабочий процесс DevOps.

В оставшейся части главы дает некоторые примеры реализации этих шаблонов в Visual Studio, Azure и Azure репозиториев:

- [Добавление скриптов в систему управления версиями в Visual Studio](#vsscripts)
- [Store конфиденциальных данных в Azure](#appsettings)
- [Использовать Git в Visual Studio и Azure репозитории](#gittfs)

<a id="scripts"></a>
## <a name="treat-automation-scripts-as-source-code"></a>Обрабатывать сценарии автоматизации как исходный код

При работе над проектом облачной вы изменяете вещи, часто, и вы хотите иметь возможность быстро реагировать на ошибки, описанные в клиентов. Быстро отвечать на запросы предполагает использование сценариев автоматизации, как описано в [автоматизировать все, что](automate-everything.md) главы. Все сценарии, которые можно использовать для создания собственной среды развертывания к нему, масштабирования, он и др., должны быть синхронизированы с исходным кодом приложения.

Для синхронизации скрипты с кодом, хранить их в систему управления версиями. Затем, если вы захотите выполнить откат изменений или внести Быстрое исправление этой проблемы в рабочем коде, который отличается от разработки кода, не нужно тратить время, пытающихся проследить, какие параметры были изменены и какие члены команды имеют копии нужных вам версий. Вы будете уверены в том, сценарии, которые требуются в соответствии с кодовой базы, они нужны для, и вы уверены, что все участники команды работают с те же сценарии. Затем вам нужно автоматизировать тестирование и развертывание исправление для рабочей среды или разработка новых функций, нужно ли соответствующий скрипт для кода, который должен быть обновлен.

<a id="secrets"></a>
## <a name="dont-check-in-secrets"></a>Не устанавливайте флажок в секретах

Обычно репозиторием исходного кода доступен слишком много людей, для него необходимо соответствующим образом безопасное для конфиденциальных данных, такие как пароли. Если скрипты, зависят от секретные данные, например пароли, параметризовать эти параметры, чтобы они не сохраняются в исходном коде и хранить свои секреты в другом месте.

Например Azure позволяет загрузить файлы, содержащие параметры публикации для автоматизации создания профили публикации. Эти файлы содержат имена пользователей и пароли, которые имеют право управлять службами Azure. Если не использовать этот метод для создания профилей публикации, и если возвращать эти файлы в систему управления версиями, любой пользователь с доступом к репозиторию могут видеть имена пользователей и пароли. Можно безопасно хранить пароль в профиле публикации самой, так как он зашифрован и находится в *. pubxml.user* файл, который по умолчанию не включен в системе управления версиями.

<a id="devops"></a>
## <a name="structure-source-branches-to-facilitate-devops-workflow"></a>Структура исходных ветвей для упрощения рабочего процесса DevOps

Как реализовать ветви в репозитории влияет на возможность как для разработки новых компонентов, так и для устранения проблем в рабочей среде. Вот шаблон, что массу среднего размера команды используют:

![Структура ветвей источника](source-control/_static/image1.png)

Главной ветви всегда соответствует код, который находится в рабочей среде. Подразделов вне главного соответствуют разные этапы жизненного цикла разработки. Ветвь development выполняется реализация новых функций. Для небольшой команды может просто иметься master и разработки, но рекомендуется часто, что пользователи имеют промежуточную ветвь между разработкой и master. Промежуточного хранения можно использовать для окончательного интеграционного тестирования перед обновлением перемещается в рабочую среду.

Для больших групп может быть отдельной ветви для каждой новой функции; для небольшой команды может потребоваться все проверки ветви development в ветвь.

При наличии ветвь для каждого компонента, при включенной функции объект готов объединении его изменения в исходном коде вверх в процессе разработки в ветви и вниз в других ветвях компонентов. Этот исходный код, процессом слияния может занять много времени, и во избежание этой работы, сохраняя при этом отдельные функции, некоторые команды реализовать альтернативы вызывается *[ротацию функций](http://en.wikipedia.org/wiki/Feature_toggle)* (также известен как *флаги компонентов*). Это означает, что весь код для всех функций — в одной ветви, но можно включить или отключить каждую функцию с помощью переключателей в коде. Например предположим, функции A — это новое поле для задач приложения ее исправить, и возможностей Б расширяет его функциональные возможности кэширования. Код для обоих компонентов может быть в ветви development в ветвь, но только отображения приложения будет новое поле, если переменной присвоено значение true и он будет использовать только кэширование при различных переменной задано значение true. Функции A не готова к повышению возможностей Б будет готов, вы можете повысить уровень весь код в рабочей среде с параметром функции A off и включения возможностей Б. Затем можно завершить признаков А и повысьте его до более поздней версии, все это с слияния исходного кода.

Независимо от того, имеется ли для функции используется ветвей или переключение, разветвленную структуру следующим образом позволяет потока кода от разработки в рабочей среде путем гибкой и repeatable.

Эта структура также позволяет быстро реагировать на отзывы клиентов. Если вы хотите внести Быстрое исправление этой проблемы в рабочей среде, можно также сделать, эффективно гибкие возможности. Можно создать ветвь из главного или промежуточных и готовности его слияние в главную ветвь вверх и вниз на ветви разработки и специализированные.

![Ветви исправления](source-control/_static/image2.png)

Без разветвленную структуру следующим образом с его разделением производства и ветвей разработки проблема рабочей среде может поместите в положение необходимости повышение уровня нового кода функции вместе с вашей рабочей среде исправление. Новый код функции может быть полностью проверенных и готова к рабочей среде и может потребоваться выполнить большой объем работы, резервном изменения, которые не готовы. Или может потребоваться отложить исправления для тестирования изменений и подготовить их к развертыванию.

Далее рассмотрим примеры использования для реализации этих трех шаблонов в Visual Studio, Azure и Azure репозиториев. Ниже приведены примеры, а не подробные пошаговые инструкции практические-в-it; Подробные инструкции, которые предоставляют все необходимые контекста, см. в разделе [ресурсы](#resources) в конце раздела.

<a id="vsscripts"></a>
## <a name="add-scripts-to-source-control-in-visual-studio"></a>Добавление скриптов в систему управления версиями в Visual Studio

Сценарии можно добавить в систему управления версиями в Visual Studio, включая их в папке решения Visual Studio (предполагается, что проект находится в системе управления версиями). Вот один из способов сделать это.

Создайте папку для скриптов в папку решения (той же папке, с вашей *.sln* файла).

![Папка автоматизации](source-control/_static/image3.png)

Скопируйте файлы скриптов в папку.

![Содержимое папки автоматизации](source-control/_static/image4.png)

В Visual Studio добавьте папку решения в проект.

![Новое выделение меню папки решения](source-control/_static/image5.png)

И добавьте файлы скриптов в папку решения.

![Добавить существующий элемент меню выбора](source-control/_static/image6.png)

![Диалоговое окно ''Добавление существующего элемента''](source-control/_static/image7.png)

Файлы скриптов теперь включены в проект и системы управления версиями отслеживает их изменения версии, а также соответствующие изменения в исходном коде.

<a id="appsettings"></a>
## <a name="store-sensitive-data-in-azure"></a>Store конфиденциальных данных в Azure

Если вы запустите приложение на веб-сайте в Azure, для хранения их в Azure является одним из способов избежать хранения учетных данных в системе управления версиями.

Например приложение Fix It хранит в его файле Web.config файл две строки подключения, которые будут иметь пароли в рабочей среде и ключ, который предоставляет доступ к вашей учетной записи хранения Azure.

[!code-xml[Main](source-control/samples/sample1.xml?highlight=2-3,11)]

Если поместить фактические рабочие значения для этих параметров в вашей *Web.config* файл, или если поместить их в *Web.Release.config* файл, чтобы настроить преобразование Web.config будет сделать во время развертывания они будут храниться в исходный репозиторий. При вводе строки подключения к базам данных в рабочую среду профиль публикации, пароль будет использоваться в вашей *.pubxml* файла. (Можно исключить *.pubxml* файл из системы управления версиями, но затем вы теряете преимущества совместного использования все остальные параметры развертывания.)

Azure предоставляет альтернативы для **appSettings** и строки подключения разделы *Web.config* файл. Вот соответствующая часть **конфигурации** вкладку веб-сайта на портале управления Azure:

![appSettings и connectionStrings на портале](source-control/_static/image8.png)

При развертывании проекта для этого веб-сайта и выполнения приложения, любые значения, сохраненные в Azure переопределить любые значения находятся в файле Web.config.

Эти значения можно задать в Azure с помощью портала управления или скриптов. Сценарий автоматизации создания среды, можно было увидеть в [автоматизировать все, что](automate-everything.md) Глава создает базу данных SQL Azure, получает хранилище и строки подключения базы данных SQL и сохраняет эти секреты в параметрах веб-сайта.

[!code-powershell[Main](source-control/samples/sample2.ps1)]

[!code-powershell[Main](source-control/samples/sample3.ps1)]

Обратите внимание на то, что скрипты параметризуются, таким образом, чтобы фактические значения не сохраняются в исходный репозиторий.

При локальном запуске в среде разработки, приложение считывает данные в локальный файл Web.config и подключение к строка указывает на базу данных LocalDB SQL Server в *приложения\_данных* папку веб-проекта. При запуске приложения в Azure и приложение пытается прочитать эти значения из файла Web.config, что он возвращается и использует — это значения, хранящиеся в веб-сайта, не фактически в файле Web.config.

<a id="gittfs"></a>
## <a name="use-git-in-visual-studio-and-azure-devops"></a>Используйте Git в Visual Studio и Azure DevOps

Любой среду управления версиями можно использовать для реализации разветвленную структуру DevOps, представленного выше. Для распределенных групп [распределенной системы управления версиями](http://en.wikipedia.org/wiki/Distributed_revision_control) (DVCS) может работать лучше; для других команд [централизованной системы](http://en.wikipedia.org/wiki/Revision_control) может работать лучше.

[Git](http://git-scm.com/) является популярным распределенная система управления версиями. При использовании Git для системы управления версиями, у вас есть полная копия репозитория со всеми его журнала на локальном компьютере. Многие пользователи предпочитают, поскольку это проще продолжать работать, когда вы не подключены к сети — вы можете сделать фиксирует и откаты, создания и переключения ветки и т. д. Даже в том случае, если вы подключены к сети, это проще и быстрее создавайте ветви и переключения ветки в том случае, если все компоненты локальной. Также можно сделать локальные фиксации или отката не вредя при на других разработчиков. И выполнить пакетную обработку фиксации перед их отправкой на сервер.

[Azure репозиториев](/azure/devops/repos/index?view=vsts) предлагает оба [Git](/azure/devops/repos/git/?view=vsts) и [системы управления версиями Team Foundation](/azure/devops/repos/tfvc/index?view=vsts) (TFVC; централизованной системы управления версиями). Начало работы с Azure DevOps [здесь](https://app.vsaex.visualstudio.com/signup).

Visual Studio 2017 включает в себя встроенные, первоклассную [поддержка Git](https://msdn.microsoft.com/library/hh850437.aspx). Ниже приведен краткий демонстрационную версию, как это работает.

Откройте проект в Visual Studio, щелкните правой кнопкой мыши решение в **обозревателе решений**, а затем выберите **добавить решение в систему управления версиями**.

![Добавить решение в систему управления версиями](source-control/_static/image9.png)

Visual Studio предлагает, если вы хотите использовать (централизованной системы управления версиями) TFVC или Git.

![Выберите систему управления версиями](source-control/_static/image10.png)

Если вы выберите Git и выбрать пункт **ОК**, Visual Studio создает нового локального репозитория Git в папке решения. Новое хранилище еще нет файлов; Вам нужно добавить их в репозиторий, выполнив фиксации Git. Щелкните правой кнопкой мыши решение в **обозревателе решений**, а затем нажмите кнопку **зафиксировать**.

![Фиксация](source-control/_static/image11.png)

Visual Studio автоматически размещает все файлы проекта для фиксации и выведет их имена в **Team Explorer** в **включенные изменения** области. (Если есть некоторые вы не хотите включить в фиксацию, можно выбрать их, щелкните правой кнопкой мыши и нажмите кнопку **исключить**.)

![Командный обозреватель](source-control/_static/image12.png)

Введите комментарии для фиксации и нажмите кнопку **фиксации**, и Visual Studio выполняет фиксацию и отображает идентификатор фиксации.

![Изменения Team Explorer](source-control/_static/image13.png)

Теперь при изменении некоторый код, так как это отличается от в репозитории, можно легко просматривать различия. Щелкните правой кнопкой мыши файл, который вы изменили, выберите **сравнения с Unmodified**, и вы получаете сравнения отображения, показывающего незафиксированные изменения.

![Сравнить с неизмененной](source-control/_static/image14.png)

![Изменения отображение различий](source-control/_static/image15.png)

Можно легко увидеть, какие изменения вы вносите и их туда.

Предположим, что необходимо сделать ветвь — это можно сделать в Visual Studio слишком. В **Team Explorer**, нажмите кнопку **новую ветвь**.

![Новую ветвь в Team Explorer](source-control/_static/image16.png)

Введите имя ветви, нажмите кнопку **создать ветвь**, и если вы выбрали **извлечение ветви**, Visual Studio автоматически извлекает новой ветви.

![Новую ветвь в Team Explorer](source-control/_static/image17.png)

Теперь можно вносить изменения в файлы и проверить их в этой ветви. И вы можете легко переключаться между ветви и Visual Studio автоматически синхронизируется, в которую были извлечены файлы в ту ветвь, вы. В этом примере заголовок веб-страницы в  *\_Layout.cshtml* было изменено на «Исправление 1» в HotFix1 ветви.

![Hotfix1 ветви](source-control/_static/image18.png)

При переключении обратно в главной ветви, содержимое  *\_Layout.cshtml* автоматически восстановить файла в главной ветви.

![Главной ветви](source-control/_static/image19.png)

Этот простой пример того, как можно быстро создать ветвь и возвращаться между ветвями. Эта функция позволяет очень гибкой разработки рабочего процесса, с помощью структуры ветвей и сценарии автоматизации представлены в [автоматизировать все, что](automate-everything.md) главы. Например, может быть работа в ветви Development в ветвь, создание ветви исправления из главного, переключитесь в новой ветви, вносят в нее ваши изменения и зафиксировать их и затем переключитесь обратно в ветви Development в ветвь и продолжить свои действия.

Теперь вы увидели здесь является работу с локального репозитория Git в Visual Studio. В среде группы обычно также внесении изменений общего хранилища. Средства Visual Studio также позволяют указывать в удаленном репозитории Git. Для этой цели можно использовать GitHub.com, или воспользоваться [Git и репозитории Azure](/azure/devops/repos/git/overview?view=vsts) интегрированы со всеми другими возможностями Azure DevOps, такие как рабочий элемент и отслеживания ошибок.

Это не единственный способ, можно реализовать agile стратегию ветвления, конечно. Вы можете включить одного рабочего процесса гибкой разработки с помощью централизованной системе управления версиями.

## <a name="summary"></a>Сводка

Оценить успешность систему управления версиями, на основе как быстро можно внести изменения и получить ее в безопасном и предсказуемым способом в реальном времени. Если вы находитесь попробовать совместить их внести изменения, так как вам нужно сделать один или два объема ручного тестирования на нем дня, вы можете задаться что нужно сделать process-wise или test-wise таким образом, можно внести это изменение в минутах или в худшем случае больше одного часа. Одна из стратегий по, заключается в реализации непрерывной интеграции и непрерывной доставки, мы расскажем в [следующей главе](continuous-integration-and-continuous-delivery.md).

<a id="resources"></a>
## <a name="resources"></a>Ресурсы

Дополнительные сведения о стратегии ветвления см. следующие ресурсы:

- [Создание конвейера выпусков с Team Foundation Server 2012](https://msdn.microsoft.com/library/dn449957.aspx). Документация по Microsoft Patterns and Practices. В главе 6 обсуждение стратегий ветвления. Функция представители сообщества переключает через ветви компонентов и если используются ветви для функций, отвечает, обеспечивая кратковременное (часов или дней, в большинстве случаев).
- [Руководство по контролю версии](https://aka.ms/vsarsolutions). Руководство по стратегии ветвления по ALM Rangers. См. в разделе Strategies.pdf ветвление на вкладке «файлы для загрузки».
- [Разработка программного обеспечения с помощью переключателей функций](https://msdn.microsoft.com/magazine/dn683796.aspx). Статья журнала MSDN Magazine.
- [Функция переключить](http://martinfowler.com/bliki/FeatureToggle.html). Введение в функцию переключает / флаги функций в блоге (Martin Fowler).
- [Функция vs переключение ветвей компонентов](http://geekswithblogs.net/Optikal/archive/2013/02/10/152069.aspx). Другой записи блога о ротации функций, Dylan Smith.

Дополнительные сведения о том, как обрабатывать конфиденциальные сведения, которые не должны храниться в репозиториев системы управления версиями см. следующие ресурсы:

- [Рекомендации по развертыванию паролей и других конфиденциальных данных в ASP.NET и службы приложений Azure](../../../../identity/overview/features-api/best-practices-for-deploying-passwords-and-other-sensitive-data-to-aspnet-and-azure.md).
- [Веб-сайты Azure: How Application Strings and Connection Strings Work](https://azure.microsoft.com/blog/2013/07/17/windows-azure-web-sites-how-application-strings-and-connection-strings-work/) (Веб-сайты Microsoft Azure: как работают строки приложения и строки подключения). Описывает функцию Azure, переопределяющий `appSettings` и `connectionStrings` данные в *Web.config* файл.
- [Настраиваемые параметры конфигурации и приложения в веб-сайты Azure — с (Stefan Schackow)](https://azure.microsoft.com/documentation/videos/configuration-and-app-settings-of-azure-web-sites/).

Сведения о других способах хранения конфиденциальной информации из системы управления версиями, см. в разделе [ASP.NET MVC: Сохранить частные параметры Out из системы управления версиями](http://typecastexception.com/post/2014/04/06/ASPNET-MVC-Keep-Private-Settings-Out-of-Source-Control.aspx).

> [!div class="step-by-step"]
> [Назад](automate-everything.md)
> [Вперед](continuous-integration-and-continuous-delivery.md)
