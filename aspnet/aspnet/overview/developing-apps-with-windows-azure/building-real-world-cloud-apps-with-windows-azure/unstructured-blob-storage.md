---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/unstructured-blob-storage
title: Неструктурированное хранилище BLOB-объектов (создание облачных приложений в реальном мире с помощью Azure) | Документация Майкрософт
author: MikeWasson
description: Создание реальных облачных приложений с помощью электронной книги Azure основано на презентации, разработанной Скотт Гатри (. В нем объясняются 13 шаблонов и методик, которые могут...
ms.author: riande
ms.date: 03/30/2015
ms.assetid: 9f05ccb1-2004-4661-ad8b-c370e6c09c8e
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/unstructured-blob-storage
msc.type: authoredcontent
ms.openlocfilehash: f48b2be755b84dff9b2672bd348c73107602c6dd
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78500412"
---
# <a name="unstructured-blob-storage-building-real-world-cloud-apps-with-azure"></a><span data-ttu-id="82dd6-104">Неструктурированное хранилище BLOB-объектов (создание облачных приложений в реальном мире с помощью Azure)</span><span class="sxs-lookup"><span data-stu-id="82dd6-104">Unstructured Blob Storage (Building Real-World Cloud Apps with Azure)</span></span>

<span data-ttu-id="82dd6-105">[Майк Уоссон](https://github.com/MikeWasson), [Рик Андерсон (](https://twitter.com/RickAndMSFT), том [Dykstra)](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="82dd6-105">by [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson](https://twitter.com/RickAndMSFT), [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="82dd6-106">[Скачивание решения ИТ-проекта](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) или [Загрузка электронной книги](https://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span><span class="sxs-lookup"><span data-stu-id="82dd6-106">[Download Fix It Project](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) or [Download E-book](https://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span></span>

> <span data-ttu-id="82dd6-107">**Создание реальных облачных приложений с помощью** электронной книги Azure основано на презентации, разработанной Скотт Гатри (.</span><span class="sxs-lookup"><span data-stu-id="82dd6-107">The **Building Real World Cloud Apps with Azure** e-book is based on a presentation developed by Scott Guthrie.</span></span> <span data-ttu-id="82dd6-108">В нем объясняются 13 шаблонов и методик, которые могут помочь в успешной разработке веб-приложений для облака.</span><span class="sxs-lookup"><span data-stu-id="82dd6-108">It explains 13 patterns and practices that can help you be successful developing web apps for the cloud.</span></span> <span data-ttu-id="82dd6-109">Сведения о электронной книге см. [в первой главе](introduction.md).</span><span class="sxs-lookup"><span data-stu-id="82dd6-109">For information about the e-book, see [the first chapter](introduction.md).</span></span>

<span data-ttu-id="82dd6-110">В предыдущей главе мы рассматривали схемы секционирования и объяснили, как приложение для устранения проблем сохраняет изображения в службе Azure Storage Blob и другие данные задач в базе данных SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="82dd6-110">In the previous chapter we looked at partitioning schemes and explained how the Fix It app stores images in the Azure Storage Blob service, and other task data in Azure SQL Database.</span></span> <span data-ttu-id="82dd6-111">В этой главе мы подробно рассмотрим службу BLOB-объектов и покажем, как она реализована в разделе Исправление кода ИТ-проекта.</span><span class="sxs-lookup"><span data-stu-id="82dd6-111">In this chapter we go deeper into the Blob service and show how it's implemented in Fix It project code.</span></span>

## <a name="what-is-blob-storage"></a><span data-ttu-id="82dd6-112">Что такое хранилище BLOB-объектов?</span><span class="sxs-lookup"><span data-stu-id="82dd6-112">What is Blob storage?</span></span>

<span data-ttu-id="82dd6-113">Служба Azure Storage Blob предоставляет способ хранения файлов в облаке.</span><span class="sxs-lookup"><span data-stu-id="82dd6-113">The Azure Storage Blob service provides a way to store files in the cloud.</span></span> <span data-ttu-id="82dd6-114">Служба BLOB-объектов имеет ряд преимуществ по сравнению с хранением файлов в локальной сетевой файловой системе:</span><span class="sxs-lookup"><span data-stu-id="82dd6-114">The Blob service has a number of advantages over storing files in a local network file system:</span></span>

- <span data-ttu-id="82dd6-115">Это очень масштабируемая.</span><span class="sxs-lookup"><span data-stu-id="82dd6-115">It's highly scalable.</span></span> <span data-ttu-id="82dd6-116">Одна учетная запись хранения может хранить [сотни терабайт](https://msdn.microsoft.com/library/windowsazure/dn249410.aspx), и у вас может быть несколько учетных записей хранения.</span><span class="sxs-lookup"><span data-stu-id="82dd6-116">A single Storage account can store [hundreds of terabytes](https://msdn.microsoft.com/library/windowsazure/dn249410.aspx), and you can have multiple Storage accounts.</span></span> <span data-ttu-id="82dd6-117">Некоторые из крупнейших клиентов Azure хранят сотни петабайтов.</span><span class="sxs-lookup"><span data-stu-id="82dd6-117">Some of the biggest Azure customers store hundreds of petabytes.</span></span> <span data-ttu-id="82dd6-118">Microsoft SkyDrive использует хранилище BLOB-объектов.</span><span class="sxs-lookup"><span data-stu-id="82dd6-118">Microsoft SkyDrive uses blob storage.</span></span>
- <span data-ttu-id="82dd6-119">Это устойчивое.</span><span class="sxs-lookup"><span data-stu-id="82dd6-119">It's durable.</span></span> <span data-ttu-id="82dd6-120">Резервное копирование всех файлов, хранящихся в службе BLOB-объектов, выполняется автоматически.</span><span class="sxs-lookup"><span data-stu-id="82dd6-120">Every file you store in the Blob service is automatically backed up.</span></span>
- <span data-ttu-id="82dd6-121">Он обеспечивает высокий уровень доступности.</span><span class="sxs-lookup"><span data-stu-id="82dd6-121">It provides high availability.</span></span> <span data-ttu-id="82dd6-122">[Соглашение об уровне обслуживания для хранилища](https://go.microsoft.com/fwlink/p/?linkid=159705&amp;clcid=0x409) обещает 99,9% или 99,99% времени работы в зависимости от выбранного варианта геоизбыточности.</span><span class="sxs-lookup"><span data-stu-id="82dd6-122">The [SLA for Storage](https://go.microsoft.com/fwlink/p/?linkid=159705&amp;clcid=0x409) promises 99.9% or 99.99% uptime, depending on which geo-redundancy option you choose.</span></span>
- <span data-ttu-id="82dd6-123">Это функция платформы как услуги (PaaS) в Azure. Это означает, что вы просто храните и извлечете файлы, платите только за фактический объем хранилища, и Azure автоматически следит за настройкой и управлением всеми виртуальными машинами и дисками, необходимыми для служеб.</span><span class="sxs-lookup"><span data-stu-id="82dd6-123">It's a platform-as-a-service (PaaS) feature of Azure, which means you just store and retrieve files, paying only for the actual amount of storage you use, and Azure automatically takes care of setting up and managing all of the VMs and disk drives required for the service.</span></span>
- <span data-ttu-id="82dd6-124">Доступ к службе BLOB-объектов можно получить с помощью REST API или API языка программирования.</span><span class="sxs-lookup"><span data-stu-id="82dd6-124">You can access the Blob service by using a REST API or by using a programming language API.</span></span> <span data-ttu-id="82dd6-125">Пакеты SDK доступны для .NET, Java, Ruby и других.</span><span class="sxs-lookup"><span data-stu-id="82dd6-125">SDKs are available for .NET, Java, Ruby, and others.</span></span>
- <span data-ttu-id="82dd6-126">При сохранении файла в службе BLOB-объектов можно легко сделать его общедоступным через Интернет.</span><span class="sxs-lookup"><span data-stu-id="82dd6-126">When you store a file in the Blob service, you can easily make it publicly available over the Internet.</span></span>
- <span data-ttu-id="82dd6-127">Вы можете защитить файлы в службе BLOB-объектов, чтобы они могли обращаться только к полномочным пользователям, или предоставить временный маркер доступа, который сделает их доступными только в течение ограниченного периода времени.</span><span class="sxs-lookup"><span data-stu-id="82dd6-127">You can secure files in the Blob service so they can accessed only by authorized users, or you can provide temporary access tokens that makes them available to someone only for a limited period of time.</span></span>

<span data-ttu-id="82dd6-128">Когда вы создаете приложение для Azure и хотите хранить большое количество данных в локальной среде, попадают в файлы, такие как изображения, видео, документы PDF, электронные таблицы и т. д. — Рассмотрим службу BLOB-объектов.</span><span class="sxs-lookup"><span data-stu-id="82dd6-128">Anytime you're building an app for Azure and you want to store a lot of data that in an on-premises environment would go in files -- such as images, videos, PDFs, spreadsheets, etc. -- consider the Blob service.</span></span>

## <a name="creating-a-storage-account"></a><span data-ttu-id="82dd6-129">Создание учетной записи хранения</span><span class="sxs-lookup"><span data-stu-id="82dd6-129">Creating a Storage account</span></span>

<span data-ttu-id="82dd6-130">Чтобы приступить к работе со службой BLOB-объектов, создайте учетную запись хранения в Azure.</span><span class="sxs-lookup"><span data-stu-id="82dd6-130">To get started with the Blob service you create a Storage account in Azure.</span></span> <span data-ttu-id="82dd6-131">На портале щелкните **создать** -- **Data Services** -- **хранилище** -- **Быстрое создание**, а затем введите URL-адрес и расположение центра обработки данных.</span><span class="sxs-lookup"><span data-stu-id="82dd6-131">In the portal, click **New** -- **Data Services** -- **Storage** -- **Quick Create**, and then enter a URL and a data center location.</span></span> <span data-ttu-id="82dd6-132">Расположение центра обработки данных должно быть таким же, как и веб-приложение.</span><span class="sxs-lookup"><span data-stu-id="82dd6-132">The data center location should be the same as your web app.</span></span>

![Создание учетной записи хранилища](unstructured-blob-storage/_static/image1.png)

<span data-ttu-id="82dd6-134">Вы выбираете основной регион, в котором вы хотите сохранить содержимое, и если вы выбрали вариант [георепликации](https://blogs.msdn.com/b/windowsazurestorage/archive/2013/12/11/introducing-read-access-geo-replicated-storage-ra-grs-for-windows-azure-storage.aspx#_Geo_Redundant_Storage) , Azure создает реплики всех данных в другом центре обработки данных в другом регионе страны.</span><span class="sxs-lookup"><span data-stu-id="82dd6-134">You pick the primary region where you want to store the content, and if you choose the [geo-replication](https://blogs.msdn.com/b/windowsazurestorage/archive/2013/12/11/introducing-read-access-geo-replicated-storage-ra-grs-for-windows-azure-storage.aspx#_Geo_Redundant_Storage) option, Azure creates replicas of all your data in a different data center in another region of the country.</span></span> <span data-ttu-id="82dd6-135">Например, если выбрать центр обработки данных "Западная часть США", то при сохранении файла он переходит в центр обработки данных "Западная часть США", но в фоновом режиме Azure также копирует его в один из других центров обработки данных США.</span><span class="sxs-lookup"><span data-stu-id="82dd6-135">For example, if you choose the Western US data center, when you store a file it goes to the Western US data center, but in the background Azure also copies it to one of the other US data centers.</span></span> <span data-ttu-id="82dd6-136">Если в одном регионе страны происходит аварии, данные остаются безнадежными.</span><span class="sxs-lookup"><span data-stu-id="82dd6-136">If a disaster happens in one region of the country, your data is still safe.</span></span>

<span data-ttu-id="82dd6-137">Azure не реплицирует данные через географические границы: Если ваше основное расположение находится в США, ваши файлы реплицируются только в другой регион в США. Если основное расположение — Австралия, файлы реплицируются только в другой центр обработки данных в Австралии.</span><span class="sxs-lookup"><span data-stu-id="82dd6-137">Azure won't replicate data across geo-political boundaries: if your primary location is in the U.S., your files are only replicated to another region within the U.S.; if your primary location is Australia, your files are only replicated to another data center in Australia.</span></span>

<span data-ttu-id="82dd6-138">Конечно, вы также можете создать учетную запись хранения, выполнив команды из скрипта, как было показано ранее.</span><span class="sxs-lookup"><span data-stu-id="82dd6-138">Of course, you can also create a Storage account by executing commands from a script, as we saw earlier.</span></span> <span data-ttu-id="82dd6-139">Ниже приведена команда Windows PowerShell для создания учетной записи хранения.</span><span class="sxs-lookup"><span data-stu-id="82dd6-139">Here's a Windows PowerShell command to create a Storage account:</span></span>

[!code-powershell[Main](unstructured-blob-storage/samples/sample1.ps1)]

<span data-ttu-id="82dd6-140">После создания учетной записи хранения вы можете сразу же начать хранить файлы в службе BLOB-объектов.</span><span class="sxs-lookup"><span data-stu-id="82dd6-140">Once you have a Storage account, you can immediately start storing files in the Blob service.</span></span>

## <a name="using-blob-storage-in-the-fix-it-app"></a><span data-ttu-id="82dd6-141">Использование хранилища BLOB-объектов в приложении Fix ИТ</span><span class="sxs-lookup"><span data-stu-id="82dd6-141">Using Blob storage in the Fix It app</span></span>

<span data-ttu-id="82dd6-142">Приложение для устранения проблем позволяет отправлять фотографии.</span><span class="sxs-lookup"><span data-stu-id="82dd6-142">The Fix It app enables you to upload photos.</span></span>

![Создание задачи решения ИТ](unstructured-blob-storage/_static/image2.png)

<span data-ttu-id="82dd6-144">При нажатии кнопки **создать Fixit**приложение отправляет указанный файл изображения и сохраняет его в службе BLOB-объектов.</span><span class="sxs-lookup"><span data-stu-id="82dd6-144">When you click **Create the FixIt**, the application uploads the specified image file and stores it in the Blob service.</span></span>

### <a name="set-up-the-blob-container"></a><span data-ttu-id="82dd6-145">Настройка контейнера больших двоичных объектов</span><span class="sxs-lookup"><span data-stu-id="82dd6-145">Set up the Blob container</span></span>

<span data-ttu-id="82dd6-146">Чтобы сохранить файл в службе BLOB-объектов, необходим *контейнер* для его хранения.</span><span class="sxs-lookup"><span data-stu-id="82dd6-146">In order to store a file in the Blob service you need a *container* to store it in.</span></span> <span data-ttu-id="82dd6-147">Контейнер службы BLOB-объектов соответствует папке файловой системы.</span><span class="sxs-lookup"><span data-stu-id="82dd6-147">A Blob service container corresponds to a file system folder.</span></span> <span data-ttu-id="82dd6-148">Сценарии создания среды, которые мы рассматривали в [главе Автоматизация всех](automate-everything.md) , создают учетную запись хранения, но не создают контейнер.</span><span class="sxs-lookup"><span data-stu-id="82dd6-148">The environment creation scripts that we reviewed in the [Automate Everything chapter](automate-everything.md) create the Storage account, but they don't create a container.</span></span> <span data-ttu-id="82dd6-149">Поэтому целью метода `CreateAndConfigure` класса `PhotoService` является создание контейнера, если он еще не существует.</span><span class="sxs-lookup"><span data-stu-id="82dd6-149">So the purpose of the `CreateAndConfigure` method of the `PhotoService` class is to create a container if it doesn't already exist.</span></span> <span data-ttu-id="82dd6-150">Этот метод вызывается из метода `Application_Start` в *Global. asax*.</span><span class="sxs-lookup"><span data-stu-id="82dd6-150">This method is called from the `Application_Start` method in *Global.asax*.</span></span>

[!code-csharp[Main](unstructured-blob-storage/samples/sample2.cs)]

<span data-ttu-id="82dd6-151">Имя учетной записи хранения и ключ доступа хранятся в коллекции `appSettings` файла *Web. config* , а код в методе `StorageUtils.StorageAccount` использует эти значения для создания строки подключения и установления соединения:</span><span class="sxs-lookup"><span data-stu-id="82dd6-151">The storage account name and access key are stored in the `appSettings` collection of the *Web.config* file, and code in the `StorageUtils.StorageAccount` method uses those values to build a connection string and establish a connection:</span></span>

[!code-csharp[Main](unstructured-blob-storage/samples/sample3.cs)]

<span data-ttu-id="82dd6-152">Затем метод `CreateAndConfigureAsync` создает объект, представляющий службу BLOB-объектов, и объект, представляющий контейнер (папку) с именем "Images" в службе больших двоичных объектов:</span><span class="sxs-lookup"><span data-stu-id="82dd6-152">The `CreateAndConfigureAsync` method then creates an object that represents the Blob service, and an object that represents a container (folder) named "images" in the Blob service:</span></span>

[!code-csharp[Main](unstructured-blob-storage/samples/sample4.cs)]

<span data-ttu-id="82dd6-153">Если контейнер с именем "Images" еще не существует, то это будет иметь значение true при первом запуске приложения для новой учетной записи хранения. код создает контейнер и устанавливает разрешения, чтобы сделать его общедоступным.</span><span class="sxs-lookup"><span data-stu-id="82dd6-153">If a container named "images" doesn't exist yet -- which will be true the first time you run the app against a new storage account -- the code creates the container and sets permissions to make it public.</span></span> <span data-ttu-id="82dd6-154">(По умолчанию новые контейнеры больших двоичных объектов являются частными и доступны только пользователям, имеющим разрешение на доступ к вашей учетной записи хранения.)</span><span class="sxs-lookup"><span data-stu-id="82dd6-154">(By default, new blob containers are private and are accessible only to users who have permission to access your storage account.)</span></span>

[!code-csharp[Main](unstructured-blob-storage/samples/sample5.cs)]

### <a name="store-the-uploaded-photo-in-blob-storage"></a><span data-ttu-id="82dd6-155">Хранение отправленной фотографии в хранилище BLOB-объектов</span><span class="sxs-lookup"><span data-stu-id="82dd6-155">Store the uploaded photo in Blob storage</span></span>

<span data-ttu-id="82dd6-156">Чтобы передать и сохранить файл изображения, приложение использует интерфейс `IPhotoService` и реализацию интерфейса в классе `PhotoService`.</span><span class="sxs-lookup"><span data-stu-id="82dd6-156">To upload and save the image file, the app uses an `IPhotoService` interface and an implementation of the interface in the `PhotoService` class.</span></span> <span data-ttu-id="82dd6-157">Файл *PhotoService.CS* содержит весь код в приложении Fix ИТ, которое взаимодействует со службой BLOB-объектов.</span><span class="sxs-lookup"><span data-stu-id="82dd6-157">The *PhotoService.cs* file contains all of the code in the Fix It app that communicates with the Blob service.</span></span>

<span data-ttu-id="82dd6-158">Следующий метод контроллера MVC вызывается, когда пользователь нажимает кнопку **создать Fixit**.</span><span class="sxs-lookup"><span data-stu-id="82dd6-158">The following MVC controller method is called when the user clicks **Create the FixIt**.</span></span> <span data-ttu-id="82dd6-159">В этом коде `photoService` ссылается на экземпляр класса `PhotoService`, а `fixittask` ссылается на экземпляр класса сущностей `FixItTask`, в котором хранятся данные для новой задачи.</span><span class="sxs-lookup"><span data-stu-id="82dd6-159">In this code, `photoService` refers to an instance of the `PhotoService` class, and `fixittask` refers to an instance of the `FixItTask` entity class that stores data for a new task.</span></span>

[!code-csharp[Main](unstructured-blob-storage/samples/sample6.cs?highlight=8)]

<span data-ttu-id="82dd6-160">Метод `UploadPhotoAsync` в классе `PhotoService` сохраняет отправленный файл в службе больших двоичных объектов и возвращает URL-адрес, указывающий на новый большой двоичный объект.</span><span class="sxs-lookup"><span data-stu-id="82dd6-160">The `UploadPhotoAsync` method in the `PhotoService` class stores the uploaded file in the Blob service and returns a URL that points to the new blob.</span></span>

[!code-csharp[Main](unstructured-blob-storage/samples/sample7.cs)]

<span data-ttu-id="82dd6-161">Как и в методе `CreateAndConfigure`, код подключается к учетной записи хранения и создает объект, представляющий контейнер больших двоичных объектов "Images", за исключением случаев, когда предполагается, что контейнер уже существует.</span><span class="sxs-lookup"><span data-stu-id="82dd6-161">As in the `CreateAndConfigure` method, the code connects to the storage account and creates an object that represents the "images" blob container, except here it assumes the container already exists.</span></span>

<span data-ttu-id="82dd6-162">Затем он создает уникальный идентификатор для образа, который будет отправлен, путем сцепления нового значения GUID с расширением файла:</span><span class="sxs-lookup"><span data-stu-id="82dd6-162">Then it creates a unique identifier for the image about to be uploaded, by concatenating a new GUID value with the file extension:</span></span>

[!code-csharp[Main](unstructured-blob-storage/samples/sample8.cs)]

<span data-ttu-id="82dd6-163">Затем код использует объект контейнера больших двоичных объектов и новый уникальный идентификатор для создания объекта BLOB, устанавливает атрибут для этого объекта, указывающий тип файла, а затем использует объект большого двоичного объекта для хранения файла в хранилище BLOB-объектов.</span><span class="sxs-lookup"><span data-stu-id="82dd6-163">The code then uses the blob container object and the new unique identifier to create a blob object, sets an attribute on that object indicating what kind of file it is, and then uses the blob object to store the file in blob storage.</span></span>

[!code-csharp[Main](unstructured-blob-storage/samples/sample9.cs)]

<span data-ttu-id="82dd6-164">Наконец, он получает URL-адрес, который ссылается на большой двоичный объект.</span><span class="sxs-lookup"><span data-stu-id="82dd6-164">Finally, it gets a URL that references the blob.</span></span> <span data-ttu-id="82dd6-165">Этот URL-адрес будет храниться в базе данных и может использоваться на веб-страницах исправления для вывода отправленного изображения.</span><span class="sxs-lookup"><span data-stu-id="82dd6-165">This URL will be stored in the database and can be used in Fix It web pages to display the uploaded image.</span></span>

[!code-csharp[Main](unstructured-blob-storage/samples/sample10.cs)]

<span data-ttu-id="82dd6-166">Этот URL-адрес хранится в базе данных как один из столбцов таблицы Фикситтаск.</span><span class="sxs-lookup"><span data-stu-id="82dd6-166">This URL is stored in the database as one of the columns of the FixItTask table.</span></span>

[!code-csharp[Main](unstructured-blob-storage/samples/sample11.cs?highlight=10)]

<span data-ttu-id="82dd6-167">Благодаря только URL-адресу в базе данных и изображениям в хранилище BLOB-приложений решение для устранения проблем сохраняет небольшие, масштабируемые и недорогие базы данных, а образы хранятся в том месте, где хранилище недорого и может обрабатывать терабайты или петабайтов.</span><span class="sxs-lookup"><span data-stu-id="82dd6-167">With only the URL in the database, and images in Blob storage, the Fix It app keeps the database small, scalable, and inexpensive, while the images are stored where storage is cheap and capable of handling terabytes or petabytes.</span></span> <span data-ttu-id="82dd6-168">Одна учетная запись хранения может хранить сотни терабайт для исправления ИТ, и вы платите только за то, что используете.</span><span class="sxs-lookup"><span data-stu-id="82dd6-168">One storage account can store hundreds of terabytes of Fix It photos, and you only pay for what you use.</span></span> <span data-ttu-id="82dd6-169">Так что вы можете начать с небольшой выплаты 9 центов на первый гигабайт и добавить дополнительные образы для копеек на каждый дополнительный гигабайт.</span><span class="sxs-lookup"><span data-stu-id="82dd6-169">So you can start off small paying 9 cents for the first gigabyte, and add more images for pennies per additional gigabyte.</span></span>

### <a name="display-the-uploaded-file"></a><span data-ttu-id="82dd6-170">Отображение отправленного файла</span><span class="sxs-lookup"><span data-stu-id="82dd6-170">Display the uploaded file</span></span>

<span data-ttu-id="82dd6-171">При отображении сведений о задаче приложение для устранения проблем отображает отправленный файл изображения.</span><span class="sxs-lookup"><span data-stu-id="82dd6-171">The Fix It application displays the uploaded image file when it displays details for a task.</span></span>

![Устранение сведений о задачах ИТ с помощью фото](unstructured-blob-storage/_static/image3.png)

<span data-ttu-id="82dd6-173">Чтобы отобразить изображение, все представление MVC должно содержать `PhotoUrl` значение в HTML-коде, отправляемом в браузер.</span><span class="sxs-lookup"><span data-stu-id="82dd6-173">To display the image, all the MVC view has to do is include the `PhotoUrl` value in the HTML sent to the browser.</span></span> <span data-ttu-id="82dd6-174">Веб-сервер и база данных не используют циклы для показа образа. они обслуживают только несколько байтов для URL-адреса образа.</span><span class="sxs-lookup"><span data-stu-id="82dd6-174">The web server and the database are not using cycles to display the image, they are only serving up a few bytes to the image URL.</span></span> <span data-ttu-id="82dd6-175">В следующем коде Razor `Model` ссылается на экземпляр класса сущностей `FixItTask`.</span><span class="sxs-lookup"><span data-stu-id="82dd6-175">In the following Razor code, `Model` refers to an instance of the `FixItTask` entity class.</span></span>

[!code-cshtml[Main](unstructured-blob-storage/samples/sample12.cshtml?highlight=11)]

<span data-ttu-id="82dd6-176">Если взглянуть на код HTML отображаемой страницы, вы увидите URL-адрес, указывающий непосредственно на образ в хранилище BLOB-объектов, примерно так:</span><span class="sxs-lookup"><span data-stu-id="82dd6-176">If you look at the HTML of the page that displays, you see the URL pointing directly to the image in blob storage, something like this:</span></span>

[!code-cshtml[Main](unstructured-blob-storage/samples/sample13.cshtml?highlight=11)]

## <a name="summary"></a><span data-ttu-id="82dd6-177">Сводка</span><span class="sxs-lookup"><span data-stu-id="82dd6-177">Summary</span></span>

<span data-ttu-id="82dd6-178">Вы увидели, как приложение для устранения проблем сохраняет изображения в службе BLOB-объектов и только URL для изображений в базе данных SQL.</span><span class="sxs-lookup"><span data-stu-id="82dd6-178">You've seen how the Fix It app stores images in the Blob service and only image URLs in the SQL database.</span></span> <span data-ttu-id="82dd6-179">Использование службы BLOB-объектов позволяет хранить базу данных SQL гораздо меньше, чем в противном случае, что позволяет масштабировать до почти неограниченного числа задач и может быть выполнено без написания большого объема кода.</span><span class="sxs-lookup"><span data-stu-id="82dd6-179">Using the Blob service keeps the SQL database much smaller than it otherwise would be, makes it possible to scale up to an almost unlimited number of tasks, and can be done without writing a lot of code.</span></span>

<span data-ttu-id="82dd6-180">В учетной записи хранения можно использовать сотни терабайтов, а стоимость хранения гораздо дешевле, чем хранилище базы данных SQL, начиная с 3 центов за гигабайт в месяц и за счет небольшого объема транзакций.</span><span class="sxs-lookup"><span data-stu-id="82dd6-180">You can have hundreds of terabytes in a storage account, and the storage cost is much less expensive than SQL Database storage, starting at about 3 cents per gigabyte per month plus a small transaction charge.</span></span> <span data-ttu-id="82dd6-181">И помните, что вы не платите за максимальную емкость, но только за фактический объем, чтобы ваше приложение было готово к масштабированию, но вы не оплачиваете все эти дополнительные возможности.</span><span class="sxs-lookup"><span data-stu-id="82dd6-181">And keep in mind that you're not paying for the maximum capacity but only for the amount you actually store, so your app is ready to scale but you're not paying for all that extra capacity.</span></span>

<span data-ttu-id="82dd6-182">В [следующей главе](design-to-survive-failures.md) мы поговорим о важности создания облачного приложения, способного корректно обрабатывать сбои.</span><span class="sxs-lookup"><span data-stu-id="82dd6-182">In the [next chapter](design-to-survive-failures.md) we'll talk about the importance of making a cloud app capable of gracefully handling failures.</span></span>

## <a name="resources"></a><span data-ttu-id="82dd6-183">Ресурсы</span><span class="sxs-lookup"><span data-stu-id="82dd6-183">Resources</span></span>

<span data-ttu-id="82dd6-184">Дополнительные сведения см. в следующих ресурсах:</span><span class="sxs-lookup"><span data-stu-id="82dd6-184">For more information see the following resources:</span></span>

- <span data-ttu-id="82dd6-185">[Введение в хранилище BLOB-объектов Azure](https://www.simple-talk.com/cloud/cloud-data/an-introduction-to-windows-azure-blob-storage-/).</span><span class="sxs-lookup"><span data-stu-id="82dd6-185">[An Introduction to Azure BLOB Storage](https://www.simple-talk.com/cloud/cloud-data/an-introduction-to-windows-azure-blob-storage-/).</span></span> <span data-ttu-id="82dd6-186">Блог от Майка.</span><span class="sxs-lookup"><span data-stu-id="82dd6-186">Blog by Mike Wood.</span></span>
- <span data-ttu-id="82dd6-187">[Как использовать службу хранилища BLOB-объектов Azure в .NET](https://docs.microsoft.com/azure/storage/blobs/storage-dotnet-how-to-use-blobs).</span><span class="sxs-lookup"><span data-stu-id="82dd6-187">[How to use the Azure Blob Storage Service in .NET](https://docs.microsoft.com/azure/storage/blobs/storage-dotnet-how-to-use-blobs).</span></span> <span data-ttu-id="82dd6-188">Официальная документация на сайте MicrosoftAzure.com.</span><span class="sxs-lookup"><span data-stu-id="82dd6-188">Official documentation on the MicrosoftAzure.com site.</span></span> <span data-ttu-id="82dd6-189">Краткое введение в хранилище BLOB-объектов, а затем примеры кода, посвященные подключению к хранилищу BLOB-объектов, созданию контейнеров, передаче и скачиванию больших двоичных объектов и т. д.</span><span class="sxs-lookup"><span data-stu-id="82dd6-189">A brief introduction to blob storage followed by code examples showing how to connect to blob storage, create containers, upload and download blobs, etc.</span></span>
- <span data-ttu-id="82dd6-190">[Отказоустойчивость: создание масштабируемых отказоустойчивых облачных служб](https://channel9.msdn.com/Series/FailSafe).</span><span class="sxs-lookup"><span data-stu-id="82dd6-190">[FailSafe: Building Scalable, Resilient Cloud Services](https://channel9.msdn.com/Series/FailSafe).</span></span> <span data-ttu-id="82dd6-191">Серия видео из девяти частей по Ульрих Хоманн, (Marc Меркури и пометить SIMM.</span><span class="sxs-lookup"><span data-stu-id="82dd6-191">Nine-part video series by Ulrich Homann, Marc Mercuri, and Mark Simms.</span></span> <span data-ttu-id="82dd6-192">Предоставляет основные понятия и архитектурные принципы в очень удобном и интересном смысле, а также истории, полученные от работы группы консультирования клиентов Майкрософт (CAT) с реальными клиентами.</span><span class="sxs-lookup"><span data-stu-id="82dd6-192">Presents high-level concepts and architectural principles in a very accessible and interesting way, with stories drawn from Microsoft Customer Advisory Team (CAT) experience with actual customers.</span></span> <span data-ttu-id="82dd6-193">Сведения о службе хранилища Azure и больших двоичных объектах см. в статье о версии 5, начиная с 35:13.</span><span class="sxs-lookup"><span data-stu-id="82dd6-193">For a discussion of Azure Storage service and blobs, see episode 5 starting at 35:13.</span></span>
- <span data-ttu-id="82dd6-194">[Шаблоны и методики Майкрософт. Руководство по Azure](https://msdn.microsoft.com/library/dn568099.aspx).</span><span class="sxs-lookup"><span data-stu-id="82dd6-194">[Microsoft Patterns and Practices - Azure Guidance](https://msdn.microsoft.com/library/dn568099.aspx).</span></span> <span data-ttu-id="82dd6-195">См. раздел шаблон камердинера Key.</span><span class="sxs-lookup"><span data-stu-id="82dd6-195">See Valet Key pattern.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="82dd6-196">[Назад](data-partitioning-strategies.md)
> [Вперед](design-to-survive-failures.md)</span><span class="sxs-lookup"><span data-stu-id="82dd6-196">[Previous](data-partitioning-strategies.md)
[Next](design-to-survive-failures.md)</span></span>
