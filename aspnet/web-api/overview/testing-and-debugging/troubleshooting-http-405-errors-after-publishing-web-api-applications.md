---
uid: web-api/overview/testing-and-debugging/troubleshooting-http-405-errors-after-publishing-web-api-applications
title: Устранение неполадок HTTP 405 ошибки после публикации веб-приложений API | Документация Майкрософт
author: rmcmurray
description: Это руководство содержит инструкции для устранения ошибок HTTP 405 после публикации веб-API приложения рабочий веб-сервер.
ms.author: riande
ms.date: 01/23/2019
ms.assetid: 07ec7d37-023f-43ea-b471-60b08ce338f7
msc.legacyurl: /web-api/overview/testing-and-debugging/troubleshooting-http-405-errors-after-publishing-web-api-applications
msc.type: authoredcontent
ms.openlocfilehash: ce5b617cc1032d190cc2450aa554b462ea6f6156
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/01/2019
ms.locfileid: "57025331"
---
# <a name="troubleshooting-http-405-errors-after-publishing-web-api-applications"></a>Устранение ошибок HTTP 405 после публикации приложений веб-API

> Это руководство содержит инструкции для устранения ошибок HTTP 405 после публикации веб-API приложения рабочий веб-сервер.
> 
> ## <a name="software-used-in-this-tutorial"></a>Программное обеспечение, используемое в этом руководстве
> 
> 
> - [Internet Information Services (IIS)](https://www.iis.net/) (версии 7 или более поздней версии)
> - [Веб-API](../../index.md) 


Веб-API приложения обычно используют распространенные HTTP-команды: GET, POST, PUT, DELETE, а иногда и PATCH. Неудачна разработчикам можете оказаться в ситуации, где эти команды реализуются другой модуль IIS на их рабочем сервере, который ведет к ситуации, куда будет возвращать контроллер Web API, правильно работающая в Visual Studio или на сервере разработки HTTP 405 ошибки при развертывании на рабочем сервере. К счастью, эту проблему легко устранена, но разрешение гарантирует объяснение, почему возникают проблемы.

## <a name="what-causes-http-405-errors"></a>Что вызывает ошибки HTTP 405

Первый шаг к обучения как ошибки HTTP 405 — понять, что фактически означает ошибку HTTP 405. Управляющий основной тип документа для протокола HTTP — это [RFC 2616](http://www.ietf.org/rfc/rfc2616.txt), который определяет код состояния HTTP 405, когда ***метод запрещен***и более подробно описывающими этот код состояния, как состояние где &quot;метод указанный в строке запроса не допускается для ресурса, указанного в URI запроса.&quot; Другими словами HTTP-команду для конкретного URL-адреса HTTP-клиент запросил не допускается.

В качестве краткого обзора ниже приведены некоторые из наиболее часто используемые методы HTTP как определено в RFC 2616, RFC 4918 и RFC 5789.

| Метод HTTP | Описание |
| --- | --- |
| **ПОЛУЧИТЬ** | Этот метод используется для получения данных из URI и он, вероятно, наиболее часто используемые метод HTTP. |
| **HEAD** | Этот метод является очень похоже на метод GET, за исключением того, что она не извлекает фактически не данные из URI запроса — он просто получает сведения о состоянии HTTP. |
| **ПОМЕСТИТЬ** | Этот метод обычно используется для отправки новых данных к URL-АДРЕСУ; POST часто используется для отправки данных формы. |
| **PUT** | Этот метод обычно используется для отправки необработанных данных в универсальный код Ресурса; PUT часто используется для отправки данных JSON или XML в приложениях Web API. |
| **УДАЛЕНИЕ** | Этот метод используется для удаления данных из URI. |
| **ПАРАМЕТРЫ** | Этот метод обычно используется для получения списка методов HTTP, которые поддерживаются для URI. |
| **КОПИРОВАНИЕ ПЕРЕМЕЩЕНИЕ** | Эти два метода используются с WebDAV, и их назначение — говорит само за себя. |
| **MKCOL** | Этот метод вызывается WebDAV, и он используется для создания коллекции (например, каталог) по указанному URI. |
| **PROPFIND PROPPATCH** | Эти два метода используются с WebDAV, и они используются для запроса или задать свойства для URI. |
| **РАЗБЛОКИРОВАТЬ БЛОКИРОВКИ** | Эти два метода используются с WebDAV, и они используются, чтобы заблокировать или разблокировать ресурс, идентифицируемый URI запроса при создании. |
| **ИСПРАВЛЕНИЕ** | Этот метод используется для изменения существующего ресурса HTTP. |

Если один из этих методов HTTP настроена для использования на сервере, сервер вернет код состояния HTTP и других данных, который подходит для запроса. (Например, метод GET может получать HTTP 200 ***ОК*** ответа, а метод PUT может получать HTTP 201 ***Created*** ответ.)

Если метод HTTP не настроен для использования на сервере, сервер вернет HTTP 501 ***не реализован*** ошибки.

Тем не менее, при HTTP-метода была настроена для использования на сервере, но она была отключена для заданного URI, сервер будет отправить в ответ HTTP 405 ***метод запрещен*** ошибки.

## <a name="example-http-405-error"></a>Ошибка HTTP 405 пример

Следующий пример HTTP-запрос и ответ показаны ситуации, где HTTP-клиент пытается ПОМЕСТИТЬ значение в веб-API приложение на веб-сервере, а сервер возвращает ошибку HTTP, что состояния, которые метод PUT не допускается.


HTTP-запроса:


[!code-console[Main](troubleshooting-http-405-errors-after-publishing-web-api-applications/samples/sample1.cmd)]


HTTP-ответа:


[!code-console[Main](troubleshooting-http-405-errors-after-publishing-web-api-applications/samples/sample2.cmd)]


В этом примере клиент HTTP при отправке запроса JSON допустимый URL-адрес для веб-API приложения на веб-сервере, но сервер вернул сообщение об ошибке HTTP 405, который указывает, что метод PUT не разрешалось использовать URL-адреса. Напротив, если URI запроса не соответствует маршрут для приложения веб-API, сервер вернет HTTP 404 ***не найден*** ошибки.

## <a name="resolve-http-405-errors"></a>Устранение ошибок HTTP 405

Существует несколько причин, почему определенные HTTP-команда не может быть разрешен, но есть основной скрипт, является ведущим причиной этой ошибки в службах IIS: несколько обработчиков определены для одной команды или метода, и один из обработчиков блокирует ожидаемый из обработчика обработку запроса. Посредством объяснение IIS обрабатывает обработчики из первых последнего на основе порядка обработчик записей в файле applicationHost.config и web.config, где первый соответствующим сочетанием из пути, команды, ресурсов и др., будет использоваться для обработки запроса.

Следующий пример представляет выдержку из файла applicationHost.config по использованию IIS server, который возвращается ошибка HTTP 405, при использовании метода PUT для отправки данных в приложении веб-API. В этом фрагменте определяются несколько обработчиков HTTP и каждый обработчик имеет другой набор методов HTTP, для которых настроена - обработчику статического содержимого, который является обработчиком по умолчанию, используемый после другие обработчики имели chanc является последней записи в списке e, чтобы запрос на:

[!code-xml[Main](troubleshooting-http-405-errors-after-publishing-web-api-applications/samples/sample3.xml)]

В приведенном выше примере обработчик WebDAV и обработчик URL-адресов без расширений для ASP.NET (который используется для веб-API) четко определяются для отдельные списки в HTTP-методов. Обратите внимание на то, что обработчик ISAPI DLL настроена для всех методов HTTP, несмотря на то, что эта конфигурация не обязательно вызывает ошибку. Тем не менее параметры конфигурации, как это необходимо учитывать при устранении ошибок HTTP 405.

В приведенном выше примере обработчик ISAPI DLL не проблема; на самом деле проблема не был определен в файле applicationHost.config для сервера IIS — причина запись в файле web.config, при создании приложения веб-API в Visual Studio. В следующем фрагменте из файла web.config приложения показано расположение проблемы:

[!code-xml[Main](troubleshooting-http-405-errors-after-publishing-web-api-applications/samples/sample4.xml)]

В этом фрагменте обработчик URL-адресов без расширений для ASP.NET переопределяется для включения дополнительных методов HTTP, которые будут использоваться в приложении веб-API. Тем не менее так как для обработчика WebDAV определен аналогичный набор методов HTTP, возникает конфликт. В этом конкретном случае обработчик WebDAV определяется и загрузки службами IIS, несмотря на то, что WebDAV отключен для веб-сайта, которая включает приложение веб-API. Во время обработки запроса HTTP PUT, IIS вызывает модуль WebDAV, так как он определен для команды PUT. При вызове модуля WebDAV, он проверит свою конфигурацию и видит, что она отключена, так что он возвращает HTTP 405 ***метод запрещен*** ошибку для любого запроса, который похож на запрос WebDAV. Чтобы устранить эту проблему, следует удалить из списка модулей HTTP для веб-сайта, где определяется веб-API приложения WebDAV. В следующем примере показано, что, может выглядеть следующим образом:

[!code-xml[Main](troubleshooting-http-405-errors-after-publishing-web-api-applications/samples/sample5.xml)]

Этот сценарий часто встречающихся после публикации приложения из среды разработки в рабочей среде, и это происходит, поскольку список обработчиков и модулей, отличается от среды разработки и рабочей среде. Например, если вы используете Visual Studio 2012 или более поздней версии, чтобы разработать приложение веб-API IIS Express является сервером по умолчанию для тестирования. Этот веб-сервер разработки является упрощенной версией полной функциональности IIS, входящий в серверный продукт, и этот веб-сервер разработки содержит несколько изменений, которые были добавлены для сценариев разработки. Например модуль WebDAV часто установлен на рабочий веб-сервер под управлением полной версии IIS, несмотря на то, что может оказаться на практике. Версии разработки IIS (IIS Express), будет установлен модуль WebDAV, но записи для модуля WebDAV намеренно закомментированы, чтобы модуль WebDAV никогда не был загружен на сервер IIS Express, если конфигурации IIS Express параметры, чтобы добавить функциональными возможностями WebDAV в установку IIS Express. Таким образом веб-приложение может работать должным образом на компьютере разработчика, но могут возникнуть ошибки HTTP 405, при публикации веб-API приложения на веб-сервер в рабочей среде.

## <a name="summary"></a>Сводка

HTTP 405 ошибки возникают в том случае, если метод HTTP не разрешен веб-сервером для запрошенного URL-адреса. Это условие часто рассматривается при конкретной обработчик был определен для определенной команды, и этот обработчик переопределяет обработчик, который предполагается, что для обработки запроса.

Если возникнет ситуация, когда появляется сообщение об ошибке HTTP 501, это означает, что конкретные функции не был реализован на сервере, это часто означает, что нет обработчика, заданных в параметрах IIS, которая согласуется с HTTP-запроса, который Возможно, указывает, что что-то неправильно установлен на компьютере или что-то изменил параметры IIS, таким образом, что обработчики отсутствуют определенные этот метод для поддержки конкретных HTTP. Разрешить эту проблему, необходимо повторно установить любое приложение, которое пытается использовать метод HTTP, для которого он не имеет соответствующего модуля и определения обработчика.
