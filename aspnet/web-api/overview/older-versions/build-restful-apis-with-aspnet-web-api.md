---
uid: web-api/overview/older-versions/build-restful-apis-with-aspnet-web-api
title: Создание API-интерфейсов RESTful с помощью ASP.NET Web API — ASP.NET 4.x
author: rick-anderson
description: Практическое лабораторное занятие. Использование веб-API в ASP.NET 4.x, создать простой API REST для приложения диспетчера контактов.
ms.author: riande
ms.date: 02/18/2013
ms.custom: seoapril2019
ms.assetid: 87daa99f-3810-407e-b969-dd28a192959d
msc.legacyurl: /web-api/overview/older-versions/build-restful-apis-with-aspnet-web-api
msc.type: authoredcontent
ms.openlocfilehash: 35b115d6b4f84084e78e429bbb4842670e57bba4
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65132265"
---
# <a name="build-restful-apis-with-aspnet-web-api"></a>Создание API-интерфейсов RESTful с помощью веб-API ASP.NET

по [Web Слышатся Team](https://twitter.com/webcamps)

> Практическое лабораторное занятие. Использование веб-API в ASP.NET 4.x, создать простой API REST для приложения диспетчера контактов. Вы также создадите клиента для использования API.

В последние годы стало clear, что HTTP не только для подготовки HTML-страницы. Это также мощную платформу для построения веб-API, такие как с помощью несколько команд (GET, POST и т. д.) плюс несколько простых концепции *идентификаторы URI* и *заголовки*. Веб-API ASP.NET — это набор компонентов, которые упрощают программирование HTTP. Так как она построена на основе среды выполнения ASP.NET MVC, веб-API автоматически обрабатывает сведения низкого уровня транспорта протокола HTTP. В то же время веб-API, естественным образом, предоставляет модель программирования HTTP. На самом деле, одна из целей веб-API — *не* абстрагировании от реальности HTTP. Таким образом веб-API, гибкие и легко расширяется.  Архитектурный стиль REST оказалось эффективным способом использовать HTTP -, несмотря на то, что это, конечно, единственным допустимым подход к HTTP. Диспетчер контактов будет предоставлять RESTful для списка, добавление и удаление контактов, среди прочего. 

Это лабораторное занятие требует понимания HTTP, REST и предполагается, что вы имеете базовые знания рабочий HTML, JavaScript и jQuery.
> 
> > [!NOTE]
> > Веб-узла ASP.NET имеет выделенный в веб-API ASP.NET Framework в область [ https://asp.net/web-api ](https://asp.net/web-api). Этот сайт будет продолжать последние сведения, примеры и новостей, относящихся к веб-API, поэтому она регулярно проверяйте Если вы хотите более подробно рассмотрим искусством создания пользовательского веб-API, доступных для framework практически с любого устройства или разработки.
> > 
> > Веб-API, аналогичную ASP.NET MVC 4 ASP.NET имеет большую гибкость с точки зрения отделение слой служб от контроллеров, позволяя использовать несколько доступных платформ внедрения зависимостей довольно просто. В MSDN, показывающий, как использовать Ninject для внедрения зависимостей в проекте веб-API ASP.NET, его можно загрузить из есть хороший пример [здесь](https://code.msdn.microsoft.com/ASPNET-Web-API-JavaScript-d0d64dd7).
> 
> 
> Все примеры кода и фрагменты кода включены в Web лагеря комплект обучающих материалов, доступных в [ https://go.microsoft.com/fwlink/?LinkID=248297&clcid=0x409 ](https://go.microsoft.com/fwlink/?LinkID=248297&clcid=0x409).

<a id="Objectives"></a>
### <a name="objectives"></a>Цели

В этой практической работу вы узнаете, как:

- Реализации веб-API RESTful
- Для вызова API из HTML-клиента

<a id="Prerequisites"></a>
### <a name="prerequisites"></a>Предварительные требования

Для завершения этой практической работу требуется следующее:

- [Microsoft Visual Studio Express 2012 для Web](https://www.microsoft.com/visualstudio/eng/products/visual-studio-express-for-web) или руководителя (чтение [приложении Б](#AppendixB) инструкции по его установке).

<a id="Setup"></a>
### <a name="setup"></a>Установка

**Установка фрагменты кода**

Для удобства большая часть кода, который вы планируете управлять вдоль этой лаборатории доступен как фрагменты кода Visual Studio. Чтобы установить фрагменты кода запуска **.\Source\Setup\CodeSnippets.vsi** файла.

Если вы не знакомы с фрагменты кода Visual Studio и хотите научиться использовать их, можно ссылаться в приложение из этого документа &quot; [приложении a. Фрагменты кода](#AppendixA)&quot;.

<a id="Exercises"></a>
## <a name="exercises"></a>Упражнения

Это Практическое занятие включает в себя следующие упражнения:

1. [Упражнение 1. Создание только для чтения веб-API](#Exercise1)
2. [Упражнение 2. Создание чтения и записи веб-API](#Exercise2)
3. [Упражнение 3. Использовать веб-API из HTML-клиента](#Exercise3)

> [!NOTE]
> Каждого упражнения сопровождается **окончания** папку, содержащую полученное решение, должен быть получен после завершения упражнения. Это решение можно использовать как руководство, если вам нужна дополнительная помощь при работе с примерами.

Предполагаемое время для выполнения этого лабораторного: **60 минут**.

<a id="Exercise1"></a>

<a id="Exercise_1_Create_a_Read-Only_Web_API"></a>
### <a name="exercise-1-create-a-read-only-web-api"></a>Упражнение 1. Создание только для чтения веб-API

В этом упражнении вы реализуете методы GET только для чтения для диспетчера контактов.

<a id="Ex1Task1"></a>

<a id="Task_1_-_Creating_the_API_Project"></a>
#### <a name="task-1---creating-the-api-project"></a>Задача 1 - Создание проекта API

В этой задаче будет использовать новые шаблоны веб-проектов ASP.NET для создания веб-приложения веб-API.

1. Запустите **Visual Studio 2012 Express для Web**, для этого перейдите к **запустить** и тип **VS Express для Web** нажмите клавишу **ввод**.
2. Из **файл** меню, выберите **новый проект**. Выберите **Visual C# | Web** тип в представлении дерева проекта типа проекта, а затем выберите **веб-приложение ASP.NET MVC 4** тип проекта. Установите проект **имя** для *ContactManager* и **имя решения** для *начать*, нажмите кнопку **ОК**.

    ![Создание нового ASP.NET MVC 4.0 проект веб-приложения](build-restful-apis-with-aspnet-web-api/_static/image1.png "Создание нового ASP.NET MVC 4.0 проект веб-приложения")

    *Создание нового ASP.NET MVC 4.0 проект веб-приложения*
3. В диалоговом окне типа проекта ASP.NET MVC 4, выберите **веб-API** тип проекта. Нажмите кнопку **ОК**.

    ![Указывает тип проекта веб-API](build-restful-apis-with-aspnet-web-api/_static/image2.png "указывает тип проекта веб-API")

    *Указывает тип проекта веб-API*

<a id="Ex1Task2"></a>

<a id="Task_2_-_Creating_the_Contact_Manager_API_Controllers"></a>
#### <a name="task-2---creating-the-contact-manager-api-controllers"></a>Задача 2 - Создание контроллеров API диспетчера контактов

В этой задаче вы создадите классы контроллера, в которых будет находиться методов API.

1. Удалите файл с именем **ValuesController.cs** в **контроллеров** папку из проекта.
2. Щелкните правой кнопкой мыши **контроллеров** папки в проект и выберите **Add | Контроллер** в контекстном меню.

    ![Добавление в проект новый контроллер](build-restful-apis-with-aspnet-web-api/_static/image3.png "добавлении нового контроллера в проект")

    *Добавление в проект новый контроллер*
3. В **Добавление контроллера** появившемся диалоговом окне выберите **пустой контроллер API** меню шаблон. Имя класса контроллера **ContactController**. Щелкните **Add.**

    ![Используя диалоговое окно добавления контроллера для создания нового контроллера веб-API](build-restful-apis-with-aspnet-web-api/_static/image4.png "используя диалоговое окно добавления контроллера для создания нового контроллера веб-API")

    *Используя диалоговое окно добавления контроллера для создания нового контроллера веб-API*
4. Добавьте следующий код, чтобы **ContactController**.

    (Code Snippet - *метод API Get лаборатории API веб - Ex01 -*)

    [!code-csharp[Main](build-restful-apis-with-aspnet-web-api/samples/sample1.cs)]
5. Нажмите клавишу **F5** для отладки приложения. Откроется домашняя страница по умолчанию для проекта веб-API.

    ![Домашняя страница по умолчанию приложения веб-API ASP.NET](build-restful-apis-with-aspnet-web-api/_static/image5.png "Домашняя страница по умолчанию приложения веб-API ASP.NET")

    *Домашняя страница по умолчанию приложения веб-API ASP.NET*
6. В окне Internet Explorer, нажмите клавишу **F12** клавишу, чтобы открыть **средств разработчика** окна. Нажмите кнопку **сети** , а затем щелкните **начать захват** кнопку, чтобы начать отслеживать сетевой трафик в окно.

    ![Открыв вкладку "Сеть" и затем запускать сбор по сети](build-restful-apis-with-aspnet-web-api/_static/image6.png "открыв вкладку \"Сеть\" и затем запускать сбор по сети")

    *Открыв вкладку "Сеть" и затем запускать сбор данных о сети*
7. Добавьте URL-адрес в адресной строке браузера с **/api/contact** и нажмите клавишу ВВОД. В окне записи сети отображаются сведения передачи. Обратите внимание, что в ответе тип MIME **application/json**. Это показывает, как формат выходных данных по умолчанию — JSON.

    ![Просмотр выходных данных запроса веб-API в представлении сети](build-restful-apis-with-aspnet-web-api/_static/image7.png "просмотр выходных данных запроса веб-API в представлении сети")

    *Просмотр выходных данных запроса веб-API в представлении сети*

    > [!NOTE]
    > Поведение по умолчанию Internet Explorer 10 на этом этапе следует задавать, если пользователь хочет сохранить или открыть поток, полученный из вызова веб-API. Выходные данные будут текстовый файл, содержащий результат JSON вызова URL-адрес API. Не отменять диалогового окна, чтобы иметь возможность просматривать содержимое ответа через окно инструментов для разработчиков.
8. Нажмите кнопку **перейдите к представлению подробные** кнопки для просмотра дополнительных сведений об ответе этот вызов API.

    ![Переключиться в подробное представление](build-restful-apis-with-aspnet-web-api/_static/image8.png "переключитесь в представление сведений")

    *Переключиться в подробное представление*
9. Нажмите кнопку **текст ответа** вкладку, чтобы просмотреть фактический текст ответа JSON.

    ![Просмотр JSON вывода текста в сетевом мониторе](build-restful-apis-with-aspnet-web-api/_static/image9.png "просмотра JSON вывода текста в сетевом мониторе")

    *Просмотр выходного текста JSON в сетевом мониторе*

<a id="Ex1Task3"></a>

<a id="Task_3_-_Creating_the_Contact_Models_and_Augment_the_Contact_Controller"></a>
#### <a name="task-3---creating-the-contact-models-and-augment-the-contact-controller"></a>Задача 3 - Создание связи моделей и дополнять контактные контроллера

В этой задаче вы создадите классы контроллера, в которых будет находиться методов API.

1. Щелкните правой кнопкой мыши **моделей** папку и выберите **Add | Класс...**  в контекстном меню.

    ![Добавление новой модели в веб-приложение](build-restful-apis-with-aspnet-web-api/_static/image10.png "Добавление новой модели в веб-приложение")

    *Добавление новой модели в веб-приложение*
2. В **Добавление нового элемента** диалоговое окно, назовите новый файл **Contact.cs** и нажмите кнопку **Add.**

    ![Создание нового файла класса контакта](build-restful-apis-with-aspnet-web-api/_static/image11.png "Создание новый файл класса контакта")

    *Создание нового файла класса контакта*
3. Добавьте следующий выделенный код, который **контакт** класса.

    (Code Snippet - *веб-API лаборатории - Ex01 - класса контакта*)

    [!code-csharp[Main](build-restful-apis-with-aspnet-web-api/samples/sample2.cs)]
4. В **ContactController** выберите слово **строка** в определение метода **получить** метод и введите слово *контакт*. После слово вводится в, индикатора будет отображаться в начале слова **контакт**. Либо удерживайте **Ctrl** ключа и нажмите клавишу точки (.) или щелкните значок с помощью мыши, чтобы открыть диалоговое окно помощника в редакторе кода, чтобы автоматически заполнять **с помощью** директив для моделей пространство имен.

    ![С помощью Intellisense помощь для деклараций пространств имен](build-restful-apis-with-aspnet-web-api/_static/image12.png)

    *С помощью Intellisense помощь для деклараций пространств имен*
5. Изменение кода для **получить** метод, возвращающий массив экземпляров модели контакта.

    (Code Snippet - *лаборатории API веб - Ex01 - Возврат списка контактов*)

    [!code-csharp[Main](build-restful-apis-with-aspnet-web-api/samples/sample3.cs)]
6. Нажмите клавишу **F5** для отладки веб-приложения в браузере. Чтобы просмотреть изменения, внесенные в выходные данные ответа API, выполните следующие действия.

   1. После того, как браузер откроется, нажмите **F12** средств разработчика еще не открытым.
   2. Нажмите кнопку **сети** вкладки.
   3. Нажмите клавишу **начать захват** кнопки.
   4. Добавьте суффикс URL-адрес **/api/contact** на URL-адрес в адресной строке и нажмите клавишу **ввод** ключ.
   5. Нажмите клавишу **перейдите к представлению подробные** кнопки.
   6. Выберите **текст ответа** вкладки. Вы должны увидеть строку JSON, представляющая сериализованную форму массива экземпляров контакта.

      ![JSON-сериализованных выходных данных вызова метода веб-API, сложных](build-restful-apis-with-aspnet-web-api/_static/image13.png "JSON сериализованных выходных данных сложные вызова метода веб-API")

      *Выходные данные сериализации JSON сложных вызова метода веб-API*

<a id="Ex1Task4"></a>

<a id="Task_4_-_Extracting_Functionality_into_a_Service_Layer"></a>
#### <a name="task-4---extracting-functionality-into-a-service-layer"></a>Задача 4 - извлечения функции в слой служб

Эта задача будет показано, как для извлечения функции в слой служб, что упрощает для разработчиков для разделения их функциональность службы от уровня контроллера, тем самым позволяя возможность многократного использования служб, которые фактически выполняющие работу.

1. Создайте новую папку в корневом каталоге решения и назовите его **служб**. Чтобы сделать это, щелкните правой кнопкой мыши **ContactManager** проекта, выберите **добавить** | **новую папку**, назовите его *служб*.

    ![Папка служб создание](build-restful-apis-with-aspnet-web-api/_static/image14.png "папку создание служб")

    *Создание папки служб*
2. Щелкните правой кнопкой мыши **служб** папку и выберите **Add | Класс...**  в контекстном меню.

    ![Добавление нового класса в папку службы](build-restful-apis-with-aspnet-web-api/_static/image15.png "Добавление нового класса в папку «службы»")

    *Добавление нового класса в папку «службы»*
3. Когда **Добавление нового элемента** откроется диалоговое окно, назовите новый класс **ContactRepository** и нажмите кнопку **добавить**.

    ![Создание класса файл, содержащий код для уровня службы репозитория обратитесь к](build-restful-apis-with-aspnet-web-api/_static/image16.png "создания файла класса должен содержать код для уровня службы репозитория контактов")

    *Создание класса файл, содержащий код для уровня службы репозитория контактов*
4. Добавить с помощью директивы **ContactRepository.cs** файл, чтобы включить пространство имен модели.

    [!code-csharp[Main](build-restful-apis-with-aspnet-web-api/samples/sample4.cs)]
5. Добавьте следующий выделенный код, который **ContactRepository.cs** файл для реализации метода GetAllContacts.

    (Code Snippet - *веб-API лаборатории - Ex01 - репозиторий контактов*)

    [!code-csharp[Main](build-restful-apis-with-aspnet-web-api/samples/sample5.cs)]
6. Откройте **ContactController.cs** файла, если он еще не открыт.
7. Добавьте следующий код с помощью инструкции в раздел объявлений пространства имен файла.

    [!code-csharp[Main](build-restful-apis-with-aspnet-web-api/samples/sample6.cs)]
8. Добавьте следующий выделенный код, который **ContactController.cs** класса добавьте закрытое поле для представления экземпляра репозитория, таким образом, чтобы использовать rest членам класса реализации службы.

    (Code Snippet - *лаборатории API - Ex01 - контактные контроллер веб-*)

    [!code-csharp[Main](build-restful-apis-with-aspnet-web-api/samples/sample7.cs)]
9. Изменение **получить** метод, поэтому она позволяет использовать службы репозитория контактов.

    (Code Snippet - *лаборатории API веб - Ex01 - Возврат списка контактов с помощью репозитория*)

    [!code-csharp[Main](build-restful-apis-with-aspnet-web-api/samples/sample8.cs)]
10. Установите точку останова на **ContactController** **получить** определение метода.

   ![Добавление точек останова к контроллеру контактные](build-restful-apis-with-aspnet-web-api/_static/image17.png "Добавление точек останова к контроллеру контакта")

   *Добавление точек останова к контроллеру контакта*
11. Нажмите клавишу **F5** для запуска приложения.
12. Когда откроется браузер, нажмите клавишу **F12** открытие средств разработчика.
13. Нажмите кнопку **сети** вкладки.
14. Нажмите кнопку **начать захват** кнопки.
15. Добавьте URL-адрес в адресной строке с суффиксом **/api/contact** и нажмите клавишу **ввод** загрузить контроллер API.
16. Visual Studio 2012 следует останов **получить** начинается выполнение метода.

   ![Критические в метод Get](build-restful-apis-with-aspnet-web-api/_static/image18.png "критические в метод Get")

   *Критические в метод Get*
17. Чтобы продолжить выполнение, нажмите клавишу **F5**.
18. Вернуться назад в Internet Explorer, если он еще не находится в фокусе. Обратите внимание, окно записи сетевых данных.

    ![В обозревателе Internet Explorer, отображая результаты вызова веб-API сети](build-restful-apis-with-aspnet-web-api/_static/image19.png "сети в обозревателе Internet Explorer, отображая результаты вызова веб-API")

    *Представление сети в Internet Explorer, отображая результаты вызова веб-API*
19. Нажмите кнопку **перейдите к представлению подробные** кнопки.
20. Нажмите кнопку **текст ответа** вкладки. Обратите внимание, выходные данные JSON в вызове API, и как он представляет два контакта, полученный на уровне службы.

    ![Просмотр выходных данных JSON из веб-API в окне средств разработчика](build-restful-apis-with-aspnet-web-api/_static/image20.png "просмотр выходных данных JSON из веб-API в окне средств разработчика")

    *Просмотр выходных данных JSON из веб-API в окне средств разработчика*

<a id="Exercise2"></a>

<a id="Exercise_2_Create_a_ReadWrite_Web_API"></a>
### <a name="exercise-2-create-a-readwrite-web-api"></a>Упражнение 2. Создание чтения и записи веб-API

В этом упражнении вы реализуете POST и PUT методы для диспетчера контактов включить его с помощью функции редактирования данных.

<a id="Ex2Task1"></a>

<a id="Task_1_-_Opening_the_Web_API_Project"></a>
#### <a name="task-1---opening-the-web-api-project"></a>Задача 1 - Открытие проекта веб-API

В этой задаче будет подготовлена для улучшения проект веб-API, созданный в упражнении 1, таким образом, он может принимать ввод данных пользователем.

1. Запустите **Visual Studio 2012 Express для Web**, для этого перейдите к **запустить** и тип **VS Express для Web** нажмите клавишу **ввод**.
2. Откройте **начать** решений, расположенный **источника/Ex02-ReadWriteWebAPI/начало/** папки. В противном случае можно продолжить использование **окончания** решение получен путем выполнения предыдущего упражнения.

   1. Если вы открыли предоставленный **начать** решение, необходимо будет загрузить некоторые отсутствующие пакеты NuGet прежде чем продолжить. Чтобы сделать это, нажмите кнопку **проекта** меню и выберите **управление пакетами NuGet**.
   2. В **управление пакетами NuGet** диалоговое окно, нажмите кнопку **восстановить** чтобы скачивать отсутствующие пакеты.
   3. Наконец, постройте решение, нажав кнопку **построения** | **построить решение**.

      > [!NOTE]
      > Одним из преимуществ использования NuGet является отсутствие поставлять все библиотеки в проекте, уменьшив размер проекта. С помощью NuGet Power Tools путем указания версий пакета в файле Packages.config можно для скачивания всех необходимых библиотек при первом запуске проекта. Вот почему необходимо выполните описанные выше действия, после открытия существующего решения из этой лаборатории.
3. Откройте **Services/ContactRepository.cs** файла.

<a id="Ex2Task2"></a>

<a id="Task_2_-_Adding_Data-Persistence_Features_to_the_Contact_Repository_Implementation"></a>
#### <a name="task-2---adding-data-persistence-features-to-the-contact-repository-implementation"></a>Задача 2 - Добавление функций сохраняемости данных, к реализации репозиторий контактов

В этой задаче будет расширить класс ContactRepository проекта веб-API, созданного в упражнении 1, чтобы его можно сохранить и принимать ввод данных пользователем и новые экземпляры обратитесь в службу.

1. Добавьте следующую константу для **ContactRepository** класс, представляющий имя имя веб-сервера кэш элемент ключа позже в этом упражнении.

    [!code-csharp[Main](build-restful-apis-with-aspnet-web-api/samples/sample9.cs)]
2. Добавьте конструктор для **ContactRepository** содержит следующий код.

    (Code Snippet - *веб-API лаборатории - Ex02 - репозиторий контактов конструктор*)

    [!code-csharp[Main](build-restful-apis-with-aspnet-web-api/samples/sample10.cs)]
3. Изменение кода для **GetAllContacts** метод, как показано ниже.

    (Code Snippet - *лаборатории API веб - Ex02 - получить все контакты*)

    [!code-csharp[Main](build-restful-apis-with-aspnet-web-api/samples/sample11.cs)]

    > [!NOTE]
    > В этом примере осуществляется для демонстрационных целей и будет использовать кэш веб сервера как на носителе, чтобы значения будут доступны для нескольких клиентов одновременно, а не использовать механизм хранения сеанса или времени жизни запроса хранилища. Можно было использовать Entity Framework, XML-хранилища или любые другие различные вместо кэше веб-сервера.
4. Реализуйте новый метод с именем **SaveContact** для **ContactRepository** класс для работа по сохранению контакта. **SaveContact** метод должен принимать один **контакт** и возвращают логическое значение, указывающее успех или неудачу.

    (Code Snippet - *веб-API лаборатории - Ex02 - реализация метода SaveContact*)

    [!code-csharp[Main](build-restful-apis-with-aspnet-web-api/samples/sample12.cs)]

<a id="Exercise3"></a>

<a id="Exercise_3_Consume_the_Web_API_from_an_HTML_Client"></a>
### <a name="exercise-3-consume-the-web-api-from-an-html-client"></a>Упражнение 3. Использовать веб-API из HTML-клиента

В этом упражнении вы создадите HTML-клиента для вызова веб-API. Этот клиент будет упростить обмен данными с веб-API с помощью JavaScript и отображает результаты в браузере с помощью разметки HTML.

<a id="Ex3Task1"></a>

<a id="Task_1_-_Modifying_the_Index_View_to_Provide_a_GUI_for_Displaying_Contacts"></a>
#### <a name="task-1---modifying-the-index-view-to-provide-a-gui-for-displaying-contacts"></a>Задача 1 - Изменение представления индекса для предоставляют графический интерфейс пользователя для отображения контактов

В этой задаче будет изменено представление индекса по умолчанию веб-приложения для поддержки требования отображения списка существующих контактов в HTML-браузером.

1. Откройте **Visual Studio 2012 Express для Web** если он еще не открыт.
2. Откройте **начать** решений, расположенный **источника/Ex03-ConsumingWebAPI/начало/** папки. В противном случае можно продолжить использование **окончания** решение получен путем выполнения предыдущего упражнения.

   1. Если вы открыли предоставленный **начать** решение, необходимо будет загрузить некоторые отсутствующие пакеты NuGet прежде чем продолжить. Чтобы сделать это, нажмите кнопку **проекта** меню и выберите **управление пакетами NuGet**.
   2. В **управление пакетами NuGet** диалоговое окно, нажмите кнопку **восстановить** чтобы скачивать отсутствующие пакеты.
   3. Наконец, постройте решение, нажав кнопку **построения** | **построить решение**.

      > [!NOTE]
      > Одним из преимуществ использования NuGet является отсутствие поставлять все библиотеки в проекте, уменьшив размер проекта. С помощью NuGet Power Tools путем указания версий пакета в файле Packages.config можно для скачивания всех необходимых библиотек при первом запуске проекта. Вот почему необходимо выполните описанные выше действия, после открытия существующего решения из этой лаборатории.
3. Откройте **Index.cshtml** файл, расположенный в **Views/Home** папки.
4. Замените код HTML в элемент div с идентификатором **текст** , чтобы он выглядел как следующий код.

    [!code-html[Main](build-restful-apis-with-aspnet-web-api/samples/sample13.html)]
5. Добавьте следующий код Javascript в нижней части файла для выполнения запроса HTTP для веб-API.

    [!code-cshtml[Main](build-restful-apis-with-aspnet-web-api/samples/sample14.cshtml)]
6. Откройте **ContactController.cs** файла, если он еще не открыт.
7. Поместите точку останова на **получить** метод **ContactController** класса.

    ![Установив точку останова в методе Get контроллера API](build-restful-apis-with-aspnet-web-api/_static/image21.png "установив точку останова в методе Get контроллера API")

    *Установив точку останова в методе Get контроллера API*
8. Нажмите клавишу **F5**, чтобы запустить проект. Обозреватель загрузит HTML-документа.

    > [!NOTE]
    > Убедитесь, что вы подключаетесь к корневой URL-адрес приложения.
9. После загрузки страницы и выполняет код JavaScript, точка останова будет достигнута и выполнение кода будет приостановлено в контроллере.

    ![Отладка в вызовы веб-API, с помощью VS Express для Web](build-restful-apis-with-aspnet-web-api/_static/image22.png "отладки в вызовы веб-API, с помощью VS Express для Web")

    *Отладка в вызов веб-API, с помощью Visual Studio 2012 Express для Web*
10. Удалите точку останова и нажмите клавишу **F5** или панель инструментов отладки **Продолжить** кнопку, чтобы продолжить загрузку представление в браузере. После завершения вызова веб-API должно отобразиться контактов, возвращенных веб-API вызывать отобразить в виде элементов списка в браузере.

    ![Результаты вызова API, отображаются в браузере в виде элементов списка](build-restful-apis-with-aspnet-web-api/_static/image23.png "результаты вызова API, отображаются в браузере в виде элементов списка")

    *Результаты вызова API, отображаются в браузере в виде элементов списка*
11. Остановите отладку.

<a id="Ex3Task2"></a>

<a id="Task_2_-_Modifying_the_Index_View_to_Provide_a_GUI_for_Creating_Contacts"></a>
#### <a name="task-2---modifying-the-index-view-to-provide-a-gui-for-creating-contacts"></a>Задача 2 - изменение представления индекса обеспечивает графический интерфейс пользователя для создания контактов

В этой задаче будет продолжать Изменение представления индекса приложения MVC. Формы будут добавляться на HTML-страницу, которая будет ввод данных и отправлять их в веб-API для создания нового контакта, и будет создан новый метод контроллера веб-API для сбора даты из графического интерфейса пользователя.

1. Откройте **ContactController.cs** файла.
2. Добавьте новый метод в класс контроллера с именем **Post** как показано в следующем коде.

    (Code Snippet - *веб-метода Post лаборатории API - Ex03 -*)

    [!code-csharp[Main](build-restful-apis-with-aspnet-web-api/samples/sample15.cs)]
3. Откройте **Index.cshtml** файла в Visual Studio, если он еще не открыт.
4. Добавьте приведенный ниже код HTML в файл сразу после неупорядоченного списка, добавленного в предыдущей задаче.

    [!code-html[Main](build-restful-apis-with-aspnet-web-api/samples/sample16.html)]
5. В элементе скрипта, в нижней части документа добавьте выделенный ниже код для обработки события нажатия кнопки, которые будет отправлять данные веб-API с помощью вызова HTTP POST.

    [!code-html[Main](build-restful-apis-with-aspnet-web-api/samples/sample17.html)]
6. В **ContactController.cs**, поместите точку останова на **Post** метод.
7. Нажмите клавишу **F5** для запуска приложения в браузере.
8. После загрузки страницы в браузере, введите имя нового контакта и идентификатор и нажмите кнопку **Сохранить** кнопки.

    ![Загружен документ клиента HTML в браузере](build-restful-apis-with-aspnet-web-api/_static/image24.png "загружен документ клиента HTML в браузере")

    *Клиент HTML-документа, загруженной в браузере*
9. Когда в окне отладчика прерывается **Post** метод, просмотр свойств **обратитесь в службу** параметра. Значения должны соответствовать данные, введенные в форме.

    ![Объект контакт, отправляются в веб-API из клиента](build-restful-apis-with-aspnet-web-api/_static/image25.png "объектов Contact, отправляемых веб-API из клиента")

    *Объект контакт, отправляются в веб-API из клиента*
10. Шаг при помощи метода отладчик до **ответа** переменная создана. После проверки в **"Локальные"** окно в отладчике, вы увидите что заданы все свойства.

   ![После создания в отладчике ответ](build-restful-apis-with-aspnet-web-api/_static/image26.png "ответа, после создания в отладчике")

   *Ответ после создания в отладчике*
11. Если нажать клавишу **F5** или нажмите кнопку **Продолжить** в отладчике запрос будет выполнен. После переключения обратно в браузер, новый контакт был добавлен в список контактов, хранящихся в **ContactRepository** реализации.

   ![Браузер отражает успешного создания нового экземпляра контактные](build-restful-apis-with-aspnet-web-api/_static/image27.png "браузер отражает успешного создания нового экземпляра контакта")

   *Браузер отражает успешного создания нового экземпляра контакта*

> [!NOTE]
> Кроме того, можно развернуть это приложение для Azure следующих [приложение в: Публикация приложения ASP.NET MVC 4 с помощью веб-развертывания](#AppendixC).

---

<a id="Summary"></a>
## <a name="summary"></a>Сводка

Это лабораторное занятие был представлен на новую платформу веб-API ASP.NET и реализации Web API-интерфейсов RESTful с помощью платформы. На этой странице можно создать новый репозиторий, который обеспечивает сохраняемость данных, используя любое количество механизмы и привязывания этой службы вместо того, простой, приведено в качестве примера в этой лабораторной работе. Веб-API поддерживает несколько дополнительных функций, таких как включение подключения от клиентов отличающийся от HTML, написанных на любом языке, поддерживающем HTTP и JSON или XML. Возможность размещения веб-API за пределами типичный веб-приложения можно также, а также является возможность создавать собственные форматы сериализации.

Веб-узла ASP.NET имеет выделенный в веб-API ASP.NET Framework в область [ [ https://asp.net/web-api ](https://asp.net/web-api) ](https://asp.net/web-api). Этот сайт будет продолжать последние сведения, примеры и новостей, относящихся к веб-API, поэтому она регулярно проверяйте Если вы хотите более подробно рассмотрим искусством создания пользовательского веб-API, доступных для framework практически с любого устройства или разработки.

<a id="AppendixA"></a>

<a id="Appendix_A_Using_Code_Snippets"></a>
## <a name="appendix-a-using-code-snippets"></a>Приложение а. Фрагменты кода

С помощью фрагментов кода у вас есть весь код, который требуется в вашем распоряжении. Лаборатории документ поможет определить точно при их использовании, как показано на рисунке ниже.

![Фрагменты кода Visual Studio, чтобы вставить код в проект](build-restful-apis-with-aspnet-web-api/_static/image28.png "фрагменты кода с помощью Visual Studio, чтобы вставить код в проект")

*Фрагменты кода Visual Studio, чтобы вставить код в проект*

<a id="CodeSnippetUsingKeyBoard"></a>

<a id="To_add_a_code_snippet_using_the_keyboard_C_only"></a>
### <a name="to-add-a-code-snippet-using-the-keyboard-c-only"></a>Чтобы добавить фрагмент кода, с помощью клавиатуры (только C#)

1. Поместите курсор в место вставки кода.
2. Начните вводить имя фрагмента (без пробелов и дефисов).
3. Посмотрите, как IntelliSense отображает, совпадающие с именами фрагменты.
4. Выберите правильный фрагмент (или продолжите ввод, пока не будет выделен весь фрагмент имени).
5. Нажмите клавишу Tab дважды, чтобы вставить фрагмент в положении курсора.

    ![Начните вводить имя фрагмента](build-restful-apis-with-aspnet-web-api/_static/image29.png "начните вводить имя фрагмента")

    *Начните вводить имя фрагмента*

    ![Нажмите клавишу Tab, чтобы выделить фрагмент в выделенный](build-restful-apis-with-aspnet-web-api/_static/image30.png "нажмите клавишу Tab, чтобы выделить выделенный фрагмент")

    *Нажмите клавишу Tab, чтобы выделить выделенный фрагмент*

    ![Снова нажмите клавишу Tab и фрагмент будет расширяться](build-restful-apis-with-aspnet-web-api/_static/image31.png "еще раз нажмите клавишу Tab и фрагмент будет расширяться")

    *Снова нажмите клавишу Tab и фрагмент будет расширяться*

<a id="CodeSnippetUsingMouse"></a>

<a id="To_add_a_code_snippet_using_the_mouse_C_Visual_Basic_and_XML"></a>
### <a name="to-add-a-code-snippet-using-the-mouse-c-visual-basic-and-xml"></a>Чтобы добавить фрагмент кода, с помощью мыши (C#, Visual Basic и XML)

1. Щелкните правой кнопкой мыши место для вставки фрагмента кода.
2. Выберите **вставить фрагмент** следуют **Мои фрагменты кода**.
3. Выберите соответствующий фрагмент из списка, щелкнув его.

    ![Щелкните правой кнопкой мыши, где необходимо вставить фрагмент кода и выберите Вставить фрагмент](build-restful-apis-with-aspnet-web-api/_static/image32.png "щелкните правой кнопкой мыши, где необходимо вставить фрагмент кода и выберите Вставить фрагмент")

    *Щелкните правой кнопкой мыши место для вставки фрагмента кода и выберите Вставить фрагмент*

    ![Выберите соответствующий фрагмент из списка, щелкнув по ней](build-restful-apis-with-aspnet-web-api/_static/image33.png "выбрать соответствующий фрагмент из списка, щелкнув по ней")

    *Выберите соответствующий фрагмент из списка, щелкнув по ней*

<a id="AppendixB"></a>

<a id="Appendix_B_Installing_Visual_Studio_Express_2012_for_Web"></a>
## <a name="appendix-b-installing-visual-studio-express-2012-for-web"></a>Приложение б. Установка Visual Studio Express 2012 для Web

Вы можете установить **Microsoft Visual Studio Express 2012 для Web** или другой &quot;Express&quot; версию с помощью **[Microsoft Web Platform Installer](https://www.microsoft.com/web/downloads/platform.aspx)**. Приведенные ниже инструкции описывают действия, необходимые для установки *Visual studio Express 2012 для Web* с помощью *Microsoft Web Platform Installer*.

1. Перейдите к [ [ https://go.microsoft.com/?linkid=9810169 ](https://go.microsoft.com/?linkid=9810169) ](https://go.microsoft.com/?linkid=9810169). Кроме того, если вы уже установили установщика веб-платформы, можно открыть его и выполните поиск продукта &quot; <em>Visual Studio Express 2012 для Web с пакетом Azure SDK</em>&quot;.
2. Щелкните **установить сейчас**. Если у вас нет **установщика веб-платформы** вы будете перенаправлены к сначала загрузить и установить его.
3. Один раз **установщика веб-платформы** открыт, нажмите кнопку **установить** для запуска программы установки.

    ![Установка Visual Studio Express](build-restful-apis-with-aspnet-web-api/_static/image34.png "установка Visual Studio Express")

    *Установка Visual Studio Express*
4. Прочтите лицензии и условия все продукты и нажмите кнопку **я принимаю** для продолжения.

    ![Принятие условий лицензии](build-restful-apis-with-aspnet-web-api/_static/image35.png)

    *Принятие условий лицензии*
5. Подождите, пока не завершится процесс загрузки и установки.

    ![Ход установки](build-restful-apis-with-aspnet-web-api/_static/image36.png)

    *Ход выполнения установки*
6. После завершения установки нажмите кнопку **Готово**.

    ![Установка завершена](build-restful-apis-with-aspnet-web-api/_static/image37.png)

    *Установка завершена*
7. Нажмите кнопку **выхода** закрыть установщик веб-платформы.
8. Чтобы открыть Visual Studio Express для Web, перейдите к **запустить** экрана и Займитесь написанием &quot; **VS Express**&quot;, нажмите кнопку на **VS Express для Web** Плитка.

    ![VS Express для Web плитки](build-restful-apis-with-aspnet-web-api/_static/image38.png)

    *VS Express для Web плитки*

<a id="AppendixC"></a>

<a id="Appendix_C_Publishing_an_ASPNET_MVC_4_Application_using_Web_Deploy"></a>
## <a name="appendix-c-publishing-an-aspnet-mvc-4-application-using-web-deploy"></a>Приложение c. Публикация приложения ASP.NET MVC 4 с помощью веб-развертывания

В этом приложении показано, как создать новый веб-сайт на портале Azure и опубликовать приложение, полученный после лаборатории, используя преимущества компонентов публикации веб-развертывания, предоставляемые Azure.

<a id="ApxCTask1"></a>

<a id="Task_1_-_Creating_a_New_Web_Site_from_the_Windows_Azure_Portal"></a>
#### <a name="task-1---creating-a-new-web-site-from-the-azure-portal"></a>Задача 1 - Создание нового веб-сайта с помощью портала Azure

1. Перейдите к [портала управления Azure](https://manage.windowsazure.com/) и войдите с использованием учетных данных Майкрософт, связанную с вашей подпиской.

    > [!NOTE]
    > С помощью Azure можно бесплатное размещение 10 веб-сайтов ASP.NET и затем масштабировать по мере увеличения объема трафика. Вы можете зарегистрироваться [здесь](https://aka.ms/aspnet-hol-azure).

    ![Войдите на портал Windows Azure](build-restful-apis-with-aspnet-web-api/_static/image39.png "Войдите на портал Windows Azure")

    *Войдите на портал*
2. Нажмите кнопку **New** на панели команд.

    ![Создание нового веб-сайта](build-restful-apis-with-aspnet-web-api/_static/image40.png "создания нового веб-сайта")

    *Создание нового веб-сайта*
3. Нажмите кнопку **вычислений** | **веб-сайт**. Затем выберите **быстрое создание** параметр. Укажите URL-адрес доступен для нового веб-сайта и нажмите кнопку **создать веб-сайт**.

    > [!NOTE]
    > Azure является узлом для веб-приложение, работающее в облаке, вы можете управлять. Быстрое создание позволяет развернуть завершенное веб-приложения в Azure из вне портала. Он не включает действия по настройке базы данных.

    ![Создание нового веб-сайта, с помощью быстрого создания](build-restful-apis-with-aspnet-web-api/_static/image41.png "создания нового веб-сайта, с помощью быстрого создания")

    *Создание нового веб-сайта, с помощью быстрого создания*
4. Подождите, пока новый **веб-сайт** создается.
5. После создания веб-сайт, щелкните ссылку под **URL-адрес** столбца. Проверьте, что новый веб-сайт работает.

    ![Выбрав новый веб-сайт](build-restful-apis-with-aspnet-web-api/_static/image42.png "просмотра на новый веб-сайт")

    *Выбрав новый веб-сайт*

    ![Веб-сайт работал](build-restful-apis-with-aspnet-web-api/_static/image43.png "веб-узлом")

    *Веб-сайт под управлением*
6. Вернитесь на портал и щелкните имя веб-сайт в **имя** столбец для отображения страницы управления.

    ![Открытие страницы управления веб-сайт](build-restful-apis-with-aspnet-web-api/_static/image44.png "Открытие страницы управления веб-сайта")

    *Открытие страницы управления веб-сайта*
7. В **панели мониторинга** раздела **быстрый обзор** щелкните **загрузить профиль публикации** ссылку.

    > [!NOTE]
    > *Профиль публикации* содержит все сведения, необходимые для публикации веб-приложения в Azure для каждого разрешенного метода публикации. Профиль публикации содержит URL-адреса, учетные данные пользователя и строк базы данных, необходимых для подключения и проверку подлинности в каждой из конечных точек, для которых включена метода публикации. **Microsoft WebMatrix 2**, **Microsoft Visual Studio Express для Web** и **Microsoft Visual Studio 2012** поддерживают чтение профилей публикации для автоматизации настройки из этих программ для Публикация веб-приложений в Azure.

    ![Профиль публикации веб-сайт загрузки](build-restful-apis-with-aspnet-web-api/_static/image45.png "профиль публикации веб-сайта загрузки")

    *Профиль публикации веб-сайта загрузки*
8. Скачайте файл профиля публикации в известном месте. Далее в этом упражнении показано, как использовать этот файл для публикации веб-приложения в Azure из Visual Studio.

    ![Сохранение файла профиля публикации](build-restful-apis-with-aspnet-web-api/_static/image46.png "Сохранение профиля публикации")

    *Сохранение файла профиля публикации*

<a id="ApxCTask2"></a>

<a id="Task_2_-_Configuring_the_Database_Server"></a>
#### <a name="task-2---configuring-the-database-server"></a>Задача 2 - Настройка сервера базы данных

Если приложение использует SQL Server, баз данных, необходимо будет создать сервер базы данных SQL. Эту задачу может пропустить, если вы хотите развернуть простое приложение, которое не использует SQL Server.

1. Вам потребуется сервер базы данных SQL для хранения базы данных приложения. Серверы баз данных SQL можно просмотреть в своей подписке на портале управления Azure на **баз данных Sql** | **серверы** | **мониторинга сервера**. Если у вас на сервер, созданный, можно создать его, используя **добавить** кнопки на панели команд. Запишите **имя сервера и URL-адрес, имя входа администратора и пароль**, как их использование в следующие задачи. Не создавайте базы данных, так как он будет создан в более позднем этапе.

    ![Панель мониторинга базы данных SQL Server](build-restful-apis-with-aspnet-web-api/_static/image47.png "панель мониторинга базы данных SQL Server")

    *Панель мониторинга базы данных SQL Server*
2. В следующей задаче вы проверите подключения к базе данных из Visual Studio по этой причине необходимо включить IP-адрес локального сервера списка **разрешенные IP-адреса**. Чтобы сделать это, нажмите кнопку **Настройка**, выберите IP-адрес из **текущий IP-адрес клиента** и вставьте его на **начальный IP-адрес** и **конечный IP-адрес** текстовые поля и нажмите кнопку ![add-client-ip-address-ok-button](build-restful-apis-with-aspnet-web-api/_static/image48.png) кнопки.

    ![Добавление IP-адрес клиента](build-restful-apis-with-aspnet-web-api/_static/image49.png)

    *Добавление IP-адрес клиента*
3. Один раз **IP-адрес клиента** добавляется разрешенных IP-адресов выберите на **Сохранить** для подтверждения изменения.

    ![Подтверждение изменений](build-restful-apis-with-aspnet-web-api/_static/image50.png)

    *Подтверждение изменений*

<a id="ApxCTask3"></a>

<a id="Task_3_-_Publishing_an_ASPNET_MVC_4_Application_using_Web_Deploy"></a>
#### <a name="task-3---publishing-an-aspnet-mvc-4-application-using-web-deploy"></a>Задача 3 - публикация приложения ASP.NET MVC 4 с помощью веб-развертывания

1. Вернитесь к решению для ASP.NET MVC 4. В **обозревателе решений**, щелкните правой кнопкой мыши проект веб-сайта и выберите **публикации**.

    ![Публикация приложения](build-restful-apis-with-aspnet-web-api/_static/image51.png "публикации приложения")

    *Публикация веб-сайта*
2. Импортируйте профиль публикации, сохраненный в первой задаче.

    ![Импорт профиля публикации](build-restful-apis-with-aspnet-web-api/_static/image52.png "Импорт профиля публикации")

    *Импорт профиля публикации*
3. Нажмите кнопку **Проверка подключения**. После завершения проверки нажмите кнопку **Далее**.

    > [!NOTE]
    > Проверка будет завершена, как только вы увидите зеленый флажок отображаться рядом с кнопкой проверить подключение.

    ![Проверка подключения](build-restful-apis-with-aspnet-web-api/_static/image53.png "Проверка подключения")

    *Проверка подключения*
4. В **параметры** раздела **баз данных** нажмите кнопку рядом с текстовое поле подключения к базе данных (т. е. **DefaultConnection**).

    ![Конфигурация веб-развертывания](build-restful-apis-with-aspnet-web-api/_static/image54.png "конфигурация веб-развертывания")

    *Конфигурация веб-развертывания*
5. Настройте подключение к базе данных следующим образом:

   - В **имя_сервера** введите URL-адреса серверу базы данных SQL с помощью *tcp:* префикс.
   - В **имя пользователя** введите имя входа администратора сервера.
   - В **пароль** введите пароль входа администратора сервера.
   - Введите новое имя базы данных, например: *MVC4SampleDB*.

     ![Настройка строки подключения назначения](build-restful-apis-with-aspnet-web-api/_static/image55.png "Настройка строка соединения с назначением")

     *Настройка строки подключения назначения*
6. Затем нажмите кнопку **ОК**. При появлении запроса на создание базы данных нажмите кнопку **Да**.

    ![Создание базы данных](build-restful-apis-with-aspnet-web-api/_static/image56.png "Создание строки базы данных")

    *Создание базы данных*
7. В текстовое поле подключение по умолчанию отображается строка подключения, который будет использоваться для подключения к базе данных SQL в Windows Azure. Затем нажмите кнопку **Далее**.

    ![Строка подключения, указывающий на базу данных SQL](build-restful-apis-with-aspnet-web-api/_static/image57.png "строку подключения, указывающий на базу данных SQL")

    *Строка подключения, указывающий на базу данных SQL*
8. В **предварительной версии** щелкните **публикации**.

    ![Публикация веб-приложения](build-restful-apis-with-aspnet-web-api/_static/image58.png "публикации веб-приложения")

    *Публикация веб-приложения*
9. После завершения процесса публикации в браузере по умолчанию откроется опубликованного веб-сайта.

    ![Приложение опубликовано в Windows Azure](build-restful-apis-with-aspnet-web-api/_static/image59.png "публикации приложения в Windows Azure")

    *Приложение будет публиковаться в Azure*
