---
uid: web-api/overview/security/authentication-and-authorization-in-aspnet-web-api
title: Аутентификация и авторизация в ASP.NET Web API Документы Майкрософт
author: MikeWasson
description: Дает общий обзор проверки подлинности и авторизации в ASP.NET Web API.
ms.author: riande
ms.date: 11/27/2012
ms.assetid: 6dfb51ea-9f4d-4e70-916c-8ef8344a88d6
msc.legacyurl: /web-api/overview/security/authentication-and-authorization-in-aspnet-web-api
msc.type: authoredcontent
ms.openlocfilehash: 368d2b9456d12b2bb4063a23333e5c8837faa3b8
ms.sourcegitcommit: ce28244209db8615bc9bdd576a2e2c88174d318d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/06/2020
ms.locfileid: "80675865"
---
# <a name="authentication-and-authorization-in-aspnet-web-api"></a><span data-ttu-id="16fc4-103">Проверка подлинности и авторизация веб-API ASP.NET</span><span class="sxs-lookup"><span data-stu-id="16fc4-103">Authentication and Authorization in ASP.NET Web API</span></span>

<span data-ttu-id="16fc4-104">[Майк Уоссон](https://github.com/MikeWasson)</span><span class="sxs-lookup"><span data-stu-id="16fc4-104">by [Mike Wasson](https://github.com/MikeWasson)</span></span>

<span data-ttu-id="16fc4-105">Вы создали веб-API, но теперь вы хотите контролировать доступ к нему.</span><span class="sxs-lookup"><span data-stu-id="16fc4-105">You've created a web API, but now you want to control access to it.</span></span> <span data-ttu-id="16fc4-106">В этой серии статей мы рассмотрим некоторые варианты защиты веб-API от неавторизованных пользователей.</span><span class="sxs-lookup"><span data-stu-id="16fc4-106">In this series of articles, we'll look at some options for securing a web API from unauthorized users.</span></span> <span data-ttu-id="16fc4-107">Эта серия будет охватывать как аутентификацию, так и авторизацию.</span><span class="sxs-lookup"><span data-stu-id="16fc4-107">This series will cover both authentication and authorization.</span></span>

- <span data-ttu-id="16fc4-108">*Аутентификация* — это знание личности пользователя.</span><span class="sxs-lookup"><span data-stu-id="16fc4-108">*Authentication* is knowing the identity of the user.</span></span> <span data-ttu-id="16fc4-109">Например, Алиса входит в систему с именем пользователя и паролем, и сервер использует пароль для проверки подлинности Алисы.</span><span class="sxs-lookup"><span data-stu-id="16fc4-109">For example, Alice logs in with her username and password, and the server uses the password to authenticate Alice.</span></span>
- <span data-ttu-id="16fc4-110">*Авторизация* решает, разрешено ли пользователю выполнять действие.</span><span class="sxs-lookup"><span data-stu-id="16fc4-110">*Authorization* is deciding whether a user is allowed to perform an action.</span></span> <span data-ttu-id="16fc4-111">Например, у Алисы есть разрешение на получение ресурса, но не на создание ресурса.</span><span class="sxs-lookup"><span data-stu-id="16fc4-111">For example, Alice has permission to get a resource but not create a resource.</span></span>

<span data-ttu-id="16fc4-112">Первая статья серии дает общий обзор проверки подлинности и авторизации в ASP.NET Web API.</span><span class="sxs-lookup"><span data-stu-id="16fc4-112">The first article in the series gives a general overview of authentication and authorization in ASP.NET Web API.</span></span> <span data-ttu-id="16fc4-113">Другие темы описывают общие сценарии аутентификации для Web API.</span><span class="sxs-lookup"><span data-stu-id="16fc4-113">Other topics describe common authentication scenarios for Web API.</span></span>

> [!NOTE]
> <span data-ttu-id="16fc4-114">Спасибо людям, которые рассмотрели эту серию и предоставили ценную обратную связь: Рик Андерсон, Леви Бродерик, Барри Дорранс, Том Дайкстра, Hongmei Ge, Дэвид Мэтсон, Даниэль Рот, Тим Teebken.</span><span class="sxs-lookup"><span data-stu-id="16fc4-114">Thanks to the people who reviewed this series and provided valuable feedback: Rick Anderson, Levi Broderick, Barry Dorrans, Tom Dykstra, Hongmei Ge, David Matson, Daniel Roth, Tim Teebken.</span></span>

## <a name="authentication"></a><span data-ttu-id="16fc4-115">Аутентификация</span><span class="sxs-lookup"><span data-stu-id="16fc4-115">Authentication</span></span>

<span data-ttu-id="16fc4-116">Web API предполагает, что аутентификация происходит в хосте.</span><span class="sxs-lookup"><span data-stu-id="16fc4-116">Web API assumes that authentication happens in the host.</span></span> <span data-ttu-id="16fc4-117">Для веб-хостинга хостом является IIS, который использует модули HTTP для проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="16fc4-117">For web-hosting, the host is IIS, which uses HTTP modules for authentication.</span></span> <span data-ttu-id="16fc4-118">Вы можете настроить проект, чтобы использовать любой из модулей аутентификации, встроенных в IIS или ASP.NET, или написать свой собственный модуль HTTP для выполнения пользовательской аутентификации.</span><span class="sxs-lookup"><span data-stu-id="16fc4-118">You can configure your project to use any of the authentication modules built in to IIS or ASP.NET, or write your own HTTP module to perform custom authentication.</span></span>

<span data-ttu-id="16fc4-119">Когда узла проверяет подлинность пользователя, он создает *основной*объект, который представляет собой объект [IPrincipal,](https://msdn.microsoft.com/library/System.Security.Principal.IPrincipal.aspx) представляющий контекст безопасности, под которым работает код.</span><span class="sxs-lookup"><span data-stu-id="16fc4-119">When the host authenticates the user, it creates a *principal*, which is an [IPrincipal](https://msdn.microsoft.com/library/System.Security.Principal.IPrincipal.aspx) object that represents the security context under which code is running.</span></span> <span data-ttu-id="16fc4-120">Хост прикрепляет основной к текущему потоку, установив **Thread.CurrentPrincipal**.</span><span class="sxs-lookup"><span data-stu-id="16fc4-120">The host attaches the principal to the current thread by setting **Thread.CurrentPrincipal**.</span></span> <span data-ttu-id="16fc4-121">Основной элемент содержит связанный объект **Identity,** содержащий информацию о пользователе.</span><span class="sxs-lookup"><span data-stu-id="16fc4-121">The principal contains an associated **Identity** object that contains information about the user.</span></span> <span data-ttu-id="16fc4-122">Если пользователь проверен, **Identity.IsAuthenticated собственности** **возвращается верно**.</span><span class="sxs-lookup"><span data-stu-id="16fc4-122">If the user is authenticated, the **Identity.IsAuthenticated** property returns **true**.</span></span> <span data-ttu-id="16fc4-123">Для анонимных запросов, **IsAuthenticated** возвращает **ложные**.</span><span class="sxs-lookup"><span data-stu-id="16fc4-123">For anonymous requests, **IsAuthenticated** returns **false**.</span></span> <span data-ttu-id="16fc4-124">Для получения дополнительной информации [Role-Based Security](https://msdn.microsoft.com/library/shz8h065.aspx)о принципах см.</span><span class="sxs-lookup"><span data-stu-id="16fc4-124">For more information about principals, see [Role-Based Security](https://msdn.microsoft.com/library/shz8h065.aspx).</span></span>

### <a name="http-message-handlers-for-authentication"></a><span data-ttu-id="16fc4-125">ОБработчики сообщений HTTP для аутентификации</span><span class="sxs-lookup"><span data-stu-id="16fc4-125">HTTP Message Handlers for Authentication</span></span>

<span data-ttu-id="16fc4-126">Вместо использования хоста для проверки подлинности можно поместить логику проверки подлинности в [обработчик сообщений HTTP.](../advanced/http-message-handlers.md)</span><span class="sxs-lookup"><span data-stu-id="16fc4-126">Instead of using the host for authentication, you can put authentication logic into an [HTTP message handler](../advanced/http-message-handlers.md).</span></span> <span data-ttu-id="16fc4-127">В этом случае обработчик сообщений изучает запрос HTTP и устанавливает принцип.</span><span class="sxs-lookup"><span data-stu-id="16fc4-127">In that case, the message handler examines the HTTP request and sets the principal.</span></span>

<span data-ttu-id="16fc4-128">Когда следует использовать обработчики сообщений для проверки подлинности?</span><span class="sxs-lookup"><span data-stu-id="16fc4-128">When should you use message handlers for authentication?</span></span> <span data-ttu-id="16fc4-129">Вот некоторые компромиссы:</span><span class="sxs-lookup"><span data-stu-id="16fc4-129">Here are some tradeoffs:</span></span>

- <span data-ttu-id="16fc4-130">Модуль HTTP просматривает все запросы, которые проходят через конвейер ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="16fc4-130">An HTTP module sees all requests that go through the ASP.NET pipeline.</span></span> <span data-ttu-id="16fc4-131">Обработчик сообщений видит только запросы, которые направляются в Web API.</span><span class="sxs-lookup"><span data-stu-id="16fc4-131">A message handler only sees requests that are routed to Web API.</span></span>
- <span data-ttu-id="16fc4-132">Можно настроить обработчики сообщений на маршрут, что позволяет применить схему проверки подлинности к определенному маршруту.</span><span class="sxs-lookup"><span data-stu-id="16fc4-132">You can set per-route message handlers, which lets you apply an authentication scheme to a specific route.</span></span>
- <span data-ttu-id="16fc4-133">Модули HTTP специфичны для IIS.</span><span class="sxs-lookup"><span data-stu-id="16fc4-133">HTTP modules are specific to IIS.</span></span> <span data-ttu-id="16fc4-134">Обработчики сообщений являются хост-агностиками, поэтому их можно использовать как с веб-хостингом, так и с автохостингом.</span><span class="sxs-lookup"><span data-stu-id="16fc4-134">Message handlers are host-agnostic, so they can be used with both web-hosting and self-hosting.</span></span>
- <span data-ttu-id="16fc4-135">Модули HTTP участвуют в регистрации, аудите ИИС и так далее.</span><span class="sxs-lookup"><span data-stu-id="16fc4-135">HTTP modules participate in IIS logging, auditing, and so on.</span></span>
- <span data-ttu-id="16fc4-136">Модули HTTP работают ранее в конвейере.</span><span class="sxs-lookup"><span data-stu-id="16fc4-136">HTTP modules run earlier in the pipeline.</span></span> <span data-ttu-id="16fc4-137">Если вы обрабатываете проверку подлинности в обработчике сообщений, принцип не устанавливается до тех пор, пока обработчик не заработает.</span><span class="sxs-lookup"><span data-stu-id="16fc4-137">If you handle authentication in a message handler, the principal does not get set until the handler runs.</span></span> <span data-ttu-id="16fc4-138">Кроме того, основной возвращается к предыдущему принципу, когда ответ покидает обработчик сообщений.</span><span class="sxs-lookup"><span data-stu-id="16fc4-138">Moreover, the principal reverts back to the previous principal when the response leaves the message handler.</span></span>

<span data-ttu-id="16fc4-139">Как правило, если вам не нужно поддерживать самостоятельное размещение, модуль HTTP является лучшим вариантом.</span><span class="sxs-lookup"><span data-stu-id="16fc4-139">Generally, if you don't need to support self-hosting, an HTTP module is a better option.</span></span> <span data-ttu-id="16fc4-140">Если вам необходимо поддерживать самостоятельное размещение, подумайте об обработчике сообщений.</span><span class="sxs-lookup"><span data-stu-id="16fc4-140">If you need to support self-hosting, consider a message handler.</span></span>

### <a name="setting-the-principal"></a><span data-ttu-id="16fc4-141">Установка директора</span><span class="sxs-lookup"><span data-stu-id="16fc4-141">Setting the Principal</span></span>

<span data-ttu-id="16fc4-142">Если приложение выполняет любую пользовательскую логику проверки подлинности, необходимо установить принцип в двух местах:</span><span class="sxs-lookup"><span data-stu-id="16fc4-142">If your application performs any custom authentication logic, you must set the principal on two places:</span></span>

- <span data-ttu-id="16fc4-143">**Thread.CurrentPrincipal**.</span><span class="sxs-lookup"><span data-stu-id="16fc4-143">**Thread.CurrentPrincipal**.</span></span> <span data-ttu-id="16fc4-144">Это свойство является стандартным способом установить принцип потока в .NET.</span><span class="sxs-lookup"><span data-stu-id="16fc4-144">This property is the standard way to set the thread's principal in .NET.</span></span>
- <span data-ttu-id="16fc4-145">**HttpContext.Current.User**.</span><span class="sxs-lookup"><span data-stu-id="16fc4-145">**HttpContext.Current.User**.</span></span> <span data-ttu-id="16fc4-146">Это свойство характерно для ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="16fc4-146">This property is specific to ASP.NET.</span></span>

<span data-ttu-id="16fc4-147">Следующий код показывает, как установить принцип:</span><span class="sxs-lookup"><span data-stu-id="16fc4-147">The following code shows how to set the principal:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample1.cs)]

<span data-ttu-id="16fc4-148">Для веб-хостинга, вы должны установить основной в обоих местах; в противном случае контекст безопасности может стать непоследовательным.</span><span class="sxs-lookup"><span data-stu-id="16fc4-148">For web-hosting, you must set the principal in both places; otherwise the security context may become inconsistent.</span></span> <span data-ttu-id="16fc4-149">Для самостоятельного хостинга, однако, **HttpContext.Current** является недействительным.</span><span class="sxs-lookup"><span data-stu-id="16fc4-149">For self-hosting, however, **HttpContext.Current** is null.</span></span> <span data-ttu-id="16fc4-150">Чтобы убедиться, что ваш код является хост-агностиком, поэтому проверьте наличие нуля перед назначением **httpContext.Current**, как показано на рисунке.</span><span class="sxs-lookup"><span data-stu-id="16fc4-150">To ensure your code is host-agnostic, therefore, check for null before assigning to **HttpContext.Current**, as shown.</span></span>

## <a name="authorization"></a><span data-ttu-id="16fc4-151">Авторизация</span><span class="sxs-lookup"><span data-stu-id="16fc4-151">Authorization</span></span>

<span data-ttu-id="16fc4-152">Авторизация происходит позже в конвейере, ближе к контроллеру.</span><span class="sxs-lookup"><span data-stu-id="16fc4-152">Authorization happens later in the pipeline, closer to the controller.</span></span> <span data-ttu-id="16fc4-153">Это позволяет делать более детальный выбор, когда вы предоставляете доступ к ресурсам.</span><span class="sxs-lookup"><span data-stu-id="16fc4-153">That lets you make more granular choices when you grant access to resources.</span></span>

- <span data-ttu-id="16fc4-154">*Фильтры авторизации* запускаться до действия контроллера.</span><span class="sxs-lookup"><span data-stu-id="16fc4-154">*Authorization filters* run before the controller action.</span></span> <span data-ttu-id="16fc4-155">Если запрос не авторизован, фильтр возвращает ответ на ошибку, и действие не вызывается.</span><span class="sxs-lookup"><span data-stu-id="16fc4-155">If the request is not authorized, the filter returns an error response, and the action is not invoked.</span></span>
- <span data-ttu-id="16fc4-156">В рамках действия контроллера вы можете получить текущий принцип из свойства **ApiController.User.**</span><span class="sxs-lookup"><span data-stu-id="16fc4-156">Within a controller action, you can get the current principal from the **ApiController.User** property.</span></span> <span data-ttu-id="16fc4-157">Например, можно отфильтровать список ресурсов на основе имени пользователя, вернув только те ресурсы, которые принадлежат этому пользователю.</span><span class="sxs-lookup"><span data-stu-id="16fc4-157">For example, you might filter a list of resources based on the user name, returning only those resources that belong to that user.</span></span>

![](authentication-and-authorization-in-aspnet-web-api/_static/image1.png)

<a id="auth3"></a>
### <a name="using-the-authorize-attribute"></a><span data-ttu-id="16fc4-158">Использование атрибута «Авторизуализацию»</span><span class="sxs-lookup"><span data-stu-id="16fc4-158">Using the [Authorize] Attribute</span></span>

<span data-ttu-id="16fc4-159">Web API предоставляет встроенный фильтр авторизации, [AuthorizeAttribute](https://msdn.microsoft.com/library/system.web.http.authorizeattribute.aspx).</span><span class="sxs-lookup"><span data-stu-id="16fc4-159">Web API provides a built-in authorization filter, [AuthorizeAttribute](https://msdn.microsoft.com/library/system.web.http.authorizeattribute.aspx).</span></span> <span data-ttu-id="16fc4-160">Этот фильтр проверяет, проверяется ли подлинность пользователя.</span><span class="sxs-lookup"><span data-stu-id="16fc4-160">This filter checks whether the user is authenticated.</span></span> <span data-ttu-id="16fc4-161">В противном случае он возвращает код статуса HTTP 401 (несанкционированный), не ссылаясь на действие.</span><span class="sxs-lookup"><span data-stu-id="16fc4-161">If not, it returns HTTP status code 401 (Unauthorized), without invoking the action.</span></span>

<span data-ttu-id="16fc4-162">Вы можете применять фильтр глобально, на уровне контроллера или на уровне отдельных действий.</span><span class="sxs-lookup"><span data-stu-id="16fc4-162">You can apply the filter globally, at the controller level, or at the level of individual actions.</span></span>

<span data-ttu-id="16fc4-163">**Глобально:** Чтобы ограничить доступ для каждого контроллера Web API, добавьте фильтр **AuthorizeAttribute** в глобальный список фильтров:</span><span class="sxs-lookup"><span data-stu-id="16fc4-163">**Globally**: To restrict access for every Web API controller, add the **AuthorizeAttribute** filter to the global filter list:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample2.cs)]

<span data-ttu-id="16fc4-164">**Контроллер**: Чтобы ограничить доступ для определенного контроллера, добавьте фильтр в качестве атрибута для контроллера:</span><span class="sxs-lookup"><span data-stu-id="16fc4-164">**Controller**: To restrict access for a specific controller, add the filter as an attribute to the controller:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample3.cs)]

<span data-ttu-id="16fc4-165">**Действие**: Чтобы ограничить доступ для определенных действий, добавьте атрибут в метод действия:</span><span class="sxs-lookup"><span data-stu-id="16fc4-165">**Action**: To restrict access for specific actions, add the attribute to the action method:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample4.cs)]

<span data-ttu-id="16fc4-166">Кроме того, можно ограничить контроллер, а затем разрешить анонимный `[AllowAnonymous]` доступ к определенным действиям, используя атрибут.</span><span class="sxs-lookup"><span data-stu-id="16fc4-166">Alternatively, you can restrict the controller and then allow anonymous access to specific actions, by using the `[AllowAnonymous]` attribute.</span></span> <span data-ttu-id="16fc4-167">В следующем примере `Post` метод ограничен, `Get` но метод позволяет анонимный доступ.</span><span class="sxs-lookup"><span data-stu-id="16fc4-167">In the following example, the `Post` method is restricted, but the `Get` method allows anonymous access.</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample5.cs)]

<span data-ttu-id="16fc4-168">В предыдущих примерах фильтр позволяет любому подлинному пользователю получить доступ к ограниченным методам; только анонимные пользователи не достатомы. Вы также можете ограничить доступ к определенным пользователям или пользователям в определенных ролях:</span><span class="sxs-lookup"><span data-stu-id="16fc4-168">In the previous examples, the filter allows any authenticated user to access the restricted methods; only anonymous users are kept out. You can also limit access to specific users or to users in specific roles:</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample6.cs)]

> [!NOTE]
> <span data-ttu-id="16fc4-169">Фильтр **AuthorizeAttribute** для контроллеров Web API находится в пространстве имен **System.Web.Http.**</span><span class="sxs-lookup"><span data-stu-id="16fc4-169">The **AuthorizeAttribute** filter for Web API controllers is located in the **System.Web.Http** namespace.</span></span> <span data-ttu-id="16fc4-170">Аналогичный фильтр для контроллеров MVC существует в пространстве имен **System.Web.Mvc,** который не совместим с контроллерами Web API.</span><span class="sxs-lookup"><span data-stu-id="16fc4-170">There is a similar filter for MVC controllers in the **System.Web.Mvc** namespace, which is not compatible with Web API controllers.</span></span>

### <a name="custom-authorization-filters"></a><span data-ttu-id="16fc4-171">Пользовательские фильтры авторизации</span><span class="sxs-lookup"><span data-stu-id="16fc4-171">Custom Authorization Filters</span></span>

<span data-ttu-id="16fc4-172">Чтобы написать пользовательский фильтр авторизации, вытекают из одного из этих типов:</span><span class="sxs-lookup"><span data-stu-id="16fc4-172">To write a custom authorization filter, derive from one of these types:</span></span>

- <span data-ttu-id="16fc4-173">**АвторизутАтрибут**.</span><span class="sxs-lookup"><span data-stu-id="16fc4-173">**AuthorizeAttribute**.</span></span> <span data-ttu-id="16fc4-174">Расширьте этот класс для выполнения логики авторизации на основе текущего пользователя и ролей пользователя.</span><span class="sxs-lookup"><span data-stu-id="16fc4-174">Extend this class to perform authorization logic based on the current user and the user's roles.</span></span>
- <span data-ttu-id="16fc4-175">**АвторизацияФильтрАтрибут**.</span><span class="sxs-lookup"><span data-stu-id="16fc4-175">**AuthorizationFilterAttribute**.</span></span> <span data-ttu-id="16fc4-176">Расширьте этот класс для выполнения синхронной логики авторизации, которая не обязательно основана на текущем пользователе или роли.</span><span class="sxs-lookup"><span data-stu-id="16fc4-176">Extend this class to perform synchronous authorization logic that is not necessarily based on the current user or role.</span></span>
- <span data-ttu-id="16fc4-177">**IАвторизацияФильтр**.</span><span class="sxs-lookup"><span data-stu-id="16fc4-177">**IAuthorizationFilter**.</span></span> <span data-ttu-id="16fc4-178">Реализация этого интерфейса для выполнения асинхронной логики авторизации; например, если логика авторизации делает асинхронные ввод/во-х или сетевые вызовы.</span><span class="sxs-lookup"><span data-stu-id="16fc4-178">Implement this interface to perform asynchronous authorization logic; for example, if your authorization logic makes asynchronous I/O or network calls.</span></span> <span data-ttu-id="16fc4-179">(Если логика авторизации связана с процессором, проще получить из **AuthorizationFilterAttribute,** потому что тогда вам не нужно писать асинхронный метод.)</span><span class="sxs-lookup"><span data-stu-id="16fc4-179">(If your authorization logic is CPU-bound, it is simpler to derive from **AuthorizationFilterAttribute**, because then you don't need to write an asynchronous method.)</span></span>

<span data-ttu-id="16fc4-180">Следующая диаграмма показывает иерархию классов для класса **AuthorizeAttribute.**</span><span class="sxs-lookup"><span data-stu-id="16fc4-180">The following diagram shows the class hierarchy for the **AuthorizeAttribute** class.</span></span>

![](authentication-and-authorization-in-aspnet-web-api/_static/image2.png)

### <a name="authorization-inside-a-controller-action"></a><span data-ttu-id="16fc4-181">Авторизация внутри действия контроллера</span><span class="sxs-lookup"><span data-stu-id="16fc4-181">Authorization Inside a Controller Action</span></span>

<span data-ttu-id="16fc4-182">В некоторых случаях можно разрешить продолжение запроса, но изменить поведение на основе основного принципала.</span><span class="sxs-lookup"><span data-stu-id="16fc4-182">In some cases, you might allow a request to proceed, but change the behavior based on the principal.</span></span> <span data-ttu-id="16fc4-183">Например, возвращается информация может изменяться в зависимости от роли пользователя.</span><span class="sxs-lookup"><span data-stu-id="16fc4-183">For example, the information that you return might change depending on the user's role.</span></span> <span data-ttu-id="16fc4-184">В рамках метода контроллера можно получить текущий принцип из свойства **ApiController.User.**</span><span class="sxs-lookup"><span data-stu-id="16fc4-184">Within a controller method, you can get the current principal from the **ApiController.User** property.</span></span>

[!code-csharp[Main](authentication-and-authorization-in-aspnet-web-api/samples/sample7.cs)]
