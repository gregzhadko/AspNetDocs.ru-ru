---
uid: web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs
title: Практическое лабораторное занятие. Создать одностраничное приложение (SPA) с веб-API ASP.NET и Angular.js - ASP.NET 4.x
author: rick-anderson
description: 'Шаг за шагом кода: Создание приложения на одной странице (SPA) с помощью веб-API ASP.NET и Angular.js для ASP.NET 4.x.'
ms.author: riande
ms.date: 09/30/2015
ms.custom: seoapril2019
ms.assetid: 719727b7-bef3-45ad-bfe9-ba5bcdb2305f
msc.legacyurl: /web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs
msc.type: authoredcontent
ms.openlocfilehash: 1f093e348216750cbadb6e52f524e5edd4d6c498
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59390276"
---
# <a name="hands-on-lab-build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs"></a>Практическое лабораторное занятие. Создание одностраничного приложения (SPA) с помощью веб-API ASP.NET и Angular.js

по [Web Слышатся Team](https://twitter.com/webcamps)

[Скачайте комплект учебных материалов по лагеря Web](https://aka.ms/webcamps-training-kit)

Данная лабораторная работа показано, как создать одностраничное приложение (SPA) с веб-API ASP.NET и Angular.js для ASP.NET 4.x.

В этой лаборатории в наличии будет воспользоваться преимуществами этих технологий для реализации Quiz компьютерщик, trivia веб-сайт, на концепции SPA. Сначала будет реализовать на уровне службы с веб-API ASP.NET, чтобы предоставить необходимые конечные точки, чтобы получить на вопросы викторины и сохранить ответы. Затем вы создадите пользовательский Интерфейс, широкие возможности и отвечает на запросы, с помощью AngularJS и CSS3 влияние преобразования.

В традиционных веб-приложениях клиент (браузер) инициирует обмен данными с сервером путем запроса страницы. Затем сервер обрабатывает запрос и отправляет клиенту HTML-код страницы. В последующих взаимодействий со страницей — например пользователь переходит по ссылке или отправке формы с данными — новый запрос отправляется на сервер, и начнет работу потока: сервер обрабатывает запрос и возвращает новую страницу в браузер в ответ на запрос нового действия Эд клиентом.
> 
> В одностраничных приложениях (SPA) вся страница загружается в браузере после начального запроса, но последующие операции выполняются с помощью запросов Ajax. Это означает, что браузер должен обновить только часть страницы, которая была изменена; Нет необходимости перезагрузить всей страницы. SPA подход уменьшает время, необходимое для реагирования на действия пользователя, что более гибкий интерфейса приложения.
> 
> Архитектура SPA включает в себя определенные трудности, которые не существуют в традиционные веб-приложения. Тем не менее новые технологии, такие как веб-API ASP.NET, JavaScript платформы, такие как AngularJS, и новые функции стилей, предоставляемые CSS3 сделать очень легко проектировать и создавать одностраничные приложения.
> 
> 
> Все примеры кода и фрагменты кода включены в Web лагеря комплект обучающих материалов, доступных в [ https://aka.ms/webcamps-training-kit ](https://aka.ms/webcamps-training-kit).


## <a name="overview"></a>Обзор

<a id="Objectives"></a>
### <a name="objectives"></a>Цели

В этой практической работу вы узнаете, как:

- Создание службы веб-API ASP.NET для отправки и получения данных JSON
- Создание адаптивного пользовательского интерфейса с помощью AngularJS
- Улучшения пользовательского интерфейса с помощью преобразований CSS3

<a id="Prerequisites"></a>
### <a name="prerequisites"></a>Предварительные требования

Для завершения этой практической работу требуется следующее:

- [Visual Studio Express 2013 для Web](https://www.microsoft.com/visualstudio/) или более поздней версии

<a id="Setup"></a>
### <a name="setup"></a>Установка

Для выполнения упражнений в этой практической работу, необходимо сначала настроить среду.

1. Откройте Windows Explorer и перейдите к лаборатории **источника** папки.
2. Щелкните правой кнопкой мыши **Setup.cmd** и выберите **Запуск от имени администратора** для запуска процесса установки, будет настроить среду и установить фрагменты кода Visual Studio для этой лабораторной работы.
3. Если отображается диалоговое окно контроля учетных записей, подтвердите действие для продолжения.

> [!NOTE]
> Убедитесь, что все зависимости для этой лабораторной работы вы вернули перед запуском программы установки.


<a id="CodeSnippets"></a>
### <a name="using-the-code-snippets"></a>Фрагменты кода

В этом документе лаборатории вам будет рекомендовано вставлять блоки кода. Для удобства основная часть кода предоставляется как фрагменты кода Visual Studio, к которому можно получить из в Visual Studio 2013, чтобы избежать необходимости добавлять ее вручную.

> [!NOTE]
> Каждого упражнения сопровождается начальный решения, расположенный в **начать** папку упражнения, чему вы сможете каждого упражнения, независимо от других. Имейте в виду, что фрагменты кода, которые добавляются во время атаки, отсутствуют эти стартовые решения и могут не работать, пока не будут выполнены упражнения. В исходном коде для упражнения, вы также найдете **окончания** папку, содержащую решение Visual Studio с кодом, полученный в результате выполнения действий, описанных в соответствующий упражнении. Эти решения можно использовать в качестве руководства, если вам нужна дополнительная помощь, отвечая на это Практическое занятие.


---

<a id="Exercises"></a>
## <a name="exercises"></a>Упражнения

Это Практическое занятие включает в себя следующие упражнения:

1. [Создание веб-API](#Exercise1)
2. [Создание ОДНОСТРАНИЧНОГО интерфейса](#Exercise2)

Предполагаемое время для выполнения этого лабораторного: **60 минут**

> [!NOTE]
> При первом запуске Visual Studio, необходимо выбрать один из предварительно определенных коллекций параметров. Каждой коллекции предопределенных соответствует конкретному стилю разработки и определяет макетов окон, поведение редактора, фрагменты кода IntelliSense и параметры диалогового окна. В этом лабораторном занятии описаны действия, необходимые для выполнения данной задачи в Visual Studio при использовании **обычные параметры разработки** коллекции. При выборе другого набора параметров для среды разработки, возможно, различия в действиях, которые следует учитывать.


<a id="Exercise1"></a>
### <a name="exercise-1-creating-a-web-api"></a>Упражнение 1. Создание веб-API

Одним из ключевых элементов SPA является уровень служб. Он отвечает за обработку вызовов Ajax, отправляемые функциями пользовательского интерфейса и возврат данных в ответ на этот вызов. Извлеченные данные должны быть представлены в машиночитаемом формате для синтаксического анализа и использования клиентом.

Платформа веб-API является частью стека ASP.NET и предназначен для упрощения реализации службы HTTP, как правило, отправки и получения данных в формате JSON или XML через API-интерфейсов RESTful. В этом упражнении вы создадите веб-сайт для размещения приложения Quiz компьютерщик, а затем реализуйте серверной службы для предоставления и сохранения данных тест, с помощью веб-API ASP.NET.

<a id="Ex1Task1"></a>
#### <a name="task-1--creating-the-initial-project-for-geek-quiz"></a>Задача 1 – Создание начального проекта для Компьютерщик головоломки

В этой задаче будет приступить к созданию нового проекта ASP.NET MVC с поддержкой веб-API ASP.NET на основе **One ASP.NET** тип, который поставляется с Visual Studio проекта. **One ASP.NET** объединяет все технологии ASP.NET и предоставляет вам возможность комбинировать и сопоставлять их при необходимости. Затем вы добавите классы модели Entity Framework и инициализации базы данных для вставки вопросы теста.

1. Откройте **Visual Studio Express 2013 для Web** и выберите **файл | Создать проект...**  для запуска нового решения.

    ![Создание нового проекта](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image1.png "создания нового проекта")

    *Создание нового проекта*
2. В **новый проект** выберите **веб-приложение ASP.NET** под **Visual C# | Web** вкладки. Убедитесь, что **.NET Framework 4.5** — флажок установлен, назовите его *GeekQuiz*, выберите **расположение** и нажмите кнопку **ОК**.

    ![Создание нового проекта веб-приложение ASP.NET](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image2.png "Создание нового проекта веб-приложения ASP.NET")

    *Создание нового проекта веб-приложения ASP.NET*
3. В **новый проект ASP.NET** выберите **MVC** шаблона и выберите **веб-API** параметр. Кроме того, убедитесь, что **проверки подлинности** параметру присваивается **учетные записи отдельных пользователей**. Нажмите кнопку **ОК** , чтобы продолжить.

    ![Создание нового проекта с помощью шаблона MVC, включая компоненты веб-API](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image3.png)

    *Создание нового проекта с помощью шаблона MVC, включая компоненты веб-API*
4. В **обозревателе решений**, щелкните правой кнопкой мыши **моделей** папке **GeekQuiz** проекта и выберите **Add | Существующий элемент...** .

    ![Добавление существующего элемента](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image4.png "Добавление существующего элемента")

    *Добавление существующего элемента*
5. В **добавить существующий элемент** диалогового окна поле, перейдите в каталог **источника/ресурсы/моделей** папку и выберите все файлы. Нажмите кнопку **Добавить**.

    ![Добавление средств модели](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image5.png "добавление средств модели")

    *Добавление средств модели*

    > [!NOTE]
    > Добавив эти файлы, при добавлении в модель данных, контекст базы данных Entity Framework и инициализации базы данных для приложения Quiz Компьютерщик.
    > 
    > **Entity Framework (EF)** является объектно реляционного сопоставления (ORM), которая позволяет создавать приложения для доступа к данным, работающие с концептуальной моделью приложения вместо программирования, напрямую с помощью реляционной схемой хранения. Дополнительные сведения о платформе Entity Framework [здесь](../../../entity-framework.md).
    > 
    > Ниже приведено описание классов, которые вы только что добавили.
    > 
    > - **TriviaOption:** представляет отдельный параметр, связанный с вопрос головоломки
    > - **TriviaQuestion:** представляет вопрос головоломки и предоставляет связанные параметры через **параметры** свойство
    > - **TriviaAnswer:** представляет параметр, выбранный пользователем в ответ на вопрос головоломки
    > - **TriviaContext:** представляет контекст базы данных Entity Framework приложения Компьютерщик тест. Этот класс является производным от **DContext** и предоставляет **DbSet** свойства, представляющие коллекцию сущностей, описанных выше.
    > - **TriviaDatabaseInitializer:** инициализатора Entity Framework для реализации **TriviaContext** класс, который наследуется от **CreateDatabaseIfNotExists**. Этот класс по умолчанию для создания базы данных только в том случае, если он не существует, вставка сущности указан в **начальное значение** метод.
6. Откройте **Global.asax.cs** файл и добавьте следующий оператор using.

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample1.cs)]
7. Добавьте следующий код в начале **приложения\_запустить** метод, чтобы задать **TriviaDatabaseInitializer** как инициализатор базы данных.

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample2.cs)]
8. Изменить **Главная** контроллера для ограничения доступа для прошедших проверку пользователей. Чтобы сделать это, откройте **HomeController.cs** внутри **контроллеров** папку и добавьте **Authorize** атрибут **HomeController**определение класса.

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample3.cs)]

    > [!NOTE]
    > **Authorize** фильтр проверяет, если пользователь прошел проверку подлинности. Если пользователь не прошел проверку подлинности, он возвращает код состояния HTTP 401 (неавторизованный) без вызова действия. Вы можете применить фильтр глобально, на уровне контроллера или на уровне отдельных действий.
9. Теперь будет выполнена настройка макета веб-страниц и фирменную символику. Чтобы сделать это, откройте  **\_Layout.cshtml** внутри **представления | Общие** папки и обновить содержимое **&lt;title&gt;** элемента, заменив *Мое приложение ASP.NET* с *Компьютерщик тест* .

    [!code-cshtml[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample4.cshtml)]
10. В тот же файл, добавить на панель навигации, удалив *о* и *контакт* ссылки и переименование *Главная* связать *воспроизведение*. Кроме того, переименование *имя_приложения* связать *Quiz Компьютерщик*. HTML для панели навигации должен выглядеть аналогично следующему коду.

    [!code-cshtml[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample5.cshtml)]
11. Обновите нижний колонтитул страницы макета, заменив *Мое приложение ASP.NET* с *Quiz Компьютерщик*. Для этого замените содержимое **&lt;нижний колонтитул&gt;** элемент с следующий выделенный код.

    [!code-html[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample6.html)]

<a id="Ex1Task2"></a>
#### <a name="task-2--creating-the-triviacontroller-web-api"></a>Задача 2 — Создание TriviaController веб-API

В предыдущей задаче вы создали начальную структуру веб-приложения Quiz Компьютерщик. Теперь вы создадите простую службу веб-API, который взаимодействует с моделью данных головоломки и предоставляет следующие действия:

- **GET/api/trivia**: Извлекает следующий вопрос из списка викторины, чтобы получать ответ пользователя, прошедшего аутентификацию.
- **POST/api/trivia**: Сохраняет ответ головоломки, указанное пользователем, прошедшим проверку.

Формирование шаблонов ASP.NET средств, предоставляемых Visual Studio будет использовать для создания шаблона для класса контроллера веб-API.

1. Откройте **WebApiConfig.cs** внутри **приложения\_запустить** папки. Этот файл определяет конфигурацию службы, веб-API, например сопоставление маршрутов к действиям контроллера веб-API.
2. Добавьте следующую инструкцию using в начале файла.

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample7.cs)]
3. Добавьте следующий выделенный код, который **зарегистрировать** метод глобально настроить модуль форматирования для данных JSON, извлекаемые методами действий веб-API.

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample8.cs)]

    > [!NOTE]
    > **CamelCasePropertyNamesContractResolver** автоматически преобразует имена свойств для *camel* случай, который является соглашением, общие для имен свойств в JavaScript.
4. В **обозревателе решений**, щелкните правой кнопкой мыши **контроллеров** папке **GeekQuiz** проекта и выберите **Add | Создать шаблонный элемент...** .

    ![Создание новый шаблонный элемент](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image6.png "Создание новый шаблонный элемент")

    *Создание нового элемента формирования шаблонов*
5. В **Добавление шаблона** диалогового окна поле, убедитесь, что **распространенных** узел выбран на панели слева. Выберите **контроллер Web API 2 — пустой** шаблона в центральной области и нажмите кнопку **добавить**.

    ![Выбрав шаблон пустой контроллер Web API 2](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image7.png "выбрав шаблон пустой контроллер Web API 2")

    *Выбрав шаблон пустой контроллер Web API 2*

    > [!NOTE]
    > **Формирование шаблонов ASP.NET** — это платформа создания кода для веб-приложений ASP.NET. Visual Studio 2013 включает в себя генераторы предварительно установленных кода для проектов MVC и веб-API. Для быстрого добавления кода, взаимодействующего с моделями данных, чтобы сократить количество времени, необходимые для разработки стандартных данных операций, следует использовать формирование шаблонов в проекте.
    > 
    > Процесс формирования шаблонов также гарантирует, что в проекте установлены все необходимые зависимости. Например если начать с пустого проекта ASP.NET и затем использовать формирование шаблонов по добавлению контроллера в веб-API, необходимые пакеты Web API NuGet и ссылки добавляются в проект автоматически.
6. В **Добавление контроллера** диалоговом окне *TriviaController* в **имя контроллера** текстовое поле и нажмите кнопку **добавить**.

    ![Добавление контроллера Trivia](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image8.png "Добавление контроллера дополнительной информации")

    *Добавление контроллера дополнительной информации*
7. **TriviaController.cs** файл добавляется в **контроллеров** папке **GeekQuiz** проект, содержащий пустой **TriviaController** класса. Добавьте следующие операторы using в начале файла.

    (Code Snippet - *TriviaControllerUsings AspNetWebApiSpa - сервера Ex1 -*)

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample9.cs)]
8. Добавьте следующий код в начале **TriviaController** класс для определения, инициализации и dispose **TriviaContext** экземпляра в контроллере.

    (Code Snippet - *TriviaControllerContext AspNetWebApiSpa - сервера Ex1 -*)

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample10.cs)]

    > [!NOTE]
    > **Dispose** метод **TriviaController** вызывает **Dispose** метод **TriviaContext** экземпляр, который гарантирует, что все освобождаются ресурсы, используемые объектом контекста при **TriviaContext** экземпляр удаляется или сборщиком мусора. Сюда входят, закрытие всех подключений к базе данных открывается с Entity Framework.
9. Добавьте следующий вспомогательный метод в конце **TriviaController** класса. Этот метод извлекает следующий вопрос тест из базы данных, которые отвечают указанному пользователю.

    (Code Snippet - *TriviaControllerNextQuestion AspNetWebApiSpa - сервера Ex1 -*)

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample11.cs)]
10. Добавьте следующий **получить** методом действия **TriviaController** класса. Этот метод вызывает **NextQuestionAsync** вспомогательный метод, определенный в предыдущем шаге, чтобы получить следующий вопрос для авторизованного пользователя.

    (Code Snippet - *TriviaControllerGetAction AspNetWebApiSpa - сервера Ex1 -*)

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample12.cs)]
11. Добавьте следующий вспомогательный метод в конце **TriviaController** класса. Этот метод сохраняет указанный ответ в базе данных и возвращает логическое значение, указывающее, будет ли получен верный ответ.

    (Code Snippet - *TriviaControllerStoreAsync AspNetWebApiSpa - сервера Ex1 -*)

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample13.cs)]
12. Добавьте следующий **Post** методом действия **TriviaController** класса. Этот метод действия связывает ответ на прошедшего проверку подлинности пользователя и вызывает **StoreAsync** вспомогательный метод. Затем оно отправляет ответ с логическое значение, возвращенное вспомогательный метод.

    (Code Snippet - *TriviaControllerPostAction AspNetWebApiSpa - сервера Ex1 -*)

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample14.cs)]
13. Изменение контроллера веб-API для ограничения доступа пользователям, прошедшим проверку, добавив **Authorize** атрибут **TriviaController** определение класса.

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample15.cs)]

<a id="Ex1Task3"></a>
#### <a name="task-3--running-the-solution"></a>Задача 3 – при запуске решения

В этой задаче вы проверите, что служба веб-API, созданный в предыдущей задаче работает должным образом. В Internet Explorer будет использоваться **средства разработчика F12** для записи сетевого трафика и проверки полный ответ от службы веб-API.

> [!NOTE]
> Убедитесь, что **Internet Explorer** выбран в **запустить** расположенную на панели инструментов Visual Studio.
> 
> ![Параметр Internet Explorer](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image9.png)


1. Нажмите клавишу **F5** для запуска решения. **Вход** страница должна выглядеть в браузере.

    > [!NOTE]
    > Активируется при запуске приложения, маршрут по умолчанию MVC, которое по умолчанию сопоставляется **индекс** действие **HomeController** класса. Так как **HomeController** только пользователям, прошедшим проверку (Помните, что вы атрибутом класса **Authorize** атрибут в упражнении 1) и пользователь не прошел проверку подлинности, но приложение перенаправляет на страницу входа исходного запроса.

    ![При запуске решения](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image10.png "при запуске решения")

    *При запуске решения*
2. Нажмите кнопку **зарегистрировать** для создания нового пользователя.

    ![Регистрация нового пользователя](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image11.png "регистрации новых пользователей")

    *Регистрация нового пользователя*
3. В **зарегистрировать** введите **имя пользователя** и **пароль**, а затем нажмите кнопку **зарегистрировать**.

    ![Страница «Регистрация»](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image12.png "регистра страницы")

    *Страница «Регистрация»*
4. Приложение регистрирует новую учетную запись, и пользователь прошел проверку подлинности и перенаправляется на домашнюю страницу.

    ![Пользователь прошел проверку подлинности](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image13.png "пользователь прошел проверку подлинности")

    *Пользователь прошел проверку подлинности*
5. В браузере, нажмите клавишу **F12** открыть **средств разработчика** панели. Нажмите клавишу **CTRL + 4** или нажмите кнопку **сети** значок, а затем щелкните кнопку с зеленой стрелкой, чтобы начать отслеживать сетевой трафик.

    ![Запуск записи сетевых данных веб-API](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image14.png "записи сетевых данных инициирует веб-API")

    *Запуск записи сетевых данных веб-API*
6. Добавление **api/trivia** на URL-адрес в адресной строке браузера. Теперь проверьте сведения об ответе от **получить** метода действия в **TriviaController**.

    ![Получение следующего вопроса данных через веб-API](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image15.png "получении следующего вопроса данных через веб-API")

    *Получение следующего вопроса данных через веб-API*

    > [!NOTE]
    > После завершения загрузки, вам будет предложено задать действие с помощью загруженного файла. Не закрывайте диалоговое окно, чтобы иметь возможность смотреть содержимое ответа через окно инструментов для разработчиков.
7. Теперь будет проверять текст ответа. Чтобы сделать это, нажмите кнопку **сведения** вкладке и нажмите кнопку **текст ответа**. Вы можете проверить, что загруженные данные — это объект со свойствами **параметры** (который приведен список **TriviaOption** объекты), **идентификатор** и **title** , которые соответствуют **TriviaQuestion** класса.

    ![Просмотр тексте ответа API Web](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image16.png "Просмотр тексте ответа API Web")

    *Текст ответа API Web просмотра*
8. Вернитесь к Visual Studio и нажать клавишу **SHIFT + F5** остановить отладку.

<a id="Exercise2"></a>
### <a name="exercise-2-creating-the-spa-interface"></a>Упражнение 2. Создание ОДНОСТРАНИЧНОГО интерфейса

В этом упражнении следует построить веб интерфейсной части Quiz компьютерщик, уделяя основное внимание взаимодействия одностраничного приложения с помощью **AngularJS**. Затем, улучшает взаимодействие с пользователем с помощью CSS3 выполнения широкие возможности анимации и предоставлять визуальный эффект переключения при переходе от одного вопроса к следующему контекста.

<a id="Ex2Task1"></a>
#### <a name="task-1--creating-the-spa-interface-using-angularjs"></a>Задача 1 – Создание интерфейса одностраничного приложения, с помощью AngularJS

В этой задаче вы воспользуетесь **AngularJS** для реализации приложения Quiz Компьютерщик на стороне клиента. **AngularJS** — это фреймворк открытым исходным кодом JavaScript, который расширяет Браузерные приложения с *Model-View-Controller* (MVC) возможностей, упрощения разработки, так и тестирования.

Начнем с установки AngularJS из консоли диспетчера пакетов Visual Studio. Затем вы создадите контроллера для обеспечения поведения приложения Компьютерщик головоломки и представления для отображения головоломки вопросы и ответы, используя модуль AngularJS шаблонов.

> [!NOTE]
> Дополнительные сведения о AngularJS см. [ [ http://angularjs.org/ ](http://angularjs.org/) ](http://angularjs.org/).


1. Откройте **Visual Studio Express 2013 для Web** и откройте **GeekQuiz.sln** решение находится в **источника/Ex2-CreatingASPAInterface/начало** папки. Кроме того можно продолжить с решением, полученный в предыдущем упражнении.
2. Откройте **консоль диспетчера пакетов** из **средства** > **диспетчер пакетов NuGet**. Введите следующую команду, чтобы установить **AngularJS.Core** пакет NuGet.

    [!code-powershell[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample16.ps1)]
3. В **обозревателе решений**, щелкните правой кнопкой мыши **сценарии** папке **GeekQuiz** проекта и выберите **Add | Новая папка**. Назовите папку **приложения** и нажмите клавишу **ввод**.
4. Щелкните правой кнопкой мыши **приложения** только что созданной папке и выберите **Add | Файл JavaScript**.

    ![Создание нового файла JavaScript](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image17.png)

    *Создание нового файла JavaScript*
5. В **указания имени элемента** диалоговом окне *головоломки контроллера* в **имя элемента** текстовое поле и нажмите кнопку **ОК**.

    ![Именование новый файл JavaScript](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image18.png)

    *Именование новый файл JavaScript*
6. В **тест controller.js** добавьте следующий код, чтобы объявить и инициализировать AngularJS **QuizCtrl** контроллера.

    (Code Snippet - *AngularQuizController AspNetWebApiSpa - Ex2 -*)

    [!code-javascript[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample17.js)]

    > [!NOTE]
    > Функции-конструктора модуля **QuizCtrl** контроллера требуется injectable параметр с именем **$scope**. Начальное состояние области следует настроить в функции конструктора путем присоединения свойства **$scope** объекта. Свойства содержат **модель представления**и время регистрации контроллера будет доступен в шаблоне.
    > 
    > **QuizCtrl** контроллер определен в модуле с именем **QuizApp**. Модули — это единицы работы, которые позволяют разбить приложение на отдельные компоненты. Основные преимущества с помощью модулей, что код проще для понимания и упрощает модульное тестирование, возможность повторного использования и удобства поддержки.
7. Теперь поведение будет добавлена в область действия для реагирования на события, вызываемые из представления. Добавьте следующий код в конце **QuizCtrl** контроллера для определения **nextQuestion** работать в **$scope** объекта.

    (Code Snippet - *AngularQuizControllerNextQuestion AspNetWebApiSpa - Ex2 -*)

    [!code-javascript[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample18.js)]

    > [!NOTE]
    > Эта функция извлекает следующий вопрос из **Trivia** веб-API, созданный в предыдущем упражнении и присоединяет вопрос данные **$scope** объекта.
8. Вставьте следующий код в конце **QuizCtrl** контроллера для определения **sendAnswer** работать в **$scope** объекта.

    (Code Snippet - *AngularQuizControllerSendAnswer AspNetWebApiSpa - Ex2 -*)

    [!code-javascript[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample19.js)]

    > [!NOTE]
    > Эта функция отправляет ответ, выбранный пользователем для **Trivia** веб-API и сохраняет результат — т. е. Если ответ правильный, или нет — в **$scope** объекта.
    > 
    > **NextQuestion** и **sendAnswer** функции выше используют AngularJS **$http** объекта, чтобы абстрагировать взаимодействие с веб-API через XMLHttpRequest Объект JavaScript в браузере. AngularJS поддерживает другую службу, которая обеспечивает более высокий уровень абстракции для выполнения операций CRUD для ресурса с помощью API-интерфейсов RESTful. AngularJS **$resource** объект имеет методы действий, которые предоставляют общие поведения без необходимости взаимодействовать с **$http** объекта. Рассмотрите возможность использования **$resource** объекта в сценариях, который требует модели CRUD (fore сведения см. в разделе [$resource документации](https://docs.angularjs.org/api/ngResource/service/$resource)).
9. Следующий шаг — создать шаблон AngularJS, который определяет представление для головоломки. Чтобы сделать это, откройте **Index.cshtml** внутри **представления | Главная** папку и замените содержимое следующим кодом.

    (Code Snippet - *GeekQuizView AspNetWebApiSpa - Ex2 -*)

    [!code-cshtml[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample20.cshtml)]

    > [!NOTE]
    > Шаблон AngularJS — декларативный спецификации, которые используют сведения из модели и контроллера для преобразования статическую разметку в динамическое представление, которое пользователь видит в браузере. Ниже приведены примеры AngularJS элементов и атрибутов элемента, которые могут использоваться в шаблоне:
    > 
    > - **Ng-app** директива указывает AngularJS элемент DOM, который представляет корневой элемент приложения.
    > - **Ng-controller** директива присоединяет контроллера в модель DOM в точке, где объявлен директивы.
    > - Запись в фигурных скобках **{{}}** обозначает привязки для свойства области, указанных в этом контроллере.
    > - **Щелчком ng** директива используется для вызова функции, определенные в области действия в ответ на щелчок пользователя.
10. Откройте **Site.css** внутри **содержимого** папку и добавьте следующие выделенные стили в конце файла для предоставления внешнего вида и поведения для представления головоломки.

    (Code Snippet - *GeekQuizStyles AspNetWebApiSpa - Ex2 -*)

    [!code-css[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample21.css)]

<a id="Ex2Task2"></a>
#### <a name="task-2--running-the-solution"></a>Задача 2 – при запуске решения

В этой задаче, в которые будет выполнять решения с помощью нового пользователя интерфейс, созданный с помощью AngularJS, чтобы ответить на вопросы викторины вами.

1. Нажмите клавишу **F5** для запуска решения.
2. Зарегистрируйте новую учетную запись пользователя. Чтобы сделать это, выполните действия для регистрации описано в упражнении 1, задача 3.

    > [!NOTE]
    > Если вы используете решение из предыдущего упражнения, вы можете войти с учетной записью пользователя, которую вы создали ранее.
3. **Главная** страница должна выглядеть, показывающий на первый вопрос головоломки. Ответьте на вопрос, щелкнув один из вариантов. Это приводит к запуску **sendAnswer** функции, определенной ранее, но, которая отправляет выбранный параметр **Trivia** веб-API.

    ![Ответить на вопрос о](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image19.png "ответить на вопрос")

    *Ответы на вопросы*
4. Щелкните одну из кнопок и появится ответ. Нажмите кнопку **следующий вопрос** для отображения на следующий вопрос. Это приводит к запуску **nextQuestion** функции, определенной в контроллере.

    ![Запрашивает следующий вопрос](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image20.png "запрашивает следующий вопрос")

    *Запрашивает следующий вопрос*
5. Должен появиться следующий вопрос. По-прежнему ответы на вопросы столько раз, сколько требуется. После завершения работы все вопросы следует возвращать на первый вопрос.

    ![Другой вопрос](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image21.png "другой вопрос")

    *Следующий вопрос*
6. Вернитесь к Visual Studio и нажать клавишу **SHIFT + F5** остановить отладку.

<a id="Ex2Task3"></a>
#### <a name="task-3--creating-a-flip-animation-using-css3"></a>Задача 3 — Создание Переворачивающейся анимации, с помощью CSS3

В этой задаче будет использовать свойства CSS3 для выполнения многофункциональных анимации путем добавления эффекта переворачивающейся, когда ответ на вопрос, и при извлечении следующий вопрос.

1. В **обозревателе решений**, щелкните правой кнопкой мыши **содержимого** папке **GeekQuiz** проекта и выберите **Add | Существующий элемент...** .

    ![Добавление существующего элемента в папку Content](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image22.png "Добавление существующего элемента в папку Content")

    *Добавление существующего элемента в папку Content*
2. В **добавить существующий элемент** диалоговом окне перейдите к **источника и ресурсы** папку и выберите **Flip.css**. Нажмите кнопку **Добавить**.

    ![Добавление файла Flip.css из средств](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image23.png "Добавление файла Flip.css из ресурсов")

    *Добавление файла Flip.css из ресурсов*
3. Откройте **Flip.css** файл был только что добавили и проверьте его содержимое.
4. Найдите **перевернуть преобразование** комментарий. Стили меньше этого комментария использовать CSS **перспективы** и **rotateY** преобразования для создания &quot;карточка пролистывание&quot; эффект.

    [!code-css[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample22.css)]
5. Найдите **скрыть лицевой панели во время пролистывание** комментарий. Стиль ниже этого комментария скрывает на обратной стороне лиц, когда они столкнулись в сторону от зрителя, задав **противоположной видимость** свойств CSS для *скрытые*.

    [!code-css[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample23.css)]
6. Откройте **BundleConfig.cs** внутри **приложения\_запустить** папку и добавьте ссылку на **Flip.css** файл **&quot;~/Content/css&quot;** стиля пакета

    [!code-csharp[Main](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/samples/sample24.cs)]
7. Нажмите клавишу **F5** для запуска решения и журналов с помощью учетных данных.
8. Ответ на вопрос, щелкнув один из вариантов. Обратите внимание переворачивающейся эффект, во время перехода между представлениями.

    ![Ответы на вопросы с эффектом переворачивающейся](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image24.png "ответить на вопрос с переворачивающейся эффектом")

    *Ответы на вопросы с переворачивающейся эффектом*
9. Нажмите кнопку **следующий вопрос** для извлечения на следующий вопрос. Снова появится переворачивающейся эффект.

    ![Получение на следующий вопрос с эффектом переворачивающейся](build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs/_static/image25.png "извлечение на следующий вопрос с переворачивающейся эффектом")

    *Получение на следующий вопрос с переворачивающейся эффектом*

---

<a id="Summary"></a>
## <a name="summary"></a>Сводка

Выполнив этой практической работу вы узнали, как:

- Создание контроллера веб-API ASP.NET с помощью формирования шаблонов ASP.NET
- Реализовать действие получения Web API для получения следующий вопрос головоломки
- Реализуйте действие после Web API для хранения ответы на тест
- Установка AngularJS из консоли диспетчера пакетов Visual Studio
- Реализуйте AngularJS шаблоны и контроллеры
- Использовать для выполнения эффекты анимации переходы CSS3
