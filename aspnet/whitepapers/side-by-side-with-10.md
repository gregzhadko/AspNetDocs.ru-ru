---
uid: whitepapers/side-by-side-with-10
title: ASP.NET параллельное выполнение .NET Framework 1,0 и 1,1 | Документация Майкрософт
author: rick-anderson
description: В этом техническом документе описывается установка .NET 1,0 и .NET 1,1 на компьютере, что позволяет веб-приложению ASP.NET работать в любой версии Фрам...
ms.author: riande
ms.date: 02/10/2010
ms.assetid: bdea2003-e964-4db5-9092-d56cc7560616
msc.legacyurl: /whitepapers/side-by-side-with-10
msc.type: content
ms.openlocfilehash: c123545099013af71569bce4707f2b3eb732c344
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78513834"
---
# <a name="aspnet-side-by-side-execution-of-net-framework-10-and-11"></a>Параллельное выполнение нескольких версий .NET Framework 1.0 и 1.1 в ASP.NET

> В этом техническом документе описывается установка .NET 1,0 и .NET 1,1 на компьютере, что позволяет веб-приложению ASP.NET работать в любой версии платформы.
> 
> Применяется к ASP.NET 1,0 и ASP.NET 1,1.

В ASP.NET приложения говорят, что они работают параллельно, если они установлены на одном компьютере, но используют разные версии .NET Framework. В следующем разделе описывается настройка приложений ASP.NET для параллельного выполнения и даются подробные инструкции по выполнению следующих действий.

- [Поддержание сопоставления веб-приложения с .NET Framework версии 1,0 во время установки](#1)
- [Сопоставьте веб-приложение с определенной версией .NET Framework](#2)
- [Поиск версии .NET Framework, используемой веб-сайтом](#3)

Обычно при обновлении компонента или приложения на компьютере старая версия удаляется и заменяется новой версией. Если новая версия несовместима с предыдущей, это обычно приводит к разрыву работы других приложений, использующих этот компонент или приложение. .NET Framework обеспечивает поддержку параллельного выполнения, что позволяет одновременно установить на одном компьютере несколько версий сборки или приложения одновременно. Поскольку несколько версий можно установить одновременно, управляемые приложения могут выбрать версию, которая будет использоваться, не влияя на приложения, использующие другую версию.

По умолчанию во время установки .NET Framework версии 1,1 все существующие приложения ASP.NET автоматически перестраиваются для использования последней версии .NET Framework. Если вы не хотите, чтобы приложения ASP.NET по умолчанию .NET Framework 1,1, щелкните [здесь](#1) , чтобы узнать, как предотвратить это во время установки.

Если вы обновите веб-сервер до .NET Framework 1,1 и хотите, чтобы одно или несколько веб-приложений выполняли .NET Framework 1,0, необходимо обновить карту сценариев службы IIS (IIS). Сопоставление сценариев — это механизм сопоставления расширения ASPX-файла для конкретного веб приложения с версией .NET Framework. Щелкните [здесь](#2) , чтобы узнать, как сопоставлять веб-приложения с определенной версией .NET Framework.

Вы можете использовать диспетчер Internet Information Manager или средство регистрации ASP.NET IIS (ASPNET\_regiis. exe), чтобы найти .NET Framework версию, на которой выполняется определенное веб-приложение. Щелкните [здесь](#3) , чтобы узнать, как найти версию .NET Framework, используемую веб-сайтом.

При переходе на .NET Framework 1,1 в каждой версии .NET Framework используется собственный файл Machine. config. В результате, если веб-администратор внес изменения в файл Machine. config, эти изменения необходимо перенести в файл Machine. config .NET Framework 1,1.

<a id="1"></a>

## <a name="maintaining-your-web-applications-mapping-to-net-framework-10-during-installation"></a>Поддержание сопоставления веб-приложения с .NET Framework 1,0 во время установки

По умолчанию все существующие приложения ASP.NET автоматически перестраиваются во время установки, чтобы использовать более новую версию .NET Framework. Используя более новую версию .NET Framework, приложения могут воспользоваться всеми преимуществами усовершенствований и новых функций, реализованных в новом выпуске. В то же время веб-администратор, которому может потребоваться детальный контроль над тем, какие приложения обновляются, может предотвратить автоматическое повторное сопоставление всех существующих ASP.NET приложений во время установки .NET Framework.

Чтобы предотвратить автоматическое повторное сопоставление всего приложения ASP.NET с новой версией .NET Framework, веб-администратор может использовать параметр командной строки/ноаспупграде с программой установки Dotnetfx. exe.

**Предотвращение общего пересопоставления приложения ASP.NET с новой версией**

1. Выберите **Пуск**.
2. Щелкните **выполнить**.
3. Наберите команду **cmd**.
4. Нажмите кнопку **ОК**.  
  
    ![](side-by-side-with-10/_static/image1.gif)
5. В командной строке введите следующую строку, чтобы начать установку .NET Framework: **Dotnetfx. exe/c: "Install/ноаспупграде?** .  
  
    ![](side-by-side-with-10/_static/image2.gif)
6. Нажмите кнопку **Да** в программе установки Microsoft .NET Framework 1,1. Это приведет к запуску процесса установки .NET Framework 1,1.  
  
    ![](side-by-side-with-10/_static/image3.gif)

<a id="2"></a>

## <a name="map-a-web-application-to-a-specific-version-of-the-net-framework"></a>Сопоставьте веб-приложение с определенной версией .NET Framework

Каждая версия .NET Framework включает версию средства регистрации служб IIS ASP.NET (ASPNET\_regiis. exe). Это средство позволяет администраторам указать, что веб-приложение должно выполняться в определенной версии .NET Framework. Это называется сопоставлением веб-приложения с версией .NET Framework. Администраторы должны выбрать ASPNET\_regiis. exe, соответствующий версии .NET Framework, которая будет связана с веб-приложением. Например, администратор, желающий указать, что веб-сайт использует .NET Framework 1,1, должен использовать ASPNET\_regiis. exe, поставляемый с .NET Framework 1,1.

Файл ASPNET\_regiis. exe для версии 1,0 находится по адресу:

- К:\виндовс\микрософт.нет\фрамеворк\\**v 1.0.3705**\ASPNET\_regiis

Файл ASPNET\_regiis. exe для версии 1, 1 находится по адресу:

- К:\виндовс\микрософт.нет\фрамеворк\\**v 1.1.4322**\ASPNET\_regiis

ASPNET\_regiis. exe предоставляет два варианта создания сценариев для сопоставления веб-приложения:

- **-s** задает схему скрипта в пути и в ее дочерних каталогах.
- **-SN** задает схему сценария только в пути.

Путь определяет путь метаданных IIS веб-приложения, который определен в формате W3SVC/ROOT/{Вебситенумбер}/{имя приложения\_}. Например, для веб-приложения с именем Portal, расположенным на веб-сайте по умолчанию, путь к метабазе — W3SVC/1/ROOT/портал.

![](side-by-side-with-10/_static/image4.gif)

Примечание. для получения пути к метабазе можно также использовать средство, называемое редактором метабазы. Это средство можно загрузить на служба поддержки Майкрософт сайте по адресу [https://support.microsoft.com/default.aspx?scid=kb; en-US; 232068.](https://support.microsoft.com/default.aspx?scid=kb;en-us;232068)

- Выполните команду ASPNET\_regiis. exe-s W3SVC/1/ROOT/портал, чтобы обновить карту скриптов IIS портала и ее подприложение.  
  
    ![](side-by-side-with-10/_static/image5.gif)

- Выполните команду ASPNET\_regiis. exe-SN W3SVC/1/ROOT/портал, чтобы обновить карту сценариев портала IIS, не затрагивая приложения в подкаталогах портала.  
  
    ![](side-by-side-with-10/_static/image6.gif)

<a id="3"></a>

## <a name="find-the-net-framework-version-that-a-web-application-is-using"></a>Поиск версии .NET Framework, используемой веб-приложением

Администратор может использовать Service Manager Интернета, чтобы узнать, какая версия .NET Framework запускает веб-сайт. Разные версии операционных систем запускают Интернет-Service Manager по-другому. Чтобы запустить Service Manager, выполните указанные ниже действия.

**Запуск Service Manager Интернета**

1. Выберите **Пуск**.
2. Щелкните **выполнить**.
3. Введите **inetmgr**.  
  
    ![](side-by-side-with-10/_static/image7.gif)
4. В Service Manager Интернета выберите веб-приложение, версию .NET Framework которого необходимо получить.  
  
    ![](side-by-side-with-10/_static/image8.gif)
5. Щелкните правой кнопкой мыши веб-приложение и выберите пункт **Свойства.**  
  
    ![](side-by-side-with-10/_static/image9.gif)
6. В окне свойств выберите **Конфигурация.**  
  
    ![](side-by-side-with-10/_static/image10.gif)
7. В таблице сопоставление приложений выберите **ASPX**и нажмите кнопку **изменить**.  
  
    ![](side-by-side-with-10/_static/image11.gif)
8. В текстовом поле **исполняемый объект** просмотрите каталог версий, прокрутите его. Если каталог версий — v. 1.1.4322, приложение сопоставляется с .NET Framework 1,1. И наоборот, если каталог версии — версия 1.0.3705, приложение сопоставляется с .NET Framework 1,0.  
  
    ![](side-by-side-with-10/_static/image12.gif)
