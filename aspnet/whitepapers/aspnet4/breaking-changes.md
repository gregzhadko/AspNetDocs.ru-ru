---
uid: whitepapers/aspnet4/breaking-changes
title: ASP.NET 4 критические изменения | Документация Майкрософт
author: rick-anderson
description: В этом документе описаны изменения, внесенные в выпуск .NET Framework версии 4, который потенциально может повлиять на приложения, созданные с помощью...
ms.author: riande
ms.date: 02/10/2010
ms.assetid: d601c540-f86b-4feb-890c-20c806b3da6c
msc.legacyurl: /whitepapers/aspnet4/breaking-changes
msc.type: content
ms.openlocfilehash: 8ccad3b40a723c92a3164de082e1f94577141008
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78439512"
---
# <a name="aspnet-4-breaking-changes"></a><span data-ttu-id="08f8a-103">Критические изменения в ASP.NET 4</span><span class="sxs-lookup"><span data-stu-id="08f8a-103">ASP.NET 4 Breaking Changes</span></span>

> <span data-ttu-id="08f8a-104">В этом документе описаны изменения, внесенные в выпуск .NET Framework версии 4, который потенциально может повлиять на приложения, созданные с помощью более ранних выпусков, включая версии ASP.NET 4 Beta 1 и Beta 2.</span><span class="sxs-lookup"><span data-stu-id="08f8a-104">This document describes changes that have been made for the .NET Framework version 4 release that can potentially affect applications that were created using earlier releases, including the ASP.NET 4 Beta 1 and Beta 2 releases.</span></span>
> 
> [<span data-ttu-id="08f8a-105">Загрузить этот технический документ</span><span class="sxs-lookup"><span data-stu-id="08f8a-105">Download This Whitepaper</span></span>](https://download.microsoft.com/download/7/1/A/71A105A9-89D6-4201-9CC5-AD6A3B7E2F22/ASP_NET_4_Breaking_Changes.pdf)

<a id="0.1__Toc256768952"></a><a id="0.1__Toc256770056"></a>

## <a name="contents"></a><span data-ttu-id="08f8a-106">Содержимое</span><span class="sxs-lookup"><span data-stu-id="08f8a-106">Contents</span></span>

[<span data-ttu-id="08f8a-107">Параметр Контролрендерингкомпатибилитиверсион в файле Web. config</span><span class="sxs-lookup"><span data-stu-id="08f8a-107">ControlRenderingCompatibilityVersion Setting in the Web.config File</span></span>](#0.1__Toc256770141 "_Toc256770141")  
[<span data-ttu-id="08f8a-108">ClientIDMode изменения</span><span class="sxs-lookup"><span data-stu-id="08f8a-108">ClientIDMode Changes</span></span>](#0.1__Toc256770142 "_Toc256770142")  
[<span data-ttu-id="08f8a-109">HtmlEncode и UrlEncode теперь кодируются одинарные кавычки</span><span class="sxs-lookup"><span data-stu-id="08f8a-109">HtmlEncode and UrlEncode Now Encode Single Quotation Marks</span></span>](#0.1__Toc256770143 "_Toc256770143")  
[<span data-ttu-id="08f8a-110">Средство синтаксического анализа страницы ASP.NET (. aspx) является более четким</span><span class="sxs-lookup"><span data-stu-id="08f8a-110">ASP.NET Page (.aspx) Parser is Stricter</span></span>](#0.1__Toc256770144 "_Toc256770144")  
[<span data-ttu-id="08f8a-111">Обновлены файлы определения браузера</span><span class="sxs-lookup"><span data-stu-id="08f8a-111">Browser Definition Files Updated</span></span>](#0.1__Toc256770145 "_Toc256770145")  
[<span data-ttu-id="08f8a-112">System. Web. Mobile. dll удален из корневого файла веб-конфигурации</span><span class="sxs-lookup"><span data-stu-id="08f8a-112">System.Web.Mobile.dll Removed from Root Web Configuration File</span></span>](#0.1__Toc256770146 "_Toc256770146")  
[<span data-ttu-id="08f8a-113">Проверка запроса ASP.NET</span><span class="sxs-lookup"><span data-stu-id="08f8a-113">ASP.NET Request Validation</span></span>](#0.1__Toc256770147 "_Toc256770147")  
[<span data-ttu-id="08f8a-114">Алгоритм хэширования по умолчанию теперь HMACSHA256</span><span class="sxs-lookup"><span data-stu-id="08f8a-114">Default Hashing Algorithm Is Now HMACSHA256</span></span>](#0.1__Toc256770148 "_Toc256770148")  
[<span data-ttu-id="08f8a-115">Ошибки конфигурации, связанные с новой корневой конфигурацией ASP.NET 4</span><span class="sxs-lookup"><span data-stu-id="08f8a-115">Configuration Errors Related to New ASP.NET 4 Root Configuration</span></span>](#0.1__Toc256770149 "_Toc256770149")  
[<span data-ttu-id="08f8a-116">Не удается запустить дочерние приложения ASP.NET 4 при использовании приложений ASP.NET 2,0 или ASP.NET 3,5</span><span class="sxs-lookup"><span data-stu-id="08f8a-116">ASP.NET 4 Child Applications Fail to Start When Under ASP.NET 2.0 or ASP.NET 3.5 Applications</span></span>](#0.1__Toc256770150 "_Toc256770150")  
[<span data-ttu-id="08f8a-117">Не удается запустить веб-сайты ASP.NET 4 на компьютерах, где установлена SharePoint</span><span class="sxs-lookup"><span data-stu-id="08f8a-117">ASP.NET 4 Web Sites Fail to Start on Computers Where SharePoint Is Installed</span></span>](#0.1__Toc256770151 "_Toc256770151")  
[<span data-ttu-id="08f8a-118">Свойство HttpRequest. FilePath больше не включает значения PathInfo</span><span class="sxs-lookup"><span data-stu-id="08f8a-118">The HttpRequest.FilePath Property No Longer Includes PathInfo Values</span></span>](#0.1__Toc256770152 "_Toc256770152")  
[<span data-ttu-id="08f8a-119">Приложения ASP.NET 2,0 могут создавать ошибки HttpException, которые ссылаются на еурл. axd</span><span class="sxs-lookup"><span data-stu-id="08f8a-119">ASP.NET 2.0 Applications Might Generate HttpException Errors that Reference eurl.axd</span></span>](#0.1__Toc256770153 "_Toc256770153")  
[<span data-ttu-id="08f8a-120">Обработчики событий могут не вызываться в документе по умолчанию в интегрированном режиме IIS 7 или IIS 7,5.</span><span class="sxs-lookup"><span data-stu-id="08f8a-120">Event Handlers Might Not Be Not Raised in a Default Document in IIS 7 or IIS 7.5 Integrated Mode</span></span>](#0.1__Toc256770154 "_Toc256770154")  
[<span data-ttu-id="08f8a-121">Изменения в реализации управления доступом для кода ASP.NET (CAS)</span><span class="sxs-lookup"><span data-stu-id="08f8a-121">Changes to the ASP.NET Code Access Security (CAS) Implementation</span></span>](#0.1__Toc256770155 "_Toc256770155")  
[<span data-ttu-id="08f8a-122">MembershipUser и другие типы в пространстве имен System. Web. Security были перемещены</span><span class="sxs-lookup"><span data-stu-id="08f8a-122">MembershipUser and Other Types in the System.Web.Security Namespace Have Been Moved</span></span>](#0.1__Toc256770156 "_Toc256770156")  
[<span data-ttu-id="08f8a-123">Изменения кэширования выходных данных в разные \* заголовке HTTP</span><span class="sxs-lookup"><span data-stu-id="08f8a-123">Output Caching Changes to Vary \* HTTP Header</span></span>](#0.1__Toc256770157 "_Toc256770157")  
[<span data-ttu-id="08f8a-124">Устаревшие типы System. Web. Security для паспорта</span><span class="sxs-lookup"><span data-stu-id="08f8a-124">System.Web.Security Types for Passport are Obsolete</span></span>](#0.1__Toc256770158 "_Toc256770158")  
[<span data-ttu-id="08f8a-125">Свойство MenuItem. Попаутимажеурл не может обработать изображение в ASP.NET 4</span><span class="sxs-lookup"><span data-stu-id="08f8a-125">The MenuItem.PopOutImageUrl Property Fails to Render an Image in ASP.NET 4</span></span>](#0.1__Toc256770159 "_Toc256770159")  
[<span data-ttu-id="08f8a-126">Menu. Статикпопаутимажеурл и Menu. Динамикпопаутимажеурл не могут визуализировать изображения, если пути содержат символы обратной косой черты</span><span class="sxs-lookup"><span data-stu-id="08f8a-126">Menu.StaticPopOutImageUrl and Menu.DynamicPopOutImageUrl Fail to Render Images When Paths Contain Backslashes</span></span>](#0.1__Toc256770160 "_Toc256770160")  
[<span data-ttu-id="08f8a-127">Заявление об отказе</span><span class="sxs-lookup"><span data-stu-id="08f8a-127">Disclaimer</span></span>](#0.1__Toc256770161 "_Toc256770161")

<a id="0.1__ControlRenderingCompatibilityVersio"></a><a id="0.1__Toc245724853"></a><a id="0.1__Toc255587630"></a><a id="0.1__Toc256770141"></a>

## <a name="controlrenderingcompatibilityversion-setting-in-the-webconfig-file"></a><span data-ttu-id="08f8a-128">Параметр Контролрендерингкомпатибилитиверсион в файле Web. config</span><span class="sxs-lookup"><span data-stu-id="08f8a-128">ControlRenderingCompatibilityVersion Setting in the Web.config File</span></span>

<span data-ttu-id="08f8a-129">Элементы управления ASP.NET были изменены в .NET Framework версии 4, что позволяет указать более точное отображение разметки.</span><span class="sxs-lookup"><span data-stu-id="08f8a-129">ASP.NET controls have been modified in the .NET Framework version 4 in order to let you specify more precisely how they render markup.</span></span> <span data-ttu-id="08f8a-130">В предыдущих версиях .NET Framework некоторые элементы управления порождены разметкой, которые не были бы отключены.</span><span class="sxs-lookup"><span data-stu-id="08f8a-130">In previous versions of the .NET Framework, some controls emitted markup that you had no way to disable.</span></span> <span data-ttu-id="08f8a-131">По умолчанию ASP.NET 4 этот тип разметки больше не создается.</span><span class="sxs-lookup"><span data-stu-id="08f8a-131">By default, ASP.NET 4 this type of markup is no longer generated.</span></span>

<span data-ttu-id="08f8a-132">Если вы используете Visual Studio 2010 для обновления приложения с ASP.NET 2,0 или ASP.NET 3,5, средство автоматически добавляет параметр в файл `Web.config`, который сохраняет устаревшую визуализацию.</span><span class="sxs-lookup"><span data-stu-id="08f8a-132">If you use Visual Studio 2010 to upgrade your application from ASP.NET 2.0 or ASP.NET 3.5, the tool automatically adds a setting to the `Web.config` file that preserves legacy rendering.</span></span> <span data-ttu-id="08f8a-133">Однако если вы обновляете приложение путем изменения пула приложений в IIS, задавая .NET Framework 4 как целевую платформу, ASP.NET использует новый режим отрисовки по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="08f8a-133">However, if you upgrade an application by changing the application pool in IIS to target the .NET Framework 4, ASP.NET uses the new rendering mode by default.</span></span> <span data-ttu-id="08f8a-134">Чтобы отключить новый режим рендеринга, добавьте следующий параметр в файл `Web.config`:</span><span class="sxs-lookup"><span data-stu-id="08f8a-134">To disable the new rendering mode, add the following setting in the `Web.config` file:</span></span>

[!code-xml[Main](breaking-changes/samples/sample1.xml)]

<span data-ttu-id="08f8a-135">Основная визуализация приводит к изменению нового поведения:</span><span class="sxs-lookup"><span data-stu-id="08f8a-135">The major rendering changes that the new behavior brings are as follows:</span></span>

- <span data-ttu-id="08f8a-136">Элементы управления **Image** и **ImageButton** больше не отображают атрибут `border="0"`.</span><span class="sxs-lookup"><span data-stu-id="08f8a-136">The **Image** and **ImageButton** controls no longer render a `border="0"` attribute.</span></span>
- <span data-ttu-id="08f8a-137">Класс **BaseValidator** и элементы управления проверки, производные от него, больше не отображают красный текст по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="08f8a-137">The **BaseValidator** class and validation controls that derive from it no longer render red text by default.</span></span>
- <span data-ttu-id="08f8a-138">Элемент управления **HtmlForm** не отображает атрибут **Name** .</span><span class="sxs-lookup"><span data-stu-id="08f8a-138">The **HtmlForm** control does not render a **name** attribute.</span></span>
- <span data-ttu-id="08f8a-139">Элемент управления " **Таблица** " больше не отображает `border="0"` атрибут.</span><span class="sxs-lookup"><span data-stu-id="08f8a-139">The **Table** control no longer renders a `border="0"` attribute.</span></span>
- <span data-ttu-id="08f8a-140">Элементы управления, не предназначенные для ввода данных пользователем (например, элемент управления **Label** ), больше не отображают атрибут `disabled="disabled"`, если их свойство **Enabled** имеет значение **false** (или если они наследуют этот параметр от элемента управления контейнера).</span><span class="sxs-lookup"><span data-stu-id="08f8a-140">Controls that are not designed for user input (for example, the **Label** control) no longer render the `disabled="disabled"` attribute if their **Enabled** property is set to **false** (or if they inherit this setting from a container control).</span></span>

<a id="0.1__Toc245724854"></a><a id="0.1__Toc255587631"></a><a id="0.1__Toc256770142"></a>

## <a name="clientidmode-changes"></a><span data-ttu-id="08f8a-141">ClientIDMode изменения</span><span class="sxs-lookup"><span data-stu-id="08f8a-141">ClientIDMode Changes</span></span>

<span data-ttu-id="08f8a-142">Параметр **ClientIDMode** в ASP.NET 4 позволяет указать, как ASP.NET создает атрибут **ID** для элементов HTML.</span><span class="sxs-lookup"><span data-stu-id="08f8a-142">The **ClientIDMode** setting in ASP.NET 4 lets you specify how ASP.NET generates the **id** attribute for HTML elements.</span></span> <span data-ttu-id="08f8a-143">В предыдущих версиях ASP.NET поведение по умолчанию было эквивалентно значению **AutoID** параметра **ClientIDMode**.</span><span class="sxs-lookup"><span data-stu-id="08f8a-143">In previous versions of ASP.NET, the default behavior was equivalent to the **AutoID** setting of **ClientIDMode**.</span></span> <span data-ttu-id="08f8a-144">Однако параметр по умолчанию теперь является **прогнозируемым**.</span><span class="sxs-lookup"><span data-stu-id="08f8a-144">However, the default setting is now **Predictable**.</span></span>

<span data-ttu-id="08f8a-145">Если вы используете Visual Studio 2010 для обновления приложения с ASP.NET 2,0 или ASP.NET 3,5, средство автоматически добавляет параметр в файл `Web.config`, сохраняющий поведение более ранних версий .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="08f8a-145">If you use Visual Studio 2010 to upgrade your application from ASP.NET 2.0 or ASP.NET 3.5, the tool automatically adds a setting to the `Web.config` file that preserves the behavior of earlier versions of the .NET Framework.</span></span> <span data-ttu-id="08f8a-146">Однако если вы обновляете приложение путем изменения пула приложения в IIS, задавая .NET Framework 4 как целевую платформу, ASP.NET использует новый режим по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="08f8a-146">However, if you upgrade an application by changing the application pool in IIS to target the .NET Framework 4, ASP.NET uses the new mode by default.</span></span> <span data-ttu-id="08f8a-147">Чтобы отключить новый режим идентификатора клиента, добавьте следующий параметр в файл `Web.config`:</span><span class="sxs-lookup"><span data-stu-id="08f8a-147">To disable the new client ID mode, add the following setting in the `Web.config` file:</span></span>

[!code-xml[Main](breaking-changes/samples/sample2.xml)]

<a id="0.1__Toc245724855"></a><a id="0.1__Toc255587632"></a><a id="0.1__Toc256770143"></a>

## <a name="htmlencode-and-urlencode-now-encode-single-quotation-marks"></a><span data-ttu-id="08f8a-148">HtmlEncode и UrlEncode теперь кодируются одинарные кавычки</span><span class="sxs-lookup"><span data-stu-id="08f8a-148">HtmlEncode and UrlEncode Now Encode Single Quotation Marks</span></span>

<span data-ttu-id="08f8a-149">В ASP.NET 4 методы **HtmlEncode** и **UrlEncode** классов **HttpUtility** и **HttpServerUtility** были обновлены для кодирования символа одинарной кавычки (') следующим образом:</span><span class="sxs-lookup"><span data-stu-id="08f8a-149">In ASP.NET 4, the **HtmlEncode** and **UrlEncode** methods of the **HttpUtility** and **HttpServerUtility** classes have been updated to encode the single quotation mark character (') as follows:</span></span>

- <span data-ttu-id="08f8a-150">Метод **HtmlEncode** кодирует экземпляры одинарной кавычки как.</span><span class="sxs-lookup"><span data-stu-id="08f8a-150">The **HtmlEncode** method encodes instances of the single quotation mark as ' .</span></span>
- <span data-ttu-id="08f8a-151">Метод **UrlEncode** кодирует экземпляры одинарной кавычки как %27.</span><span class="sxs-lookup"><span data-stu-id="08f8a-151">The **UrlEncode** method encodes instances of the single quotation mark as %27.</span></span>

<a id="0.1__Toc255587633"></a><a id="0.1__Toc256770144"></a><a id="0.1__Toc245724856"></a>

## <a name="aspnet-page-aspx-parser-is-stricter"></a><span data-ttu-id="08f8a-152">Средство синтаксического анализа страницы ASP.NET (. aspx) является более четким</span><span class="sxs-lookup"><span data-stu-id="08f8a-152">ASP.NET Page (.aspx) Parser is Stricter</span></span>

<span data-ttu-id="08f8a-153">Синтаксический анализатор страниц для страниц ASP.NET (файлов`.aspx`) и пользовательских элементов управления (`.ascx` файлов) является более чем в ASP.NET 4 и будет отклонять больше экземпляров недопустимой разметки.</span><span class="sxs-lookup"><span data-stu-id="08f8a-153">The page parser for ASP.NET pages (`.aspx` files) and user controls (`.ascx` files) is stricter in ASP.NET 4 and will reject more instances of invalid markup.</span></span> <span data-ttu-id="08f8a-154">Например, следующие два фрагмента кода успешно анализируются в предыдущих выпусках ASP.NET, но теперь будут вызывать ошибки синтаксического анализатора в ASP.NET 4.</span><span class="sxs-lookup"><span data-stu-id="08f8a-154">For example, the following two snippets would successfully parse in earlier releases of ASP.NET, but will now raise parser errors in ASP.NET 4.</span></span>

[!code-aspx[Main](breaking-changes/samples/sample3.aspx)]

<span data-ttu-id="08f8a-155">Обратите внимание на неправильную точку с запятой в конце тега **HiddenField** .</span><span class="sxs-lookup"><span data-stu-id="08f8a-155">Notice the invalid semicolon at the end of the **HiddenField** tag.</span></span>

[!code-aspx[Main](breaking-changes/samples/sample4.aspx)]

<span data-ttu-id="08f8a-156">Обратите внимание на незакрытый атрибут **стиля** , который выполняется в атрибуте **CssClass** .</span><span class="sxs-lookup"><span data-stu-id="08f8a-156">Notice the unclosed **style** attribute that runs into the **CssClass** attribute.</span></span>

<a id="0.1__Toc255587634"></a><a id="0.1__Toc256770145"></a>

## <a name="browser-definition-files-updated"></a><span data-ttu-id="08f8a-157">Обновлены файлы определения браузера</span><span class="sxs-lookup"><span data-stu-id="08f8a-157">Browser Definition Files Updated</span></span>

<span data-ttu-id="08f8a-158">Файлы описания браузеров обновлены: теперь они включают сведения о новых и обновленных браузерах и устройствах.</span><span class="sxs-lookup"><span data-stu-id="08f8a-158">The browser definition files have been updated to include information about new and updated browsers and devices.</span></span> <span data-ttu-id="08f8a-159">Устаревшие браузеры и устройства (например, Netscape Navigator) удалены; добавлены новые браузеры и устройства (например, Google Chrome и Apple iPhone).</span><span class="sxs-lookup"><span data-stu-id="08f8a-159">Older browsers and devices such as Netscape Navigator have been removed, and newer browsers and devices such as Google Chrome and Apple iPhone have been added.</span></span>

<span data-ttu-id="08f8a-160">Если ваше приложение содержит пользовательские описания браузеров, унаследованные от одного из удаленных описаний браузеров, произойдет ошибка.</span><span class="sxs-lookup"><span data-stu-id="08f8a-160">If your application contains custom browser definitions that inherit from one of the browser definitions that have been removed, you will see an error.</span></span> <span data-ttu-id="08f8a-161">Например, если папка `App_Browsers` содержит определение браузера, наследуемое от определения браузера IE2, вы получите следующее сообщение об ошибке конфигурации:</span><span class="sxs-lookup"><span data-stu-id="08f8a-161">For example, if the `App_Browsers` folder contains a browser definition that inherits from the IE2 browser definition, you will receive the following configuration error message:</span></span>

- <span data-ttu-id="08f8a-162">Не удается найти элемент браузера или шлюза с ИДЕНТИФИКАТОРом "IE2".</span><span class="sxs-lookup"><span data-stu-id="08f8a-162">The browser or gateway element with ID 'IE2' cannot be found.</span></span>

> [!NOTE]
> <span data-ttu-id="08f8a-163">Объект **хттпбровсеркапабилитиес** (который предоставляется свойством **request. browser** страницы) определяется файлами определений браузера.</span><span class="sxs-lookup"><span data-stu-id="08f8a-163">The **HttpBrowserCapabilities** object (which is exposed by the page's **Request.Browser** property) is driven by the browser definitions files.</span></span> <span data-ttu-id="08f8a-164">Поэтому сведения, возвращаемые при доступе к свойству этого объекта в ASP.NET 4, могут отличаться от данных, возвращаемых в более ранней версии ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="08f8a-164">Therefore, the information returned by accessing a property of this object in ASP.NET 4 might be different than the information returned in an earlier version of ASP.NET.</span></span>

<span data-ttu-id="08f8a-165">Можно вернуться к старым файлам определения браузера, скопировав файлы определения браузера из следующей папки:</span><span class="sxs-lookup"><span data-stu-id="08f8a-165">You can revert to the old browser definition files by copying the browser definition files from the following folder:</span></span>

[!code-console[Main](breaking-changes/samples/sample5.cmd)]

<span data-ttu-id="08f8a-166">Скопируйте файлы в соответствующую папку `\CONFIG\Browsers` для ASP.NET 4.</span><span class="sxs-lookup"><span data-stu-id="08f8a-166">Copy the files into the corresponding `\CONFIG\Browsers` folder for ASP.NET 4.</span></span> <span data-ttu-id="08f8a-167">После копирования файлов запустите программу командной строки ASPNET\_регбровсерс. exe.</span><span class="sxs-lookup"><span data-stu-id="08f8a-167">After you copy the files, run the Aspnet\_regbrowsers.exe command-line tool.</span></span>

<a id="0.1__Toc255587635"></a><a id="0.1__Toc256770146"></a>

## <a name="systemwebmobiledll-removed-from-root-web-configuration-file"></a><span data-ttu-id="08f8a-168">System. Web. Mobile. dll удален из корневого файла веб-конфигурации</span><span class="sxs-lookup"><span data-stu-id="08f8a-168">System.Web.Mobile.dll Removed from Root Web Configuration File</span></span>

<span data-ttu-id="08f8a-169">В предыдущих версиях ASP.NET ссылка на сборку System. Web. Mobile. dll была включена в корневой файл `Web.config` в разделе " **сборки** " раздела.</span><span class="sxs-lookup"><span data-stu-id="08f8a-169">In previous versions of ASP.NET, a reference to the System.Web.Mobile.dll assembly was included in the root `Web.config` file in the **assemblies** section under.</span></span> <span data-ttu-id="08f8a-170">Для повышения производительности ссылка на эту сборку была удалена.</span><span class="sxs-lookup"><span data-stu-id="08f8a-170">In order to improve performance, the reference to this assembly was removed.</span></span>

<span data-ttu-id="08f8a-171">Сборка System. Web. Mobile. DLL включена в ASP.NET 4, но она является устаревшей.</span><span class="sxs-lookup"><span data-stu-id="08f8a-171">The System.Web.Mobile.dll assembly is included in ASP.NET 4, but it is deprecated.</span></span> <span data-ttu-id="08f8a-172">Если вы хотите использовать типы из сборки System. Web. Mobile. dll, добавьте ссылку на эту сборку либо в корневой `Web.config` файл, либо в файл приложения `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="08f8a-172">If you want to use types from the System.Web.Mobile.dll assembly, add a reference to this assembly to either the root `Web.config` file or to an application `Web.config` file.</span></span> <span data-ttu-id="08f8a-173">Например, если вы хотите использовать любые из ASP.NET мобильных элементов управления (не рекомендуется), необходимо добавить ссылку на сборку System. Web. Mobile. dll в файл `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="08f8a-173">For example, if you want to use any of the (deprecated) ASP.NET mobile controls, you must add a reference to the System.Web.Mobile.dll assembly to the `Web.config` file.</span></span>

<a id="0.1__Toc245724857"></a><a id="0.1__Toc255587636"></a><a id="0.1__Toc256770147"></a>

## <a name="aspnet-request-validation"></a><span data-ttu-id="08f8a-174">Проверка запроса ASP.NET</span><span class="sxs-lookup"><span data-stu-id="08f8a-174">ASP.NET Request Validation</span></span>

<span data-ttu-id="08f8a-175">Функция проверки запросов в ASP.NET предоставляет определенный уровень защиты по умолчанию от атак с использованием межсайтовых сценариев (XSS).</span><span class="sxs-lookup"><span data-stu-id="08f8a-175">The request validation feature in ASP.NET provides a certain level of default protection against cross-site scripting (XSS) attacks.</span></span> <span data-ttu-id="08f8a-176">В предыдущих версиях ASP.NET проверка запросов была включена по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="08f8a-176">In previous versions of ASP.NET, request validation was enabled by default.</span></span> <span data-ttu-id="08f8a-177">Однако он применяется только к ASP.NET страницам (файлы`.aspx` и их файлы классов) и только при выполнении этих страниц.</span><span class="sxs-lookup"><span data-stu-id="08f8a-177">However, it applied only to ASP.NET pages (`.aspx` files and their class files) and only when those pages were executing.</span></span>

<span data-ttu-id="08f8a-178">В ASP.NET 4 по умолчанию проверка запросов включена для всех запросов, так как она включена до фазы **beginRequest** HTTP-запроса.</span><span class="sxs-lookup"><span data-stu-id="08f8a-178">In ASP.NET 4, by default, request validation is enabled for all requests, because it is enabled before the **BeginRequest** phase of an HTTP request.</span></span> <span data-ttu-id="08f8a-179">В результате проверка запроса применяется к запросам всех ASP.NET ресурсов, а не только запросов страницы ASPX.</span><span class="sxs-lookup"><span data-stu-id="08f8a-179">As a result, request validation applies to requests for all ASP.NET resources, not just .aspx page requests.</span></span> <span data-ttu-id="08f8a-180">Сюда входят такие запросы, как вызовы веб-служб и пользовательские обработчики HTTP.</span><span class="sxs-lookup"><span data-stu-id="08f8a-180">This includes requests such as Web service calls and custom HTTP handlers.</span></span> <span data-ttu-id="08f8a-181">Проверка запросов также активна, когда пользовательские модули HTTP считывают содержимое HTTP-запроса.</span><span class="sxs-lookup"><span data-stu-id="08f8a-181">Request validation is also active when custom HTTP modules are reading the contents of an HTTP request.</span></span>

<span data-ttu-id="08f8a-182">В результате ошибки проверки запросов теперь могут возникать для запросов, которые ранее не активировали ошибки.</span><span class="sxs-lookup"><span data-stu-id="08f8a-182">As a result, request validation errors might now occur for requests that previously did not trigger errors.</span></span> <span data-ttu-id="08f8a-183">Чтобы вернуться к поведению функции проверки запросов ASP.NET 2,0, добавьте следующий параметр в файл `Web.config`:</span><span class="sxs-lookup"><span data-stu-id="08f8a-183">To revert to the behavior of the ASP.NET 2.0 request validation feature, add the following setting in the `Web.config` file:</span></span>

[!code-xml[Main](breaking-changes/samples/sample6.xml)]

<span data-ttu-id="08f8a-184">Однако рекомендуется проанализировать все ошибки проверки запросов, чтобы определить, будут ли существующие обработчики, модули или другие пользовательские коды получать доступ к потенциально небезопасным входным данным HTTP, которые могут быть векторами атаки XSS.</span><span class="sxs-lookup"><span data-stu-id="08f8a-184">However, we recommend that you analyze any request validation errors to determine whether existing handlers, modules, or other custom code accesses potentially unsafe HTTP inputs that could be XSS attack vectors.</span></span>

<a id="0.1__Toc245724858"></a><a id="0.1__Toc255587637"></a><a id="0.1__Toc256770148"></a>

## <a name="default-hashing-algorithm-is-now-hmacsha256"></a><span data-ttu-id="08f8a-185">Алгоритм хэширования по умолчанию теперь HMACSHA256</span><span class="sxs-lookup"><span data-stu-id="08f8a-185">Default Hashing Algorithm Is Now HMACSHA256</span></span>

<span data-ttu-id="08f8a-186">ASP.NET использует как алгоритм шифрования, так и алгоритм хэширования для обеспечения безопасности данных, например файлов cookie проверки подлинности форм и состояния просмотра.</span><span class="sxs-lookup"><span data-stu-id="08f8a-186">ASP.NET uses both encryption and hashing algorithms to help secure data such as forms authentication cookies and view state.</span></span> <span data-ttu-id="08f8a-187">По умолчанию ASP.NET 4 теперь использует алгоритм HMACSHA256 для операций хэширования с файлами cookie и состоянием просмотра.</span><span class="sxs-lookup"><span data-stu-id="08f8a-187">By default, ASP.NET 4 now uses the HMACSHA256 algorithm for hash operations on cookies and view state.</span></span> <span data-ttu-id="08f8a-188">Более ранние версии ASP.NET использовали старый алгоритм HMACSHA1.</span><span class="sxs-lookup"><span data-stu-id="08f8a-188">Earlier versions of ASP.NET used the older HMACSHA1 algorithm.</span></span>

<span data-ttu-id="08f8a-189">Приложения могут быть затронуты при запуске смешанных сред ASP.NET 2.0/ASP. NET 4, где данные, такие как файлы cookie проверки подлинности форм, должны работать с версиями across.NET Framework.</span><span class="sxs-lookup"><span data-stu-id="08f8a-189">Your applications might be affected if you run mixed ASP.NET 2.0/ASP.NET 4 environments where data such as forms authentication cookies must work across.NET Framework versions.</span></span> <span data-ttu-id="08f8a-190">Чтобы настроить веб-приложение ASP.NET 4 для использования старого алгоритма HMACSHA1, добавьте следующий параметр в файл `Web.config`:</span><span class="sxs-lookup"><span data-stu-id="08f8a-190">To configure an ASP.NET 4 Web application to use the older HMACSHA1 algorithm, add the following setting in the `Web.config` file:</span></span>

[!code-xml[Main](breaking-changes/samples/sample7.xml)]

<a id="0.1__Toc245724859"></a><a id="0.1__Toc255587638"></a><a id="0.1__Toc256770149"></a>

## <a name="configuration-errors-related-to-new-aspnet-4-root-configuration"></a><span data-ttu-id="08f8a-191">Ошибки конфигурации, связанные с новой корневой конфигурацией ASP.NET 4</span><span class="sxs-lookup"><span data-stu-id="08f8a-191">Configuration Errors Related to New ASP.NET 4 Root Configuration</span></span>

<span data-ttu-id="08f8a-192">Корневые файлы конфигурации (файл `machine.config` и корневой `Web.config` файл) для .NET Framework 4 (и, следовательно, ASP.NET 4) были обновлены для включения большинства стандартных сведений о конфигурации, которые в ASP.NET 3,5 были найдены в файлах приложения `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="08f8a-192">The root configuration files (the `machine.config` file and the root `Web.config` file) for the .NET Framework 4 (and therefore ASP.NET 4) have been updated to include most of the boilerplate configuration information that in ASP.NET 3.5 was found in the application `Web.config` files.</span></span> <span data-ttu-id="08f8a-193">Из-за сложности управляемых систем конфигурации IIS 7 и IIS 7,5 Запуск приложений ASP.NET 3,5 в ASP.NET 4 и IIS 7 и IIS 7,5 может привести к ошибкам конфигурации ASP.NET или IIS.</span><span class="sxs-lookup"><span data-stu-id="08f8a-193">Because of the complexity of the managed IIS 7 and IIS 7.5 configuration systems, running ASP.NET 3.5 applications under ASP.NET 4 and under IIS 7 and IIS 7.5 can result in either ASP.NET or IIS configuration errors.</span></span>

<span data-ttu-id="08f8a-194">Рекомендуется обновить приложения ASP.NET 3,5 до ASP.NET 4 с помощью средств обновления проектов в Visual Studio 2010, если это возможно.</span><span class="sxs-lookup"><span data-stu-id="08f8a-194">We recommend that you upgrade ASP.NET 3.5 applications to ASP.NET 4 by using the project upgrade tools in Visual Studio 2010, if practical.</span></span> <span data-ttu-id="08f8a-195">Visual Studio 2010 автоматически изменяет файл `Web.config` приложения ASP.NET 3,5, чтобы он содержал соответствующие параметры для ASP.NET 4.</span><span class="sxs-lookup"><span data-stu-id="08f8a-195">Visual Studio 2010 automatically modifies the ASP.NET 3.5 application's `Web.config` file to contain the appropriate settings for ASP.NET 4.</span></span>

<span data-ttu-id="08f8a-196">Однако это поддерживаемый сценарий для запуска приложений ASP.NET 3,5 с помощью .NET Framework 4 без перекомпиляции.</span><span class="sxs-lookup"><span data-stu-id="08f8a-196">However, it is a supported scenario to run ASP.NET 3.5 applications using the .NET Framework 4 without recompilation.</span></span> <span data-ttu-id="08f8a-197">В этом случае может потребоваться вручную изменить файл `Web.config` приложения перед запуском приложения в .NET Framework 4 и IIS 7 или IIS 7,5.</span><span class="sxs-lookup"><span data-stu-id="08f8a-197">In that case, you might have to manually modify the application's `Web.config` file before you run the application under the .NET Framework 4 and under IIS 7 or IIS 7.5.</span></span>

<span data-ttu-id="08f8a-198">В следующих двух разделах описаны изменения, которые могут потребоваться для различных сочетаний программного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="08f8a-198">The next two sections describe changes that you might need to make for different combinations of software.</span></span>

<span data-ttu-id="08f8a-199">**Windows Vista SP1 или Windows Server 2008 с пакетом обновления 1 (SP1), где не установлены исправления KB958854 и SP2.**</span><span class="sxs-lookup"><span data-stu-id="08f8a-199">**Windows Vista SP1 or Windows Server 2008 SP1, where neither hotfix KB958854 nor SP2 are installed.**</span></span> <span data-ttu-id="08f8a-200">В этой конфигурации система настройки IIS 7 неправильно объединяет управляемую конфигурацию приложения путем сравнения файла `Web.config` уровня приложения с файлами `machine.config` ASP.NET 2,0.</span><span class="sxs-lookup"><span data-stu-id="08f8a-200">In this configuration, the IIS 7 configuration system incorrectly merges an application's managed configuration by comparing the application-level `Web.config` file to the ASP.NET 2.0 `machine.config` files.</span></span> <span data-ttu-id="08f8a-201">По этой причине файлы `Web.config` уровня приложения из .NET Framework 3,5 или более поздней версии должны иметь определение раздела конфигурации **System. Web. Extensions** (элемент), чтобы не привести к СБОЮ проверки IIS 7.</span><span class="sxs-lookup"><span data-stu-id="08f8a-201">Because of this, application-level `Web.config` files from the .NET Framework 3.5 or later must have a **system.web.extensions** configuration section definition (the element) in order not to cause an IIS 7 validation failure.</span></span>

<span data-ttu-id="08f8a-202">Однако вручную измененные записи файлов `Web.config` уровня приложения, которые не точно соответствуют исходным определениям разделов конфигурации, появившимся в Visual Studio 2008, приведут к ошибкам конфигурации ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="08f8a-202">However, manually modified application-level `Web.config` file entries that do not precisely match the original boilerplate configuration section definitions that were introduced with Visual Studio 2008 will cause ASP.NET configuration errors.</span></span> <span data-ttu-id="08f8a-203">(Записи конфигурации по умолчанию, создаваемые Visual Studio 2008, работают правильно.) Распространенная проблема заключается в том, что вручную измененные `Web.config` файлы оставляют атрибуты конфигурации **allowDefinition** и **рекуирепермиссион** , которые находятся в различных определениях разделов конфигурации.</span><span class="sxs-lookup"><span data-stu-id="08f8a-203">(The default configuration entries that are generated by Visual Studio 2008 work correctly.) A common problem is that manually modified `Web.config` files leave out the **allowDefinition** and **requirePermission** configuration attributes that are found on various configuration section definitions.</span></span> <span data-ttu-id="08f8a-204">Это вызовет несоответствие между сокращенным разделом конфигурации в файлах `Web.config` уровня приложения и полным определением в файле `machine.config` ASP.NET 4.</span><span class="sxs-lookup"><span data-stu-id="08f8a-204">This causes a mismatch between the abbreviated configuration section in application-level `Web.config` files and the complete definition in the ASP.NET 4 `machine.config` file.</span></span> <span data-ttu-id="08f8a-205">В результате во время выполнения система конфигурации ASP.NET 4 вызывает ошибку конфигурации.</span><span class="sxs-lookup"><span data-stu-id="08f8a-205">As a result, at run time, the ASP.NET 4 configuration system throws a configuration error.</span></span>

<span data-ttu-id="08f8a-206">**Windows Vista SP2, Windows Server 2008 SP2, Windows 7, Windows Server 2008 R2, а также Windows Vista SP1 и Windows Server 2008 с пакетом обновления 1 (SP1), где установлено исправление KB958854.**</span><span class="sxs-lookup"><span data-stu-id="08f8a-206">**Windows Vista SP2, Windows Server 2008 SP2, Windows 7, Windows Server 2008 R2, and also Windows Vista SP1 and Windows Server 2008 SP1 where hotfix KB958854 is installed.**</span></span>

<span data-ttu-id="08f8a-207">В этом сценарии собственная система конфигурации IIS 7 и IIS 7,5 возвращает ошибку конфигурации, так как выполняет сравнение текста в атрибуте **типа** , определенном для обработчика управляемого раздела конфигурации.</span><span class="sxs-lookup"><span data-stu-id="08f8a-207">In this scenario, the IIS 7 and IIS 7.5 native configuration system returns a configuration error because it performs a text comparison on the **type** attribute that is defined for a managed configuration section handler.</span></span> <span data-ttu-id="08f8a-208">Поскольку все `Web.config` файлы, создаваемые Visual Studio 2008 и Visual Studio 2008 с пакетом обновления 1 (SP1), имеют "3,5" в строке типа для системы. обработчики разделов конфигурации **Web. Extensions** (и связанные), а так как файл ASP.NET 4 `machine.config` содержит "4,0" в атрибуте **Type** для тех же обработчиков разделов конфигурации, приложения, созданные в Visual Studio 2008 или Visual Studio 2008 SP1, всегда не проходят проверку конфигурации в iis 7 и IIS 7,5.</span><span class="sxs-lookup"><span data-stu-id="08f8a-208">Because all `Web.config` files that are generated by Visual Studio 2008 and Visual Studio 2008 SP1 have "3.5" in the type string for the **system.web.extensions** (and related) configuration section handlers, and because the ASP.NET 4 `machine.config` file has "4.0" in the **type** attribute for the same configuration section handlers, applications that are generated in Visual Studio 2008 or Visual Studio 2008 SP1 always fail configuration validation in IIS 7 and IIS 7.5.</span></span>

<a id="0.1__Toc251910248"></a>

### <a name="resolving-these-issues"></a><span data-ttu-id="08f8a-209">Устранение этих проблем</span><span class="sxs-lookup"><span data-stu-id="08f8a-209">Resolving These Issues</span></span>

<span data-ttu-id="08f8a-210">Обходной путь для первого сценария заключается в обновлении файла `Web.config` уровня приложения путем включения стандартного текста конфигурации из файла `Web.config`, который был автоматически создан Visual Studio 2008.</span><span class="sxs-lookup"><span data-stu-id="08f8a-210">The workaround for the first scenario is to update the application-level `Web.config` file by including the boilerplate configuration text from a `Web.config` file that was generated automatically by Visual Studio 2008.</span></span>

<span data-ttu-id="08f8a-211">Альтернативным решением для первого сценария является установка пакета обновления 2 (SP2) для Vista или Windows Server 2008 на компьютере или установка исправления KB958854 ([https://support.microsoft.com/kb/958854](https://support.microsoft.com/kb/958854)) для исправления неправильного поведения при слиянии конфигурации в системе конфигурации IIS.</span><span class="sxs-lookup"><span data-stu-id="08f8a-211">An alternative workaround for the first scenario is to install Service Pack 2 for Vista or Windows Server 2008 on your computer or to install hotfix KB958854 ([https://support.microsoft.com/kb/958854](https://support.microsoft.com/kb/958854)) to fix the incorrect configuration-merge behavior of the IIS configuration system.</span></span> <span data-ttu-id="08f8a-212">Однако после выполнения любого из этих действий приложение, скорее всего, будет столкнуться с ошибкой конфигурации из-за проблемы, описанной во втором сценарии.</span><span class="sxs-lookup"><span data-stu-id="08f8a-212">However, after you perform either of these actions, your application will likely encounter a configuration error due to the issue described for the second scenario.</span></span>

<span data-ttu-id="08f8a-213">Чтобы устранить проблему во втором сценарии, удалите или закомментируйте все определения разделов конфигурации **System. Web. Extensions** и определений групп разделов конфигурации из файла `Web.config` уровня приложения.</span><span class="sxs-lookup"><span data-stu-id="08f8a-213">The workaround for the second scenario is to delete or comment out all the **system.web.extensions** configuration section definitions and configuration section group definitions from the application-level `Web.config` file.</span></span> <span data-ttu-id="08f8a-214">Эти определения обычно находятся в начале файла `Web.config` уровня приложения и могут быть идентифицированы элементом **configSections** и его дочерними элементами.</span><span class="sxs-lookup"><span data-stu-id="08f8a-214">These definitions are usually at the top of the application-level `Web.config` file and can be identified by the **configSections** element and its children.</span></span>

<span data-ttu-id="08f8a-215">В обоих случаях рекомендуется вручную удалить раздел **System. CodeDom** , хотя это не является обязательным.</span><span class="sxs-lookup"><span data-stu-id="08f8a-215">For both scenarios, it is recommended that you also manually delete the **system.codedom** section, although this is not required.</span></span>

<a id="0.1__Toc252995490"></a><a id="0.1__Toc255587639"></a><a id="0.1__Toc256770150"></a><a id="0.1__Toc245724860"></a>

## <a name="aspnet-4-child-applications-fail-to-start-when-under-aspnet-20-or-aspnet-35-applications"></a><span data-ttu-id="08f8a-216">Не удается запустить дочерние приложения ASP.NET 4 при использовании приложений ASP.NET 2,0 или ASP.NET 3,5</span><span class="sxs-lookup"><span data-stu-id="08f8a-216">ASP.NET 4 Child Applications Fail to Start When Under ASP.NET 2.0 or ASP.NET 3.5 Applications</span></span>

<span data-ttu-id="08f8a-217">Приложения ASP.NET 4, которые настроены как дочерние для приложений, использующих предыдущие версии ASP.NET, могут не запускаться из-за ошибок конфигурации или компиляции.</span><span class="sxs-lookup"><span data-stu-id="08f8a-217">ASP.NET 4 applications that are configured as children of applications that run earlier versions of ASP.NET might fail to start because of configuration or compilation errors.</span></span> <span data-ttu-id="08f8a-218">В следующем примере показана структура каталогов для затронутого приложения.</span><span class="sxs-lookup"><span data-stu-id="08f8a-218">The following example shows a directory structure for an affected application.</span></span>

<span data-ttu-id="08f8a-219">`/parentwebapp` (настроено для использования ASP.NET 2,0 или ASP.NET 3,5)</span><span class="sxs-lookup"><span data-stu-id="08f8a-219">`/parentwebapp` (configured to use ASP.NET 2.0 or ASP.NET 3.5)</span></span>  
<span data-ttu-id="08f8a-220">`/childwebapp` (настроено для использования ASP.NET 4)</span><span class="sxs-lookup"><span data-stu-id="08f8a-220">`/childwebapp` (configured to use ASP.NET 4)</span></span>

<span data-ttu-id="08f8a-221">Приложение в папке `childwebapp` не сможет запуститься в IIS 7 или IIS 7,5 и сообщит об ошибке конфигурации.</span><span class="sxs-lookup"><span data-stu-id="08f8a-221">The application in the `childwebapp` folder will fail to start on IIS 7 or IIS 7.5 and will report a configuration error.</span></span> <span data-ttu-id="08f8a-222">Текст ошибки будет содержать примерно следующее сообщение:</span><span class="sxs-lookup"><span data-stu-id="08f8a-222">The error text will include a message similar to the following:</span></span>

- `The requested page cannot be accessed because the related configuration data for the page is invalid.`

- `The configuration section 'configSections' cannot be read because it is missing a section declaration.`

<span data-ttu-id="08f8a-223">В IIS 6 приложение в папке `childwebapp` также не запускается, но будет сообщать о другой ошибке.</span><span class="sxs-lookup"><span data-stu-id="08f8a-223">On IIS 6, the application in the `childwebapp` folder will also fail to start, but it will report a different error.</span></span> <span data-ttu-id="08f8a-224">Например, текст ошибки может иметь следующий статус:</span><span class="sxs-lookup"><span data-stu-id="08f8a-224">For example, the error text might state the following:</span></span>

- `The value for the 'compilerVersion' attribute in the provider options must be 'v4.0' or later if you are compiling for version 4.0 or later of the .NET Framework. To compile this Web application for version 3.5 or earlier of the .NET Framework, remove the 'targetFramework' attribute from the element of the Web.config file`

<span data-ttu-id="08f8a-225">Эти сценарии возникают из-за того, что сведения о конфигурации из родительского приложения в папке `parentwebapp` являются частью иерархии сведений о конфигурации, которая определяет окончательные Объединенные параметры конфигурации, используемые дочерним веб-приложением в папке `childwebapp`.</span><span class="sxs-lookup"><span data-stu-id="08f8a-225">These scenarios occur because the configuration information from the parent application in the `parentwebapp` folder is part of the hierarchy of configuration information that determines the final merged configuration settings that are used by the child web application in the `childwebapp` folder.</span></span> <span data-ttu-id="08f8a-226">В зависимости от того, работает ли веб-приложение ASP.NET 4 в службах IIS 7 (или IIS 7,5) или в IIS 6, либо система настройки IIS, либо система компиляции ASP.NET 4 будут возвращать ошибку.</span><span class="sxs-lookup"><span data-stu-id="08f8a-226">Depending on whether the ASP.NET 4 Web application is running on IIS 7 (or IIS 7.5) or on IIS 6, either the IIS configuration system or the ASP.NET 4 compilation system will return an error.</span></span>

<span data-ttu-id="08f8a-227">Действия, которые необходимо выполнить для устранения этой проблемы и получения дочернего приложения ASP.NET 4, зависят от того, работает ли приложение ASP.NET 4 в IIS 6 или IIS 7 (или IIS 7,5).</span><span class="sxs-lookup"><span data-stu-id="08f8a-227">The steps that you must follow to resolve this issue and to get the child ASP.NET 4 application to work depend on whether the ASP.NET 4 application runs on IIS 6 or on IIS 7 (or IIS 7.5).</span></span>

### <a name="step-1-iis-7-or-iis-75-only"></a><span data-ttu-id="08f8a-228">Шаг 1 (только для IIS 7 или IIS 7,5)</span><span class="sxs-lookup"><span data-stu-id="08f8a-228">Step 1 (IIS 7 or IIS 7.5 only)</span></span>

<span data-ttu-id="08f8a-229">Этот шаг необходим только в операционных системах, где работают службы IIS 7 или IIS 7,5, включая Windows Vista, Windows Server 2008, Windows 7 и Windows Server 2008 R2.</span><span class="sxs-lookup"><span data-stu-id="08f8a-229">This step is necessary only on operating systems that run IIS 7 or IIS 7.5, which includes Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2.</span></span>

<span data-ttu-id="08f8a-230">Переместите определение **configSections** в файл `Web.config` родительского приложения (приложение, которое работает под управлением ASP.NET 2,0 или ASP.NET 3,5) в корневой файл `Web.config` для the.NET Framework 2,0.</span><span class="sxs-lookup"><span data-stu-id="08f8a-230">Move the **configSections** definition in the `Web.config` file of the parent application (the application that runs ASP.NET 2.0 or ASP.NET 3.5) into the root `Web.config` file for the.NET Framework 2.0.</span></span> <span data-ttu-id="08f8a-231">Система IIS 7 и IIS 7,5 Native Configuration проверяет элемент **configSections** при слиянии иерархии файлов конфигурации.</span><span class="sxs-lookup"><span data-stu-id="08f8a-231">The IIS 7 and IIS 7.5 native configuration system scans the **configSections** element when it merges the hierarchy of configuration files.</span></span> <span data-ttu-id="08f8a-232">Перемещение определения **configSections** из файла `Web.config` родительского веб-приложения в корневой `Web.config` файл фактически скрывает элемент из процесса слияния конфигурации, который выполняется для дочернего приложения ASP.NET 4.</span><span class="sxs-lookup"><span data-stu-id="08f8a-232">Moving the **configSections** definition from the parent Web application's `Web.config` file to the root `Web.config` file effectively hides the element from the configuration merge process that occurs for the child ASP.NET 4 application.</span></span>

<span data-ttu-id="08f8a-233">В 32-разрядной операционной системе или в случае с 32-разрядным пулом приложений корневой `Web.config` файл для ASP.NET 2,0 и ASP.NET 3,5 обычно находится в следующей папке:</span><span class="sxs-lookup"><span data-stu-id="08f8a-233">On a 32-bit operating system or for 32-bit application pools, the root `Web.config` file for ASP.NET 2.0 and ASP.NET 3.5 is normally located in the following folder:</span></span>

`C:\Windows\Microsoft.NET\Framework\v2.0.50727\CONFIG`

<span data-ttu-id="08f8a-234">В 64-разрядной операционной системе или в случае с 64-разрядным пулом приложений корневой `Web.config` файл для ASP.NET 2,0 и ASP.NET 3,5 обычно находится в следующей папке:</span><span class="sxs-lookup"><span data-stu-id="08f8a-234">On a 64-bit operating system or for 64-bit application pools, the root `Web.config` file for ASP.NET 2.0 and ASP.NET 3.5 is normally located in the following folder:</span></span>

`C:\Windows\Microsoft.NET\Framework64\v2.0.50727\CONFIG`

<span data-ttu-id="08f8a-235">При запуске как 32-разрядных, так и 64-разрядных веб-приложений на 64-разрядном компьютере необходимо переместить элемент **configSections** в корневые `Web.config` файлы как для 32-разрядной, так и для 64-разрядной системы.</span><span class="sxs-lookup"><span data-stu-id="08f8a-235">If you run both 32-bit and 64-bit Web applications on a 64-bit computer, you must move the **configSections** element up into root `Web.config` files for both the 32-bit and the 64-bit systems.</span></span>

<span data-ttu-id="08f8a-236">Поместив элемент **configSections** в корневой `Web.config` файл, вставьте раздел сразу после элемента **Configuration** .</span><span class="sxs-lookup"><span data-stu-id="08f8a-236">When you put the **configSections** element in the root `Web.config` file, paste the section immediately after the **configuration** element.</span></span> <span data-ttu-id="08f8a-237">В следующем примере показано, как верхняя часть корневого файла `Web.config` должна выглядеть после завершения перемещения элементов.</span><span class="sxs-lookup"><span data-stu-id="08f8a-237">The following example shows what the top portion of the root `Web.config` file should look like when you have finished moving the elements.</span></span>

> [!NOTE]
> <span data-ttu-id="08f8a-238">В следующем примере строки были перенесены для удобства чтения.</span><span class="sxs-lookup"><span data-stu-id="08f8a-238">In the following example, lines have been wrapped for readability.</span></span>

[!code-xml[Main](breaking-changes/samples/sample8.xml)]

### <a name="step-2-all-versions-of-iis"></a><span data-ttu-id="08f8a-239">Шаг 2 (все версии IIS)</span><span class="sxs-lookup"><span data-stu-id="08f8a-239">Step 2 (all versions of IIS)</span></span>

<span data-ttu-id="08f8a-240">Этот шаг необходим, если дочернее веб-приложение ASP.NET 4 работает в IIS 6 или IIS 7 (или IIS 7,5).</span><span class="sxs-lookup"><span data-stu-id="08f8a-240">This step is required whether the ASP.NET 4 child Web application is running on IIS 6 or on IIS 7 (or IIS 7.5).</span></span>

<span data-ttu-id="08f8a-241">В `Web.config`ном файле родительского веб-приложения, в котором выполняется ASP.NET 2 или ASP.NET 3,5, добавьте тег **Location** , который явно указывает (для систем конфигурации IIS и ASP.NET), что записи конфигурации применяются только к родительскому веб-приложению.</span><span class="sxs-lookup"><span data-stu-id="08f8a-241">In the `Web.config` file of the parent Web application that is running ASP.NET 2 or ASP.NET 3.5, add a **location** tag that explicitly specifies (for both the IIS and ASP.NET configuration systems) that the configuration entries only apply to the parent Web application.</span></span> <span data-ttu-id="08f8a-242">В следующем примере показан синтаксис элемента **Location** для добавления:</span><span class="sxs-lookup"><span data-stu-id="08f8a-242">The following example shows the syntax of the **location** element to add:</span></span>

[!code-xml[Main](breaking-changes/samples/sample9.xml)]

<span data-ttu-id="08f8a-243">В следующем примере показано, как использовать тег **Location** для переноса всех разделов конфигурации, начиная с раздела **appSettings** и заканчивая разделом **System.** .</span><span class="sxs-lookup"><span data-stu-id="08f8a-243">The following example shows how the **location** tag is used to wrap all configuration sections starting with the **appSettings** section and ending with **system.webServer** section.</span></span>

[!code-xml[Main](breaking-changes/samples/sample10.xml)]

<span data-ttu-id="08f8a-244">После выполнения шагов 1 и 2 дочерние веб-приложения ASP.NET 4 будут запускаться без ошибок.</span><span class="sxs-lookup"><span data-stu-id="08f8a-244">When you have completed steps 1 and 2, child ASP.NET 4 Web applications will start without errors.</span></span>

<a id="0.1__Toc252995491"></a><a id="0.1__Toc255587640"></a><a id="0.1__Toc256770151"></a>

## <a name="aspnet-4-web-sites-fail-to-start-on-computers-where-sharepoint-is-installed"></a><span data-ttu-id="08f8a-245">Не удается запустить веб-сайты ASP.NET 4 на компьютерах, где установлена SharePoint</span><span class="sxs-lookup"><span data-stu-id="08f8a-245">ASP.NET 4 Web Sites Fail to Start on Computers Where SharePoint Is Installed</span></span>

<span data-ttu-id="08f8a-246">Веб-серверы, на которых выполняется SharePoint, имеют `Web.config` файл, развернутый в корне веб-сайта SharePoint (например, `c:\inetpub\wwwroot\web.config` для веб-сайта по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="08f8a-246">Web servers that run SharePoint have a `Web.config` file that is deployed at the root of a SharePoint Web site (for example, `c:\inetpub\wwwroot\web.config` for Default Web Site).</span></span> <span data-ttu-id="08f8a-247">В этом `Web.config`ном файле SharePoint устанавливает пользовательский уровень частичного доверия с именем WSS\_минимально.</span><span class="sxs-lookup"><span data-stu-id="08f8a-247">In this `Web.config` file, SharePoint sets a custom partial-trust level named WSS\_Minimal.</span></span>

<span data-ttu-id="08f8a-248">При попытке запустить веб-сайт ASP.NET 4, развернутый в качестве дочернего для этого типа веб-сайта SharePoint, вы увидите следующую ошибку:</span><span class="sxs-lookup"><span data-stu-id="08f8a-248">If you try to run an ASP.NET 4 Web site that is deployed as a child of this type of SharePoint Web site, you will see the following error:</span></span>

`Could not find permission set named 'ASP.NET'.`

<span data-ttu-id="08f8a-249">Эта ошибка возникает из-за того, что инфраструктура разграничения доступа кода ASP.NET 4 (CAS) ищет набор разрешений с именем ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="08f8a-249">This error occurs because the ASP.NET 4 code access security (CAS) infrastructure looks for a permission set named ASP.NET.</span></span> <span data-ttu-id="08f8a-250">Однако файл конфигурации с частичным доверием, на который ссылается WSS\_минимум, не содержит наборов разрешений с таким именем.</span><span class="sxs-lookup"><span data-stu-id="08f8a-250">However, the partial trust configuration file that is referenced by WSS\_Minimal does not contain any permission sets with that name.</span></span>

<span data-ttu-id="08f8a-251">Сейчас нет доступной версии SharePoint, совместимой с ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="08f8a-251">Currently there is not a version of SharePoint available that is compatible with ASP.NET.</span></span> <span data-ttu-id="08f8a-252">В результате не следует пытаться запускать веб-сайт ASP.NET 4 в качестве дочернего сайта под веб-сайтами SharePoint.</span><span class="sxs-lookup"><span data-stu-id="08f8a-252">As a result, you should not attempt to run an ASP.NET 4 Web site as a child site underneath SharePoint Web sites.</span></span>

<a id="0.1__Toc255587641"></a><a id="0.1__Toc256770152"></a>

## <a name="the-httprequestfilepath-property-no-longer-includes-pathinfo-values"></a><span data-ttu-id="08f8a-253">Свойство HttpRequest. FilePath больше не включает значения PathInfo</span><span class="sxs-lookup"><span data-stu-id="08f8a-253">The HttpRequest.FilePath Property No Longer Includes PathInfo Values</span></span>

<span data-ttu-id="08f8a-254">Предыдущие версии ASP.NET включали значение **PathInfo** в значение, полученное из различных свойств, связанных с путями файлов, включая **HttpRequest. FilePath**, **HttpRequest. аппрелативекуррентексекутионфилепас**и **HttpRequest. куррентексекутионфилепас**.</span><span class="sxs-lookup"><span data-stu-id="08f8a-254">Previous versions of ASP.NET included a **PathInfo** value in the value returned from various file path-related properties, including **HttpRequest.FilePath**, **HttpRequest.AppRelativeCurrentExecutionFilePath**, and **HttpRequest.CurrentExecutionFilePath**.</span></span> <span data-ttu-id="08f8a-255">ASP.NET 4 больше не включает значение **PathInfo** в возвращаемые значения этих свойств.</span><span class="sxs-lookup"><span data-stu-id="08f8a-255">ASP.NET 4 no longer includes the **PathInfo** value in the return values from these properties.</span></span> <span data-ttu-id="08f8a-256">Вместо этого сведения **PathInfo** доступны в **HttpRequest. PathInfo**.</span><span class="sxs-lookup"><span data-stu-id="08f8a-256">Instead, the **PathInfo** information is available in **HttpRequest.PathInfo**.</span></span> <span data-ttu-id="08f8a-257">Рассмотрим следующий фрагмент URL-адреса:</span><span class="sxs-lookup"><span data-stu-id="08f8a-257">For example, imagine the following URL fragment:</span></span>

`/testapp/Action.mvc/SomeAction`

<span data-ttu-id="08f8a-258">В более ранних версиях ASP.NET свойства **HttpRequest** имеют следующие значения:</span><span class="sxs-lookup"><span data-stu-id="08f8a-258">In earlier versions of ASP.NET, **HttpRequest** properties have the following values:</span></span>

<span data-ttu-id="08f8a-259">**HttpRequest. FilePath**: `/testapp/Action.mvc/SomeAction`</span><span class="sxs-lookup"><span data-stu-id="08f8a-259">**HttpRequest.FilePath**: `/testapp/Action.mvc/SomeAction`</span></span>

<span data-ttu-id="08f8a-260">**HttpRequest. PathInfo**: (пусто)</span><span class="sxs-lookup"><span data-stu-id="08f8a-260">**HttpRequest.PathInfo**: (empty)</span></span>

<span data-ttu-id="08f8a-261">В ASP.NET 4 свойства **HttpRequest** вместо этого имеют следующие значения:</span><span class="sxs-lookup"><span data-stu-id="08f8a-261">In ASP.NET 4, **HttpRequest** properties instead have the following values:</span></span>

<span data-ttu-id="08f8a-262">**HttpRequest. FilePath**: `/testapp/Action.mvc`</span><span class="sxs-lookup"><span data-stu-id="08f8a-262">**HttpRequest.FilePath**: `/testapp/Action.mvc`</span></span>

<span data-ttu-id="08f8a-263">**HttpRequest. PathInfo**: `SomeAction`</span><span class="sxs-lookup"><span data-stu-id="08f8a-263">**HttpRequest.PathInfo**: `SomeAction`</span></span>

<a id="0.1__Toc252995493"></a><a id="0.1__Toc255587642"></a><a id="0.1__Toc256770153"></a><a id="0.1__Toc245724861"></a>

## <a name="aspnet-20-applications-might-generate-httpexception-errors-that-reference-eurlaxd"></a><span data-ttu-id="08f8a-264">Приложения ASP.NET 2,0 могут создавать ошибки HttpException, которые ссылаются на еурл. axd</span><span class="sxs-lookup"><span data-stu-id="08f8a-264">ASP.NET 2.0 Applications Might Generate HttpException Errors that Reference eurl.axd</span></span>

<span data-ttu-id="08f8a-265">После включения ASP.NET 4 в IIS 6 приложения ASP.NET 2.0, работающие в IIS 6 (в Windows Server 2003 или Windows Server 2003 R2), могут вызывать следующие ошибки:</span><span class="sxs-lookup"><span data-stu-id="08f8a-265">After ASP.NET 4 has been enabled on IIS 6, ASP.NET 2.0 applications that run on IIS 6 (in either Windows Server 2003 or Windows Server 2003 R2) might generate errors such as the following:</span></span>

`System.Web.HttpException: Path '/[yourApplicationRoot]/eurl.axd/[Value]' was not found.`

<span data-ttu-id="08f8a-266">Эта ошибка возникает, если ASP.NET обнаруживает, что веб-сайт настроен для использования ASP.NET 4, собственный компонент ASP.NET 4 передает URL-адрес, не поддерживающий расширение, в управляемую часть ASP.NET для дальнейшей обработки.</span><span class="sxs-lookup"><span data-stu-id="08f8a-266">This error occurs because when ASP.NET detects that a Web site is configured to use ASP.NET 4, a native component of ASP.NET 4 passes an extensionless URL to the managed portion of ASP.NET for further processing.</span></span> <span data-ttu-id="08f8a-267">Однако если виртуальные каталоги, расположенные ниже веб-сайта ASP.NET 4, настроены для использования ASP.NET 2,0, то обработка URL-адреса без расширения таким образом приведет к изменению URL-адреса, содержащего строку "еурл. axd".</span><span class="sxs-lookup"><span data-stu-id="08f8a-267">However, if virtual directories that are below an ASP.NET 4 Web site are configured to use ASP.NET 2.0, processing the extensionless URL in this way results in a modified URL that contains the string "eurl.axd".</span></span> <span data-ttu-id="08f8a-268">Затем этот измененный URL-адрес отправляется в приложение ASP.NET 2,0.</span><span class="sxs-lookup"><span data-stu-id="08f8a-268">This modified URL is then sent to the ASP.NET 2.0 application.</span></span> <span data-ttu-id="08f8a-269">ASP.NET 2,0 не удается распознать формат "еурл. axd".</span><span class="sxs-lookup"><span data-stu-id="08f8a-269">ASP.NET 2.0 cannot recognize the "eurl.axd" format.</span></span> <span data-ttu-id="08f8a-270">Таким образом, ASP.NET 2,0 пытается найти файл с именем `eurl.axd` и выполнить его.</span><span class="sxs-lookup"><span data-stu-id="08f8a-270">Therefore, ASP.NET 2.0 tries to find a file named `eurl.axd` and execute it.</span></span> <span data-ttu-id="08f8a-271">Поскольку такой файл не существует, запрос завершается с исключением **HttpException** .</span><span class="sxs-lookup"><span data-stu-id="08f8a-271">Because no such file exists, the request fails with an **HttpException** exception.</span></span>

<span data-ttu-id="08f8a-272">Эту ошибку можно обойти, используя один из следующих вариантов.</span><span class="sxs-lookup"><span data-stu-id="08f8a-272">You can work around this issue using one of the following options.</span></span>

### <a name="option-1"></a><span data-ttu-id="08f8a-273">Вариант 1</span><span class="sxs-lookup"><span data-stu-id="08f8a-273">Option 1</span></span>

<span data-ttu-id="08f8a-274">Если ASP.NET 4 не требуется для запуска веб-сайта, следует переназначить сайт для использования ASP.NET 2,0.</span><span class="sxs-lookup"><span data-stu-id="08f8a-274">If ASP.NET 4 is not required in order to run the Web site, remap the site to use ASP.NET 2.0 instead.</span></span>

### <a name="option-2"></a><span data-ttu-id="08f8a-275">Вариант 2</span><span class="sxs-lookup"><span data-stu-id="08f8a-275">Option 2</span></span>

<span data-ttu-id="08f8a-276">Если для запуска веб-сайта требуется ASP.NET 4, переместите все дочерние виртуальные каталоги ASP.NET 2,0 на другой веб-сайт, сопоставленный с ASP.NET 2,0.</span><span class="sxs-lookup"><span data-stu-id="08f8a-276">If ASP.NET 4 is required in order to run the Web site, move any child ASP.NET 2.0 virtual directories to a different Web site that is mapped to ASP.NET 2.0.</span></span>

### <a name="option-3"></a><span data-ttu-id="08f8a-277">Вариант 3</span><span class="sxs-lookup"><span data-stu-id="08f8a-277">Option 3</span></span>

<span data-ttu-id="08f8a-278">Если не целесообразно повторно сопоставить веб-сайт с ASP.NET 2,0 или изменить расположение виртуального каталога, явно отключите обработку URL-адресов без расширений в ASP.NET 4.</span><span class="sxs-lookup"><span data-stu-id="08f8a-278">If it is not practical to remap the Web site to ASP.NET 2.0 or to change the location of a virtual directory, explicitly disable extensionless URL processing in ASP.NET 4.</span></span> <span data-ttu-id="08f8a-279">Выполните перечисленные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="08f8a-279">Use the following procedure:</span></span>

1. <span data-ttu-id="08f8a-280">В реестре Windows откройте следующий узел:</span><span class="sxs-lookup"><span data-stu-id="08f8a-280">In the Windows registry, open the following node:</span></span>

`HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ASP.NET\4.0.30319.0`

1. <span data-ttu-id="08f8a-281">Создайте новое значение **DWORD** с именем **енабликстенсионлессурлс**.</span><span class="sxs-lookup"><span data-stu-id="08f8a-281">Create a new **DWORD** value named **EnableExtensionlessUrls**.</span></span>
2. <span data-ttu-id="08f8a-282">Задайте для **енабликстенсионлессурлс** значение 0.</span><span class="sxs-lookup"><span data-stu-id="08f8a-282">Set **EnableExtensionlessUrls** to 0.</span></span> <span data-ttu-id="08f8a-283">Это отключает поведение URL-адресов, не имеющих расширения.</span><span class="sxs-lookup"><span data-stu-id="08f8a-283">This disables extensionless URL behavior.</span></span>
3. <span data-ttu-id="08f8a-284">Сохраните значение реестра и закройте редактор реестра.</span><span class="sxs-lookup"><span data-stu-id="08f8a-284">Save the registry value and close the registry editor.</span></span>
4. <span data-ttu-id="08f8a-285">Запустите программу командной строки **iisreset** , которая приводит к тому, что IIS Считывает новое значение реестра.</span><span class="sxs-lookup"><span data-stu-id="08f8a-285">Run the **iisreset** command-line tool, which causes IIS to read the new registry value.</span></span>

> [!NOTE]
> <span data-ttu-id="08f8a-286">Установка параметра **енабликстенсионлессурлс** в значение 1 обеспечивает поведение URL-адресов, отменяющих расширение.</span><span class="sxs-lookup"><span data-stu-id="08f8a-286">Setting **EnableExtensionlessUrls** to 1 enables extensionless URL behavior.</span></span> <span data-ttu-id="08f8a-287">Это параметр по умолчанию, если значение не указано.</span><span class="sxs-lookup"><span data-stu-id="08f8a-287">This is the default setting if no value is specified.</span></span>

<a id="0.1__Toc252995494"></a><a id="0.1__Toc255587643"></a><a id="0.1__Toc256770154"></a><a id="0.1__Toc245724862"></a>

## <a name="event-handlers-might-not-be-not-raised-in-a-default-document-in-iis-7-or-iis-75-integrated-mode"></a><span data-ttu-id="08f8a-288">Обработчики событий могут не вызываться в документе по умолчанию в интегрированном режиме IIS 7 или IIS 7,5.</span><span class="sxs-lookup"><span data-stu-id="08f8a-288">Event Handlers Might Not Be Not Raised in a Default Document in IIS 7 or IIS 7.5 Integrated Mode</span></span>

<span data-ttu-id="08f8a-289">ASP.NET 4 включает изменения, которые изменяют способ отрисовки атрибута **Action** элемента HTML **Form** , когда URL-адрес без расширений разрешается в документ по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="08f8a-289">ASP.NET 4 includes modifications that change how the **action** attribute of the HTML **form** element is rendered when an extensionless URL resolves to a default document.</span></span> <span data-ttu-id="08f8a-290">Примером URL-адреса, разрешающего доступ к документу по умолчанию, может быть [http://contoso.com/](http://contoso.com/), что приведет к [http://contoso.com/Default.aspx](http://contoso.com/Default.aspx)запроса.</span><span class="sxs-lookup"><span data-stu-id="08f8a-290">An example of an extensionless URL resolving to a default document would be [http://contoso.com/](http://contoso.com/), resulting in a request to [http://contoso.com/Default.aspx](http://contoso.com/Default.aspx).</span></span>

<span data-ttu-id="08f8a-291">ASP.NET 4 теперь отображает значение атрибута **действия** HTML-элемента **формы** в виде пустой строки, когда выполняется запрос к URL-адресу без расширения, которому сопоставлен документ по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="08f8a-291">ASP.NET 4 now renders the HTML **form** element's **action** attribute value as an empty string when a request is made to an extensionless URL that has a default document mapped to it.</span></span> <span data-ttu-id="08f8a-292">Например, в более ранних выпусках ASP.NET запрос на [http://contoso.com](http://contoso.com) приведет к `Default.aspx`запроса.</span><span class="sxs-lookup"><span data-stu-id="08f8a-292">For example, in earlier releases of ASP.NET, a request to [http://contoso.com](http://contoso.com) would result in a request to `Default.aspx`.</span></span> <span data-ttu-id="08f8a-293">В этом документе открывающий тег **формы** будет подготовлен к просмотру, как показано в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="08f8a-293">In that document, the opening **form** tag would be rendered as in the following example:</span></span>

`<form action="Default.aspx" />`

<span data-ttu-id="08f8a-294">В ASP.NET 4 запрос на [http://contoso.com](http://contoso.com) также приводит к `Default.aspx`запроса.</span><span class="sxs-lookup"><span data-stu-id="08f8a-294">In ASP.NET 4, a request to [http://contoso.com](http://contoso.com) also results in a request to `Default.aspx`.</span></span> <span data-ttu-id="08f8a-295">Однако ASP.NET теперь отображает открывающий тег **формы** HTML, как показано в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="08f8a-295">However, ASP.NET now renders the HTML opening **form** tag as in the following example:</span></span>

`<form action="" />`

<span data-ttu-id="08f8a-296">Это различие в способе подготовки к просмотру атрибута **действия** может привести к незначительным изменениям в способе обработки формы POST службами IIS и ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="08f8a-296">This difference in how the **action** attribute is rendered can cause subtle changes in how a form post is processed by IIS and ASP.NET.</span></span> <span data-ttu-id="08f8a-297">Если атрибут **Action** является пустой строкой, то объект IIS **дефаултдокументмодуле** создаст дочерний запрос для `Default.aspx`.</span><span class="sxs-lookup"><span data-stu-id="08f8a-297">When the **action** attribute is an empty string, the IIS **DefaultDocumentModule** object will create a child request to `Default.aspx`.</span></span> <span data-ttu-id="08f8a-298">В большинстве случаев этот дочерний запрос прозрачен для кода приложения, а страница `Default.aspx` выполняется обычным образом.</span><span class="sxs-lookup"><span data-stu-id="08f8a-298">Under most conditions, this child request is transparent to application code, and the `Default.aspx` page runs normally.</span></span>

<span data-ttu-id="08f8a-299">Однако возможное взаимодействие между управляемым кодом и интегрированным режимом IIS 7 или IIS 7.5 может привести к тому, что управляемые ASPX-страницы перестанут работать корректно во время выполнения дочернего запроса.</span><span class="sxs-lookup"><span data-stu-id="08f8a-299">However, a potential interaction between managed code and IIS 7 or IIS 7.5 Integrated mode can cause managed .aspx pages to stop working properly during the child request.</span></span> <span data-ttu-id="08f8a-300">Если выполняются следующие условия, дочерний запрос к `Default.aspx` документу приведет к ошибке или непредвиденному поведению:</span><span class="sxs-lookup"><span data-stu-id="08f8a-300">If the following conditions occur, the child request to a `Default.aspx` document will result in an error or in unexpected behavior:</span></span>

1. <span data-ttu-id="08f8a-301">Страница. aspx отправляется в браузер, если атрибуту **действия** элемента **формы** задано значение "".</span><span class="sxs-lookup"><span data-stu-id="08f8a-301">An .aspx page is sent to the browser with the **form** element's **action** attribute set to "".</span></span>
2. <span data-ttu-id="08f8a-302">Форма отправляется обратно в ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="08f8a-302">The form is posted back to ASP.NET.</span></span>
3. <span data-ttu-id="08f8a-303">Управляемый HTTP-модуль считывает некоторую часть тела сущности.</span><span class="sxs-lookup"><span data-stu-id="08f8a-303">A managed HTTP module reads some part of the entity body.</span></span> <span data-ttu-id="08f8a-304">Например, модуль считывает **запрос. Form** или **запрос. params**.</span><span class="sxs-lookup"><span data-stu-id="08f8a-304">For example, a module reads **Request.Form** or **Request.Params**.</span></span> <span data-ttu-id="08f8a-305">Это приводит к тому, что тело сущности запроса POST считывается в управляемую память.</span><span class="sxs-lookup"><span data-stu-id="08f8a-305">This causes the entity body of the POST request to be read into managed memory.</span></span> <span data-ttu-id="08f8a-306">В результате тело сущности становится недоступным для модулей машинного кода, запущенных в интегрированном режиме IIS 7 или IIS 7.5.</span><span class="sxs-lookup"><span data-stu-id="08f8a-306">As a result, the entity body is no longer available to any native code modules that are running in IIS 7 or IIS 7.5 Integrated mode.</span></span>
4. <span data-ttu-id="08f8a-307">Объект IIS **дефаултдокументмодуле** в конечном итоге выполняет и создает дочерний запрос к `Default.aspx` документу.</span><span class="sxs-lookup"><span data-stu-id="08f8a-307">The IIS **DefaultDocumentModule** object eventually runs and creates a child request to the `Default.aspx` document.</span></span> <span data-ttu-id="08f8a-308">Однако так как тело сущности уже было считано частью управляемого кода, тело сущности для отправки в дочерний запрос отсутствует.</span><span class="sxs-lookup"><span data-stu-id="08f8a-308">However, because the entity body has already been read by a piece of managed code, there is no entity body available to send to the child request.</span></span>
5. <span data-ttu-id="08f8a-309">При выполнении конвейера HTTP для дочернего запроса обработчик для `.aspx` файлов выполняется на этапе выполнения обработчика.</span><span class="sxs-lookup"><span data-stu-id="08f8a-309">When the HTTP pipeline runs for the child request, the handler for `.aspx` files runs during the handler-execute phase.</span></span>
6. <span data-ttu-id="08f8a-310">Так как отсутствует тело сущности, нет переменных формы и состояния представления, поэтому для обработчика страницы ASPX-данных нет доступных сведений, чтобы определить, какое событие должно быть создано.</span><span class="sxs-lookup"><span data-stu-id="08f8a-310">Because there is no entity body, there are no form variables and no view state, and therefore no information is available for the .aspx page handler to determine what event (if any) is supposed to be raised.</span></span> <span data-ttu-id="08f8a-311">В результате для соответствующей ASPX-страницы ни один из обработчиков событий обратной передачи не выполняется.</span><span class="sxs-lookup"><span data-stu-id="08f8a-311">As a result, none of the postback event handlers for the affected .aspx page run.</span></span>

<span data-ttu-id="08f8a-312">Это поведение можно обойти следующими способами.</span><span class="sxs-lookup"><span data-stu-id="08f8a-312">You can work around this behavior in the following ways:</span></span>

- <span data-ttu-id="08f8a-313">Определите HTTP-модуль, обращающийся к телу объекта запроса во время запросов документов по умолчанию, и определите, можно ли настроить его для запуска только для управляемых запросов.</span><span class="sxs-lookup"><span data-stu-id="08f8a-313">Identify the HTTP module that is accessing the request's entity body during default document requests and determine whether it can be configured to run only for managed requests.</span></span> <span data-ttu-id="08f8a-314">В интегрированном режиме как для IIS 7, так и для IIS 7,5 модули HTTP могут быть помечены для запуска только для управляемых запросов путем добавления следующего атрибута в запись **System... Server или** modules модуля:</span><span class="sxs-lookup"><span data-stu-id="08f8a-314">In Integrated mode for both IIS 7 and IIS 7.5, HTTP modules can be marked to run only for managed requests by adding the following attribute to the module's **system.webServer/modules** entry:</span></span>

- `precondition="managedHandler"`

- <span data-ttu-id="08f8a-315">Этот параметр отключает модуль для запросов, которые IIS 7 и IIS 7,5 определяют как неуправляемые запросы.</span><span class="sxs-lookup"><span data-stu-id="08f8a-315">This setting disables the module for requests that IIS 7 and IIS 7.5 determine as not being managed requests.</span></span> <span data-ttu-id="08f8a-316">Для запросов документов по умолчанию первым запросом является URL-адрес, не имеющий расширения.</span><span class="sxs-lookup"><span data-stu-id="08f8a-316">For default document requests, the first request is to an extensionless URL.</span></span> <span data-ttu-id="08f8a-317">Поэтому службы IIS не запускают управляемые модули, помеченные предусловием управляемого обработчика во время обработки первоначального запроса.</span><span class="sxs-lookup"><span data-stu-id="08f8a-317">Therefore, IIS does not run any managed modules that are marked with a precondition of managed Handler during initial request processing.</span></span> <span data-ttu-id="08f8a-318">В результате управляемые модули не будут случайно считать тело сущности, поэтому тело сущности по-прежнему доступно и передается в дочерний запрос и в документ по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="08f8a-318">As a result, managed modules will not accidentally read the entity body and thus the entity body is still available and is passed along to the child request and to the default document.</span></span>

- <span data-ttu-id="08f8a-319">Если проблемные HTTP-модули должны выполняться для всех запросов (для статических файлов, для URL-адресов без расширения, которые разрешаются в объекте **дефаултдокументмодуле** , для управляемых запросов и т. д.), измените затронутые страницы. aspx, явно задав для свойства **Action** элемента управления **System. Web. UI. HtmlControls. HtmlForm** непустую строку.</span><span class="sxs-lookup"><span data-stu-id="08f8a-319">If the problematic HTTP modules have to run for all requests (for static files, for extensionless URLs that resolve to the **DefaultDocumentModule** object, for managed requests, etc.), modify the affected .aspx pages by explicitly setting the **Action** property of the page's **System.Web.UI.HtmlControls.HtmlForm** control to a non-empty string.</span></span> <span data-ttu-id="08f8a-320">Например, если документ по умолчанию `Default.aspx`, измените код страницы, чтобы явно задать для свойства **Action** элемента управления **HtmlForm** значение Default. aspx.</span><span class="sxs-lookup"><span data-stu-id="08f8a-320">For example, if the default document is `Default.aspx`, modify the page's code to explicitly set the **HtmlForm** control's **Action** property to "Default.aspx".</span></span>

<a id="0.1__Toc255587644"></a><a id="0.1__Toc256770155"></a>

## <a name="changes-to-the-aspnet-code-access-security-cas-implementation"></a><span data-ttu-id="08f8a-321">Изменения в реализации управления доступом для кода ASP.NET (CAS)</span><span class="sxs-lookup"><span data-stu-id="08f8a-321">Changes to the ASP.NET Code Access Security (CAS) Implementation</span></span>

<span data-ttu-id="08f8a-322">ASP.NET 2,0 и по расширению функций ASP.NET, которые были добавлены в 3,5, используйте модель управления доступом для кода .NET Framework 1,1 и 2,0.</span><span class="sxs-lookup"><span data-stu-id="08f8a-322">ASP.NET 2.0, and by extension the ASP.NET features that were added in 3.5, use the .NET Framework 1.1 and 2.0 code access security (CAS) model.</span></span> <span data-ttu-id="08f8a-323">Однако реализация управления доступом для кода в ASP.NET 4 значительно усовершенствована.</span><span class="sxs-lookup"><span data-stu-id="08f8a-323">However, the implementation of CAS in ASP.NET 4 has been substantially overhauled.</span></span> <span data-ttu-id="08f8a-324">В результате приложения ASP.NET с частичным доверием, использующие доверенный код, работающий в глобальном кэше сборок (GAC), могут завершиться с различными исключениями безопасности.</span><span class="sxs-lookup"><span data-stu-id="08f8a-324">As a result, partial-trust ASP.NET applications that rely on trusted code running in the global assembly cache (GAC) might fail with various security exceptions.</span></span> <span data-ttu-id="08f8a-325">Приложения с частичным доверием, использующие значительные изменения политики CAS компьютера, также могут завершиться с исключениями безопасности.</span><span class="sxs-lookup"><span data-stu-id="08f8a-325">Partial-trust applications that rely on extensive modifications to machine CAS policy might also fail with security exceptions.</span></span>

<span data-ttu-id="08f8a-326">Вы можете вернуть приложения с частичным доверием ASP.NET 4 к поведению ASP.NET 1,1 и 2,0 с помощью нового атрибута **легацикасмодел** в элементе конфигурации **доверия** , как показано в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="08f8a-326">You can revert partial-trust ASP.NET 4 applications to the behavior of ASP.NET 1.1 and 2.0 using the new **legacyCasModel** attribute in the **trust** configuration element, as shown in the following example:</span></span>

`<trust level= "Medium" legacyCasModel="true" />`

<span data-ttu-id="08f8a-327">При возврате к устаревшей модели CAS включены следующие старые поведения CAS:</span><span class="sxs-lookup"><span data-stu-id="08f8a-327">When you revert to the legacy CAS model, the following old CAS behaviors are enabled:</span></span>

- <span data-ttu-id="08f8a-328">Политика CAS компьютера соблюдается.</span><span class="sxs-lookup"><span data-stu-id="08f8a-328">Machine CAS policy is honored.</span></span>
- <span data-ttu-id="08f8a-329">В одном домене приложения разрешено несколько различных наборов разрешений.</span><span class="sxs-lookup"><span data-stu-id="08f8a-329">Multiple different permission sets in a single application domain are allowed.</span></span>
- <span data-ttu-id="08f8a-330">Явные утверждения разрешений не требуются для сборок в глобальном кэше сборок, которые вызываются, когда в стеке находится только ASP.NET или другой код .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="08f8a-330">Explicit permission assertions are not required for assemblies in the GAC that are invoked when only ASP.NET or other .NET Framework code is on the stack.</span></span>

<span data-ttu-id="08f8a-331">Один из сценариев не может быть возвращен в .NET Framework 4: приложения с частичным доверием, не являющиеся веб-приложениями, больше не могут вызывать определенные API в System. Web. dll и System. Web. Extensions. dll.</span><span class="sxs-lookup"><span data-stu-id="08f8a-331">One scenario cannot be reverted in the .NET Framework 4: non-Web partial-trust applications can no longer call certain APIs in System.Web.dll and System.Web.Extensions.dll.</span></span> <span data-ttu-id="08f8a-332">В предыдущих версиях .NET Framework для приложений с частичным доверием, не являющихся веб-приложениями, можно явно предоставить разрешения **аспнесостингпермиссион** .</span><span class="sxs-lookup"><span data-stu-id="08f8a-332">In previous versions of the .NET Framework, it was possible for non-Web partial-trust applications to be explicitly granted **AspNetHostingPermission** permissions.</span></span> <span data-ttu-id="08f8a-333">Затем эти приложения могут использовать **System. Web. HttpUtility**, типы в пространствах имен **System. Web. ClientServices.\*** и типы, связанные с членством, ролями и профилями.</span><span class="sxs-lookup"><span data-stu-id="08f8a-333">These applications could then use **System.Web.HttpUtility**, types in the **System.Web.ClientServices.\*** namespaces, and types related to membership, roles, and profiles.</span></span> <span data-ttu-id="08f8a-334">Вызов этих типов из приложений с частичным доверием, не являющихся веб-приложениями, больше не поддерживается в .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="08f8a-334">Calling these types from non-Web partial trust applications is no longer supported in the .NET Framework 4.</span></span>

> [!NOTE]
> <span data-ttu-id="08f8a-335">Функции **HtmlEncode** и **HtmlDecode** класса **System. Web. HttpUtility** были перемещены в новый класс **служебной программы .NET Framework 4 System .NET.**</span><span class="sxs-lookup"><span data-stu-id="08f8a-335">The **HtmlEncode** and **HtmlDecode** functionality of the **System.Web.HttpUtility** class was moved to the new .NET Framework 4 **System.Net.WebUtility** class.</span></span> <span data-ttu-id="08f8a-336">Если это была единственная используемая функция ASP.NET, измените код приложения так, чтобы вместо него использовался новый класс **служебной программы** .</span><span class="sxs-lookup"><span data-stu-id="08f8a-336">If that was the only ASP.NET functionality that was being used, modify the application's code to use the new **WebUtility** class instead.</span></span>

<span data-ttu-id="08f8a-337">Ниже приведен общий обзор изменений в реализации CAS по умолчанию в ASP.NET 4:</span><span class="sxs-lookup"><span data-stu-id="08f8a-337">The following is a high-level summary of the changes to the default CAS implementation in ASP.NET 4:</span></span>

- <span data-ttu-id="08f8a-338">Домены приложений ASP.NET теперь являются однородными доменами приложений.</span><span class="sxs-lookup"><span data-stu-id="08f8a-338">ASP.NET application domains are now homogeneous application domains.</span></span> <span data-ttu-id="08f8a-339">В домене приложения доступны только наборы разрешений с частичным доверием и полным доверием.</span><span class="sxs-lookup"><span data-stu-id="08f8a-339">Only partial-trust and full-trust grant sets are available in an application domain.</span></span>
- <span data-ttu-id="08f8a-340">Наборы разрешений с частичным доверием ASP.NET не зависят от политики CAS уровня предприятия, уровня компьютера или уровня пользователя.</span><span class="sxs-lookup"><span data-stu-id="08f8a-340">ASP.NET partial-trust grant sets are independent from any enterprise-level, machine-level, or user-level CAS policy.</span></span>
- <span data-ttu-id="08f8a-341">Сборки ASP.NET, поставляемые в 3,5 и 3,5 с пакетом обновления 1 (SP1), были преобразованы для использования модели прозрачности .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="08f8a-341">ASP.NET assemblies that shipped in 3.5 and 3.5 SP1 have been converted to use the .NET Framework 4 transparency model.</span></span>
- <span data-ttu-id="08f8a-342">Использование атрибута ASP.NET **аспнесостингпермиссион** было значительно уменьшено.</span><span class="sxs-lookup"><span data-stu-id="08f8a-342">Use of the ASP.NET **AspNetHostingPermission** attribute has been substantially reduced.</span></span> <span data-ttu-id="08f8a-343">Большинство экземпляров этого атрибута были удалены из общедоступных API ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="08f8a-343">Most instances of this attribute have been removed from the public ASP.NET APIs.</span></span>
- <span data-ttu-id="08f8a-344">Динамически компилируемые сборки, созданные поставщиками сборки ASP.NET, были обновлены для явного пометки сборок как прозрачных.</span><span class="sxs-lookup"><span data-stu-id="08f8a-344">Dynamically compiled assemblies that are created by ASP.NET build providers have been updated to explicitly mark assemblies as transparent.</span></span>
- <span data-ttu-id="08f8a-345">Все сборки ASP.NET теперь помечены таким образом, что атрибут APTCA учитывается только в средах размещения веб-сайтов.</span><span class="sxs-lookup"><span data-stu-id="08f8a-345">All ASP.NET assemblies are now marked in such a way that the APTCA attribute is honored only in Web hosting environments.</span></span> <span data-ttu-id="08f8a-346">Частично доверенные невеб-среды размещения, такие как ClickOnce, не смогут вызывать сборки ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="08f8a-346">Partially trusted non-Web hosting environments like ClickOnce will not be able to call into ASP.NET assemblies.</span></span>

<span data-ttu-id="08f8a-347">Дополнительные сведения о новой модели управления доступом для кода ASP.NET 4 см. [в разделе Использование управления доступом для кода в приложениях ASP.NET](https://msdn.microsoft.com/library/dd984947%28VS.100%29.aspx) на веб-сайте MSDN.</span><span class="sxs-lookup"><span data-stu-id="08f8a-347">For more information about the new ASP.NET 4 code access security model, see [Using Code Access Security in ASP.NET Applications](https://msdn.microsoft.com/library/dd984947%28VS.100%29.aspx) on the MSDN Web site.</span></span>

<a id="0.1__Toc256770156"></a><a id="0.1__Toc245724863"></a><a id="0.1__Toc252995496"></a><a id="0.1__Toc255587645"></a><a id="0.1__Toc245724864"></a>

## <a name="membershipuser-and-other-types-in-the-systemwebsecurity-namespace-have-been-moved"></a><span data-ttu-id="08f8a-348">MembershipUser и другие типы в пространстве имен System. Web. Security были перемещены</span><span class="sxs-lookup"><span data-stu-id="08f8a-348">MembershipUser and Other Types in the System.Web.Security Namespace Have Been Moved</span></span>

<span data-ttu-id="08f8a-349">Некоторые типы, используемые в членстве ASP.NET, были перемещены из `System.Web.dll` в новую сборку System. Web. ApplicationServices. dll.</span><span class="sxs-lookup"><span data-stu-id="08f8a-349">Some types that are used in ASP.NET membership have been moved from `System.Web.dll` to the new System.Web.ApplicationServices.dll assembly.</span></span> <span data-ttu-id="08f8a-350">Типы были перемещены для устранения проблемы зависимостей уровней архитектуры между типами в клиенте и в расширенных SKU платформы .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="08f8a-350">The types were moved in order to resolve architectural layering dependencies between types in the client and in extended .NET Framework SKUs.</span></span>

<span data-ttu-id="08f8a-351">Проекты веб-сайтов не имеют проблем в результате перемещения этих типов, так как System. Web. ApplicationServices. dll был добавлен в список сборок, на которые имеются ссылки, которые по умолчанию используются системой компиляции ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="08f8a-351">Web site projects do not have problems as a result of moving these types, because System.Web.ApplicationServices.dll was added to the list of referenced assemblies that is used by default by the ASP.NET compilation system.</span></span> <span data-ttu-id="08f8a-352">Если обновить проект веб-сайта, созданный с помощью более ранней версии ASP.NET, до ASP.NET 4, открыв его в Visual Studio 2010, проект будет компилироваться без ошибок.</span><span class="sxs-lookup"><span data-stu-id="08f8a-352">If you upgrade a Web site project that was created using an earlier version of ASP.NET to ASP.NET 4 by opening it in Visual Studio 2010, the project will compile without errors.</span></span>

<span data-ttu-id="08f8a-353">Аналогичным образом, если обновить проект веб-приложения, созданный в более ранней версии ASP.NET, до ASP.NET 4, открыв его в Visual Studio 2010, в процессе обновления в проект будет добавлена ссылка на файл System. Web. ApplicationServices. dll.</span><span class="sxs-lookup"><span data-stu-id="08f8a-353">Similarly, if you upgrade a Web application project that was created in an earlier version of ASP.NET to ASP.NET 4 by opening it in Visual Studio 2010, the upgrade process adds a reference to System.Web.ApplicationServices.dll to the project.</span></span> <span data-ttu-id="08f8a-354">Поэтому обновленные проекты веб-приложений также будут компилироваться без ошибок.</span><span class="sxs-lookup"><span data-stu-id="08f8a-354">Therefore, upgraded Web application projects will also compile without errors.</span></span>

<span data-ttu-id="08f8a-355">Скомпилированные (двоичные) файлы, созданные с помощью более ранних версий ASP.NET, также будут выполняться без ошибок в ASP.NET 4, даже если типы членства были перемещены в другую сборку.</span><span class="sxs-lookup"><span data-stu-id="08f8a-355">Compiled (binary) files that were created using earlier versions of ASP.NET will also run without errors on ASP.NET 4, even though the membership types were moved to a different assembly.</span></span> <span data-ttu-id="08f8a-356">В `System.Web.dll` версию ASP.NET 4 добавлена информация о перенаправлении типов, которая автоматически направляет ссылки времени выполнения для этих типов в новое расположение для типов.</span><span class="sxs-lookup"><span data-stu-id="08f8a-356">Type forwarding information has been added to the ASP.NET 4 version of `System.Web.dll` that automatically routes run-time references for these types to the new location for the types.</span></span>

<span data-ttu-id="08f8a-357">Однако библиотеки классов, использующие определенные типы членства и обновленные с предыдущих версий ASP.NET, не будут компилироваться при использовании в проекте ASP.NET 4.</span><span class="sxs-lookup"><span data-stu-id="08f8a-357">However, class libraries that use specific membership types and that have been upgraded from earlier versions of ASP.NET will fail to compile when used in an ASP.NET 4 project.</span></span> <span data-ttu-id="08f8a-358">Например, проект библиотеки классов может не компилироваться и сообщать об ошибке, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="08f8a-358">For example, a class library project might fail to compile and report an error such as the following:</span></span>

- `The type 'System.Web.Security.MembershipUser' is defined in an assembly that is not referenced. You must add a reference to assembly 'System.Web.ApplicationServices, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.`

- `The type name 'MembershipUser' could not be found. This type has been forwarded to assembly 'System.Web.ApplicationServices, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'. Consider adding a reference to that assembly.`

<span data-ttu-id="08f8a-359">Эту проблему можно обойти, добавив ссылку в проект библиотеки классов в System. Web. ApplicationServices. dll.</span><span class="sxs-lookup"><span data-stu-id="08f8a-359">You can work around this problem by adding a reference in your class library project to System.Web.ApplicationServices.dll.</span></span>

<span data-ttu-id="08f8a-360">В следующем списке показаны типы *System. Web. Security* , перемещенные из `System.Web.dll` в System. Web. ApplicationServices. dll:</span><span class="sxs-lookup"><span data-stu-id="08f8a-360">The following list shows the *System.Web.Security* types that were moved from `System.Web.dll` to System.Web.ApplicationServices.dll:</span></span>

- <span data-ttu-id="08f8a-361">*System. Web. Security. Мембершипкреатестатус*</span><span class="sxs-lookup"><span data-stu-id="08f8a-361">*System.Web.Security.MembershipCreateStatus*</span></span>
- <span data-ttu-id="08f8a-362">*System. Web. Security. Membership. Креатеусерексцептион*</span><span class="sxs-lookup"><span data-stu-id="08f8a-362">*System.Web.Security.Membership.CreateUserException*</span></span>
- <span data-ttu-id="08f8a-363">*System. Web. Security. Мембершиппассвордексцептион*</span><span class="sxs-lookup"><span data-stu-id="08f8a-363">*System.Web.Security.MembershipPasswordException*</span></span>
- <span data-ttu-id="08f8a-364">*System. Web. Security. Мембершиппассвордформат*</span><span class="sxs-lookup"><span data-stu-id="08f8a-364">*System.Web.Security.MembershipPasswordFormat*</span></span>
- <span data-ttu-id="08f8a-365">*System. Web. Security. MembershipProvider*</span><span class="sxs-lookup"><span data-stu-id="08f8a-365">*System.Web.Security.MembershipProvider*</span></span>
- <span data-ttu-id="08f8a-366">*System. Web. Security. Мембершиппровидерколлектион*</span><span class="sxs-lookup"><span data-stu-id="08f8a-366">*System.Web.Security.MembershipProviderCollection*</span></span>
- <span data-ttu-id="08f8a-367">*System. Web. Security. MembershipUser*</span><span class="sxs-lookup"><span data-stu-id="08f8a-367">*System.Web.Security.MembershipUser*</span></span>
- <span data-ttu-id="08f8a-368">*System. Web. Security. Мембершипусерколлектион*</span><span class="sxs-lookup"><span data-stu-id="08f8a-368">*System.Web.Security.MembershipUserCollection*</span></span>
- <span data-ttu-id="08f8a-369">*System. Web. Security. Мембершипвалидатепассвордевенсандлер*</span><span class="sxs-lookup"><span data-stu-id="08f8a-369">*System.Web.Security.MembershipValidatePasswordEventHandler*</span></span>
- <span data-ttu-id="08f8a-370">*System. Web. Security. Валидатепассвордевентаргс*</span><span class="sxs-lookup"><span data-stu-id="08f8a-370">*System.Web.Security.ValidatePasswordEventArgs*</span></span>
- <span data-ttu-id="08f8a-371">*System. Web. Security. RoleProvider*</span><span class="sxs-lookup"><span data-stu-id="08f8a-371">*System.Web.Security.RoleProvider*</span></span>
- <a id="0.1_a"></a><span data-ttu-id="08f8a-372">*System. Web. Configuration. Мембершиппассвордкомпатибилитимоде*</span><span class="sxs-lookup"><span data-stu-id="08f8a-372">*System.Web.Configuration.MembershipPasswordCompatibilityMode*</span></span>

<a id="0.1__Toc256770157"></a>

## <a name="output-caching-changes-to-vary--http-header"></a><span data-ttu-id="08f8a-373">Изменения кэширования выходных данных в разные \* заголовке HTTP</span><span class="sxs-lookup"><span data-stu-id="08f8a-373">Output Caching Changes to Vary \* HTTP Header</span></span>

<span data-ttu-id="08f8a-374">В ASP.NET 1,0 ошибка привела к тому, что кэшированные страницы, заданные `Location="ServerAndClient"` как параметры кэширования вывода, выдают `Vary:*` заголовок HTTP в ответе.</span><span class="sxs-lookup"><span data-stu-id="08f8a-374">In ASP.NET 1.0, a bug caused cached pages that specified `Location="ServerAndClient"` as an output–cache setting to emit a `Vary:*` HTTP header in the response.</span></span> <span data-ttu-id="08f8a-375">Таким образом, клиентские браузеры получали указание никогда не кэшировать такую страницу локально.</span><span class="sxs-lookup"><span data-stu-id="08f8a-375">This had the effect of telling client browsers to never cache the page locally.</span></span>

<span data-ttu-id="08f8a-376">В ASP.NET 1,1 был добавлен метод **System. Web. HttpCachePolicy. сетомитваристар** , который можно вызвать для подавления заголовка `Vary:*`.</span><span class="sxs-lookup"><span data-stu-id="08f8a-376">In ASP.NET 1.1, the **System.Web.HttpCachePolicy.SetOmitVaryStar** method was added, which you could call to suppress the `Vary:*` header.</span></span> <span data-ttu-id="08f8a-377">Этот метод был выбран, поскольку изменение выданного заголовка HTTP было потенциально критическим изменением во времени.</span><span class="sxs-lookup"><span data-stu-id="08f8a-377">This method was chosen because changing the emitted HTTP header was considered a potentially breaking change at the time.</span></span> <span data-ttu-id="08f8a-378">Тем не менее, разработчики были путать поведение в ASP.NET, и в отчетах об ошибках предлагалось, что разработчики не знают о существующем поведении **сетомитваристар** .</span><span class="sxs-lookup"><span data-stu-id="08f8a-378">However, developers have been confused by the behavior in ASP.NET, and bug reports suggest that developers are unaware of the existing **SetOmitVaryStar** behavior.</span></span>

<span data-ttu-id="08f8a-379">В ASP.NET 4 было принято решение устранить корневую проблему.</span><span class="sxs-lookup"><span data-stu-id="08f8a-379">In ASP.NET 4, the decision was made to fix the root problem.</span></span> <span data-ttu-id="08f8a-380">Заголовок HTTP `Vary:*` больше не отправляется из ответов, которые задают следующую директиву:</span><span class="sxs-lookup"><span data-stu-id="08f8a-380">The `Vary:*` HTTP header is no longer emitted from responses that specify the following directive:</span></span>

`<%@OutputCache Location="ServerAndClient" %>`

<span data-ttu-id="08f8a-381">В результате **сетомитваристар** больше не требуется для подавления заголовка `Vary:*`.</span><span class="sxs-lookup"><span data-stu-id="08f8a-381">As a result, **SetOmitVaryStar** is no longer needed in order to suppress the `Vary:*` header.</span></span>

<span data-ttu-id="08f8a-382">В приложениях, которые задают `Location="ServerAndClient"` в директиве **@ OutputCache** на странице, вы увидите поведение, предполагаемое именем значения атрибута **Location** , то есть страницы будут кэшироваться в браузере без необходимости вызова метода **сетомитваристар** .</span><span class="sxs-lookup"><span data-stu-id="08f8a-382">In applications that specify `Location="ServerAndClient"` in the **@ OutputCache** directive on a page, you will now see the behavior implied by the name of the **Location** attribute's value – that is, pages will be cacheable in the browser without requiring that you call the **SetOmitVaryStar** method.</span></span>

<span data-ttu-id="08f8a-383">Если страницы в приложении должны порождать `Vary:*`, вызовите метод **аппендхеадер** , как показано в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="08f8a-383">If pages in your application must emit `Vary:*`, call the **AppendHeader** method, as in the following example:</span></span>

`HttpResponse.AppendHeader("Vary","*");`

<span data-ttu-id="08f8a-384">Кроме того, можно изменить значение атрибута **Расположение** выходных кэширования на "сервер".</span><span class="sxs-lookup"><span data-stu-id="08f8a-384">Alternatively, you can change the value of the output caching **Location** attribute to "Server".</span></span>

<a id="0.1__Toc255587646"></a><a id="0.1__Toc256770158"></a>

## <a name="systemwebsecurity-types-for-passport-are-obsolete"></a><span data-ttu-id="08f8a-385">Устаревшие типы System. Web. Security для паспорта</span><span class="sxs-lookup"><span data-stu-id="08f8a-385">System.Web.Security Types for Passport are Obsolete</span></span>

<span data-ttu-id="08f8a-386">Поддержка паспорта, встроенная в ASP.NET 2,0, устарела и не поддерживается в течение нескольких лет из-за изменений в паспорте (теперь LiveID).</span><span class="sxs-lookup"><span data-stu-id="08f8a-386">The Passport support built into ASP.NET 2.0 has been obsolete and unsupported for a few years due to changes in Passport (now LiveID).</span></span> <span data-ttu-id="08f8a-387">В результате пять типов, связанных с паспортом в **System. Web. Security** , теперь помечаются атрибутом **ObsoleteAttribute** .</span><span class="sxs-lookup"><span data-stu-id="08f8a-387">As a result, the five types related to Passport in **System.Web.Security** are now marked with the **ObsoleteAttribute** attribute.</span></span>

<a id="0.1__The_MenuItem.PopOutImageUrl_Propert"></a><a id="0.1__Toc256770159"></a>

## <a name="the-menuitempopoutimageurl-property-fails-to-render-an-image-in-aspnet-4"></a><span data-ttu-id="08f8a-388">Свойство MenuItem. Попаутимажеурл не может обработать изображение в ASP.NET 4</span><span class="sxs-lookup"><span data-stu-id="08f8a-388">The MenuItem.PopOutImageUrl Property Fails to Render an Image in ASP.NET 4</span></span>

<span data-ttu-id="08f8a-389">В ASP.NET 3,5 свойство *MenuItem. попаутимажеурл* позволяет указать URL-адрес изображения, отображаемого в пункте меню, чтобы указать, что у пункта меню есть динамическое подменю.</span><span class="sxs-lookup"><span data-stu-id="08f8a-389">In ASP.NET 3.5, the *MenuItem.PopOutImageUrl* property lets you specify the URL for an image that is displayed in a menu item to indicate that the menu item has a dynamic submenu.</span></span> <span data-ttu-id="08f8a-390">В следующем примере показано, как задать это свойство в разметке в ASP.NET 3,5.</span><span class="sxs-lookup"><span data-stu-id="08f8a-390">The following example shows how to specify this property in markup in ASP.NET 3.5.</span></span>

[!code-aspx[Main](breaking-changes/samples/sample11.aspx)]

<span data-ttu-id="08f8a-391">В результате изменения проекта в ASP.NET 4 выходные данные для *попаутимажеурл* не отображаются, если свойство задано для класса *MenuItem* .</span><span class="sxs-lookup"><span data-stu-id="08f8a-391">As a result of a design change in ASP.NET 4, no output is rendered for the *PopOutImageUrl* if the property is set for the *MenuItem* class.</span></span> <span data-ttu-id="08f8a-392">Вместо этого необходимо указать URL-адрес изображения непосредственно в элементе управления *Menu* с помощью свойства *статикпопаутимажеурл* или *динамикпопаутимажеурл* .</span><span class="sxs-lookup"><span data-stu-id="08f8a-392">Instead, you must specify an image URL directly in the *Menu* control using either the *StaticPopOutImageUrl* property or the *DynamicPopOutImageUrl* property.</span></span> <span data-ttu-id="08f8a-393">При работе со статическим меню свойство *Menu. статикпопаутимажеурл* указывает URL-адрес изображения, которое отображается, чтобы указать, что у статического пункта меню есть подменю, как показано в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="08f8a-393">When you work with a static menu, the *Menu.StaticPopOutImageUrl* property specifies the URL for an image that is displayed in order to indicate that the static menu item has a submenu, as shown in the following example:</span></span>

[!code-aspx[Main](breaking-changes/samples/sample12.aspx)]

<span data-ttu-id="08f8a-394">Если вы работаете с динамическим меню, используйте свойство *Menu. динамикпопаутимажеурл* , чтобы указать URL-адрес изображения, которое указывает, что в элементе динамического меню есть подменю.</span><span class="sxs-lookup"><span data-stu-id="08f8a-394">If you are working with a dynamic menu, you use the *Menu.DynamicPopOutImageUrl* property to specify the URL for an image that indicates that a dynamic menu item has a submenu.</span></span> <span data-ttu-id="08f8a-395">Следующий пример аналогичен предыдущему, но показывает, как задать свойство *динамикпопаутимажеурл* для динамического меню.</span><span class="sxs-lookup"><span data-stu-id="08f8a-395">The following example is similar to the previous one, but shows how to set the *DynamicPopOutImageUrl* property for a dynamic menu.</span></span>

[!code-aspx[Main](breaking-changes/samples/sample13.aspx)]

<span data-ttu-id="08f8a-396">Если свойство *Menu. динамикпопаутимажеурл* не задано и свойство *Menu. динамиценабледефаултпопаутимаже* имеет значение *false*, изображение не отображается.</span><span class="sxs-lookup"><span data-stu-id="08f8a-396">If the *Menu.DynamicPopOutImageUrl* property is not set and the *Menu.DynamicEnableDefaultPopOutImage* property is set to *false*, no image is displayed.</span></span> <span data-ttu-id="08f8a-397">Аналогично, если свойство *статикпопаутимажеурл* не задано и свойство *статиценабледефаултпопаутимаже* имеет значение *false*, изображение не отображается.</span><span class="sxs-lookup"><span data-stu-id="08f8a-397">Similarly, if the *StaticPopOutImageUrl* property is not set and the *StaticEnableDefaultPopOutImage* property is set to *false*, no image is displayed.</span></span>

<span data-ttu-id="08f8a-398">При задании путей к этим свойствам используйте косую черту (/) вместо обратной косой черты (\).</span><span class="sxs-lookup"><span data-stu-id="08f8a-398">When you set the paths for these properties, use a forward slash (/) instead of a backslash (\).</span></span> <span data-ttu-id="08f8a-399">Дополнительные сведения см. в разделах [Menu. статикпопаутимажеурл и Menu. Динамикпопаутимажеурл не удается отобразить изображения, если пути содержат символы обратной косой черты](#0.1__Menu.StaticPopOutImageUrl_and_Menu. "_Menu. StaticPopOutImageUrl_and_Menu.") в других местах этого документа.</span><span class="sxs-lookup"><span data-stu-id="08f8a-399">For more information, see [Menu.StaticPopOutImageUrl and Menu.DynamicPopOutImageUrl Fail to Render Images When Paths Contain Backslashes](#0.1__Menu.StaticPopOutImageUrl_and_Menu. "_Menu.StaticPopOutImageUrl_and_Menu.") elsewhere in this document.</span></span>

<a id="0.1__Menu.StaticPopOutImageUrl_and_Menu."></a><a id="0.1__Toc256770160"></a>

## <a name="menustaticpopoutimageurl-and-menudynamicpopoutimageurl-fail-to-render-images-when-paths-contain-backslashes"></a><span data-ttu-id="08f8a-400">Menu. Статикпопаутимажеурл и Menu. Динамикпопаутимажеурл не могут визуализировать изображения, если пути содержат символы обратной косой черты</span><span class="sxs-lookup"><span data-stu-id="08f8a-400">Menu.StaticPopOutImageUrl and Menu.DynamicPopOutImageUrl Fail to Render Images When Paths Contain Backslashes</span></span>

<span data-ttu-id="08f8a-401">В ASP.NET 4 изображения, указываемые с помощью свойств *Menu. статикпопаутимажеурл* и *Menu. динамикпопаутимажеурл* , не отображаются, если путь содержит бакклашес (\).</span><span class="sxs-lookup"><span data-stu-id="08f8a-401">In ASP.NET 4, the images that you specify using the *Menu.StaticPopOutImageUrl* and *Menu.DynamicPopOutImageUrl* properties will not render if the path contains backlashes (\).</span></span> <span data-ttu-id="08f8a-402">Это изменение из более ранних версий ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="08f8a-402">This is a change from earlier versions of ASP.NET.</span></span>

<span data-ttu-id="08f8a-403">Следующий пример разметки элемента управления *Menu* показывает набор свойств *статикпопаутимажеурл* с использованием пути, содержащего обратную косую черту.</span><span class="sxs-lookup"><span data-stu-id="08f8a-403">The following example of *Menu* control markup shows the *StaticPopOutImageUrl* property set using a path that contains a backslash.</span></span> <span data-ttu-id="08f8a-404">В ASP.NET 4 изображение, указанное в свойстве, не будет отображено.</span><span class="sxs-lookup"><span data-stu-id="08f8a-404">In ASP.NET 4, the image specified in the property will not render.</span></span>

[!code-aspx[Main](breaking-changes/samples/sample14.aspx)]

<span data-ttu-id="08f8a-405">Чтобы устранить эту ошибку, измените значения пути, указанные в свойствах *статикпопаутимажеурл* и *динамикпопаутимажеурл* , чтобы использовать косую черту (/).</span><span class="sxs-lookup"><span data-stu-id="08f8a-405">To correct this issue, change path values that are specified in the *StaticPopOutImageUrl* and *DynamicPopOutImageUrl* properties to use forward slashes (/).</span></span> <span data-ttu-id="08f8a-406">В следующем примере показано это изменение:</span><span class="sxs-lookup"><span data-stu-id="08f8a-406">The following example shows this change:</span></span>

[!code-aspx[Main](breaking-changes/samples/sample15.aspx)]

<span data-ttu-id="08f8a-407">Обратите внимание, что приложения, перенесенные из более ранних версий ASP.NET в ASP.NET 4, также могут быть затронуты, поскольку свойство *MenuItem. попаутимажеурл* было изменено.</span><span class="sxs-lookup"><span data-stu-id="08f8a-407">Note that applications that were migrated from earlier versions of ASP.NET to ASP.NET 4 might also be affected, because the *MenuItem.PopOutImageUrl* property has been changed.</span></span> <span data-ttu-id="08f8a-408">Дополнительные сведения см. в описании [свойства MenuItem. попаутимажеурл для невозможности прорисовки изображения в ASP.NET 4](#0.1__The_MenuItem.PopOutImageUrl_Propert "_The_MenuItem. PopOutImageUrl_Propert") в других местах этого документа.</span><span class="sxs-lookup"><span data-stu-id="08f8a-408">For more information, see [The MenuItem.PopOutImageUrl Property Fails to Render an Image in ASP.NET 4](#0.1__The_MenuItem.PopOutImageUrl_Propert "_The_MenuItem.PopOutImageUrl_Propert") elsewhere in this document.</span></span>

<a id="0.1__Toc224729061"></a><a id="0.1__Toc255587647"></a><a id="0.1__Toc256770161"></a>

## <a name="disclaimer"></a><span data-ttu-id="08f8a-409">Отказ от ответственности</span><span class="sxs-lookup"><span data-stu-id="08f8a-409">Disclaimer</span></span>

<span data-ttu-id="08f8a-410">Это предварительный документ, он может быть существенно изменен до выхода окончательного коммерческого выпуска описанного здесь программного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="08f8a-410">This is a preliminary document and may be changed substantially prior to final commercial release of the software described herein.</span></span>

<span data-ttu-id="08f8a-411">Информация, содержащаяся в этом документе, являет собой текущее представление корпорации Майкрософт о вопросах, которые обсуждались на момент публикации.</span><span class="sxs-lookup"><span data-stu-id="08f8a-411">The information contained in this document represents the current view of Microsoft Corporation on the issues discussed as of the date of publication.</span></span> <span data-ttu-id="08f8a-412">Поскольку корпорация Майкрософт должна реагировать на изменение рыночных условий, эта информация не должна рассматриваться как обязательство корпорации Майкрософт. Корпорация Майкрософт не может гарантировать достоверность информации, предоставленной после момента публикации.</span><span class="sxs-lookup"><span data-stu-id="08f8a-412">Because Microsoft must respond to changing market conditions, it should not be interpreted to be a commitment on the part of Microsoft, and Microsoft cannot guarantee the accuracy of any information presented after the date of publication.</span></span>

<span data-ttu-id="08f8a-413">Данный технический документ предназначен только для ознакомительных целей.</span><span class="sxs-lookup"><span data-stu-id="08f8a-413">This White Paper is for informational purposes only.</span></span> <span data-ttu-id="08f8a-414">МАЙКРОСОФТ НЕ ПРЕДОСТАВЛЯЕТ НИКАКИХ ГАРАНТИЙ, ЯВНЫХ ИЛИ ПРЕДУСМОТРЕННЫХ ЗАКОНОДАТЕЛЬСТВОМ, ОТНОСИТЕЛЬНО СВЕДЕНИЙ, СОДЕРЖАЩИХСЯ В ДАННОМ ДОКУМЕНТЕ.</span><span class="sxs-lookup"><span data-stu-id="08f8a-414">MICROSOFT MAKES NO WARRANTIES, EXPRESS, IMPLIED OR STATUTORY, AS TO THE INFORMATION IN THIS DOCUMENT.</span></span>

<span data-ttu-id="08f8a-415">Ответственность за соблюдение всех авторских прав и прав на интеллектуальную собственность целиком и полностью несет пользователь.</span><span class="sxs-lookup"><span data-stu-id="08f8a-415">Complying with all applicable copyright laws is the responsibility of the user.</span></span> <span data-ttu-id="08f8a-416">Без ограничения авторских прав ни одна из частей этого документа не может быть воспроизведена, сохранена или использована в системах поиска либо передана в любой форме, любыми способами (электронными, механическими, в виде фотокопии, в виде записи или любыми другими) и для любых целей без письменного разрешения корпорации Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="08f8a-416">Without limiting the rights under copyright, no part of this document may be reproduced, stored in or introduced into a retrieval system, or transmitted in any form or by any means (electronic, mechanical, photocopying, recording, or otherwise), or for any purpose, without the express written permission of Microsoft Corporation.</span></span>

<span data-ttu-id="08f8a-417">Корпорация Майкрософт может иметь патенты, патентные заявки, охраняемые товарные знаки, авторские или другие права на интеллектуальную собственность применительно к содержимому этого документа.</span><span class="sxs-lookup"><span data-stu-id="08f8a-417">Microsoft may have patents, patent applications, trademarks, copyrights, or other intellectual property rights covering subject matter in this document.</span></span> <span data-ttu-id="08f8a-418">Без письменного разрешения корпорации Майкрософт данный документ не дает лицензии на эти патенты, охраняемые товарные знаки, авторские права и другую интеллектуальную собственность.</span><span class="sxs-lookup"><span data-stu-id="08f8a-418">Except as expressly provided in any written license agreement from Microsoft, the furnishing of this document does not give you any license to these patents, trademarks, copyrights, or other intellectual property.</span></span>

<span data-ttu-id="08f8a-419">Если не указано иное, примеры компаний, организаций, продуктов, доменных имен, адресов электронной почты, логотипов, людей, мест и событий являются вымышленными и без связи с реальными компаниями, организациями, продуктами, именами доменов, электронной почтой. адрес, Эмблема, лицо, место или событие должны быть выведены на случай.</span><span class="sxs-lookup"><span data-stu-id="08f8a-419">Unless otherwise noted, the example companies, organizations, products, domain names, email addresses, logos, people, places and events depicted herein are fictitious, and no association with any real company, organization, product, domain name, email address, logo, person, place or event is intended or should be inferred.</span></span>

<span data-ttu-id="08f8a-420">© 2010 Корпорация Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="08f8a-420">© 2010 Microsoft Corporation.</span></span> <span data-ttu-id="08f8a-421">Все права защищены.</span><span class="sxs-lookup"><span data-stu-id="08f8a-421">All rights reserved.</span></span>

<span data-ttu-id="08f8a-422">Microsoft и Windows являются охраняемыми товарными знаками корпорации Майкрософт в США и других странах.</span><span class="sxs-lookup"><span data-stu-id="08f8a-422">Microsoft and Windows are either registered trademarks or trademarks of Microsoft Corporation in the United States and/or other countries.</span></span>

<span data-ttu-id="08f8a-423">Названия фактических компаний и продуктов, упомянутые здесь, могут являться охраняемыми товарными знаками соответствующих владельцев.</span><span class="sxs-lookup"><span data-stu-id="08f8a-423">The names of actual companies and products mentioned herein may be the trademarks of their respective owners.</span></span>
