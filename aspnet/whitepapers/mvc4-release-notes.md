---
uid: whitepapers/mvc4-release-notes
title: ASP.NET MVC 4 | Документация Майкрософт
author: rick-anderson
description: В этом документе описывается версия ASP.NET MVC 4.
ms.author: riande
ms.date: 09/09/2011
ms.assetid: f014524f-25c0-4094-b8e1-886d99536f00
msc.legacyurl: /whitepapers/mvc4-release-notes
msc.type: content
ms.openlocfilehash: 0f9b4e2ba0514df4c017a192f3c2136a7eec60c7
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59413260"
---
# <a name="aspnet-mvc-4"></a>ASP.NET MVC 4

> В этом документе описывается версия ASP.NET MVC 4.


- [Замечания по установке](#_Toc303253802)
- [Документация](#_Toc303253803)
- [Поддержка](#_Toc303253804)
- [Требования к программному обеспечению](#_Toc303253805)
- [Новые возможности в ASP.NET MVC 4](#_Toc303253807)

    - [ASP.NET Web API](#_Toc317096197)
    - [Усовершенствования в шаблоны проектов по умолчанию](#_Toc303253808)
    - [Шаблон проекта для мобильных устройств](#_Toc303253809)
    - [Режимы отображения](#_Toc303253810)
    - [jQuery Mobile, переключателя и переопределения браузера](#_Toc303253811)
    - [Поддержка задачи для асинхронных контроллеров](#_Toc303253813)
    - [Пакет SDK для Azure](#_Toc303253814)
    - [Перенос базы данных](#_Toc303253818)
    - [Шаблон пустого проекта](#_Toc303253819)
    - [Добавить контроллер в любой папке проекта](#_Toc303253820)
    - [Объединение и минификация](#_Toc303253821)
    - [Включение имена входа из Facebook, а также других узлов, с помощью OAuth и OpenID](#_Toc303253822)
- [Обновление проекта ASP.NET MVC 3 до ASP.NET MVC 4](#_Toc303253806)
- [Изменения в релиз-кандидат ASP.NET MVC 4](#_Toc303253817)
- [Известные проблемы и критические изменения](#_Toc303253815)

<a id="_Toc303253802"></a>
## <a name="installation-notes"></a>Замечания по установке

ASP.NET MVC 4 для Visual Studio 2010 можно установить из [Домашняя страница ASP.NET MVC 4](../mvc/mvc4.md) с помощью установщика веб-платформы.

Мы рекомендуем удалить все ранее установленные предварительные версии ASP.NET MVC 4 до установки ASP.NET MVC 4. Бета-версия ASP.NET MVC 4 и версии-кандидата можно обновить до ASP.NET MVC 4 без удаления.

Этот выпуск не совместим с любой предварительных выпусков платформы .NET Framework 4.5. Необходимо отдельно обновить любой установленных предварительных выпусков платформы .NET Framework 4.5 до окончательной версии перед установкой ASP.NET MVC 4.

ASP.NET MVC 4 могут быть установлены и запущены side-by-side с ASP.NET MVC 3.

<a id="_Toc303253803"></a>
## <a name="documentation"></a>Документация

Документация по ASP.NET MVC доступна на веб-сайте MSDN по АДРЕСУ:

[https://go.microsoft.com/fwlink/?LinkID=243043](https://go.microsoft.com/fwlink/?LinkID=243043)

Учебники и другие сведения о ASP.NET MVC доступны на странице веб-сайта ASP.NET MVC 4 ([https://www.asp.net/mvc/mvc4](../mvc/mvc4.md)).

<a id="_Toc303253804"></a>
## <a name="support"></a>Поддержка

ASP.NET MVC 4, полностью поддерживается. Если у вас есть вопросы о работе с этого выпуска также их можно разместить на форуме ASP.NET MVC ([https://forums.asp.net/1146.aspx](https://forums.asp.net/1146.aspx)), где участники сообщества ASP.NET помогают друг другу, предоставляя полезные сведения.

<a id="_Toc303253805"></a>
## <a name="software-requirements"></a>Требования к программному обеспечению

Компоненты ASP.NET MVC 4 для Visual Studio требуется PowerShell 2.0, а также Visual Studio 2010 с пакетом обновления 1 или Visual Web Developer Express 2010 с пакетом обновления 1.

<a id="_Toc303253807"></a>
## <a name="new-features-in-aspnet-mvc-4"></a>Новые возможности в ASP.NET MVC 4

В этом разделе описаны возможности, которые были введены в версии ASP.NET MVC 4.

<a id="_Toc317096197"></a>
### <a name="aspnet-web-api"></a>ASP.NET Web API

ASP.NET MVC 4 включает в себя веб-API ASP.NET, новую платформу для создания служб HTTP, могут получить доступ широкого круга клиентов, включая браузеры и мобильные устройства. Веб-API ASP.NET также является идеальной платформой для создания служб RESTful.

Веб-API ASP.NET включает в себя поддержку следующих функций:

- **Современную модель программирования HTTP:** Непосредственно доступа и управления HTTP-запросы и ответы в веб-API с помощью объектной модели новой, строго типизированный HTTP. Соответствует модели программирования и конвейер HTTP симметрично доступен на клиенте посредством нового *HttpClient* типа.
- **Полная поддержка маршруты:** Веб-API ASP.NET поддерживает полный набор возможностей маршрутизации ASP.NET, включая параметры маршрута и ограничения маршрута. Кроме того можно используйте простые правила для сопоставления действия с HTTP-методов.
- **Согласование содержимого:** Чтобы определить корректный формат данных, возвращаемых из веб-API клиента и сервера могут работать совместно. Веб-API ASP.NET по умолчанию поддерживает XML, JSON, и форматы форму URL-адреса и вы можно расширения этой поддержки, добавив собственные модули форматирования, или даже заменять стратегия согласование содержимого по умолчанию.
- **Модель привязки и проверки:** Связыватели моделей обеспечивают простой способ извлечения данных из различных частей HTTP-запроса и преобразования этих частей сообщения в объекты .NET, которые могут использоваться при выполнении действий веб-API. Проверка также выполняется на действие параметров на основании заметок к данным.
- **Фильтры:** Веб-API ASP.NET поддерживает фильтры, включая хорошо известных фильтры, такие как *[Authorize]* атрибута. Можно создать и подключить собственные фильтры действий, авторизации и обработки исключений.
- **Построение запроса:** Используйте *[Queryable]* атрибут фильтра на действие, возвращающее *IQueryable* для включения поддержки для выполнения запросов к веб-API с помощью запроса соглашениям OData.
- **Улучшенные возможности тестирования:** Вместо того чтобы задавать сведения о HTTP в статическом контексте объектов, веб-API рабочих действий с экземплярами *HttpRequestMessage* и *HttpResponseMessage*. Создайте проект модульного теста, а также проект веб-API, чтобы начать работу быстро написание модульных тестов для функциональные возможности по работе веб-API.
- **Конфигурация на основе кода:** Настройка веб-API ASP.NET выполняется исключительно с помощью кода, оставив свои файлы config чистой. Используйте шаблон локатора службы для настройки точки расширения.
- **Улучшенная поддержка контейнеров Inversion of Control (IoC).** Веб-API ASP.NET предоставляет отличную поддержку для контейнеров IoC посредством абстракции Сопоставитель улучшенные зависимостей
- **Резидентного размещения:** Веб-API может размещаться в собственном процессе в дополнение к IIS, при этом используя всю мощь маршруты и другие возможности веб-API.
- **Создайте специальную справку и тестировании страниц.** Теперь можно легко создавать специальную справку и тестировании страниц для вашего веб-API с помощью нового *IApiExplorer* службу, чтобы получить описание завершения среды выполнения веб-API-интерфейсы.
- **Мониторинг и диагностика:** ASP.NET Web API теперь предоставляет инфраструктуру трассировки небольшого размера, которая позволяет легко интегрировать с существующими решениями ведения журнала, например System.Diagnostics, ETW и сторонних платформ ведения журналов. Можно включить трассировку, предоставляя *ITraceWriter* реализации и добавив его в конфигурацию веб-API.
- **Создание компоновки:** Используйте ASP.NET Web API *UrlHelper* для создания ссылки на связанные ресурсы в одном приложении.
- **Шаблон проекта веб-API:** Выберите новую форму проекта веб-API мастер создания проекта MVC 4, чтобы быстро приступить к работе с веб-API ASP.NET.
- **Формирование шаблонов:** Используйте **Добавление контроллера** диалогового окна, чтобы быстро сформировать контроллер веб-API на платформе Entity Framework на основе типа модели.

См. Дополнительные сведения о веб-API ASP.NET [ https://www.asp.net/web-api ](../web-api/index.md).

<a id="_Toc303253808"></a>
### <a name="enhancements-to-default-project-templates"></a>Усовершенствования в шаблоны проектов по умолчанию

Шаблон, который используется для создания новых проектов ASP.NET MVC 4 был обновлен для создания более современных веб-сайта:

![](mvc4-release-notes/_static/image1.png)

В дополнение к финальных включает улучшенную функциональность в новый шаблон. Шаблон использует методику адаптивной отрисовки для поиска подходят для использования в классических браузерах и браузеры мобильных устройств без какой-либо настройки.

![](mvc4-release-notes/_static/image2.png)

См. в разделе адаптивной рендеринг в действии, можно использовать эмулятор мобильных устройств или просто попробуйте изменить размер окна классического браузера меньше. При получении окна браузера достаточно небольшой, разметку страницы изменится.

<a id="_Toc303253809"></a>
### <a name="mobile-project-template"></a>Шаблон проекта для мобильных устройств

Если вы начинаете новый проект и создать на сайте специально для мобильных устройств и браузеров tablet, можно использовать новый шаблон проекта мобильного приложения. Это основано на jQuery Mobile, библиотеки с открытым исходным кодом для создания оптимизированных для сенсорных экранов пользовательского интерфейса:

![](mvc4-release-notes/_static/image3.png)

Этот шаблон содержит ту же структуру приложения, как шаблон веб-приложение (и код контроллера практически идентичен), но это оформленных с помощью jQuery Mobile хорошо выглядят и ведут себя для мобильных устройств с сенсорным управлением. Дополнительные сведения о том, как структуры и стиля мобильного пользовательского интерфейса, см. в разделе [веб-сайт jQuery мобильного проекта](http://jquerymobile.com/).

При наличии сайта, ориентированных на рабочий стол, что вы хотите добавить представления, оптимизированный для мобильных устройств, чтобы, или если вы хотите создать один сайт, который выступает по-разному оформленного представлений для настольных и мобильных браузеров, можно использовать новую функцию режимов отображения. (См. следующий раздел).

<a id="_Toc303253810"></a>
### <a name="display-modes"></a>Режимы отображения

Новая функция режимов отображения для работы приложения выберите представления, в зависимости от браузера, отправляющая запрос. Например если классический браузер запрашивает на домашнюю страницу, в приложении можно использовать шаблон Views\Home\Index.cshtml. Если браузер мобильного устройства запрашивает на домашнюю страницу, приложение может возвратить Views\Home\Index.mobile.cshtml шаблона.

Макетов и частичных представлений можно также переопределить для конкретного браузера типов. Пример:

- Если папка Views\Shared содержит оба \_Layout.cshtml и \_Layout.mobile.cshtml шаблоны по умолчанию, то приложение будет использовать \_Layout.mobile.cshtml во время запросов из браузеров мобильных устройств и \_Layout.cshtml во время других запросов.
- Если папка содержит оба \_MyPartial.cshtml и \_MyPartial.mobile.cshtml, инструкция @Html.Partial(»\_MyPartial») будут отображаться \_MyPartial.mobile.cshtml во время запросы от мобильных устройств обозреватели, и \_MyPartial.cshtml во время других запросов.

Если вы хотите создать более конкретные представления, макетов и частичных представлений для других устройств, можно зарегистрировать новый *DefaultDisplayMode* экземпляра, чтобы указать, какое имя будет поиска, если запрос удовлетворяет определенным условиям. Например, можно добавить следующий код, чтобы *приложения\_запустить* метод в файле Global.asax, чтобы зарегистрировать строку «iPhone» в качестве режим просмотра, который применяется при браузера Apple iPhone запроса:

[!code-csharp[Main](mvc4-release-notes/samples/sample1.cs)]

После выполнения этого кода, когда это Apple iPhone браузер отправляет запрос, приложение будет использовать Views\Shared\\_Layout.iPhone.cshtml макета (если он существует). Дополнительные сведения о режиме отображения, см. в разделе [ASP.NET MVC 4 мобильных функций](../mvc/overview/older-versions/aspnet-mvc-4-mobile-features.md). Приложения с помощью DisplayModeProvider следует установить [основных DisplayModes](http://nuget.org/packages/Microsoft.AspNet.Mvc.FixedDisplayModes) пакет NuGet. [ASP.NET Осень 2012 с обновлением](https://go.microsoft.com/fwlink/?LinkID=271322) включает в себя [основных DisplayModes](http://nuget.org/packages/Microsoft.AspNet.Mvc.FixedDisplayModes) пакет NuGet в новые шаблоны проектов. См. в разделе [Fixedd ошибки кэширования в Mobile для ASP.NET MVC 4](https://blogs.msdn.com/b/rickandy/archive/2012/09/17/asp-net-mvc-4-mobile-caching-bug-fixed.aspx) подробные исправления.

<a id="_Toc303253811"></a>
### <a name="jquery-mobile-and-mobile-features"></a>jQuery Mobile и Mobile компоненты

Сведения о разработке мобильных приложений с помощью ASP.NET MVC 4 с помощью jQuery Mobile, см. в руководстве [ASP.NET MVC 4 мобильных функций](../mvc/overview/older-versions/aspnet-mvc-4-mobile-features.md).

<a id="_Toc303253813"></a>
### <a name="task-support-for-asynchronous-controllers"></a>Поддержка задачи для асинхронных контроллеров

Теперь можно написать асинхронные методы действия, как единый методы, которые возвращают объект типа *задачи* или *задачи&lt;ActionResult&gt;*.

 Дополнительные сведения см. в разделе [использование асинхронных методов в ASP.NET MVC 4](../mvc/overview/performance/using-asynchronous-methods-in-aspnet-mvc-4.md).

<a id="_Toc303253814"></a>
### <a name="azure-sdk"></a>Пакет SDK для Azure

ASP.NET MVC 4 поддерживает 1.6 и более поздних версиях Windows Azure SDK.

<a id="_Toc303253818"></a>
### <a name="database-migrations"></a>Перенос базы данных

Проекты ASP.NET MVC 4 теперь включают Entity Framework 5. Одно из замечательных возможностей Entity Framework 5 поддерживается перенос базы данных. Эта функция позволяет легко развивать схемы базы данных с помощью миграции, ориентированный на код, при сохранении данных в базе данных. Дополнительные сведения о миграции базы данных, см. в разделе [Добавление нового поля в модель Movie и таблицу](../mvc/overview/older-versions/getting-started-with-aspnet-mvc4/adding-a-new-field-to-the-movie-model-and-table.md) в [введение в ASP.NET MVC 4 учебника](../mvc/overview/older-versions/getting-started-with-aspnet-mvc4/intro-to-aspnet-mvc-4.md).

<a id="_Toc303253819"></a>
### <a name="empty-project-template"></a>Шаблон пустого проекта

Таким образом, вы можете начать с нуля совершенно MVC пустого шаблона проекта будет по-настоящему очищен. Более раннюю версию шаблон пустого проекта был переименован в базовый.

<a id="_Toc303253820"></a>
### <a name="add-controller-to-any-project-folder"></a>Добавить контроллер в любой папке проекта

Теперь можно правой кнопкой мыши и выберите **Добавление контроллера** из любой папки в проекте MVC. Это обеспечивает большую гибкость для упорядочения своих контроллерах, любым способом, включая сохранение контроллеров MVC и веб-API в разных папках.

<a id="_Toc303253821"></a>
### <a name="bundling-and-minification"></a>Объединение и минификация

Объединение и Минификация framework позволяет уменьшить количество HTTP-запросов, которые веб-страницы необходимо сделать, объединив отдельные файлы в один объединенный файл для сценариев и CSS. Затем его можно уменьшить общий размер запросов путем уменьшения содержимое пакета. Минификация может включать такие действия, таким как устранение пробела, чтобы сократить имена переменных даже свертывающейся селекторов CSS на основе их семантики. Пакеты объявляются и настроены в код на них легко ссылаться в представлениях, с помощью вспомогательных методов, которые можно создать либо одну ссылку пакета или при отладке нескольких ссылки на отдельные содержимое пакета. Дополнительные сведения см. в разделе [объединение и Минификация](../mvc/overview/performance/bundling-and-minification.md).

<a id="_Toc303253822"></a>
### <a name="enabling-logins-from-facebook-and-other-sites-using-oauth-and-openid"></a>Включение имена входа из Facebook, а также других узлов, с помощью OAuth и OpenID

Шаблоны по умолчанию в шаблоне проекта ASP.NET MVC 4 Интернет теперь включает поддержку для имени входа OAuth и OpenID, с помощью библиотека DotNetOpenAuth. Сведения о настройке поставщика OAuth или OpenID, см. в разделе [поддержку протокола OAuth или OpenID для веб-форм, MVC и веб-страниц](https://blogs.msdn.com/b/webdev/archive/2012/08/15/oauth-openid-support-for-webforms-mvc-and-webpages.aspx) и [OAuth и OpenID компонентов в документации по ASP.NET Web Pages](../web-pages/overview/releases/top-features-in-web-pages-2.md#oauthsetup).

<a id="_Toc303253806"></a>
## <a name="upgrading-an-aspnet-mvc-3-project-to-aspnet-mvc-4"></a>Обновление проекта ASP.NET MVC 3 до ASP.NET MVC 4

ASP.NET MVC 4 может устанавливаться параллельно с ASP.NET MVC 3 на одном компьютере, который обеспечивает гибкость в выборе, когда следует обновить приложение ASP.NET MVC 3 до ASP.NET MVC 4.

Самый простой способ обновления — для создания нового проекта ASP.NET MVC 4 и скопируйте все представления, контроллеры, кода и содержимое файлов из существующего проекта MVC 3 в новый проект и затем обновление ссылок на сборку в новый проект в соответствии с любой шаблон не MVC в включенные assembiles, которую вы используете. Если вы внесли изменения в файл Web.config в проекте MVC 3, необходимо также слияние этих изменений в файл Web.config в проекте MVC 4.

Чтобы вручную обновить существующее приложение ASP.NET MVC 3 до версии 4, сделайте следующее:

1. В файле Web.config все файлы в проекте (имеется в корневом каталоге проекта, в папке Views и в папке Views каждой области в проекте), заменить все экземпляры следующий текст (Примечание: System.Web.WebPages, Version = 1.0.0.0 не найден в проектах, созданных с помощью Visual Studio 2012): 

    [!code-console[Main](mvc4-release-notes/samples/sample2.cmd)]

    соответствующие следующим текстом:

    [!code-console[Main](mvc4-release-notes/samples/sample3.cmd)]
2. В корневом файле Web.config, обновить *webPages:Version* элемент «2.0.0.0» и добавьте новую *PreserveLoginUrl* ключом, имеющим значение «true»: 

    [!code-xml[Main](mvc4-release-notes/samples/sample4.xml)]
3. В обозревателе решений щелкните правой кнопкой мыши в ссылках и выберите Управление пакетами NuGet. В левой области выберите **источник официального пакета Online\NuGet**, затем обновите следующие:

    - ASP.NET MVC 4
    - (Необязательно) jQuery, jQuery проверки и пользовательский Интерфейс jQuery
    - (Необязательно) Платформа Entity Framework
    - (Optonal) Modernizr
4. В обозревателе решений щелкните правой кнопкой мыши имя проекта и затем выберите команду Выгрузить проект. Затем щелкните правой кнопкой мыши имя и выберите "Правка" *имя_проекта*.csproj.
5. Найдите *ProjectTypeGuids* и замените {E53F8FEA-EAE0-44A6-8774-FFD645390401} с {E3E379DF-F4C6-4180-9B81-6769533ABE47}.
6. Сохраните изменения, закройте файл проекта (csproj), которую вы изменяете, щелкните правой кнопкой мыши проект и выберите команду перезагрузить проект.
7. Если проект ссылается на все библиотеки сторонних производителей скомпилированы с помощью предыдущих версий ASP.NET MVC, откройте в корневом файле Web.config и добавьте следующие три *bindingRedirect* элементов под  *Конфигурация* раздел: 

    [!code-xml[Main](mvc4-release-notes/samples/sample5.xml)]

<a id="_Toc303253817"></a>
## <a name="changes-from-aspnet-mvc-4-release-candidate"></a>Изменения в релиз-кандидат ASP.NET MVC 4

Заметки о выпуске для версии-кандидата ASP.NET MVC 4 можно найти здесь:

Основные изменения из версии-кандидата ASP.NET MVC 4 в этом выпуске приведены ниже:

- **Каждой конфигурации контроллера:** Контроллеры веб-API ASP.NET можно отнести с пользовательским атрибутом, который реализует *IControllerConfiguration* настроить свои собственные модули форматирования, средство выбора действий и привязки параметра. *HttpControllerConfigurationAttribute* был удален.
- **На обработчики маршрутов сообщений:** Теперь можно указать обработчик окончательный сообщений в цепочке запроса для данного маршрута. Это обеспечивает поддержку платформ вдоль поездке использует маршрутизацию для перенаправления с собственной (отличным от*IHttpController*) конечные точки.
- **Уведомления о ходе выполнения:** *ProgressMessageHandler* создает уведомления о ходе выполнения для отправляемых объектов запроса и загружаемых объектов ответа. С помощью этого обработчика возможна для отслеживания как далеко текст запроса для отправки или загрузки текст ответа.
- **Отправьте содержимое:** *PushStreamContent* класс позволяет реализовать сценарии, где производителю данных требуется для записи непосредственно в запрос или ответ (синхронно или асинхронно) с помощью потока. Когда *PushStreamContent* готов принять данные, он вызывает делегат действия с в выходной поток. Для по мере необходимости и закрыть долго завершения потока, при написании разработчик может затем записи в поток. *PushStreamContent* обнаруживает закрытие потока и завершения базовой асинхронной *задачи* для записи содержимого.
- **Создание сообщения об ошибках:** Используйте *HttpError* тип для согласованного представления информации об ошибке из таких как ошибки и исключения учитывая при этом *IncludeErrorDetailPolicy*. Используйте новый *CreateErrorResponse* методы расширения для создания сообщения об ошибках с *HttpError* как содержимое. *HttpError* содержимое является полностью содержимого согласование.
- **Удалены MediaRangeMapping:** Диапазоны типов мультимедиа теперь обрабатываются согласователь содержимого по умолчанию.
- **Привязка параметра по умолчанию для параметров простого типа — теперь [FromUri]:** В предыдущих версиях ASP.NET Web API привязки параметра по умолчанию для параметров простого типа используется привязка модели. Привязка параметра по умолчанию для параметров простого типа — теперь *[FromUri]*.
- **Выбор действия учитывает обязательные параметры:** Выбор действий в веб-API ASP.NET будет теперь только выберите действие, если указаны все необходимые параметры, полученные из URI. Параметр можно указать как необязательные, указав значение по умолчанию для аргумента в сигнатуре метода действия.
- **Настройка привязки параметров HTTP.** Используйте *ParameterBindingAttribute* для настройки привязки параметра для параметра определенное действие или использовать *ParameterBindingRules* на *HttpConfiguration*для настройки привязки параметров более широко.
- **Улучшения MediaTypeFormatter:** Модули форматирования теперь имеют доступ к полной *HttpContent* экземпляра.
- **Узел буферизации Выбор политики:** Реализовать и настроить *IHostBufferPolicySelector* службы в веб-API ASP.NET, чтобы включить узлы определить политику для буферизации при для использования.
- **Сертификаты клиентов доступа в независимо от узла:** Используйте *GetClientCertificate* метод расширения для получения предоставленного сертификата клиента из сообщения-запроса.
- **Расширяемость согласование содержимого:** Настройка согласования содержимого путем наследования от *DefaultContentNegotiator* и переопределение любую часть согласования содержимого, в котором вы хотите.
- **Поддержку для возвращения 406 неприемлемо ответов:** Теперь может возвращать ответы 406 неприемлемо в веб-API ASP.NET, если не найден подходящий модуль форматирования, создав *DefaultContentNegotiator* с *excludeMatchOnTypeOnly* параметру присвоить *true*.
- **Чтение данных формы в качестве NameValueCollection или JToken:** Можно считывать данные формы в строке запроса URI или в тексте запроса как *NameValueCollection* с помощью *ParseQueryString* и *ReadAsFormDataAsync* расширения методы соответственно. Аналогичным образом, вы можете считывать данные формы в строке запроса URI или в тексте запроса как *JToken* с помощью *TryReadQueryAsJson* и *ReadAsAsync*&lt;T&gt; методы расширения соответственно.
- **Составной улучшения:** Теперь можно написать *MultipartStreamProvider* , полностью соответствующий тип MIME составных данных, что может выполнять чтение и представит результат оптимальным способом для пользователя. Можно также подключить шаг последующей обработки на *MultipartStreamProvider* , позволяющий реализация, которую нужно сделать независимо от post, его обработка намеревается на части составного текста MIME. Например *MultipartFormDataStreamProvider* реализации, считывает HTML-форма частей данных и добавляет их в *NameValueCollection* так, чтобы они легко попасть в от вызывающего пользователя.
- **Усовершенствования создания ссылки:** *UrlHelper* больше не зависит от *HttpControllerContext*. Теперь вы можете просматривать *UrlHelper* в любом контексте, где *HttpRequestMessage* доступен.
- **Изменение порядка выполнения обработчика сообщений:** Обработчики сообщений теперь выполняются в порядке, в котором они настроены вместо в обратном порядке.
- **Вспомогательный корректную работу обработчики сообщений:** Новый *HttpClientFactory* , можно добавить в *DelegatingHandlers* и создайте *HttpClient* с требуемой готова к работе конвейера. Он также предоставляет функциональные возможности корректную работу с альтернативным внутренних обработчиков (по умолчанию используется *HttpClientHandler*) также, как и привязка при использовании *HttpMessageInvoker* или другой  *DelegatingHandler* вместо *HttpClient* как top-invoker.
- **Поддержка сети доставки содержимого веб-ASP.NET:** Оптимизация веб-ASP.NET теперь обеспечивает поддержку альтернативных путей CDN, позволяя указывать для каждого пакета дополнительный URL-адрес, который указывает этот ресурс в сети доставки содержимого. Поддержка CDN позволяет получить наборы скриптов и стилей географически ближе к конечным пользователям веб-приложений. Рабочие приложения должны реализовывать переход на резервный ресурс, если CDN недоступен. Протестируйте резервный вариант.
- **Направляет веб-API ASP.NET и конфигурации переносится в *WebApiConfig.Register* статический метод, который может быть resused в коде теста.** Маршруты веб-API ASP.NET ранее были добавлены в *RouteConfig.RegisterRoutes* вместе с MVC стандартных маршрутов. По умолчанию, направляет веб-API ASP.NET и конфигурации теперь обрабатываются в отдельном *WebApiConfig.Register* метод, чтобы упростить тестирование.

<a id="_Toc303253815"></a>
## <a name="known-issues-and-breaking-changes"></a>Известные проблемы и критические изменения

- **Версия RC и RTM ASP.NET MVC 4 возвращается кэшированным представлениям рабочего стола неправильно в том случае, если мобильных представлений должны быть возвращены.**

    - См. в разделе [ASP.NET MVC 4 Mobile кэширование ошибки основных](https://blogs.msdn.com/b/rickandy/archive/2012/09/17/asp-net-mvc-4-mobile-caching-bug-fixed.aspx) подробные исправления. Исправления можно установить из [основных DisplayModes](http://nuget.org/packages/Microsoft.AspNet.Mvc.FixedDisplayModes) пакет NuGet.
- **Критические изменения в модуль представлений Razor**. Следующие типы были удалены из *System.Web.Mvc.Razor*: 

    - *ModelSpan*
    - *MvcVBRazorCodeGenerator*
    - *MvcCSharpRazorCodeGenerator*
    - *MvcVBRazorCodeParser*

  Также были удалены следующие методы: 

    - *MvcCSharpRazorCodeParser.ParseInheritsStatement(System.Web.Razor.Parser.CodeBlockInfo)*
    - *MvcWebPageRazorHost.DecorateCodeGenerator(System.Web.Razor.Generator.RazorCodeGenerator)*
    - *MvcVBRazorCodeParser.ParseInheritsStatement(System.Web.Razor.Parser.CodeBlockInfo)*
- **Если WebMatrix.WebData.dll включен в каталоге/Bin приложения ASP.NET MVC 4, она имеет над URL-адрес для проверки подлинности форм.** Добавление сборки WebMatrix.WebData.dll приложения (например, выбрав «ASP.NET веб-страницы с синтаксисом Razor» при использовании диалогового окна Добавление развертываемых зависимостей) будет переопределять перенаправления входа проверки подлинности/учетная запись входа в систему вместо / Учетная запись или имя пользователя по умолчанию ASP.NET MVC учетной записи контроллера должным образом. Чтобы предотвратить такое поведение и использовать URL-адрес уже указан в разделе проверки подлинности файла Web.config, можно добавить appSetting с именем PreserveLoginUrl и присвойте ему значение true: 

    [!code-xml[Main](mvc4-release-notes/samples/sample6.xml)]
- **Диспетчер пакетов NuGet не устанавливается при установке ASP.NET MVC 4 для параллельных установок Visual Studio 2010 и Visual Web Developer 2010.** Для запуска Visual Studio 2010 и Visual Web Developer 2010 параллельно с ASP.NET MVC 4 необходимо установить ASP.NET MVC 4 после уже были установлены обе версии Visual Studio.
- **При удалении ASP.NET MVC 4 завершается ошибкой, если необходимые компоненты уже был удален.** Чтобы полностью удалить ASP.NET MVC 4you необходимо удалить перед удалением Visual Studio ASP.NET MVC 4.
- **Установка ASP.NET MVC 4 прерывает приложения ASP.NET MVC 3 RTM.** Выпуска приложений ASP.NET MVC 3, которые были созданы с RTM (не с [обновления средств ASP.NET MVC 3](https://www.microsoft.com/download/details.aspx?id=1491) release) для работы side-by-side, с помощью ASP.NET MVC 4 требуется следующие изменения. Построение проекта без сохранения результатов обновления в ошибки компиляции. 

    **Обязательные обновления**

  1. В корневом файле Web.config, добавьте новый *&lt;appSettings&gt;* запись с ключом *webPages:Version* и значение *1.0.0.0*. 

      [!code-xml[Main](mvc4-release-notes/samples/sample7.xml)]
  2. В обозревателе решений щелкните правой кнопкой мыши имя проекта и затем выберите команду Выгрузить проект. Затем щелкните правой кнопкой мыши имя и выберите "Правка" *имя_проекта*.csproj.
  3. Найдите ссылки на следующие сборки: 

      [!code-xml[Main](mvc4-release-notes/samples/sample8.xml)]

      Замените их следующим кодом:

      [!code-xml[Main](mvc4-release-notes/samples/sample9.xml)]
  4. Сохраните изменения, закройте файл проекта (csproj), редактирования, а затем щелкните правой кнопкой мыши проект и выберите перезагрузить.

- **Изменение проекта ASP.NET MVC 4 для целевой 4.0 с версии 4.5 не обновляет ссылку на сборку EntityFramework:** Если изменение проекта ASP.NET MVC 4 для целевой 4.0 после предназначенных 4.5 ссылку на сборку EntityFramework по-прежнему будет указывать до версии 4.5. Для устранения этой проблемы удаления и повторной установки пакета EntityFramework NuGet.
- **«403 запрещено» при запуске приложения ASP.NET MVC 4 в Azure после изменения целевой 4.0 с версии 4.5:** Если изменение проекта ASP.NET MVC 4 для целевой 4.0 после предназначенных 4.5, а затем развернуть в Azure может появиться ошибка 403 Forbidden во время выполнения. Чтобы обойти эту проблему, добавьте следующую команду, чтобы ваш файл web.config: `<modules runAllManagedModulesForAllRequests="true" />`
- **Visual Studio 2012 аварийно завершает работу, при вводе "\' в строковом литерале в файле Razor.** Для работы этого введите закрывающую кавычку строкового литерала, сначала.
- <strong>Перейдя к &quot;учетной записи и управление&quot; в результатах Интернет шаблона ошибка среды выполнения для CHS, TRK и CHT языков.</strong> Для устранения проблемы измените страницу, можно разделить <em>@User.Identity.Name</em> , поместив его как единственное содержимое в <em>&lt;строгого&gt;</em> тега.
- **Поставщики Google и LinkedIn, не поддерживаются в веб-сайтах Azure.** Использование поставщиков альтернативные проверки подлинности, при развертывании на веб-сайтах Azure.
- **При использовании UriPathExtensionMapping с IIS 8 Express и IIS, при попытке использовать расширение получит ошибки 404 не найдено.** Обработчик статических файлов будет препятствовать выполнению запросов к веб-API, использующие *UriPathExtensionMappings*. Задайте *runAllManagedModulesForAllRequests = true* в файле web.config, чтобы решить эту проблему.
- **Метод Controller.Execute больше не вызывается.** Все контроллеры MVC теперь всегда выполняются асинхронно.
