---
uid: whitepapers/what-is-new-in-aspnet-mvc
title: Новые возможности ASP.NET MVC 2 | Документация Майкрософт
author: rick-anderson
description: В этом документе описаны новые функции и усовершенствования, появившиеся в ASP.NET MVC 2. Этот документ также доступен для загрузки.
ms.author: riande
ms.date: 04/20/2010
ms.assetid: 69a8d6f8-4b10-4602-8822-2d6c05fc432b
msc.legacyurl: /whitepapers/what-is-new-in-aspnet-mvc
msc.type: content
ms.openlocfilehash: 1a0a29241d8afecd295b11013b27621b21c9ed52
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "86162721"
---
# <a name="whats-new-in-aspnet-mvc-2"></a><span data-ttu-id="1dd46-104">Новые возможности ASP.NET MVC 2</span><span class="sxs-lookup"><span data-stu-id="1dd46-104">What's New in ASP.NET MVC 2</span></span>

> <span data-ttu-id="1dd46-105">В этом документе описаны новые функции и усовершенствования, появившиеся в ASP.NET MVC 2.</span><span class="sxs-lookup"><span data-stu-id="1dd46-105">This document describes new features and improvements introduced in ASP.NET MVC 2.</span></span> <span data-ttu-id="1dd46-106">Этот документ также доступен для [загрузки](https://download.microsoft.com/download/F/1/6/F16F9AF9-8EF4-4845-BC97-639791D5699C/WhatIsNewInMVC_2.pdf)</span><span class="sxs-lookup"><span data-stu-id="1dd46-106">This document is also available for [Download](https://download.microsoft.com/download/F/1/6/F16F9AF9-8EF4-4845-BC97-639791D5699C/WhatIsNewInMVC_2.pdf)</span></span>

<span data-ttu-id="1dd46-107">[Общие](#_TOC1) </span><span class="sxs-lookup"><span data-stu-id="1dd46-107">[Introduction](#_TOC1) </span></span>  
<span data-ttu-id="1dd46-108">[Обновление проекта ASP.NET MVC 1,0 до ASP.NET MVC 2](#_TOC2) </span><span class="sxs-lookup"><span data-stu-id="1dd46-108">[Upgrading an ASP.NET MVC 1.0 Project to ASP.NET MVC 2](#_TOC2) </span></span>  
<span data-ttu-id="1dd46-109">[Новые возможности](#_TOC3) </span><span class="sxs-lookup"><span data-stu-id="1dd46-109">[New Features](#_TOC3) </span></span>  
<span data-ttu-id="1dd46-110">[Шаблоны вспомогательных функций](#_TOC3_1) </span><span class="sxs-lookup"><span data-stu-id="1dd46-110">[Templated Helpers](#_TOC3_1) </span></span>  
<span data-ttu-id="1dd46-111">[Зон](#_TOC3_2) </span><span class="sxs-lookup"><span data-stu-id="1dd46-111">[Areas](#_TOC3_2) </span></span>  
<span data-ttu-id="1dd46-112">[Поддержка асинхронных контроллеров](#_TOC3_3) </span><span class="sxs-lookup"><span data-stu-id="1dd46-112">[Support for Asynchronous Controllers](#_TOC3_3) </span></span>  
<span data-ttu-id="1dd46-113">[Поддержка DefaultValueAttribute в параметрах метода действия](#_TOC3_4) </span><span class="sxs-lookup"><span data-stu-id="1dd46-113">[Support for DefaultValueAttribute in Action-Method Parameters](#_TOC3_4) </span></span>  
<span data-ttu-id="1dd46-114">[Поддержка привязки двоичных данных с помощью связывателей моделей](#_TOC3_5) </span><span class="sxs-lookup"><span data-stu-id="1dd46-114">[Support for Binding Binary Data with Model Binders](#_TOC3_5) </span></span>  
<span data-ttu-id="1dd46-115">[Классы ModelMetadata и Моделметадатапровидер](#_TOC3_6) </span><span class="sxs-lookup"><span data-stu-id="1dd46-115">[ModelMetadata and ModelMetadataProvider Classes](#_TOC3_6) </span></span>  
<span data-ttu-id="1dd46-116">[Поддержка атрибутов заметок к заметкам](#_TOC3_7) </span><span class="sxs-lookup"><span data-stu-id="1dd46-116">[Support for DataAnnotations Attributes](#_TOC3_7) </span></span>  
<span data-ttu-id="1dd46-117">[Поставщики проверки модели](#_TOC3_8) </span><span class="sxs-lookup"><span data-stu-id="1dd46-117">[Model-Validator Providers](#_TOC3_8) </span></span>  
<span data-ttu-id="1dd46-118">[Проверка на стороне клиента](#_TOC3_9) </span><span class="sxs-lookup"><span data-stu-id="1dd46-118">[Client-Side Validation](#_TOC3_9) </span></span>  
<span data-ttu-id="1dd46-119">[Новые фрагменты кода для Visual Studio 2010](#_TOC3_10) </span><span class="sxs-lookup"><span data-stu-id="1dd46-119">[New Code Snippets for Visual Studio 2010](#_TOC3_10) </span></span>  
<span data-ttu-id="1dd46-120">[Новый фильтр действий Рекуирехттпсаттрибуте](#_TOC3_11) </span><span class="sxs-lookup"><span data-stu-id="1dd46-120">[New RequireHttpsAttribute Action Filter](#_TOC3_11) </span></span>  
<span data-ttu-id="1dd46-121">[Переопределение глагола метода HTTP](#_TOC3_12) </span><span class="sxs-lookup"><span data-stu-id="1dd46-121">[Overriding the HTTP Method Verb](#_TOC3_12) </span></span>  
<span data-ttu-id="1dd46-122">[Новый класс Хидденинпутаттрибуте для шаблонов вспомогательных функций](#_TOC3_13) </span><span class="sxs-lookup"><span data-stu-id="1dd46-122">[New HiddenInputAttribute Class for Templated Helpers](#_TOC3_13) </span></span>  
<span data-ttu-id="1dd46-123">[Вспомогательный метод HTML. ValidationSummary может отображать ошибки уровня модели](#_TOC3_14) </span><span class="sxs-lookup"><span data-stu-id="1dd46-123">[Html.ValidationSummary Helper Method Can Display Model-Level Errors](#_TOC3_14) </span></span>  
<span data-ttu-id="1dd46-124">[Шаблоны T4 в Visual Studio создают код, относящийся к целевой версии](#_TOC3_15)[улучшений API](#_TOC4) .NET Framework</span><span class="sxs-lookup"><span data-stu-id="1dd46-124">[T4 Templates in Visual Studio Generate Code that is Specific to the Target Version of the .NET Framework](#_TOC3_15)[API Improvements](#_TOC4)</span></span>  
[<span data-ttu-id="1dd46-125">Критические изменения</span><span class="sxs-lookup"><span data-stu-id="1dd46-125">Breaking Changes</span></span>](#_TOC5)  
[<span data-ttu-id="1dd46-126">Отказ от ответственности</span><span class="sxs-lookup"><span data-stu-id="1dd46-126">Disclaimer</span></span>](#_TOC6)  

## <a name="introduction"></a><a id="_TOC1"></a><span data-ttu-id="1dd46-127">Общие</span><span class="sxs-lookup"><span data-stu-id="1dd46-127">Introduction</span></span>

<span data-ttu-id="1dd46-128">ASP.NET MVC 2 строится на ASP.NET MVC 1,0 и содержит большой набор усовершенствований и функций, которые нацелены на повышение производительности.</span><span class="sxs-lookup"><span data-stu-id="1dd46-128">ASP.NET MVC 2 builds on ASP.NET MVC 1.0 and introduces a large set of enhancements and features that are focused on increasing productivity.</span></span> <span data-ttu-id="1dd46-129">Этот выпуск совместим с ASP.NET MVC 1,0, поэтому все ваши знания, навыки, код и расширения для ASP.NET MVC 1,0 продолжают действовать.</span><span class="sxs-lookup"><span data-stu-id="1dd46-129">This release is compatible with ASP.NET MVC 1.0, so all your knowledge, skills, code, and extensions for ASP.NET MVC 1.0 continue to apply.</span></span>

<span data-ttu-id="1dd46-130">Дополнительные сведения о ASP.NET MVC см. в следующих ресурсах:</span><span class="sxs-lookup"><span data-stu-id="1dd46-130">For more information about ASP.NET MVC, visit the following resources:</span></span>

- [<span data-ttu-id="1dd46-131">Документация по ASP.NET MVC на MSDN</span><span class="sxs-lookup"><span data-stu-id="1dd46-131">ASP.NET MVC documentation on MSDN</span></span>](https://go.microsoft.com/fwlink/?LinkId=159758)
- [<span data-ttu-id="1dd46-132">Веб-сайт ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="1dd46-132">The ASP.NET MVC Web site</span></span>](https://asp.net/mvc/)
- [<span data-ttu-id="1dd46-133">Форумы ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="1dd46-133">The ASP.NET MVC forums</span></span>](https://forums.asp.net/1146.aspx)

## <a name="upgrading-an-aspnet-mvc-10-project-to-aspnet-mvc-2"></a><a id="_TOC2"></a><span data-ttu-id="1dd46-134">Обновление проекта ASP.NET MVC 1,0 до ASP.NET MVC 2</span><span class="sxs-lookup"><span data-stu-id="1dd46-134">Upgrading an ASP.NET MVC 1.0 Project to ASP.NET MVC 2</span></span>

<span data-ttu-id="1dd46-135">ASP.NET MVC 2 может быть установлен параллельно с ASP.NET MVC 1,0 на том же сервере, что дает разработчикам возможность гибко выбирать время обновления приложения ASP.NET MVC 1,0 до ASP.NET MVC 2.</span><span class="sxs-lookup"><span data-stu-id="1dd46-135">ASP.NET MVC 2 can be installed side by side with ASP.NET MVC 1.0 on the same server, which gives application developers flexibility in choosing when to upgrade an ASP.NET MVC 1.0 application to ASP.NET MVC 2.</span></span> <span data-ttu-id="1dd46-136">Сведения о том, как выполнить обновление, см. в документе [Обновление приложения ASP.NET mvc 1,0 до ASP.NET MVC 2](https://go.microsoft.com/fwlink/?LinkID=185459).</span><span class="sxs-lookup"><span data-stu-id="1dd46-136">For information on how to upgrade, see the document [Upgrading an ASP.NET MVC 1.0 Application to ASP.NET MVC 2](https://go.microsoft.com/fwlink/?LinkID=185459).</span></span>

## <a name="new-features"></a><a id="_TOC3"></a><span data-ttu-id="1dd46-137">Новые возможности</span><span class="sxs-lookup"><span data-stu-id="1dd46-137">New Features</span></span>

<span data-ttu-id="1dd46-138">В этом разделе описаны функции, которые появились в выпуске MVC 2.</span><span class="sxs-lookup"><span data-stu-id="1dd46-138">This section describes features that have been introduced in the MVC 2 release.</span></span>

### <a name="templated-helpers"></a><a id="_TOC3_1"></a><span data-ttu-id="1dd46-139">Шаблоны вспомогательных функций</span><span class="sxs-lookup"><span data-stu-id="1dd46-139">Templated Helpers</span></span>

<span data-ttu-id="1dd46-140">Шаблонные вспомогательные методы позволяют автоматически связывать элементы HTML для редактирования и вывода с типами данных.</span><span class="sxs-lookup"><span data-stu-id="1dd46-140">Templated helpers let you automatically associate HTML elements for edit and display with data types.</span></span> <span data-ttu-id="1dd46-141">Например, если данные типа System. DateTime отображаются в представлении, элемент пользовательского интерфейса средства выбора даты может быть автоматически визуализирован.</span><span class="sxs-lookup"><span data-stu-id="1dd46-141">For example, when data of type System.DateTime is displayed in a view, a date-picker UI element can be automatically rendered.</span></span> <span data-ttu-id="1dd46-142">Это похоже на то, как шаблоны полей работают в ASP.NET платформа динамических данных.</span><span class="sxs-lookup"><span data-stu-id="1dd46-142">This is similar to how field templates work in ASP.NET Dynamic Data.</span></span> <span data-ttu-id="1dd46-143">Дополнительные сведения см. в разделе [Использование шаблонов вспомогательных функций для вывода данных](https://go.microsoft.com/fwlink/?LinkId=159062) на веб-сайте MSDN.</span><span class="sxs-lookup"><span data-stu-id="1dd46-143">For more information, see [Using Templated Helpers to Display Data](https://go.microsoft.com/fwlink/?LinkId=159062) on the MSDN Web site.</span></span>

### <a name="areas"></a><a id="_TOC3_2"></a><span data-ttu-id="1dd46-144">Зон</span><span class="sxs-lookup"><span data-stu-id="1dd46-144">Areas</span></span>

<span data-ttu-id="1dd46-145">Области позволяют организовать большой проект в несколько меньших разделов, чтобы управлять сложностью больших веб-приложений.</span><span class="sxs-lookup"><span data-stu-id="1dd46-145">Areas let you organize a large project into multiple smaller sections in order to manage the complexity of a large Web application.</span></span> <span data-ttu-id="1dd46-146">Каждый раздел ("область") обычно представляет отдельный раздел крупного веб-узла и используется для группирования связанных наборов контроллеров и представлений.</span><span class="sxs-lookup"><span data-stu-id="1dd46-146">Each section ("area") typically represents a separate section of a large Web site and is used to group related sets of controllers and views.</span></span> <span data-ttu-id="1dd46-147">Дополнительные сведения см. в разделе [Пошаговое руководство. упорядочение приложения ASP.NET MVC по областям](https://go.microsoft.com/fwlink/?LinkId=158978) на веб-сайте MSDN.</span><span class="sxs-lookup"><span data-stu-id="1dd46-147">For more information, see [Walkthrough: Organizing an ASP.NET MVC Application by Areas](https://go.microsoft.com/fwlink/?LinkId=158978) on the MSDN Web site.</span></span>

<span data-ttu-id="1dd46-148">Чтобы создать новую область, в обозреватель решений щелкните правой кнопкой мыши проект, выберите Добавить, а затем щелкните область.</span><span class="sxs-lookup"><span data-stu-id="1dd46-148">To create a new area, in Solution Explorer, right-click the project, click Add, and then click Area.</span></span> <span data-ttu-id="1dd46-149">Откроется диалоговое окно с предложением ввести имя области.</span><span class="sxs-lookup"><span data-stu-id="1dd46-149">This displays a dialog box that prompts you for the area name.</span></span> <span data-ttu-id="1dd46-150">После ввода имени области Visual Studio добавит новую область в проект.</span><span class="sxs-lookup"><span data-stu-id="1dd46-150">After you enter the area name, Visual Studio adds a new area to the project.</span></span>

<span data-ttu-id="1dd46-151">На следующем рисунке показан пример макета для проекта с двумя областями, администратором и блогами.</span><span class="sxs-lookup"><span data-stu-id="1dd46-151">The following figure shows an example layout for a project with two areas, Admin and Blogs.</span></span>

![](what-is-new-in-aspnet-mvc/_static/image1.png)

<span data-ttu-id="1dd46-152">При создании области Visual Studio добавляет класс, производный от AreaRegistration, к каждой области.</span><span class="sxs-lookup"><span data-stu-id="1dd46-152">When you create an area, Visual Studio adds a class that derives from AreaRegistration to each area.</span></span> <span data-ttu-id="1dd46-153">Этот класс необходим для регистрации области и ее маршрутов, как показано в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="1dd46-153">This class is required in order to register the area and its routes, as shown in the following example:</span></span>

[!code-csharp[Main](what-is-new-in-aspnet-mvc/samples/sample1.cs)]

<span data-ttu-id="1dd46-154">Шаблон проекта по умолчанию для ASP.NET MVC 2 включает вызов метода Регистераллареас в коде для файла Global. asax.</span><span class="sxs-lookup"><span data-stu-id="1dd46-154">The default project template for ASP.NET MVC 2 includes a call to the RegisterAllAreas method in the code for the Global.asax file.</span></span> <span data-ttu-id="1dd46-155">Этот метод регистрирует каждую область проекта, ищут все типы, производные от класса AreaRegistration, создавая экземпляр типа, а затем вызывая метод Регистерареа в экземпляре.</span><span class="sxs-lookup"><span data-stu-id="1dd46-155">This method registers each area in the project by looking for all types that derive from the AreaRegistration class, instantiating an instance of the type, and then calling the RegisterArea method on the instance.</span></span> <span data-ttu-id="1dd46-156">В следующем примере показано, как это сделать.</span><span class="sxs-lookup"><span data-stu-id="1dd46-156">The following example shows how this is done.</span></span>

[!code-csharp[Main](what-is-new-in-aspnet-mvc/samples/sample2.cs)]

<span data-ttu-id="1dd46-157">Если не указать пространство имен в методе Регистерареа, вызвав контекст. Пространства имен. Add метод. по умолчанию используется пространство имен класса регистрации.</span><span class="sxs-lookup"><span data-stu-id="1dd46-157">If you do not specify the namespace in the RegisterArea method by calling the context.Namespaces.Add method, the namespace of the registration class is used by default.</span></span>

### <a name="support-for-asynchronous-controllers"></a><a id="_TOC3_3"></a><span data-ttu-id="1dd46-158">Поддержка асинхронных контроллеров</span><span class="sxs-lookup"><span data-stu-id="1dd46-158">Support for Asynchronous Controllers</span></span>

<span data-ttu-id="1dd46-159">ASP.NET MVC 2 теперь позволяет контроллерам обрабатывать запросы асинхронно.</span><span class="sxs-lookup"><span data-stu-id="1dd46-159">ASP.NET MVC 2 now allows controllers to process requests asynchronously.</span></span> <span data-ttu-id="1dd46-160">Это может привести к повышению производительности, позволяя серверам, которые часто вызывают блокирующие операции (например, сетевые запросы), вызывать вместо них неблокирующие аналоги.</span><span class="sxs-lookup"><span data-stu-id="1dd46-160">This can lead to performance gains by allowing servers which frequently call blocking operations (like network requests) to call non-blocking counterparts instead.</span></span> <span data-ttu-id="1dd46-161">Дополнительные сведения см. в разделе [Использование асинхронного контроллера в ASP.NET MVC](https://msdn.microsoft.com/library/ee728598(v=VS.100).aspx) в MSDN.</span><span class="sxs-lookup"><span data-stu-id="1dd46-161">For more information, see the [Using an Asynchronous Controller in ASP.NET MVC](https://msdn.microsoft.com/library/ee728598(v=VS.100).aspx) topic on MSDN.</span></span>

### <a name="support-for-defaultvalueattribute-in-action-method-parameters"></a><a id="_TOC3_4"></a><span data-ttu-id="1dd46-162">Поддержка DefaultValueAttribute в параметрах метода действия</span><span class="sxs-lookup"><span data-stu-id="1dd46-162">Support for DefaultValueAttribute in Action-Method Parameters</span></span>

<span data-ttu-id="1dd46-163">Класс System. ComponentModel. DefaultValueAttribute позволяет предоставить значение по умолчанию для параметра-аргумента методу действия.</span><span class="sxs-lookup"><span data-stu-id="1dd46-163">The System.ComponentModel.DefaultValueAttribute class allows a default value to be supplied for the argument parameter to an action method.</span></span> <span data-ttu-id="1dd46-164">Например, предположим, что определен следующий маршрут по умолчанию:</span><span class="sxs-lookup"><span data-stu-id="1dd46-164">For example, assume that the following default route is defined:</span></span>

[!code-json[Main](what-is-new-in-aspnet-mvc/samples/sample3.json)]

<span data-ttu-id="1dd46-165">Также предположим, что определен следующий контроллер и метод действия:</span><span class="sxs-lookup"><span data-stu-id="1dd46-165">Also assume that the following controller and action method is defined:</span></span>

[!code-csharp[Main](what-is-new-in-aspnet-mvc/samples/sample4.cs)]

<span data-ttu-id="1dd46-166">Любой из следующих URL-адресов запроса вызовет метод действия представления, определенный в предыдущем примере.</span><span class="sxs-lookup"><span data-stu-id="1dd46-166">Any of the following request URLs will invoke the View action method that is defined in the preceding example.</span></span>

- <span data-ttu-id="1dd46-167">/Article/View/123</span><span class="sxs-lookup"><span data-stu-id="1dd46-167">/Article/View/123</span></span>
- <span data-ttu-id="1dd46-168">/Article/View/123? Page = 1 (фактически аналогично предыдущему запросу)</span><span class="sxs-lookup"><span data-stu-id="1dd46-168">/Article/View/123?page=1 (Effectively the same as the previous request)</span></span>
- <span data-ttu-id="1dd46-169">/Article/View/123? стр. 2</span><span class="sxs-lookup"><span data-stu-id="1dd46-169">/Article/View/123?page=2</span></span>

<span data-ttu-id="1dd46-170">Без атрибута DefaultValueAttribute первый URL-адрес из предыдущего списка не будет работать, поскольку аргумент Page является типом значения, не допускающим значения NULL, значение которого не было предоставлено.</span><span class="sxs-lookup"><span data-stu-id="1dd46-170">Without the DefaultValueAttribute attribute, the first URL from the preceding list would not work, because the page argument is a non-nullable value type whose value has not been provided.</span></span>

<span data-ttu-id="1dd46-171">Если код написан на Visual Basic 2010 или Visual C# 2010, можно использовать необязательные параметры вместо атрибута DefaultValueAttribute, как показано в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="1dd46-171">If your code is written in Visual Basic 2010 or Visual C# 2010, you can use optional parameters instead of the DefaultValueAttribute attribute, as shown in the following example:</span></span>

[!code-vb[Main](what-is-new-in-aspnet-mvc/samples/sample5.vb)]

### <a name="support-for-binding-binary-data-with-model-binders"></a><a id="_TOC3_5"></a><span data-ttu-id="1dd46-172">Поддержка привязки двоичных данных с помощью связывателей моделей</span><span class="sxs-lookup"><span data-stu-id="1dd46-172">Support for Binding Binary Data with Model Binders</span></span>

<span data-ttu-id="1dd46-173">Существует две новые перегрузки вспомогательного метода HTML. Hidden, который кодирует двоичные значения в строки в кодировке Base-64:</span><span class="sxs-lookup"><span data-stu-id="1dd46-173">There are two new overloads of the Html.Hidden helper that encode binary values as base-64-encoded strings:</span></span>

[!code-csharp[Main](what-is-new-in-aspnet-mvc/samples/sample6.cs)]

<span data-ttu-id="1dd46-174">Обычно используется для встраивания отметки времени для объекта в представлении.</span><span class="sxs-lookup"><span data-stu-id="1dd46-174">A typical use is to embed a timestamp for an object in the view.</span></span> <span data-ttu-id="1dd46-175">Например, приложение может включать следующий объект Product:</span><span class="sxs-lookup"><span data-stu-id="1dd46-175">For example, your application might include the following Product object:</span></span>

[!code-csharp[Main](what-is-new-in-aspnet-mvc/samples/sample7.cs)]

<span data-ttu-id="1dd46-176">Форма редактирования может отображать свойство TimeStamp в форме, как показано в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="1dd46-176">An edit form can render the TimeStamp property in the form as shown in the following example:</span></span>

[!code-aspx[Main](what-is-new-in-aspnet-mvc/samples/sample8.aspx)]

<span data-ttu-id="1dd46-177">Эта разметка визуализирует скрытый элемент ввода со значением timestamp как строку в кодировке Base-64, которая напоминает следующий пример:</span><span class="sxs-lookup"><span data-stu-id="1dd46-177">This markup renders a hidden input element with the timestamp value as a base-64-encoded string that resembles the following example:</span></span>

[!code-html[Main](what-is-new-in-aspnet-mvc/samples/sample9.html)]

<span data-ttu-id="1dd46-178">Эта форма может быть отправлена в метод действия, имеющий аргумент типа Product, как показано в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="1dd46-178">This form might be posted to an action method that has an argument of type Product, as shown in the following example:</span></span>

[!code-csharp[Main](what-is-new-in-aspnet-mvc/samples/sample10.cs)]

<span data-ttu-id="1dd46-179">В методе действия свойство TimeStamp заполняется правильно, так как переданная строка Base-64-Encoded преобразуется в массив байтов.</span><span class="sxs-lookup"><span data-stu-id="1dd46-179">In the action method, the TimeStamp property is populated correctly because the posted base-64-encoded string is converted to a byte array.</span></span>

### <a name="modelmetadata-and-modelmetadataprovider-classes"></a><a id="_TOC3_6"></a><span data-ttu-id="1dd46-180">Классы ModelMetadata и Моделметадатапровидер</span><span class="sxs-lookup"><span data-stu-id="1dd46-180">ModelMetadata and ModelMetadataProvider Classes</span></span>

<span data-ttu-id="1dd46-181">Класс Моделметадатапровидер предоставляет абстракцию для получения метаданных для модели в представлении.</span><span class="sxs-lookup"><span data-stu-id="1dd46-181">The ModelMetadataProvider class provides an abstraction for obtaining metadata for the model within a view.</span></span> <span data-ttu-id="1dd46-182">MVC 2 включает поставщик по умолчанию, который делает доступными метаданные, предоставляемые атрибутами в пространстве имен System. ComponentModel. аннотации.</span><span class="sxs-lookup"><span data-stu-id="1dd46-182">MVC 2 includes a default provider that makes available the metadata that is exposed by the attributes in the System.ComponentModel.DataAnnotations namespace.</span></span> <span data-ttu-id="1dd46-183">Можно создать поставщики метаданных, предоставляющие метаданные из других хранилищ данных, таких как базы данных или XML-файлы.</span><span class="sxs-lookup"><span data-stu-id="1dd46-183">It is possible to create metadata providers that provide metadata from other data stores, such as databases or XML files.</span></span>

<span data-ttu-id="1dd46-184">Класс ViewDataDictionary предоставляет объект ModelMetadata, который содержит метаданные, извлеченные из модели классом Моделметадатапровидер.</span><span class="sxs-lookup"><span data-stu-id="1dd46-184">The ViewDataDictionary class exposes a ModelMetadata object that contains the metadata that is extracted from the model by the ModelMetadataProvider class.</span></span> <span data-ttu-id="1dd46-185">Это позволяет шаблонным вспомогательным разработчикам использовать эти метаданные и соответствующим образом скорректировать их выходные данные.</span><span class="sxs-lookup"><span data-stu-id="1dd46-185">This enables the templated helpers to consume this metadata and adjust their output accordingly.</span></span>

<span data-ttu-id="1dd46-186">Дополнительные сведения см. в документации по классам [ModelMetadata](https://msdn.microsoft.com/library/system.web.mvc.modelmetadataprovider(VS.100).aspx) и [моделметадатапровидер](https://msdn.microsoft.com/library/system.web.mvc.modelmetadataprovider(VS.100).aspx) .</span><span class="sxs-lookup"><span data-stu-id="1dd46-186">For more information, see the documentation for the [ModelMetadata](https://msdn.microsoft.com/library/system.web.mvc.modelmetadataprovider(VS.100).aspx) and [ModelMetadataProvider](https://msdn.microsoft.com/library/system.web.mvc.modelmetadataprovider(VS.100).aspx) classes.</span></span>

### <a name="support-for-dataannotations-attributes"></a><a id="_TOC3_7"></a><span data-ttu-id="1dd46-187">Поддержка атрибутов заметок к заметкам</span><span class="sxs-lookup"><span data-stu-id="1dd46-187">Support for DataAnnotations Attributes</span></span>

<span data-ttu-id="1dd46-188">ASP.NET MVC 2 поддерживает использование атрибутов проверки Ранжеаттрибуте, RequiredAttribute, Стрингленгсаттрибуте и Режексаттрибуте (определенных в пространстве имен System. ComponentModel. аннотации) при привязке к модели с целью обеспечения проверки входных данных.</span><span class="sxs-lookup"><span data-stu-id="1dd46-188">ASP.NET MVC 2 supports using the RangeAttribute, RequiredAttribute, StringLengthAttribute, and RegexAttribute validation attributes (defined in the System.ComponentModel.DataAnnotations namespace) when you bind to a model in order to provide input validation.</span></span>

<span data-ttu-id="1dd46-189">Дополнительные сведения см. в разделе [инструкции. Проверка данных модели с помощью атрибутов примечаний](https://go.microsoft.com/fwlink/?LinkId=159063) на веб-сайте MSDN.</span><span class="sxs-lookup"><span data-stu-id="1dd46-189">For more information, see [How to: Validate Model Data Using DataAnnotations Attributes](https://go.microsoft.com/fwlink/?LinkId=159063) on the MSDN Web site.</span></span> <span data-ttu-id="1dd46-190">Пример проекта, иллюстрирующий использование этих атрибутов, доступен для загрузки по адресу [https://go.microsoft.com/fwlink/?LinkId=157753](https://go.microsoft.com/fwlink/?LinkId=157753) .</span><span class="sxs-lookup"><span data-stu-id="1dd46-190">A sample project that illustrates the use of these attributes is available for download at [https://go.microsoft.com/fwlink/?LinkId=157753](https://go.microsoft.com/fwlink/?LinkId=157753).</span></span>

### <a name="model-validator-providers"></a><a id="_TOC3_8"></a><span data-ttu-id="1dd46-191">Поставщики проверки модели</span><span class="sxs-lookup"><span data-stu-id="1dd46-191">Model-Validator Providers</span></span>

<span data-ttu-id="1dd46-192">Класс поставщика проверки модели представляет абстракцию, которая предоставляет логику проверки для модели.</span><span class="sxs-lookup"><span data-stu-id="1dd46-192">The model-validation provider class represents an abstraction that provides validation logic for the model.</span></span> <span data-ttu-id="1dd46-193">ASP.NET MVC включает поставщик по умолчанию на основе атрибутов проверки, включенных в пространство имен System. ComponentModel. аннотации.</span><span class="sxs-lookup"><span data-stu-id="1dd46-193">ASP.NET MVC includes a default provider based on validation attributes that are included in the System.ComponentModel.DataAnnotations namespace.</span></span> <span data-ttu-id="1dd46-194">Вы также можете создавать собственные поставщики проверки, определяющие пользовательские правила проверки и пользовательские сопоставления правил проверки для модели.</span><span class="sxs-lookup"><span data-stu-id="1dd46-194">You can also create your own validation providers that define custom validation rules and custom mappings of validation rules to the model.</span></span> <span data-ttu-id="1dd46-195">Дополнительные сведения см. в документации по классу [моделвалидаторпровидер](https://msdn.microsoft.com/library/system.web.mvc.ModelValidatorProvider(VS.100).aspx) .</span><span class="sxs-lookup"><span data-stu-id="1dd46-195">For more information, see the documentation for the [ModelValidatorProvider](https://msdn.microsoft.com/library/system.web.mvc.ModelValidatorProvider(VS.100).aspx) class.</span></span>

### <a name="client-side-validation"></a><a id="_TOC3_9"></a><span data-ttu-id="1dd46-196">Проверка на стороне клиента</span><span class="sxs-lookup"><span data-stu-id="1dd46-196">Client-Side Validation</span></span>

<span data-ttu-id="1dd46-197">Класс поставщика проверяющего элемента управления модели предоставляет браузеру метаданные проверки в виде сериализованных данных JSON, которые могут использоваться библиотекой проверки на стороне клиента.</span><span class="sxs-lookup"><span data-stu-id="1dd46-197">The model-validator provider class exposes validation metadata to the browser in the form of JSON-serialized data that can be consumed by a client-side validation library.</span></span> <span data-ttu-id="1dd46-198">ASP.NET MVC 2 включает библиотеку проверки клиента и адаптер, которые поддерживают атрибуты проверки пространства имен, указанные ранее.</span><span class="sxs-lookup"><span data-stu-id="1dd46-198">ASP.NET MVC 2 includes a client validation library and adapter that supports the DataAnnotations namespace validation attributes noted earlier.</span></span> <span data-ttu-id="1dd46-199">Класс поставщика также позволяет использовать другие библиотеки проверки клиента путем записи адаптера, обрабатывающего данные JSON, и вызова в альтернативную библиотеку.</span><span class="sxs-lookup"><span data-stu-id="1dd46-199">The provider class also enables you to use other client-validation libraries by writing an adapter that processes the JSON data and calls into the alternate library.</span></span>

### <a name="new-code-snippets-for-visual-studio-2010"></a><a id="_TOC3_10"></a><span data-ttu-id="1dd46-200">Новые фрагменты кода для Visual Studio 2010</span><span class="sxs-lookup"><span data-stu-id="1dd46-200">New Code Snippets for Visual Studio 2010</span></span>

<span data-ttu-id="1dd46-201">Набор фрагментов кода HTML для ASP.NET MVC 2 устанавливается вместе с Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="1dd46-201">A set of HTML code snippets for ASP.NET MVC 2 is installed with Visual Studio 2010.</span></span> <span data-ttu-id="1dd46-202">Чтобы просмотреть список этих фрагментов, в меню Сервис выберите пункт Диспетчер фрагментов кода.</span><span class="sxs-lookup"><span data-stu-id="1dd46-202">To view a list of these snippets, in the Tools menu, select Code Snippets Manager.</span></span> <span data-ttu-id="1dd46-203">Для этого языка выберите HTML, а в поле Расположение выберите ASP.NET MVC 2.</span><span class="sxs-lookup"><span data-stu-id="1dd46-203">For the language, select HTML, and for location, select ASP.NET MVC 2.</span></span> <span data-ttu-id="1dd46-204">Дополнительные сведения об использовании фрагментов кода см. в документации по Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="1dd46-204">For more information about how to use code snippets, see the Visual Studio documentation.</span></span>

### <a name="new-requirehttpsattribute-action-filter"></a><a id="_TOC3_11"></a><span data-ttu-id="1dd46-205">Новый фильтр действий Рекуирехттпсаттрибуте</span><span class="sxs-lookup"><span data-stu-id="1dd46-205">New RequireHttpsAttribute Action Filter</span></span>

<span data-ttu-id="1dd46-206">ASP.NET MVC 2 включает новый класс Рекуирехттпсаттрибуте, который можно применять к методам действий и контроллерам.</span><span class="sxs-lookup"><span data-stu-id="1dd46-206">ASP.NET MVC 2 includes a new RequireHttpsAttribute class that can be applied to action methods and controllers.</span></span> <span data-ttu-id="1dd46-207">По умолчанию фильтр перенаправляет запрос, не использующий протокол SSL (HTTP), в эквивалент SSL-(HTTPS).</span><span class="sxs-lookup"><span data-stu-id="1dd46-207">By default, the filter redirects a non-SSL (HTTP) request to the SSL-enabled (HTTPS) equivalent.</span></span>

### <a name="overriding-the-http-method-verb"></a><a id="_TOC3_12"></a><span data-ttu-id="1dd46-208">Переопределение глагола метода HTTP</span><span class="sxs-lookup"><span data-stu-id="1dd46-208">Overriding the HTTP Method Verb</span></span>

<span data-ttu-id="1dd46-209">При создании веб-сайта с использованием общеархитектурного стиля команды HTTP используются для определения действия, выполняемого для ресурса.</span><span class="sxs-lookup"><span data-stu-id="1dd46-209">When you build a Web site by using the REST architectural style, HTTP verbs are used to determine which action to perform for a resource.</span></span> <span data-ttu-id="1dd46-210">Для работы службы RESTFUL требуется, чтобы приложения поддерживали полный спектр общих HTTP-команд, включая GET, WHERE, POST и DELETE.</span><span class="sxs-lookup"><span data-stu-id="1dd46-210">REST requires that applications support the full range of common HTTP verbs, including GET, PUT, POST, and DELETE.</span></span>

<span data-ttu-id="1dd46-211">ASP.NET MVC 2 включает новые атрибуты, которые можно применять к методам действий и синтаксису Compact Feature.</span><span class="sxs-lookup"><span data-stu-id="1dd46-211">ASP.NET MVC 2 includes new attributes that you can apply to action methods and that feature compact syntax.</span></span> <span data-ttu-id="1dd46-212">Эти атрибуты позволяют ASP.NET MVC выбирать метод действия на основе HTTP-команды.</span><span class="sxs-lookup"><span data-stu-id="1dd46-212">These attributes enable ASP.NET MVC to select an action method based on the HTTP verb.</span></span> <span data-ttu-id="1dd46-213">В следующем примере запрос POST вызовет первый метод действия, а запрос размещения вызовет второй метод действия.</span><span class="sxs-lookup"><span data-stu-id="1dd46-213">In the following example, a POST request will call the first action method and a PUT request will call the second action method.</span></span>

[!code-csharp[Main](what-is-new-in-aspnet-mvc/samples/sample11.cs)]

<span data-ttu-id="1dd46-214">В более ранних версиях ASP.NET MVC эти методы действия требовали более подробного синтаксиса, как показано в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="1dd46-214">In earlier versions of ASP.NET MVC, these action methods required more verbose syntax, as shown in the following example:</span></span>

[!code-csharp[Main](what-is-new-in-aspnet-mvc/samples/sample12.cs)]

<span data-ttu-id="1dd46-215">Так как браузеры поддерживают только HTTP-команды GET и POST, невозможно выполнить запись в действие, для которого требуется другая команда.</span><span class="sxs-lookup"><span data-stu-id="1dd46-215">Because browsers support only the GET and POST HTTP verbs, it is not possible to post to an action that requires a different verb.</span></span> <span data-ttu-id="1dd46-216">Поэтому невозможно изначально поддерживать все запросы RESTFUL.</span><span class="sxs-lookup"><span data-stu-id="1dd46-216">Thus it is not possible to natively support all RESTful requests.</span></span>

<span data-ttu-id="1dd46-217">Однако для поддержки запросов RESTFUL во время операций POST в ASP.NET MVC 2 появился новый вспомогательный метод Хттпмесодоверриде HTML.</span><span class="sxs-lookup"><span data-stu-id="1dd46-217">However, to support RESTful requests during POST operations, ASP.NET MVC 2 introduces a new HttpMethodOverride HTML helper method.</span></span> <span data-ttu-id="1dd46-218">Этот метод визуализирует скрытый элемент ввода, который заставляет форму эффективно эмулировать любой метод HTTP.</span><span class="sxs-lookup"><span data-stu-id="1dd46-218">This method renders a hidden input element that causes the form to effectively emulate any HTTP method.</span></span> <span data-ttu-id="1dd46-219">Например, с помощью вспомогательного метода HTML Хттпмесодоверриде можно отправить форму с запросом на размещение или удаление.</span><span class="sxs-lookup"><span data-stu-id="1dd46-219">For example, by using the HttpMethodOverride HTML helper method, you can have a form submission appear be a PUT or DELETE request.</span></span> <span data-ttu-id="1dd46-220">Поведение Хттпмесодоверриде влияет на следующие атрибуты:</span><span class="sxs-lookup"><span data-stu-id="1dd46-220">The behavior of HttpMethodOverride affects the following attributes:</span></span>

- <span data-ttu-id="1dd46-221">хттппостаттрибуте</span><span class="sxs-lookup"><span data-stu-id="1dd46-221">HttpPostAttribute</span></span>
- <span data-ttu-id="1dd46-222">хттппутаттрибуте</span><span class="sxs-lookup"><span data-stu-id="1dd46-222">HttpPutAttribute</span></span>
- <span data-ttu-id="1dd46-223">хттпжетаттрибуте</span><span class="sxs-lookup"><span data-stu-id="1dd46-223">HttpGetAttribute</span></span>
- <span data-ttu-id="1dd46-224">хттпделетеаттрибуте</span><span class="sxs-lookup"><span data-stu-id="1dd46-224">HttpDeleteAttribute</span></span>
- <span data-ttu-id="1dd46-225">акцептвербсаттрибуте</span><span class="sxs-lookup"><span data-stu-id="1dd46-225">AcceptVerbsAttribute</span></span>

<span data-ttu-id="1dd46-226">У скрытого элемента ввода имя X-HTTP-Method-reoverride и его значение задано для команды HTTP для эмуляции.</span><span class="sxs-lookup"><span data-stu-id="1dd46-226">The hidden input element has its name X-HTTP-Method-Override and its value set to the HTTP verb to emulate.</span></span> <span data-ttu-id="1dd46-227">Значение переопределения также можно указать в заголовке HTTP или в значении строки запроса в виде пары "имя-значение".</span><span class="sxs-lookup"><span data-stu-id="1dd46-227">The override value can also be specified in an HTTP header or in a query string value as a name/value pair.</span></span>

<span data-ttu-id="1dd46-228">Переопределение можно использовать, только если реальный запрос является запросом POST.</span><span class="sxs-lookup"><span data-stu-id="1dd46-228">The override can only be used when the real request is a POST request.</span></span> <span data-ttu-id="1dd46-229">Значение переопределения будет проигнорировано для запросов, использующих любую другую команду HTTP.</span><span class="sxs-lookup"><span data-stu-id="1dd46-229">The override value will be ignored for requests that use any other HTTP verb.</span></span>

### <a name="new-hiddeninputattribute-class-for-templated-helpers"></a><a id="_TOC3_13"></a><span data-ttu-id="1dd46-230">Новый класс Хидденинпутаттрибуте для шаблонов вспомогательных функций</span><span class="sxs-lookup"><span data-stu-id="1dd46-230">New HiddenInputAttribute Class for Templated Helpers</span></span>

<span data-ttu-id="1dd46-231">Можно применить новый атрибут Хидденинпутаттрибуте к свойству модели, чтобы указать, должен ли быть визуализирован скрытый элемент ввода при отображении модели в шаблоне редактора.</span><span class="sxs-lookup"><span data-stu-id="1dd46-231">You can apply the new HiddenInputAttribute attribute to a model property to indicate whether a hidden input element should be rendered when displaying the model in an editor template.</span></span> <span data-ttu-id="1dd46-232">(Атрибут задает неявное значение UIHint Хидденинпут).</span><span class="sxs-lookup"><span data-stu-id="1dd46-232">(The attribute sets an implicit UIHint value of HiddenInput).</span></span> <span data-ttu-id="1dd46-233">Свойство Дисплайвалуе атрибута позволяет указать, будет ли значение отображаться в редакторе и режимах отображения.</span><span class="sxs-lookup"><span data-stu-id="1dd46-233">The attribute's DisplayValue property lets you specify whether the value is displayed in editor and display modes.</span></span> <span data-ttu-id="1dd46-234">Если Дисплайвалуе имеет значение false, ничего не отображается, а не в виде HTML-разметки, которая обычно окружает поле.</span><span class="sxs-lookup"><span data-stu-id="1dd46-234">When DisplayValue is set to false, nothing is displayed, not even the HTML markup that normally surrounds a field.</span></span> <span data-ttu-id="1dd46-235">Значение по умолчанию для Дисплайвалуе — true.</span><span class="sxs-lookup"><span data-stu-id="1dd46-235">The default value for DisplayValue is true.</span></span>

<span data-ttu-id="1dd46-236">Атрибут Хидденинпутаттрибуте можно использовать в следующих сценариях:</span><span class="sxs-lookup"><span data-stu-id="1dd46-236">You might use HiddenInputAttribute attribute in the following scenarios:</span></span>

- <span data-ttu-id="1dd46-237">Когда представление позволяет пользователям изменять идентификатор объекта, необходимо отобразить значение, а также предоставить скрытый элемент ввода, содержащий старый идентификатор, чтобы его можно было передать обратно в контроллер.</span><span class="sxs-lookup"><span data-stu-id="1dd46-237">When a view lets users edit the ID of an object and it is necessary to display the value as well as to provide a hidden input element that contains the old ID so that it can be passed back to the controller.</span></span>
- <span data-ttu-id="1dd46-238">Если представление позволяет пользователям изменять двоичное свойство, которое никогда не должно отображаться, например свойство timestamp.</span><span class="sxs-lookup"><span data-stu-id="1dd46-238">When a view lets users edit a binary property that should never be displayed, such as a timestamp property.</span></span> <span data-ttu-id="1dd46-239">В этом случае значение и окружающая разметка HTML (например, метка и значение) не отображаются.</span><span class="sxs-lookup"><span data-stu-id="1dd46-239">In that case, the value and surrounding HTML markup (such as the label and value) are not displayed.</span></span>

<span data-ttu-id="1dd46-240">В следующем примере показано, как использовать класс Хидденинпутаттрибуте.</span><span class="sxs-lookup"><span data-stu-id="1dd46-240">The following example shows how to use the HiddenInputAttribute class.</span></span>

[!code-csharp[Main](what-is-new-in-aspnet-mvc/samples/sample13.cs)]

<span data-ttu-id="1dd46-241">Если для атрибута задано значение true (или не указан параметр), происходит следующее:</span><span class="sxs-lookup"><span data-stu-id="1dd46-241">When the attribute is set to true (or no parameter is specified), the following occurs:</span></span>

- <span data-ttu-id="1dd46-242">В шаблонах отображения отображается метка и отображается значение для пользователя.</span><span class="sxs-lookup"><span data-stu-id="1dd46-242">In display templates, a label is rendered and the value is displayed to the user.</span></span>
- <span data-ttu-id="1dd46-243">В шаблонах редактора отображается метка, а значение отображается в скрытом элементе ввода.</span><span class="sxs-lookup"><span data-stu-id="1dd46-243">In editor templates, a label is rendered and the value is rendered in a hidden input element.</span></span>

<span data-ttu-id="1dd46-244">Если атрибут имеет значение false, происходит следующее:</span><span class="sxs-lookup"><span data-stu-id="1dd46-244">When the attribute is set to false, the following occurs:</span></span>

- <span data-ttu-id="1dd46-245">В шаблонах отображения для этого поля ничего не отображается.</span><span class="sxs-lookup"><span data-stu-id="1dd46-245">In display templates, nothing is rendered for that field.</span></span>
- <span data-ttu-id="1dd46-246">В шаблонах редактора метка не отображается, и значение отображается в скрытом элементе ввода.</span><span class="sxs-lookup"><span data-stu-id="1dd46-246">In editor templates, no label is rendered and the value is rendered in a hidden input element.</span></span>

### <a name="htmlvalidationsummary-helper-method-can-display-model-level-errors"></a><a id="_TOC3_14"></a><span data-ttu-id="1dd46-247">Вспомогательный метод HTML. ValidationSummary может отображать ошибки уровня модели</span><span class="sxs-lookup"><span data-stu-id="1dd46-247">Html.ValidationSummary Helper Method Can Display Model-Level Errors</span></span>

<span data-ttu-id="1dd46-248">Вместо того чтобы всегда отображать все ошибки проверки, вспомогательный метод HTML. ValidationSummary имеет новый параметр для отображения только ошибок уровня модели.</span><span class="sxs-lookup"><span data-stu-id="1dd46-248">Instead of always displaying all validation errors, the Html.ValidationSummary helper method has a new option to display only model-level errors.</span></span> <span data-ttu-id="1dd46-249">Это позволяет отображать ошибки уровня модели в сводке проверки и ошибки, относящиеся к полям, которые должны отображаться рядом с каждым полем.</span><span class="sxs-lookup"><span data-stu-id="1dd46-249">This enables model-level errors to be displayed in the validation summary and field-specific errors to be displayed next to each field.</span></span>

### <a name="t4-templates-in-visual-studio-generate-code-that-is-specific-to-the-target-version-of-the-net-framework"></a><a id="_TOC3_15"></a><span data-ttu-id="1dd46-250">Шаблоны T4 в Visual Studio создают код, относящийся к целевой версии .NET Framework</span><span class="sxs-lookup"><span data-stu-id="1dd46-250">T4 Templates in Visual Studio Generate Code that is Specific to the Target Version of the .NET Framework</span></span>

<span data-ttu-id="1dd46-251">Новое свойство доступно для файлов T4 из узла T4 ASP.NET MVC, указывающего версию .NET Framework, используемую приложением.</span><span class="sxs-lookup"><span data-stu-id="1dd46-251">A new property is available to T4 files from the ASP.NET MVC T4 host that specifies the version of the .NET Framework that is used by the application.</span></span> <span data-ttu-id="1dd46-252">Это позволяет шаблонам T4 формировать код и разметку, характерные для версии .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="1dd46-252">This enables T4 templates to generate code and markup that is specific to a version of the .NET Framework.</span></span> <span data-ttu-id="1dd46-253">В Visual Studio 2008 значение всегда равно .NET 3,5.</span><span class="sxs-lookup"><span data-stu-id="1dd46-253">In Visual Studio 2008, the value is always .NET 3.5.</span></span> <span data-ttu-id="1dd46-254">В Visual Studio 2010 значением является либо .NET 3,5, либо .NET 4.</span><span class="sxs-lookup"><span data-stu-id="1dd46-254">In Visual Studio 2010, the value is either .NET 3.5 or .NET 4.</span></span>

## <a name="api-improvements"></a><a id="_TOC4"></a><span data-ttu-id="1dd46-255">Улучшения API</span><span class="sxs-lookup"><span data-stu-id="1dd46-255">API Improvements</span></span>

<span data-ttu-id="1dd46-256">В этом разделе описываются изменения существующих типов и членов MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="1dd46-256">This section describes changes to existing ASP.NET MVC types and members.</span></span>

- <span data-ttu-id="1dd46-257">Добавлен защищенный виртуальный метод Креатеактионинвокер в классе Controller.</span><span class="sxs-lookup"><span data-stu-id="1dd46-257">Added a protected virtual CreateActionInvoker method in the Controller class.</span></span> <span data-ttu-id="1dd46-258">Этот метод вызывается свойством Актионинвокер контроллера и обеспечивает Отложенное создание экземпляра вызывающего объекта, если не задано ни одного вызова.</span><span class="sxs-lookup"><span data-stu-id="1dd46-258">This method is invoked by the ActionInvoker property of Controller and allows for lazy instantiation of the invoker if no invoker is already set.</span></span>
- <span data-ttu-id="1dd46-259">Добавлен защищенный виртуальный метод Хандлеунаусоризедрекуест в класс AuthorizeAttribute.</span><span class="sxs-lookup"><span data-stu-id="1dd46-259">Added a protected virtual HandleUnauthorizedRequest method in the AuthorizeAttribute class.</span></span> <span data-ttu-id="1dd46-260">Это позволяет фильтрам, производным от AuthorizeAttribute, управлять поведением при сбое авторизации.</span><span class="sxs-lookup"><span data-stu-id="1dd46-260">This enables filters that derive from AuthorizeAttribute to control the behavior when authorization fails.</span></span>
- <span data-ttu-id="1dd46-261">В класс Валуепровидердиктионари добавлен метод Add (строковый ключ, значение объекта).</span><span class="sxs-lookup"><span data-stu-id="1dd46-261">Added an Add(string key, object value) method in the ValueProviderDictionary class.</span></span> <span data-ttu-id="1dd46-262">Это позволяет использовать синтаксис инициализатора словаря для Валуепровидердиктионари, как показано в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="1dd46-262">This enables you to use the dictionary initializer syntax for ValueProviderDictionary, as in the following example:</span></span>

[!code-csharp[Main](what-is-new-in-aspnet-mvc/samples/sample14.cs)]

- <span data-ttu-id="1dd46-263">Добавлен метод получения \_ объекта в класс sys. MVC. ажаксконтекст.</span><span class="sxs-lookup"><span data-stu-id="1dd46-263">Added a get\_object method in the Sys.Mvc.AjaxContext class.</span></span> <span data-ttu-id="1dd46-264">Это метод JavaScript, аналогичный \_ методу get Data, но если тип содержимого ответа — Application/JSON, командлет Get \_ Object ВОЗВРАЩАЕТ объект JSON.</span><span class="sxs-lookup"><span data-stu-id="1dd46-264">This is a JavaScript method that is similar to the get\_data method, but if the content type of the response is application/json, get\_object returns the JSON object.</span></span>
- <span data-ttu-id="1dd46-265">Добавлено свойство Актиондескриптор в класс AuthorizationContext.</span><span class="sxs-lookup"><span data-stu-id="1dd46-265">Added an ActionDescriptor property in the AuthorizationContext class.</span></span>
- <span data-ttu-id="1dd46-266">Добавлен маркер Урлпараметер. Optional, который можно использовать для решения проблем при привязке к модели, содержащей свойство ID, если свойство отсутствует в записи формы.</span><span class="sxs-lookup"><span data-stu-id="1dd46-266">Added a UrlParameter.Optional token that can be used to work around problems when binding to a model that contains an ID property when the property is absent in a form post.</span></span> <span data-ttu-id="1dd46-267">Дополнительные сведения см. в записи [ASP.NET MVC 2 Optional URL-параметры](http://haacked.com/archive/2010/02/12/asp-net-mvc-2-optional-url-parameters.aspx) в блоге Фил Хаак.</span><span class="sxs-lookup"><span data-stu-id="1dd46-267">For more detail, see the entry [ASP.NET MVC 2 Optional URL Parameters](http://haacked.com/archive/2010/02/12/asp-net-mvc-2-optional-url-parameters.aspx) on Phil Haack's blog.</span></span>

## <a name="breaking-changes"></a><a id="_TOC5"></a><span data-ttu-id="1dd46-268">Критические изменения</span><span class="sxs-lookup"><span data-stu-id="1dd46-268">Breaking Changes</span></span>

<span data-ttu-id="1dd46-269">Следующие изменения могут вызвать ошибки в существующих приложениях ASP.NET MVC 1,0.</span><span class="sxs-lookup"><span data-stu-id="1dd46-269">The following changes might cause errors in existing ASP.NET MVC 1.0 applications.</span></span>

#### <a name="change-in-property-validation-behavior-for-classes-that-implement-idataerrorinfo"></a><span data-ttu-id="1dd46-270">Изменение поведения проверки свойства для классов, реализующих IDataErrorInfo</span><span class="sxs-lookup"><span data-stu-id="1dd46-270">Change in property validation behavior for classes that implement IDataErrorInfo</span></span>

<span data-ttu-id="1dd46-271">Для объектов модели, использующих IDataErrorInfo для выполнения проверки, проверяется каждое свойство, независимо от того, было ли установлено новое значение.</span><span class="sxs-lookup"><span data-stu-id="1dd46-271">For model objects that use IDataErrorInfo to perform validation, every property is validated, regardless of whether a new value was set.</span></span> <span data-ttu-id="1dd46-272">В ASP.NET MVC 1,0 были проверены только свойства, для которых были установлены новые значения.</span><span class="sxs-lookup"><span data-stu-id="1dd46-272">In ASP.NET MVC 1.0, only properties that had new values set were validated.</span></span> <span data-ttu-id="1dd46-273">В ASP.NET MVC 2 свойство Error объекта IDataErrorInfo вызывается только в том случае, если все проверяющие элементы управления были успешными.</span><span class="sxs-lookup"><span data-stu-id="1dd46-273">In ASP.NET MVC 2, the Error property of IDataErrorInfo is called only if all the property validators were successful.</span></span>

#### <a name="iis-script-mapping-script-is-no-longer-available-in-the-installer"></a><span data-ttu-id="1dd46-274">Скрипт сопоставления сценариев IIS больше не доступен в установщике</span><span class="sxs-lookup"><span data-stu-id="1dd46-274">IIS script mapping script is no longer available in the installer</span></span>

<span data-ttu-id="1dd46-275">Скрипт сопоставления сценариев IIS — это сценарий командной строки, который используется для настройки сопоставлений сценариев для IIS 6 и IIS 7 в классическом режиме.</span><span class="sxs-lookup"><span data-stu-id="1dd46-275">The IIS script-mapping script is a command-line script that is used to configure script maps for IIS 6 and for IIS 7 in Classic mode.</span></span> <span data-ttu-id="1dd46-276">Сценарий сопоставления скриптов не требуется при использовании Visual Studio Development Server или при использовании IIS 7 в интегрированном режиме.</span><span class="sxs-lookup"><span data-stu-id="1dd46-276">The script-mapping script is not needed if you use the Visual Studio Development Server or if you use IIS 7 in Integrated mode.</span></span> <span data-ttu-id="1dd46-277">Сценарии доступны в виде отдельного неподдерживаемого скачивания в [ASP.NET](https://github.com/aspnet/AspNetWebStack).</span><span class="sxs-lookup"><span data-stu-id="1dd46-277">The scripts are available as a separate unsupported download on the [ASP.NET WebStack](https://github.com/aspnet/AspNetWebStack).</span></span>

#### <a name="the-htmlsubstitute-helper-method-in-mvc-futures-is-no-longer-available"></a><span data-ttu-id="1dd46-278">Вспомогательный метод HTML. reзамены в MVC Futures больше не доступен</span><span class="sxs-lookup"><span data-stu-id="1dd46-278">The Html.Substitute helper method in MVC Futures is no longer available</span></span>

<span data-ttu-id="1dd46-279">Из-за изменений в работе обработчиков представлений MVC HTML. замещающий вспомогательный метод не работает и был удален.</span><span class="sxs-lookup"><span data-stu-id="1dd46-279">Due to changes in the rendering behavior of MVC view engines, the Html.Substitute helper method does not work and has been removed.</span></span>

#### <a name="the-ivalueprovider-interface-replaces-all-uses-of-idictionary"></a><span data-ttu-id="1dd46-280">Интерфейс Ивалуепровидер заменяет все используемые IDictionary</span><span class="sxs-lookup"><span data-stu-id="1dd46-280">The IValueProvider interface replaces all uses of IDictionary</span></span>

<span data-ttu-id="1dd46-281">Каждое свойство или аргумент метода, которые приняли значение IDictionary в MVC 1,0, теперь принимают Ивалуепровидер.</span><span class="sxs-lookup"><span data-stu-id="1dd46-281">Every property or method argument that accepted IDictionary in MVC 1.0 now accepts IValueProvider.</span></span> <span data-ttu-id="1dd46-282">Это изменение затрагивает только те приложения, которые содержат пользовательские поставщики значений или связыватели настраиваемых моделей.</span><span class="sxs-lookup"><span data-stu-id="1dd46-282">This change affects only applications that include custom value providers or custom model binders.</span></span> <span data-ttu-id="1dd46-283">Примеры свойств и методов, затрагиваемых этим изменением, включают следующее.</span><span class="sxs-lookup"><span data-stu-id="1dd46-283">Examples of properties and methods that are affected by this change include the following:</span></span>

- <span data-ttu-id="1dd46-284">Свойство значение valueprovider классов ControllerBase и Моделбиндингконтекст.</span><span class="sxs-lookup"><span data-stu-id="1dd46-284">The ValueProvider property of the ControllerBase and ModelBindingContext classes.</span></span>
- <span data-ttu-id="1dd46-285">Методы Трюпдатемодел класса Controller.</span><span class="sxs-lookup"><span data-stu-id="1dd46-285">The TryUpdateModel methods of the Controller class.</span></span>

#### <a name="new-css-classes-were-added-in-the-sitecss-file"></a><span data-ttu-id="1dd46-286">В файл Site. CSS добавлены новые классы CSS</span><span class="sxs-lookup"><span data-stu-id="1dd46-286">New CSS classes were added in the Site.css file</span></span>

<span data-ttu-id="1dd46-287">Файл Site. CSS в шаблонах проекта ASP.NET MVC был обновлен для включения новых стилей, используемых функцией проверки и шаблонными вспомогательными функциями.</span><span class="sxs-lookup"><span data-stu-id="1dd46-287">The Site.css file in the ASP.NET MVC project templates has been updated to include new styles used by the validation functionality and by the templated helpers.</span></span>

#### <a name="helpers-now-return-an-mvchtmlstring-object"></a><span data-ttu-id="1dd46-288">Вспомогательные объекты теперь возвращают объект Мвчтмлстринг</span><span class="sxs-lookup"><span data-stu-id="1dd46-288">Helpers now return an MvcHtmlString object</span></span>

<span data-ttu-id="1dd46-289">Чтобы воспользоваться преимуществами нового синтаксиса выражений HTML-кодирования в ASP.NET 4, возвращаемый тип для вспомогательных функций HTML теперь Мвчтмлстринг вместо строки.</span><span class="sxs-lookup"><span data-stu-id="1dd46-289">In order to take advantage of the new HTML-encoding expression syntax in ASP.NET 4, the return type for HTML helpers is now MvcHtmlString instead of a string.</span></span> <span data-ttu-id="1dd46-290">Если вы используете ASP.NET MVC 2 и новые вспомогательные методы в ASP.NET 3,5, вы не сможете воспользоваться преимуществами синтаксиса HTML-кодирования. Новый синтаксис доступен только при запуске ASP.NET MVC 2 на ASP.NET 4.</span><span class="sxs-lookup"><span data-stu-id="1dd46-290">If you use ASP.NET MVC 2 and the new helpers on ASP.NET 3.5, you will not be able to take advantage of the HTML-encoding syntax; the new syntax is available only when you run ASP.NET MVC 2 on ASP.NET 4.</span></span>

#### <a name="jsonresult-now-responds-only-to-http-post-requests"></a><span data-ttu-id="1dd46-291">JsonResult теперь реагирует только на запросы HTTP POST.</span><span class="sxs-lookup"><span data-stu-id="1dd46-291">JsonResult now responds only to HTTP POST requests</span></span>

<span data-ttu-id="1dd46-292">Чтобы устранить атаки, приводящие к захвату JSON, которые потенциально могут раскрытие информации, класс JsonResult теперь отвечает только на запросы HTTP POST.</span><span class="sxs-lookup"><span data-stu-id="1dd46-292">In order to mitigate JSON hijacking attacks that have the potential for information disclosure, by default, the JsonResult class now responds only to HTTP POST requests.</span></span> <span data-ttu-id="1dd46-293">Вызовы AJAX GET к методам действий, которые возвращают объект JsonResult, следует изменить для использования вместо этого метода POST.</span><span class="sxs-lookup"><span data-stu-id="1dd46-293">Ajax GET calls to action methods that return a JsonResult object should be changed to use POST instead.</span></span> <span data-ttu-id="1dd46-294">При необходимости можно переопределить это поведение, задав новое свойство Жсонрекуестбехавиор объекта JsonResult.</span><span class="sxs-lookup"><span data-stu-id="1dd46-294">If necessary, you can override this behavior by setting the new JsonRequestBehavior property of JsonResult.</span></span> <span data-ttu-id="1dd46-295">Дополнительные сведения о потенциальной атаке см. в блоге записи блога о [захвате JSON](http://haacked.com/archive/2009/06/25/json-hijacking.aspx) в блоге по Фил Хаак.</span><span class="sxs-lookup"><span data-stu-id="1dd46-295">For more information about the potential exploit, see the blog post [JSON Hijacking](http://haacked.com/archive/2009/06/25/json-hijacking.aspx) on Phil Haack's blog.</span></span>

#### <a name="model-and-modeltype-property-setters-on-modelbindingcontext-are-obsolete"></a><span data-ttu-id="1dd46-296">Методы задания свойств Model и ModelType в Моделбиндингконтекст устарели</span><span class="sxs-lookup"><span data-stu-id="1dd46-296">Model and ModelType property setters on ModelBindingContext are obsolete</span></span>

<span data-ttu-id="1dd46-297">В класс Моделбиндингконтекст было добавлено новое устанавливаемое свойство ModelMetadata.</span><span class="sxs-lookup"><span data-stu-id="1dd46-297">A new settable ModelMetadata property has been added to the ModelBindingContext class.</span></span> <span data-ttu-id="1dd46-298">Новое свойство инкапсулирует как модель, так и свойства ModelType.</span><span class="sxs-lookup"><span data-stu-id="1dd46-298">The new property encapsulates both the Model and the ModelType properties.</span></span> <span data-ttu-id="1dd46-299">Несмотря на то что свойства Model и ModelType устарели, для обратной совместимости методы получения свойств все еще работают. Они делегируют свойство ModelMetadata для получения значения.</span><span class="sxs-lookup"><span data-stu-id="1dd46-299">Although the Model and ModelType properties are obsolete, for backward compatibility the property getters still work; they delegate to the ModelMetadata property to retrieve the value.</span></span>

#### <a name="changes-to-the-defaultcontrollerfactory-class-break-custom-controller-factories-that-derive-from-it"></a><span data-ttu-id="1dd46-300">Изменения в классе Дефаултконтроллерфактори нарушают фабрики пользовательских контроллеров, производные от нее</span><span class="sxs-lookup"><span data-stu-id="1dd46-300">Changes to the DefaultControllerFactory class break custom controller factories that derive from it</span></span>

<span data-ttu-id="1dd46-301">Класс Дефаултконтроллерфактори был исправлен путем удаления свойства RequestContext.</span><span class="sxs-lookup"><span data-stu-id="1dd46-301">The DefaultControllerFactory class was fixed by removing the RequestContext property.</span></span> <span data-ttu-id="1dd46-302">Вместо этого свойства экземпляр контекста запроса передается защищенным виртуальным методам Жетконтроллеринстанце и Жетконтроллертипе.</span><span class="sxs-lookup"><span data-stu-id="1dd46-302">In place of this property, the request context instance is passed to the protected virtual GetControllerInstance and GetControllerType methods.</span></span> <span data-ttu-id="1dd46-303">Это изменение влияет на пользовательские фабрики контроллеров, производные от Дефаултконтроллерфактори.</span><span class="sxs-lookup"><span data-stu-id="1dd46-303">This change affects custom controller factories that derive from DefaultControllerFactory.</span></span>

<span data-ttu-id="1dd46-304">Фабрики пользовательских контроллеров часто используются для обеспечения внедрения зависимостей для приложений ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="1dd46-304">Custom controller factories are often used to provide dependency injection for ASP.NET MVC applications.</span></span> <span data-ttu-id="1dd46-305">Чтобы обновить фабрики настраиваемых контроллеров для поддержки ASP.NET MVC 2, измените сигнатуру метода или сигнатуры в соответствии с новыми сигнатурами и используйте параметр контекста запроса вместо свойства.</span><span class="sxs-lookup"><span data-stu-id="1dd46-305">To update the custom controller factories to support ASP.NET MVC 2, change the method signature or signatures to match the new signatures, and use the request context parameter instead of the property.</span></span>

#### <a name="area-is-a-now-a-reserved-route-value-key"></a><span data-ttu-id="1dd46-306">"Область" теперь является зарезервированным ключом "маршрут-значение"</span><span class="sxs-lookup"><span data-stu-id="1dd46-306">"Area" is a now a reserved route-value key</span></span>

<span data-ttu-id="1dd46-307">Строка "Area" в значениях маршрута теперь имеет особое значение в ASP.NET MVC таким же образом, как и "Controller" и "Action".</span><span class="sxs-lookup"><span data-stu-id="1dd46-307">The string "area" in Route values now has special meaning in ASP.NET MVC, in the same way that "controller" and "action" do.</span></span> <span data-ttu-id="1dd46-308">Одно следствие заключается в том, что если вспомогательные методы HTML содержат словарь значений маршрута, содержащий "область", вспомогательные методы больше не будут добавлять "область" в строке запроса.</span><span class="sxs-lookup"><span data-stu-id="1dd46-308">One implication is that if HTML helpers are supplied with a route-value dictionary containing "area", the helpers will no longer append "area" in the query string.</span></span>

<span data-ttu-id="1dd46-309">Если вы используете функцию "области", не используйте {Area} в качестве части URL-адреса маршрута.</span><span class="sxs-lookup"><span data-stu-id="1dd46-309">If you are using the Areas feature, make sure to not use {area} as part of your route URL.</span></span>

## <a name="disclaimer"></a><a id="_TOC6"></a><span data-ttu-id="1dd46-310">Заявление об отказе</span><span class="sxs-lookup"><span data-stu-id="1dd46-310">Disclaimer</span></span>

<span data-ttu-id="1dd46-311">Это предварительный документ, он может быть существенно изменен до выхода окончательного коммерческого выпуска описанного здесь программного обеспечения.</span><span class="sxs-lookup"><span data-stu-id="1dd46-311">This is a preliminary document and may be changed substantially prior to final commercial release of the software described herein.</span></span>

<span data-ttu-id="1dd46-312">Информация, содержащаяся в этом документе, являет собой текущее представление корпорации Майкрософт о вопросах, которые обсуждались на момент публикации.</span><span class="sxs-lookup"><span data-stu-id="1dd46-312">The information contained in this document represents the current view of Microsoft Corporation on the issues discussed as of the date of publication.</span></span> <span data-ttu-id="1dd46-313">Поскольку корпорация Майкрософт должна реагировать на изменение рыночных условий, эта информация не должна рассматриваться как обязательство корпорации Майкрософт. Корпорация Майкрософт не может гарантировать достоверность информации, предоставленной после момента публикации.</span><span class="sxs-lookup"><span data-stu-id="1dd46-313">Because Microsoft must respond to changing market conditions, it should not be interpreted to be a commitment on the part of Microsoft, and Microsoft cannot guarantee the accuracy of any information presented after the date of publication.</span></span>

<span data-ttu-id="1dd46-314">Данный технический документ предназначен только для ознакомительных целей.</span><span class="sxs-lookup"><span data-stu-id="1dd46-314">This White Paper is for informational purposes only.</span></span> <span data-ttu-id="1dd46-315">МАЙКРОСОФТ НЕ ПРЕДОСТАВЛЯЕТ НИКАКИХ ГАРАНТИЙ, ЯВНЫХ ИЛИ ПРЕДУСМОТРЕННЫХ ЗАКОНОДАТЕЛЬСТВОМ, ОТНОСИТЕЛЬНО СВЕДЕНИЙ, СОДЕРЖАЩИХСЯ В ДАННОМ ДОКУМЕНТЕ.</span><span class="sxs-lookup"><span data-stu-id="1dd46-315">MICROSOFT MAKES NO WARRANTIES, EXPRESS, IMPLIED OR STATUTORY, AS TO THE INFORMATION IN THIS DOCUMENT.</span></span>

<span data-ttu-id="1dd46-316">Ответственность за соблюдение всех авторских прав и прав на интеллектуальную собственность целиком и полностью несет пользователь.</span><span class="sxs-lookup"><span data-stu-id="1dd46-316">Complying with all applicable copyright laws is the responsibility of the user.</span></span> <span data-ttu-id="1dd46-317">Без ограничения авторских прав ни одна из частей этого документа не может быть воспроизведена, сохранена или использована в системах поиска либо передана в любой форме, любыми способами (электронными, механическими, в виде фотокопии, в виде записи или любыми другими) и для любых целей без письменного разрешения корпорации Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="1dd46-317">Without limiting the rights under copyright, no part of this document may be reproduced, stored in or introduced into a retrieval system, or transmitted in any form or by any means (electronic, mechanical, photocopying, recording, or otherwise), or for any purpose, without the express written permission of Microsoft Corporation.</span></span>

<span data-ttu-id="1dd46-318">Корпорация Майкрософт может иметь патенты, патентные заявки, охраняемые товарные знаки, авторские или другие права на интеллектуальную собственность применительно к содержимому этого документа.</span><span class="sxs-lookup"><span data-stu-id="1dd46-318">Microsoft may have patents, patent applications, trademarks, copyrights, or other intellectual property rights covering subject matter in this document.</span></span> <span data-ttu-id="1dd46-319">Без письменного разрешения корпорации Майкрософт данный документ не дает лицензии на эти патенты, охраняемые товарные знаки, авторские права и другую интеллектуальную собственность.</span><span class="sxs-lookup"><span data-stu-id="1dd46-319">Except as expressly provided in any written license agreement from Microsoft, the furnishing of this document does not give you any license to these patents, trademarks, copyrights, or other intellectual property.</span></span>

<span data-ttu-id="1dd46-320">Если не указано иное, примеры компаний, организаций, продуктов, доменных имен, адресов электронной почты, логотипов, людей, мест и событий являются вымышленными, и никакой связи с реальными компаниями, организациями, продуктами, именами доменов, адресами электронной почты, логотипами, лицами, местами и событиями является случайным образом.</span><span class="sxs-lookup"><span data-stu-id="1dd46-320">Unless otherwise noted, the example companies, organizations, products, domain names, email addresses, logos, people, places and events depicted herein are fictitious, and no association with any real company, organization, product, domain name, email address, logo, person, place or event is intended or should be inferred.</span></span>

<span data-ttu-id="1dd46-321">© 2010 Корпорация Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="1dd46-321">© 2010 Microsoft Corporation.</span></span> <span data-ttu-id="1dd46-322">Все права защищены.</span><span class="sxs-lookup"><span data-stu-id="1dd46-322">All rights reserved.</span></span>

<span data-ttu-id="1dd46-323">Microsoft и Windows являются охраняемыми товарными знаками корпорации Майкрософт в США и других странах.</span><span class="sxs-lookup"><span data-stu-id="1dd46-323">Microsoft and Windows are either registered trademarks or trademarks of Microsoft Corporation in the United States and/or other countries.</span></span>

<span data-ttu-id="1dd46-324">Названия фактических компаний и продуктов, упомянутые здесь, могут являться охраняемыми товарными знаками соответствующих владельцев.</span><span class="sxs-lookup"><span data-stu-id="1dd46-324">The names of actual companies and products mentioned herein may be the trademarks of their respective owners.</span></span>
