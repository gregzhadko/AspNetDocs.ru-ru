---
uid: signalr/overview/performance/signalr-connection-density-testing-with-crank
title: Тестирование с помощью Crank плотности подключений SignalR | Документация Майкрософт
author: bradygaster
description: Тестирование плотности подключений SignalR с помощью Crank
ms.author: bradyg
ms.date: 02/22/2015
ms.assetid: 148d9ca7-1af1-44b6-a9fb-91e261b9b463
msc.legacyurl: /signalr/overview/performance/signalr-connection-density-testing-with-crank
msc.type: authoredcontent
ms.openlocfilehash: 40c9764f0c47b83df8300553b4b290429937345c
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/01/2019
ms.locfileid: "57058031"
---
<a name="signalr-connection-density-testing-with-crank"></a>Тестирование плотности подключений SignalR с помощью Crank
====================
по [Tom FitzMacken](https://github.com/tfitzmac)

[!INCLUDE [Consider ASP.NET Core SignalR](~/includes/signalr/signalr-version-disambiguation.md)]

> В этой статье описывается, как использовать средство ручки для тестирования приложения с несколькими клиентами имитации.


После запуска приложения в его среде размещения (либо Azure веб-роли, службы IIS, или размещение с помощью Owin) можно проверить ответ приложения на высокий уровень плотности подключений, используя средство ручки. Среда размещения может быть сервер Internet Information Services (IIS), хостом Owin или веб-роли Azure. (Примечание: Счетчики производительности недоступны на веб-приложениях службы приложений Azure, поэтому вы не сможете получить данные о производительности от плотности Проверка подключения.)

Плотность подключения ссылается на число одновременных TCP-подключений, которые можно установить на сервере. Влечет за собой свой собственный издержки для каждого TCP-подключения и открыв большое количество неактивных соединений в конечном счете создаст узкое место в памяти.

[SignalR codebase](https://github.com/signalr/signalr) включает нагрузочного тестирования утилиту **Crank**. Можно найти в последней версии Crank [ветви Dev](https://github.com/SignalR/signalr/tree/dev) на сайте GitHub. Вы можете скачать ZIP-файла архива ветви Dev SignalR codebase [здесь](https://github.com/SignalR/SignalR/archive/dev.zip).

Crank может использоваться для полностью насыщения памяти сервера, чтобы вычислить общее количество неактивных соединений, возможно на серверное оборудование. Кроме того вы может также использовать ручки для нагрузочного теста сервера под определенный объем нехватки памяти, увеличивать подключений, пока не будет достигнуто значение конкретного счетчика или пороговое значение памяти.

При тестировании, очень важно использовать удаленных клиентах, чтобы избежать любой конкуренция за ресурсы (т. е. TCP-подключения и память). Мониторинг клиентов, чтобы убедиться, что они не превышают узкие места, которые могут помешать серверу достижения в полном объеме (памяти или ЦП). Может потребоваться увеличить число клиентов для полной загрузки сервера.

### <a name="running-a-connection-density-test"></a>Выполнение теста плотность подключения

В этом разделе описываются шаги, которые необходимы для запуска теста плотность подключения в приложении SignalR.

1. Загрузить и построить [codebase ветвь разработки SignalR](https://github.com/SignalR/SignalR/archive/dev.zip). В командной строке перейдите в раздел &lt;каталог проекта&gt;\src\Microsoft.AspNet.SignalR.Crank\bin\debug.
2. Развернете приложение для его предполагаемой средой размещения. Запомните или запишите конечной точки, используемые приложением; Например, в приложение, созданное в [учебнике Приступая к работе](../getting-started/tutorial-getting-started-with-signalr.md), конечная точка имеет `http://<yourhost>:8080/signalr`.
3. Установка [счетчиков производительности SignalR](signalr-performance.md#perfcounters) на сервере. Если приложение работает под управлением Azure, см. в разделе [с помощью счетчиков производительности SignalR в веб-роли Azure](using-signalr-performance-counters-in-an-azure-web-role.md).

Как только вы загрузили и построение базы кода и установлены счетчики производительности на узле, средство командной строки Crank можно найти в `src\Microsoft.AspNet.SignalR.Crank\bin\Debug` папку.

Доступные параметры для средства Crank:

- **/?**: Появится экран справки. Доступные параметры отображаются также в том случае, если **URL-адрес** параметр пропущен.
- **/ URL-адрес**: URL-адрес для подключений SignalR. Этот параметр обязателен. Для приложения SignalR, использование сопоставления по умолчанию, путь будет завершен через «/ signalr».
- **/ Транспорта**: Имя транспорта, используемого. По умолчанию используется `auto`, который выберет наиболее протокола. Параметры включают `WebSockets`, `ServerSentEvents`, и `LongPolling` (`ForeverFrame` не подходит для ручки, так как клиент .NET, а не должен использоваться Internet Explorer). Дополнительные сведения о том, как SignalR выбирает транспортов, см. в разделе [транспорта и в случае ошибки](../getting-started/introduction-to-signalr.md#transports).
- **/ BatchSize**: Число клиентов, которые добавлены в каждом пакете. Значение по умолчанию — 50.
- **/ ConnectInterval**: Интервал в миллисекундах между добавлением соединения. Значение по умолчанию — 500.
- **/ Подключений**: Количество соединений, используемых для тестирования нагрузки приложения. Значение по умолчанию равно 100 000.
- **/ ConnectTimeout**: Время ожидания в секундах до прерывания тестового. Значение по умолчанию — 300.
- **MinServerMBytes**: Минимальной серверной мегабайт для достижения. Значение по умолчанию — 500.
- **SendBytes**: Размер полезных данных, отправляемых на сервер, в байтах. Значение по умолчанию — 0.
- **SendInterval**: Задержка в миллисекундах между сообщениями на сервер. Значение по умолчанию — 500.
- **SendTimeout**: Время ожидания в миллисекундах для сообщений на сервер. Значение по умолчанию — 300.
- **ControllerUrl**: URL-адрес, где один клиент будет размещаться концентратор контроллера. Значение по умолчанию имеет значение null (нет контроллеров). Контроллер концентратор запускается при запуске сеанса ручки; выполняется дальнейшая контакта между контроллеров и ручки.
- **NumClients**: Число имитации клиентов для подключения к приложению. Значение по умолчанию — один.
- **Файл журнала**: Имя файла для файла журнала для тестового запуска. Значение по умолчанию — `crank.csv`.
- **SampleInterval**: Время в миллисекундах между значения выборки счетчиков производительности. Значение по умолчанию — 1000.
- **SignalRInstance**: Имя экземпляра для счетчиков производительности на сервере. Значение по умолчанию — использовать состояние подключения клиента.

### <a name="example"></a>Пример

Следующая команда проверит узла с именем `pfsignalr` в Azure, на котором размещается приложение через порт 8080 в центре, с именем «ControllerHub», с использованием 100 соединений.

`crank /Connections:100 /Url:http://pfsignalr.cloudapp.net:8080/signalr`
