---
uid: signalr/overview/getting-started/tutorial-getting-started-with-signalr
title: Учебник. Чат в реальном времени с SignalR 2 | Документация Майкрософт
author: bradygaster
description: В этом учебнике содержатся сведения об использовании SignalR для создания приложения разговора в режиме реального времени. Добавление пустой веб-приложения ASP.NET SignalR.
ms.author: bradyg
ms.date: 01/22/2019
ms.assetid: a8b3b778-f009-4369-85c7-e90f9878d8b4
msc.legacyurl: /signalr/overview/getting-started/tutorial-getting-started-with-signalr
msc.type: authoredcontent
ms.topic: tutorial
ms.openlocfilehash: ecc235454d4b95ce660a4373387f44720826b076
ms.sourcegitcommit: 2d53ed9e4c8b19d3526cbc689bfa8394c9449cec
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2019
ms.locfileid: "59905648"
---
# <a name="tutorial-real-time-chat-with-signalr-2"></a>Учебник. Чат в реальном времени с SignalR 2

Этом руководстве показано, как использовать SignalR для создания приложения разговора в режиме реального времени. Добавьте пустой веб-приложения ASP.NET SignalR и создайте страницу HTML для отправки и отображения сообщений.

В этом учебнике рассмотрены следующие задачи.

> [!div class="checklist"]
> * Настройка проекта
> * Запуск образца
> * Изучите код

[!INCLUDE [Consider ASP.NET Core SignalR](~/includes/signalr/signalr-version-disambiguation.md)]

## <a name="prerequisites"></a>Предварительные требования

* [Visual Studio 2017](https://visualstudio.microsoft.com/downloads/) с **ASP.NET и веб-разработка** рабочей нагрузки.

## <a name="set-up-the-project"></a>Настройка проекта

В этом разделе показано, как использовать Visual Studio 2017 и SignalR 2 для создания пустой веб-приложения ASP.NET, добавьте SignalR и создание приложения чата.

1. В Visual Studio создайте веб-приложения ASP.NET.

    ![Создание веб-](tutorial-getting-started-with-signalr/_static/image2.png)

1. В **новый проект ASP.NET — SignalRChat** окне оставьте **пустой** затем выберите **ОК**.

1. В **обозревателе решений**, щелкните правой кнопкой мыши проект и выберите **добавить** > **новый элемент**.

1. В **Добавление нового элемента — SignalRChat**выберите **установленные** > **Visual C#**   >  **Web**  >  **SignalR** , а затем выберите **класс концентратора SignalR (v2)**.

1. Назовите класс *ChatHub* и добавьте его в проект.

    На этом шаге создается *ChatHub.cs* файла и добавляет набор файлов сценариев и ссылки на сборки, которые поддерживают SignalR в проект.

1. Замените код в новом *ChatHub.cs* файл класса следующим кодом:

    [!code-csharp[Main](tutorial-getting-started-with-signalr/samples/sample1.cs)]

1. В **обозревателе решений**, щелкните правой кнопкой мыши проект и выберите **добавить** > **новый элемент**.

1. В **Добавление нового элемента — SignalRChat** выберите **установленные** > **Visual C#**   >  **Web** и затем Выберите **класс запуска OWIN**.

1. Назовите класс *запуска* и добавьте его в проект.

1. Замените код по умолчанию в *запуска* класса следующим кодом:

    [!code-csharp[Main](tutorial-getting-started-with-signalr/samples/sample2.cs)]

1. В **обозревателе решений**, щелкните правой кнопкой мыши проект и выберите **добавить** > **HTML-страницу**.

1. Имя новой страницы *индекс* и выберите **ОК**.

1. В **обозревателе решений**, щелкните правой кнопкой мыши созданную HTML-страницы и выберите **задать в качестве начальной страницы**.

1. Замените код по умолчанию в HTML-страницы этот код:

    [!code-html[Main](tutorial-getting-started-with-signalr/samples/sample3.html)]

1. В **обозревателе решений**, разверните **сценариев**.

    Библиотеки скрипта для jQuery и SignalR, отображаются в проект.

    > [!IMPORTANT]
    > Диспетчер пакетов может установить более позднюю версию сценариев SignalR.

1. Убедитесь, что ссылки на скрипты в блоке кода соответствуют версиям файлов сценариев в проекте.

    Ссылки на скрипты из исходного блока кода:

    ```html
    <!--Script references. -->
    <!--Reference the jQuery library. -->
    <script src="Scripts/jquery-3.1.1.min.js" ></script>
    <!--Reference the SignalR library. -->
    <script src="Scripts/jquery.signalR-2.2.1.min.js"></script>
    ```

1. Если они не совпадают, обновите *.html* файл.

1. В строке меню выберите **файл** > **сохранить все**.

## <a name="run-the-sample"></a>Запуск образца

1. На панели инструментов, включите **отладки скриптов** и затем нажмите кнопку воспроизведения, чтобы запустить пример в режиме отладки.

    ![Введите имя пользователя](tutorial-getting-started-with-signalr/_static/image3.png)

1. Когда откроется браузер, введите имя для вашего удостоверения чата.

1. Скопируйте URL-адрес из браузера, откройте два других браузеров и вставьте URL-адреса в панели адрес.

1. В каждом браузере введите уникальное имя.

1. Теперь добавьте комментарий и выберите **отправки**. Повторите, в других браузерах. Комментарии отображаются в режиме реального времени.

    > [!NOTE]
    > Это приложение на простом чате не ведет контекста обсуждения на сервере. Концентратор осуществляет широковещательную передачу комментарии для всех текущих пользователей. Пользователи, беседа позже будет видеть сообщения добавлены с момента их присоединения к.

    См. в разделе, запуск приложения чата в трех различных браузерах. Когда Tom Ананд и Сьюзан отправляют сообщения, все браузеры обновление в режиме реального времени:

    ![Все три браузеры отображают же журнала разговора](tutorial-getting-started-with-signalr/_static/image4.png)

1. В **обозревателе решений**, проверять **документы скриптов** узел для запущенного приложения. Файл скрипта с именем *концентраторов* , библиотека SignalR создает во время выполнения. Этот файл управляет обменом данных между jQuery-сценарий и код на стороне сервера.

    ![автоматически созданное концентраторов сценария в узел документов скриптов](tutorial-getting-started-with-signalr/_static/image5.png)

## <a name="examine-the-code"></a>Изучите код

Приложение SignalRChat демонстрирует две основные задачи разработки SignalR. Оно показано, как создать концентратор. Сервер использует этот концентратор как объект основного координации. Концентратор использует библиотеку jQuery SignalR для отправки и получения сообщений.

### <a name="signalr-hubs-in-the-chathubcs"></a>Концентраторы SignalR в ChatHub.cs

В приведенном выше примере кода `ChatHub` класс является производным от `Microsoft.AspNet.SignalR.Hub` класса. Наследование от `Hub` класс является эффективным методом для построения приложения SignalR. Можно создавать открытые методы в классе концентратора и затем использовать их, вызвав их из сценариев на веб-странице.

В коде чата, клиенты вызывают `ChatHub.Send` метод для отправки нового сообщения. Концентратор затем отправляет сообщение всем клиентам, вызвав `Clients.All.broadcastMessage`.

`Send` Метод демонстрирует несколько вещей понятия:

* Объявления открытых методов концентратора, таким образом, клиенты могут вызывать их.

* Используйте `Microsoft.AspNet.SignalR.Hub.Clients` динамических свойств для взаимодействия со всеми клиентами, подключенных к этому концентратору.

* Вызов функции на стороне клиента (например `broadcastMessage` функции) для обновления клиентов.

    [!code-csharp[Main](tutorial-getting-started-with-signalr/samples/sample4.cs)]

### <a name="signalr-and-jquery-in-the-indexhtml"></a>SignalR и jQuery в index.html

*Index.html* страницы в примере кода показано, как использовать библиотеку jQuery SignalR для взаимодействия с центром SignalR. Код выполняет ряд важных задач. Он объявляется прокси-сервер для ссылки на концентратор, объявляет функцию, сервер может обратиться к содержимому Push-уведомлений для клиентов, что он запускает подключение для отправки сообщений в концентратор.

[!code-javascript[Main](tutorial-getting-started-with-signalr/samples/sample5.js)]

> [!NOTE]
> В JavaScript должно быть camelCase ссылку на класс сервера и его членах. Ссылки на код примера C# *ChatHub* класс в JavaScript в виде `chatHub`.

В этот блок кода как создать функцию обратного вызова в скрипте.

[!code-html[Main](tutorial-getting-started-with-signalr/samples/sample6.html)]

Класс концентратора на сервере вызывает эту функцию для отправки обновлений содержимого для каждого клиента. Две строки, HTML-кодирование содержимого перед его отображением являются необязательными и Показать хороший способ предотвратить внедрение скрипта.

Этот код открывает соединение с концентратором.

[!code-javascript[Main](tutorial-getting-started-with-signalr/samples/sample7.js)]

> [!NOTE]
> Такой подход гарантирует, что код устанавливает соединение перед выполнением обработчика событий.

Код запускает подключение, а затем передает его функции, чтобы обрабатывать событие щелчка на **отправки** кнопку в HTML-страницы.

## <a name="get-the-code"></a>Получение кода

[Скачать завершенный проект](http://code.msdn.microsoft.com/SignalR-Getting-Started-b9d18aa9)

## <a name="additional-resources"></a>Дополнительные ресурсы

Дополнительные сведения о SignalR см. следующие ресурсы:

* [Проект SignalR](http://signalr.net)

* [SignalR Github и примерами](https://github.com/SignalR/SignalR)

* [Вики-сайте SignalR](https://github.com/SignalR/SignalR/wiki)

## <a name="next-steps"></a>Следующие шаги

В этом руководстве вы:

> [!div class="checklist"]
> * Настройка проекта
> * Запустили пример
> * Проверить код

Перейдите к следующей статье, чтобы сведения об использовании SignalR и MVC 5.
> [!div class="nextstepaction"]
> [SignalR 2 и MVC 5](tutorial-getting-started-with-signalr-and-mvc.md)