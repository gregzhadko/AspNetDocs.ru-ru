---
uid: signalr/overview/older-versions/troubleshooting
title: Устранение неполадок SignalR (SignalR 1.x) Документы Майкрософт
author: bradygaster
description: В этой статье описаны общие проблемы с разработкой приложений SignalR.
ms.author: bradyg
ms.date: 06/05/2013
ms.assetid: 347210ba-c452-4feb-886f-b51d89f58971
msc.legacyurl: /signalr/overview/older-versions/troubleshooting
msc.type: authoredcontent
ms.openlocfilehash: e65ce086d28cff2a36c609f47a05af632081be63
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2020
ms.locfileid: "81543097"
---
# <a name="signalr-troubleshooting-signalr-1x"></a>Устранение неполадок SignalR (SignalR 1.x)

[Патрик Флетчер](https://github.com/pfletcher)

[!INCLUDE [Consider ASP.NET Core SignalR](~/includes/signalr/signalr-version-disambiguation.md)]

> В этом документе описаны общие проблемы устранения неполадок с SignalR.

Этот документ содержит следующие разделы.

- [Методы вызова между клиентом и сервером бесшумно не удается](#connection)
- [Другие проблемы с подключением](#other)
- [Компиляция и ошибки на стороне сервера](#server)
- [Вопросы визуальной студии](#vs)
- [Вопросы, связанные с информационными услугами Интернета](#iis)
- [Проблемы Azure](#azure)

<a id="connection"></a>

## <a name="calling-methods-between-the-client-and-server-silently-fails"></a>Методы вызова между клиентом и сервером бесшумно не удается

В этом разделе описаны возможные причины сбоя вызова метода между клиентом и сервером без значимого сообщения об ошибке. В приложении SignalR сервер не имеет информации о методах, которые реализует клиент; когда сервер ссылается на метод клиента, имя метода и данные параметров отправляются клиенту, а метод выполняется только в том случае, если он существует в формате, указанном сервером. Если на клиенте нет способа сопоставления, ничего не происходит, и сообщение об ошибке не поднимается на сервере.

Для дальнейшего изучения методов клиента, не вызываемых, можно включить журнал, прежде чем вызвать метод запуска на концентраторе, чтобы узнать, какие вызовы поступают с сервера. Чтобы включить журнал в приложении JavaScript, [см. Как включить журнал клиентов (клиентская версия JavaScript)](../guide-to-the-api/hubs-api-guide-javascript-client.md#logging). Чтобы включить вход в клиентское приложение .NET, [см. Как включить журнал клиентов (.NET Клиентская версия)](../guide-to-the-api/hubs-api-guide-net-client.md#logging).

### <a name="misspelled-method-incorrect-method-signature-or-incorrect-hub-name"></a>Метод неправильного проработки, неправильная подпись метода или неправильное название концентратора

Если имя или подпись вызываемого метода точно не совпадают с соответствующим методом клиента, вызов завершится неудачей. Убедитесь, что имя метода, вызванное сервером, совпадает с именем метода на клиенте. Кроме того, SignalR создает прокси-концентратор, используя методы верблюжьего `SendMessage` корпуса, как `sendMessage` это уместно в JavaScript, поэтому метод, вызванный на сервер, будет вызываться в клиентском прокси. Если вы `HubName` используете атрибут в коде сервера, убедитесь, что используемое имя соответствует имени, используемому для создания концентратора клиента. Если вы не `HubName` используете атрибут, убедитесь, что имя концентратора в клиенте JavaScript является случаем верблюда, например, chatHub вместо ChatHub.

### <a name="duplicate-method-name-on-client"></a>Двойное имя метода на клиенте

Убедитесь, что у вас нет дубликата метода на клиенте, который отличается только в зависимости от случая. Если в клиентском приложении есть метод, называемый, `sendMessage` `SendMessage` убедитесь, что не существует также метода, называемого также.

### <a name="missing-json-parser-on-the-client"></a>Пропавший парсер JSON на клиенте

SignalR требует присутствия parser JSON для сериализации звонков между сервером и клиентом. Если у вашего клиента нет встроенного парора JSON (например, Internet Explorer 7), его необходимо включить в приложение. Вы можете скачать Parser JSON [здесь](http://nuget.org/packages/json2).

### <a name="mixing-hub-and-persistentconnection-syntax"></a>Смешивание концентратора и синтаксиса PersistentConnection

SignalR использует две коммуникационные модели: концентраторы и стойкие соединения. Синтаксис для вызова этих двух моделей связи отличается в клиентском коде. Если вы добавили концентратор в код сервера, убедитесь, что весь ваш клиентский код использует соответствующий синтаксис концентратора.

**Клиентский код JavaScript, создающий постоянноеподключение в клиенте JavaScript**

[!code-javascript[Main](troubleshooting/samples/sample1.js)]

**Клиентский код JavaScript, создающий прокси-сервер концентратора в клиенте Javascript**

[!code-javascript[Main](troubleshooting/samples/sample2.js)]

**Серверный код C', который отображает маршрут к постоянному подключению**

[!code-csharp[Main](troubleshooting/samples/sample3.cs)]

**Серверный код C,c, который отображает маршрут к концентратору или нескольким концентратам, если у вас есть несколько приложений**

[!code-csharp[Main](troubleshooting/samples/sample4.cs)]

### <a name="connection-started-before-subscriptions-are-added"></a>Подключение началось до добавления подписки

Если подключение концентратора запущено до того, как методы, которые можно вызвать с сервера, будут добавлены к прокси-, сообщения не будут получены. Следующий код JavaScript не запустит концентратор должным образом:

**Неправильный клиентский код JavaScript, который не позволит получать сообщения концентратов**

[!code-javascript[Main](troubleshooting/samples/sample5.js)]

Вместо этого добавьте подписку на метод перед вызовом Start:

**Клиентский код JavaScript, который правильно добавляет подписки в концентратор**

[!code-javascript[Main](troubleshooting/samples/sample6.js)]

### <a name="missing-method-name-on-the-hub-proxy"></a>Отсутствует имя метода на прокси-сервере концентратора

Убедитесь, что метод, определенный на сервере, подписан на клиента. Несмотря на то, что сервер определяет метод, он все равно должен быть добавлен в прокси-сервер клиента. Методы могут быть добавлены в прокси клиента следующим образом (обратите `client` внимание, что метод добавляется к члену концентратора непосредственно):

**Клиентский код JavaScript, который добавляет методы в прокси-сервер концентратора**

[!code-javascript[Main](troubleshooting/samples/sample7.js)]

### <a name="hub-or-hub-methods-not-declared-as-public"></a>Методы концентратора или концентратора, не объявленные общедоступными

Чтобы быть видимым на клиенте, реализация концентратора и методы должны быть объявлены как. `public`

### <a name="accessing-hub-from-a-different-application"></a>Доступ концентратора из другого приложения

Доступ к концентрам SignalR можно получить только через приложения, реализующие клиентов SignalR. SignalR не может сотрудничать с другими библиотеками связи (например, С веб-сервисами SOAP или WCF). Если для вашей целевой платформы нет клиента SignalR, вы не можете получить прямой доступ к конечному моменту сервера.

### <a name="manually-serializing-data"></a>Ручной сериализации данных

SignalR будет автоматически использовать JSON для сериализации параметров вашего метода - нет необходимости делать это самостоятельно.

### <a name="remote-hub-method-not-executed-on-client-in-ondisconnected-function"></a>Метод удаленного концентратора не выполняется на клиенте в функции OnDisconnected

В этом весь замысел. При `OnDisconnected` вызове концентратор `Disconnected` уже вошел в состояние, что не позволяет вызывать дальнейшие методы концентратора.

**Код сервера C,C, который правильно выполняет код в событии OnDisconnected**

[!code-csharp[Main](troubleshooting/samples/sample8.cs)]

### <a name="connection-limit-reached"></a>Ограничение подключения достигнуто

При использовании полной версии IIS на клиентской операционной системе, такой как Windows 7, вводится ограничение на подключение в 10. При использовании клиентской ОС, вместо этого используйте IIS Express, чтобы избежать этого ограничения.

### <a name="cross-domain-connection-not-set-up-properly"></a>Кросс-доменное соединение не настроено должным образом

Если соединение кросс-домена (соединение, для которого URL SignalR не находится в том же домене, что и страница хостинга) настроено неправильно, соединение может выйти из строя без сообщения об ошибке. Для получения информации о том, как включить кросс-домен связи, см [Как установить кросс-домен соединение](../guide-to-the-api/hubs-api-guide-javascript-client.md#crossdomain).

### <a name="connection-using-ntlm-active-directory-not-working-in-net-client"></a>Подключение с использованием NTLM (Active Directory) не работает в клиенте .NET

Подключение в клиентском приложении .NET, используюваесебя безопасность домена, может выработать сядек, если соединение не настроено должным образом. Чтобы использовать SignalR в среде домена, установите необходимое свойство подключения следующим образом:

**Клиентский код C', реализуемый учетные данные соединения**

[!code-csharp[Main](troubleshooting/samples/sample9.cs)]

<a id="other"></a>

## <a name="other-connection-issues"></a>Другие проблемы с подключением

В этом разделе описаны причины и решения для конкретных симптомов или сообщений об ошибках, которые возникают во время соединения.

### <a name="start-must-be-called-before-data-can-be-sent-error"></a>Ошибка "Старт должен быть вызван до отправки данных"

Эта ошибка обычно видна, если код ссылается на объекты SignalR до начала соединения. Проводная связь для обработчиков и тому подобное вызовет методы, определенные на сервере, должны быть добавлены после завершения соединения. Обратите внимание, `Start` что вызов является асинхронным, поэтому код после вызова может быть выполнен до его завершения. Лучший способ добавить обработчики после полного подключения — поместить их в функцию обратного вызова, которая передается в качестве параметра методу запуска:

**Клиентский код JavaScript, который правильно добавляет обработчики событий, которые ссылаются на объекты SignalR**

[!code-javascript[Main](troubleshooting/samples/sample10.js?highlight=1)]

Эта ошибка также будет видна, если соединение останавливается, в то время как объекты SignalR все еще ссылаются.

### <a name="301-moved-permanently-or-302-moved-temporarily-error"></a>Ошибка "301 Перемещено постоянно" или "302 перемещенвременно"

Эта ошибка может быть замечена, если проект содержит папку под названием SignalR, которая будет мешать автоматически созданного прокси. Чтобы избежать этой ошибки, не `SignalR` используйте папку, называемую в приложении, или выключите автоматическое генерирование прокси. Для получения более подробной информации [ознакомьтесь с The Generated Proxy и тем, что он делает для вас.](../guide-to-the-api/hubs-api-guide-javascript-client.md#genproxy)

### <a name="403-forbidden-error-in-net-or-silverlight-client"></a>Ошибка "403 Запрещена" в клиенте .NET или Silverlight

Эта ошибка может произойти в средах кросс-домена, где связь между доменами не включена должным образом. Для получения информации о том, как включить кросс-домен связи, см [Как установить кросс-домен соединение](../guide-to-the-api/hubs-api-guide-javascript-client.md#crossdomain). Чтобы установить кросс-домен соединение в клиенте Silverlight, [см.](../guide-to-the-api/hubs-api-guide-net-client.md#slcrossdomain)

### <a name="404-not-found-error"></a>Ошибка "404 не найдена"

Есть несколько причин для этой проблемы. Проверить все следующие:

- **Ссылка на прокси-адрес концентратора не отформатирована правильно:** Эта ошибка обычно видна, если ссылка на сгенерированный прокси-адрес концентратора не отформатирована правильно. Убедитесь, что ссылка на адрес концентратора сделана должным образом. Узнайте, как ссылаться на [динамически сгенерированный прокси](../guide-to-the-api/hubs-api-guide-javascript-client.md#dynamicproxy) для получения подробной информации.
- **Добавление маршрутов в приложение перед добавлением маршрута концентратора:** Если приложение использует другие маршруты, убедитесь, `MapHubs`что первый добавленный маршрут является вызовом.

### <a name="500-internal-server-error"></a>"500 Внутренняя ошибка сервера"

Это очень общая ошибка, которая может иметь широкий спектр причин. Детали ошибки должны отображаться в журнале событий сервера или могут быть найдены при отладке сервера. Более подробная информация об ошибках может быть получена путем включения подробных ошибок на сервере. Для получения дополнительной [How to handle errors in the Hub class](../guide-to-the-api/hubs-api-guide-server.md#handleErrors)информации см.

### <a name="typeerror-lthubtypegt-is-undefined-error"></a>Ошибка &lt;"TypeError:&gt; hubType является неопределенным" ошибка

Эта ошибка приведет, если `MapHubs` вызов не сделан должным образом. Узнайте, [как зарегистрировать маршрут SignalR и настроить параметры SignalR](../guide-to-the-api/hubs-api-guide-server.md#route) для получения дополнительной информации.

### <a name="jsonserializationexception-was-unhandled-by-user-code"></a>JsonSerializationИсключение не справился с помощью пользовательского кода

Убедитесь, что параметры, которые вы отправляете на методы, не включают несериализируемые типы (например, файлообработки или соединения баз данных). Если вам нужно использовать участников на объекте на стороне сервера, который вы не хотите, чтобы их `JSONIgnore` отправляли клиенту (либо в целях безопасности, либо по причинам сериализации), используйте атрибут.

### <a name="protocol-error-unknown-transport-error"></a>Ошибка "Ошибка протокола: Неизвестный транспорт" ошибка

Эта ошибка может возникнуть, если клиент не поддерживает переносы, которые использует SignalR. См [Транспорти и Fallbacks](../getting-started/introduction-to-signalr.md#transports) для получения информации о том, какие браузеры могут быть использованы с SignalR.

### <a name="javascript-hub-proxy-generation-has-been-disabled"></a>"Поколение прокси-серверов JavaScript Hub отключено."

Эта ошибка будет `DisableJavaScriptProxies` происходить, если установлен, а также `signalr/hubs`в том числе ссылка на динамически сгенерированных прокси на . Для получения дополнительной информации о создании прокси вручную, смотрите [сгенерированный прокси и что он делает для вас.](../guide-to-the-api/hubs-api-guide-javascript-client.md#genproxy)

### <a name="the-connection-id-is-in-the-incorrect-format-or-the-user-identity-cannot-change-during-an-active-signalr-connection-error"></a>"Идентификатор соединения находится в неправильном формате" или "Идентификация пользователя не может изменяться во время активного подключения SignalR" ошибка

Эта ошибка может быть замечена, если используется аутентификация, и клиент вырегистрируется до того, как соединение остановлено. Решение состоит в том, чтобы остановить подключение SignalR перед регистрацией клиента.

### <a name="uncaught-error-signalr-jquery-not-found-please-ensure-jquery-is-referenced-before-the-signalrjs-file-error"></a>"Непойманная ошибка: SignalR: jquery не найдено. Пожалуйста, убедитесь, что j'ery ссылается до ошибки файла SignalR.js

Клиент SignalR JavaScript требует запуска j''i. Убедитесь, что ваша ссылка на j'ery верна, что используемый путь является действительным, и что ссылка на j'ery находится до ссылки на SignalR.

### <a name="uncaught-typeerror-cannot-read-property-ltpropertygt-of-undefined-error"></a>"Uncaught TypeError: Не&lt;может&gt;читать свойство ' собственности ' неопределенных" ошибка

Эта ошибка является результатом не имеющих j'sry или концентраторов прокси ссылки должным образом. Убедитесь, что ваша ссылка на прокси j'ery и концентраторы верна, что используемый путь действителен, и что ссылка на j'ery находится до ссылки на прокси концентратов. Ссылка по умолчанию на прокси-сервер концентраторов должна выглядеть следующим образом:

**HTML клиент-код, который правильно ссылается на прокси концентраторов**

[!code-html[Main](troubleshooting/samples/sample11.html)]

### <a name="runtimebinderexception-was-unhandled-by-user-code-error"></a>"RuntimeBinderException был необработан из-за ошибки кода пользователя"

Эта ошибка может возникнуть при `Hub.On` неправильной перегрузке. Если метод имеет значение возврата, тип возврата должен быть указан как общий параметр типа:

**Метод, определяемый на клиенте (без генерируемого прокси)**

[!code-html[Main](troubleshooting/samples/sample12.html?highlight=1)]

### <a name="connection-id-is-inconsistent-or-connection-breaks-between-page-loads"></a>Идентификатор соединения несовместим или разрывы связи между загрузками страниц

В этом весь замысел. Поскольку объект концентратора размещается в объекте страницы, концентратор уничтожается при обновлении страницы. Многостраничное приложение должно поддерживать связь между пользователями и идентизацией связи, чтобы они были последовательными между загрузками страниц. Итики подключения могут храниться на `ConcurrentDictionary` сервере как в объекте, так и в базе данных.

### <a name="value-cannot-be-null-error"></a>Ошибка "Value не может быть нулевым"

Методы сервера с дополнительными параметрами в настоящее время не поддерживаются; если дополнительный параметр опущен, метод выйдет из строя. Для получения дополнительной [информации см.](https://github.com/SignalR/SignalR/issues/324)

### <a name="firefox-cant-establish-a-connection-to-the-server-at-ltaddressgt-error-in-firebug"></a>"Firefox не может установить подключение &lt;к&gt;серверу по адресу " Ошибка в Firebug

Это сообщение об ошибке можно увидеть в Firebug, если переговоры о транспорте WebSocket не удались, и вместо него используется другой транспорт. В этом весь замысел.

### <a name="the-remote-certificate-is-invalid-according-to-the-validation-procedure-error-in-net-client-application"></a>"Удаленный сертификат недействителен в соответствии с процедурой проверки" ошибка в клиентском приложении .NET

Если серверу требуются пользовательские сертификаты клиента, то вы можете добавить сертификат x509 к подключению до того, как будет сделан запрос. Добавьте сертификат к `Connection.AddClientCertificate`подключению с помощью .

### <a name="connection-drops-after-authentication-times-out"></a>Подключение падает после проверки подлинности

В этом весь замысел. Учетные данные аутентификации не могут быть изменены во время активного подключения; для обновления учетных данных соединение должно быть остановлено и перезапущено.

### <a name="onconnected-gets-called-twice-when-using-jquery-mobile"></a>OnConnected вызывается дважды при использовании j's'ry Mobile

`initializePage` Функция j's Mobile заставляет скрипты на каждой странице повторно выполняться, создавая тем самым второе соединение. Решения для этой проблемы включают в себя:

- Включите ссылку на j'ery Mobile перед файлом JavaScript.
- Отпустите `initializePage` функцию, установив. `$.mobile.autoInitializePage = false`
- Подождите, пока страница закончится инициализацией, прежде чем начать соединение.

### <a name="messages-are-delayed-in-silverlight-applications-using-server-sent-events"></a>Сообщения задерживаются в приложениях Silverlight с помощью событий Сервера Отправлено

Сообщения задерживаются при использовании событий, отправляемых на сервере Silverlight. Чтобы вместо этого принудить к использованию длинные опросы, используйте следующее при запуске соединения:

[!code-css[Main](troubleshooting/samples/sample13.css)]

### <a name="permission-denied-using-forever-frame-protocol"></a>"Разрешение отказано" с использованием протокола Forever Frame

Это известный вопрос, описанный [здесь](https://github.com/SignalR/SignalR/issues/1963). Этот симптом можно увидеть с помощью последней библиотеки J'ery; обходной путь заключается в том, чтобы понизить ваше приложение до J's1.8.2.

<a id="server"></a>

## <a name="compilation-and-server-side-errors"></a>Компиляция и ошибки на стороне сервера

 Следующий раздел содержит возможные решения для компилятора и ошибок в расписании выполнения сервера. 

### <a name="reference-to-hub-instance-is-null"></a>Ссылка на экземпляр концентратора является нулевой

Поскольку экземпляр концентратора создается для каждого соединения, вы не можете создать экземпляр концентратора в коде самостоятельно. Чтобы вызвать методы концентратора из-за пределов самого концентратора, [см. Как вызвать методы клиента и управлять группами из-за пределов класса концентратора,](../guide-to-the-api/hubs-api-guide-server.md#callfromoutsidehub) чтобы получить ссылку на контекст концентратора.

### <a name="httpcontextcurrentsession-is-null"></a>HTTPContext.Current.Session является недействительным

В этом весь замысел. SignalR не поддерживает состояние сеанса ASP.NET, так как включение состояния сеанса приведет к разбивке дуплексных сообщений.

### <a name="no-suitable-method-to-override"></a>Нет подходящего метода для переопределения

Вы можете увидеть эту ошибку, если вы используете код из старой документации или блогов. Убедитесь, что вы не ссылаетесь на названия методов, которые `OnConnectedAsync`были изменены или измотаны (например).

### <a name="hostcontextextensionswebsocketserverurl-is-null"></a>HostContextExtensions.WebSocketServerUrl является недействительным

В этом весь замысел. Этот член является амортизированным и не должен использоваться.

### <a name="a-route-named-signalrhubs-is-already-in-the-route-collection-error"></a>"Маршрут под названием 'signalr.hubs' уже находится в сборе маршрутов" ошибка

Эта ошибка будет `MapHubs` видна, если она называется в два раза вашим приложением. Некоторые примеры `MapHubs` приложений называются непосредственно в файле глобального приложения; другие делают звонок в типе обертки. Убедитесь, что приложение не выполняет и то, и другое.

<a id="vs"></a>

## <a name="visual-studio-issues"></a>Вопросы визуальной студии

В этом разделе описаны проблемы, возникающие в Visual Studio.

### <a name="script-documents-node-does-not-appear-in-solution-explorer"></a>Узел документов скрипта не отображается в Исследователе решения

Некоторые из наших учебников направляют вас к узлом "Документы сценариев" в Solution Explorer во время отладки. Этот узло производится отладчиком JavaScript и будет отображаться только при отладке клиентов браузера в Internet Explorer; узел не появится при использовании Chrome или Firefox. Отладка JavaScript также не будет работать, если работает другой отладчик клиента, например отладчик Silverlight.

### <a name="signalr-does-not-work-on-visual-studio-2008-or-earlier"></a>SignalR не работает на Visual Studio 2008 или раньше

В этом весь замысел. SignalR требует .NET Framework 4 или более поздней позже; это требует, чтобы приложения SignalR разрабатывались в Visual Studio 2010 или позже.

<a id="iis"></a>

## <a name="iis-issues"></a>Вопросы ИИС

Этот раздел содержит проблемы с Информационными службами Интернета.

### <a name="web-site-crashes-after-maphubs-call"></a>Веб-сайт выходит из строя после вызова MapHubs

Эта проблема была исправлена в последней версии SignalR. Убедитесь, что вы используете последнюю выпущенную версию SignalR, обновляя установку с помощью NuGet.

<a id="azure"></a>

## <a name="azure-issues"></a>Проблемы Azure

Этот раздел содержит проблемы с Microsoft Azure.

### <a name="messages-are-not-received-through-the-azure-backplane-after-altering-topic-names"></a>Сообщения не принимаются через заднюю плоскость Azure после изменения названий тем

Темы, используемые задней плоскостью Azure, не предназначены для настройки пользователя.
