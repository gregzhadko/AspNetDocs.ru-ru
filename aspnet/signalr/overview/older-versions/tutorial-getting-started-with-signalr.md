---
uid: signalr/overview/older-versions/tutorial-getting-started-with-signalr
title: Учебник. начало работы с SignalR 1. x | Документация Майкрософт
author: bradygaster
description: Используйте ASP.NET SignalR для создания приложения разговора в режиме реального времени на HTML-странице.
ms.author: bradyg
ms.date: 02/18/2013
ms.assetid: fdc3599a-5217-44c1-951f-0eec9812dce7
msc.legacyurl: /signalr/overview/older-versions/tutorial-getting-started-with-signalr
msc.type: authoredcontent
ms.openlocfilehash: 87a90b47ae30bee43e0b0c1e078597db54b8e67d
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78505752"
---
# <a name="tutorial-getting-started-with-signalr-1x"></a>Учебник. начало работы с SignalR 1. x

[Патрик Флетчера](https://github.com/pfletcher), [Тим тибкен](https://github.com/timlt)

[!INCLUDE [Consider ASP.NET Core SignalR](~/includes/signalr/signalr-version-disambiguation.md)]

> В этом учебнике содержатся сведения об использовании SignalR для создания приложения разговора в режиме реального времени. Вы добавите SignalR в пустое веб-приложение ASP.NET и создадите HTML-страницу для отправки и вывода сообщений.

## <a name="overview"></a>Обзор

В этом учебнике рассматривается разработка SignalR, в которой показано, как создать простое приложение для разговора на основе браузера. Вы добавите библиотеку SignalR в пустое веб-приложение ASP.NET, создадите класс концентратора для отправки сообщений клиентам и создадите HTML-страницу, позволяющую пользователям отправлять и получать сообщения в чате. Аналогичный учебник, в котором показано, как создать приложение разговора в MVC 4 с помощью представления MVC, см. в разделе [Начало работы с SignalR и MVC 4](index.md).

> [!NOTE]
> В этом руководстве используется версия SignalR (1. x). Дополнительные сведения об изменениях в SignalR 1. x и 2,0 см. в разделе [Обновление проектов SignalR 1. x](../releases/upgrading-signalr-1x-projects-to-20.md).

SignalR — это библиотека .NET с открытым исходным кодом для создания веб-приложений, требующих интерактивного взаимодействия с пользователем или обновления данных в режиме реального времени. К примерам относятся социальные приложения, многопользовательские игры, Бизнес-совместная работа, Новости, погода или финансовые обновления. Они часто называются приложениями в режиме реального времени.

SignalR упрощает процесс создания приложений в режиме реального времени. Он включает библиотеку сервера ASP.NET и клиентскую библиотеку JavaScript, чтобы упростить управление подключениями клиента и сервера и отправлять обновления содержимого на клиенты. Библиотеку SignalR можно добавить в существующее приложение ASP.NET для получения функциональных возможностей в режиме реального времени.

В этом учебнике демонстрируются следующие задачи разработки SignalR:

- Добавление библиотеки SignalR в веб-приложение ASP.NET.
- Создание класса концентратора для отправки содержимого клиентам.
- Использование библиотеки jQuery SignalR на веб-странице для отправки сообщений и вывода обновлений из центра.

На следующем снимке экрана показано приложение разговора, выполняемое в браузере. Каждый новый пользователь может публиковать комментарии и просматривать комментарии, добавленные после того, как пользователь присоединился к разговору.

![Экземпляры чата](tutorial-getting-started-with-signalr/_static/image1.png)

Священ

- [Настройка проекта](#setup)
- [Запуск примера](#run)
- [Изучение кода](#code)
- [Следующие шаги](#next)

<a id="setup"></a>

## <a name="set-up-the-project"></a>Настройка проекта

В этом разделе показано, как создать пустое веб-приложение ASP.NET, добавить SignalR и создать приложение Chat.

Предварительные требования:

- Visual Studio 2010 с пакетом обновления 1 (SP1) или 2012. Если у вас нет Visual Studio, см. [ASP.net downloads](https://www.asp.net/downloads) , чтобы получить бесплатное средство visual Studio 2012 Express Development Tool.
- [Microsoft ASP.NET and Web Tools 2012,2](https://go.microsoft.com/fwlink/?LinkId=279941). Для Visual Studio 2012 этот установщик добавляет новые функции ASP.NET, включая шаблоны SignalR, в Visual Studio. Для Visual Studio 2010 с пакетом обновления 1 (SP1) установщик недоступен, но можно завершить работу с руководством, установив пакет NuGet SignalR, как описано в шагах установки.

Следующие шаги используют Visual Studio 2012 для создания пустого веб-приложения ASP.NET и добавления библиотеки SignalR:

1. В Visual Studio создайте пустое веб-приложение ASP.NET.

    ![Создать пустой веб-сайт](tutorial-getting-started-with-signalr/_static/image2.png)
2. Откройте **консоль диспетчера пакетов** , выбрав **Сервис | Диспетчер пакетов NuGet | Консоль диспетчера пакетов**. В окне консоли введите следующую команду:

    `Install-Package Microsoft.AspNet.SignalR -Version 1.1.3`

    Эта команда устанавливает последнюю версию SignalR 1. x.
3. В **Обозреватель решений**щелкните правой кнопкой мыши проект, выберите **Добавить | Класс**. Назовите новый класс **часуб**.
4. В **Обозреватель решений** разверните узел скрипты. Библиотеки скриптов для jQuery и SignalR отображаются в проекте.

    ![Ссылки на библиотеки](tutorial-getting-started-with-signalr/_static/image3.png)
5. Замените код в классе **часуб** следующим кодом.

    [!code-csharp[Main](tutorial-getting-started-with-signalr/samples/sample1.cs)]
6. В **Обозреватель решений**щелкните правой кнопкой мыши проект и выберите команду **Добавить | Новый элемент**. В диалоговом окне **Добавление нового элемента** выберите **Глобальный класс приложения** и нажмите кнопку **добавить**.

    ![Добавить глобальное](tutorial-getting-started-with-signalr/_static/image4.png)
7. Добавьте следующие `using` операторы после указанных операторов `using` в классе Global.asax.cs.

    [!code-csharp[Main](tutorial-getting-started-with-signalr/samples/sample2.cs)]
8. Добавьте следующую строку кода в метод `Application_Start` глобального класса, чтобы зарегистрировать маршрут по умолчанию для концентраторов SignalR.

    [!code-csharp[Main](tutorial-getting-started-with-signalr/samples/sample3.cs)]
9. В **Обозреватель решений**щелкните правой кнопкой мыши проект и выберите команду **Добавить | Новый элемент**. В диалоговом окне **Добавление нового элемента** выберите HTML-страница и нажмите кнопку **Добавить**.
10. В **Обозреватель решений**щелкните правой кнопкой мыши только что СОЗДАНную HTML-страницу и выберите пункт **задать как начальную страницу**.
11. Замените код по умолчанию на странице HTML следующим кодом.

    [!code-html[Main](tutorial-getting-started-with-signalr/samples/sample4.html)]
12. **Сохраните все** для проекта.

<a id="run"></a>

## <a name="run-the-sample"></a>Запуск примера

1. Нажмите клавишу F5, чтобы запустить проект в режиме отладки. Страница HTML загружается в экземпляр браузера и запрашивает имя пользователя.

    ![Введите имя пользователя](tutorial-getting-started-with-signalr/_static/image5.png)
2. Введите имя пользователя.
3. Скопируйте URL-адрес из строки адреса браузера и используйте его, чтобы открыть два других экземпляра браузера. В каждом экземпляре браузера введите уникальное имя пользователя.
4. В каждом экземпляре браузера добавьте комментарий и нажмите кнопку **Отправить**. Комментарии должны отображаться во всех экземплярах браузера.

    > [!NOTE]
    > Это простое приложение разговора не поддерживает контекст обсуждения на сервере. Центр передает комментарии всем текущим пользователям. Пользователи, которые присоединяются к обсуждению позже, увидят сообщения, добавленные с момента присоединение.

    На следующем снимке экрана показано приложение разговора, выполняемое в трех экземплярах браузера, все из которых обновляются, когда один экземпляр отправляет сообщение:

    ![Браузеры чатов](tutorial-getting-started-with-signalr/_static/image6.png)
5. В **Обозреватель решений**просмотрите узел **документы скрипта** для работающего приложения. Существует файл скрипта **с именем** Hubs, динамически формируемый библиотекой SignalR во время выполнения. Этот файл управляет обменом данными между скриптом jQuery и кодом на стороне сервера.

    ![Созданный скрипт концентратора](tutorial-getting-started-with-signalr/_static/image7.png)

<a id="code"></a>

## <a name="examine-the-code"></a>Изучение кода

Приложение разговора SignalR демонстрирует две основные задачи разработки SignalR: создание концентратора в качестве основного объекта координации на сервере и использование библиотеки jQuery SignalR для отправки и получения сообщений.

### <a name="signalr-hubs"></a>Концентраторы SignalR

В примере кода класс **часуб** является производным от класса **Microsoft. AspNet. SignalR. Hub** . Наследование от класса **Hub** — это удобный способ создания приложения SignalR. Вы можете создавать открытые методы в классе Hub, а затем обращаться к этим методам, вызывая их из скриптов jQuery на веб-странице.

В коде разговора клиенты вызывают метод **часуб. Send** для отправки нового сообщения. Концентратор, в свою очередь, отправляет сообщение всем клиентам, вызывая **Clients. ALL. броадкастмессаже**.

Метод **Send** демонстрирует несколько основных понятий:

- Объявите открытые методы в концентраторе, чтобы клиенты могли их вызывать.
- Используйте динамическое свойство **Microsoft. AspNet. SignalR. Hub. Clients** для доступа ко всем клиентам, подключенным к этому концентратору.
- Вызовите функцию jQuery на клиенте (например, функцию `broadcastMessage`) для обновления клиентов.

    [!code-csharp[Main](tutorial-getting-started-with-signalr/samples/sample5.cs)]

### <a name="signalr-and-jquery"></a>SignalR и jQuery

На странице HTML в образце кода показано, как использовать библиотеку jQuery SignalR для взаимодействия с концентратором SignalR. Основными задачами в коде является объявление прокси-сервера для ссылки на концентратор, объявление функции, которую сервер может вызывать для отправки содержимого клиентам, и запуск соединения для отправки сообщений в концентратор.

Следующий код объявляет прокси-сервер для концентратора.

[!code-javascript[Main](tutorial-getting-started-with-signalr/samples/sample6.js)]

> [!NOTE]
> В jQuery ссылка на серверный класс и его члены находятся в неоднородном регистре. Пример кода ссылается C# на класс **часуб** в jQuery как **часуб**.

В следующем коде показано, как создать функцию обратного вызова в скрипте. Класс концентратора на сервере вызывает эту функцию для отправки обновлений содержимого на каждый клиент. Две строки, которые кодирует содержимое в формате HTML перед отображением, являются необязательными и показывают простой способ предотвращения внедрения скрипта.

[!code-html[Main](tutorial-getting-started-with-signalr/samples/sample7.html)]

В следующем коде показано, как открыть подключение к концентратору. Код запускает соединение, а затем передает ему функцию для управления событием щелчка на кнопке **Send** на странице HTML.

> [!NOTE]
> Этот подход гарантирует, что соединение будет установлено до выполнения обработчика событий.

[!code-javascript[Main](tutorial-getting-started-with-signalr/samples/sample8.js)]

<a id="next"></a>

## <a name="next-steps"></a>Next Steps

Вы узнали, что SignalR — это платформа для создания веб-приложений в режиме реального времени. Вы также узнали о нескольких задачах разработки SignalR: как добавить SignalR в приложение ASP.NET, как создать класс Hub, а также как отправлять и получать сообщения от концентратора.

Вы можете сделать пример приложения в этом руководстве или других приложениях SignalR, доступных через Интернет, развернув их на поставщик услуг размещения. Корпорация Майкрософт предлагает бесплатное веб-размещение для 10 веб-сайтов в бесплатной [пробной учетной записи Windows Azure](https://www.windowsazure.com/pricing/free-trial/?WT.mc_id=A443DD604). Пошаговое руководство по развертыванию примера приложения SignalR см. в статье [публикация начало работы образца в качестве веб-сайта Windows Azure](https://blogs.msdn.com/b/timlee/archive/2013/02/27/deploy-the-signalr-getting-started-sample-as-a-windows-azure-web-site.aspx). Подробные сведения о развертывании веб-проекта Visual Studio на веб-сайте Windows Azure см. в статье [развертывание приложения ASP.NET на веб-сайте Windows Azure](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet). (Примечание. транспорт WebSocket в настоящее время не поддерживается для веб-сайтов Windows Azure. Если транспорт WebSocket недоступен, SignalR использует другие доступные транспорты, как описано в разделе транспорты статьи [Введение в SignalR](index.md).)

Чтобы узнать о более сложных концепциях разработки SignalR, посетите следующие сайты с исходным кодом и ресурсами SignalR:

- [Проект SignalR](http://signalr.net)
- [GitHub и примеры SignalR](https://github.com/SignalR/SignalR)
- [Вики-сайт SignalR](https://github.com/SignalR/SignalR/wiki)
