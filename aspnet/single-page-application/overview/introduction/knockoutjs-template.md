---
uid: single-page-application/overview/introduction/knockoutjs-template
title: Одностраничное приложение. Шаблон KnockoutJS | Документация Майкрософт
author: MikeWasson
description: Шаблон Knockout
ms.author: riande
ms.date: 01/30/2013
ms.assetid: f9c07af0-4b20-4b08-af8f-47fc3df169a2
msc.legacyurl: /single-page-application/overview/introduction/knockoutjs-template
msc.type: authoredcontent
ms.openlocfilehash: 20d2d4412345399acdde1535447cc18b6611b572
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59412857"
---
# <a name="single-page-application-knockoutjs-template"></a><span data-ttu-id="71e43-103">Одностраничное приложение. Шаблон KnockoutJS</span><span class="sxs-lookup"><span data-stu-id="71e43-103">Single Page Application: KnockoutJS template</span></span>

<span data-ttu-id="71e43-104">по [Майк Уоссон](https://github.com/MikeWasson)</span><span class="sxs-lookup"><span data-stu-id="71e43-104">by [Mike Wasson](https://github.com/MikeWasson)</span></span>

> <span data-ttu-id="71e43-105">Шаблон MVC Knockout является частью ASP.NET и веб-инструментами 2012.2</span><span class="sxs-lookup"><span data-stu-id="71e43-105">The Knockout MVC Template is part of ASP.NET and Web Tools 2012.2</span></span>
> 
> [<span data-ttu-id="71e43-106">Скачать ASP.NET и веб-инструменты 2012.2</span><span class="sxs-lookup"><span data-stu-id="71e43-106">Download ASP.NET and Web Tools 2012.2</span></span>](https://go.microsoft.com/fwlink/?LinkId=282650)


<span data-ttu-id="71e43-107">Обновления ASP.NET и веб-инструментами 2012.2 содержит шаблон одностраничного приложения (SPA) для ASP.NET MVC 4.</span><span class="sxs-lookup"><span data-stu-id="71e43-107">The ASP.NET and Web Tools 2012.2 update includes a Single-Page Application (SPA) template for ASP.NET MVC 4.</span></span> <span data-ttu-id="71e43-108">Этот шаблон предназначен для начала работы, быстрого создания интерактивных клиентского веб-приложений.</span><span class="sxs-lookup"><span data-stu-id="71e43-108">This template is designed to get you started quickly building interactive client-side web apps.</span></span>

<span data-ttu-id="71e43-109">«Одностраничного приложения» (SPA) — это общий термин для веб-приложения, который загружает единственную HTML-страницу и затем обновляет страницу динамически, вместо загрузки новых страниц.</span><span class="sxs-lookup"><span data-stu-id="71e43-109">"Single-page application" (SPA) is the general term for a web application that loads a single HTML page and then updates the page dynamically, instead of loading new pages.</span></span> <span data-ttu-id="71e43-110">После загрузки начальной страницы SPA взаимодействует с сервером с помощью запросов AJAX.</span><span class="sxs-lookup"><span data-stu-id="71e43-110">After the initial page load, the SPA talks with the server through AJAX requests.</span></span>

![](knockoutjs-template/_static/image1.png)

<span data-ttu-id="71e43-111">AJAX нет ничего нового, но на сегодняшний день существует платформ JavaScript, которые упрощают создание и обслуживание большого сложные приложения SPA.</span><span class="sxs-lookup"><span data-stu-id="71e43-111">AJAX is nothing new, but today there are JavaScript frameworks that make it easier to build and maintain a large sophisticated SPA application.</span></span> <span data-ttu-id="71e43-112">Кроме того HTML 5 и CSS3 что облегчает создание многофункциональных пользовательских интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="71e43-112">Also, HTML 5 and CSS3 are making it easier to create rich UIs.</span></span>

<span data-ttu-id="71e43-113">Чтобы приступить к работе, SPA шаблон создает образец приложения «Список дел».</span><span class="sxs-lookup"><span data-stu-id="71e43-113">To get you started, the SPA template creates a sample "To-do list" application.</span></span> <span data-ttu-id="71e43-114">В этом руководстве мы рассмотрим демонстрацию шаблона.</span><span class="sxs-lookup"><span data-stu-id="71e43-114">In this tutorial, we'll take a guided tour of the template.</span></span> <span data-ttu-id="71e43-115">Сначала мы будем рассмотрим само приложение списка дел, а затем проверьте примеров технологий, которые делают это в действии.</span><span class="sxs-lookup"><span data-stu-id="71e43-115">First we'll look at the To-do list application itself, then examine the technology pieces that make it work.</span></span>

## <a name="create-a-new-spa-template-project"></a><span data-ttu-id="71e43-116">Создание нового шаблона проекта SPA</span><span class="sxs-lookup"><span data-stu-id="71e43-116">Create a New SPA Template Project</span></span>

<span data-ttu-id="71e43-117">Требования:</span><span class="sxs-lookup"><span data-stu-id="71e43-117">Requirements:</span></span>

- <span data-ttu-id="71e43-118">Visual Studio 2012 или Visual Studio Express 2012 для Web</span><span class="sxs-lookup"><span data-stu-id="71e43-118">Visual Studio 2012 or Visual Studio Express 2012 for Web</span></span>
- <span data-ttu-id="71e43-119">Обновление средств ASP.NET Web 2012.2.</span><span class="sxs-lookup"><span data-stu-id="71e43-119">ASP.NET Web Tools 2012.2 update.</span></span> <span data-ttu-id="71e43-120">Можно установить обновление [здесь](https://www.microsoft.com/web/handlers/webpi.ashx?command=getinstallerredirect&appid=ASPDOTNETandWebTools2012_2).</span><span class="sxs-lookup"><span data-stu-id="71e43-120">You can install the update [here](https://www.microsoft.com/web/handlers/webpi.ashx?command=getinstallerredirect&appid=ASPDOTNETandWebTools2012_2).</span></span>

<span data-ttu-id="71e43-121">Запустите Visual Studio и выберите **новый проект** с начальной страницы.</span><span class="sxs-lookup"><span data-stu-id="71e43-121">Start Visual Studio and select **New Project** from the Start page.</span></span> <span data-ttu-id="71e43-122">Или с **файл** меню, выберите **New** и затем **проекта**.</span><span class="sxs-lookup"><span data-stu-id="71e43-122">Or, from the **File** menu, select **New** and then **Project**.</span></span>

<span data-ttu-id="71e43-123">В **шаблоны** области выберите **установленные шаблоны** и разверните **Visual C#** узла.</span><span class="sxs-lookup"><span data-stu-id="71e43-123">In the **Templates** pane, select **Installed Templates** and expand the **Visual C#** node.</span></span> <span data-ttu-id="71e43-124">В разделе **Visual C#** выберите **Web**.</span><span class="sxs-lookup"><span data-stu-id="71e43-124">Under **Visual C#**, select **Web**.</span></span> <span data-ttu-id="71e43-125">В списке шаблонов проектов выберите **веб-приложение ASP.NET MVC 4**.</span><span class="sxs-lookup"><span data-stu-id="71e43-125">In the list of project templates, select **ASP.NET MVC 4 Web Application**.</span></span> <span data-ttu-id="71e43-126">Имя проекта и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="71e43-126">Name the project and click **OK**.</span></span>

![](knockoutjs-template/_static/image2.png)

<span data-ttu-id="71e43-127">В **новый проект** мастера выберите **одностраничного приложения**.</span><span class="sxs-lookup"><span data-stu-id="71e43-127">In the **New Project** wizard, select **Single Page Application**.</span></span>

![](knockoutjs-template/_static/image3.png)

<span data-ttu-id="71e43-128">Нажмите клавишу F5, чтобы выполнить сборку приложения и запустить его.</span><span class="sxs-lookup"><span data-stu-id="71e43-128">Press F5 to build and run the application.</span></span> <span data-ttu-id="71e43-129">При первом запуске приложения отображается экран входа.</span><span class="sxs-lookup"><span data-stu-id="71e43-129">When the application first runs, it displays a login screen.</span></span>

![](knockoutjs-template/_static/image4.png)

<span data-ttu-id="71e43-130">Нажмите кнопку &quot;зарегистрироваться&quot; связать и создать нового пользователя.</span><span class="sxs-lookup"><span data-stu-id="71e43-130">Click the &quot;Sign up&quot; link and create a new user.</span></span>

![](knockoutjs-template/_static/image5.png)

<span data-ttu-id="71e43-131">После входа в приложение создает список Todo по умолчанию с двумя элементами.</span><span class="sxs-lookup"><span data-stu-id="71e43-131">After you log in, the application creates a default Todo list with two items.</span></span> <span data-ttu-id="71e43-132">Нажмите кнопку «Добавить список дел» для добавления нового списка.</span><span class="sxs-lookup"><span data-stu-id="71e43-132">You can click "Add Todo list" to add a new list.</span></span>

![](knockoutjs-template/_static/image6.png)

<span data-ttu-id="71e43-133">Список переименования, добавление элементов в списке и снимите флажок.</span><span class="sxs-lookup"><span data-stu-id="71e43-133">Rename the list, add items to the list, and check them off.</span></span> <span data-ttu-id="71e43-134">Кроме того, можно удалить элементы или удалять весь список.</span><span class="sxs-lookup"><span data-stu-id="71e43-134">You can also delete items or delete an entire list.</span></span> <span data-ttu-id="71e43-135">Эти изменения автоматически сохраняются в базу данных на сервере (фактически LocalDB на этом этапе, так как приложение выполняется локально).</span><span class="sxs-lookup"><span data-stu-id="71e43-135">The changes are automatically persisted to a database on the server (actually LocalDB at this point, because you are running the application locally).</span></span>

![](knockoutjs-template/_static/image7.png)

## <a name="architecture-of-the-spa-template"></a><span data-ttu-id="71e43-136">Архитектура шаблона одностраничного приложения</span><span class="sxs-lookup"><span data-stu-id="71e43-136">Architecture of the SPA Template</span></span>

<span data-ttu-id="71e43-137">На этой диаграмме показаны основные строительные блоки для приложения.</span><span class="sxs-lookup"><span data-stu-id="71e43-137">This diagram shows the main building blocks for the application.</span></span>

![](knockoutjs-template/_static/image8.png)

<span data-ttu-id="71e43-138">На стороне сервера ASP.NET MVC служит HTML, а также обрабатывает проверку подлинности на основе форм.</span><span class="sxs-lookup"><span data-stu-id="71e43-138">On the server side, ASP.NET MVC serves the HTML and also handles forms-based authentication.</span></span>

<span data-ttu-id="71e43-139">Веб-API ASP.NET обрабатывает все запросы, относящиеся к ToDoLists и ToDoItems, включая получение, создание, обновление и удаление.</span><span class="sxs-lookup"><span data-stu-id="71e43-139">ASP.NET Web API handles all requests that relate to the ToDoLists and ToDoItems, including getting, creating, updating and deleting.</span></span> <span data-ttu-id="71e43-140">Клиент обменивается данными с веб-API в формате JSON.</span><span class="sxs-lookup"><span data-stu-id="71e43-140">The client exchanges data with Web API in JSON format.</span></span>

<span data-ttu-id="71e43-141">Entity Framework (EF) — уровень объектно-реляционное отображение.</span><span class="sxs-lookup"><span data-stu-id="71e43-141">Entity Framework (EF) is the O/RM layer.</span></span> <span data-ttu-id="71e43-142">Он служит посредником между объектно ориентированном мире ASP.NET и базы данных.</span><span class="sxs-lookup"><span data-stu-id="71e43-142">It mediates between the object-oriented world of ASP.NET and the underlying database.</span></span> <span data-ttu-id="71e43-143">База данных использует LocalDB, но это можно изменить в файле Web.config.</span><span class="sxs-lookup"><span data-stu-id="71e43-143">The database uses LocalDB but you can change this in the Web.config file.</span></span> <span data-ttu-id="71e43-144">Обычно вы будет использовать LocalDB для локальной разработки и затем развернуть в базе данных SQL на сервере, используя миграцию на EF code first.</span><span class="sxs-lookup"><span data-stu-id="71e43-144">Typically you would use LocalDB for local development and then deploy to a SQL database on the server, using EF code-first migration.</span></span>

<span data-ttu-id="71e43-145">На стороне клиента библиотека Knockout.js обрабатывает обновления страниц из запросов AJAX.</span><span class="sxs-lookup"><span data-stu-id="71e43-145">On the client side, the Knockout.js library handles page updates from AJAX requests.</span></span> <span data-ttu-id="71e43-146">Knockout использует привязку данных для синхронизации на странице с последними данными.</span><span class="sxs-lookup"><span data-stu-id="71e43-146">Knockout uses data binding to synchronize the page with the latest data.</span></span> <span data-ttu-id="71e43-147">Таким образом, не нужно писать код, который поможет выполнить данные JSON и обновляет DOM.</span><span class="sxs-lookup"><span data-stu-id="71e43-147">That way, you don't have to write any of the code that walks through the JSON data and updates the DOM.</span></span> <span data-ttu-id="71e43-148">Вместо этого вы поместите декларативных атрибутов в код HTML, сообщите Knockout, как для представления данных.</span><span class="sxs-lookup"><span data-stu-id="71e43-148">Instead, you put declarative attributes in the HTML that tell Knockout how to present the data.</span></span>

<span data-ttu-id="71e43-149">Большим преимуществом этой архитектуры является то, что он отделяет слой представления от логики приложения.</span><span class="sxs-lookup"><span data-stu-id="71e43-149">A big advantage of this architecture is that it separates the presentation layer from the application logic.</span></span> <span data-ttu-id="71e43-150">Можно создать часть веб-API, не зная ничего о том, как будет выглядеть веб-страницы.</span><span class="sxs-lookup"><span data-stu-id="71e43-150">You can create the Web API portion without knowing anything about how your web page will look.</span></span> <span data-ttu-id="71e43-151">На стороне клиента, созданной «модель представления» для представления данных и модель представления использует Knockout для привязки к HTML-код.</span><span class="sxs-lookup"><span data-stu-id="71e43-151">On the client side, you create a "view model" to represent that data, and the view model uses Knockout to bind to the HTML.</span></span> <span data-ttu-id="71e43-152">Который позволяет легко изменять HTML-код без изменения модели представления.</span><span class="sxs-lookup"><span data-stu-id="71e43-152">That lets you easily change the HTML without changing the view model.</span></span> <span data-ttu-id="71e43-153">(Мы рассмотрим Knockout чуть позже.)</span><span class="sxs-lookup"><span data-stu-id="71e43-153">(We'll look at Knockout a bit later.)</span></span>

## <a name="models"></a><span data-ttu-id="71e43-154">Модели</span><span class="sxs-lookup"><span data-stu-id="71e43-154">Models</span></span>

<span data-ttu-id="71e43-155">В проекте Visual Studio в папку Models содержит модели, используемые на стороне сервера.</span><span class="sxs-lookup"><span data-stu-id="71e43-155">In the Visual Studio project, the Models folder contains the models that are used on the server side.</span></span> <span data-ttu-id="71e43-156">(На стороне клиента также существуют модели мы коснемся тех.)</span><span class="sxs-lookup"><span data-stu-id="71e43-156">(There are also models on the client side; we'll get to those.)</span></span>

![](knockoutjs-template/_static/image9.png)

<span data-ttu-id="71e43-157">**TodoItem, TodoList**</span><span class="sxs-lookup"><span data-stu-id="71e43-157">**TodoItem, TodoList**</span></span>

<span data-ttu-id="71e43-158">Это базы данных модели Entity Framework Code First.</span><span class="sxs-lookup"><span data-stu-id="71e43-158">These are the database models for Entity Framework Code First.</span></span> <span data-ttu-id="71e43-159">Обратите внимание на то, что эти модели имеют свойства, указывающие на друг с другом.</span><span class="sxs-lookup"><span data-stu-id="71e43-159">Notice that these models have properties that point to each other.</span></span> <span data-ttu-id="71e43-160">`ToDoList` содержит коллекцию элементов ToDoItems, при этом каждая `ToDoItem` ссылающимся обратно к его родительскому элементу ToDoList.</span><span class="sxs-lookup"><span data-stu-id="71e43-160">`ToDoList` contains a collection of ToDoItems, and each `ToDoItem` has a reference back to its parent ToDoList.</span></span> <span data-ttu-id="71e43-161">Эти свойства называются свойствами навигации, и они представляют отношения один ко многим, список задач с элементами списка дел.</span><span class="sxs-lookup"><span data-stu-id="71e43-161">These properties are called navigation properties, and they represent the one-to-many relation a to-do list and its to-do items.</span></span>

<span data-ttu-id="71e43-162">`ToDoItem` Класс также использует **[ForeignKey]** атрибут, чтобы указать, что `ToDoListId` является внешним ключом в `ToDoList` таблицы.</span><span class="sxs-lookup"><span data-stu-id="71e43-162">The `ToDoItem` class also uses the **[ForeignKey]** attribute to specify that `ToDoListId` is a foreign key into the `ToDoList` table.</span></span> <span data-ttu-id="71e43-163">Это сообщает EF, чтобы добавить ограничение внешнего ключа к базе данных.</span><span class="sxs-lookup"><span data-stu-id="71e43-163">This tells EF to add a foreign-key constraint to the database.</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample1.cs)]

<span data-ttu-id="71e43-164">**TodoItemDto TodoListDto**</span><span class="sxs-lookup"><span data-stu-id="71e43-164">**TodoItemDto, TodoListDto**</span></span>

<span data-ttu-id="71e43-165">Эти классы определяют данные, которые будут отправляться клиенту.</span><span class="sxs-lookup"><span data-stu-id="71e43-165">These classes define the data that will be sent to the client.</span></span> <span data-ttu-id="71e43-166">«DTO» означает «объект передачи данных».</span><span class="sxs-lookup"><span data-stu-id="71e43-166">"DTO" stands for "data transfer object."</span></span> <span data-ttu-id="71e43-167">DTO определяет, каким образом сущности будет сериализовано в JSON.</span><span class="sxs-lookup"><span data-stu-id="71e43-167">The DTO defines how the entities will be serialized into JSON.</span></span> <span data-ttu-id="71e43-168">Вообще говоря существует несколько причин для использования DTO:</span><span class="sxs-lookup"><span data-stu-id="71e43-168">In general, there are several reasons to use DTOs:</span></span>

- <span data-ttu-id="71e43-169">Чтобы контролировать, какие свойства сериализуются.</span><span class="sxs-lookup"><span data-stu-id="71e43-169">To control which properties are serialized.</span></span> <span data-ttu-id="71e43-170">Объект передачи данных может содержать подмножество свойств из модели домена.</span><span class="sxs-lookup"><span data-stu-id="71e43-170">The DTO can contain a subset of the properties from the domain model.</span></span> <span data-ttu-id="71e43-171">Это можно сделать по соображениям безопасности (Скрыть конфиденциальные данные) или просто для уменьшения объема данных, отправляемых.</span><span class="sxs-lookup"><span data-stu-id="71e43-171">You might do this for security reasons (to hide sensitive data) or simply to reduce the amount of data that you send.</span></span>
- <span data-ttu-id="71e43-172">Чтобы изменить форму данных — например в плоскую структуру более сложную структуру данных.</span><span class="sxs-lookup"><span data-stu-id="71e43-172">To change the shape of the data – e.g. to flatten a more complex data structure.</span></span>
- <span data-ttu-id="71e43-173">Чтобы сохранить все бизнес-логику из DTO (Разделение областей ответственности).</span><span class="sxs-lookup"><span data-stu-id="71e43-173">To keep any business logic out of the DTO (separation of concerns).</span></span>
- <span data-ttu-id="71e43-174">If your domain models cannot be serialized for some reason.</span><span class="sxs-lookup"><span data-stu-id="71e43-174">If your domain models cannot be serialized for some reason.</span></span> <span data-ttu-id="71e43-175">Например, циклические ссылки может вызвать проблемы при сериализации объекта, существуют способы устранения этой проблемы в веб-API (см. в разделе [обработка циклические ссылки объекта](../../../web-api/overview/formats-and-model-binding/json-and-xml-serialization.md#handling_circular_object_references)); но с использованием DTO просто помогает избежать проблемы полностью.</span><span class="sxs-lookup"><span data-stu-id="71e43-175">For example, circular references can cause problems when you serialize an object There are ways to handle this problem in Web API (see [Handling Circular Object References](../../../web-api/overview/formats-and-model-binding/json-and-xml-serialization.md#handling_circular_object_references)); but using a DTO simply avoids the problem altogether.</span></span>

<span data-ttu-id="71e43-176">В шаблоне SPA DTO содержит те же данные, как модели домена.</span><span class="sxs-lookup"><span data-stu-id="71e43-176">In the SPA template, the DTOs contains the same data as the domain models.</span></span> <span data-ttu-id="71e43-177">Тем не менее они по-прежнему полезны, так как их избежать циклических ссылок из свойства навигации, и они показывают общий шаблон DTO.</span><span class="sxs-lookup"><span data-stu-id="71e43-177">However, they are still useful because they avoid circular references from the navigation properties, and they demonstrate the general DTO pattern.</span></span>

<span data-ttu-id="71e43-178">**AccountModels.cs**</span><span class="sxs-lookup"><span data-stu-id="71e43-178">**AccountModels.cs**</span></span>

<span data-ttu-id="71e43-179">Этот файл содержит модели для членством на сайте.</span><span class="sxs-lookup"><span data-stu-id="71e43-179">This file contains models for site membership.</span></span> <span data-ttu-id="71e43-180">`UserProfile` Класс определяет схему для профилей пользователей в членство DB.</span><span class="sxs-lookup"><span data-stu-id="71e43-180">The `UserProfile` class defines the schema for user profiles in the membership DB.</span></span> <span data-ttu-id="71e43-181">(В этом случае единственные сведения — это идентификатор пользователя и имя пользователя.) Другие классы модели в этом файле используются для создания формы регистрации и входа пользователя.</span><span class="sxs-lookup"><span data-stu-id="71e43-181">(In this case, the only information is the user ID and the user name.) The other model classes in this file are used to create the user registration and login forms.</span></span>

## <a name="entity-framework"></a><span data-ttu-id="71e43-182">Entity Framework</span><span class="sxs-lookup"><span data-stu-id="71e43-182">Entity Framework</span></span>

<span data-ttu-id="71e43-183">Шаблон одностраничного приложения использует EF Code First.</span><span class="sxs-lookup"><span data-stu-id="71e43-183">The SPA template uses EF Code First.</span></span> <span data-ttu-id="71e43-184">В шаблона разработки Code First сначала определяют модели в коде и затем EF использует модель для создания базы данных.</span><span class="sxs-lookup"><span data-stu-id="71e43-184">In Code First development, you define the models first in code, and then EF uses the model to create the database.</span></span> <span data-ttu-id="71e43-185">Можно также использовать EF с существующей базы данных ([Database First](https://msdn.microsoft.com/data/jj206878.aspx)).</span><span class="sxs-lookup"><span data-stu-id="71e43-185">You can also use EF with an existing database ([Database First](https://msdn.microsoft.com/data/jj206878.aspx)).</span></span>

<span data-ttu-id="71e43-186">`TodoItemContext` Класс в папку Models является производным от **DbContext**.</span><span class="sxs-lookup"><span data-stu-id="71e43-186">The `TodoItemContext` class in the Models folder derives from **DbContext**.</span></span> <span data-ttu-id="71e43-187">Этот класс предоставляет между моделями и EF «glue».</span><span class="sxs-lookup"><span data-stu-id="71e43-187">This class provides the "glue" between the models and EF.</span></span> <span data-ttu-id="71e43-188">`TodoItemContext` Содержит `ToDoItem` коллекции и `TodoList` коллекции.</span><span class="sxs-lookup"><span data-stu-id="71e43-188">The `TodoItemContext` holds a `ToDoItem` collection and a `TodoList` collection.</span></span> <span data-ttu-id="71e43-189">Запросить базу данных, просто написать запрос LINQ к этих коллекций.</span><span class="sxs-lookup"><span data-stu-id="71e43-189">To query the database, you simply write a LINQ query against these collections.</span></span> <span data-ttu-id="71e43-190">Например Вот как можно выбрать все списки дел для пользователя «Alice»:</span><span class="sxs-lookup"><span data-stu-id="71e43-190">For example, here is how you can select all of the to-do lists for user "Alice":</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample2.cs)]

<span data-ttu-id="71e43-191">Можно также добавлять новые элементы в коллекцию, обновлять элементы, или удалять элементы из коллекции и сохранения изменений в базу данных.</span><span class="sxs-lookup"><span data-stu-id="71e43-191">You can also add new items to the collection, update items, or delete items from the collection, and persist the changes to the database.</span></span>

## <a name="aspnet-web-api-controllers"></a><span data-ttu-id="71e43-192">Контроллеры веб-API ASP.NET</span><span class="sxs-lookup"><span data-stu-id="71e43-192">ASP.NET Web API Controllers</span></span>

<span data-ttu-id="71e43-193">В веб-API ASP.NET контроллеры — это объекты, которые обрабатывают запросы HTTP.</span><span class="sxs-lookup"><span data-stu-id="71e43-193">In ASP.NET Web API, controllers are objects that handle HTTP requests.</span></span> <span data-ttu-id="71e43-194">Как уже упоминалось, SPA шаблон использует веб-API для операций CRUD в `ToDoList` и `ToDoItem` экземпляров.</span><span class="sxs-lookup"><span data-stu-id="71e43-194">As mentioned, the SPA template uses Web API to enable CRUD operations on `ToDoList` and `ToDoItem` instances.</span></span> <span data-ttu-id="71e43-195">Контроллеры, находятся в папке Controllers решения.</span><span class="sxs-lookup"><span data-stu-id="71e43-195">The controllers are located in the Controllers folder of the solution.</span></span>

![](knockoutjs-template/_static/image10.png)

- <span data-ttu-id="71e43-196">`TodoController`: Обрабатывает HTTP-запросы для элементов списка дел</span><span class="sxs-lookup"><span data-stu-id="71e43-196">`TodoController`: Handles HTTP requests for to-do items</span></span>
- <span data-ttu-id="71e43-197">`TodoListController`: Обрабатывает HTTP-запросов для списков задач.</span><span class="sxs-lookup"><span data-stu-id="71e43-197">`TodoListController`: Handles HTTP requests for to-do lists.</span></span>

<span data-ttu-id="71e43-198">Эти имена являются более важными, так как веб-API соответствует пути URI к имени контроллера.</span><span class="sxs-lookup"><span data-stu-id="71e43-198">These names are significant, because Web API matches the URI path to the controller name.</span></span> <span data-ttu-id="71e43-199">(Чтобы узнать, как веб-API направляет HTTP-запросы к контроллерам, см. в разделе [маршрутизации в ASP.NET Web API](../../../web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api.md).)</span><span class="sxs-lookup"><span data-stu-id="71e43-199">(To learn how Web API routes HTTP requests to controllers, see [Routing in ASP.NET Web API](../../../web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api.md).)</span></span>

<span data-ttu-id="71e43-200">Давайте взглянем на `ToDoListController` класса.</span><span class="sxs-lookup"><span data-stu-id="71e43-200">Let's look at the `ToDoListController` class.</span></span> <span data-ttu-id="71e43-201">Он содержит член данных:</span><span class="sxs-lookup"><span data-stu-id="71e43-201">It contains a single data member:</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample3.cs)]

<span data-ttu-id="71e43-202">`TodoItemContext` Используется для взаимодействия с EF, как описано выше.</span><span class="sxs-lookup"><span data-stu-id="71e43-202">The `TodoItemContext` is used to communicate with EF, as described earlier.</span></span> <span data-ttu-id="71e43-203">Методы контроллера реализовать операции CRUD.</span><span class="sxs-lookup"><span data-stu-id="71e43-203">The methods on the controller implement the CRUD operations.</span></span> <span data-ttu-id="71e43-204">Веб-API сопоставляют запросы HTTP от клиента для методов контроллера, следующим образом:</span><span class="sxs-lookup"><span data-stu-id="71e43-204">Web API maps HTTP requests from the client to controller methods, as follows:</span></span>

| <span data-ttu-id="71e43-205">HTTP-запроса</span><span class="sxs-lookup"><span data-stu-id="71e43-205">HTTP Request</span></span> | <span data-ttu-id="71e43-206">Метод контроллера</span><span class="sxs-lookup"><span data-stu-id="71e43-206">Controller Method</span></span> | <span data-ttu-id="71e43-207">Описание</span><span class="sxs-lookup"><span data-stu-id="71e43-207">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="71e43-208">GET/api/todo</span><span class="sxs-lookup"><span data-stu-id="71e43-208">GET /api/todo</span></span> | `GetTodoLists` | <span data-ttu-id="71e43-209">Получает коллекцию списков задач.</span><span class="sxs-lookup"><span data-stu-id="71e43-209">Gets a collection of to-do lists.</span></span> |
| <span data-ttu-id="71e43-210">GET/API/todo/*идентификатор*</span><span class="sxs-lookup"><span data-stu-id="71e43-210">GET /api/todo/*id*</span></span> | `GetTodoList` | <span data-ttu-id="71e43-211">Получает список дел по Идентификатору</span><span class="sxs-lookup"><span data-stu-id="71e43-211">Gets a to-do list by ID</span></span> |
| <span data-ttu-id="71e43-212">PUT/API/todo/*идентификатор*</span><span class="sxs-lookup"><span data-stu-id="71e43-212">PUT /api/todo/*id*</span></span> | `PutTodoList` | <span data-ttu-id="71e43-213">Обновляет список дел.</span><span class="sxs-lookup"><span data-stu-id="71e43-213">Updates a to-do list.</span></span> |
| <span data-ttu-id="71e43-214">POST/api/todo</span><span class="sxs-lookup"><span data-stu-id="71e43-214">POST /api/todo</span></span> | `PostTodoList` | <span data-ttu-id="71e43-215">Создает новый список дел.</span><span class="sxs-lookup"><span data-stu-id="71e43-215">Creates a new to-do list.</span></span> |
| <span data-ttu-id="71e43-216">DELETE/API/todo/*идентификатор*</span><span class="sxs-lookup"><span data-stu-id="71e43-216">DELETE /api/todo/*id*</span></span> | `DeleteTodoList` | <span data-ttu-id="71e43-217">Удаляет список TODO.</span><span class="sxs-lookup"><span data-stu-id="71e43-217">Deletes a TODO list.</span></span> |

<span data-ttu-id="71e43-218">Обратите внимание, что URI для некоторых операций содержат заполнители для значение идентификатора.</span><span class="sxs-lookup"><span data-stu-id="71e43-218">Notice that the URIs for some operations contain placeholders for the ID value.</span></span> <span data-ttu-id="71e43-219">Например, можно удалить в список с Идентификатором 42, URI не `/api/todo/42`.</span><span class="sxs-lookup"><span data-stu-id="71e43-219">For example, to delete a to-list with an ID of 42, the URI is `/api/todo/42`.</span></span>

<span data-ttu-id="71e43-220">Дополнительные сведения об использовании веб-API для операций CRUD, см. в разделе [Создание веб-API, поддерживает операции CRUD](../../../web-api/overview/older-versions/creating-a-web-api-that-supports-crud-operations.md).</span><span class="sxs-lookup"><span data-stu-id="71e43-220">To learn more about using Web API for CRUD operations, see [Creating a Web API that Supports CRUD Operations](../../../web-api/overview/older-versions/creating-a-web-api-that-supports-crud-operations.md).</span></span> <span data-ttu-id="71e43-221">Код для данного контроллера вполне очевиден.</span><span class="sxs-lookup"><span data-stu-id="71e43-221">The code for this controller is fairly straightforward.</span></span> <span data-ttu-id="71e43-222">Ниже приведены некоторые интересные моменты:</span><span class="sxs-lookup"><span data-stu-id="71e43-222">Here are some interesting points:</span></span>

- <span data-ttu-id="71e43-223">`GetTodoLists` Метод использует запрос LINQ для фильтрации результатов по Идентификатору пользователя, вошедшего в систему.</span><span class="sxs-lookup"><span data-stu-id="71e43-223">The `GetTodoLists` method uses a LINQ query to filter the results by the ID of the logged-in user.</span></span> <span data-ttu-id="71e43-224">Таким образом, пользователь видит только данные, к которой принадлежит ему.</span><span class="sxs-lookup"><span data-stu-id="71e43-224">That way, a user only sees the data that belongs to him or her.</span></span> <span data-ttu-id="71e43-225">Кроме того, обратите внимание, что инструкция Select используется для преобразования `ToDoList` экземпляров в `TodoListDto` экземпляров.</span><span class="sxs-lookup"><span data-stu-id="71e43-225">Also, notice that a Select statement is used to convert the `ToDoList` instances into `TodoListDto` instances.</span></span>
- <span data-ttu-id="71e43-226">Методы PUT и POST Проверьте состояние модели перед изменением базы данных.</span><span class="sxs-lookup"><span data-stu-id="71e43-226">The PUT and POST methods check the model state before modifying the database.</span></span> <span data-ttu-id="71e43-227">Если **ModelState.IsValid** имеет значение false, эти методы возвращают HTTP 400 Неверный запрос.</span><span class="sxs-lookup"><span data-stu-id="71e43-227">If **ModelState.IsValid** is false, these methods return HTTP 400, Bad Request.</span></span> <span data-ttu-id="71e43-228">Дополнительные сведения о проверке модели в веб-API в [проверки модели](../../../web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api.md).</span><span class="sxs-lookup"><span data-stu-id="71e43-228">Read more about model validation in Web API at [Model Validation](../../../web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api.md).</span></span>
- <span data-ttu-id="71e43-229">Класс контроллера дополняется также **[Authorize]** атрибута.</span><span class="sxs-lookup"><span data-stu-id="71e43-229">The controller class is also decorated with the **[Authorize]** attribute.</span></span> <span data-ttu-id="71e43-230">Этот атрибут проверяет, прошел ли HTTP-запроса.</span><span class="sxs-lookup"><span data-stu-id="71e43-230">This attribute checks whether the HTTP request is authenticated.</span></span> <span data-ttu-id="71e43-231">Если запрос не прошел проверку подлинности, клиент получает HTTP 401 не санкционировано.</span><span class="sxs-lookup"><span data-stu-id="71e43-231">If the request is not authenticated, the client receives HTTP 401, Unauthorized.</span></span> <span data-ttu-id="71e43-232">Дополнительные сведения о проверки подлинности в [проверки подлинности и авторизации в веб-API ASP.NET](../../../web-api/overview/security/authentication-and-authorization-in-aspnet-web-api.md).</span><span class="sxs-lookup"><span data-stu-id="71e43-232">Read more about authentication at [Authentication and Authorization in ASP.NET Web API](../../../web-api/overview/security/authentication-and-authorization-in-aspnet-web-api.md).</span></span>

<span data-ttu-id="71e43-233">`TodoController` Класс очень похож на `TodoListController`.</span><span class="sxs-lookup"><span data-stu-id="71e43-233">The `TodoController` class is very similar to `TodoListController`.</span></span> <span data-ttu-id="71e43-234">Главное отличие состоит в том, что он не определяет никакие методы GET, так как клиент получит элементы списка дел, а также каждого списка дел.</span><span class="sxs-lookup"><span data-stu-id="71e43-234">The biggest difference is that it does not define any GET methods, because the client will get the to-do items along with each to-do list.</span></span>

## <a name="mvc-controllers-and-views"></a><span data-ttu-id="71e43-235">Контроллеров и представлений MVC</span><span class="sxs-lookup"><span data-stu-id="71e43-235">MVC Controllers and Views</span></span>

<span data-ttu-id="71e43-236">Контроллеры MVC также расположены в папке Controllers решения.</span><span class="sxs-lookup"><span data-stu-id="71e43-236">The MVC controllers are also located in the Controllers folder of the solution.</span></span> <span data-ttu-id="71e43-237">`HomeController` Отображает основные HTML для приложения.</span><span class="sxs-lookup"><span data-stu-id="71e43-237">`HomeController` renders the main HTML for the application.</span></span> <span data-ttu-id="71e43-238">Для контроллера Home оно определено в Views/Home/Index.cshtml.</span><span class="sxs-lookup"><span data-stu-id="71e43-238">The view for the Home controller is defined in Views/Home/Index.cshtml.</span></span> <span data-ttu-id="71e43-239">Домашняя страница отображает другое содержимое в зависимости от того, вошел ли пользователь:</span><span class="sxs-lookup"><span data-stu-id="71e43-239">The Home view renders different content depending on whether the user is logged in:</span></span>

[!code-cshtml[Main](knockoutjs-template/samples/sample4.cshtml)]

<span data-ttu-id="71e43-240">Когда пользователи находятся в системе, они видят основной пользовательский Интерфейс.</span><span class="sxs-lookup"><span data-stu-id="71e43-240">When users are logged in, they see the main UI.</span></span> <span data-ttu-id="71e43-241">В противном случае они увидят панель входа.</span><span class="sxs-lookup"><span data-stu-id="71e43-241">Otherwise, they see the login panel.</span></span> <span data-ttu-id="71e43-242">Обратите внимание, что этот условный рендеринг происходит на стороне сервера.</span><span class="sxs-lookup"><span data-stu-id="71e43-242">Note that this conditional rendering happens on the server side.</span></span> <span data-ttu-id="71e43-243">Никогда не пытаются скрываться конфиденциального содержимого на стороне клиента&#8212;все, что вы отправляете HTTP-ответа является видимым для человек, который отслеживается необработанными сообщениями HTTP.</span><span class="sxs-lookup"><span data-stu-id="71e43-243">Never try to hide sensitive content on the client side&#8212;anything that you send in an HTTP response is visible to someone who is watching the raw HTTP messages.</span></span>

## <a name="client-side-javascript-and-knockoutjs"></a><span data-ttu-id="71e43-244">JavaScript на стороне клиента и Knockout.js</span><span class="sxs-lookup"><span data-stu-id="71e43-244">Client-Side JavaScript and Knockout.js</span></span>

<span data-ttu-id="71e43-245">Теперь давайте рассмотрим из серверной части приложения на клиент.</span><span class="sxs-lookup"><span data-stu-id="71e43-245">Now let's turn from the server side of the application to the client.</span></span> <span data-ttu-id="71e43-246">В шаблоне SPA используется сочетание jQuery и Knockout.js создать smooth, интерактивный пользовательский Интерфейс.</span><span class="sxs-lookup"><span data-stu-id="71e43-246">The SPA template uses a combination of jQuery and Knockout.js to create a smooth, interactive UI.</span></span> <span data-ttu-id="71e43-247">Knockout.js — это библиотека JavaScript, которая позволяет легко выполнить привязку к данным HTML.</span><span class="sxs-lookup"><span data-stu-id="71e43-247">Knockout.js is a JavaScript library that makes it easy to bind HTML to data.</span></span> <span data-ttu-id="71e43-248">Knockout.js использует шаблон под названием «Model-View-ViewModel».</span><span class="sxs-lookup"><span data-stu-id="71e43-248">Knockout.js uses a pattern called "Model-View-ViewModel."</span></span>

- <span data-ttu-id="71e43-249">Модель представляет данные домена (списки дел и элементы списка дел).</span><span class="sxs-lookup"><span data-stu-id="71e43-249">The model is the domain data (ToDo lists and ToDo items).</span></span>
- <span data-ttu-id="71e43-250">Это представление является HTML-документа.</span><span class="sxs-lookup"><span data-stu-id="71e43-250">The view is the HTML document.</span></span>
- <span data-ttu-id="71e43-251">Модель представления является объект JavaScript, которая содержит данные модели.</span><span class="sxs-lookup"><span data-stu-id="71e43-251">The view-model is a JavaScript object that holds the model data.</span></span> <span data-ttu-id="71e43-252">Модель представления — это абстракция код пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="71e43-252">The view-model is a code abstraction of the UI.</span></span> <span data-ttu-id="71e43-253">Он не имеет сведений о представление HTML.</span><span class="sxs-lookup"><span data-stu-id="71e43-253">It has no knowledge of the HTML representation.</span></span> <span data-ttu-id="71e43-254">Вместо этого он представляет абстрактный функции представления, например «список дел».</span><span class="sxs-lookup"><span data-stu-id="71e43-254">Instead, it represents abstract features of the view, such as "a list of ToDo items".</span></span>

<span data-ttu-id="71e43-255">Представление данных привязан к модели представления.</span><span class="sxs-lookup"><span data-stu-id="71e43-255">The view is data-bound to the view-model.</span></span> <span data-ttu-id="71e43-256">Обновления для модели представления автоматически отражаются в представлении.</span><span class="sxs-lookup"><span data-stu-id="71e43-256">Updates to the view-model are automatically reflected in the view.</span></span> <span data-ttu-id="71e43-257">Привязки работают в другом направлении.</span><span class="sxs-lookup"><span data-stu-id="71e43-257">Bindings work the other direction as well.</span></span> <span data-ttu-id="71e43-258">События в модели DOM (например, нажимает) привязаны к функциям в модели представления, которые активировать вызовы AJAX.</span><span class="sxs-lookup"><span data-stu-id="71e43-258">Events in the DOM (such as clicks) are data-bound to functions on the view model, which trigger AJAX calls.</span></span>

<span data-ttu-id="71e43-259">Шаблон одностраничного приложения JavaScript на стороне клиента организованы по три уровня:</span><span class="sxs-lookup"><span data-stu-id="71e43-259">The SPA template organizes the client-side JavaScript into three layers:</span></span>

- <span data-ttu-id="71e43-260">todo.datacontext.js: Отправляет запросы AJAX.</span><span class="sxs-lookup"><span data-stu-id="71e43-260">todo.datacontext.js: Sends AJAX requests.</span></span>
- <span data-ttu-id="71e43-261">todo.model.js: Определяет моделей.</span><span class="sxs-lookup"><span data-stu-id="71e43-261">todo.model.js: Defines the models.</span></span>
- <span data-ttu-id="71e43-262">todo.viewmodel.js: Определяет модель представления.</span><span class="sxs-lookup"><span data-stu-id="71e43-262">todo.viewmodel.js: Defines the view model.</span></span>

![](knockoutjs-template/_static/image11.png)

<span data-ttu-id="71e43-263">Эти файлы расположены в папке приложения или сценарии решения.</span><span class="sxs-lookup"><span data-stu-id="71e43-263">These script files are located in the Scripts/app folder of the solution.</span></span>

![](knockoutjs-template/_static/image12.png)

<span data-ttu-id="71e43-264">**TODO.DataContext** обрабатывает все вызовы AJAX к контроллерам веб-API.</span><span class="sxs-lookup"><span data-stu-id="71e43-264">**todo.datacontext** handles all AJAX calls to the Web API controllers.</span></span> <span data-ttu-id="71e43-265">(Вызовы AJAX для входа в систему определены в другом месте, ajaxlogin.js.)</span><span class="sxs-lookup"><span data-stu-id="71e43-265">(The AJAX calls for logging in are defined elsewhere, in ajaxlogin.js.)</span></span>

<span data-ttu-id="71e43-266">**TODO.Model.js** определяет модели (браузер) на стороне клиента для списков задач.</span><span class="sxs-lookup"><span data-stu-id="71e43-266">**todo.model.js** defines the client-side (browser) models for the to-do lists.</span></span> <span data-ttu-id="71e43-267">Существует два класса модели: todoItem и todoList.</span><span class="sxs-lookup"><span data-stu-id="71e43-267">There are two model classes: todoItem and todoList.</span></span>

<span data-ttu-id="71e43-268">Многие свойства в классах модели имеют тип «ko.observable».</span><span class="sxs-lookup"><span data-stu-id="71e43-268">Many of the properties in the model classes are of type "ko.observable".</span></span> <span data-ttu-id="71e43-269">Наблюдаемые объекты являются, каким образом Knockout творить чудеса.</span><span class="sxs-lookup"><span data-stu-id="71e43-269">Observables are how Knockout does its magic.</span></span> <span data-ttu-id="71e43-270">Из [Knockout документации](http://knockoutjs.com/documentation/introduction.html): Наблюдаемый объект — «объект JavaScript, можно уведомлять подписчиков об изменениях.»</span><span class="sxs-lookup"><span data-stu-id="71e43-270">From the [Knockout documentation](http://knockoutjs.com/documentation/introduction.html): An observable is a "JavaScript object that can notify subscribers about changes."</span></span> <span data-ttu-id="71e43-271">При изменении значения наблюдаемого, Knockout обновляет HTML-элементов, связанных с этими наблюдаемые объекты.</span><span class="sxs-lookup"><span data-stu-id="71e43-271">When the value of an observable changes, Knockout updates any HTML elements that are bound to those observables.</span></span> <span data-ttu-id="71e43-272">Например todoItem имеет наблюдаемые объекты для свойств title и isDone:</span><span class="sxs-lookup"><span data-stu-id="71e43-272">For example, todoItem has observables for the title and isDone properties:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample5.js)]

<span data-ttu-id="71e43-273">Кроме того, можно также подписаться на наблюдаемый объект в коде.</span><span class="sxs-lookup"><span data-stu-id="71e43-273">You can also subscribe to an observable in code.</span></span> <span data-ttu-id="71e43-274">Например класс todoItem подписывается на изменения в свойствах «isDone» и «title»:</span><span class="sxs-lookup"><span data-stu-id="71e43-274">For example, the todoItem class subscribes to changes in the "isDone" and "title" properties:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample6.js)]

<span data-ttu-id="71e43-275">**Модель представления**</span><span class="sxs-lookup"><span data-stu-id="71e43-275">**View Model**</span></span>

<span data-ttu-id="71e43-276">Модель представления определяется в todo.viewmodel.js.</span><span class="sxs-lookup"><span data-stu-id="71e43-276">The view model is defined in todo.viewmodel.js.</span></span> <span data-ttu-id="71e43-277">Модель представления является центральной точки, где приложение связывает элементы HTML страницы данных домена.</span><span class="sxs-lookup"><span data-stu-id="71e43-277">The view model is the central point where the application binds the HTML page elements to the domain data.</span></span> <span data-ttu-id="71e43-278">В шаблоне SPA модель представления содержит массив наблюдаемый todoLists.</span><span class="sxs-lookup"><span data-stu-id="71e43-278">In the SPA template, the view model contains an observable array of todoLists.</span></span> <span data-ttu-id="71e43-279">Следующий код в модели представления, сообщает Knockout для применения привязки:</span><span class="sxs-lookup"><span data-stu-id="71e43-279">The following code in the view model tells Knockout to apply the bindings:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample7.js)]

## <a name="html-and-data-binding"></a><span data-ttu-id="71e43-280">HTML и привязки данных</span><span class="sxs-lookup"><span data-stu-id="71e43-280">HTML and Data Binding</span></span>

<span data-ttu-id="71e43-281">Основной код HTML для страницы определяется в Views/Home/Index.cshtml.</span><span class="sxs-lookup"><span data-stu-id="71e43-281">The main HTML for the page is defined in Views/Home/Index.cshtml.</span></span> <span data-ttu-id="71e43-282">Так как мы используем привязку данных, код HTML является лишь шаблон для что фактически Получает отображаемое.</span><span class="sxs-lookup"><span data-stu-id="71e43-282">Because we are using data-binding, the HTML is only a template for what actually gets rendered.</span></span> <span data-ttu-id="71e43-283">Использует Knockout *декларативной* привязки.</span><span class="sxs-lookup"><span data-stu-id="71e43-283">Knockout uses *declarative* bindings.</span></span> <span data-ttu-id="71e43-284">Элементы страницы привязку к данным, путем добавления атрибута «data-bind» к элементу.</span><span class="sxs-lookup"><span data-stu-id="71e43-284">You bind page elements to data by adding a "data-bind" attribute to the element.</span></span> <span data-ttu-id="71e43-285">Ниже приведен очень простой пример, взяты из документации по Knockout:</span><span class="sxs-lookup"><span data-stu-id="71e43-285">Here is a very simple example, taken from the Knockout documentation:</span></span>

[!code-html[Main](knockoutjs-template/samples/sample8.html)]

<span data-ttu-id="71e43-286">В этом примере Knockout обновляет содержимое **&lt;span&gt;** со значением, равным `myItems.count()`.</span><span class="sxs-lookup"><span data-stu-id="71e43-286">In this example, Knockout updates the contents of the **&lt;span&gt;** element with the value of `myItems.count()`.</span></span> <span data-ttu-id="71e43-287">Каждый раз, когда это значение изменяется, Knockout обновляет документа.</span><span class="sxs-lookup"><span data-stu-id="71e43-287">Whenever this value changes, Knockout updates the document.</span></span>

<span data-ttu-id="71e43-288">Knockout предоставляет ряд различными типами привязок.</span><span class="sxs-lookup"><span data-stu-id="71e43-288">Knockout provides a number of different binding types.</span></span> <span data-ttu-id="71e43-289">Ниже приведены некоторые из привязок, используемые в шаблоне SPA.</span><span class="sxs-lookup"><span data-stu-id="71e43-289">Here are some of the bindings used in the SPA template:</span></span>

- <span data-ttu-id="71e43-290">**по каждому элементу**: Позволяет выполнять итерации по циклу и применить одну разметку для каждого элемента в списке.</span><span class="sxs-lookup"><span data-stu-id="71e43-290">**foreach**: Lets you iterate through a loop and apply the same markup to each item in the list.</span></span> <span data-ttu-id="71e43-291">Это позволяет отображать списки дел и элементы списка дел.</span><span class="sxs-lookup"><span data-stu-id="71e43-291">This is used to render the to-do lists and to-do items.</span></span> <span data-ttu-id="71e43-292">В рамках **foreach**, привязок, применяются к элементам списка.</span><span class="sxs-lookup"><span data-stu-id="71e43-292">Within the **foreach**, the bindings are applied to the elements of the list.</span></span>
- <span data-ttu-id="71e43-293">**отображается**: Используемая для переключения видимости.</span><span class="sxs-lookup"><span data-stu-id="71e43-293">**visible**: Used to toggle visibility.</span></span> <span data-ttu-id="71e43-294">Скрыть разметки, когда коллекция пуста или отобразить сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="71e43-294">Hide markup when a collection is empty, or make the error message visible.</span></span>
- <span data-ttu-id="71e43-295">**Значение**: Используется для заполнения значения формы.</span><span class="sxs-lookup"><span data-stu-id="71e43-295">**value**: Used to populate form values.</span></span>
- <span data-ttu-id="71e43-296">**Нажмите кнопку**: Привязывает событие щелчка на функцию в модели представления.</span><span class="sxs-lookup"><span data-stu-id="71e43-296">**click**: Binds a click event to a function on the view model.</span></span>

## <a name="anti-csrf-protection"></a><span data-ttu-id="71e43-297">Защита Anti-CSRF</span><span class="sxs-lookup"><span data-stu-id="71e43-297">Anti-CSRF Protection</span></span>

<span data-ttu-id="71e43-298">Подделки межсайтовых запросов (CSRF) — это атака, при которой вредоносный сайт отправляет запрос на уязвимом сайте, где пользователь вошел в.</span><span class="sxs-lookup"><span data-stu-id="71e43-298">Cross-Site Request Forgery (CSRF) is an attack where a malicious site sends a request to a vulnerable site where the user is currently logged in.</span></span> <span data-ttu-id="71e43-299">Для предотвращения атак CSRF, ASP.NET MVC использует *маркеров защиты от подделки*, также называется запрос проверки токенов.</span><span class="sxs-lookup"><span data-stu-id="71e43-299">To help prevent CSRF attacks, ASP.NET MVC uses *anti-forgery tokens*, also called request verification tokens.</span></span> <span data-ttu-id="71e43-300">Идея состоит в том, что сервер переводит случайным образом созданный маркер в веб-страницу.</span><span class="sxs-lookup"><span data-stu-id="71e43-300">The idea is that the server puts a randomly generated token into a web page.</span></span> <span data-ttu-id="71e43-301">Когда клиент отправляет данные на сервер, она должна содержать это значение в сообщении запроса.</span><span class="sxs-lookup"><span data-stu-id="71e43-301">When the client submits data to the server, it must include this value in the request message.</span></span>

<span data-ttu-id="71e43-302">Маркеры защиты от подделки работать, поскольку вредоносной страницы не удается считать маркеры пользователя, из-за политики одного источника.</span><span class="sxs-lookup"><span data-stu-id="71e43-302">Anti-forgery tokens work because the malicious page cannot read the user's tokens, due to same-origin policies.</span></span> <span data-ttu-id="71e43-303">(Политика одного источника не документов, размещенные на двух разных сайтах, доступ к содержимому друг друга).</span><span class="sxs-lookup"><span data-stu-id="71e43-303">(Same-origin policies prevent documents hosted on two different sites from accessing each other's content.)</span></span>

<span data-ttu-id="71e43-304">ASP.NET MVC предоставляет встроенную поддержку для маркеров защиты от подделки через [защиты от подделки](https://msdn.microsoft.com/library/system.web.helpers.antiforgery.aspx) класс и [[ValidateAntiForgeryToken]](https://msdn.microsoft.com/library/system.web.mvc.validateantiforgerytokenattribute.aspx) атрибута.</span><span class="sxs-lookup"><span data-stu-id="71e43-304">ASP.NET MVC provides built-in support for anti-forgery tokens, through the [AntiForgery](https://msdn.microsoft.com/library/system.web.helpers.antiforgery.aspx) class and the [[ValidateAntiForgeryToken]](https://msdn.microsoft.com/library/system.web.mvc.validateantiforgerytokenattribute.aspx) attribute.</span></span> <span data-ttu-id="71e43-305">В настоящее время эта функция не встроена в веб-API.</span><span class="sxs-lookup"><span data-stu-id="71e43-305">Currently, this functionality is not built into Web API.</span></span> <span data-ttu-id="71e43-306">Однако шаблон одностраничного приложения включает пользовательскую реализацию для веб-API.</span><span class="sxs-lookup"><span data-stu-id="71e43-306">However, the SPA template includes a custom implementation for Web API.</span></span> <span data-ttu-id="71e43-307">Этот код определен в `ValidateHttpAntiForgeryTokenAttribute` класс, который находится в папке фильтры решения.</span><span class="sxs-lookup"><span data-stu-id="71e43-307">This code is defined in the `ValidateHttpAntiForgeryTokenAttribute` class, which is located in the Filters folder of the solution.</span></span> <span data-ttu-id="71e43-308">Дополнительные сведения о anti-CSRF, в веб-API, см. в разделе [атак предотвращения межсайтовых подделкой запросов (CSRF)](../../../web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks.md).</span><span class="sxs-lookup"><span data-stu-id="71e43-308">To learn more about anti-CSRF in Web API, see [Preventing Cross-Site Request Forgery (CSRF) Attacks](../../../web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks.md).</span></span>

## <a name="conclusion"></a><span data-ttu-id="71e43-309">Заключение</span><span class="sxs-lookup"><span data-stu-id="71e43-309">Conclusion</span></span>

<span data-ttu-id="71e43-310">Чтобы приступить к работе, быстро написания современные интерактивные веб-приложений предназначен данный шаблон одностраничного приложения.</span><span class="sxs-lookup"><span data-stu-id="71e43-310">The SPA template is designed to get you started quickly writing modern, interactive web applications.</span></span> <span data-ttu-id="71e43-311">Он использует библиотеку Knockout.js возможность отделить представление (HTML-разметка) из данных и приложений логики.</span><span class="sxs-lookup"><span data-stu-id="71e43-311">It uses the Knockout.js library to separate presentation (HTML markup) from the data and application logic.</span></span> <span data-ttu-id="71e43-312">Но Knockout не только библиотеки JavaScript, которые можно использовать для создания SPA.</span><span class="sxs-lookup"><span data-stu-id="71e43-312">But Knockout is not the only JavaScript library you can use to create a SPA.</span></span> <span data-ttu-id="71e43-313">Если вы хотите изучить некоторые другие параметры, взгляните на [созданных сообществом шаблонов одностраничных ПРИЛОЖЕНИЙ](../templates/index.md).</span><span class="sxs-lookup"><span data-stu-id="71e43-313">If you want to explore some other options, take a look at the [community-created SPA templates](../templates/index.md).</span></span>
