---
uid: single-page-application/overview/templates/backbonejs-template
title: Шаблон магистрали | Документация Майкрософт
author: madskristensen
description: Шаблон SPA на магистральном. js
ms.author: riande
ms.date: 04/04/2013
ms.assetid: 00aca413-f067-4108-9bd1-cf21e64a2646
msc.legacyurl: /single-page-application/overview/templates/backbonejs-template
msc.type: authoredcontent
ms.openlocfilehash: 7297db7d5b35a53b40f9d9162960e529a167bd12
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78449778"
---
# <a name="backbone-template"></a>Шаблон Backbone

по [Мэдсом Кристенсеном](https://github.com/madskristensen)

> Шаблон магистрального SPA был написан с помощью Кази Манзур Рашид
> 
> [Скачайте шаблон SPA для магистрали](https://go.microsoft.com/fwlink/?LinkId=293631)

Шаблон SPA. js предназначен для быстрого создания интерактивных веб-приложений на стороне клиента с помощью [магистрали. js.](http://backbonejs.org/)

Шаблон предоставляет первоначальный скелет для разработки приложения магистрали в ASP.NET MVC. В нем предоставляются основные функции входа пользователя, включая регистрацию, вход, сброс пароля и подтверждение пользователя с помощью основных шаблонов электронной почты.

Требования

- [Обновление ASP.NET and Web Tools 2012,2](https://go.microsoft.com/fwlink/?LinkId=282650)

## <a name="create-a-backbone-template-project"></a>Создание проекта магистрального шаблона

Скачайте и установите шаблон, нажав кнопку Загрузить выше. Шаблон упаковывается как файл расширения Visual Studio (VSIX). Возможно, потребуется перезапустить Visual Studio.

В области **шаблоны** выберите **Установленные шаблоны** и разверните узел  **C# визуального** элемента. В **разделе C#визуальный** элемент выберите **веб**. В списке шаблонов проектов выберите **ASP.NET MVC 4 веб-приложение**. Задайте для проекта имя и щелкните **ОК**.

![](backbonejs-template/_static/image1.png)

В мастере **создания проектов** выберите проект "Магистральный JS".

![](backbonejs-template/_static/image2.png)

Нажмите клавиши CTRL + F5, чтобы создать и запустить приложение без отладки, или нажмите клавишу F5 для запуска с отладкой.

![](backbonejs-template/_static/image3.png)

Если щелкнуть "Моя учетная запись", откроется страница входа:

![](backbonejs-template/_static/image4.png)

## <a name="walkthrough-client-code"></a>Пошаговое руководство. клиентский код

Начнем со стороны клиента. Скрипты клиентского приложения находятся в папке ~/Скриптс/аппликатион Приложение пишется в [TypeScript](http://www.typescriptlang.org/) (TS-файлы), которые компилируются в JavaScript (JS-файлы).

**Приложение**

`Application` определяется в Application. TS. Этот объект инициализирует приложение и выступает в качестве корневого пространства имен. Он хранит сведения о конфигурации и состоянии, которые совместно используются в приложении, например о том, вошел ли пользователь в систему.

Метод `application.start` создает модальные представления и присоединяет обработчики событий для событий уровня приложения, таких как вход пользователя в систему. Затем он создает маршрутизатор по умолчанию и проверяет, указан ли URL-адрес на стороне клиента. В противном случае он перенаправляется на URL-адрес по умолчанию (#!/).

**События**

События всегда важны при разработке слабо связанных компонентов. Приложения часто выполняют несколько операций в ответ на действия пользователя. Магистраль предоставляет встроенные события с такими компонентами, как модель, коллекция и представление. Вместо создания взаимных зависимостей между этими компонентами шаблон использует модель "Pub/rean": объект `events`, определенный в Events. TS, выступает в качестве концентратора событий для публикации и подписки на события приложения. Объект `events` является Singleton-классом. В следующем коде показано, как подписываться на событие и затем запускать событие.

[!code-csharp[Main](backbonejs-template/samples/sample1.cs)]

**Маршрутизатор**

В магистраль. js маршрутизатор предоставляет методы для маршрутизации страниц на стороне клиента и их подключения к действиям и событиям. Шаблон определяет один маршрутизатор в Router. TS. Маршрутизатор создает представления активабле и сохраняет состояние при переключении представлений. (Представления активабле описаны в следующем разделе.) Изначально проект имеет два фиктивных представления — Home и About. Он также имеет представление NotFound, которое отображается, если маршрут неизвестен.

**Представления**

Представления определяются в ~/Скриптс/аппликатион/виевс. Существует два вида представлений: активабле представления и модальные диалоговые окна. Активабле представления вызываются маршрутизатором. При отображении представления активабле все остальные представления активабле становятся неактивными. Чтобы создать представление активабле, расширьте представление с помощью объекта `Activable`:

[!code-javascript[Main](backbonejs-template/samples/sample2.js)]

Расширение с помощью `Activable` добавляет в представление два новых метода: `activate` и `deactivate`. Маршрутизатор вызывает эти методы для активации и деактивности представления.

Модальные представления реализуются в виде модальных диалоговых окон [начальной загрузки Twitter](https://twitter.github.com/bootstrap/) . Представления `Membership` и `Profile` являются модальными представлениями. Представления модели могут вызываться любыми событиями приложения. Например, в представлении `Navigation` можно щелкнуть ссылку "Моя учетная запись", чтобы просмотреть представление `Membership` или представление `Profile` в зависимости от того, вошел ли пользователь в систему. `Navigation` присоединяет обработчики событий Click к любым дочерним элементам, имеющим атрибут `data-command`. Ниже приведена разметка HTML:

[!code-html[Main](backbonejs-template/samples/sample3.html)]

Ниже приведен код в области навигации. TS для подключения событий.

[!code-csharp[Main](backbonejs-template/samples/sample4.cs)]

**Модели**

Модели определяются в ~/Скриптс/аппликатион/Моделс. Все модели имеют три основных вещи: атрибуты по умолчанию, правила проверки и конечную точку на стороне сервера. Ниже приведен типичный пример.

[!code-javascript[Main](backbonejs-template/samples/sample5.js)]

**Подключаемые модули**

Папка ~/Скриптс/аппликатион/либ содержит несколько полезных подключаемых модулей jQuery. Файл Form. TS определяет подключаемый модуль для работы с данными формы. Часто требуется сериализовать или десериализовать данные формы и отобразить все ошибки проверки модели. Подключаемый модуль Form. TS содержит такие методы, как `serializeFields`, `deserializeFields`и `showFieldErrors`. В следующем примере показано, как сериализовать форму в модель.

[!code-javascript[Main](backbonejs-template/samples/sample6.js)]

Подключаемый модуль флашбар. TS предоставляет пользователю различные виды отзывов. Методы `$.showSuccessbar`, `$.showErrorbar` и `$.showInfobar`. В фоновом режиме для отображения хорошо анимированных сообщений используются оповещения начальной загрузки Twitter.

Подключаемый модуль Confirm. TS заменяет диалоговое окно подтверждения браузера, хотя API немного отличается:

[!code-javascript[Main](backbonejs-template/samples/sample7.js)]

## <a name="walkthrough-server-code"></a>Пошаговое руководство. серверный код

Теперь давайте взглянем на серверную часть.

**Контроллеры**

В одностраничном приложении сервер играет только небольшую роль в пользовательском интерфейсе. Как правило, сервер подготавливает к просмотру начальную страницу, а затем отправляет и получает данные JSON.

В шаблоне есть два контроллера MVC: `HomeController` отображает начальную страницу, а `SupportsController` используется для подтверждения новых учетных записей пользователей и сброса паролей. Все остальные контроллеры в шаблоне являются веб-API ASP.NET контроллерами, которые отправляют и получают данные JSON. По умолчанию контроллеры используют новый класс `WebSecurity` для выполнения задач, связанных с пользователем. Однако у них также есть необязательные конструкторы, которые позволяют передавать делегаты для этих задач. Это упрощает тестирование и позволяет заменить `WebSecurity`, используя IoC-контейнер. Например:

[!code-csharp[Main](backbonejs-template/samples/sample8.cs)]

## <a name="views"></a>Представления

Представления предназначены для модульных: каждый раздел страницы имеет собственное выделенное представление. В одностраничном приложении обычно включаются представления, у которых нет соответствующего контроллера. Вы можете включить представление, вызвав `@Html.Partial('myView')`, но это очень утомительно. Чтобы упростить этот процесс, шаблон определяет вспомогательный метод, `IncludeClientViews`, который визуализирует все представления в указанной папке:

[!code-cshtml[Main](backbonejs-template/samples/sample9.cshtml)]

Если имя папки не указано, по умолчанию используется имя папки «Клиентвиевс». Если в представлении клиента также используются частичные представления, Присвойте разделяемому представлению имя с символом подчеркивания (например, `_SignUp`). Метод `IncludeClientViews` исключает все представления, имена которых начинаются с символа подчеркивания. Чтобы включить в представление клиента частичное представление, вызовите `Html.ClientView('SignUp')` вместо `Html.Partial('_SignUp')`.

**Отправка электронной почты**

Для отправки электронной почты шаблон использует [почтовый индекс](http://aboutcode.net/postal). Однако почтовый индекс является абстрактным от остальной части кода с помощью интерфейса `IMailer`, поэтому его можно легко заменить другой реализацией. Шаблоны электронной почты находятся в папке Views/emails. Адрес электронной почты отправителя указан в файле Web. config в разделе `sender.email` раздела **appSettings** . Кроме того, при `debug="true"` в файле Web. config приложение не требует подтверждения электронной почты пользователя, чтобы ускорить разработку.

## <a name="github"></a>GitHub

Вы также можете найти шаблон "Магистральный JS" (SPA) на [GitHub](https://github.com/kazimanzurrashid/AspNetMvcBackboneJsSpa).
