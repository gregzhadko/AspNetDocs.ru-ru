---
uid: identity/overview/extensibility/overview-of-custom-storage-providers-for-aspnet-identity
title: Обзор пользовательских поставщиков хранилища для ASP.NET Identity-ASP.NET 4. x
author: Rick-Anderson
description: ASP.NET Identity — это расширяемая система, которая позволяет создать собственный поставщик хранилища и подключить его к приложению без повторной работы приложения...
ms.author: riande
ms.date: 10/13/2014
ms.assetid: 681a9204-462e-4260-9a0b-19f0644d6ad7
ms.custom: seoapril2019
msc.legacyurl: /identity/overview/extensibility/overview-of-custom-storage-providers-for-aspnet-identity
msc.type: authoredcontent
ms.openlocfilehash: 21baedf6285b411f89627df9ca25d47a2a42e387
ms.sourcegitcommit: 88fc80e3f65aebdf61ec9414810ddbc31c543f04
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/22/2020
ms.locfileid: "76519106"
---
# <a name="overview-of-custom-storage-providers-for-aspnet-identity"></a><span data-ttu-id="cfd3a-103">Обзор пользовательских поставщиков хранилищ для ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="cfd3a-103">Overview of Custom Storage Providers for ASP.NET Identity</span></span>

<span data-ttu-id="cfd3a-104">от [Tom фитзмаккен](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="cfd3a-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="cfd3a-105">ASP.NET Identity — это расширяемая система, которая позволяет создать собственный поставщик хранилища и подключить его к приложению без повторной работы приложения.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-105">ASP.NET Identity is an extensible system which enables you to create your own storage provider and plug it into your application without re-working the application.</span></span> <span data-ttu-id="cfd3a-106">В этом разделе описывается создание настраиваемого поставщика хранилища для ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-106">This topic describes how to create a customized storage provider for ASP.NET Identity.</span></span> <span data-ttu-id="cfd3a-107">В нем рассматриваются важные понятия создания собственного поставщика хранилища, но не пошаговое руководство по реализации пользовательского поставщика хранилища.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-107">It covers the important concepts for creating your own storage provider, but it is not step-by-step walkthrough of implementing a custom storage provider.</span></span>
> 
> <span data-ttu-id="cfd3a-108">Пример реализации пользовательского поставщика хранилища см. [в статье реализация пользовательского поставщика хранилища ASP.NET Identity MySQL](implementing-a-custom-mysql-aspnet-identity-storage-provider.md).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-108">For an example of implementing a custom storage provider, see [Implementing a Custom MySQL ASP.NET Identity Storage Provider](implementing-a-custom-mysql-aspnet-identity-storage-provider.md).</span></span>
> 
> <span data-ttu-id="cfd3a-109">Этот раздел был обновлен для ASP.NET Identity 2,0.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-109">This topic was updated for ASP.NET Identity 2.0.</span></span>
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="cfd3a-110">Версии программного обеспечения, используемые в этом руководстве</span><span class="sxs-lookup"><span data-stu-id="cfd3a-110">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="cfd3a-111">Visual Studio 2013 с обновлением 2</span><span class="sxs-lookup"><span data-stu-id="cfd3a-111">Visual Studio 2013 with Update 2</span></span>
> - <span data-ttu-id="cfd3a-112">ASP.NET Identity 2</span><span class="sxs-lookup"><span data-stu-id="cfd3a-112">ASP.NET Identity 2</span></span>

## <a name="introduction"></a><span data-ttu-id="cfd3a-113">Введение</span><span class="sxs-lookup"><span data-stu-id="cfd3a-113">Introduction</span></span>

<span data-ttu-id="cfd3a-114">По умолчанию ASP.NET Identity система хранит сведения о пользователях в базе данных SQL Server и использует Entity Framework Code First для создания базы данных.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-114">By default, the ASP.NET Identity system stores user information in a SQL Server database, and uses Entity Framework Code First to create the database.</span></span> <span data-ttu-id="cfd3a-115">Для многих приложений такой подход хорошо работает.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-115">For many applications, this approach works well.</span></span> <span data-ttu-id="cfd3a-116">Однако вы можете использовать другой тип механизма сохранения, например хранилище таблиц Azure, или же таблицы базы данных с совершенно отличной структурой по сравнению с реализацией по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-116">However, you may prefer to use a different type of persistence mechanism, such as Azure Table Storage, or you may already have database tables with a very different structure than the default implementation.</span></span> <span data-ttu-id="cfd3a-117">В любом случае можно написать настраиваемый поставщик для механизма хранения и подключить его к приложению.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-117">In either case, you can write a customized provider for your storage mechanism and plug that provider into your application.</span></span>

<span data-ttu-id="cfd3a-118">ASP.NET Identity включен по умолчанию во многих шаблонах Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-118">ASP.NET Identity is included by default in many of the Visual Studio 2013 templates.</span></span> <span data-ttu-id="cfd3a-119">Вы можете получить обновления для ASP.NET Identity с помощью [пакета NuGet Microsoft AspNet Identity EntityFramework](http://www.nuget.org/packages/Microsoft.AspNet.Identity.EntityFramework/).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-119">You can get updates to ASP.NET Identity through [Microsoft AspNet Identity EntityFramework NuGet package](http://www.nuget.org/packages/Microsoft.AspNet.Identity.EntityFramework/).</span></span>

<span data-ttu-id="cfd3a-120">Этот раздел включает следующие подразделы:</span><span class="sxs-lookup"><span data-stu-id="cfd3a-120">This topic includes the following sections:</span></span>

- [<span data-ttu-id="cfd3a-121">Общие сведения об архитектуре</span><span class="sxs-lookup"><span data-stu-id="cfd3a-121">Understand the architecture</span></span>](#architecture)
- [<span data-ttu-id="cfd3a-122">Общие сведения о хранимых данных</span><span class="sxs-lookup"><span data-stu-id="cfd3a-122">Understand the data that is stored</span></span>](#data)
- [<span data-ttu-id="cfd3a-123">Создание уровня доступа к данным</span><span class="sxs-lookup"><span data-stu-id="cfd3a-123">Create the data access layer</span></span>](#dal)
- [<span data-ttu-id="cfd3a-124">Настройка класса User</span><span class="sxs-lookup"><span data-stu-id="cfd3a-124">Customize the user class</span></span>](#user)
- [<span data-ttu-id="cfd3a-125">Настройка хранилища пользователей</span><span class="sxs-lookup"><span data-stu-id="cfd3a-125">Customize the user store</span></span>](#userstore)
- [<span data-ttu-id="cfd3a-126">Настройка класса Role</span><span class="sxs-lookup"><span data-stu-id="cfd3a-126">Customize the role class</span></span>](#role)
- [<span data-ttu-id="cfd3a-127">Настройка хранилища ролей</span><span class="sxs-lookup"><span data-stu-id="cfd3a-127">Customize the role store</span></span>](#rolestore)
- [<span data-ttu-id="cfd3a-128">Перенастроить приложение для использования нового поставщика хранилища</span><span class="sxs-lookup"><span data-stu-id="cfd3a-128">Reconfigure application to use new storage provider</span></span>](#reconfigure)
- [<span data-ttu-id="cfd3a-129">Другие реализации пользовательских поставщиков хранилища</span><span class="sxs-lookup"><span data-stu-id="cfd3a-129">Other implementations of custom storage providers</span></span>](#other)

<a id="architecture"></a>
## <a name="understand-the-architecture"></a><span data-ttu-id="cfd3a-130">Общие сведения об архитектуре</span><span class="sxs-lookup"><span data-stu-id="cfd3a-130">Understand the architecture</span></span>

<span data-ttu-id="cfd3a-131">ASP.NET Identity состоит из классов, именуемых диспетчерами и магазинами.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-131">ASP.NET Identity consists of classes called managers and stores.</span></span> <span data-ttu-id="cfd3a-132">Руководители — это высокоуровневые классы, которые разработчик приложений использует для выполнения таких операций, как создание пользователя в системе ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-132">Managers are high-level classes which an application developer uses to perform operations, such as creating a user, in the ASP.NET Identity system.</span></span> <span data-ttu-id="cfd3a-133">Магазины — это классы более низкого уровня, указывающие, как сохраняются сущности, например пользователи и роли.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-133">Stores are lower-level classes that specify how entities, such as users and roles, are persisted.</span></span> <span data-ttu-id="cfd3a-134">Хранилища тесно связаны с механизмом сохранения, но менеджеры отделяются от хранилищ. Это означает, что вы можете заменить механизм сохраняемости, не нарушая работу всего приложения.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-134">Stores are closely coupled with the persistence mechanism, but managers are decoupled from stores which means you can replace the persistence mechanism without disrupting the entire application.</span></span>

<span data-ttu-id="cfd3a-135">На следующей схеме показано, как веб-приложение взаимодействует с менеджерами, и сохраняет взаимодействие с уровнем доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-135">The following diagram shows how your web application interacts with the managers, and stores interact with the data access layer.</span></span>

![](overview-of-custom-storage-providers-for-aspnet-identity/_static/image1.png)

<span data-ttu-id="cfd3a-136">Чтобы создать настраиваемый поставщик хранилища для ASP.NET Identity, необходимо создать источник данных, уровень доступа к данным и классы хранилища, взаимодействующие с этим уровнем доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-136">To create a customized storage provider for ASP.NET Identity, you have to create the data source, the data access layer, and the store classes that interact with this data access layer.</span></span> <span data-ttu-id="cfd3a-137">Вы можете продолжить использовать те же API-интерфейсы диспетчера для выполнения операций с данными на пользователя, но теперь эти данные сохраняются в другой системе хранения.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-137">You can continue using the same manager APIs to perform data operations on the user but now that data is saved to a different storage system.</span></span>

<span data-ttu-id="cfd3a-138">Настраивать классы Manager не требуется, так как при создании нового экземпляра UserManager или RoleManager вы предоставляете тип класса User и передаете экземпляр класса Store в качестве аргумента.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-138">You do not need to customize the manager classes because when creating a new instance of UserManager or RoleManager you provide the type of the user class and pass an instance of the store class as an argument.</span></span> <span data-ttu-id="cfd3a-139">Такой подход позволяет подключать пользовательские классы к существующей структуре.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-139">This approach enables you to plug your customized classes into the existing structure.</span></span> <span data-ttu-id="cfd3a-140">Вы узнаете, как создать экземпляр UserManager и RoleManager с вашими настроенными классами хранилища в разделе [перенастройка приложения для использования нового поставщика хранилища](#reconfigure).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-140">You will see how to instantiate UserManager and RoleManager with your customized store classes in the section [Reconfigure application to use new storage provider](#reconfigure).</span></span>

<a id="data"></a>
## <a name="understand-the-data-that-is-stored"></a><span data-ttu-id="cfd3a-141">Общие сведения о хранимых данных</span><span class="sxs-lookup"><span data-stu-id="cfd3a-141">Understand the data that is stored</span></span>

<span data-ttu-id="cfd3a-142">Для реализации пользовательского поставщика хранилища необходимо понимать типы данных, используемых в ASP.NET Identity, а также определить, какие функции относятся к вашему приложению.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-142">To implement a custom storage provider, you must understand the types of data used with ASP.NET Identity, and decide which features are relevant to your application.</span></span>

| <span data-ttu-id="cfd3a-143">Данные</span><span class="sxs-lookup"><span data-stu-id="cfd3a-143">Data</span></span> | <span data-ttu-id="cfd3a-144">Описание</span><span class="sxs-lookup"><span data-stu-id="cfd3a-144">Description</span></span> |
| --- | --- |
| <span data-ttu-id="cfd3a-145">Пользователи</span><span class="sxs-lookup"><span data-stu-id="cfd3a-145">Users</span></span> | <span data-ttu-id="cfd3a-146">Зарегистрированные пользователи вашего веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-146">Registered users of your web site.</span></span> <span data-ttu-id="cfd3a-147">Включает идентификатор пользователя и имя пользователя.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-147">Includes the user Id and user name.</span></span> <span data-ttu-id="cfd3a-148">Может включать хэшированный пароль, если пользователи входят в систему с учетными данными, специфическими для вашего сайта (вместо использования учетных данных с внешнего сайта, например Facebook), и метки безопасности, указывающей, изменились ли какие-либо изменения в учетных данных пользователя.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-148">Might include a hashed password if users log in with credentials that are specific to your site (rather than using credentials from an external site like Facebook), and security stamp to indicate whether anything has changed in the user credentials.</span></span> <span data-ttu-id="cfd3a-149">Может также включать адрес электронной почты, номер телефона, включение двухфакторной проверки подлинности, текущее число неудачных попыток входа и заблокирована ли учетная запись.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-149">Might also include email address, phone number, whether two factor authentication is enabled, the current number of failed logins, and whether an account has been locked.</span></span> |
| <span data-ttu-id="cfd3a-150">Утверждения пользователей</span><span class="sxs-lookup"><span data-stu-id="cfd3a-150">User Claims</span></span> | <span data-ttu-id="cfd3a-151">Набор инструкций (или утверждений) о пользователе, который представляет удостоверение пользователя.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-151">A set of statements (or claims) about the user that represent the user's identity.</span></span> <span data-ttu-id="cfd3a-152">Можно включить большее выражение удостоверения пользователя, чем можно достичь с помощью ролей.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-152">Can enable greater expression of the user's identity than can be achieved through roles.</span></span> |
| <span data-ttu-id="cfd3a-153">Имена входа пользователей</span><span class="sxs-lookup"><span data-stu-id="cfd3a-153">User Logins</span></span> | <span data-ttu-id="cfd3a-154">Сведения о внешнем поставщике проверки подлинности (например, Facebook), который будет использоваться для входа пользователя.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-154">Information about the external authentication provider (like Facebook) to use when logging in a user.</span></span> |
| <span data-ttu-id="cfd3a-155">Роли</span><span class="sxs-lookup"><span data-stu-id="cfd3a-155">Roles</span></span> | <span data-ttu-id="cfd3a-156">Группы авторизации для сайта.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-156">Authorization groups for your site.</span></span> <span data-ttu-id="cfd3a-157">Содержит идентификатор роли и имя роли (например, "admin" или "Employee").</span><span class="sxs-lookup"><span data-stu-id="cfd3a-157">Includes the role Id and role name (like "Admin" or "Employee").</span></span> |

<a id="dal"></a>
## <a name="create-the-data-access-layer"></a><span data-ttu-id="cfd3a-158">Создание уровня доступа к данным</span><span class="sxs-lookup"><span data-stu-id="cfd3a-158">Create the data access layer</span></span>

<span data-ttu-id="cfd3a-159">В этом разделе предполагается, что вы знакомы с механизмом сохраняемости, который вы собираетесь использовать, и как создавать сущности для этого механизма.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-159">This topic assumes you are familiar with the persistence mechanism that you are going to use and how to create entities for that mechanism.</span></span> <span data-ttu-id="cfd3a-160">В этом разделе не приводятся сведения о создании репозиториев или классов доступа к данным. Вместо этого он предоставляет некоторые рекомендации по архитектуре, которые необходимо принять при работе с ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-160">This topic does not provide details about how to create the repositories or data access classes; instead, it provides some suggestions about the design decisions you need to make when working with ASP.NET Identity.</span></span>

<span data-ttu-id="cfd3a-161">При проектировании репозиториев для настроенного поставщика хранилища у вас есть масса свободы.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-161">You have a lot of freedom when designing the repositories for a customized store provider.</span></span> <span data-ttu-id="cfd3a-162">Для компонентов, которые предполагается использовать в приложении, необходимо создать только репозитории.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-162">You only need to create repositories for features that you intend to use in your application.</span></span> <span data-ttu-id="cfd3a-163">Например, если вы не используете роли в приложении, вам не нужно создавать хранилище для ролей или ролей пользователей.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-163">For example, if you are not using roles in your application, you do not need to create storage for roles or user roles.</span></span> <span data-ttu-id="cfd3a-164">Для вашей технологии и существующей инфраструктуры может потребоваться структура, которая сильно отличается от реализации по умолчанию ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-164">Your technology and existing infrastructure may require a structure that is very different from the default implementation of ASP.NET Identity.</span></span> <span data-ttu-id="cfd3a-165">На уровне доступа к данным вы предоставляете логику для работы со структурой репозиториев.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-165">In your data access layer, you provide the logic to work with the structure of your repositories.</span></span>

<span data-ttu-id="cfd3a-166">Сведения о реализации репозиториев данных в MySQL для ASP.NET Identity 2,0 см. в разделе [мисклидентити. SQL](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/MySQLIdentity.sql).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-166">For a MySQL implementation of data repositories for ASP.NET Identity 2.0, see [MySQLIdentity.sql](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/MySQLIdentity.sql).</span></span>

<span data-ttu-id="cfd3a-167">На уровне доступа к данным вы предоставляете логику для сохранения данных из ASP.NET Identity в источнике данных.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-167">In the data access layer, you provide the logic to save the data from ASP.NET Identity to your data source.</span></span> <span data-ttu-id="cfd3a-168">Уровень доступа к данным для настроенного поставщика хранилища может включать следующие классы для хранения сведений о пользователях и ролях.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-168">The data access layer for your customized storage provider might include the following classes to store user and role information.</span></span>

| <span data-ttu-id="cfd3a-169">Класс</span><span class="sxs-lookup"><span data-stu-id="cfd3a-169">Class</span></span> | <span data-ttu-id="cfd3a-170">Описание</span><span class="sxs-lookup"><span data-stu-id="cfd3a-170">Description</span></span> | <span data-ttu-id="cfd3a-171">Пример</span><span class="sxs-lookup"><span data-stu-id="cfd3a-171">Example</span></span> |
| --- | --- | --- |
| <span data-ttu-id="cfd3a-172">Контекст</span><span class="sxs-lookup"><span data-stu-id="cfd3a-172">Context</span></span> | <span data-ttu-id="cfd3a-173">Инкапсулирует сведения для подключения к механизму сохранения и выполнения запросов.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-173">Encapsulates the information to connect to your persistence mechanism and execute queries.</span></span> <span data-ttu-id="cfd3a-174">Этот класс является центральным для уровня доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-174">This class is central to your data access layer.</span></span> <span data-ttu-id="cfd3a-175">Другим классам данных потребуется экземпляр этого класса для выполнения своих операций.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-175">The other data classes will require an instance of this class to perform their operations.</span></span> <span data-ttu-id="cfd3a-176">Кроме того, вы инициализируйте классы хранилища с помощью экземпляра этого класса.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-176">You will also initialize your store classes with an instance of this class.</span></span> | [<span data-ttu-id="cfd3a-177">мисклдатабасе</span><span class="sxs-lookup"><span data-stu-id="cfd3a-177">MySQLDatabase</span></span>](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/MySQLDatabase.cs) |
| <span data-ttu-id="cfd3a-178">Хранилище пользователя</span><span class="sxs-lookup"><span data-stu-id="cfd3a-178">User Storage</span></span> | <span data-ttu-id="cfd3a-179">Сохраняет и извлекает сведения о пользователе (например, имя пользователя и хэш пароля).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-179">Stores and retrieves user information (such as user name and password hash).</span></span> | [<span data-ttu-id="cfd3a-180">Усертабле (MySQL)</span><span class="sxs-lookup"><span data-stu-id="cfd3a-180">UserTable (MySQL)</span></span>](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/UserTable.cs) |
| <span data-ttu-id="cfd3a-181">Хранилище ролей</span><span class="sxs-lookup"><span data-stu-id="cfd3a-181">Role Storage</span></span> | <span data-ttu-id="cfd3a-182">Сохраняет и извлекает сведения о ролях (например, имя роли).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-182">Stores and retrieves role information (such as the role name).</span></span> | [<span data-ttu-id="cfd3a-183">Ролетабле (MySQL)</span><span class="sxs-lookup"><span data-stu-id="cfd3a-183">RoleTable (MySQL)</span></span>](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/RoleTable.cs) |
| <span data-ttu-id="cfd3a-184">Хранилище Усерклаимс</span><span class="sxs-lookup"><span data-stu-id="cfd3a-184">UserClaims Storage</span></span> | <span data-ttu-id="cfd3a-185">Сохраняет и извлекает сведения о пользовательской заявке (например, тип и значение утверждения).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-185">Stores and retrieves user claim information (such as the claim type and value).</span></span> | [<span data-ttu-id="cfd3a-186">Усерклаимстабле (MySQL)</span><span class="sxs-lookup"><span data-stu-id="cfd3a-186">UserClaimsTable (MySQL)</span></span>](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/UserClaimsTable.cs) |
| <span data-ttu-id="cfd3a-187">Хранилище Усерлогинс</span><span class="sxs-lookup"><span data-stu-id="cfd3a-187">UserLogins Storage</span></span> | <span data-ttu-id="cfd3a-188">Хранит и получает сведения для входа пользователя (например, внешний поставщик проверки подлинности).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-188">Stores and retrieves user login information (such as an external authentication provider).</span></span> | [<span data-ttu-id="cfd3a-189">Усерлогинстабле (MySQL)</span><span class="sxs-lookup"><span data-stu-id="cfd3a-189">UserLoginsTable (MySQL)</span></span>](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/UserLoginsTable.cs) |
| <span data-ttu-id="cfd3a-190">Хранилище UserRole</span><span class="sxs-lookup"><span data-stu-id="cfd3a-190">UserRole Storage</span></span> | <span data-ttu-id="cfd3a-191">Сохраняет и извлекает роли, назначенные пользователю.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-191">Stores and retrieves which roles a user is assigned to.</span></span> | [<span data-ttu-id="cfd3a-192">Усерролетабле (MySQL)</span><span class="sxs-lookup"><span data-stu-id="cfd3a-192">UserRoleTable (MySQL)</span></span>](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/UserRoleTable.cs) |

<span data-ttu-id="cfd3a-193">Опять же, достаточно реализовать классы, которые будут использоваться в приложении.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-193">Again, you only need to implement the classes that you intend to use in your application.</span></span>

<span data-ttu-id="cfd3a-194">В классах доступа к данным вы предоставляете код для выполнения операций с данными в конкретном механизме сохраняемости.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-194">In the data access classes, you provide code to perform data operations for your particular persistence mechanism.</span></span> <span data-ttu-id="cfd3a-195">Например, в реализации MySQL класс Усертабле содержит метод для вставки новой записи в таблицу базы данных Users.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-195">For example, within the MySQL implementation, the UserTable class contains a method to insert a new record into the Users database table.</span></span> <span data-ttu-id="cfd3a-196">Переменная с именем `_database` является экземпляром класса Мисклдатабасе.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-196">The variable named `_database` is an instance of the MySQLDatabase class.</span></span>

[!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample1.cs)]

<span data-ttu-id="cfd3a-197">После создания классов доступа к данным необходимо создать классы хранения, которые вызывают конкретные методы на уровне доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-197">After creating your data access classes, you must create store classes that call the specific methods in the data access layer.</span></span>

<a id="user"></a>
## <a name="customize-the-user-class"></a><span data-ttu-id="cfd3a-198">Настройка класса User</span><span class="sxs-lookup"><span data-stu-id="cfd3a-198">Customize the user class</span></span>

<span data-ttu-id="cfd3a-199">При реализации собственного поставщика хранилища необходимо создать класс пользователя, эквивалентный классу [идентитюсер](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework.identityuser(v=vs.108).aspx) в пространстве имен [Microsoft. ASP. NET. Identity. EntityFramework](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework(v=vs.108).aspx) :</span><span class="sxs-lookup"><span data-stu-id="cfd3a-199">When implementing your own storage provider, you must create a user class which is equivalent to the [IdentityUser](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework.identityuser(v=vs.108).aspx) class in the [Microsoft.ASP.NET.Identity.EntityFramework](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework(v=vs.108).aspx) namespace:</span></span>

<span data-ttu-id="cfd3a-200">На следующей схеме показан класс Идентитюсер, который необходимо создать, и интерфейс для реализации в этом классе.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-200">The following diagram shows the IdentityUser class that you must create and the interface to implement in this class.</span></span>

![](overview-of-custom-storage-providers-for-aspnet-identity/_static/image2.png)

<span data-ttu-id="cfd3a-201">Интерфейс [&gt;IUser&lt;TKey](https://msdn.microsoft.com/library/dn613291(v=vs.108).aspx) определяет свойства, которые UserManager пытается вызвать при выполнении запрошенных операций.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-201">The [IUser&lt;TKey&gt;](https://msdn.microsoft.com/library/dn613291(v=vs.108).aspx) interface defines the properties that the UserManager attempts to call when performing requested operations.</span></span> <span data-ttu-id="cfd3a-202">Интерфейс содержит два свойства: ID и UserName.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-202">The interface contains two properties - Id and UserName.</span></span> <span data-ttu-id="cfd3a-203">Интерфейс [&gt;IUser&lt;TKey](https://msdn.microsoft.com/library/dn613291(v=vs.108).aspx) позволяет указать тип ключа для пользователя с помощью универсального параметра **TKey** .</span><span class="sxs-lookup"><span data-stu-id="cfd3a-203">The [IUser&lt;TKey&gt;](https://msdn.microsoft.com/library/dn613291(v=vs.108).aspx) interface enables you to specify the type of the key for the user through the generic **TKey** parameter.</span></span> <span data-ttu-id="cfd3a-204">Тип свойства ID соответствует значению параметра TKey.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-204">The type of the Id property matches the value of the TKey parameter.</span></span>

<span data-ttu-id="cfd3a-205">Платформа удостоверений также предоставляет интерфейс [IUser](https://msdn.microsoft.com/library/microsoft.aspnet.identity.iuser(v=vs.108).aspx) (без универсального параметра), если требуется использовать строковое значение для ключа.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-205">The Identity framework also provides the [IUser](https://msdn.microsoft.com/library/microsoft.aspnet.identity.iuser(v=vs.108).aspx) interface (without the generic parameter) when you want to use a string value for the key.</span></span>

<span data-ttu-id="cfd3a-206">Класс Идентитюсер реализует IUser и содержит любые дополнительные свойства или конструкторы для пользователей на вашем веб-сайте.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-206">The IdentityUser class implements IUser and contains any additional properties or constructors for users on your web site.</span></span> <span data-ttu-id="cfd3a-207">В следующем примере показан класс Идентитюсер, который использует целое число для ключа.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-207">The following example shows an IdentityUser class that uses an integer for the key.</span></span> <span data-ttu-id="cfd3a-208">Поле идентификатора устанавливается в значение **int** в соответствии со значением универсального параметра.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-208">The Id field is set to **int** to match the value of the generic parameter.</span></span> 

[!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample2.cs)]

 <span data-ttu-id="cfd3a-209">Полную реализацию см. в разделе [идентитюсер (MySQL)](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/IdentityUser.cs).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-209">For a complete implementation, see [IdentityUser (MySQL)](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/IdentityUser.cs).</span></span> 

<a id="userstore"></a>
## <a name="customize-the-user-store"></a><span data-ttu-id="cfd3a-210">Настройка хранилища пользователей</span><span class="sxs-lookup"><span data-stu-id="cfd3a-210">Customize the user store</span></span>

<span data-ttu-id="cfd3a-211">Также создается класс UserStore, предоставляющий методы для всех операций с данными пользователя.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-211">You also create a UserStore class that provides the methods for all data operations on the user.</span></span> <span data-ttu-id="cfd3a-212">Этот класс эквивалентен классу [UserStore&lt;тусер&gt;](https://msdn.microsoft.com/library/dn315446(v=vs.108).aspx) в пространстве имен [Microsoft. ASP. NET. Identity. EntityFramework](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework(v=vs.108).aspx) .</span><span class="sxs-lookup"><span data-stu-id="cfd3a-212">This class is equivalent to the [UserStore&lt;TUser&gt;](https://msdn.microsoft.com/library/dn315446(v=vs.108).aspx) class in the [Microsoft.ASP.NET.Identity.EntityFramework](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework(v=vs.108).aspx) namespace.</span></span> <span data-ttu-id="cfd3a-213">В классе UserStore вы реализуете [IUserStore&lt;Тусер, TKey&gt;](https://msdn.microsoft.com/library/dn613276(v=vs.108).aspx) и любые дополнительные интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-213">In your UserStore class, you implement the [IUserStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613276(v=vs.108).aspx) and any of the optional interfaces.</span></span> <span data-ttu-id="cfd3a-214">Вы можете выбрать, какие дополнительные интерфейсы следует реализовать на основе функциональных возможностей, которые вы хотите предоставить в приложении.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-214">You select which optional interfaces to implement based on the functionality you wish to provide in your application.</span></span>

<span data-ttu-id="cfd3a-215">На следующем рисунке показан класс UserStore, который необходимо создать, и соответствующие интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-215">The following image shows the UserStore class you must create and the relevant interfaces.</span></span>

![](overview-of-custom-storage-providers-for-aspnet-identity/_static/image3.png)

<span data-ttu-id="cfd3a-216">Шаблон проекта по умолчанию в Visual Studio содержит код, который предполагает, что многие из дополнительных интерфейсов были реализованы в хранилище пользователя.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-216">The default project template in Visual Studio contains code that assumes many of the optional interfaces have been implemented in the user store.</span></span> <span data-ttu-id="cfd3a-217">Если вы используете шаблон по умолчанию с настроенным хранилищем пользователей, необходимо либо реализовать дополнительные интерфейсы в хранилище пользователя, либо изменить код шаблона, чтобы он больше не вызывал методы в интерфейсах, которые не были реализованы.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-217">If you are using the default template with a customized user store, you must either implement optional interfaces in your user store or alter the template code to no longer call methods in the interfaces you have not implemented.</span></span>

 <span data-ttu-id="cfd3a-218">В следующем примере показан простой класс хранилища пользователя.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-218">The following example shows a simple user store class.</span></span> <span data-ttu-id="cfd3a-219">Универсальный параметр **Тусер** принимает тип класса пользователя, который обычно является классом идентитюсер, который вы определили.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-219">The **TUser** generic parameter takes the type of your user class which usually is the IdentityUser class you defined.</span></span> <span data-ttu-id="cfd3a-220">Универсальный параметр **TKey** принимает тип ключа пользователя.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-220">The **TKey** generic parameter takes the type of your user key.</span></span> 

[!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample3.cs)]

 <span data-ttu-id="cfd3a-221">В этом примере конструктор, принимающий параметр с именем *Database* типа ексампледатабасе, является лишь иллюстрацией того, как передать в класс доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-221">In this example, the constructor that takes a parameter named *database* of type ExampleDatabase is only an illustration of how to pass in your data access class.</span></span> <span data-ttu-id="cfd3a-222">Например, в реализации MySQL этот конструктор принимает параметр типа Мисклдатабасе.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-222">For example, in the MySQL implementation, this constructor takes a parameter of type MySQLDatabase.</span></span> 

<span data-ttu-id="cfd3a-223">В классе UserStore используются классы доступа к данным, созданные для выполнения операций.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-223">Within your UserStore class, you use the data access classes that you created to perform operations.</span></span> <span data-ttu-id="cfd3a-224">Например, в реализации MySQL класс UserStore имеет метод CreateAsync, который использует экземпляр Усертабле для вставки новой записи.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-224">For example, in the MySQL implementation, the UserStore class has the CreateAsync method which uses an instance of UserTable to insert a new record.</span></span> <span data-ttu-id="cfd3a-225">Метод **INSERT** объекта **усертабле** — это тот же метод, который был показан в предыдущем разделе.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-225">The **Insert** method on the **userTable** object is the same method that was shown in the previous section.</span></span> 

[!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample4.cs)]

### <a name="interfaces-to-implement-when-customizing-user-store"></a><span data-ttu-id="cfd3a-226">Интерфейсы, реализуемые при настройке хранилища пользователей</span><span class="sxs-lookup"><span data-stu-id="cfd3a-226">Interfaces to implement when customizing user store</span></span>

<span data-ttu-id="cfd3a-227">На следующем рисунке показаны дополнительные сведения о функциональных возможностях, определенных в каждом интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-227">The next image shows more details about the functionality defined in each interface.</span></span> <span data-ttu-id="cfd3a-228">Все необязательные интерфейсы наследуют от IUserStore.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-228">All of the optional interfaces inherit from IUserStore.</span></span>

![](overview-of-custom-storage-providers-for-aspnet-identity/_static/image4.png)

- <span data-ttu-id="cfd3a-229">**IUserStore**</span><span class="sxs-lookup"><span data-stu-id="cfd3a-229">**IUserStore**</span></span>  
  <span data-ttu-id="cfd3a-230">Интерфейс [IUserStore&lt;Тусер, TKey&gt;](https://msdn.microsoft.com/library/dn613278(v=vs.108).aspx) является единственным интерфейсом, который необходимо реализовать в хранилище пользователя.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-230">The [IUserStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613278(v=vs.108).aspx) interface is the only interface you must implement in your user store.</span></span> <span data-ttu-id="cfd3a-231">Он определяет методы для создания, обновления, удаления и получения пользователей.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-231">It defines methods for creating, updating, deleting, and retrieving users.</span></span>
- <span data-ttu-id="cfd3a-232">**IUserClaimStore**</span><span class="sxs-lookup"><span data-stu-id="cfd3a-232">**IUserClaimStore**</span></span>  
  <span data-ttu-id="cfd3a-233">Интерфейс [IUserClaimStore&lt;Тусер, TKey&gt;](https://msdn.microsoft.com/library/dn613265(v=vs.108).aspx) определяет методы, которые необходимо реализовать в хранилище пользователя для включения заявок пользователя.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-233">The [IUserClaimStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613265(v=vs.108).aspx) interface defines the methods you must implement in your user store to enable user claims.</span></span> <span data-ttu-id="cfd3a-234">Он содержит методы, а также добавляет, удаляет и извлекает утверждения пользователей.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-234">It contains methods or adding, removing and retrieving user claims.</span></span>
- <span data-ttu-id="cfd3a-235">**иусерлогинсторе**</span><span class="sxs-lookup"><span data-stu-id="cfd3a-235">**IUserLoginStore**</span></span>  
  <span data-ttu-id="cfd3a-236">[Иусерлогинсторе&lt;Тусер, TKey&gt;](https://msdn.microsoft.com/library/dn613272(v=vs.108).aspx) определяет методы, которые необходимо реализовать в хранилище пользователя для включения внешних поставщиков проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-236">The [IUserLoginStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613272(v=vs.108).aspx) defines the methods you must implement in your user store to enable external authentication providers.</span></span> <span data-ttu-id="cfd3a-237">Он содержит методы для добавления, удаления и получения имен входа пользователей, а также метод для получения пользователя на основе сведений об имени входа.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-237">It contains methods for adding, removing and retrieving user logins, and a method for retrieving a user based on the login information.</span></span>
- <span data-ttu-id="cfd3a-238">**IUserRoleStore**</span><span class="sxs-lookup"><span data-stu-id="cfd3a-238">**IUserRoleStore**</span></span>  
  <span data-ttu-id="cfd3a-239">Интерфейс [IUserRoleStore&lt;TKey, тусер&gt;](https://msdn.microsoft.com/library/dn613276(v=vs.108).aspx) определяет методы, которые необходимо реализовать в хранилище пользователя, чтобы сопоставлять пользователя с ролью.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-239">The [IUserRoleStore&lt;TKey, TUser&gt;](https://msdn.microsoft.com/library/dn613276(v=vs.108).aspx) interface defines the methods you must implement in your user store to map a user to a role.</span></span> <span data-ttu-id="cfd3a-240">Он содержит методы для добавления, удаления и получения ролей пользователя, а также метод для проверки того, назначен ли пользователю роль.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-240">It contains methods to add, remove, and retrieve a user's roles, and a method to check if a user is assigned to a role.</span></span>
- <span data-ttu-id="cfd3a-241">**IUserPasswordStore**</span><span class="sxs-lookup"><span data-stu-id="cfd3a-241">**IUserPasswordStore**</span></span>  
  <span data-ttu-id="cfd3a-242">Интерфейс [IUserPasswordStore&lt;Тусер, TKey&gt;](https://msdn.microsoft.com/library/dn613273(v=vs.108).aspx) определяет методы, которые необходимо реализовать в хранилище пользователя для сохранения хэшированных паролей.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-242">The [IUserPasswordStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613273(v=vs.108).aspx) interface defines the methods you must implement in your user store to persist hashed passwords.</span></span> <span data-ttu-id="cfd3a-243">Он содержит методы для получения и установки хэшированного пароля, а также метод, который указывает, установил ли пользователь пароль.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-243">It contains methods for getting and setting the hashed password, and a method that indicates whether the user has set a password.</span></span>
- <span data-ttu-id="cfd3a-244">**иусерсекуритистампсторе**</span><span class="sxs-lookup"><span data-stu-id="cfd3a-244">**IUserSecurityStampStore**</span></span>  
  <span data-ttu-id="cfd3a-245">Интерфейс [&gt;иусерсекуритистампсторе&lt;Тусер, TKey](https://msdn.microsoft.com/library/dn613277(v=vs.108).aspx) определяет методы, которые необходимо реализовать в хранилище пользователя, чтобы использовать метку безопасности для указания, изменились ли сведения об учетной записи пользователя.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-245">The [IUserSecurityStampStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613277(v=vs.108).aspx) interface defines the methods you must implement in your user store to use a security stamp for indicating whether the user's account information has changed.</span></span> <span data-ttu-id="cfd3a-246">Эта метка обновляется, когда пользователь изменяет пароль или добавляет или удаляет имена входа.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-246">This stamp is updated when a user changes the password, or adds or removes logins.</span></span> <span data-ttu-id="cfd3a-247">Он содержит методы для получения и установки метки безопасности.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-247">It contains methods for getting and setting the security stamp.</span></span>
- <span data-ttu-id="cfd3a-248">**IUserTwoFactorStore**</span><span class="sxs-lookup"><span data-stu-id="cfd3a-248">**IUserTwoFactorStore**</span></span>  
  <span data-ttu-id="cfd3a-249">Интерфейс [&gt;IUserTwoFactorStore&lt;Тусер, TKey](https://msdn.microsoft.com/library/dn613279(v=vs.108).aspx) определяет методы, которые необходимо реализовать для реализации двухфакторной проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-249">The [IUserTwoFactorStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613279(v=vs.108).aspx) interface defines the methods you must implement to implement two factor authentication.</span></span> <span data-ttu-id="cfd3a-250">Он содержит методы для получения и настройки проверки подлинности, включенной для пользователя.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-250">It contains methods for getting and setting whether two factor authentication is enabled for a user.</span></span>
- <span data-ttu-id="cfd3a-251">**иусерфоненумберсторе**</span><span class="sxs-lookup"><span data-stu-id="cfd3a-251">**IUserPhoneNumberStore**</span></span>  
  <span data-ttu-id="cfd3a-252">Интерфейс [иусерфоненумберсторе&lt;Тусер, TKey&gt;](https://msdn.microsoft.com/library/dn613275(v=vs.108).aspx) определяет методы, которые необходимо реализовать для хранения телефонных номеров пользователей.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-252">The [IUserPhoneNumberStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613275(v=vs.108).aspx) interface defines the methods you must implement to store user phone numbers.</span></span> <span data-ttu-id="cfd3a-253">Он содержит методы для получения и установки номера телефона, а также сведения о подтверждении номера телефона.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-253">It contains methods for getting and setting the phone number and whether the phone number is confirmed.</span></span>
- <span data-ttu-id="cfd3a-254">**иусеремаилсторе**</span><span class="sxs-lookup"><span data-stu-id="cfd3a-254">**IUserEmailStore**</span></span>  
  <span data-ttu-id="cfd3a-255">Интерфейс [иусеремаилсторе&lt;Тусер, TKey&gt;](https://msdn.microsoft.com/library/dn613143(v=vs.108).aspx) определяет методы, которые необходимо реализовать для хранения адресов электронной почты пользователей.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-255">The [IUserEmailStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613143(v=vs.108).aspx) interface defines the methods you must implement to store user email addresses.</span></span> <span data-ttu-id="cfd3a-256">Он содержит методы для получения и установки адреса электронной почты, а также сведения о том, подтверждено ли сообщение электронной почты.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-256">It contains methods for getting and setting the email address and whether the email is confirmed.</span></span>
- <span data-ttu-id="cfd3a-257">**иусерлоккаутсторе**</span><span class="sxs-lookup"><span data-stu-id="cfd3a-257">**IUserLockoutStore**</span></span>  
  <span data-ttu-id="cfd3a-258">Интерфейс [иусерлоккаутсторе&lt;Тусер, TKey&gt;](https://msdn.microsoft.com/library/dn613271(v=vs.108).aspx) определяет методы, которые необходимо реализовать для хранения сведений о блокировке учетной записи.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-258">The [IUserLockoutStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613271(v=vs.108).aspx) interface defines the methods you must implement to store information about locking an account.</span></span> <span data-ttu-id="cfd3a-259">Он содержит методы для получения текущего количества неудачных попыток доступа, получения и задания возможности блокировки учетной записи, получения и установки даты окончания блокировки, увеличения числа неудачных попыток и сброса количества неудачных попыток.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-259">It contains methods for getting the current number of failed access attempts, getting and setting whether the account can be locked, getting and setting the lock out end date, incrementing the number of failed attempts, and resetting the number of failed attempts.</span></span>
- <span data-ttu-id="cfd3a-260">**IQueryableUserStore**</span><span class="sxs-lookup"><span data-stu-id="cfd3a-260">**IQueryableUserStore**</span></span>  
  <span data-ttu-id="cfd3a-261">Интерфейс [IQueryableUserStore&lt;Тусер, TKey&gt;](https://msdn.microsoft.com/library/dn613267(v=vs.108).aspx) определяет члены, которые необходимо реализовать для предоставления запрашиваемого хранилища пользователя.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-261">The [IQueryableUserStore&lt;TUser, TKey&gt;](https://msdn.microsoft.com/library/dn613267(v=vs.108).aspx) interface defines the members you must implement to provide a queryable user store.</span></span> <span data-ttu-id="cfd3a-262">Он содержит свойство, которое содержит запрашиваемых пользователей.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-262">It contains a property that holds the queryable users.</span></span>

  <span data-ttu-id="cfd3a-263">Вы реализуете интерфейсы, необходимые в приложении; Например, интерфейсы IUserClaimStore, Иусерлогинсторе, IUserRoleStore, IUserPasswordStore и Иусерсекуритистампсторе, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-263">You implement the interfaces that are needed in your application; such as, the IUserClaimStore, IUserLoginStore, IUserRoleStore, IUserPasswordStore, and IUserSecurityStampStore interfaces as shown below.</span></span> 

[!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample5.cs)]

<span data-ttu-id="cfd3a-264">Полную реализацию (включая все интерфейсы) см. в разделе [UserStore (MySQL)](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/UserStore.cs).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-264">For a complete implementation (including all of interfaces), see [UserStore (MySQL)](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/UserStore.cs).</span></span>

### <a name="identityuserclaim-identityuserlogin-and-identityuserrole"></a><span data-ttu-id="cfd3a-265">Идентитюсерклаим, Идентитюсерлогин и Идентитюсерроле</span><span class="sxs-lookup"><span data-stu-id="cfd3a-265">IdentityUserClaim, IdentityUserLogin, and IdentityUserRole</span></span>

<span data-ttu-id="cfd3a-266">Пространство имен Microsoft. AspNet. Identity. EntityFramework содержит реализации классов [идентитюсерклаим](https://msdn.microsoft.com/library/dn613250(v=vs.108).aspx), [идентитюсерлогин](https://msdn.microsoft.com/library/dn613251(v=vs.108).aspx)и [идентитюсерроле](https://msdn.microsoft.com/library/dn613252(v=vs.108).aspx) .</span><span class="sxs-lookup"><span data-stu-id="cfd3a-266">The Microsoft.AspNet.Identity.EntityFramework namespace contains implementations of the [IdentityUserClaim](https://msdn.microsoft.com/library/dn613250(v=vs.108).aspx), [IdentityUserLogin](https://msdn.microsoft.com/library/dn613251(v=vs.108).aspx), and [IdentityUserRole](https://msdn.microsoft.com/library/dn613252(v=vs.108).aspx) classes.</span></span> <span data-ttu-id="cfd3a-267">При использовании этих функций может потребоваться создать собственные версии этих классов и определить свойства приложения.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-267">If you are using these features, you may want to create your own versions of these classes and define the properties for your application.</span></span> <span data-ttu-id="cfd3a-268">Однако иногда эффективнее не загружать эти сущности в память при выполнении основных операций (например, при добавлении или удалении утверждения пользователя).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-268">However, sometimes it is more efficient to not load these entities into memory when performing basic operations (such as adding or removing a user's claim).</span></span> <span data-ttu-id="cfd3a-269">Вместо этого классы хранилища серверной части могут выполнять эти операции непосредственно в источнике данных.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-269">Instead, the backend store classes can execute these operations directly on the data source.</span></span> <span data-ttu-id="cfd3a-270">Например, метод UserStore. Жетклаимсасинк () может вызвать Усерклаимтабле. Финдбюсерид (пользователь. ID) для выполнения запроса к этой таблице напрямую и возврата списка утверждений.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-270">For example, the UserStore.GetClaimsAsync() method can call the userClaimTable.FindByUserId(user.Id) method to execute a query on that table directly and return a list of claims.</span></span>

[!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample6.cs)]

<a id="role"></a>
## <a name="customize-the-role-class"></a><span data-ttu-id="cfd3a-271">Настройка класса Role</span><span class="sxs-lookup"><span data-stu-id="cfd3a-271">Customize the role class</span></span>

<span data-ttu-id="cfd3a-272">При реализации собственного поставщика хранилища необходимо создать класс роли, эквивалентный классу [идентитироле](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework.identityrole(v=vs.108).aspx) в пространстве имен [Microsoft. ASP. NET. Identity. EntityFramework](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework(v=vs.108).aspx) :</span><span class="sxs-lookup"><span data-stu-id="cfd3a-272">When implementing your own storage provider, you must create a role class which is equivalent to the [IdentityRole](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework.identityrole(v=vs.108).aspx) class in the [Microsoft.ASP.NET.Identity.EntityFramework](https://msdn.microsoft.com/library/microsoft.aspnet.identity.entityframework(v=vs.108).aspx) namespace:</span></span>

<span data-ttu-id="cfd3a-273">На следующей схеме показан класс Идентитироле, который необходимо создать, и интерфейс для реализации в этом классе.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-273">The following diagram shows the IdentityRole class that you must create and the interface to implement in this class.</span></span>

![](overview-of-custom-storage-providers-for-aspnet-identity/_static/image5.png)

<span data-ttu-id="cfd3a-274">Интерфейс [&gt;ироле&lt;TKey](https://msdn.microsoft.com/library/dn613268(v=vs.108).aspx) определяет свойства, которые метод roleManager пытается вызвать при выполнении запрошенных операций.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-274">The [IRole&lt;TKey&gt;](https://msdn.microsoft.com/library/dn613268(v=vs.108).aspx) interface defines the properties that the RoleManager attempts to call when performing requested operations.</span></span> <span data-ttu-id="cfd3a-275">Интерфейс содержит два свойства — ID и Name.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-275">The interface contains two properties - Id and Name.</span></span> <span data-ttu-id="cfd3a-276">Интерфейс [&gt;ироле&lt;TKey](https://msdn.microsoft.com/library/dn613268(v=vs.108).aspx) позволяет указать тип ключа для роли с помощью универсального параметра **TKey** .</span><span class="sxs-lookup"><span data-stu-id="cfd3a-276">The [IRole&lt;TKey&gt;](https://msdn.microsoft.com/library/dn613268(v=vs.108).aspx) interface enables you to specify the type of the key for the role through the generic **TKey** parameter.</span></span> <span data-ttu-id="cfd3a-277">Тип свойства ID соответствует значению параметра TKey.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-277">The type of the Id property matches the value of the TKey parameter.</span></span>

<span data-ttu-id="cfd3a-278">Платформа удостоверений также предоставляет интерфейс [ироле](https://msdn.microsoft.com/library/microsoft.aspnet.identity.irole(v=vs.108).aspx) (без универсального параметра), если требуется использовать строковое значение для ключа.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-278">The Identity framework also provides the [IRole](https://msdn.microsoft.com/library/microsoft.aspnet.identity.irole(v=vs.108).aspx) interface (without the generic parameter) when you want to use a string value for the key.</span></span>

<span data-ttu-id="cfd3a-279">В следующем примере показан класс Идентитироле, который использует целое число для ключа.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-279">The following example shows an IdentityRole class that uses an integer for the key.</span></span> <span data-ttu-id="cfd3a-280">Поле идентификатора устанавливается в значение int в соответствии со значением универсального параметра.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-280">The Id field is set to int to match the value of the generic parameter.</span></span> 

[!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample7.cs)]

 <span data-ttu-id="cfd3a-281">Полную реализацию см. в разделе [идентитироле (MySQL)](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/IdentityRole.cs).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-281">For a complete implementation, see [IdentityRole (MySQL)](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/IdentityRole.cs).</span></span> 

<a id="rolestore"></a>
## <a name="customize-the-role-store"></a><span data-ttu-id="cfd3a-282">Настройка хранилища ролей</span><span class="sxs-lookup"><span data-stu-id="cfd3a-282">Customize the role store</span></span>

<span data-ttu-id="cfd3a-283">Также создается класс Ролесторе, предоставляющий методы для всех операций с данными в ролях.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-283">You also create a RoleStore class that provides the methods for all data operations on roles.</span></span> <span data-ttu-id="cfd3a-284">Этот класс эквивалентен классу [ролесторе&lt;троле&gt;](https://msdn.microsoft.com/library/dn468181(v=vs.108).aspx) в пространстве имен Microsoft. ASP. NET. Identity. EntityFramework.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-284">This class is equivalent to the [RoleStore&lt;TRole&gt;](https://msdn.microsoft.com/library/dn468181(v=vs.108).aspx) class in the Microsoft.ASP.NET.Identity.EntityFramework namespace.</span></span> <span data-ttu-id="cfd3a-285">В классе Ролесторе вы реализуете [иролесторе&lt;троле, tkey&gt;](https://msdn.microsoft.com/library/dn613266(v=vs.108).aspx) и, при необходимости, интерфейс [икуеряблеролесторе&lt;троле, TKey&gt;](https://msdn.microsoft.com/library/dn613262(v=vs.108).aspx) .</span><span class="sxs-lookup"><span data-stu-id="cfd3a-285">In your RoleStore class, you implement the [IRoleStore&lt;TRole, TKey&gt;](https://msdn.microsoft.com/library/dn613266(v=vs.108).aspx) and optionally the [IQueryableRoleStore&lt;TRole, TKey&gt;](https://msdn.microsoft.com/library/dn613262(v=vs.108).aspx) interface.</span></span>

![](overview-of-custom-storage-providers-for-aspnet-identity/_static/image6.png)

<span data-ttu-id="cfd3a-286">В следующем примере показан класс хранилища ролей.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-286">The following example shows a role store class.</span></span> <span data-ttu-id="cfd3a-287">Универсальный параметр троле принимает тип класса роли, который обычно является классом Идентитироле, который вы определили.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-287">The TRole generic parameter takes the type of your role class which usually is the IdentityRole class you defined.</span></span> <span data-ttu-id="cfd3a-288">Универсальный параметр TKey принимает тип ключа роли.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-288">The TKey generic parameter takes the type of your role key.</span></span> 

[!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample8.cs)]

- <span data-ttu-id="cfd3a-289">**Иролесторе&lt;троле&gt;**</span><span class="sxs-lookup"><span data-stu-id="cfd3a-289">**IRoleStore&lt;TRole&gt;**</span></span>  
  <span data-ttu-id="cfd3a-290">Интерфейс [иролесторе](https://msdn.microsoft.com/library/dn468195.aspx) определяет методы для реализации в классе хранилища ролей.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-290">The [IRoleStore](https://msdn.microsoft.com/library/dn468195.aspx) interface defines the methods to implement in your role store class.</span></span> <span data-ttu-id="cfd3a-291">Он содержит методы для создания, обновления, удаления и извлечения ролей.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-291">It contains methods for creating, updating, deleting and retrieving roles.</span></span>
- <span data-ttu-id="cfd3a-292">**Ролесторе&lt;троле&gt;**</span><span class="sxs-lookup"><span data-stu-id="cfd3a-292">**RoleStore&lt;TRole&gt;**</span></span>  
  <span data-ttu-id="cfd3a-293">Чтобы настроить Ролесторе, создайте класс, реализующий интерфейс Иролесторе.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-293">To customize RoleStore, create a class that implements the IRoleStore interface.</span></span> <span data-ttu-id="cfd3a-294">Этот класс необходимо реализовать только в том случае, если требуется использовать роли в системе.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-294">You only have to implement this class if want to use roles on your system.</span></span> <span data-ttu-id="cfd3a-295">Конструктор, принимающий параметр с именем *Database* типа ексампледатабасе, является только иллюстрацией того, как передать в класс доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-295">The constructor that takes a parameter named *database* of type ExampleDatabase is only an illustration of how to pass in your data access class.</span></span> <span data-ttu-id="cfd3a-296">Например, в реализации MySQL этот конструктор принимает параметр типа Мисклдатабасе.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-296">For example, in the MySQL implementation, this constructor takes a parameter of type MySQLDatabase.</span></span>  
  
  <span data-ttu-id="cfd3a-297">Полную реализацию см. в разделе [ролесторе (MySQL)](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/RoleStore.cs) .</span><span class="sxs-lookup"><span data-stu-id="cfd3a-297">For a complete implementation, see [RoleStore (MySQL)](https://github.com/aspnet/samples/blob/master/samples/aspnet/Identity/AspNet.Identity.MySQL/RoleStore.cs) .</span></span>

<a id="reconfigure"></a>
## <a name="reconfigure-application-to-use-new-storage-provider"></a><span data-ttu-id="cfd3a-298">Перенастроить приложение для использования нового поставщика хранилища</span><span class="sxs-lookup"><span data-stu-id="cfd3a-298">Reconfigure application to use new storage provider</span></span>

<span data-ttu-id="cfd3a-299">Вы реализовали новый поставщик хранилища.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-299">You have implemented your new storage provider.</span></span> <span data-ttu-id="cfd3a-300">Теперь необходимо настроить приложение для использования этого поставщика хранилища.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-300">Now, you must configure your application to use this storage provider.</span></span> <span data-ttu-id="cfd3a-301">Если поставщик хранилища по умолчанию был добавлен в проект, необходимо удалить поставщика по умолчанию и заменить его своим поставщиком.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-301">If the default storage provider was included in your project, you must remove the default provider and replace it with your provider.</span></span>

### <a name="replace-default-storage-provider-in-mvc-project"></a><span data-ttu-id="cfd3a-302">Замена поставщика хранилища по умолчанию в проекте MVC</span><span class="sxs-lookup"><span data-stu-id="cfd3a-302">Replace default storage provider in MVC project</span></span>

1. <span data-ttu-id="cfd3a-303">В окне **Управление пакетами NuGet** удалите пакет **Microsoft ASP.NET Identity EntityFramework** .</span><span class="sxs-lookup"><span data-stu-id="cfd3a-303">In the **Manage NuGet Packages** window, uninstall the **Microsoft ASP.NET Identity EntityFramework** package.</span></span> <span data-ttu-id="cfd3a-304">Этот пакет можно найти, выполнив поиск в установленных пакетах для Identity. EntityFramework.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-304">You can find this package by searching in the Installed packages for Identity.EntityFramework.</span></span>  
    <span data-ttu-id="cfd3a-305">![](overview-of-custom-storage-providers-for-aspnet-identity/_static/image7.png) вам будет предложено также удалить Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-305">![](overview-of-custom-storage-providers-for-aspnet-identity/_static/image7.png) You will be asked if you also want to uninstall Entity Framework.</span></span> <span data-ttu-id="cfd3a-306">Если он не нужен в других частях приложения, его можно удалить.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-306">If you do not need it in other parts of your application, you can uninstall it.</span></span>
2. <span data-ttu-id="cfd3a-307">В файле IdentityModels.cs в папке Models удалите или закомментируйте классы **аппликатионусер** и **ApplicationDbContext** .</span><span class="sxs-lookup"><span data-stu-id="cfd3a-307">In the IdentityModels.cs file in the Models folder, delete or comment out the **ApplicationUser** and **ApplicationDbContext** classes.</span></span> <span data-ttu-id="cfd3a-308">В приложении MVC можно удалить весь файл IdentityModels.cs.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-308">In an MVC application, you can delete the entire IdentityModels.cs file.</span></span> <span data-ttu-id="cfd3a-309">В приложении веб-форм удалите эти два класса, но убедитесь, что вы сохраняете вспомогательный класс, который также находится в файле IdentityModels.cs.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-309">In a Web Forms application, delete the two classes but make sure you keep the helper class that is also located in the IdentityModels.cs file.</span></span>
3. <span data-ttu-id="cfd3a-310">Если поставщик хранилища находится в отдельном проекте, добавьте в веб-приложение ссылку на него.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-310">If your storage provider resides in a separate project, add a reference to it in your web application.</span></span>
4. <span data-ttu-id="cfd3a-311">Замените все ссылки на `using Microsoft.AspNet.Identity.EntityFramework;` с помощью оператора using для пространства имен поставщика хранилища.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-311">Replace all references to `using Microsoft.AspNet.Identity.EntityFramework;` with a using statement for the namespace of your storage provider.</span></span>
5. <span data-ttu-id="cfd3a-312">В классе **Startup.auth.CS** измените метод **конфигуреаус** , чтобы он использовал единственный экземпляр соответствующего контекста.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-312">In the **Startup.Auth.cs** class, change the **ConfigureAuth** method to use a single instance of the appropriate context.</span></span> 

    [!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample9.cs?highlight=3)]
6. <span data-ttu-id="cfd3a-313">В папке приложения\_Пуск откройте **IdentityConfig.CS**.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-313">In the App\_Start folder, open **IdentityConfig.cs**.</span></span> <span data-ttu-id="cfd3a-314">В классе Аппликатионусерманажер измените метод **CREATE** , чтобы он возвращал Диспетчер пользователей, использующий настроенное хранилище пользователя.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-314">In the ApplicationUserManager class, change the **Create** method to return a user manager that uses your customized user store.</span></span> 

    [!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample10.cs?highlight=3)]
7. <span data-ttu-id="cfd3a-315">Замените все ссылки на **аппликатионусер** на **идентитюсер**.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-315">Replace all references to **ApplicationUser** with **IdentityUser**.</span></span>
8. <span data-ttu-id="cfd3a-316">Проект по умолчанию содержит некоторые члены класса User, которые не определены в интерфейсе IUser. Например, email, PasswordHash и Женератеусеридентитясинк.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-316">The default project includes some members in user class which are not defined in the IUser interface; such as Email, PasswordHash, and GenerateUserIdentityAsync.</span></span> <span data-ttu-id="cfd3a-317">Если у вашего класса пользователя нет этих членов, необходимо либо реализовать их, либо изменить код, использующий эти члены.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-317">If your user class does not have these members, you must either implement them or change the code that uses these members.</span></span>
9. <span data-ttu-id="cfd3a-318">Если вы создали какие бы то ни было экземпляры RoleManager, измените этот код для использования нового класса Ролесторе.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-318">If you have created any instances of RoleManager, change that code to use your new RoleStore class.</span></span>  

    [!code-csharp[Main](overview-of-custom-storage-providers-for-aspnet-identity/samples/sample11.cs)]
10. <span data-ttu-id="cfd3a-319">Проект по умолчанию предназначен для пользовательского класса, имеющего строковое значение для ключа.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-319">The default project is designed for a user class that has a string value for the key.</span></span> <span data-ttu-id="cfd3a-320">Если класс пользователя имеет другой тип ключа (например, целое число), необходимо изменить проект для работы с типом.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-320">If your user class has a different type for the key (such as an integer), you must change the project to work with your type.</span></span> <span data-ttu-id="cfd3a-321">См. раздел [Изменение первичного ключа для пользователей в ASP.NET Identity](change-primary-key-for-users-in-aspnet-identity.md).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-321">See [Change Primary Key for Users in ASP.NET Identity](change-primary-key-for-users-in-aspnet-identity.md).</span></span>
11. <span data-ttu-id="cfd3a-322">При необходимости добавьте строку подключения в файл Web. config.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-322">If needed, add the connection string to the Web.config file.</span></span>

<a id="other"></a>
## <a name="other-resources"></a><span data-ttu-id="cfd3a-323">Другие ресурсы</span><span class="sxs-lookup"><span data-stu-id="cfd3a-323">Other resources</span></span>

- <span data-ttu-id="cfd3a-324">Блог. [реализация ASP.NET Identity](http://odetocode.com/blogs/scott/archive/2014/01/20/implementing-asp-net-identity.aspx)</span><span class="sxs-lookup"><span data-stu-id="cfd3a-324">Blog: [Implementing ASP.NET Identity](http://odetocode.com/blogs/scott/archive/2014/01/20/implementing-asp-net-identity.aspx)</span></span>
- <span data-ttu-id="cfd3a-325">Учебник и код GIT. [простой поставщик удостоверений Data ASP.NET](http://designcoderelease.blogspot.co.uk/2015/03/simpledata-aspnet-identity-provider.html)</span><span class="sxs-lookup"><span data-stu-id="cfd3a-325">Tutorial and GIT code: [Simple.Data Asp.Net Identity Provider](http://designcoderelease.blogspot.co.uk/2015/03/simpledata-aspnet-identity-provider.html)</span></span>
- <span data-ttu-id="cfd3a-326">Учебник.[Настройка базовых учетных записей удостоверений и указание их во внешней базе данных](http://typecastexception.com/post/2013/10/27/Configuring-Db-Connection-and-Code-First-Migration-for-Identity-Accounts-in-ASPNET-MVC-5-and-Visual-Studio-2013.aspx).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-326">Tutorial:[Setting up the basic Identity accounts, and pointing them at an external DB](http://typecastexception.com/post/2013/10/27/Configuring-Db-Connection-and-Code-First-Migration-for-Identity-Accounts-in-ASPNET-MVC-5-and-Visual-Studio-2013.aspx).</span></span> <span data-ttu-id="cfd3a-327">По [@xivSolutions](https://twitter.com/xivSolutions).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-327">By [@xivSolutions](https://twitter.com/xivSolutions).</span></span>
- <span data-ttu-id="cfd3a-328">Учебник[. Реализация пользовательского поставщика хранилища ASP.NET Identity MySQL](implementing-a-custom-mysql-aspnet-identity-storage-provider.md)</span><span class="sxs-lookup"><span data-stu-id="cfd3a-328">Tutorial[: Implementing a Custom MySQL ASP.NET Identity Storage Provider](implementing-a-custom-mysql-aspnet-identity-storage-provider.md)</span></span>
- <span data-ttu-id="cfd3a-329">[Кодефлуент сущности](http://blog.codefluententities.com/2014/04/30/asp-net-identity-v2-and-codefluent-entities/) по [софтфлуент](http://www.softfluent.com/)</span><span class="sxs-lookup"><span data-stu-id="cfd3a-329">[CodeFluent Entities](http://blog.codefluententities.com/2014/04/30/asp-net-identity-v2-and-codefluent-entities/) by [SoftFluent](http://www.softfluent.com/)</span></span>
- <span data-ttu-id="cfd3a-330">[Хранилище таблиц Azure](https://www.nuget.org/packages/accidentalfish.aspnet.identity.azure/) по Джеймс Randall.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-330">[Azure Table Storage](https://www.nuget.org/packages/accidentalfish.aspnet.identity.azure/) by James Randall.</span></span>
- <span data-ttu-id="cfd3a-331">Хранилище таблиц Azure: [AspNet. Identity. TableStorage](https://github.com/stuartleeks/leeksnet.AspNet.Identity.TableStorage) по [@stuartleeks](https://twitter.com/stuartleeks).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-331">Azure Table Storage: [AspNet.Identity.TableStorage](https://github.com/stuartleeks/leeksnet.AspNet.Identity.TableStorage) by [@stuartleeks](https://twitter.com/stuartleeks).</span></span>
- [<span data-ttu-id="cfd3a-332">CouchDB или облако с помощью Даниэль Версеим.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-332">CouchDB / Cloudant by Daniel Wertheim.</span></span>](https://github.com/danielwertheim/mycouch.aspnet.identity)
- <span data-ttu-id="cfd3a-333">Эластичные ИС[h: эластичные удостоверения](https://github.com/bmbsqd/elastic-identity) с помощью бомбскуад AB.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-333">Elastic Searc[h: Elastic Identity](https://github.com/bmbsqd/elastic-identity) by Bombsquad AB.</span></span>
- <span data-ttu-id="cfd3a-334">[MongoDB](http://www.nuget.org/packages/MongoDB.AspNet.Identity/) by Джонатан шили Джонатан шили.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-334">[MongoDB](http://www.nuget.org/packages/MongoDB.AspNet.Identity/) by Jonathan Sheely Jonathan Sheely.</span></span>
- <span data-ttu-id="cfd3a-335">[NHibernate. AspNet. Identity](https://github.com/milesibastos/NHibernate.AspNet.Identity) от Антôнио Милеси Бастос.</span><span class="sxs-lookup"><span data-stu-id="cfd3a-335">[NHibernate.AspNet.Identity](https://github.com/milesibastos/NHibernate.AspNet.Identity) by Antônio Milesi Bastos.</span></span>
- <span data-ttu-id="cfd3a-336">[RavenDB](http://www.nuget.org/packages/AspNet.Identity.RavenDB/1.0.0) по [@tourismgeek](https://twitter.com/tourismgeek).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-336">[RavenDB](http://www.nuget.org/packages/AspNet.Identity.RavenDB/1.0.0) by [@tourismgeek](https://twitter.com/tourismgeek).</span></span>
- <span data-ttu-id="cfd3a-337">[RavenDB. AspNet. Identity](https://github.com/ILMServices/RavenDB.AspNet.Identity) by [илмсервицес](http://www.ilmservice.com/).</span><span class="sxs-lookup"><span data-stu-id="cfd3a-337">[RavenDB.AspNet.Identity](https://github.com/ILMServices/RavenDB.AspNet.Identity) by [ILMServices](http://www.ilmservice.com/).</span></span>
- <span data-ttu-id="cfd3a-338">Redis: [Redis. AspNet. Identity](https://github.com/aminjam/Redis.AspNet.Identity)</span><span class="sxs-lookup"><span data-stu-id="cfd3a-338">Redis: [Redis.AspNet.Identity](https://github.com/aminjam/Redis.AspNet.Identity)</span></span>
- <span data-ttu-id="cfd3a-339">Шаблоны T4 для создания кода EF для хранилища "база данных — первый" пользовательское хранилище: [AspNet. Identity. EntityFramework](https://github.com/cbfrank/AspNet.Identity.EntityFramework)</span><span class="sxs-lookup"><span data-stu-id="cfd3a-339">T4 Templates to generate EF code for a "database first" user store: [AspNet.Identity.EntityFramework](https://github.com/cbfrank/AspNet.Identity.EntityFramework)</span></span>
