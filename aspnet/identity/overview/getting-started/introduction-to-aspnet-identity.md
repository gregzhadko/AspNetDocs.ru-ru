---
uid: identity/overview/getting-started/introduction-to-aspnet-identity
title: Введение в ASP.NET Identity - ASP.NET 4.x
author: jongalloway
description: Система членства ASP.NET впервые появилась в ASP.NET 2.0 обратно в 2005 г., а поскольку затем произошло много изменений в инициированная приложений web способов...
ms.author: riande
ms.date: 01/22/2019
ms.assetid: 38717fc1-5989-43cf-952d-4007cc1dd923
ms.custom: seoapril2019
msc.legacyurl: /identity/overview/getting-started/introduction-to-aspnet-identity
msc.type: authoredcontent
ms.openlocfilehash: 34a0d62d7afcaffa8fbac0bc774d9266efb6b165
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59413052"
---
# <a name="introduction-to-aspnet-identity"></a>Введение в ASP.NET Identity


> Система членства ASP.NET впервые появилась в ASP.NET 2.0 обратно в 2005 г., а поскольку затем произошло много изменений одним из способов проверки подлинности и авторизации веб-приложения обычно обрабатывают. ASP.NET Identity — это Свежий взгляд на то, что система членства должно быть при создании современных приложений для Интернета, телефона или планшета.


## <a name="background-membership-in-aspnet"></a>Справочная информация. Членство в ASP.NET

### <a name="aspnet-membership"></a>Членство в ASP.NET

[Членство ASP.NET](https://msdn.microsoft.com/library/yh26yfzy(v=VS.100).aspx) разработана для решения требований к членству сайта, которые были приняты в 2005, в которой участвует проверки подлинности форм и базы данных SQL Server для имен пользователей, пароли и данные профиля. Сегодняшний день не существует много широкого ряда варианты хранения данных для веб-приложений и хотите разрешить их сайтов использовать Поставщики удостоверений социальных сетей для работы функций проверки подлинности и авторизации большинства разработчиков. Ограничения членства ASP.NET разработки усложнить этот переход:

- Схемы базы данных было разработано для SQL Server и его невозможно изменить. Вы можете добавить данные профиля, но дополнительные данные, упакована в другую таблицу, что затрудняет для доступа к любым способом, за исключением через API-Интерфейс поставщика профиля.
- Поставщик системы позволяет изменить хранилище данных, но система разработано на основе предположения, которые подходят для реляционной базы данных. Можно написать поставщика для хранения сведений о членстве в механизм и нереляционные хранилища, такие как таблицы хранилища Azure, но это не обойти реляционного конструктора, написание кода и масса `System.NotImplementedException` исключения для методов, которые не применить к базам данных NoSQL.
- Так как функциональные возможности log in/log out основан на проверке подлинности форм, система членства нельзя использовать [OWIN](../../../aspnet/overview/owin-and-katana/an-overview-of-project-katana.md). OWIN включает в себя компоненты по промежуточного слоя для проверки подлинности, включая поддержку входа с помощью внешних поставщиков удостоверений (например, учетные записи Майкрософт, Facebook, Google, Twitter) и входа с учетными записями организации из локальной Active Directory или Azure Active Directory. OWIN также включает поддержку OAuth 2.0, JWT и CORS.

### <a name="aspnet-simple-membership"></a>Членство ASP.NET Simple

[Простого членства ASP.NET](../../../web-pages/overview/security/16-adding-security-and-membership.md) была разработана как система членства ASP.NET Web Pages. Он был выпущен вместе с WebMatrix и Visual Studio 2010 с пакетом обновления 1. Цель простого членства — позволяют легко добавить функции членства для приложения веб-страниц.

Простого членства поступивший проще настроить сведения о профиле пользователя, но она по-прежнему имеет другие проблемы с членства ASP.NET и он имеет некоторые ограничения:

- Это было настолько сложно для сохранения данных о членстве системы в нереляционного хранилища.
- Его нельзя использовать с OWIN.
- Он не работает с существующими поставщиками членства ASP.NET, и он не является расширяемым.

### <a name="aspnet-universal-providers"></a>Универсальные поставщики ASP.NET

[Универсальные поставщики ASP.NET](http://www.hanselman.com/blog/IntroducingSystemWebProvidersASPNETUniversalProvidersForSessionMembershipRolesAndUserProfileOnSQLCompactAndSQLAzure.aspx) разработанные, чтобы обеспечить возможность сохранять информацию членства в Microsoft, база данных SQL Azure и они также работать с SQL Server Compact. Универсальные поставщики были построены из Entity Framework Code First, это означает, что универсальные поставщики может использоваться для сохранения данных в любое хранилище, поддерживаемых EF. Универсальные поставщики схему базы данных был очищен также довольно много.

Универсальные поставщики создаются по инфраструктуре членства ASP.NET, поэтому они по-прежнему содержать те же ограничения, что поставщик SqlMembership. То есть они были созданы для реляционных баз данных и это усложняет их настройку профиля и сведения о пользователях. Эти поставщики по-прежнему проверки подлинности в формах для входа в систему и выхода функции.

## <a name="aspnet-identity"></a>ASP.NET Identity

Членства в истории в ASP.NET развивался с годами, группа разработчиков ASP.NET много узнал от отзывов клиентов.

В предположении, что пользователи будут выполнять вход, введя имя пользователя и пароль, который они зарегистрированы в приложении больше не является допустимым. Веб-узла становится более социальных сетей. Пользователи взаимодействуют друг с другом в режиме реального времени с помощью социальных сетей, таких как Facebook, Twitter и других социальных веб-сайтов. Разработчики предпочитают, чтобы пользователи могли выполнить вход с использованием их удостоверений социальных сетей, чтобы они могли можно получить обширные возможности на своих веб-сайтах. Это система членства современных необходимо включить на основе перенаправления входами поставщикам проверки подлинности, таких как Facebook, Twitter и другие.

Как развитие веб-разработки, что привело шаблонов разработки веб-приложений. Модульного тестирования кода приложения стала основной проблемой для разработчиков приложений. В 2008 ASP.NET добавлена новая платформа, на основе шаблона Model-View-Controller (MVC), отчасти для того, чтобы помочь разработчикам создавать модульные тестируемых приложений ASP.NET. Разработчики, желающие модульного тестирования логики своих приложений, также хотели бы иметь возможность сделать это с помощью системы членства.

Учитывая эти изменения в разработке веб-приложений ASP.NET Identity был разработан для следующих целей:

- **Одну систему ASP.NET Identity**

    - ASP.NET Identity можно использовать со всеми платформы ASP.NET, такие как ASP.NET MVC, Web Forms, веб-страниц, веб-API и SignalR.
    - ASP.NET Identity можно использовать при построении Интернета, phone, магазина или гибридных приложений.
- **Простота подключения профиля данных о пользователе**

    - Вы можете контролировать схему пользователя и сведения о профиле. Например вы можете легко включить системой для хранения даты рождения, вводимые пользователем при регистрации учетной записи в приложении.

- **Элемент управления сохраняемости**

    - По умолчанию система ASP.NET Identity хранит все данные пользователя в базе данных. ASP.NET Identity использует Entity Framework Code First для реализации всех механизма сохранения.
    - Так как управлять схемой базы данных, общие задачи, такие как изменение имен таблиц или тип данных первичные ключи процедура аналогична.
    - Легко подключите в хранилища различных механизмов, таких как SharePoint, службу таблиц хранилища Azure, базами данных NoSQL и др., без необходимости создавать `System.NotImplementedExceptions` исключения.
- **Возможности модульного тестирования**

    - ASP.NET Identity делает его веб-приложения более пригодного для тестирования. Можно написать модульные тесты для части приложения, использующие ASP.NET Identity.
- **Поставщик ролей**

    - Нет поставщика ролей, который позволяет ограничить доступ к частям приложения ролей. Можно легко создавать роли, например «Admin» и добавление пользователей к ролям.
- **На основе утверждений**

    - ASP.NET Identity поддерживает аутентификации на основе утверждений, где удостоверение пользователя представляется в виде набора утверждений. Утверждения позволяют разработчикам быть гораздо более выразительной, в описании идентификатора пользователя, чем роли. В то время как членство в роли — это просто логическое значение (элемент или являющихся членами), утверждение может включать подробные сведения об удостоверениях и членстве пользователя.
- **Учетные записи социальных сетей поставщиков**

    - Можно легко добавить социальных сетей журнала модулей, таких как учетная запись Майкрософт, Facebook, Twitter, Google и других в приложение и хранения данных конкретного пользователя в приложении.

- **Интеграция OWIN**

    - Проверка подлинности ASP.NET теперь основана на по промежуточного слоя OWIN, который может использоваться на любом узле на основе OWIN. ASP.NET Identity имеет любую зависимость на System.Web. Он представляет собой полностью соответствует OWIN и может использоваться в любом приложении OWIN размещенных.
    - Удостоверение ASP.NET использует проверку подлинности OWIN для журнала или журнала обслужен пользователей на веб-сайте. Это означает, что вместо использования FormsAuthentication для создания файла cookie, приложение использует OWIN CookieAuthentication для этого.
- **Пакет NuGet**

    - ASP.NET Identity распространяется как пакет NuGet, который устанавливается в шаблонах ASP.NET MVC, веб-форм и веб-API, входящие в состав Visual Studio 2017. Этот пакет NuGet можно загрузить из галереи NuGet.
    - Освобождение ASP.NET Identity в виде NuGet пакета упрощает перебирайте новые функции и исправления ошибок и доставлять их разработчикам гибкое группа разработчиков ASP.NET.

## <a name="get-started-with-aspnet-identity"></a>Начало работы с ASP.NET Identity

ASP.NET Identity используется в шаблонах проектов Visual Studio 2017 для ASP.NET MVC, Web Forms, веб-API и одностраничных ПРИЛОЖЕНИЙ. В этом пошаговом руководстве демонстрируют использование ASP.NET Identity шаблоны проектов для добавления функций для регистрации, входа и выйдите из системы пользователя.

ASP.NET Identity реализуется с помощью следующей процедуры. Цель этой статьи является приведу общий обзор ASP.NET Identity; можно переходить по нему шаг за шагом или просто ознакомиться с подробностями. Более подробные инструкции по созданию приложений с помощью ASP.NET Identity, включая добавление пользователей, роли и сведения о профиле, с помощью нового API см. в разделе "Дальнейшие действия" в конце этой статьи.

1. Создание приложения ASP.NET MVC с отдельным учетным записям. Можно использовать ASP.NET Identity в ASP.NET MVC, Web Forms, веб-API, SignalR и т.д. В этой статье мы начнем с приложением ASP.NET MVC.  
  
    ![](introduction-to-aspnet-identity/_static/image1.png)
2. Созданный проект содержит следующие три пакета для ASP.NET Identity.

    - [`Microsoft.AspNet.Identity.EntityFramework`](http://www.nuget.org/packages/Microsoft.AspNet.Identity.EntityFramework/)  
   Этот пакет имеет Entity Framework реализация ASP.NET Identity, которая сохранит данные ASP.NET Identity и схему для SQL Server.
    - [`Microsoft.AspNet.Identity.Core`](http://www.nuget.org/packages/Microsoft.AspNet.Identity.Core/)  
   Этот пакет содержит базовых интерфейсов для ASP.NET Identity. Этот пакет можно создать реализацию для ASP.NET Identity, что сохраняемости на разных целевых объектов хранилища, такие как хранилище таблиц Azure, NoSQL баз данных и т.д.
    - [`Microsoft.AspNet.Identity.OWIN`](http://www.nuget.org/packages/Microsoft.AspNet.Identity.Owin/)  
   Этот пакет содержит функции, используемое для подключения в OWIN проверки подлинности в ASP.NET Identity в приложениях ASP.NET. Используется при добавлении входа функциональных возможностей в приложении и вызвать в по промежуточного слоя OWIN проверки подлинности файла Cookie для создания файла cookie.
3. Создание пользователя.  
   Запустите приложение и выберите команду **зарегистрировать** ссылку, чтобы создать пользователя. Ниже показана страница Register собирает имя пользователя и пароль.  
  
    ![](introduction-to-aspnet-identity/_static/image2.png)  
  
   Когда пользователь выбирает **зарегистрировать** кнопки `Register` контроллера учетных записей создается пользователь, вызвав API удостоверения ASP.NET, как показано ниже:

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample1.cs?highlight=8-9)]
4. Войти.  
   Если пользователь был успешно создан, он подписан `SignInAsync` метод.  

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample6.cs?highlight=12)]


   `SignInManager.SignInAsync` Метод создает [ClaimsIdentity](https://msdn.microsoft.com/library/system.security.claims.claimsidentity.aspx). Так как ASP.NET Identity и OWIN файл Cookie проверки подлинности на основе утверждений система, платформа требует приложения для создания ClaimsIdentity для пользователя. ClaimsIdentity имеет сведения о все утверждения для пользователя, например пользователь принадлежит к роли.   
 
5. Выйдите из системы.  
   Выберите **выйти** ссылку, чтобы вызвать действие выхода из системы в контроллере account. 

    [!code-csharp[Main](introduction-to-aspnet-identity/samples/sample5.cs?highlight=6)]

   Выделенный выше код демонстрирует OWIN `AuthenticationManager.SignOut` метод. Это аналогично [FormsAuthentication.SignOut](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx) метод, используемый [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) модуля в веб-форм.

## <a name="components-of-aspnet-identity"></a>Компоненты ASP.NET Identity

На следующей схеме показаны компоненты системы ASP.NET Identity (select на [это](introduction-to-aspnet-identity/_static/image3.png) или на диаграмме, чтобы увеличить его). Пакеты зеленым цветом составляющих систему ASP.NET Identity. Все пакеты, зависимости, необходимые для использования системы удостоверений ASP.NET в приложениях ASP.NET.

[![](introduction-to-aspnet-identity/_static/image5.png)](introduction-to-aspnet-identity/_static/image4.png)

Вот краткое описание пакетов NuGet, не упомянутые ранее:

- [Microsoft.Owin.Security.Cookies](http://www.nuget.org/packages/Microsoft.Owin.Security.Cookies/)  
 Промежуточный слой, который позволяет приложению использовать файл cookie на основе проверки подлинности, аналогичную ASP. NET-проверки подлинности форм.
- [EntityFramework](http://www.nuget.org/packages/EntityFramework/)  
 Платформа Entity Framework — технология доступа к данных, рекомендуемые корпорации Майкрософт для реляционных баз данных.

## <a name="migrating-from-membership-to-aspnet-identity"></a>Миграция из членства в ASP.NET Identity

Мы надеемся вскоре предоставить рекомендации по переносу существующих приложений, использующих ASP.NET или простой членства в новую систему ASP.NET Identity.

## <a name="next-steps"></a>Следующие шаги

- [Создать приложение ASP.NET MVC 5 с помощью Facebook и Google OAuth2 и OpenID единого входа](../../../mvc/overview/security/create-an-aspnet-mvc-5-app-with-facebook-and-google-oauth2-and-openid-sign-on.md)  
 В руководстве используется API удостоверения ASP.NET, чтобы добавить сведения о профиле для пользовательской базы данных и как выполнять аутентификацию в Google и Facebook.
- [Создание приложения ASP.NET MVC с проверкой подлинности и база данных SQL и развертывание в службе приложений Azure](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data)  
 Этом руководстве показано, как использовать API удостоверения для добавления пользователей и ролей.
- [https://github.com/rustd/AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample)  
 Образец приложения, показано, как добавлять основные роли и поддержка пользователей и инструкции по выполнению ролей и управление пользователями.
