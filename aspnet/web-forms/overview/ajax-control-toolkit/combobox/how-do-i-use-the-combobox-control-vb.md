---
uid: web-forms/overview/ajax-control-toolkit/combobox/how-do-i-use-the-combobox-control-vb
title: Как использовать comboBox Control? (VB) Документы Майкрософт
author: rick-anderson
description: ComboBox является ASP.NET управления AJAX, который сочетает в себе гибкость TextBox со списком вариантов, из которых пользователи могут выбрать.
ms.author: riande
ms.date: 05/12/2009
ms.assetid: e887e7b2-a6e7-4a28-a134-ba334494badb
msc.legacyurl: /web-forms/overview/ajax-control-toolkit/combobox/how-do-i-use-the-combobox-control-vb
msc.type: authoredcontent
ms.openlocfilehash: 237e3ef864238c11fc1fb49239c3f6fa3f75537d
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2020
ms.locfileid: "81543071"
---
# <a name="how-do-i-use-the-combobox-control-vb"></a>Как использовать comboBox Control? Visual Basic

[корпорацией Майкрософт](https://github.com/microsoft)

> ComboBox является ASP.NET управления AJAX, который сочетает в себе гибкость TextBox со списком вариантов, из которых пользователи могут выбрать.

Цель этого учебника состоит в том, чтобы объяснить AJAX управления Toolkit ComboBox управления. ComboBox работает как комбинация между стандартным ASP.NET управления DropDownList и textBox управления. Вы можете выбрать из уже существующего списка элементов или ввести новый элемент.

ComboBox похож на удлинитель управления AutoComplete, но элементы управления используются в различных сценариях. Автополный расширитель запрашивает веб-службу, чтобы получить соответствующие записи. Контроль ComboBox, напротив, инициализирован с набором элементов. Использование удлинителя AutoComplete имеет смысл при работе с большим набором данных (миллионы автозапчастей) при использовании управления ComboBox имеет смысл при работе с небольшим набором данных (десятки автозапчастей).

## <a name="selecting-from-a-static-list-of-items"></a>Выбор из статического списка элементов

Начнем с простого образца использования управления ComboBox. Представьте, что вы хотите отобразить статический список элементов в списке выпадающих. Тем не менее, вы хотите оставить открытой возможность того, что список не является полным. Вы хотите разрешить пользователю ввести пользовательское значение в список.

Мы создадим новую страницу ASP.NET веб-форм и используем элемент управления ComboBox на странице. Добавьте новую страницу ASP.NET в проект и переключитесь на представление Design.

Если вы хотите использовать элемент управления ComboBox на странице, то вы должны добавить элемент управления ScriptManager на страницу. Перетащите элемент управления ScriptManager из-под вкладки AJAX Extensions на поверхность конструктора. Вы должны добавить элемент управления ScriptManager в верхней части страницы; Вы можете добавить его непосредственно &lt;под&gt; тегом формы сервера.

Затем перетащите элемент управления ComboBox на страницу. Вы можете найти управление ComboBox в Toolbox с другими управления миаком управления AJAX Toolkit и удлинители управления (см. рисунок1).

[![Простая форма для создания бизнес-карты](how-do-i-use-the-combobox-control-vb/_static/image1.jpg)](how-do-i-use-the-combobox-control-vb/_static/image1.png)

**Рисунок 01**: Выбор управления ComboBox из панели инструментов ([Нажмите, чтобы просмотреть полноразмерное изображение](how-do-i-use-the-combobox-control-vb/_static/image2.png))

Мы будем использовать элемент управления ComboBox для отображения статического списка вариантов. Пользователь может выбрать определенный уровень остроты для своей пищи из списка из трех вариантов: Мягкий, Средний и Горячий (см. рисунок 2).

[![Выбор из статического списка элементов](how-do-i-use-the-combobox-control-vb/_static/image2.jpg)](how-do-i-use-the-combobox-control-vb/_static/image3.png)

**Рисунок 02**: Выбор из статического списка элементов[(Нажмите, чтобы просмотреть полноразмерное изображение)](how-do-i-use-the-combobox-control-vb/_static/image4.png)

Есть два способа, которые вы можете добавить эти варианты в управление ComboBox. Во-первых, вы выбираете опцию задачи «Отредитивайте параметры», когда мыжет над управлением в представлении Design view и открывайте редактор элементов (см. рисунок 3).

[![Редактирование элементов ComboBox](how-do-i-use-the-combobox-control-vb/_static/image3.jpg)](how-do-i-use-the-combobox-control-vb/_static/image5.png)

**Рисунок 03**: Редактирование элементов ComboBox[(Нажмите, чтобы просмотреть полноразмерное изображение)](how-do-i-use-the-combobox-control-vb/_static/image6.png)

Второй вариант заключается в добавлении списка элементов между открытием и закрытием &lt;asp:ComboBox&gt; теги в виде источника. Страница в листинге 1 содержит обновленный ComboBox, который имеет список элементов.

**Список 1 - Static.aspx**

[!code-aspx[Main](how-do-i-use-the-combobox-control-vb/samples/sample1.aspx)]

При открытии страницы в листинге 1 можно выбрать один из уже существующих вариантов из ComboBox. Другими словами, ComboBox работает так же, как контроль DropDownList.

Тем не менее, у вас также есть возможность ввести новый выбор (например, Super Spicy), который не входит в существующий список. Так, ComboBox также работает как управление TextBox.

Независимо от того, выбираете ли вы уже существующий элемент или вводите пользовательский элемент, при отправке формы ваш выбор отображается в элементе управления этикеткой. При отправке формы обработчик\_btnSubmit Click выполняет и обновляет метку (см. рисунок 4).

[![Отображение выбранного элемента](how-do-i-use-the-combobox-control-vb/_static/image4.jpg)](how-do-i-use-the-combobox-control-vb/_static/image7.png)

**Рисунок 04**: Отображение выбранного элемента[(Нажмите, чтобы просмотреть полноразмерное изображение)](how-do-i-use-the-combobox-control-vb/_static/image8.png)

ComboBox поддерживает те же свойства, что и элемент управления DropDownList для извлечения выбранного элемента после отправки формы:

- SelectedItem.Text - Отображает значение свойства текста выбранного элемента.
- SelectedItem.Value - Отображает значение свойства ценности выбранного элемента или отображает текст, набранный в ComboBox.
- Выбранная стоимость - То же самое, что и SelectedItem.Value, за исключением того, что это свойство позволяет указать выбранный по умолчанию (первоначальный) элемент.

Если вы введете пользовательский выбор в ComboBox, то пользовательский выбор назначается как Свойствам SelectedItem.Text, так и SelectedItem.Value.

## <a name="selecting-the-list-of-items-from-the-database"></a>Выбор списка элементов из базы данных

Вы можете получить список элементов, которые ComboBox отображает из базы данных. Например, можно привязать ComboBox к управлению SqlDataSource, управлению ObjectDataSource, LinqDataSource или EntityDataSource.

Представьте, что вы хотите отобразить список фильмов в ComboBox. Вы хотите получить список фильмов из таблицы базы данных Movies. Выполните следующие действия.

1. Создать страницу под названием Movies.aspx
2. Добавьте элемент управления ScriptManager на страницу, перетащив вкладку ScriptManager из-под вкладки AJAX Extensions в наборе инструментов на страницу.
3. Добавьте элемент управления ComboBox на страницу, перетащив ComboBox на страницу.
4. В представлении дизайна нависните над мышью над управлением ComboBox и выберите опцию **«Выберите источник данных»** (см. рисунок 5). Запускается мастер конфигурации исходного кода данных.
5. На этапе **«Выбрать источник данных»** выберите новый &lt;вариант исходного кода.&gt;
6. На этапе **«Выбрать тип источника данных»** выберите базу данных.
7. На этапе **«Выберите подключение к данным»** выберите базу данных (например, MoviesDB.mdf).
8. В **строке «Сохранить строку подключения» к шагу файла конфигурации приложения** выберите опцию для сохранения строки соединения.
9. На этапе настройки шага **«Выберите заявление»** выберите таблицу базы данных «Фильмы» и выберите все столбцы.
10. На шаге **тестового запроса** нажмите кнопку «Завершение».
11. Вернувшись в шаг **«Выберите источник данных»,** выберите столбец «Заголовок» для отображения поля и столбец Id для поля данных (см. рисунок).
12. Нажмите кнопку OK, чтобы закрыть мастера.

[![Выбор источника данных](how-do-i-use-the-combobox-control-vb/_static/image5.jpg)](how-do-i-use-the-combobox-control-vb/_static/image9.png)

**Рисунок 05**: Выбор источника данных[(Нажмите, чтобы просмотреть полноразмерное изображение)](how-do-i-use-the-combobox-control-vb/_static/image10.png)

[![Выбор текста данных и областей значений](how-do-i-use-the-combobox-control-vb/_static/image6.jpg)](how-do-i-use-the-combobox-control-vb/_static/image11.png)

**Рисунок 06**: Выбор текста данных и значений[полей (Нажмите, чтобы просмотреть полноразмерное изображение](how-do-i-use-the-combobox-control-vb/_static/image12.png))

После выполнения вышеуказанных шагов ComboBox будет привязан к управлению SqlDataSource, который представляет фильмы из таблицы базы данных Movies. Источник для страницы выглядит как листинг 2 (я очистил форматирование немного).

**Список 2 - Movies.aspx**

[!code-aspx[Main](how-do-i-use-the-combobox-control-vb/samples/sample2.aspx)]

Обратите внимание, что в управлении ComboBox есть свойство DataSourceID, которое указывает на элемент управления SqlDataSource. При открытии страницы в браузере отображается список фильмов из базы данных (см. рисунок 7). Вы можете выбрать фильм из списка или ввести новый фильм, введя фильм в ComboBox.

[![Отображение списка фильмов](how-do-i-use-the-combobox-control-vb/_static/image7.jpg)](how-do-i-use-the-combobox-control-vb/_static/image13.png)

**Рисунок 07**: Отображение списка фильмов[(Нажмите, чтобы просмотреть полноразмерное изображение)](how-do-i-use-the-combobox-control-vb/_static/image14.png)

## <a name="setting-the-dropdownstyle"></a>Настройка DropDownStyle

Вы можете использовать свойство ComboBox DropDownStyle, чтобы изменить поведение ComboBox. Это свойство принимает там возможные значения:

- DropDown - (значение по умолчанию) ComboBox отображает список выпадающих при нажатии на стрелку, и вы можете ввести пользовательское значение.
- Простой - ComboBox отображает список выпадающих автоматически, и вы можете ввести пользовательское значение.
- DropDownList - ComboBox работает так же, как контроль DropDownList.

Различать DropDown и Simple — это когда отображается список элементов. В случае простого, список отображается сразу же при перемещении фокуса на ComboBox. В случае DropDown необходимо нажать на стрелку, чтобы увидеть список элементов.

Значение DropDownList заставляет элемент управления ComboBox работать так же, как стандартный контроль DropDownList. Тем не менее, есть важное различие здесь. Старые версии Internet Explorer отображают элемент управления DropDownList с бесконечным z-индексом, поэтому элемент управления будет отображаться перед любым элементом управления, размещенным перед ним. Поскольку ComboBox отображает &lt;HTML&gt; div тег &lt;вместо&gt; HTML выберите тег, ComboBox правильно уважает z-заказ.

## <a name="setting-the-autocompletemode"></a>Настройка AutoCompleteMode

Вы используете свойство ComboBox AutoCompleteMode, чтобы указать, что происходит, когда кто-то вводит текст в ComboBox. Это свойство принимает следующие возможные значения:

- Нет - (значение по умолчанию) ComboBox не обеспечивает автоматического полного поведения.
- Предложите - ComboBox отображает список и выделяет соответствующий элемент в списке (см. рисунок 8).
- Приложение - ComboBox не отображает список, и он придатков соответствующий пункт из списка на то, что вы набрали (см. Рисунок 9).
- SuggestAppend - ComboBox отображает список и прилагает соответствующий элемент из списка на то, что вы набрали (см. рисунок 10).

[![ComboBox делает предложение](how-do-i-use-the-combobox-control-vb/_static/image8.jpg)](how-do-i-use-the-combobox-control-vb/_static/image15.png)

**Рисунок 08**: ComboBox делает предложение[(Нажмите, чтобы посмотреть полноразмерное изображение](how-do-i-use-the-combobox-control-vb/_static/image16.png))

[![ComboBox прилагает соответствующий текст](how-do-i-use-the-combobox-control-vb/_static/image9.jpg)](how-do-i-use-the-combobox-control-vb/_static/image17.png)

**Рисунок 09**: ComboBox прилагает соответствующий текст[(Нажмите, чтобы посмотреть полноразмерное изображение](how-do-i-use-the-combobox-control-vb/_static/image18.png))

[![ComboBox предлагает и придатков](how-do-i-use-the-combobox-control-vb/_static/image10.jpg)](how-do-i-use-the-combobox-control-vb/_static/image19.png)

**Рисунок 10**: ComboBox предлагает и приложения[(Нажмите, чтобы посмотреть полноразмерное изображение](how-do-i-use-the-combobox-control-vb/_static/image20.png))

## <a name="summary"></a>Сводка

В этом учебнике вы узнали, как использовать элемент управления ComboBox для отображения фиксированного набора элементов. Мы связали управление ComboBox как со статичным набором элементов, так и с таблицей баз данных. Наконец, вы узнали, как изменить поведение ComboBox, установив его DropDownStyle и AutoCompleteMode свойства.

> [!div class="step-by-step"]
> [Назад](how-do-i-use-the-combobox-control-cs.md)
