---
uid: web-forms/overview/ajax-control-toolkit/htmleditor/how-do-i-use-the-html-editor-control-vb
title: Как использовать элемент управления HTML-редактором? (VB) Документы Майкрософт
author: rick-anderson
description: HTMLEditor — это ASP.NET AJAX Control, который позволяет легко создавать и редактировать HTML-контент с помощью кнопок в панели инструментов.
ms.author: riande
ms.date: 05/12/2009
ms.assetid: 32ec9321-7c8c-4b0f-8234-99acb56df6b5
msc.legacyurl: /web-forms/overview/ajax-control-toolkit/htmleditor/how-do-i-use-the-html-editor-control-vb
msc.type: authoredcontent
ms.openlocfilehash: bba42b4b6ff130b209b92c1608bc37f2f574c19c
ms.sourcegitcommit: 022f79dbc1350e0c6ffaa1e7e7c6e850cdabf9af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2020
ms.locfileid: "81542837"
---
# <a name="how-do-i-use-the-html-editor-control-vb"></a><span data-ttu-id="6d26b-104">Как использовать элемент управления HTML-редактором?</span><span class="sxs-lookup"><span data-stu-id="6d26b-104">How do I use the HTML Editor Control?</span></span> <span data-ttu-id="6d26b-105">Visual Basic</span><span class="sxs-lookup"><span data-stu-id="6d26b-105">(VB)</span></span>

<span data-ttu-id="6d26b-106">[корпорацией Майкрософт](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="6d26b-106">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="6d26b-107">HTMLEditor — это ASP.NET AJAX Control, который позволяет легко создавать и редактировать HTML-контент с помощью кнопок в панели инструментов.</span><span class="sxs-lookup"><span data-stu-id="6d26b-107">HTMLEditor is an ASP.NET AJAX Control that allows you to easily create and edit HTML content via buttons in a toolbar.</span></span>

<span data-ttu-id="6d26b-108">Цель этого учебника состоит в том, чтобы предоставить вам обзор управления HTML редактор включены с AJAX управления Toolkit.</span><span class="sxs-lookup"><span data-stu-id="6d26b-108">The goal of this tutorial is to provide you with an overview of the HTML Editor control included with the AJAX Control Toolkit.</span></span> <span data-ttu-id="6d26b-109">Html Editor включает в себя варианты изменения размера шрифта, выбора шрифта, изменения цвета фона, изменения цвета переднего плана, добавления ссылок, добавления изображений, изменения выравнивания текста и выполнения операций разреза, копирования и вставки (см. рисунок 1).</span><span class="sxs-lookup"><span data-stu-id="6d26b-109">The HTML Editor includes options for changing font size, selecting a font, changing background color, modifying the foreground color, adding links, adding images, changing text alignment, and performing cut, copy, and paste operations (see Figure 1).</span></span>

<span data-ttu-id="6d26b-110">[![Редактор HTML](how-do-i-use-the-html-editor-control-vb/_static/image1.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6d26b-110">[![The HTML Editor](how-do-i-use-the-html-editor-control-vb/_static/image1.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image1.png)</span></span>

<span data-ttu-id="6d26b-111">**Рисунок 01**: Html редактор[(Нажмите, чтобы посмотреть полноразмерное изображение](how-do-i-use-the-html-editor-control-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="6d26b-111">**Figure 01**: The HTML Editor([Click to view full-size image](how-do-i-use-the-html-editor-control-vb/_static/image2.png))</span></span>

<span data-ttu-id="6d26b-112">HTML-редактор позволяет вводить содержимое в режиме проектирования или вы можете ввести HTML напрямую.</span><span class="sxs-lookup"><span data-stu-id="6d26b-112">The HTML editor enables you to enter content using a design mode or you can enter HTML directly.</span></span> <span data-ttu-id="6d26b-113">Вам также предоставляется возможность предварительного просмотра HTML-контента (см. рисунок 2).</span><span class="sxs-lookup"><span data-stu-id="6d26b-113">You also are provided with the option to preview your HTML content (see Figure 2).</span></span>

<span data-ttu-id="6d26b-114">[![Кнопки проектирования, HTML и Preview](how-do-i-use-the-html-editor-control-vb/_static/image2.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="6d26b-114">[![Design, HTML, and Preview buttons](how-do-i-use-the-html-editor-control-vb/_static/image2.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image3.png)</span></span>

<span data-ttu-id="6d26b-115">**Рисунок 02**: Дизайн, HTML, и Предварительный просмотр кнопок[(Нажмите, чтобы посмотреть полноразмерное изображение](how-do-i-use-the-html-editor-control-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="6d26b-115">**Figure 02**: Design, HTML, and Preview buttons([Click to view full-size image](how-do-i-use-the-html-editor-control-vb/_static/image4.png))</span></span>

<span data-ttu-id="6d26b-116">В этом уроке вы узнаете, как отобразить HTML-редактор, как настроить кнопки панели инструментов, которые появляются в редакторе HTML, и как избежать перекрестных атак на сценарии.</span><span class="sxs-lookup"><span data-stu-id="6d26b-116">In this tutorial, you learn how to display the HTML Editor, how to customize the toolbar buttons that appear in the HTML Editor, and how to avoid Cross-Site Scripting Attacks.</span></span>

## <a name="displaying-the-html-editor"></a><span data-ttu-id="6d26b-117">Отображение HTML-редактора</span><span class="sxs-lookup"><span data-stu-id="6d26b-117">Displaying the HTML Editor</span></span>

<span data-ttu-id="6d26b-118">Прежде чем использовать HTML-редактор на странице ASP.NET, необходимо сначала добавить элемент управления ScriptManager на страницу.</span><span class="sxs-lookup"><span data-stu-id="6d26b-118">Before you can use the HTML Editor in an ASP.NET page, you must first add a ScriptManager control to the page.</span></span> <span data-ttu-id="6d26b-119">Контроль ScriptManager расположен под вкладкой AJAX Extensions в наборе инструментов Visual Studio/Visual Web Developer Express.</span><span class="sxs-lookup"><span data-stu-id="6d26b-119">The ScriptManager control is located beneath the AJAX Extensions tab in the Visual Studio/Visual Web Developer Express toolbox.</span></span>

<span data-ttu-id="6d26b-120">Вы должны поместить элемент управления ScriptManager в верхней части страницы, прежде чем любые другие элементы управления на странице.</span><span class="sxs-lookup"><span data-stu-id="6d26b-120">You should place the ScriptManager control at the top of the page before any other controls on the page.</span></span> <span data-ttu-id="6d26b-121">Например, его можно разместить непосредственно под &lt;тегом формы&gt; сервера.</span><span class="sxs-lookup"><span data-stu-id="6d26b-121">For example, you can place it immediately below the opening server-side &lt;form&gt; tag.</span></span>

<span data-ttu-id="6d26b-122">Управление HTML-редактором находится в наборе инструментов с остальными элементами управления AJAX.</span><span class="sxs-lookup"><span data-stu-id="6d26b-122">The HTML Editor control is located in the toolbox with the rest of the AJAX Control Toolkit controls.</span></span> <span data-ttu-id="6d26b-123">Он называется управление редактором (см. рисунок 3).</span><span class="sxs-lookup"><span data-stu-id="6d26b-123">It is named the Editor control (see Figure 3).</span></span>

<span data-ttu-id="6d26b-124">[![Управление редактором HTML](how-do-i-use-the-html-editor-control-vb/_static/image3.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="6d26b-124">[![The HTML Editor control](how-do-i-use-the-html-editor-control-vb/_static/image3.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image5.png)</span></span>

<span data-ttu-id="6d26b-125">**Рисунок 03**: Управление редактором HTML[(Нажмите, чтобы просмотреть полноразмерное изображение)](how-do-i-use-the-html-editor-control-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="6d26b-125">**Figure 03**: The HTML Editor control([Click to view full-size image](how-do-i-use-the-html-editor-control-vb/_static/image6.png))</span></span>

<span data-ttu-id="6d26b-126">После перетаскивания HTML-редактора на страницу можно установить его свойства в листе свойств.</span><span class="sxs-lookup"><span data-stu-id="6d26b-126">After you drag the HTML Editor onto a page, you can set its properties in the property sheet.</span></span> <span data-ttu-id="6d26b-127">Например, обычно требуется установить свойства ширины и высоты.</span><span class="sxs-lookup"><span data-stu-id="6d26b-127">For example, you normally want to set the Width and Height properties.</span></span> <span data-ttu-id="6d26b-128">Список 1 содержит источник для страницы ASP.NET, содержащей HTML-редактор.</span><span class="sxs-lookup"><span data-stu-id="6d26b-128">Listing 1 contains the source for an ASP.NET page that contains an HTML editor.</span></span>

<span data-ttu-id="6d26b-129">**Список 1 - SimpleEditor.aspx**</span><span class="sxs-lookup"><span data-stu-id="6d26b-129">**Listing 1 - SimpleEditor.aspx**</span></span>

[!code-aspx[Main](how-do-i-use-the-html-editor-control-vb/samples/sample1.aspx)]

<span data-ttu-id="6d26b-130">Страница в листинге 1 содержит управление HTML-редактором, управление кнопкой и буквальное управление.</span><span class="sxs-lookup"><span data-stu-id="6d26b-130">The page in Listing 1 contains an HTML Editor control, a Button control, and a Literal control.</span></span> <span data-ttu-id="6d26b-131">При нажатии кнопки содержимое HTML-редактора отображается в буквальном элементе управления (см. рисунок 4).</span><span class="sxs-lookup"><span data-stu-id="6d26b-131">When you click the button, the contents of the HTML Editor appear in the Literal control (see Figure 4).</span></span>

<span data-ttu-id="6d26b-132">[![Отправка формы с помощью HTML-редактора](how-do-i-use-the-html-editor-control-vb/_static/image4.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="6d26b-132">[![Submitting a form with an HTML Editor](how-do-i-use-the-html-editor-control-vb/_static/image4.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image7.png)</span></span>

<span data-ttu-id="6d26b-133">**Рисунок 04**: Отправка формы с HTML Редактор[(Нажмите, чтобы посмотреть полноразмерное изображение](how-do-i-use-the-html-editor-control-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="6d26b-133">**Figure 04**: Submitting a form with an HTML Editor([Click to view full-size image](how-do-i-use-the-html-editor-control-vb/_static/image8.png))</span></span>

<span data-ttu-id="6d26b-134">Свойство HTML Editor Content используется для получения HTML-контента, внесенного в HTML-редактор.</span><span class="sxs-lookup"><span data-stu-id="6d26b-134">The HTML Editor Content property is used to retrieve the HTML content entered into the HTML Editor.</span></span> <span data-ttu-id="6d26b-135">Имейте в виду, что этот HTML-контент может содержать JavaScript.</span><span class="sxs-lookup"><span data-stu-id="6d26b-135">Be aware that this HTML content can contain JavaScript.</span></span> <span data-ttu-id="6d26b-136">В следующем разделе мы обсудим, как можно предотвратить атаки инъекций JavaScript.</span><span class="sxs-lookup"><span data-stu-id="6d26b-136">In the next section, we discuss how you can prevent JavaScript Injection Attacks.</span></span>

## <a name="customizing-the-html-editor-toolbar"></a><span data-ttu-id="6d26b-137">Настройка панели инструментов html Editor</span><span class="sxs-lookup"><span data-stu-id="6d26b-137">Customizing the HTML Editor Toolbar</span></span>

<span data-ttu-id="6d26b-138">Вы можете настроить, какие именно кнопки отображаются в редакторе.</span><span class="sxs-lookup"><span data-stu-id="6d26b-138">You can customize exactly which buttons appear in the editor.</span></span> <span data-ttu-id="6d26b-139">Например, можно удалить вкладку HTML, чтобы пользователи не переключали HTML-редактор в режим HTML.</span><span class="sxs-lookup"><span data-stu-id="6d26b-139">For example, you might want to remove the HTML tab to prevent users from switching the HTML Editor into HTML mode.</span></span> <span data-ttu-id="6d26b-140">Или, возможно, вы захотите удалить список выпадающих размеров шрифта, чтобы предотвратить создание пользователями слишком большого текста в сообщении форума (см. рисунок 5).</span><span class="sxs-lookup"><span data-stu-id="6d26b-140">Or, you might want to remove the font size dropdown list to prevent users from creating overly large text in a forum message post (see Figure 5).</span></span>

<span data-ttu-id="6d26b-141">[![Индивидуальный HTML-редактор](how-do-i-use-the-html-editor-control-vb/_static/image5.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="6d26b-141">[![A customized HTML Editor](how-do-i-use-the-html-editor-control-vb/_static/image5.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image9.png)</span></span>

<span data-ttu-id="6d26b-142">**Рисунок 05**: Настраиваемый HTML редактор[(Нажмите, чтобы просмотреть полноразмерное изображение](how-do-i-use-the-html-editor-control-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="6d26b-142">**Figure 05**: A customized HTML Editor([Click to view full-size image](how-do-i-use-the-html-editor-control-vb/_static/image10.png))</span></span>

<span data-ttu-id="6d26b-143">Вы настраиваете кнопки панели инструментов, выдыхая новый HTML-редактор из класса базового редактора.</span><span class="sxs-lookup"><span data-stu-id="6d26b-143">You customize the toolbar buttons by deriving a new HTML Editor from the base Editor class.</span></span> <span data-ttu-id="6d26b-144">Например, пользовательский редактор в листинге 2 содержит только кнопки панели инструментов для смелых и курсивных.</span><span class="sxs-lookup"><span data-stu-id="6d26b-144">For example, the custom editor in Listing 2 only contains toolbar buttons for bold and italic.</span></span> <span data-ttu-id="6d26b-145">Все остальные кнопки панели инструментов были удалены.</span><span class="sxs-lookup"><span data-stu-id="6d26b-145">All other toolbar buttons have been removed.</span></span> <span data-ttu-id="6d26b-146">Кроме того, вкладка HTML была удалена из нижней части редактора (но вкладки Design and Preview все еще существуют).</span><span class="sxs-lookup"><span data-stu-id="6d26b-146">Furthermore, the HTML tab has been removed from the bottom of the editor (but the Design and Preview tabs are still there).</span></span>

<span data-ttu-id="6d26b-147">**Список 2\_- App Code-CustomEditor.vb**</span><span class="sxs-lookup"><span data-stu-id="6d26b-147">**Listing 2 - App\_Code\CustomEditor.vb**</span></span>

[!code-vb[Main](how-do-i-use-the-html-editor-control-vb/samples/sample2.vb)]

<span data-ttu-id="6d26b-148">Необходимо добавить класс в листинге\_2 в папку App Code, чтобы класс был компилирован автоматически.</span><span class="sxs-lookup"><span data-stu-id="6d26b-148">You must add the class in Listing 2 to your App\_Code folder so that the class will be compiled automatically.</span></span> <span data-ttu-id="6d26b-149">Если папка App\_Code не существует на вашем сайте, то вы можете просто добавить папку.</span><span class="sxs-lookup"><span data-stu-id="6d26b-149">If the App\_Code folder does not exist in your website then you can simply add the folder.</span></span>

<span data-ttu-id="6d26b-150">После создания пользовательского редактора его можно добавить на страницу ASP.NET так же, как и обычный HTML-редактор (см. список 3).</span><span class="sxs-lookup"><span data-stu-id="6d26b-150">After you create a custom editor, you can add it to an ASP.NET page in the same way as you add the normal HTML Editor (see Listing 3).</span></span>

<span data-ttu-id="6d26b-151">**Список 3 - ShowCustomEditor.aspx**</span><span class="sxs-lookup"><span data-stu-id="6d26b-151">**Listing 3 - ShowCustomEditor.aspx**</span></span>

[!code-aspx[Main](how-do-i-use-the-html-editor-control-vb/samples/sample3.aspx)]

## <a name="avoiding-cross-site-scripting-xss-attacks"></a><span data-ttu-id="6d26b-152">Как избежать перекрестного сайта Сценарии (XSS) Атак</span><span class="sxs-lookup"><span data-stu-id="6d26b-152">Avoiding Cross-Site Scripting (XSS) Attacks</span></span>

<span data-ttu-id="6d26b-153">Всякий раз, когда вы принимаете ввод от пользователя и повторно отображаете этот вход на вашем сайте, вы потенциально открываете свой веб-сайт для перекрестных атак сценариев (XSS).</span><span class="sxs-lookup"><span data-stu-id="6d26b-153">Whenever you accept input from a user, and redisplay that input on your website, you potentially open your website to Cross-Site Scripting (XSS) Attacks.</span></span> <span data-ttu-id="6d26b-154">Теоретически, злоумышленник может отправить код JavaScript, который выполняется при повторном отображении ввода.</span><span class="sxs-lookup"><span data-stu-id="6d26b-154">In theory, a malicious hacker could submit JavaScript code that gets executed when the input is redisplayed.</span></span> <span data-ttu-id="6d26b-155">JavaScript может быть использован для кражи паролей пользователей или другой конфиденциальной информации.</span><span class="sxs-lookup"><span data-stu-id="6d26b-155">The JavaScript could be used to steal user passwords or other sensitive information.</span></span>

<span data-ttu-id="6d26b-156">Как правило, вы можете победить XSS-атаки HTML кодирования любой вход, который вы получаете от пользователя, прежде чем отображать его на веб-странице.</span><span class="sxs-lookup"><span data-stu-id="6d26b-156">Normally, you can defeat XSS attacks by HTML encoding whatever input you retrieve from a user before displaying it in a web page.</span></span> <span data-ttu-id="6d26b-157">Тем не менее, HTML кодирования вывода HTML редактор &lt;не&gt; только кодировать теги скрипта, он также будет кодировать все теги HTML.</span><span class="sxs-lookup"><span data-stu-id="6d26b-157">However, HTML encoding the output of the HTML Editor would not only encode &lt;script&gt; tags, it would also encode all HTML tags.</span></span> <span data-ttu-id="6d26b-158">Другими словами, вы потеряете все форматирование, такие как тип шрифта, размер шрифта и цвет фона.</span><span class="sxs-lookup"><span data-stu-id="6d26b-158">In other words, you would lose all of the formatting such as the font type, font size, and background color.</span></span>

<span data-ttu-id="6d26b-159">Если вы собираете конфиденциальную информацию от пользователей, например пароли, номера кредитных карт и номера социального страхования, то вам не следует отображать незакодированный контент, который вы получаете от пользователя с HTML-редактором.</span><span class="sxs-lookup"><span data-stu-id="6d26b-159">If you are collecting sensitive information from your users -- such as passwords, credit-card numbers, and social security numbers - then you should not display un-encoded content that you retrieve from a user with the HTML Editor.</span></span> <span data-ttu-id="6d26b-160">Редактор HTML следует использовать только в ситуациях, когда вы не переображаете HTML-контент или HTML-контент передается на ваш веб-сайт доверенной стороной.</span><span class="sxs-lookup"><span data-stu-id="6d26b-160">You should use the HTML Editor only in situations in which you are not redisplaying the HTML content, or the HTML content is being submitted to your website by a trusted party.</span></span>

<span data-ttu-id="6d26b-161">Представьте себе, например, что вы создаете приложение для блога.</span><span class="sxs-lookup"><span data-stu-id="6d26b-161">Imagine, for example, that you are creating a blog application.</span></span> <span data-ttu-id="6d26b-162">В этой ситуации имеет смысл использовать HTML-редактор при составлении сообщений в блоге.</span><span class="sxs-lookup"><span data-stu-id="6d26b-162">In this situation, it makes sense to use the HTML Editor when composing blog posts.</span></span> <span data-ttu-id="6d26b-163">Вы единственный, кто представляет сообщение в блоге и, по-видимому, вы можете доверять себе, чтобы не представить вредоносных JavaScript.</span><span class="sxs-lookup"><span data-stu-id="6d26b-163">You are the only one who submits a blog post and, presumably, you can trust yourself not to submit malicious JavaScript.</span></span> <span data-ttu-id="6d26b-164">Тем не менее, не имеет смысла использовать HTML редактор, когда позволяет анонимным пользователям размещать комментарии.</span><span class="sxs-lookup"><span data-stu-id="6d26b-164">However, it does not make sense to use the HTML Editor when allowing anonymous users to post comments.</span></span> <span data-ttu-id="6d26b-165">Вы должны быть особенно осторожны в ситуациях, когда пользователи отправляют конфиденциальную информацию, такую как пароли.</span><span class="sxs-lookup"><span data-stu-id="6d26b-165">You should be especially careful in situations in which users submit sensitive information such as passwords.</span></span> <span data-ttu-id="6d26b-166">Потенциально, вредоносный пользователь может опубликовать комментарий, который содержит право JavaScript для кражи пароля.</span><span class="sxs-lookup"><span data-stu-id="6d26b-166">Potentially, a malicious user could post a comment that contains the right JavaScript for stealing a password.</span></span>

## <a name="summary"></a><span data-ttu-id="6d26b-167">Сводка</span><span class="sxs-lookup"><span data-stu-id="6d26b-167">Summary</span></span>

<span data-ttu-id="6d26b-168">В этом уроке вам был предоставлен краткий обзор управления HTML-редактором, включенным в набор инструментов управления AJAX.</span><span class="sxs-lookup"><span data-stu-id="6d26b-168">In this tutorial, you were provided with a brief overview of the HTML Editor control included in the AJAX Control Toolkit.</span></span> <span data-ttu-id="6d26b-169">Вы узнали, как использовать HTML Редактор принять богатый контент от пользователя и отправить содержимое на сервер.</span><span class="sxs-lookup"><span data-stu-id="6d26b-169">You learned how to use the HTML Editor to accept rich content from a user and submit the content to the server.</span></span> <span data-ttu-id="6d26b-170">Мы также обсудили, как можно настроить кнопки панели инструментов, отображаемые редактором HTML.</span><span class="sxs-lookup"><span data-stu-id="6d26b-170">We also discussed how you can customize the toolbar buttons that are displayed by the HTML Editor.</span></span> <span data-ttu-id="6d26b-171">Наконец, вы узнали, как избежать кросс-сайт Скриптирование атак при использовании HTML редактор принять потенциально вредоносных ввода.</span><span class="sxs-lookup"><span data-stu-id="6d26b-171">Finally, you learned how to avoid Cross-Site Scripting Attacks when using the HTML Editor to accept potentially malicious input.</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="6d26b-172">Назад</span><span class="sxs-lookup"><span data-stu-id="6d26b-172">Previous</span></span>](how-do-i-use-the-html-editor-control-cs.md)
