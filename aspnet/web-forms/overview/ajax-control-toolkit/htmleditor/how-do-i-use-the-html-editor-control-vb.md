---
uid: web-forms/overview/ajax-control-toolkit/htmleditor/how-do-i-use-the-html-editor-control-vb
title: Разделы справки использовать элемент управления редактора HTML? (VB) | Документация Майкрософт
author: microsoft
description: Хтмледитор — это элемент управления AJAX ASP.NET, который позволяет легко создавать и редактировать содержимое HTML с помощью кнопок на панели инструментов.
ms.author: riande
ms.date: 05/12/2009
ms.assetid: 32ec9321-7c8c-4b0f-8234-99acb56df6b5
msc.legacyurl: /web-forms/overview/ajax-control-toolkit/htmleditor/how-do-i-use-the-html-editor-control-vb
msc.type: authoredcontent
ms.openlocfilehash: 20f8a2f8148bc658370ba1a939ebf1b62d376bc0
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78446286"
---
# <a name="how-do-i-use-the-html-editor-control-vb"></a>Разделы справки использовать элемент управления редактора HTML? Visual Basic

по [Майкрософт](https://github.com/microsoft)

> Хтмледитор — это элемент управления AJAX ASP.NET, который позволяет легко создавать и редактировать содержимое HTML с помощью кнопок на панели инструментов.

Цель этого учебника — предоставить обзор элемента управления редактора HTML, включенного в набор AJAX Control Toolkit. Редактор HTML включает параметры для изменения размера шрифта, выбора шрифта, изменения цвета фона, изменения цвета переднего плана, добавления ссылок, добавления изображений, изменения выравнивания текста и выполнения операций вырезания, копирования и вставки (см. рис. 1).

[![редактора HTML](how-do-i-use-the-html-editor-control-vb/_static/image1.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image1.png)

**Рис. 01**. редактор HTML ([щелкните, чтобы просмотреть изображение с полным размером](how-do-i-use-the-html-editor-control-vb/_static/image2.png))

Редактор HTML позволяет вводить содержимое в режиме конструктора или непосредственно вводить HTML. Кроме того, предоставляется возможность предварительного просмотра HTML-содержимого (см. рис. 2).

[кнопки "Конструктор", "HTML" и "Просмотр" ![](how-do-i-use-the-html-editor-control-vb/_static/image2.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image3.png)

**Рис. 02**. кнопки КОНСТРУКТОРА, HTML и предварительного просмотра ([щелкните, чтобы просмотреть изображение с полным размером](how-do-i-use-the-html-editor-control-vb/_static/image4.png))

В этом руководстве вы узнаете, как отобразить редактор HTML, как настроить кнопки панели инструментов, отображаемые в редакторе HTML, и как избежать атак с использованием межсайтовых сценариев.

## <a name="displaying-the-html-editor"></a>Отображение редактора HTML

Прежде чем использовать редактор HTML на странице ASP.NET, необходимо сначала добавить на страницу элемент управления ScriptManager. Элемент управления ScriptManager находится под вкладкой AJAX Extensions в панели элементов Visual Studio/Visual Web Developer Express.

Элемент управления ScriptManager следует поместить в верхнюю часть страницы перед любыми другими элементами управления на странице. Например, его можно поместить непосредственно под открывающим &lt;форме&gt; тега.

Элемент управления редактора HTML находится в области элементов с остальными элементами управления AJAX Control Toolkit. Он называется элементом управления редактора (см. рис. 3).

[![элемента управления редактора HTML](how-do-i-use-the-html-editor-control-vb/_static/image3.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image5.png)

**Рис. 03**. элемент управления редактора HTML ([щелкните, чтобы просмотреть изображение с полным размером](how-do-i-use-the-html-editor-control-vb/_static/image6.png))

После перетаскивания редактора HTML на страницу его свойства можно задать на странице свойств. Например, обычно требуется задать свойства Width и Height. В листинге 1 содержится источник страницы ASP.NET, содержащей редактор HTML.

**Листинг 1-Симплидитор. aspx**

[!code-aspx[Main](how-do-i-use-the-html-editor-control-vb/samples/sample1.aspx)]

Страница в листинге 1 содержит элемент управления редактора HTML, элемент управления Button и элемент управления Literal. При нажатии кнопки содержимое редактора HTML отображается в элементе управления Literal (см. рис. 4).

[![Отправка формы с помощью редактора HTML](how-do-i-use-the-html-editor-control-vb/_static/image4.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image7.png)

**Рис. 04**. Отправка формы в редакторе HTML ([щелкните, чтобы просмотреть изображение с полным размером](how-do-i-use-the-html-editor-control-vb/_static/image8.png))

Свойство содержимого редактора HTML используется для получения HTML-содержимого, вводимых в редактор HTML. Имейте в виду, что это содержимое HTML может содержать JavaScript. В следующем разделе мы обсудим, как можно предотвратить атаки путем внедрения кода JavaScript.

## <a name="customizing-the-html-editor-toolbar"></a>Настройка панели инструментов редактора HTML

Вы можете точно настроить, какие кнопки отображаются в редакторе. Например, может потребоваться удалить вкладку HTML, чтобы запретить пользователям переключать редактор HTML в режим HTML. Также можно удалить раскрывающийся список размер шрифта, чтобы пользователи не могли создавать слишком большой текст в сообщении на форуме (см. рис. 5).

[![настраиваемого редактора HTML](how-do-i-use-the-html-editor-control-vb/_static/image5.jpg)](how-do-i-use-the-html-editor-control-vb/_static/image9.png)

**Рис. 05**. настраиваемый редактор HTML ([щелкните, чтобы просмотреть изображение с полным размером](how-do-i-use-the-html-editor-control-vb/_static/image10.png))

Вы настраиваете кнопки на панели инструментов, производя новый редактор HTML от базового класса редактора. Например, пользовательский редактор в листинге 2 содержит кнопки панели инструментов для полужирного и курсивного начертания. Все остальные кнопки панели инструментов были удалены. Более того, вкладка HTML была удалена из нижней части редактора (но вкладки Конструктор и предварительный просмотр остаются там).

**Листинг 2. приложение\_Коде\кустомедитор.ВБ**

[!code-vb[Main](how-do-i-use-the-html-editor-control-vb/samples/sample2.vb)]

Класс, приведенный в листинге 2, необходимо добавить в папку приложения\_Code, чтобы класс был скомпилирован автоматически. Если папка кода приложения\_не существует на веб-сайте, можно просто добавить эту папку.

После создания пользовательского редактора его можно добавить на страницу ASP.NET таким же образом, как и при добавлении обычного редактора HTML (см. листинг 3).

**Листинг 3-Шовкустомедитор. aspx**

[!code-aspx[Main](how-do-i-use-the-html-editor-control-vb/samples/sample3.aspx)]

## <a name="avoiding-cross-site-scripting-xss-attacks"></a>Предотвращение атак с использованием межсайтовых сценариев (XSS)

Когда вы принимаете входные данные от пользователя и повторно отображаете эти данные на веб-сайте, вы потенциально открываете веб-сайт для атак с использованием межсайтовых сценариев (XSS). Теоретически вредоносный злоумышленник может отправить код JavaScript, который выполняется при повторном отображении входных данных. JavaScript можно использовать для кражи паролей пользователей или других конфиденциальных данных.

Как правило, атаки XSS можно отменять с помощью кодирования HTML любых входных данных, получаемых от пользователя, перед его отображением на веб-странице. Однако в HTML-кодировке выходные данные редактора HTML не только закодировать &lt;скрипт&gt; теги, но также будут кодировать все HTML-теги. Иными словами, вы потеряли все форматирование, такие как тип шрифта, размер шрифта и цвет фона.

Если вы собираете конфиденциальную информацию от пользователей, например пароли, номера кредитных карт и номера социального страхования, не следует отображать незакодированное содержимое, полученное от пользователя с помощью редактора HTML. Редактор HTML следует использовать только в тех случаях, когда вы не переводите содержимое HTML или отправляете содержимое HTML доверенной стороной.

Представьте, например, что вы создаете приложение блога. В этом случае имеет смысл использовать редактор HTML при создании записей блога. Вы только отправили запись блога и, предположительно, можете доверять себе, не отправляйте вредоносный код JavaScript. Однако не имеет смысла использовать редактор HTML, если разрешить анонимным пользователям публиковать комментарии. Следует быть особенно осторожным в ситуациях, когда пользователи отправляют конфиденциальную информацию, например пароли. Потенциально злонамеренный пользователь может поместить комментарий, содержащий правильный код JavaScript, для кражи пароля.

## <a name="summary"></a>Сводка

В этом учебнике вы предоставили краткий обзор элемента управления редактора HTML, включенного в набор AJAX Control Toolkit. Вы узнали, как использовать редактор HTML для приема насыщенного содержимого от пользователя и отправки содержимого на сервер. Мы также рассмотрели, как можно настроить кнопки панели инструментов, отображаемые редактором HTML. Наконец, вы узнали, как избежать атак с использованием межсайтовых сценариев при использовании редактора HTML для приема потенциально вредоносных входных данных.

> [!div class="step-by-step"]
> [Назад](how-do-i-use-the-html-editor-control-cs.md)
