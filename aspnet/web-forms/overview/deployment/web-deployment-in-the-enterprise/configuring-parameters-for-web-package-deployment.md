---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/configuring-parameters-for-web-package-deployment
title: Настройка параметров для веб-пакета развертывания | Документация Майкрософт
author: jrjlee
description: В этом разделе описывается, как задать значения параметров, как имена веб-приложений службы Internet Information Services (IIS), строки подключения и конечные точки службы...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 37947d79-ab1e-4ba9-9017-52e7a2757414
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/configuring-parameters-for-web-package-deployment
msc.type: authoredcontent
ms.openlocfilehash: f738d1c0b3cd99bb6df5f8b24dca907fa0b31f4d
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59413104"
---
# <a name="configuring-parameters-for-web-package-deployment"></a>Настройка параметров для развертывания веб-пакета

по [Джейсон Lee](https://github.com/jrjlee)

[Загрузить PDF-файл](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> В этом разделе описывается, как задать значения параметров, как имена веб-приложений службы Internet Information Services (IIS), строки подключения и конечные точки службы, при развертывании веб-пакета на удаленном веб-сервере IIS.


При создании проекта веб-приложения, построения и обработки пакетов создает три файла ключей:

- Объект *ZIP-файл [имя_проекта]* файл. Это пакет веб-развертывания для проекта веб-приложения. Этот пакет содержит все сборки, файлы, скрипты базы данных и ресурсы, необходимые для повторного создания веб-приложения на удаленном веб-сервере IIS.
- Объект *.deploy.cmd [имя_проекта]* файл. Он содержит набор параметризованных команд Web Deploy (MSDeploy.exe), используемыми для публикации веб-пакет развертывания на удаленном веб-сервере IIS.
- Объект *[имя_проекта]. SetParameters.xml* файл. Это набор значений параметров в команду MSDeploy.exe. Можно обновить значения в этот файл и передать его на веб-развертывания в качестве параметра командной строки при развертывании веб-пакет.

> [!NOTE]
> Дополнительные сведения о построения и обработки пакетов, см. в разделе [сборка и упаковка проектов веб-приложений](building-and-packaging-web-application-projects.md).


*SetParameters.xml* файла создается динамически в файл проекта веб-приложения и файлы конфигурации в проекте. Во время сборки и упаковки проекта, конвейер публикации Web (WPP) автоматически обнаруживает множество переменных, которые, скорее всего, для переключения сред развертывания, таких как назначение веб-приложения IIS и любые строки подключения к базе данных. Эти значения автоматически параметризован в пакет веб-развертывания и добавляются к *SetParameters.xml* файл. Например, если добавить строку подключения к *web.config* файл в проект веб-приложения, процесс сборки обнаружит это изменение и будет добавлена запись для *SetParameters.xml* файла соответствующим образом.

В большинстве случаев этот автоматической параметризации, будет достаточно. Тем не менее, если пользователям требуется для изменения других параметров между средами развертывания, таких как параметры приложения или URL-адреса конечной точки службы, необходимо указать WPP параметризовать эти значения в пакет развертывания и добавить соответствующие записи в *SetParameters.xml* файл. В последующих разделах объясняется, как это сделать.

### <a name="automatic-parameterization"></a>Автоматическая параметризация

Если вы собрали и упаковали веб-приложения, WPP будет автоматической параметризации следующее:

- Назначение IIS веб-приложения путь и имя.
- Строки любого подключения в вашей *web.config* файл.
- Строки подключения для всех баз данных, добавляемые **упаковка и публикация SQL** вкладки на страницах свойств проекта.

Например, если нужно собрать и упаковать [Contact Manager](the-contact-manager-solution.md) примера решения, не изменяя при этом процесс параметризации любым способом, WPP вызовет *ContactManager.Mvc.SetParameters.xml* файла:


[!code-xml[Main](configuring-parameters-for-web-package-deployment/samples/sample1.xml)]


В этом случае:

- **Имя веб-приложения IIS** параметр — это путь IIS, где вы хотите развернуть веб-приложения. Значение по умолчанию берется из **пакета и публикация веб-** страницы на страницах свойств проекта.
- **ApplicationServices-Web.config Connection String** параметра было создано из **/connectionStrings, добавить** элемент в *web.config* файл. Он представляет строку подключения, приложение должно использовать, чтобы обращаться к базе данных членства. Значения, указываемые здесь будут заменены в развернутой *web.config* файл. Значение по умолчанию берется из перед развертыванием *web.config* файл.

WPP и параметризует эти свойства в создаваемый им пакет развертывания. При установке пакета развертывания, можно указать значения для этих свойств. Если установить пакет вручную через IIS Manager, как описано в разделе [вручную Установка веб-пакеты](manually-installing-web-packages.md), мастер установки предложит указать значения для любых параметров. Если при установке пакета удаленно с помощью *. deploy.cmd* файл, как описано в разделе [развертывание веб-пакетов](deploying-web-packages.md), веб-развертывания, будут смотреть это *SetParameters.xml* файл Укажите значения параметров. Вы можете изменять значения в *SetParameters.xml* файл вручную, или можно настроить файл как часть автоматизированного процесса сборки и развертывания. Этот процесс описан более подробно далее в этом разделе.

### <a name="custom-parameterization"></a>Пользовательские параметризации

В более сложных сценариев развертывания будет часто требуется параметризовать соответствующие дополнительные свойства до развертывания проекта. Вообще говоря следует параметризовать все свойства и параметры, которые варьируются у разных сред назначения. Они могут включать:

- Конечные точки в службы *web.config* файл.
- Параметры приложения в *web.config* файл.
- Другие декларативной свойства, которые вы хотите предлагать пользователю указать.

Самый простой способ параметризовать этих свойств является добавление *parameters.xml* файл в корневую папку проекта веб-приложения. Например, в решение диспетчера контактов, ContactManager.Mvc проект включает *parameters.xml* файл в корневой папке.

![](configuring-parameters-for-web-package-deployment/_static/image1.png)

Если открыть этот файл, вы увидите, что она содержит один **параметр** запись. Операция использует языка пути XML (XPath) запрос для поиска и параметризовать URL-адрес конечной точки службы ContactService Windows Communication Foundation (WCF) в *web.config* файл.


[!code-xml[Main](configuring-parameters-for-web-package-deployment/samples/sample2.xml)]


В дополнение к параметризации URL-адрес конечной точки в пакет развертывания, WPP также добавляет соответствующую запись для *SetParameters.xml* файл, который создается в пакет развертывания.


[!code-xml[Main](configuring-parameters-for-web-package-deployment/samples/sample3.xml)]


Если вручную установить пакет развертывания, диспетчер служб IIS предложит ввести адрес конечной точки службы вместе с свойства, которые были параметризованы автоматически. Если вы установите пакет развертывания, выполнив *. deploy.cmd* файл, можно изменить *SetParameters.xml* файл, чтобы предоставить значение для адрес конечной точки службы, а также значения для свойства, которые были параметризованы автоматически.

Полные сведения о способах создания *parameters.xml* файл, см. в разделе [как: Использование параметров для настройки параметров при пакет развертывания устанавливается](https://msdn.microsoft.com/library/ff398068.aspx). Процедура, с именем **использование параметров развертывания для параметров файла Web.config** пошаговые инструкции.

## <a name="modifying-the-setparametersxml-file"></a>Изменение файла SetParameters.xml

Если планируется развернуть пакет веб-приложения вручную&#x2014;либо путем выполнения *. deploy.cmd* файла или путем запуска из командной строки MSDeploy.exe&#x2014;нет ничего должно остановить вас Ручная  *SetParameters.xml* перед развертыванием. Тем не менее если вы работаете в это решение корпоративного уровня, может потребоваться развернуть пакет веб-приложения как часть большего размера, автоматизированный процесс сборки и развертывания. В этом случае требуется Microsoft Build Engine (MSBuild), чтобы изменить *SetParameters.xml* файл для вас. Это можно сделать с помощью MSBuild **XmlPoke** задачи.

[Примера решения диспетчера контактов](the-contact-manager-solution.md) иллюстрирует этот процесс. Чтобы отобразить только сведения, относящиеся к этому примеру были изменены приведенных ниже примерах кода.

> [!NOTE]
> Более широкий обзор модели файл проекта в решении и введение к файлам пользовательского проекта в целом, см. в разделе [основные сведения о файле проекта](understanding-the-project-file.md) и [основные сведения о процессе построения](understanding-the-build-process.md).


Во-первых, значения параметров интерес определяются как свойства в файле проекта для конкретной среды (например, *Env Dev.proj*).


[!code-xml[Main](configuring-parameters-for-web-package-deployment/samples/sample4.xml)]


> [!NOTE]
> Рекомендации по настройке файлы проекта для конкретной среды для серверных сред, см. в разделе [настройки свойств развертывания для целевой среды](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md).


Далее, *Publish.proj* файл импортирует эти свойства. Так как каждый *SetParameters.xml* с которым связан файл *. deploy.cmd* файл и мы в конечном итоге желательно файл проекта для каждого вызова *. deploy.cmd* файл проекта MSBuild создает файл *элемент* для каждого *. deploy.cmd* файла и определяет свойства интерес как *метаданные элемента*.


[!code-xml[Main](configuring-parameters-for-web-package-deployment/samples/sample5.xml)]


В этом случае:

- **ParametersXml** значение метаданных указывает расположение *SetParameters.xml* файл.
- **IisWebAppName** значением является путь IIS, к которому вы хотите развернуть веб-приложения.
- **MembershipDBConnectionString** значением является строка подключения для базы данных членства и **MembershipDBConnectionName** значение **имя** атрибут соответствующего параметра в *SetParameters.xml* файл.
- **ServiceEndpointValue** значение — это адрес конечной точки для службы WCF на конечном сервере и **ServiceEndpointParamName** значение является атрибут имени соответствующего параметра в *SetParameters.xml* файл.

Наконец, в *Publish.proj* файл, **PublishWebPackages** целевой использует **XmlPoke** задачи, чтобы изменить эти значения в *SetParameters.xml* файл.


[!code-xml[Main](configuring-parameters-for-web-package-deployment/samples/sample6.xml)]


Вы заметите, что каждый **XmlPoke** задача определяет четыре значения атрибутов:

- **XmlInputPath** атрибут сообщает задачи, где можно найти файл, который необходимо изменить.
- **Запроса** атрибут является запрос XPath, который идентифицирует узел XML, который вы хотите изменить.
- **Значение** атрибут — это новое значение, необходимо вставить в выбранный узел XML.
- **Условие** атрибут — это критерий, на которых должна выполняться или выполняться задачи. В этом случае условие гарантирует, что не предпринимается попытка вставить значение null или пустым в *SetParameters.xml* файл.

## <a name="conclusion"></a>Заключение

В этом разделе описывается роль *SetParameters.xml* файл и описано, как оно создается при выполнении сборки проект веб-приложения. Описано, как можно параметризовать, добавив дополнительные параметры *parameters.xml* файл в проект. Он также описано, как изменять *SetParameters.xml* файл как часть процесса построения большего размера, автоматизированный, с помощью **XmlPoke** задач в файлах проекта.

Следующий раздел, [развертывание веб-пакеты](deploying-web-packages.md), описывает, как развернуть веб-пакета либо путем выполнения *. deploy.cmd* файл или напрямую с помощью MSDeploy.exe команды. В обоих случаях можно указать ваш *SetParameters.xml* файл в качестве параметра развертывания.

## <a name="further-reading"></a>Дополнительные сведения

Сведения о том, как создать веб-пакетов, см. в разделе [сборка и упаковка проектов веб-приложений](building-and-packaging-web-application-projects.md). Рекомендации о том, как фактически развернуть веб-пакет, см. в разделе [развертывание веб-пакеты](deploying-web-packages.md). Пошаговое руководство по созданию *parameters.xml* файл, см. в разделе [как: Использование параметров для настройки параметров при пакет развертывания устанавливается](https://msdn.microsoft.com/library/ff398068.aspx).

Дополнительные сведения о параметризации в веб-развертывания, см. в разделе [Web развертывание параметризации в действии](https://go.microsoft.com/?linkid=9805119) (запись блога).

> [!div class="step-by-step"]
> [Назад](building-and-packaging-web-application-projects.md)
> [Вперед](deploying-web-packages.md)
