---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/understanding-the-project-file
title: Общие сведения о файле проекта | Документация Майкрософт
author: jrjlee
description: Файлы проекта Microsoft Build Engine (MSBuild) лежат в основе процесса построения и развертывания. Этот раздел начинается с концептуальный обзор MSBuild...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 07978d9d-341c-4524-bcba-62976f390f77
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/understanding-the-project-file
msc.type: authoredcontent
ms.openlocfilehash: d774a8e13e108d1be4c39e1e909d3d9683968a0d
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59404927"
---
# <a name="understanding-the-project-file"></a><span data-ttu-id="e9ba4-104">Общие сведения о файле проекта</span><span class="sxs-lookup"><span data-stu-id="e9ba4-104">Understanding the Project File</span></span>

<span data-ttu-id="e9ba4-105">по [Джейсон Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="e9ba4-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="e9ba4-106">Загрузить PDF-файл</span><span class="sxs-lookup"><span data-stu-id="e9ba4-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="e9ba4-107">Файлы проекта Microsoft Build Engine (MSBuild) лежат в основе процесса построения и развертывания.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-107">Microsoft Build Engine (MSBuild) project files lie at the heart of the build and deployment process.</span></span> <span data-ttu-id="e9ba4-108">Этот раздел начинается с концептуальный обзор MSBuild и файл проекта.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-108">This topic starts with a conceptual overview of MSBuild and the project file.</span></span> <span data-ttu-id="e9ba4-109">Он описывает ключевые компоненты, которые вы будете сталкиваться при работе с файлами проекта, и они работают, минуя пример того, как можно использовать файлы проекта для развертывания приложений в реальных условиях.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-109">It describes the key components you'll come across when you work with project files, and it works through an example of how you can use project files to deploy real-world applications.</span></span>
> 
> <span data-ttu-id="e9ba4-110">Вы узнаете, как:</span><span class="sxs-lookup"><span data-stu-id="e9ba4-110">What you'll learn:</span></span>
> 
> - <span data-ttu-id="e9ba4-111">Как MSBuild использует файлы проекта MSBuild для построения проектов.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-111">How MSBuild uses MSBuild project files to build projects.</span></span>
> - <span data-ttu-id="e9ba4-112">Как MSBuild интегрируется с технологиями развертывания, такие как средство Internet Information Services (IIS) веб-развертывания (веб-развертывания).</span><span class="sxs-lookup"><span data-stu-id="e9ba4-112">How MSBuild integrates with deployment technologies, like the Internet Information Services (IIS) Web Deployment Tool (Web Deploy).</span></span>
> - <span data-ttu-id="e9ba4-113">Как понять ключевые компоненты файла проекта.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-113">How to understand the key components of a project file.</span></span>
> - <span data-ttu-id="e9ba4-114">Использование файлов проекта для создания и развертывания сложных приложений.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-114">How you can use project files to build and deploy complex applications.</span></span>


## <a name="msbuild-and-the-project-file"></a><span data-ttu-id="e9ba4-115">MSBuild и файл проекта</span><span class="sxs-lookup"><span data-stu-id="e9ba4-115">MSBuild and the Project File</span></span>

<span data-ttu-id="e9ba4-116">При создании и сборке решений в Visual Studio, Visual Studio использует MSBuild для построения каждого проекта в решении.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-116">When you create and build solutions in Visual Studio, Visual Studio uses MSBuild to build each project in your solution.</span></span> <span data-ttu-id="e9ba4-117">Каждый проект Visual Studio включает файл проекта MSBuild с расширением файла, который отражает типа проекта&#x2014;для этого проекта C# (CSPROJ-файл), проект Visual Basic.NET (с расширением VBPROJ) или проект базы данных (DBPROJ).</span><span class="sxs-lookup"><span data-stu-id="e9ba4-117">Every Visual Studio project includes an MSBuild project file, with a file extension that reflects the type of project&#x2014;for example, a C# project (.csproj), a Visual Basic.NET project (.vbproj), or a database project (.dbproj).</span></span> <span data-ttu-id="e9ba4-118">Чтобы построить проект, MSBuild необходимо обработать файл проекта, связанные с проектом.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-118">In order to build a project, MSBuild must process the project file associated with the project.</span></span> <span data-ttu-id="e9ba4-119">Файл проекта — это документ XML, который содержит все сведения и инструкции, что MSBuild необходимы для сборки проекта, как содержимое для включения, требования к платформе, сведения об управлении версиями, веб-сервера или параметров сервера базы данных и задачи, которые должны быть выполнены.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-119">The project file is an XML document that contains all the information and instructions that MSBuild needs in order to build your project, like the content to include, the platform requirements, versioning information, web server or database server settings, and the tasks that must be performed.</span></span>

<span data-ttu-id="e9ba4-120">Файлы проекта MSBuild основаны на [схемы MSBuild XML](https://msdn.microsoft.com/library/5dy88c2e.aspx), и в результате процесса построения и полностью открыто.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-120">MSBuild project files are based on the [MSBuild XML schema](https://msdn.microsoft.com/library/5dy88c2e.aspx), and as a result the build process is entirely open and transparent.</span></span> <span data-ttu-id="e9ba4-121">Кроме того, не нужно установить Visual Studio, чтобы использовать обработчик MSBuild&#x2014;исполняемый файл MSBuild.exe является частью .NET Framework, и его можно запустить из командной строки.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-121">In addition, you don't need to install Visual Studio in order to use the MSBuild engine&#x2014;the MSBuild.exe executable is part of the .NET Framework, and you can run it from a command prompt.</span></span> <span data-ttu-id="e9ba4-122">Как разработчик вы можете создать собственные файлы проекта MSBuild, с помощью схемы MSBuild XML, чтобы создать сложный и детальный контроль над как построение и развертывание проектов.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-122">As a developer, you can craft your own MSBuild project files, using the MSBuild XML schema, to impose sophisticated and fine-grained control over how your projects are built and deployed.</span></span> <span data-ttu-id="e9ba4-123">Эти файлы пользовательского проекта работать точно так же, как файлы проекта, создаваемые в Visual Studio автоматически.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-123">These custom project files work in exactly the same way as the project files that Visual Studio generates automatically.</span></span>

> [!NOTE]
> <span data-ttu-id="e9ba4-124">Можно также использовать файлы проекта MSBuild с помощью службы Team Build в Team Foundation Server (TFS).</span><span class="sxs-lookup"><span data-stu-id="e9ba4-124">You can also use MSBuild project files with the Team Build service in Team Foundation Server (TFS).</span></span> <span data-ttu-id="e9ba4-125">Например файлы проекта в сценариях непрерывной интеграции (CI) можно использовать для автоматизации развертывания в тестовой среде, при возврате нового кода.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-125">For example, you can use project files in continuous integration (CI) scenarios to automate deployment to a test environment when new code is checked in.</span></span> <span data-ttu-id="e9ba4-126">Дополнительные сведения см. в разделе [Настройка Team Foundation Server для автоматического развертывания веб-](../configuring-team-foundation-server-for-web-deployment/configuring-team-foundation-server-for-web-deployment.md).</span><span class="sxs-lookup"><span data-stu-id="e9ba4-126">For more information, see [Configuring Team Foundation Server for Automated Web Deployment](../configuring-team-foundation-server-for-web-deployment/configuring-team-foundation-server-for-web-deployment.md).</span></span>


### <a name="project-file-naming-conventions"></a><span data-ttu-id="e9ba4-127">Файл проекта, соглашения об именовании</span><span class="sxs-lookup"><span data-stu-id="e9ba4-127">Project File Naming Conventions</span></span>

<span data-ttu-id="e9ba4-128">При создании файлов проекта, можно использовать любое расширение файла.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-128">When you create your own project files, you can use any file extension you like.</span></span> <span data-ttu-id="e9ba4-129">Тем не менее чтобы упростить свои решения для других пользователей понять, следует использовать эти общие соглашения:</span><span class="sxs-lookup"><span data-stu-id="e9ba4-129">However, to make your solutions easier for others to understand, you should use these common conventions:</span></span>

- <span data-ttu-id="e9ba4-130">Используйте расширение .proj при создании файла проекта, который выполняет сборку проектов.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-130">Use the .proj extension when you create a project file that builds projects.</span></span>
- <span data-ttu-id="e9ba4-131">Используйте расширение TARGETS, при создании многократно используемых проекта файл для импорта в другие файлы проекта.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-131">Use the .targets extension when you create a reusable project file to import into other project files.</span></span> <span data-ttu-id="e9ba4-132">Файлы с расширением TARGETS обычно не создавайте ничего себе, они просто содержат инструкции, которые можно импортировать в файлы .proj.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-132">Files with a .targets extension typically don't build anything themselves, they simply contain instructions that you can import into your .proj files.</span></span>

### <a name="integration-with-deployment-technologies"></a><span data-ttu-id="e9ba4-133">Интеграция с технологиями развертывания</span><span class="sxs-lookup"><span data-stu-id="e9ba4-133">Integration with Deployment Technologies</span></span>

<span data-ttu-id="e9ba4-134">Если вы работали с проектами веб-приложения в Visual Studio 2010, такие как веб-приложений ASP.NET и веб-приложений ASP.NET MVC, вы будете знать, что эти проекты содержат встроенную поддержку для упаковки и развертывания веб-приложения к целевой среде.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-134">If you've worked with web application projects in Visual Studio 2010, like ASP.NET web applications and ASP.NET MVC web applications, you'll know that these projects include built-in support for packaging and deploying the web application to a target environment.</span></span> <span data-ttu-id="e9ba4-135">**Свойства** страниц для этих проектов, включают **пакета и публикация веб-** и **упаковка и публикация SQL** вкладки, которые можно использовать для настройки как компоненты вашей приложения упаковываются и развертываются.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-135">The **Properties** pages for these projects include **Package/Publish Web** and **Package/Publish SQL** tabs that you can use to configure how the components of your application are packaged and deployed.</span></span> <span data-ttu-id="e9ba4-136">Это показывает **пакета и публикация веб-** вкладке:</span><span class="sxs-lookup"><span data-stu-id="e9ba4-136">This shows the **Package/Publish Web** tab:</span></span>

![](understanding-the-project-file/_static/image1.png)

<span data-ttu-id="e9ba4-137">Базовая технология за эти возможности, известен как Web Publishing конвейера (WPP).</span><span class="sxs-lookup"><span data-stu-id="e9ba4-137">The underlying technology behind these capabilities is known as the Web Publishing Pipeline (WPP).</span></span> <span data-ttu-id="e9ba4-138">WPP фактически переводит MSBuild и [веб-развертывания](https://go.microsoft.com/?linkid=9805122) друг с другом, чтобы предоставить полный процесс создания, упаковки и развертывания для веб-приложений.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-138">The WPP essentially brings MSBuild and [Web Deploy](https://go.microsoft.com/?linkid=9805122) together to provide a complete build, package, and deployment process for your web applications.</span></span>

<span data-ttu-id="e9ba4-139">Хорошо то, что можно воспользоваться преимуществами точек интеграции, предоставляемые WPP при создании пользовательского проекта файлы для веб-проектов.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-139">The good news is that you can take advantage of the integration points that the WPP provides when you create custom project files for web projects.</span></span> <span data-ttu-id="e9ba4-140">Инструкции по развертыванию можно включить в файле проекта, позволяющая выполнять построение проектов, создание веб-развертывания пакетов и установить эти пакеты на удаленных серверах через только одним файлом проекта и один вызов MSBuild.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-140">You can include deployment instructions in your project file, which allows you to build your projects, create web deployment packages, and install these packages on remote servers through a single project file and a single call to MSBuild.</span></span> <span data-ttu-id="e9ba4-141">Также можно вызвать другие исполняемые объекты как часть процесса сборки.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-141">You can also call any other executables as part of your build process.</span></span> <span data-ttu-id="e9ba4-142">Например можно запустить средство командной строки VSDBCMD.exe развертывание базы данных из файла схемы.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-142">For example, you can run the VSDBCMD.exe command-line tool to deploy a database from a schema file.</span></span> <span data-ttu-id="e9ba4-143">В ходе этой статьи вы узнаете, как можно воспользоваться преимуществами этих возможностей в соответствии с требованиями сценариев развертывания enterprise.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-143">Over the course of this topic, you'll see how you can take advantage of these capabilities to meet the requirements of your enterprise deployment scenarios.</span></span>

> [!NOTE]
> <span data-ttu-id="e9ba4-144">Дополнительные сведения о том, как работает процесс развертывания веб-приложений, см. в разделе [обзор ASP.NET веб-приложения проекта развертывания](https://msdn.microsoft.com/library/dd394698.aspx).</span><span class="sxs-lookup"><span data-stu-id="e9ba4-144">For more information on how the web application deployment process works, see [ASP.NET Web Application Project Deployment Overview](https://msdn.microsoft.com/library/dd394698.aspx).</span></span>


## <a name="the-anatomy-of-a-project-file"></a><span data-ttu-id="e9ba4-145">Анатомия файл проекта</span><span class="sxs-lookup"><span data-stu-id="e9ba4-145">The Anatomy of a Project File</span></span>

<span data-ttu-id="e9ba4-146">Прежде чем взглянуть на процесс построения более подробно, стоит уделить немного времени для ознакомления с базовая структура файла проекта MSBuild.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-146">Before you look at the build process in more detail, it's worth taking a few moments to familiarize yourself with the basic structure of an MSBuild project file.</span></span> <span data-ttu-id="e9ba4-147">Этот раздел содержит общие сведения о наиболее распространенных элементов, которые придется столкнуться при Просмотр, изменение или создание файла проекта.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-147">This section provides an overview of the more common elements that you'll encounter when you review, edit, or create a project file.</span></span> <span data-ttu-id="e9ba4-148">В частности вы узнаете следующее.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-148">In particular, you'll learn:</span></span>

- <span data-ttu-id="e9ba4-149">Как использовать *свойства* управления переменными для процесса сборки.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-149">How to use *properties* to manage variables for the build process.</span></span>
- <span data-ttu-id="e9ba4-150">Как использовать *элементы* для идентификации входных данных для процесса построения, такие как файлы кода.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-150">How to use *items* to identify the inputs to the build process, like code files.</span></span>
- <span data-ttu-id="e9ba4-151">Как использовать *целевых объектов* и *задачи* для обеспечения выполнения инструкций на MSBuild, с помощью *свойства* и *элементы* определен в другом месте файл проекта.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-151">How to use *targets* and *tasks* to provide execution instructions to MSBuild, using *properties* and *items* defined elsewhere in the project file.</span></span>

<span data-ttu-id="e9ba4-152">Это показана связь между ключевые элементы в файл проекта MSBuild:</span><span class="sxs-lookup"><span data-stu-id="e9ba4-152">This shows the relationship between the key elements in an MSBuild project file:</span></span>

![](understanding-the-project-file/_static/image2.png)

### <a name="the-project-element"></a><span data-ttu-id="e9ba4-153">Элемент проекта</span><span class="sxs-lookup"><span data-stu-id="e9ba4-153">The Project Element</span></span>

<span data-ttu-id="e9ba4-154">[Проекта](https://msdn.microsoft.com/library/bcxfsh87.aspx) элемент является корневым элементом файла каждого проекта.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-154">The [Project](https://msdn.microsoft.com/library/bcxfsh87.aspx) element is the root element of every project file.</span></span> <span data-ttu-id="e9ba4-155">Помимо определения схемы XML для файла проекта, **проекта** элемент может включать атрибуты для указания точки входа для процесса сборки.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-155">In addition to identifying the XML schema for the project file, the **Project** element can include attributes to specify the entry points for the build process.</span></span> <span data-ttu-id="e9ba4-156">Например, в [примера решения диспетчера контактов](the-contact-manager-solution.md), *Publish.proj* файл определяет, что сборки необходимо начать с вызова целевой объект, с именем **FullPublish**.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-156">For example, in the [Contact Manager sample solution](the-contact-manager-solution.md), the *Publish.proj* file specifies that the build should start by calling the target named **FullPublish**.</span></span>


[!code-xml[Main](understanding-the-project-file/samples/sample1.xml)]


### <a name="properties-and-conditions"></a><span data-ttu-id="e9ba4-157">Свойства и условия</span><span class="sxs-lookup"><span data-stu-id="e9ba4-157">Properties and Conditions</span></span>

<span data-ttu-id="e9ba4-158">Файл проекта обычно требуется представлено множество разные части сведений для успешной сборки и развертывания проектов.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-158">A project file typically needs to provide lots of different pieces of information in order to successfully build and deploy your projects.</span></span> <span data-ttu-id="e9ba4-159">Эти части информации может включать имена серверов, строки подключения, учетные данные, конфигурации построения, исходный и конечный пути к файлам и другие сведения, которые вы хотите включить для поддержки настройки.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-159">These pieces of information could include server names, connection strings, credentials, build configurations, source and destination file paths, and any other information you want to include to support customization.</span></span> <span data-ttu-id="e9ba4-160">В файле проекта, свойства должны быть определены в [PropertyGroup](https://msdn.microsoft.com/library/t4w159bs.aspx) элемент.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-160">In a project file, properties must be defined within a [PropertyGroup](https://msdn.microsoft.com/library/t4w159bs.aspx) element.</span></span> <span data-ttu-id="e9ba4-161">Свойства MSBuild состоят из пар "ключ значение".</span><span class="sxs-lookup"><span data-stu-id="e9ba4-161">MSBuild properties consist of key-value pairs.</span></span> <span data-ttu-id="e9ba4-162">В рамках **PropertyGroup** элемент, имя элемента определяет ключ свойства и содержимое элемента определяет значение свойства.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-162">Within the **PropertyGroup** element, the element name defines the property key and the content of the element defines the property value.</span></span> <span data-ttu-id="e9ba4-163">Например, можно определить свойства с именем **ServerName** и **ConnectionString** для хранения статических серверных имя и строку подключения.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-163">For example, you could define properties named **ServerName** and **ConnectionString** to store a static server name and connection string.</span></span>


[!code-xml[Main](understanding-the-project-file/samples/sample2.xml)]


<span data-ttu-id="e9ba4-164">Чтобы получить значение свойства, используйте формат \*\*$(***PropertyName***) \*\**.*</span><span class="sxs-lookup"><span data-stu-id="e9ba4-164">To retrieve a property value, you use the format \**$(***PropertyName***)\*\*\*.*</span></span> <span data-ttu-id="e9ba4-165">Например, чтобы получить значение **ServerName** свойство, введите:</span><span class="sxs-lookup"><span data-stu-id="e9ba4-165">For example, to retrieve the value of the **ServerName** property, you would type:</span></span>


[!code-powershell[Main](understanding-the-project-file/samples/sample3.ps1)]


> [!NOTE]
> <span data-ttu-id="e9ba4-166">Вы увидите примеры того, как и когда следует использовать значения свойств далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-166">You'll see examples of how and when to use property values later in this topic.</span></span>


<span data-ttu-id="e9ba4-167">Внедрение данных о как статические свойства в файле проекта не всегда является идеальной подход к управлению процесс сборки.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-167">Embedding information as static properties in a project file is not always the ideal approach to managing the build process.</span></span> <span data-ttu-id="e9ba4-168">В большинстве сценариев необходимо получить данные из других источников или расширить возможности пользователей для предоставления сведений из командной строки.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-168">In a lot of scenarios, you'll want to obtain the information from other sources or empower the user to provide the information from the command prompt.</span></span> <span data-ttu-id="e9ba4-169">MSBuild можно указать любое значение свойства в качестве параметра командной строки.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-169">MSBuild allows you to specify any property value as a command-line parameter.</span></span> <span data-ttu-id="e9ba4-170">Например, пользователь мог задать значение для **ServerName** при выполнении MSBuild.exe из командной строки.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-170">For example, the user could provide a value for **ServerName** when he or she runs MSBuild.exe from the command line.</span></span>


[!code-console[Main](understanding-the-project-file/samples/sample4.cmd)]


> [!NOTE]
> <span data-ttu-id="e9ba4-171">Дополнительные сведения о аргументы и параметры, которые можно использовать с помощью MSBuild.exe, см. в разделе [Справочник по командной строке MSBuild](https://msdn.microsoft.com/library/ms164311.aspx).</span><span class="sxs-lookup"><span data-stu-id="e9ba4-171">For more information on the arguments and switches you can use with MSBuild.exe, see [MSBuild Command Line Reference](https://msdn.microsoft.com/library/ms164311.aspx).</span></span>


<span data-ttu-id="e9ba4-172">Можно использовать один и тот же самый синтаксис свойства для получения значений переменных среды и свойства встроенных проекта.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-172">You can use the same property syntax to obtain the values of environment variables and built-in project properties.</span></span> <span data-ttu-id="e9ba4-173">Множество часто используемые свойства определяются автоматически, и можно использовать в файлах проекта, включая имена соответствующих параметров.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-173">Lots of commonly used properties are defined for you, and you can use them in your project files by including the relevant parameter name.</span></span> <span data-ttu-id="e9ba4-174">Например, для получения текущей платформы проекта&#x2014;к примеру, **x86** или **AnyCpu**&#x2014;можно включить **$(Platform)** ссылку на свойство в файл проекта.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-174">For example, to retrieve the current project platform&#x2014;for example, **x86** or **AnyCpu**&#x2014;you can include the **$(Platform)** property reference in your project file.</span></span> <span data-ttu-id="e9ba4-175">Дополнительные сведения см. в разделе [макросы для команд и свойств построения](https://msdn.microsoft.com/library/c02as0cs.aspx), [общие свойства проектов MSBuild](https://msdn.microsoft.com/library/bb629394.aspx), и [зарезервированные свойства](https://msdn.microsoft.com/library/ms164309.aspx).</span><span class="sxs-lookup"><span data-stu-id="e9ba4-175">For more information, see [Macros for Build Commands and Properties](https://msdn.microsoft.com/library/c02as0cs.aspx), [Common MSBuild Project Properties](https://msdn.microsoft.com/library/bb629394.aspx), and [Reserved Properties](https://msdn.microsoft.com/library/ms164309.aspx).</span></span>

<span data-ttu-id="e9ba4-176">Свойства часто используются в сочетании с *условия*.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-176">Properties are often used in conjunction with *conditions*.</span></span> <span data-ttu-id="e9ba4-177">Большинство элементов MSBuild поддерживают **условие** атрибут, который позволяет указать критерии, от которых MSBuild следует оценить элемента.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-177">Most MSBuild elements support the **Condition** attribute, which lets you specify the criteria upon which MSBuild should evaluate the element.</span></span> <span data-ttu-id="e9ba4-178">Например рассмотрим такое определение свойства:</span><span class="sxs-lookup"><span data-stu-id="e9ba4-178">For example, consider this property definition:</span></span>


[!code-xml[Main](understanding-the-project-file/samples/sample5.xml)]


<span data-ttu-id="e9ba4-179">Когда MSBuild обрабатывает такое определение свойства, он сначала проверяет ли **$(OutputRoot)** доступно значение свойства.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-179">When MSBuild processes this property definition, it first checks to see whether an **$(OutputRoot)** property value is available.</span></span> <span data-ttu-id="e9ba4-180">Если значение свойства пусто&#x2014;другими словами, пользователь еще не предоставил значение для этого свойства&#x2014;условие принимает значение **true** и присваивается значение свойства **... \Publish\Out**. Если пользователь предоставил значение для этого свойства, условие принимает значение **false** и статическим значением свойства не используется.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-180">If the property value is blank&#x2014;in other words, the user hasn't provided a value for this property&#x2014;the condition evaluates to **true** and the property value is set to **..\Publish\Out**. If the user has provided a value for this property, the condition evaluates to **false** and the static property value is not used.</span></span>

<span data-ttu-id="e9ba4-181">Дополнительные сведения о различных способах, в котором можно указать условия, см. в разделе [условия MSBuild](https://msdn.microsoft.com/library/7szfhaft.aspx).</span><span class="sxs-lookup"><span data-stu-id="e9ba4-181">For more information on the different ways in which you can specify conditions, see [MSBuild Conditions](https://msdn.microsoft.com/library/7szfhaft.aspx).</span></span>

### <a name="items-and-item-groups"></a><span data-ttu-id="e9ba4-182">Элементы и группы элементов</span><span class="sxs-lookup"><span data-stu-id="e9ba4-182">Items and Item Groups</span></span>

<span data-ttu-id="e9ba4-183">Одной из важных ролей файла проекта является определение входные данные для процесса построения.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-183">One of the important roles of the project file is to define the inputs to the build process.</span></span> <span data-ttu-id="e9ba4-184">Как правило, эти входные данные представляют собой файлы&#x2014;кода файлов, файлов конфигурации, командные файлы и другие файлы, которые необходимо обработать или сохранить как часть процесса построения.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-184">Typically, these inputs are files&#x2014;code files, configuration files, command files, and any other files that you need to process or copy as part of the build process.</span></span> <span data-ttu-id="e9ba4-185">В схеме проекта MSBuild эти входные данные представлены в виде [элемент](https://msdn.microsoft.com/library/ms164283.aspx) элементов.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-185">In the MSBuild project schema, these inputs are represented by [Item](https://msdn.microsoft.com/library/ms164283.aspx) elements.</span></span> <span data-ttu-id="e9ba4-186">В файле проекта, элементов должны быть определены в [ItemGroup](https://msdn.microsoft.com/library/646dk05y.aspx) элемент.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-186">In a project file, items must be defined within an [ItemGroup](https://msdn.microsoft.com/library/646dk05y.aspx) element.</span></span> <span data-ttu-id="e9ba4-187">Так же, как **свойство** элементов, можно назвать **элемента** элемент своему усмотрению.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-187">Just like **Property** elements, you can name an **Item** element however you like.</span></span> <span data-ttu-id="e9ba4-188">Тем не менее, необходимо указать **Include** атрибутом опознания файл или подстановочный знак, который представляет элемент.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-188">However, you must specify an **Include** attribute to identify the file or wildcard that the item represents.</span></span>


[!code-xml[Main](understanding-the-project-file/samples/sample6.xml)]


<span data-ttu-id="e9ba4-189">Путем указания нескольких **элемент** элементов с одинаковым именем, вы фактически создаете именованный список ресурсов.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-189">By specifying multiple **Item** elements with the same name, you're effectively creating a named list of resources.</span></span> <span data-ttu-id="e9ba4-190">Чтобы увидеть это в действии рекомендуется для просмотра внутри одного из файлов проекта, которые создает Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-190">A good way to see this in action is to take a look inside one of the project files that Visual Studio creates.</span></span> <span data-ttu-id="e9ba4-191">Например *ContactManager.Mvc.csproj* файл в примере решения содержит много групп элементов, каждый из которых несколько тем же названием **элемент** элементов.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-191">For example, the *ContactManager.Mvc.csproj* file in the sample solution includes a lot of item groups, each with several identically named **Item** elements.</span></span>


[!code-xml[Main](understanding-the-project-file/samples/sample7.xml)]


<span data-ttu-id="e9ba4-192">Таким образом, что в проекте рекомендует MSBuild для создания списков файлов, которые должны обрабатываться так же&#x2014; **ссылку** список включает сборки, которые должны быть выполнены для успешной сборки,  **Скомпилируйте** список включает файлы кода, которые должны быть скомпилированы, и **содержимого** список содержит ресурсы, которые должны быть скопированы без изменений.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-192">In this way, the project file is instructing MSBuild to construct lists of files that need to be processed in the same way&#x2014;the **Reference** list includes assemblies that must be in place for a successful build, the **Compile** list includes code files that must be compiled, and the **Content** list includes resources that must be copied unaltered.</span></span> <span data-ttu-id="e9ba4-193">Мы рассмотрим как ссылается на процесс построения и использует эти элементы ниже в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-193">We'll look at how the build process references and uses these items later in this topic.</span></span>

<span data-ttu-id="e9ba4-194">Можно также включить элементы элемента [ItemMetadata](https://msdn.microsoft.com/library/ms164284.aspx) дочерних элементов.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-194">Item elements can also include [ItemMetadata](https://msdn.microsoft.com/library/ms164284.aspx) child elements.</span></span> <span data-ttu-id="e9ba4-195">Эти определяемые пользователем пары "ключ значение" и по сути представляют свойства, относящиеся к этому элементу.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-195">These are user-defined key-value pairs and essentially represent properties that are specific to that item.</span></span> <span data-ttu-id="e9ba4-196">Например, много **компиляции** элементов в файле проекта включают **DependentUpon** дочерних элементов.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-196">For example, a lot of the **Compile** item elements in the project file include **DependentUpon** child elements.</span></span>


[!code-xml[Main](understanding-the-project-file/samples/sample8.xml)]


> [!NOTE]
> <span data-ttu-id="e9ba4-197">В дополнение к метаданные элементов, созданных пользователем все элементы назначаются различные общие метаданные при создании.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-197">In addition to user-created item metadata, all items are assigned various common metadata on creation.</span></span> <span data-ttu-id="e9ba4-198">Дополнительные сведения см. в разделе [Стандартные метаданные элементов](https://msdn.microsoft.com/library/ms164313.aspx).</span><span class="sxs-lookup"><span data-stu-id="e9ba4-198">For more information, see [Well-known Item Metadata](https://msdn.microsoft.com/library/ms164313.aspx).</span></span>


<span data-ttu-id="e9ba4-199">Можно создать **ItemGroup** элементы внутри корневого уровня **проекта** элемента или в пределах определенного **целевой** элементов.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-199">You can create **ItemGroup** elements within the root-level **Project** element or within specific **Target** elements.</span></span> <span data-ttu-id="e9ba4-200">**ItemGroup** элементы также поддерживают **условие** атрибуты, которые позволяют адаптировать входные данные для процесса сборки в соответствии с условиями, например конфигурации проекта или платформы.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-200">**ItemGroup** elements also support **Condition** attributes, which lets you tailor the inputs to the build process according to conditions like the project configuration or platform.</span></span>

### <a name="targets-and-tasks"></a><span data-ttu-id="e9ba4-201">Целевые объекты и задачи</span><span class="sxs-lookup"><span data-stu-id="e9ba4-201">Targets and Tasks</span></span>

<span data-ttu-id="e9ba4-202">В схеме MSBuild [задачи](https://msdn.microsoft.com/library/77f2hx1s.aspx) элемент представляет инструкции отдельной сборки (или задач).</span><span class="sxs-lookup"><span data-stu-id="e9ba4-202">In the MSBuild schema, a [Task](https://msdn.microsoft.com/library/77f2hx1s.aspx) element represents an individual build instruction (or task).</span></span> <span data-ttu-id="e9ba4-203">В состав MSBuild входит множество предопределенные задачи.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-203">MSBuild includes a multitude of predefined tasks.</span></span> <span data-ttu-id="e9ba4-204">Пример:</span><span class="sxs-lookup"><span data-stu-id="e9ba4-204">For example:</span></span>

- <span data-ttu-id="e9ba4-205">**Копирования** задача копирует файлы в новое расположение.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-205">The **Copy** task copies files to a new location.</span></span>
- <span data-ttu-id="e9ba4-206">**Csc** задача вызывает компилятор Visual C#.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-206">The **Csc** task invokes the Visual C# compiler.</span></span>
- <span data-ttu-id="e9ba4-207">**Vbc** задача вызывает компилятор Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-207">The **Vbc** task invokes the Visual Basic compiler.</span></span>
- <span data-ttu-id="e9ba4-208">**Exec** задача запускает указанную программу.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-208">The **Exec** task runs a specified program.</span></span>
- <span data-ttu-id="e9ba4-209">**Сообщение** задача записывает сообщение в средство ведения журнала.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-209">The **Message** task writes a message to a logger.</span></span>

> [!NOTE]
> <span data-ttu-id="e9ba4-210">Более подробные сведения о задачи, которые доступны без дополнительной настройки, см. в разделе [справочные сведения о задачах MSBuild](https://msdn.microsoft.com/library/7z253716.aspx).</span><span class="sxs-lookup"><span data-stu-id="e9ba4-210">For full details of the tasks that are available out of the box, see [MSBuild Task Reference](https://msdn.microsoft.com/library/7z253716.aspx).</span></span> <span data-ttu-id="e9ba4-211">Дополнительные сведения о задачах, включая создание собственных пользовательских задач см. в разделе [задачи MSBuild](https://msdn.microsoft.com/library/ms171466.aspx).</span><span class="sxs-lookup"><span data-stu-id="e9ba4-211">For more information on tasks, including how to create your own custom tasks, see [MSBuild Tasks](https://msdn.microsoft.com/library/ms171466.aspx).</span></span>


<span data-ttu-id="e9ba4-212">Задачи всегда должны содержаться в [целевой](https://msdn.microsoft.com/library/t50z2hka.aspx) элементов.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-212">Tasks must always be contained within [Target](https://msdn.microsoft.com/library/t50z2hka.aspx) elements.</span></span> <span data-ttu-id="e9ba4-213">Объект **целевой** элементом является набор одну или несколько задач, которые выполняются последовательно, а также файл проекта может содержать несколько целевых объектов.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-213">A **Target** element is a set of one or more tasks that are executed sequentially, and a project file can contain multiple targets.</span></span> <span data-ttu-id="e9ba4-214">Для выполнения задачи или набора задач следует вызывать целевой объект, содержащий их.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-214">When you want to run a task, or a set of tasks, you invoke the target that contains them.</span></span> <span data-ttu-id="e9ba4-215">Например предположим, что имеется файл простой проект, который записывает сообщение.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-215">For example, suppose you have a simple project file that logs a message.</span></span>


[!code-xml[Main](understanding-the-project-file/samples/sample9.xml)]


<span data-ttu-id="e9ba4-216">Целевой объект из командной строки, можно вызвать с помощью **/t** для указания целевой объект.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-216">You can invoke the target from the command line, by using the **/t** switch to specify the target.</span></span>


[!code-console[Main](understanding-the-project-file/samples/sample10.cmd)]


<span data-ttu-id="e9ba4-217">Кроме того, можно добавить **DefaultTargets** атрибут **проекта** элемент, чтобы указать целевые объекты, которые вы хотите вызвать.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-217">Alternatively, you can add a **DefaultTargets** attribute to the **Project** element, to specify the targets that you want to invoke.</span></span>


[!code-xml[Main](understanding-the-project-file/samples/sample11.xml)]


<span data-ttu-id="e9ba4-218">В этом случае нет необходимости указывать целевой объект из командной строки.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-218">In this case, you don't need to specify the target from the command line.</span></span> <span data-ttu-id="e9ba4-219">Можно просто указать файл проекта, и будет вызывать MSBuild **FullPublish** целевой для вас.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-219">You can simply specify the project file, and MSBuild will invoke the **FullPublish** target for you.</span></span>


[!code-console[Main](understanding-the-project-file/samples/sample12.cmd)]


<span data-ttu-id="e9ba4-220">Целевые объекты и задачи могут включать **условие** атрибуты.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-220">Both targets and tasks can include **Condition** attributes.</span></span> <span data-ttu-id="e9ba4-221">Таким образом вы можете исключить все целевые объекты или отдельные задачи, при соблюдении определенных условий.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-221">As such, you can choose to omit entire targets or individual tasks if certain conditions are met.</span></span>

<span data-ttu-id="e9ba4-222">Вообще говоря при создании полезных задач и целевых объектов, необходимо ссылаться на свойства и элементы, которые вы определили в другом месте в файле проекта:</span><span class="sxs-lookup"><span data-stu-id="e9ba4-222">Generally speaking, when you create useful tasks and targets, you'll need to refer to the properties and items that you've defined elsewhere in the project file:</span></span>

- <span data-ttu-id="e9ba4-223">Чтобы использовать значение свойства, введите **$(***PropertyName***)**, где *PropertyName* имя **свойство** элемента или имя параметр.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-223">To use a property value, type **$(***PropertyName***)**, where *PropertyName* is the name of the **Property** element or the name of the parameter.</span></span>
- <span data-ttu-id="e9ba4-224">Чтобы использовать элемент, введите **@(***ItemName***)**, где *ItemName* имя **элемента** элемент.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-224">To use an item, type **@(***ItemName***)**, where *ItemName* is the name of the **Item** element.</span></span>

> [!NOTE]
> <span data-ttu-id="e9ba4-225">Помните, что при создании нескольких элементов с одинаковым именем, вы создаете список.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-225">Remember that if you create multiple items with the same name, you're building a list.</span></span> <span data-ttu-id="e9ba4-226">Напротив, при создании нескольких свойств с одинаковым именем, последнее значение свойства, указываемые перезапишет любые предыдущие свойства с тем же именем&#x2014;свойство может содержать только одно значение.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-226">In contrast, if you create multiple properties with the same name, the last property value you provide will overwrite any previous properties with the same name&#x2014;a property can only contain a single value.</span></span>


<span data-ttu-id="e9ba4-227">Например, в *Publish.proj* файл в примере решения, взгляните на **BuildProjects** целевой объект.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-227">For example, in the *Publish.proj* file in the sample solution, take a look at the **BuildProjects** target.</span></span>


[!code-xml[Main](understanding-the-project-file/samples/sample13.xml)]


<span data-ttu-id="e9ba4-228">В этом примере вы можете наблюдать за следующие основные моменты:</span><span class="sxs-lookup"><span data-stu-id="e9ba4-228">In this sample, you can observe these key points:</span></span>

- <span data-ttu-id="e9ba4-229">Если **BuildingInTeamBuild** параметр задан и имеет значение **true**, ни одна из задач в этом целевом объекте будет выполняться.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-229">If the **BuildingInTeamBuild** parameter is specified and has a value of **true**, none of the tasks within this target will be executed.</span></span>
- <span data-ttu-id="e9ba4-230">Целевой объект содержит один экземпляр [MSBuild](https://msdn.microsoft.com/library/z7f65y0d.aspx) задачи.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-230">The target contains a single instance of the [MSBuild](https://msdn.microsoft.com/library/z7f65y0d.aspx) task.</span></span> <span data-ttu-id="e9ba4-231">Эта задача позволяет создавать другие проекты MSBuild.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-231">This task lets you build other MSBuild projects.</span></span>
- <span data-ttu-id="e9ba4-232">**ProjectsToBuild** элемент передается в задачу.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-232">The **ProjectsToBuild** item is passed to the task.</span></span> <span data-ttu-id="e9ba4-233">Этот элемент может представлять список файлов проекта или решения, все определенные по **ProjectsToBuild** элементы внутри группы элементов item.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-233">This item could represent a list of project or solution files, all defined by **ProjectsToBuild** item elements within an item group.</span></span> <span data-ttu-id="e9ba4-234">В этом случае **ProjectsToBuild** элемент ссылается на файл единое решение.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-234">In this case, the **ProjectsToBuild** item refers to a single solution file.</span></span>

    [!code-xml[Main](understanding-the-project-file/samples/sample14.xml)]
- <span data-ttu-id="e9ba4-235">Свойство значения, передаваемые **MSBuild** задач включают параметры с именем **OutputRoot** и **конфигурации**.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-235">The property values passed to the **MSBuild** task include parameters named **OutputRoot** and **Configuration**.</span></span> <span data-ttu-id="e9ba4-236">Они устанавливаются на значения параметров, если они указаны, или значения статического свойства, если они отсутствуют.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-236">These are set to parameter values if they are provided, or static property values if they are not.</span></span>

    [!code-xml[Main](understanding-the-project-file/samples/sample15.xml)]

<span data-ttu-id="e9ba4-237">Также можно увидеть, что **MSBuild** задача вызывает целевой объект с именем **построения**.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-237">You can also see that the **MSBuild** task invokes a target named **Build**.</span></span> <span data-ttu-id="e9ba4-238">Это один из нескольких встроенных целевых объектов, которые широко используются в файлах проектов Visual Studio, они также доступны вам в файлах проектов, например **построения**, **Очистить**, **Перестроить**, и **публикации**.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-238">This is one of several built-in targets that are widely used in Visual Studio project files and are available to you in your custom project files, like **Build**, **Clean**, **Rebuild**, and **Publish**.</span></span> <span data-ttu-id="e9ba4-239">Дополнительные сведения об использовании целевые объекты и задачи, чтобы контролировать процесс построения, а также о **MSBuild** задач в частности, далее в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-239">You'll learn more about using targets and tasks to control the build process, and about the **MSBuild** task in particular, later in this topic.</span></span>

> [!NOTE]
> <span data-ttu-id="e9ba4-240">Дополнительные сведения о целевых объектах см. в разделе [целевых объектов MSBuild](https://msdn.microsoft.com/library/ms171462.aspx).</span><span class="sxs-lookup"><span data-stu-id="e9ba4-240">For more information on targets, see [MSBuild Targets](https://msdn.microsoft.com/library/ms171462.aspx).</span></span>


## <a name="splitting-project-files-to-support-multiple-environments"></a><span data-ttu-id="e9ba4-241">Разбиение файлов проекта для поддержки нескольких сред</span><span class="sxs-lookup"><span data-stu-id="e9ba4-241">Splitting Project Files to Support Multiple Environments</span></span>

<span data-ttu-id="e9ba4-242">Предположим, что вы хотите иметь возможность развернуть решение для нескольких сред, таких как тестовые серверы, платформ промежуточной и рабочей среды.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-242">Suppose you want to be able to deploy a solution to multiple environments, like test servers, staging platforms, and production environments.</span></span> <span data-ttu-id="e9ba4-243">Конфигурация может сильно варьироваться между этими средами&#x2014;не только с точки зрения имена серверов, строки подключения и т. д., но также потенциально с точки зрения учетные данные, параметры безопасности и множество других факторов.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-243">The configuration may vary substantially between these environments&#x2014;not just in terms of server names, connection strings, and so on, but also potentially in terms of credentials, security settings, and lots of other factors.</span></span> <span data-ttu-id="e9ba4-244">Если вам нужно делать это регулярно, это действительно подходящим изменить несколько свойств в файле проекта, каждый раз при переключении целевой среды.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-244">If you need to do this regularly, it's not really expedient to edit multiple properties in your project file every time you switch the target environment.</span></span> <span data-ttu-id="e9ba4-245">И это идеальное решение, требуется бесконечный список значений свойств, чтобы указать для процесса сборки.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-245">Nor is it an ideal solution to require an endless list of property values to be provided to the build process.</span></span>

<span data-ttu-id="e9ba4-246">К счастью, есть альтернатива.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-246">Fortunately there is an alternative.</span></span> <span data-ttu-id="e9ba4-247">MSBuild позволяет разбить конфигурацию сборки в нескольких файлах проектов.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-247">MSBuild lets you split your build configuration across multiple project files.</span></span> <span data-ttu-id="e9ba4-248">Чтобы увидеть, как это работает, в примере решения, обратите внимание на два файла пользовательского проекта:</span><span class="sxs-lookup"><span data-stu-id="e9ba4-248">To see how this works, in the sample solution, notice that there are two custom project files:</span></span>

- <span data-ttu-id="e9ba4-249">*Publish.proj*, который содержит свойства, элементы, и целевых объектов, которые являются общими для всех сред.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-249">*Publish.proj*, which contains properties, items, and targets that are common to all environments.</span></span>
- <span data-ttu-id="e9ba4-250">*Env Dev.proj*, который содержит свойства, характерные для среды разработки.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-250">*Env-Dev.proj*, which contains properties that are specific to a developer environment.</span></span>

<span data-ttu-id="e9ba4-251">Обратите внимание, что *Publish.proj* файл включает [импорта](https://msdn.microsoft.com/library/92x05xfs.aspx) элемент непосредственно под открывающей **проекта** тега.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-251">Now notice that the *Publish.proj* file includes an [Import](https://msdn.microsoft.com/library/92x05xfs.aspx) element, immediately beneath the opening **Project** tag.</span></span>


[!code-xml[Main](understanding-the-project-file/samples/sample16.xml)]


<span data-ttu-id="e9ba4-252">**Импорта** элемент используется для импорта содержимого другого файла проекта MSBuild в файле проекта MSBuild.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-252">The **Import** element is used to import the contents of another MSBuild project file into the current MSBuild project file.</span></span> <span data-ttu-id="e9ba4-253">В этом случае **TargetEnvPropsFile** параметр предоставляет имя файла для импорта файла проекта.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-253">In this case, the **TargetEnvPropsFile** parameter provides the filename of the project file you want to import.</span></span> <span data-ttu-id="e9ba4-254">Можно предоставить значение для этого параметра при запуске MSBuild.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-254">You can provide a value for this parameter when you run MSBuild.</span></span>


[!code-console[Main](understanding-the-project-file/samples/sample17.cmd)]


<span data-ttu-id="e9ba4-255">Это фактически объединяет содержимое двух файлов в один файл проекта.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-255">This effectively merges the contents of the two files into a single project file.</span></span> <span data-ttu-id="e9ba4-256">При таком подходе можно создать один проект файл, содержащий конфигурацию универсальной построения и несколько файлов с дополнительными проект, содержащий свойства, относящиеся к среде.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-256">Using this approach, you can create one project file containing your universal build configuration and multiple supplementary project files containing environment-specific properties.</span></span> <span data-ttu-id="e9ba4-257">Таким образом просто выполнив команду с другое значение параметра позволяет развернуть решение в другой среде.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-257">As a result, simply running a command with a different parameter value lets you deploy your solution to a different environment.</span></span>

![](understanding-the-project-file/_static/image3.png)

<span data-ttu-id="e9ba4-258">Разделение файлы проекта в этом случае рекомендуется следовать.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-258">Splitting your project files in this way is a good practice to follow.</span></span> <span data-ttu-id="e9ba4-259">Она позволяет разработчикам для развертывания в нескольких средах, выполнив одну команду, избегая дублирование свойства универсальной сборки в нескольких файлах проектов.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-259">It allows developers to deploy to multiple environments by running a single command, while avoiding the duplication of universal build properties across multiple project files.</span></span>

> [!NOTE]
> <span data-ttu-id="e9ba4-260">Рекомендации по настройке файлы проекта для конкретной среды для серверных сред, см. в разделе [Настройка свойств развертывания для целевой среды](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md).</span><span class="sxs-lookup"><span data-stu-id="e9ba4-260">For guidance on how to customize the environment-specific project files for your own server environments, see [Configuring Deployment Properties for a Target Environment](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md).</span></span>


## <a name="conclusion"></a><span data-ttu-id="e9ba4-261">Заключение</span><span class="sxs-lookup"><span data-stu-id="e9ba4-261">Conclusion</span></span>

<span data-ttu-id="e9ba4-262">В этом разделе предоставляются общие сведения о файлах проекта MSBuild и описано, как можно создать собственные пользовательские файлы проекта для управления процессом построения.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-262">This topic provided a general introduction to MSBuild project files and explained how you can create your own custom project files to control the build process.</span></span> <span data-ttu-id="e9ba4-263">В нем появилась также концепция разделения файлы проекта на инструкциях по построению универсальной и свойства конкретной среды построения, для упрощения построения и развертывания проектов в несколько назначений.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-263">It also introduced the concept of splitting project files into universal build instructions and environment-specific build properties, to make it easy to build and deploy projects to multiple destinations.</span></span>

<span data-ttu-id="e9ba4-264">Следующий раздел, [основные сведения о процессе построения](understanding-the-build-process.md), предоставляет более полную информацию об использовании файлов проекта для построения элемента управления и развертывания посредством развертывания решения с реалистичные уровень сложности.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-264">The next topic, [Understanding the Build Process](understanding-the-build-process.md), provides more insight into how you can use project files to control build and deployment by walking you through the deployment of a solution with a realistic level of complexity.</span></span>

## <a name="further-reading"></a><span data-ttu-id="e9ba4-265">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="e9ba4-265">Further Reading</span></span>

<span data-ttu-id="e9ba4-266">Более подробное введение в файлы проекта и WPP, см. в разделе [Inside the Microsoft Build Engine: С помощью MSBuild и Team Foundation Build](http://amzn.com/0735645248) Саид Ибрагим Хашими и William Bartholomew, ISBN: 978-0-7356-4524-0.</span><span class="sxs-lookup"><span data-stu-id="e9ba4-266">For a more in-depth introduction to project files and the WPP, see [Inside the Microsoft Build Engine: Using MSBuild and Team Foundation Build](http://amzn.com/0735645248) by Sayed Ibrahim Hashimi and William Bartholomew, ISBN: 978-0-7356-4524-0.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="e9ba4-267">[Назад](setting-up-the-contact-manager-solution.md)
> [Вперед](understanding-the-build-process.md)</span><span class="sxs-lookup"><span data-stu-id="e9ba4-267">[Previous](setting-up-the-contact-manager-solution.md)
[Next](understanding-the-build-process.md)</span></span>
