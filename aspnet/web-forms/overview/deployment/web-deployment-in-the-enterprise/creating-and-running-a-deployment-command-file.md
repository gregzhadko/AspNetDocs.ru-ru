---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/creating-and-running-a-deployment-command-file
title: Файл команд, создание и запуск развертывания | Документация Майкрософт
author: jrjlee
description: В этом разделе описывается создание командный файл, который позволит выполнить развертывание с помощью файлов проекта Microsoft Build Engine (MSBuild) как один шаг, повторно...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: c61560e9-9f6c-4985-834a-08a3eabf9c3c
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/creating-and-running-a-deployment-command-file
msc.type: authoredcontent
ms.openlocfilehash: 121df7482f7cbd70b191e518bae791f0642ccc7c
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/01/2019
ms.locfileid: "57048341"
---
<a name="creating-and-running-a-deployment-command-file"></a>Создание и запуск командного файла развертывания
====================
по [Джейсон Lee](https://github.com/jrjlee)

[Загрузить PDF-файл](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> В этом разделе описывается создание командный файл, который позволит выполнить развертывание с помощью файлов проекта Microsoft Build Engine (MSBuild) как один шаг, повторяемый процесс.


Этот раздел является частью серии учебников, исходя из требования к развертыванию enterprise вымышленной компании Fabrikam, Inc. В этой серии руководств используется пример решения&#x2014; [Contact Manager](the-contact-manager-solution.md) решение&#x2014;для представления веб-приложения с более реалистичные уровень сложности, включая приложения ASP.NET MVC 3, Windows Communication Служба Foundation (WCF) и проект базы данных.

Метод развертывания в основе этих учебников основан на разбиение проекта файл подход, описанный в [основные сведения о процессе построения](understanding-the-build-process.md), в которой процесс построения управляется двумя файлы проекта&#x2014;один с Создание инструкции, которые применяются для каждой целевой среде и содержащего параметры построения и развертывания для конкретной среды. Во время сборки файл проекта для конкретной среды объединяется в файл проекта независимой от среды, чтобы полный набор инструкций построения.

## <a name="process-overview"></a>Общие сведения о процессе

В этом разделе вы узнаете, как создать и запустить командный файл, который использует эти файлы проекта для выполнения Повторяемое развертывание целевую среду. По сути, командный файл просто должен содержать команды MSBuild:

- Сообщает MSBuild о необходимости выполнения независимой от среды *Publish.proj* файла.
- Сообщает *Publish.proj* файл, файл, который содержит параметры проекта для конкретной среды и где ее найти.

## <a name="create-an-msbuild-command"></a>Создание команды MSBuild

Как описано в разделе [основные сведения о процессе построения](understanding-the-build-process.md), файле проекта для конкретной среды&#x2014;к примеру, *Env Dev.proj*&#x2014;предназначена для импорта в независимой от среды *Publish.proj* файл во время сборки. Вместе эти два файла предоставляют полный набор инструкций, которые задают MSBuild для построения и развертывания решения.

*Publish.proj* файле используется **импорта** элемент для импорта файла проекта для конкретной среды.


[!code-xml[Main](creating-and-running-a-deployment-command-file/samples/sample1.xml)]


Таким образом при использовании MSBuild.exe для создания и развертывания решения диспетчера контактов, вам потребуется:

- Проведение MSBuild.exe *Publish.proj* файла.
- Укажите расположение файла проекта для конкретной среды, указав параметр командной строки с именем **TargetEnvPropsFile**.

Для этого команду MSBuild должен выглядеть примерно следующим образом:


[!code-console[Main](creating-and-running-a-deployment-command-file/samples/sample2.cmd)]


Здесь это простое действие, чтобы переместить повторяемых и один шаг развертывания. Все, что нужно сделать — это добавить команду MSBuild CMD-файл. В решение диспетчера контактов, в папку публикации включает в себя файл с именем *Dev.cmd публикации* , именно это и делает.


[!code-console[Main](creating-and-running-a-deployment-command-file/samples/sample3.cmd)]


> [!NOTE]
> **/Fl** коммутатора MSBuild использует для создания файла журнала с именем *msbuild.log* в рабочем каталоге, в котором был вызван MSBuild.exe.


Для развертывания или повторного развертывания решения диспетчера контактов, все что нужно сделать выполнить *Dev.cmd публикации* файл. При запуске файла будет MSBuild:

- Построение всех проектов в решении.
- Создание развертывания веб-пакетов для проектов веб-приложений.
- Создание расширением DBSCHEMA и .deploymanifest файлов для проектов баз данных.
- Развертывание веб-пакеты на веб-сервер.
- Развертывание базы данных на сервер базы данных.

## <a name="run-the-deployment"></a>Выполните развертывание

При создании командного файла для целевой среды можно выполнить всего развертывания, просто запустив файл.

**Чтобы развернуть решение диспетчера контактов для тестовой среды**

1. На рабочей станции разработчика, откройте проводник Windows и перейдите к расположению *Dev.cmd публикации* файл.
2. Дважды щелкните файл, чтобы запустить его.
3. Если **открыть файл — предупреждение системы безопасности** появится диалоговое окно, нажмите кнопку **запуска**.
4. Если параметры конфигурации и тестовые серверы настроены правильно, окно командной строки будет отображаться **построение выполнено успешно** сообщение после завершения обработки файлов проекта MSBuild.

    ![](creating-and-running-a-deployment-command-file/_static/image1.png)
5. Если это первый раз, вы развернули решение в этой среде, необходимо добавить тест web server учетную запись компьютера для **db\_datawriter** и **db\_datareader**роли на **ContactManager** базы данных. Эта процедура описана в [Настройка сервера базы данных для развертывания веб-публикаций](../configuring-server-environments-for-web-deployment/configuring-a-database-server-for-web-deploy-publishing.md).

    > [!NOTE]
    > Необходимо назначить эти разрешения, при создании базы данных. По умолчанию, процесс построения не будет воссоздать базу данных при каждом развертывании&#x2014;вместо этого будет сравнить существующую базу данных и самой последней схемы и внесите только необходимые изменения. Таким образом следует только необходимо сопоставить указанные роли базы данных при первом развертывании решения.
6. Откройте Internet Explorer и перейдите к URL-адрес приложения диспетчера контактов (например, `http://testweb1:85/ContactManager/`).
7. Убедитесь, что приложение работает правильно, и вы можете добавить контакты.

    ![](creating-and-running-a-deployment-command-file/_static/image2.png)

## <a name="conclusion"></a>Заключение

Создав командный файл, содержащий инструкции MSBuild обеспечивает быстрый и простой способ создания и развертывания решений с несколькими проектами в среде определенное место назначения. Если вам нужно повторно развернуть решение в нескольких средах назначения, можно создать несколько командных файлов. В каждый командный файл команда MSBuild создаст один и тот же файл универсальный проект, но он укажет файл различных проекта для конкретной среды. Например командный файл для публикации для разработчика или тестовой среде может содержать эта команда MSBuild:


[!code-console[Main](creating-and-running-a-deployment-command-file/samples/sample4.cmd)]


Командный файл для публикации в промежуточной среде может содержать эта команда MSBuild:


[!code-console[Main](creating-and-running-a-deployment-command-file/samples/sample5.cmd)]


> [!NOTE]
> Рекомендации по настройке файлы проекта для конкретной среды для серверных сред, см. в разделе [настройки свойств развертывания для целевой среды](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md).


Можно также настроить процесс сборки для каждой среды путем переопределения свойств, а также другими параметрами в команде MSBuild. Дополнительные сведения см. в разделе [Справочник по командной строке MSBuild](https://msdn.microsoft.com/library/ms164311.aspx).

> [!div class="step-by-step"]
> [Назад](deploying-database-projects.md)
> [Вперед](manually-installing-web-packages.md)
