---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/deploying-web-packages
title: Развертывание веб-пакеты | Документация Майкрософт
author: jrjlee
description: В этом разделе описывается, как опубликовать веб-развертывания пакетов на удаленный сервер, используя средство Internet Information Services (IIS) веб-развертывания (Web...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: a5c5eed2-8683-40a5-a2e1-35c9f8d17c29
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/deploying-web-packages
msc.type: authoredcontent
ms.openlocfilehash: c42fa327c324ac2b721268c56782a24755ec7225
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59391070"
---
# <a name="deploying-web-packages"></a>Развертывание веб-пакетов

по [Джейсон Lee](https://github.com/jrjlee)

[Скачать PDF](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> В этом разделе описывается, как опубликовать веб-развертывания пакетов на удаленный сервер, используя средство Internet Information Services (IIS) веб-развертывания (Web Deploy) 2.0.
> 
> Существует два основных способа, в которых можно развернуть веб-пакета на удаленном сервере:
> 
> - Можно использовать программу командной строки MSDeploy.exe напрямую.
> - Можно запустить *.deploy.cmd [имя_проекта]* файл, который создает процесс сборки.
> 
> Конечным результатом является же независимо от того, какой подход использовать. По сути, все *. deploy.cmd* файл является запуск MSDeploy.exe с некоторых заранее определенных значений, чтобы не нужно предоставлять столько информации для развертывания пакета. Это упрощает процесс развертывания. С другой стороны непосредственно с помощью MSDeploy.exe предоставляет гораздо большую гибкость по точности, как развертывается пакет.
> 
> От подхода, используемого будет зависеть от различных факторов, включая степень контроля, требующим через процесс развертывания и ли целевой платформой является службу агента веб-развертывания удаленного или веб-развертывание обработчик. В этом разделе описывается использование каждого подхода и указано, каждый подход подходит.
> 
> Задачи и пошаговые руководства в этом разделе предполагается, что:
> 
> - Вы создали и упакованные веб-приложения, как описано в разделе [сборка и упаковка проектов веб-приложений](building-and-packaging-web-application-projects.md).
> - Вы изменили *SetParameters.xml* файл для предоставления правильных параметров для целевой среды, как описано в разделе [Настройка параметров для развертывания веб-пакета](configuring-parameters-for-web-package-deployment.md).


Запуск [*имя_проекта*]*. deploy.cmd* файл — это самый простой способ развернуть веб-пакет. В частности, с помощью *. deploy.cmd* файл обеспечивает следующие преимущества по сравнению с использованием MSDeploy.exe напрямую:

- Не нужно указать расположение пакета веб-развертывания&#x2014; *. deploy.cmd* файл уже знал о местонахождении.
- Не нужно указать расположение *SetParameters.xml* файл&#x2014; *. deploy.cmd* файл уже знал о местонахождении.
- Не требуется для указания источника и назначения поставщиков MSDeploy&#x2014; *. deploy.cmd* файл уже знает, какие значения следует использовать.
- Вам не нужно указывать параметры операции MSDeploy&#x2014; *. deploy.cmd* файла добавляет часто необходимые значения в команду MSDeploy.exe автоматически.

Прежде чем использовать *. deploy.cmd* файла развернуть веб-пакет, следует убедиться, что:

- *. Deploy.cmd* файла [*имя_проекта*]. *SetParameters.xml* файл и веб-пакета ([*имя_проекта*]. *ZIP*) находятся в той же папке.
- Веб-развертывание (MSDeploy.exe) устанавливается на компьютере под управлением *. deploy.cmd* файл.

*. Deploy.cmd* файл поддерживает различные параметры командной строки. При запуске файла из командной строки, это базовый синтаксис:


[!code-console[Main](deploying-web-packages/samples/sample1.cmd)]


Необходимо указать либо **/T** флаг или **/Y** флаг, указывающий, хотите ли вы выполнить пробный запуск или динамической развертывания соответственно (не используйте оба флага в одной команде). В таблице ниже показано назначение каждой из этих флагов.

| Flag | Описание |
| --- | --- |
| **/T** | Вызывает MSDeploy.exe с **whatif** флаг, указывающий пробного запуска. А не развертывать пакет, он создает отчет, что произойдет, если развертывание было выполнено пакета. |
| **/Y** | Вызывает MSDeploy.exe без **whatif** флаг. Эта команда разворачивает пакета на локальном компьютере или указанный конечный сервер. |
| **/M** | Указывает конечный сервер имя или URL-адрес службы. Дополнительные сведения о значениях, можно указать здесь, см. в разделе **вопросы конечной точки** этой статьи. Если опустить **/M** флаг, пакет будет развернут на локальном компьютере. |
| **/A** | Указывает тип проверки подлинности, который MSDeploy.exe следует использовать для выполнения развертывания. Возможные значения: **NTLM** и **основные**. Если опустить **/A** флаг, тип проверки подлинности по умолчанию используется **NTLM** для развертывания в службе веб-развертывание удаленный агент и **основные** для развертывания на веб-развертывания Обработчик. |
| **/U** | Указывает имя пользователя. Это применимо только в том случае, если вы используете обычную проверку подлинности. |
| **/P** | Задает пароль. Это применимо только в том случае, если вы используете обычную проверку подлинности. |
| **/L** | Указывает, что пакет должны развертываться для локального экземпляра IIS Express. |
| **/G** | Указывает, что пакет развертывается с помощью [параметр поставщика tempAgent](https://technet.microsoft.com/library/ee517345(WS.10).aspx). Если опустить **/G** флаг, используется значение по умолчанию **false**. |

> [!NOTE]
> Каждый раз, когда в процессе сборки создается веб-пакет, он также создает файл с именем *[имя_проекта] .deploy-readme.txt* это объясняет эти варианты развертывания.


Помимо эти флаги можно указать параметры операции веб-развертывания в качестве дополнительных *. deploy.cmd* параметров. Дополнительные параметры, указываемые просто передаются через базовой команды MSDeploy.exe. Дополнительные сведения об этих параметрах см. в разделе [веб-развертывание параметров операции](https://technet.microsoft.com/library/dd569089(WS.10).aspx).

Предположим, что вы хотите развернуть проект ContactManager.Mvc веб-приложения в тестовой среде, запустив *. deploy.cmd* файл. Среде тестирования настроен для использования службы веб-развертывание удаленный агент, как описано в разделе [Настройка веб-сервера для публикации веб-развертывания (удаленный агент)](../configuring-server-environments-for-web-deployment/configuring-a-web-server-for-web-deploy-publishing-remote-agent.md). Чтобы развернуть веб-приложения, необходимо выполнить следующие действия.

**Для развертывания веб-приложения с помощью. файл deploy.cmd**

1. Собрать и упаковать проект веб-приложения, как описано в разделе [сборка и упаковка проектов веб-приложений](building-and-packaging-web-application-projects.md).
2. Изменить *ContactManager.Mvc.SetParameters.xml* файл должен содержать правильные значения параметров для тестовой среды, как описано в разделе [Настройка параметров для развертывания веб-пакета](configuring-parameters-for-web-package-deployment.md).
3. Откройте окно командной строки и перейдите к расположению *ContactManager.Mvc.deploy.cmd* файла.
4. Введите следующую команду и нажмите клавишу ВВОД:

    [!code-console[Main](deploying-web-packages/samples/sample2.cmd)]

В этом примере:

- **/Y** флаг указывает, что требуется фактическое развертывание пакета, а не выполнить это на пробную версию.
- **/M** флаг указывает, что вы хотите развернуть пакет на сервере с именем TESTWEB1. Из этого значения MSDeploy.exe попытается развернуть пакет на службу агента веб-развертывания удаленного http://TESTWEB1/MSDeployAgentService.
- **/A** флаг указывает, что вы хотите использовать проверку подлинности NTLM. Таким образом нет необходимости указывать имя пользователя и пароль.

Чтобы проиллюстрировать как с помощью *. deploy.cmd* файлов упрощает процесс развертывания, взгляните на MSDeploy.exe команду, которая получает создаваться и выполняться при запуске *ContactManager.Mvc.deploy.cmd* Использование параметров, показанный выше.


[!code-console[Main](deploying-web-packages/samples/sample3.cmd)]


Дополнительные сведения об использовании *. deploy.cmd* файл, чтобы развернуть веб-пакет, см. в разделе [как: Установка пакета развертывания с помощью файла deploy.cmd](https://msdn.microsoft.com/library/ff356104.aspx).

## <a name="using-msdeployexe"></a>С помощью MSDeploy.exe

Несмотря на то, что с помощью *. deploy.cmd* файла, как правило, упрощает процесс развертывания, существуют ситуации, когда лучше использовать MSDeploy.exe напрямую. Пример:

- Если вы хотите выполнить развертывание для веб-развертывание обработчик как пользователь без прав администратора, нельзя использовать *. deploy.cmd* файл. Это происходит из-за ошибки в Web Deploy 2.0, как описано в разделе **вопросы конечной точки**.
- Если вы хотите вручную переключиться между различными *SetParameters.xml* файлы в разных расположениях, можно напрямую использовать MSDeploy.exe.
- Если вы хотите переопределить несколько MSDeploy.exe командной строки, можно напрямую использовать MSDeploy.exe.

При использовании MSDeploy.exe, необходимо предоставить три ключевых элемента информации:

- Объект **— источник** параметр, указывающий, откуда поступают данные.
- Объект **— dest** параметр, указывающий, где будет ваши данные.
- Объект **— команда** параметр, указывающий [операции](https://technet.microsoft.com/library/dd568989(WS.10).aspx) вы хотите выполнить.

Использует MSDeploy.exe [поставщиков веб-развертывания](https://technet.microsoft.com/library/dd569040(WS.10).aspx) для обработки данных источника и назначения. Веб-развертывание включает в себя много поставщиков, представляющих спектр приложений и данных источников, он может работать с&#x2014;например, существуют поставщики для баз данных SQL Server, веб-серверы IIS, сертификаты, глобальный кэш СБОРОК сборки, различные различные файлы конфигурации и множество других типов данных. Оба **— источник** параметр и **— dest** параметра необходимо указать поставщика, в форме **— источник**: [*providerName*] = [*расположение*]. При развертывании веб-пакета на веб-сайте IIS, следует использовать эти значения:

- **— Источник** поставщик всегда является [пакета](https://technet.microsoft.com/library/dd569019(WS.10).aspx). Пример:

    [!code-console[Main](deploying-web-packages/samples/sample4.cmd)]
- **— Dest** поставщик всегда является [автоматически](https://technet.microsoft.com/library/dd569016(WS.10).aspx). Пример:

    [!code-console[Main](deploying-web-packages/samples/sample5.cmd)]
- **— Команда** всегда **синхронизации**.

    [!code-console[Main](deploying-web-packages/samples/sample6.cmd)]

Кроме того, вам потребуется указать различные другие [параметры поставщика](https://technet.microsoft.com/library/dd569001(WS.10).aspx) и Общие [параметров работы](https://technet.microsoft.com/library/dd569089(WS.10).aspx). Например предположим, что вы хотите развернуть ContactManager.Mvc веб-приложения в промежуточной среде. Развертывание ориентированы и на веб-развертывание обработчик и необходимо использовать обычную проверку подлинности. Чтобы развернуть веб-приложения, необходимо выполнить следующие действия.

**Для развертывания веб-приложение, использующее MSDeploy.exe**

1. Собрать и упаковать проект веб-приложения, как описано в разделе [сборка и упаковка проектов веб-приложений](building-and-packaging-web-application-projects.md).
2. Изменить *ContactManager.Mvc.SetParameters.xml* файл должен содержать правильные значения параметров для промежуточной среды, как описано в разделе [Настройка параметров для развертывания веб-пакета](configuring-parameters-for-web-package-deployment.md).
3. Откройте окно командной строки и перейдите к расположению MSDeploy.exe. Обычно это в %PROGRAMFILES%\IIS\Microsoft V2\msdeploy.exe развертывание Web.
4. Введите следующую команду и нажмите клавишу ВВОД (игнорировать разрывов строки):

    [!code-console[Main](deploying-web-packages/samples/sample7.cmd)]

В этом примере:

- **— Источник** параметр указывает **пакета** поставщика и указывает на расположение веб-пакета.
- **— Dest** параметр указывает **автоматически** поставщика. **ComputerName** параметр предоставляет URL-адрес службы обработчика Web развертывание на целевом сервере. **Authtype** параметр указывает, что вы хотите использовать обычную проверку подлинности, и таким образом, вам нужно предоставить **username** и **пароль**. Наконец **includeAcls = «ЛОЖЬ»** параметр указывает, что вы не хотите копировать списки управления доступом (ACL) файлов в веб-приложении исходного на конечный сервер.
- **– Verb: синхронизация** аргумент указывает, что вы хотите реплицировать исходное содержимое на целевом сервере.
- **-DisableLink** аргументы указывают, что вы не хотите реплицировать пулов приложений, виртуальный каталог конфигурации или сертификатов Secure Sockets Layer (SSL) на целевом сервере. Дополнительные сведения см. в разделе [веб-развертывание расширения ссылку](https://technet.microsoft.com/library/dd569028(WS.10).aspx).
- **— SetParamFile** параметр предоставляет расположение *SetParameters.xml* файл.
- **– AllowUntrusted** указывает, что веб-развертывания должны принимать SSL-сертификаты, которые не был выдан доверенным центром сертификации. Если вы развертываете в веб-развертывание обработчик, и вы использовали самозаверяющий сертификат для защиты URL-адрес службы, необходимо включить этот параметр.

## <a name="automating-web-package-deployment"></a>Автоматизация развертывания веб-пакета

В большинстве корпоративных сценариев нужно будет развернуть вашего веб-пакеты как часть большего размера один шаг или автоматического развертывания. Независимо от того, выбран для развертывания вашего веб-пакеты, выполнив *. deploy.cmd* файл или напрямую с помощью MSDeploy.exe, можно параметризовать применяемые команды и их вызова из целевого объекта в "Microsoft Build Engine" (MSBuild) файл проекта.

В примере решения диспетчера контактов, взгляните на **PublishWebPackages** target в *Publish.proj* файла. Этот целевой объект выполняется один раз для каждого *. deploy.cmd* файл, определенный список элементов с именем **PublishPackages**. Для формирования полного набора значений аргументов для каждой целевой объект использует свойства и метаданные элементов *. deploy.cmd* файл, а затем используется **Exec** задачи для выполнения команды.


[!code-xml[Main](deploying-web-packages/samples/sample8.xml)]


> [!NOTE]
> Более широкий обзор модели файл проекта в решении и введение к файлам пользовательского проекта в целом, см. в разделе [основные сведения о файле проекта](understanding-the-project-file.md) и [основные сведения о процессе построения](understanding-the-build-process.md).


## <a name="endpoint-considerations"></a>Рекомендации по конечной точки

Независимо от того, где развернут веб-пакет, выполнив *. deploy.cmd* файл или напрямую с помощью MSDeploy.exe, необходимо указать имя компьютера или конечной точки службы для развертывания.

Если целевой веб-сервер настроен для развертывания, с помощью службы веб-развертывание удаленного агента, укажите URL-адрес целевой службы в качестве места назначения.


[!code-console[Main](deploying-web-packages/samples/sample9.cmd)]


Кроме того можно указать только имя сервера как места назначения и веб-развертывания определяет URL-адрес службы удаленного агента.


[!code-console[Main](deploying-web-packages/samples/sample10.cmd)]


Если целевой веб-сервер настроен для развертывания с помощью веб-развертывание обработчик, необходимо указать адрес конечной точки службы IIS веб-управления (WMSvc) в качестве места назначения. По умолчанию это принимает форму:


[!code-console[Main](deploying-web-packages/samples/sample11.cmd)]


Можно выбрать любой из этих конечных точек, с помощью *. deploy.cmd* файл или напрямую MSDeploy.exe. Тем не менее если вы хотите развернуть на веб-развертывание обработчик как пользователь без прав администратора, как описано в разделе [Настройка веб-сервера для публикации веб-развертывания (веб-развертывание обработчик)](../configuring-server-environments-for-web-deployment/configuring-a-web-server-for-web-deploy-publishing-web-deploy-handler.md), необходимо добавить строку запроса с адресом конечной точки службы.


[!code-console[Main](deploying-web-packages/samples/sample12.cmd)]


Это так, как пользователь без прав администратора не имеет доступа на уровне сервера в IIS; он имеет доступ только к определенной веб-сайта IIS. На момент написания статьи, из-за ошибки в Web Publishing конвейера (WPP), нельзя запустить *. deploy.cmd* файл, используя адрес конечной точки, который включает строку запроса. В этом случае необходимо выполнить развертывание веб-пакет напрямую с помощью MSDeploy.exe.

> [!NOTE]
> Дополнительные сведения о службе веб-развертывание удаленного агента и веб-развертывание обработчик, см. в разделе [Выбор оптимального подхода для веб-развертывания справа](../configuring-server-environments-for-web-deployment/choosing-the-right-approach-to-web-deployment.md). Рекомендации по настройке развертывания для этих конечных точек файлов проекта для конкретной среды, см. в разделе [настройки свойств развертывания для целевой среды](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md).


## <a name="authentication-considerations"></a>Вопросы проверки подлинности

Независимо от того, где развернут веб-пакет, выполнив *. deploy.cmd* файл или напрямую с помощью MSDeploy.exe, необходимо указать тип проверки подлинности. Веб-развертывание принимает два возможных значения: **NTLM** или **основные**. При указании обычной проверки подлинности, необходимо также указать имя пользователя и пароль. Существуют различные факторы, которые необходимо учитывать при выборе типа проверки подлинности:

- Если вы развертываете службу агента веб-развертывания удаленного, необходимо использовать проверку подлинности NTLM. Служба удаленного агента не принимает учетные данные обычной проверки подлинности.
- Если вы развертываете в веб-развертывание обработчик, можно использовать NTLM или обычную проверку подлинности. Значение по умолчанию — Обычная проверка подлинности. Несмотря на то, что Обычная проверка подлинности зависит от того, имена пользователей и пароли, передаваемые в виде обычного текста, учетные данные защищены, как веб-развертывание обработчик всегда использует SSL-шифрования.
- Если веб-пакет включает в себя базу данных и веб-сервер и сервер базы данных находятся в разных компьютерах, вы не сможете развернуть базу данных с использованием проверки подлинности NTLM из-за [ограничение «двойного прыжка» NTLM](https://go.microsoft.com/?linkid=9805120). Необходимо использовать учетные данные SQL Server в строке подключения развертывания или ввести учетные данные обычной проверки подлинности для веб-развертывания. Эта проблема описана более подробно в [развертывание баз данных членства в корпоративных средах](../advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments.md).

## <a name="conclusion"></a>Заключение

В этом разделе описано, как развернуть веб-пакета либо путем выполнения *. deploy.cmd* файл или напрямую с помощью MSDeploy.exe. Оно описывает, когда каждый подход может подойти и оно описано, как можно параметризовать и выполнить команду развертывания как часть большего процесса одношаговой или автоматического построения.

## <a name="further-reading"></a>Дополнительные сведения

Рекомендации о способах создания и параметризовать пакет веб-развертывания, см. в разделе [сборка и упаковка проектов веб-приложений](building-and-packaging-web-application-projects.md) и [Настройка параметров для развертывания веб-пакета](configuring-parameters-for-web-package-deployment.md). Руководство по для создания и развертывания веб-пакеты из экземпляра Team Foundation Server (TFS), см. в разделе [Настройка Team Foundation Server для автоматического развертывания веб-](../configuring-team-foundation-server-for-web-deployment/configuring-team-foundation-server-for-web-deployment.md). Сведения о том, как настроить и устранение неполадок процесса развертывания, см. в разделе [за исключением файлов и папок из развертывания](../advanced-enterprise-web-deployment/excluding-files-and-folders-from-deployment.md).

> [!div class="step-by-step"]
> [Назад](configuring-parameters-for-web-package-deployment.md)
> [Вперед](deploying-database-projects.md)
