---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/building-and-packaging-web-application-projects
title: Сборка и упаковка проектов веб-приложений | Документация Майкрософт
author: jrjlee
description: Если требуется развернуть проект веб-приложения в среде удаленного сервера, то сначала нужно создать проект и создать пакет веб-развертывания...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 94e92f80-a7e3-4d18-9375-ff8be5d666ac
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/building-and-packaging-web-application-projects
msc.type: authoredcontent
ms.openlocfilehash: 1d0ee0264ce6461d7b0159f1a44de4de31e2d079
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78463230"
---
# <a name="building-and-packaging-web-application-projects"></a>Сборка и упаковка проектов веб-приложений

кто [Джейсон Иванов](https://github.com/jrjlee)

[Скачать в формате PDF](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> Если требуется развернуть проект веб-приложения в среде удаленного сервера, то сначала нужно создать проект и создать пакет веб-развертывания. В этом разделе описывается работа процесса сборки для проектов веб-приложений. В частности, это объясняется:
> 
> - Как конвейер веб-публикаций (WPP) расширяет процесс сборки для включения функций развертывания.
> - Как средство веб-развертывания службы IIS (IIS) (веб-развертывание) преобразует веб-приложение в пакет развертывания.
> - Как работает процесс сборки и упаковки и какие файлы создаются.

В Visual Studio 2010 процесс сборки и развертывания для проектов веб-приложений поддерживается в КОНВЕЙЕРе. Конвейер WPP предоставляет набор целевых объектов Microsoft Build Engine (MSBuild), расширяющих функциональные возможности MSBuild и позволяющий интегрировать его с веб-развертывание. В Visual Studio эти расширенные функции можно увидеть на страницах свойств проекта веб-приложения. **Веб-страница Упаковка и публикация** , а также страница **Пакет/Публикация SQL** позволяют настроить упаковку проекта веб-приложения для развертывания после завершения процесса сборки.

![](building-and-packaging-web-application-projects/_static/image1.png)

## <a name="how-does-the-wpp-work"></a>Как работает конвейер WPP?

Если взглянуть на файл проекта для C#проекта веб-приложения на основе, можно увидеть, что он импортирует два TARGETS-файла.

[!code-xml[Main](building-and-packaging-web-application-projects/samples/sample1.xml)]

Первый оператор **импорта** является общим для всех визуальных C# проектов. Этот файл, *Microsoft. CSharp. targets*, содержит целевые объекты и задачи, относящиеся C#к визуальному элементу. Например, здесь вызывается задача C# компилятора (**Csc**). Файл *Microsoft. CSharp. targets* , в свою очередь, импортирует файл *Microsoft. Common. targets* . Это определяет целевые объекты, общие для всех проектов, такие как **Сборка**, **Перестроение**, **Запуск**, **Компиляция**и **Очистка**. Второй оператор **импорта** относится только к проектам веб-приложений. Файл *Microsoft. веб-приложение. targets* , в свою очередь, импортирует файл *Microsoft. Web. Publishing. targets* . Файл *Microsoft. Web. Publishing. targets* по сути *является* конвейером WPP. Он определяет целевые объекты, такие как **Package** и **мсдеплойпублиш**, которые вызывают веб-развертывание для выполнения различных задач развертывания.

Чтобы понять, как используются эти дополнительные целевые объекты, в образце решения диспетчера контактов откройте файл *Publish. proj* и взгляните на целевой объект **буилдпрожектс** .

[!code-xml[Main](building-and-packaging-web-application-projects/samples/sample2.xml)]

Этот целевой объект использует задачу **MSBuild** для построения различных проектов. Обратите внимание на свойства **деплойонбуилд** и **деплойтаржет** :

- Свойство **деплойонбуилд = true** , по сути, означает, что я хочу выполнить дополнительный целевой объект после успешного завершения сборки.
- Свойство **деплойтаржет** определяет имя целевого объекта, который необходимо выполнить, если свойство **деплойонбуилд** равно **true**. В этом случае вы указываете, что MSBuild должен выполнить целевой объект **пакета** после сборки проекта.

Целевой объект **пакета** определен в файле *Microsoft. Web. Publishing. targets* . По сути, этот целевой объект принимает выходные данные сборки проекта веб-приложения и превращает его в пакет веб-развертывания, который может быть опубликован на веб-сервере IIS.

> [!NOTE]
> Чтобы просмотреть файл проекта (например, <em>ContactManager. MVC. csproj</em>) в Visual Studio 2010, сначала необходимо выгрузить проект из решения. В окне <strong>Обозреватель решений</strong> щелкните правой кнопкой мыши узел проекта и выберите команду <strong>Выгрузить проект</strong>. Снова щелкните правой кнопкой мыши узел проекта и выберите пункт <strong>изменить</strong><em>[файл проекта]</em>). Файл проекта откроется в его необработанном формате XML. Не забудьте перезагрузить проект после завершения.  
> Дополнительные сведения о целевых объектах MSBuild, задачах и инструкциях <strong>импорта</strong> см. [в разделе Основные сведения о файле проекта](understanding-the-project-file.md). Более подробные сведения о файлах проекта и конвейере WPP см. в разделе [Microsoft Build Engine: использование MSBuild и Team Foundation Build](http://amzn.com/0735645248) by Саид Ибрагим Хашими and Уильям БАРСОЛОМЕВ, ISBN: 978-0-7356-4524-0.

## <a name="what-is-a-web-deployment-package"></a>Что такое пакет веб-развертывания?

При сборке и развертывании проекта веб-приложения с помощью Visual Studio 2010 или непосредственно с помощью MSBuild конечный результат обычно является *пакетом веб-развертывания*. Пакет веб-развертывания — это файл ZIP. Он содержит все, что требуется IIS и веб-развертывание для повторного создания веб-приложения, в том числе:

- Скомпилированные выходные данные веб-приложения, включая содержимое, файлы ресурсов, файлы конфигурации, сценарии JavaScript и каскадные таблицы стилей (CSS) и т. д.
- Сборки для проекта веб-приложения и для всех проектов, на которые имеются ссылки в решении.
- Скрипты SQL для создания любых баз данных, развертываемых с веб-приложением.

После создания пакета веб-развертывания его можно опубликовать на веб-сервере IIS различными способами. Например, можно развернуть его удаленно, нажимая на службу веб-развертывание Remote Agent или обработчик веб-развертывание на целевом веб-сервере. также можно использовать диспетчер служб IIS для импорта пакета на целевой веб-сервер вручную. Дополнительные сведения об этих подходах к развертыванию см. [в разделе Выбор правильного подхода к веб-развертыванию](../configuring-server-environments-for-web-deployment/choosing-the-right-approach-to-web-deployment.md).

## <a name="how-does-the-build-process-work"></a>Как работает процесс сборки?

Это показывает, что происходит при сборке и упаковке проекта веб-приложения:

![](building-and-packaging-web-application-projects/_static/image2.png)

При построении проекта веб-приложения в процессе сборки создается файл с именем *[имя проекта]. Саурцеманифест. XML*. Вместе с файлом проекта и выходными данными сборки это *. Файл Саурцеманифест. XML* сообщает веб-развертывание, что он должен включать в пакет веб-развертывания. Используя эти входные данные, веб-развертывание создает пакет веб-развертывания с именем *[имя проекта]. zip*.

Вместе с пакетом веб-развертывания процесс сборки создает два файла, которые могут помочь в использовании пакета:

- Файл *. deploy. cmd* включает набор параметризованных команд веб-развертывание (msdeploy. exe), которые публикуют пакет веб-развертывания на удаленном веб-сервере IIS. Выполнение файла *. deploy. cmd* с соответствующими параметрами обычно обеспечивает более быструю и удобную процедуру ручного самостоятельного создания команд msdeploy. exe.
- Файл *SetParameters. XML* предоставляет набор значений параметров для команды msdeploy. exe. Эти значения включают в себя такие свойства, как имя веб-приложения IIS, в котором требуется развернуть пакет, значения всех конечных точек служб и строк подключения, определенных в файле *Web. config* , и все значения свойств развертывания, определенные на страницах свойств проекта.

Файл *SetParameters. XML* является ключевым для управления процессом развертывания. Этот файл создается динамически в соответствии с содержимым проекта веб-приложения. Например, при добавлении строки подключения в файл *Web. config* процесс сборки автоматически обнаружит строку подключения, параметризовать развертывание соответствующим образом и создаст запись в файле *SetParameters. XML* , чтобы разрешить изменение строки подключения в процессе развертывания. Следующий раздел, [Настройка параметров для развертывания веб-пакетов](configuring-parameters-for-web-package-deployment.md), более подробно описывает роль этого файла и описывает различные способы его изменения во время сборки и развертывания.

> [!NOTE]
> В Visual Studio 2010 конвейер WPP не поддерживает предварительную компиляцию страниц в веб-приложении до упаковки. В следующей версии Visual Studio и WPP будет включена возможность предварительной компиляции веб-приложения в качестве варианта упаковки.

## <a name="conclusion"></a>Заключение

В этом разделе приводятся общие сведения о процессе сборки и упаковки для проектов веб-приложений в Visual Studio 2010. В нем описано, как конвейер WPP позволяет вызывать команды веб-развертывание из MSBuild, а также объясняет, как работает процесс сборки и упаковки.

После создания пакета веб-развертывания вы должны развернуть его следующим шагом. Дополнительные сведения см. в разделе [Настройка параметров для развертывания веб-пакетов](configuring-parameters-for-web-package-deployment.md) и [Развертывание веб-пакетов](deploying-web-packages.md).

## <a name="further-reading"></a>Дополнительные материалы

Следующие подразделы этого руководства, [Настройка параметров для развертывания веб-](configuring-parameters-for-web-package-deployment.md) пакетов и [развертывания веб-пакетов](deploying-web-packages.md), предоставляют рекомендации по использованию созданного веб-пакета. В последнем руководстве, посвященном этой серии, [расширенное веб-развертывание предприятия](../advanced-enterprise-web-deployment/advanced-enterprise-web-deployment.md), приводятся рекомендации по настройке и устранению неполадок в процессе упаковки.

Более подробные сведения о файлах проекта и конвейере WPP см. в разделе [Microsoft Build Engine: использование MSBuild и Team Foundation Build](http://amzn.com/0735645248) by Саид Ибрагим Хашими and Уильям БАРСОЛОМЕВ, ISBN: 978-0-7356-4524-0.

> [!div class="step-by-step"]
> [Назад](understanding-the-build-process.md)
> [Вперед](configuring-parameters-for-web-package-deployment.md)
