---
uid: web-forms/overview/deployment/configuring-server-environments-for-web-deployment/creating-a-server-farm-with-the-web-farm-framework
title: Создание фермы серверов с помощью Web Farm Framework | Документация Майкрософт
author: jrjlee
description: В этом разделе описывается использование веб-фермы (WFF) 2.0 для создания и настройки фермы веб-серверов из коллекции серверов.
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 656dd06d-806c-467c-863d-9fc45e5ba3ab
msc.legacyurl: /web-forms/overview/deployment/configuring-server-environments-for-web-deployment/creating-a-server-farm-with-the-web-farm-framework
msc.type: authoredcontent
ms.openlocfilehash: 19c061e83257e118aee74c9373a627b8c56defe3
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59421242"
---
# <a name="creating-a-server-farm-with-the-web-farm-framework"></a>Создание фермы серверов с помощью Web Farm Framework

по [Джейсон Lee](https://github.com/jrjlee)

[Скачать PDF](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> В этом разделе описывается использование веб-фермы (WFF) 2.0 для создания и настройки фермы веб-серверов из коллекции серверов.


WFF позволяет синхронизировать нескольких с балансировкой нагрузки веб-серверов веб-платформы продуктов и компонентов, веб-приложений, веб-сайтов и параметров конфигурации. В сценариях, где требуется более одного веб-сервера, например промежуточной и рабочей сред это позволяет значительно упростить процесс развертывания и конфигурации. Можно развернуть веб-приложения к одному серверу&#x2014; *сервера-источника*&#x2014;и WFF автоматически реплицирует этого веб-приложения на все другие серверы в ферме серверов.

## <a name="understanding-the-web-farm-framework"></a>Основные сведения о Web Farm Framework

WFF 2.0 можно использовать для подготовки, управления и развертывания содержимого в группу веб-серверов. Развертывание WFF состоит из трех ключевых ролей серверов:

- *Сервера контроллера*. Использовать этот сервер для создания и настройки фермы серверов WFF. Сервер контроллера управляет синхронизацией платформы веб-компоненты, параметры конфигурации и приложений между веб-серверами в ферме серверов. Установите WFF 2.0 на сервере контроллера и сервера контроллера в свою очередь устанавливаются WFF агент на каждом из серверов в ферме серверов. Сервер контроллера не принадлежит концептуально на любой ферме сервера WFF и сервер одного контроллера может управлять нескольких фермах серверов. В этом случае для создания и управления фермы серверов промежуточной и рабочей ферме серверов используется один сервер контроллера WFF.
- *Сервера-источника*. На каждой ферме серверов WFF включает в себя один сервер-источник. При установке платформы веб-компоненты или развертывании приложений на сервере-источнике, WFF синхронизирует изменения ко всем остальным серверам в ферме серверов.
- *Сервера-получателя*. На каждой ферме серверов WFF включает в себя один или несколько серверов-получателей. Любые изменения, внесенные на основной сервер реплицируются на каждый сервер-получатель в ферме серверов.

Это показывает, как связаны эти роли сервера в Fabrikam, Inc., промежуточной и рабочей средах:

![](creating-a-server-farm-with-the-web-farm-framework/_static/image1.png)

В этом случае промежуточной и рабочей среде настроены как WFF ферм серверов. Один сервер контроллера WFF управляет двух ферм. В каждой ферме любые изменения на основной сервер реплицируются на каждый сервер-получатель.

Перед началом настройки промежуточной и рабочей среды, мы рекомендуем прочитать следующие статьи, чтобы ознакомиться с основными понятиями WFF 2.0:

- [Общие сведения о Web Farm Framework 2.0 для IIS 7](https://go.microsoft.com/?linkid=9805126)
- [Настройка фермы серверов фермы Framework Web 2.0 для IIS 7](https://go.microsoft.com/?linkid=9805127)
- [Системы и требования к платформе для Web Farm Framework 2.0 для IIS 7](https://go.microsoft.com/?linkid=9805128)

## <a name="task-overview"></a>Общие сведения о задачах

Чтобы завершить задачи и пошаговые руководства в этой статье, вам потребуется по крайней мере три сервера&#x2014;одного контроллера WFF одного основного веб-сервера для фермы серверов и один или несколько вторичных веб-серверов, которые для фермы серверов. Можно добавить дополнительные серверы-получатели к ферме серверов WFF в любое время. На высоком уровне, для создания и настройки фермы серверов WFF для промежуточной или рабочей среды, вам потребуется:

- Создайте сервер контроллера при установке Internet Information Services (IIS) 7.5 и WFF 2.0.
- Подготовка основного и дополнительного серверов путем создания обычной учетной записи администратора и настройки исключений брандмауэра.
- Настройка фермы серверов с помощью диспетчера служб IIS на сервере контроллера.
- Настройка балансировки нагрузки с помощью IIS маршрутизации запросов приложений (ARR) или альтернативный технология балансировки нагрузки.

Задачи и пошаговые руководства в этом разделе предполагается, что вы начинаете со сборками чистого сервера под управлением Windows Server 2008 R2. Перед началом работы для каждого сервера, убедитесь, что:

- Пакет обновления 1 для Windows Server 2008 R2 и все доступные обновления будут установлены.
- Сервер присоединен к домену.
- Сервер имеет статический IP-адрес.

> [!NOTE]
> Дополнительные сведения о присоединении к домену компьютеров, см. в разделе [присоединение к домену и вход](https://technet.microsoft.com/library/cc725618(v=WS.10).aspx). Дополнительные сведения о настройке статического IP-адресов, см. в разделе [настроить статический IP-адрес](https://technet.microsoft.com/library/cc754203(v=ws.10).aspx).


## <a name="create-the-wff-controller-server"></a>Создайте сервер контроллера WFF

Создайте сервер контроллера WFF, необходимо установить службы IIS 7 или более поздней и WFF 2.0 или более поздней. На самом деле WFF использует средство IIS веб-развертывания (Web Deploy) 2.x для синхронизации серверов в ферме. При использовании установщика веб-платформы для установки WFF установщик автоматически скачать и установить веб-развертывания для вас.

**Для создания сервера контроллера WFF**

1. Скачайте и установите [установщика веб-платформы](https://go.microsoft.com/?linkid=9739157).
2. В верхней части **веб-платформы 3.0 установщик** окно, нажмите кнопку **продуктов**.
3. В левой части окна, в области навигации щелкните **сервера**.
4. В **рекомендуемой конфигурации IIS 7** щелкните **добавить**.
5. В <strong>Web Farm Framework 2.</strong> <em>x</em> щелкните <strong>добавить</strong>.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image2.png)
6. Нажмите кнопку **Установить**. Обратите внимание на то, что установщик веб-платформы добавлено средство веб-развертывания, а также некоторые другие зависимости, в списке установки.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image3.png)
7. Ознакомьтесь с условиями лицензии, а если вы согласны с условиями, нажмите кнопку **я принимаю**.
8. После завершения установки нажмите кнопку **Готово**, а затем закройте **веб-платформы 3.0 установщик** окна.

## <a name="configure-the-primary-and-secondary-servers"></a>Настройка основного и дополнительного серверов

Перед созданием WFF фермы серверов, следует выполнить некоторые задачи подготовки на веб-серверах, которые составляют фермы:

- Добавление исключений брандмауэра, чтобы разрешить **Core Networking**, **удаленного администрирования**, и **к файлам и принтерам** функции для взаимодействия с сервером контроллера WFF .
- Создайте учетную запись домена (например, **FABRIKAM\stagingfarm**) в Active Directory и его добавления в группу локальных администраторов на каждом сервере. Эта учетная запись будет использоваться как учетная запись администратора фермы серверов, при создании на ферме серверов.

Дополнительные сведения о настройке этих исключений брандмауэра в брандмауэре Windows см. в разделе [системы и требования к платформе для фермы Framework 2.0 Web для IIS 7](https://go.microsoft.com/?linkid=9805128). Для других систем брандмауэра обратитесь к документации к продукту.

Чтобы добавить учетную запись домена в группу локальных администраторов в Windows Server 2008 R2, можно использовать следующую процедуру. Данную процедуру следует выполнять на каждом сервере, который требуется добавить в ферму серверов&#x2014;другими словами, добавьте одну и ту же учетную запись домена в группу локальных администраторов на сервере-источнике, так и на каждом сервере-получателе.

**Чтобы добавить учетную запись домена в группу локальных администраторов**

1. На **запустить** последовательно выберите пункты **Администрирование**, а затем нажмите кнопку **диспетчера серверов**.
2. В **диспетчера серверов** окно, в области представления дерева разверните **конфигурации**, разверните **локальные пользователи и группы**и нажмите кнопку **группы**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image4.png)
3. В **группы** панель, дважды щелкните **Администраторы**.
4. В **свойства администратора** диалоговом окне щелкните **добавить**.
5. В **Выбор пользователей, компьютеров, учетных записей служб или групп** диалоговое окно, введите (или найдите) к учетной записи домена (например, **FABRIKAM\stagingfarm**), а затем нажмите кнопку **ОК**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image5.png)
6. В **свойства администратора** диалоговом окне щелкните **ОК**.

Ваши серверы теперь готовы для добавления к ферме серверов. В случае с основного сервера, можно настроить сервер для удовлетворения требований приложения до или после создания фермы серверов&#x2014;в обоих случаях WFF будет синхронизировать серверов, развернув продуктов, компонентов или конфигурация для дополнительных серверов. Для простоты предполагается, что вы настроите сервер-источник, после завершения создания фермы серверов.

## <a name="create-the-wff-server-farm"></a>Создание фермы серверов WFF

На этом этапе все серверы готовы для добавления к ферме серверов WFF.

- Вы установили на сервере контроллера WFF.
- Вы настроили исключения брандмауэра на основной и дополнительный веб-серверов.
- Вы добавили учетную запись домена в группу локальных администраторов на основной и дополнительный веб-серверов.

Следующим шагом является создание фермы серверов в WFF. Это можно сделать из диспетчера служб IIS на сервере контроллера WFF.

**Для создания фермы серверов WFF**

1. На сервере контроллера WFF на **запустить** последовательно выберите пункты **Администрирование**, а затем нажмите кнопку **Internet Information Services (IIS) Manager**.
2. В **подключений** области, разверните узел локального сервера, щелкните правой кнопкой мыши **ферм серверов**, а затем нажмите кнопку **создания фермы серверов**.
3. В **создания фермы серверов** диалогового окна введите понятное имя для фермы серверов (например, **фермы промежуточной**) и выберите **подготовить ферму сервера**.
4. Введите имя пользователя и пароль учетной записи домена, добавленного в группу локальных администраторов на каждом сервере.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image6.png)
5. Нажмите кнопку **Далее**.
6. На **Добавление серверов** странице, введите полное доменное имя (FQDN) сервера-источника, выберите **сервера-источника**, а затем нажмите кнопку **добавить**.
7. На этом этапе WFF попытается связаться с основным сервером, используя учетные данные, которые вы указали. Если соединение успешно установлено, сервер-источник будет добавляться в таблицу **Добавление серверов** страницы.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image7.png)

    > [!NOTE]
    > Вы могли заметить, **сервер доступен для балансировки нагрузки** выбран по умолчанию. WFF использует модуль маршрутизации запросов Приложений IIS для реализации балансировки нагрузки и тем самым распределять запросы по веб-серверов в ферме серверов. В большинстве случаев можно только снять **сервер доступен для балансировки нагрузки** параметр, если вы хотите использовать вместо этого решение по балансировке нагрузки независимых производителей.
8. На **Добавление серверов** странице, введите полное ДОМЕННОЕ имя вашего первого сервера-получателя и нажмите кнопку **добавить**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image8.png)
9. Повторите шаг 7 для все дополнительные серверы в ферме, а затем нажмите кнопку **Готово**.

Ферма серверов WFF — теперь настроен и работает. Любой веб-платформы продуктов или компонентов, устанавливаемых на сервере-источнике и веб-приложений или содержимого, развертываемого на сервере-источнике, будут автоматически подготовлены на всех серверах-получателях.

WFF — это тема широкие и сложные и Дополнительные сведения о нем на [Microsoft веб-фермы Framework версии 2.0 для IIS 7](https://go.microsoft.com/?linkid=9805129) веб-сайта. Однако на данный момент существуют две области функции, которые необходимо учитывать:

- *Подготовка приложений* — процесс, который копирует содержимое с сервера-источника, таких как веб-приложений и параметры конфигурации на всех серверах-получателях в ферме серверов. Например при развертывании примера решения диспетчера контактов для промежуточного сервера-источника, процесс подготовки приложения WFF развернет это решение все дополнительные серверы размещения. По умолчанию процесс подготовки приложения выполняется каждые 30 секунд.
- *Подготовка платформы* — процесс, который синхронизирует веб-платформы продуктов и компонентов с сервера-источника на всех серверах-получателях в ферме серверов. Например если установить ASP.NET MVC 3 на промежуточном сервере-источнике, процесс подготовки платформы будет использоваться установщика веб-платформы для установки ASP.NET MVC 3 на всех дополнительных серверах промежуточного. По умолчанию процесс подготовки платформы выполняется каждые пять минут.

Вы можете управлять базовое приложение и параметры подготовки платформы из диспетчера служб IIS на сервере контроллера WFF.

**Изучите приложения и платформы, параметры подготовки**

1. В диспетчере служб IIS в **подключений** панели выберите фермы серверов.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image9.png)
2. В **фермы серверов** панель, дважды щелкните **подготовки приложения**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image10.png)
3. Как вы видите, на ферме серверов настроено для синхронизации веб-содержимого и конфигурации параметров между сервере-источнике и серверах-получателях каждые 30 секунд.
4. Нажмите кнопку **обратно**, а затем дважды щелкните **подготовка платформы**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image11.png)
5. Как вы видите, на ферме серверов настроено для синхронизации веб-платформы продуктов и компонентов сервера-источника и дополнительный сервер каждые пять минут.
6. Нажмите кнопку **Назад**.
7. Чтобы принудительно фермы серверов для синхронизации веб-платформы продуктов немедленно, в **действия** панели щелкните **подготовка платформы**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image12.png)

    > [!NOTE]
    > Подготовка платформы может занять некоторое время. В процессе установки выполняется в фоновом режиме на серверах-получателях на ферме серверов.
8. Разрешив достаточное время для завершения процесса подготовки, чтобы узнать, что продукты и компоненты, которые вы добавили сервер-источник теперь были реплицированы на серверах-получателях. Например, можно войти на сервер-получатель и использовать **диспетчера серверов** окно, чтобы проверить установку роли веб-сервера.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image13.png)
9. Вы также можете проверить список установленных программ, чтобы убедиться, что были добавлены различные компоненты веб-платформы.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image14.png)

## <a name="configure-load-balancing"></a>Настройка балансировки нагрузки

При создании веб-ферме, необходимо настроить определенные виды Балансировка нагрузки для распределения запросов HTTP между веб-серверов. Это может быть Windows Server 2008 балансировку сетевой нагрузки, IIS ARR, или решение по балансировке нагрузки программных или аппаратных независимых производителей.

Тесная интеграция с маршрутизации запросов приложений IIS предназначен WFF Чтобы воспользоваться преимуществом такой интеграции, необходимо установить модуль маршрутизации запросов Приложений на сервере контроллера WFF. Можно направлять все веб-трафика к серверу контроллера, обычно путем настройки записей доменных имен (DNS). Сервер контроллера затем распределяет входящие запросы между серверами в ферме, на основе доступности сервера и другие критерии.

> [!NOTE]
> Нет необходимости использовать ARR с WFF; Вы можете настроить WFF для работы с помощью решения балансировки нагрузки сторонних. Дополнительные сведения см. в разделе [Общие сведения о ферме Framework 2.0 Web для IIS 7](https://go.microsoft.com/?linkid=9805126).


Балансировка нагрузки с помощью модуля маршрутизации запросов Приложений — тема сложная, наиболее которого выходит за рамки данного руководства. Тем не менее можно использовать следующую процедуру для установки модуля маршрутизации запросов Приложений и приступить к работе с балансировкой нагрузки.

**Для настройки балансировки нагрузки в сервере контроллера WFF**

1. На сервере контроллера WFF запустите установщик веб-платформы.
2. В верхней части **веб-платформы 3.0 установщик** окно, нажмите кнопку **продуктов**.
3. В левой части окна, в области навигации щелкните **сервера**.
4. В **2.5 маршрутизации запросов приложений** щелкните **добавить**.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image15.png)
5. Нажмите кнопку **установить**, а затем следуйте инструкциям в **Установка веб-платформы** окна.
6. Когда установка будет завершена, запустите диспетчер IIS и в **подключений** панели, щелкните узел фермы сервера. Обратите внимание, что были добавлены несколько новых значков **фермы серверов** области.

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image16.png)
7. В **фермы серверов** панель, дважды щелкните **Балансировка нагрузки**.
8. В **средства балансировки нагрузки** выберите нагрузки сбалансировать алгоритм (например, **бы текущего запроса**).

    > [!NOTE]
    > Дополнительные сведения о балансировки нагрузки алгоритмов и другие параметры конфигурации, см. в разделе [модуль маршрутизации запросов приложений](https://go.microsoft.com/?linkid=9805130).

    ![](creating-a-server-farm-with-the-web-farm-framework/_static/image17.png)
9. В **действия** панели щелкните **применить**.

Теперь вы настроили базовые балансировку нагрузки для серверов в ферме серверов. Если вы направление все ваши веб-фермы трафика к серверу контроллера, запросы будут распределены между серверами в ферме, в соответствии с доступности и алгоритм балансировки нагрузки, которые вы выбрали.

Дополнительные сведения о настройке балансировки нагрузки с помощью ARR см. в разделе [модуль маршрутизации запросов приложений](https://go.microsoft.com/?linkid=9805130).

## <a name="monitor-the-server-farm"></a>Монитор на ферме серверов

Вы можете отслеживать работоспособность фермы серверов в любое время с помощью диспетчера служб IIS на сервере контроллера. В **подключений** области, разверните узел фермы серверов и нажмите кнопку **серверов**. Центральной области отобразится сводка каждого сервера в ферме, а также журнал трассировки для последних действий.

![](creating-a-server-farm-with-the-web-farm-framework/_static/image18.png)

## <a name="conclusion"></a>Заключение

Ферма серверов WFF теперь должен быть запущен и работает. Можно настроить сервер для поддержки развертывания подхода, который вы предпочитаете&#x2014;дополнительными материалами, Дополнительные сведения см. в разделе&#x2014;и конфигурацию реплицируются на каждый сервер-получатель в ферме серверов.

## <a name="further-reading"></a>Дополнительные сведения

Дополнительные рекомендации по всем аспектам, настройки и использования WFF, см. в разделе [Microsoft веб-фермы Framework версии 2.0 для IIS 7](https://go.microsoft.com/?linkid=9805129) веб-сайта.

> [!div class="step-by-step"]
> [Назад](configuring-a-database-server-for-web-deploy-publishing.md)
> [Вперед](configuring-deployment-properties-for-a-target-environment.md)
