---
uid: web-forms/overview/deployment/configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment
title: Настройка свойств развертывания для целевой среды | Документация Майкрософт
author: jrjlee
description: В этом разделе описываются способы настройки свойства, относящиеся к среде, чтобы развернуть пример решения диспетчера контактов в конкретной среде...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: b5b86e03-b8ed-46e6-90fa-e1da88ef34e9
msc.legacyurl: /web-forms/overview/deployment/configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment
msc.type: authoredcontent
ms.openlocfilehash: 1486cc7d8f25e823481dfab109d18c407c2d8063
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/01/2019
ms.locfileid: "57057101"
---
<a name="configuring-deployment-properties-for-a-target-environment"></a>Настройка свойств развертывания для целевой среды
====================
по [Джейсон Lee](https://github.com/jrjlee)

[Загрузить PDF-файл](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> В этом разделе описываются способы настройки свойства, относящиеся к среде, чтобы развернуть пример решения диспетчера контактов в конкретной среде.


Этот раздел является частью серии учебников, исходя из требования к развертыванию enterprise вымышленной компании Fabrikam, Inc. В этой серии руководств используется пример решения&#x2014; [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) решение&#x2014;для представления веб-приложения с более реалистичные уровень сложности, включая приложения ASP.NET MVC 3, Windows Communication Служба Foundation (WCF) и проект базы данных.

Метод развертывания в основе этих учебников основан на разбиение проекта файл подход, описанный в [основные сведения о процессе построения](../web-deployment-in-the-enterprise/understanding-the-build-process.md), в которой процесс построения управляется двумя файлы проекта&#x2014;один с Создание инструкции, которые применяются для каждой целевой среде и содержащего параметры построения и развертывания для конкретной среды. Во время сборки файл проекта для конкретной среды объединяется в файл проекта независимой от среды, чтобы полный набор инструкций построения.

## <a name="process-overview"></a>Общие сведения о процессе

Файл проекта, которое будет использоваться для создания и развертывания решения диспетчера контактов разбивается на два физических файлов:

- Содержащий универсальный сборки, параметры и инструкции ( *Publish.proj* файла).
- Параметры, содержащей конкретной среды сборки (*Env Dev.proj*, *Env Stage.proj*, и так далее).

Во время сборки, соответствующий конкретной среды файл проекта добавляются в universal *Publish.proj* файл, чтобы полный набор инструкций построения. Создание или Настройка файлов проекта для конкретной среды с параметрами, которые описывают сценария развертывания можно настроить развертывание для определенных целевых средах.

Множество этих значений, определяются как настроено целевой среды&#x2014;в частности, ли целевой веб-сервер настроен для использования службы агента веб-развертывания (удаленный агент) или веб-развертывание обработчик. Дополнительные сведения об этих подходах и рекомендации по выбору правильного подхода для конкретной среды, см. в разделе [Выбор оптимального подхода для веб-развертывания справа](choosing-the-right-approach-to-web-deployment.md).

[Сценарий Contact Manager](../deploying-web-applications-in-enterprise-scenarios/enterprise-web-deployment-scenario-overview.md) требуется два файла проекта для конкретной среды:

- Развертывание в тестовой среде разработчика (*Env Dev.proj*). Тестовая среда разработки настроена для приема удаленных развертываний с помощью удаленного агента, как описано в разделе [сценария: Настройка среды тестирования для веб-развертывания](scenario-configuring-a-test-environment-for-web-deployment.md). Этот файл должен предоставить удаленный агент, адрес конечной точки, а также параметры относящиеся к размещению, например строки подключения и конечных точек службы.
- Развертывание в промежуточной среде (*Env Stage.proj*). Промежуточная среда настроена для принятия удаленных развертываний с помощью веб-обработчик развертывания, как описано в разделе [сценария: Настройка промежуточной среды для веб-развертывания](scenario-configuring-a-staging-environment-for-web-deployment.md). Этот файл должен предоставлять адрес конечной точки веб-развертывание обработчик, а также параметры, относящиеся к размещению как строки подключения и конечные точки службы.

Это важно отметить, что параметры, настроенные в файле проекта для конкретной среды не влияют на содержимое веб-пакета, сам&#x2014;вместо этого они управляют развертыванием пакета и какие значения параметров приведены в том случае, если включен пакет извлечь. Вы импортируете веб-пакета в рабочей среде вручную, как описано в разделе [сценария: Настройке рабочей среды для веб-развертывания](scenario-configuring-a-production-environment-for-web-deployment.md) и [вручную Установка веб-пакеты](../web-deployment-in-the-enterprise/manually-installing-web-packages.md), поэтому неважно, какие параметры, используемые в файле проекта для конкретной среды при создании пакета. Диспетчер Internet Information Services (IIS) предложит ввести любой параметризованными значениями, например строки подключения и конечных точек службы, при импорте пакета.

Чтобы развернуть решение диспетчера контактов в целевой среде, можно либо настроить этот файл или использовать его как шаблон и создать собственный файл.

**Чтобы настроить параметры конкретной среды развертывания для решения диспетчера контактов**

1. Откройте решение ContactManager WCF в Visual Studio 2010.
2. В **обозревателе решений** окне разверните **публикации** папку, разверните **EnvConfig** папку и дважды щелкните **Env-Dev.proj**.

    ![](configuring-deployment-properties-for-a-target-environment/_static/image1.png)
3. Замените значения свойств в *Env Dev.proj* файл правильными значениями для тестовой среды.

    > [!NOTE]
    > В таблице, после этой процедуры приведены дополнительные сведения по каждой из этих свойств.
4. Сохранить результаты работы, а затем закройте *Env Dev.proj* файл.

## <a name="choosing-the-right-deployment-properties"></a>Выбор свойства развертывания, наиболее подходящий

Эта таблица описывает назначение каждого свойства в файле проекта для конкретной среды примера *Env Dev.proj*и даны некоторые рекомендации по значениям, необходимо предоставить.


|                                                        Имя свойства                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Подробные сведения                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|              <strong>MSDeployComputerName</strong> имя конечной точки сервера или службы веб-назначения.               |                                                                                                                                                                                                                                              Если вы развертываете к службе удаленного агента на веб-сервере назначения, можно указать имя конечного компьютера (например, <strong>TESTWEB1</strong> или <strong>TESTWEB1.fabrikam.net</strong>), или указать удаленный агент конечной точки (например, `http://TESTWEB1/MSDEPLOYAGENTSERVICE`). Развертывание выполняется так же, как в каждом конкретном случае. Если вы развертываете в веб-развертывание обработчик на веб-сервере назначения, следует указывать конечную точку службы и имя веб-сайт IIS в качестве параметра строки запроса (например, `https://STAGEWEB1:8172/MSDeploy.axd?site=DemoSite`).                                                                                                                                                                                                                                              |
|         <strong>MSDeployAuth</strong> метод, который веб-развертывания следует использовать для проверки подлинности к удаленному компьютеру.          |                                                                                                                                                                                                                          Это должно быть присвоено <strong>NTLM</strong> или <strong>основные</strong>. Как правило, вы используете <strong>NTLM</strong> при развертывании в службу удаленного агента и <strong>основные</strong> при развертывании для веб-развертывание обработчик. При использовании обычной проверки подлинности, необходимо также указать имя пользователя и пароль, которая должна олицетворяться средство IIS веб-развертывания (веб-развертывание) для выполнения развертывания. В данном случае эти значения предоставляются через <strong>MSDeployUsername</strong> и <strong>MSDeployPassword</strong> свойства. Если вы используете проверку подлинности NTLM, можно исключить эти свойства или оставить их пустыми.                                                                                                                                                                                                                          |
| <strong>MSDeployUsername</strong> при использовании обычной проверки подлинности веб-развертывания будет использовать эту учетную запись на удаленном компьютере.  |                                                                                                                                                                                                                                                                                                                                                                                                                       Это должно задаваться в виде <em>домена</em>\*имя пользователя * (например, <strong>FABRIKAM\matt</strong>). Это значение используется только в том случае, если задать обычную проверку подлинности. Если вы используете проверку подлинности NTLM, свойство может быть опущено. Если значение задано, оно будет игнорироваться.                                                                                                                                                                                                                                                                                                                                                                                                                        |
| <strong>MSDeployPassword</strong> при использовании обычной проверки подлинности веб-развертывания этот пароль будет использоваться на удаленном компьютере. |                                                                                                                                                                                                                                                                                                                                                                                                                    Это пароль для учетной записи пользователя, указанной в <strong>MSDeployUsername</strong> свойство. Это значение используется только в том случае, если задать обычную проверку подлинности. Если вы используете проверку подлинности NTLM, свойство может быть опущено. Если значение задано, оно будет игнорироваться.                                                                                                                                                                                                                                                                                                                                                                                                                    |
|     <strong>ContactManagerIisPath</strong> путь IIS, на котором вы хотите развернуть приложение диспетчера контактов MVC.     |                                                                                                                                                                                                                                                                                                                                                                        Это должно содержать путь, как оно отображается в диспетчере служб IIS в форме [<em>имя веб-сайта IIS</em>] / [<em>web</em><em>имя_приложения</em>]. Помните, что веб-сайт IIS должно существовать до развертывания приложения. Например если вы создали на веб-сайт IIS с именем DemoSite, можно указать путь IIS для приложения MVC как DemoSite/ContactManager.                                                                                                                                                                                                                                                                                                                                                                        |
|   <strong>ContactManagerServiceIisPath</strong> путь IIS, на котором требуется выполнить развертывание службы WCF диспетчера контактов.    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Например, если вы создали на веб-сайт IIS с именем DemoSite, можно указать путь IIS для службы WCF, поскольку <strong>DemoSite/ContactManagerService</strong>.                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                  <strong>ContactManagerTargetUrl</strong> URL-адрес, по которому можно связаться со службой WCF.                   |                                                                                                                                                     Это будет иметь вид [<em>URL-адрес корневого веб-сайта IIS</em>] / [<em>имя приложения службы</em>] / [<em>конечная точка службы</em>]. Например, если вы создали веб-сайт IIS на порту 85, URL-адрес потребуется форме `http://localhost:85/ContactManagerService/ContactService.svc`. Помните, что MVC-приложения и службы WCF развертываются на том же сервере. Таким образом этот URL-адрес осуществляется только с компьютера, на котором он установлен. По этой причине лучше использовать localhost или IP-адрес, а не имя компьютера или заголовок узла, в URL-адрес. Если вы используете имя компьютера или заголовок узла, [проверки замыкания на себя](https://go.microsoft.com/?linkid=9805131) функция безопасности в службах IIS может заблокировать URL-адрес и возвращают <strong>HTTP 401.1 - доступ запрещен</strong> ошибки.                                                                                                                                                     |
|                  <strong>CmDatabaseConnectionString</strong> строку подключения для сервера базы данных.                  | Строка подключения определяет, как учетные данные, которые будут использовать средство VSDBCMD для связи с сервером базы данных и создания базы данных и учетные данные, пул веб-сервера приложений будет использоваться для связи с сервером базы данных и взаимодействовать с базой данных. По сути имеется два варианта здесь. Можно указать <strong>Integrated Security = true</strong>, в этом случае используется встроенная проверка подлинности Windows: <strong>Источник данных = TESTDB1; Integrated Security = true</strong> в этом случае базы данных создается с использованием учетных данных пользователя, который запускает исполняемый файл VSDBCMD и приложение будет обращаться к базе данных с использованием удостоверения машины веб-сервера Учетная запись. Кроме того можно указать имя пользователя и пароль учетной записи SQL Server. В этом случае VSDBCMD, чтобы создать базу данных и пулом приложений для взаимодействия с базой данных, используются учетные данные SQL Server: <strong>Источник данных = TESTDB1; Идентификатор пользователя = ASqlUser; Пароль = Pa$ $w0rd</strong> пошаговые руководства в этом разделе предполагается, вы сможете использовать встроенную проверку подлинности Windows. |
|        <strong>CmTargetDatabase</strong> имя, назначаемое базы данных, вы создадите на сервере базы данных.        |                                                                                                                                                                                                                                                                                                                                                                                                                                                     Значение, которые вы указываете добавляется средство VSDBCMD команды как параметр. Он также используется для создания строки подключения целиком, пул приложений веб-сервера можно использовать для взаимодействия с базой данных.                                                                                                                                                                                                                                                                                                                                                                                                                                                     |

Эти примеры показывают, как можно настроить эти свойства для конкретных сценариев развертывания.

### <a name="example-1x2014deployment-to-the-remote-agent-service"></a>Пример 1&#x2014;развертывание в службе удаленного агента

В этом примере:

- Вы развертываете к службе удаленного агента на TESTWEB1.
- Вы указываете веб-развертывание для использования проверки подлинности NTLM. Веб-развертывание будет выполняться с использованием учетных данных, которая использовалась для вызова Microsoft Build Engine (MSBuild).
- Вы используете встроенную проверку подлинности для развертывания **ContactManager** базу данных TESTDB1. Базы данных будут развернуты с использованием учетных данных, которая использовалась для вызова MSBuild.


[!code-xml[Main](configuring-deployment-properties-for-a-target-environment/samples/sample1.xml)]


### <a name="example-2x2014deployment-to-the-web-deploy-handler-endpoint"></a>Пример 2&#x2014;развертывание в веб-развертывание обработчика конечной точки

В этом примере:

- Вы развертываете в конечную точку службы веб-развертывание обработчик на STAGEWEB1.
- Вы указываете веб-развертывание для использования обычной проверки подлинности.
- Вы указываете, что веб-развертывания должно олицетворять учетную запись FABRIKAM\stagingdeployer на удаленном компьютере.
- Вы используете проверку подлинности SQL Server для развертывания **ContactManager** STAGEDB1 базы данных.


[!code-xml[Main](configuring-deployment-properties-for-a-target-environment/samples/sample2.xml)]


## <a name="conclusion"></a>Заключение

На этом этапе файлы проекта полностью настроены на создание и развертывание решения диспетчера контактов в один или несколько сред назначения.

Чтобы использовать эти файлы проекта в рамках процесса одношаговой, воспроизводимые развертывания, необходимо выполнить *Publish.proj* файлов с помощью MSBuild и передайте расположение файла проекта для конкретной среды как параметр. Это можно сделать разными способами:

- Общие сведения о MSBuild и общие сведения о файлах пользовательских проектов, см. в разделе [основные сведения о файле проекта](../web-deployment-in-the-enterprise/understanding-the-project-file.md).
- Сведения о том, как формулировать команды MSBuild, которая выполняет файлы пользовательского проекта, см. в разделе [развертывание веб-пакеты](../web-deployment-in-the-enterprise/deploying-web-packages.md).
- Сведения о том, как внедрить MSBuild команды в командный файл один шаг, повторяемых развертываний, см. в разделе [Создание и запуск командного файла развертывания](../web-deployment-in-the-enterprise/creating-and-running-a-deployment-command-file.md).
- Сведения о том, как выполнить файлы пользовательского проекта из Team Build, см. в разделе [Создание определения сборки, развертывания поддерживает](../configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment.md).

> [!div class="step-by-step"]
> [Назад](creating-a-server-farm-with-the-web-farm-framework.md)
