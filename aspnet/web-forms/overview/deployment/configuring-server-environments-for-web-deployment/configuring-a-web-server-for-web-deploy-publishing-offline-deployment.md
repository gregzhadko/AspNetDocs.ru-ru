---
uid: web-forms/overview/deployment/configuring-server-environments-for-web-deployment/configuring-a-web-server-for-web-deploy-publishing-offline-deployment
title: Настройка веб-сервера для веб-публикации (автономное развертывание) "развертывания" | Документация Майкрософт
author: jrjlee
description: В этом разделе описываются способы настройки веб-сервер IIS для поддержки автономной веб-публикации и развертывания. При работе с Internet Information Services (я...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: ba92788f-9f03-44b1-b6b2-af8413e6a35d
msc.legacyurl: /web-forms/overview/deployment/configuring-server-environments-for-web-deployment/configuring-a-web-server-for-web-deploy-publishing-offline-deployment
msc.type: authoredcontent
ms.openlocfilehash: 66a784430de734c8b1387c950382472ce59d5ccc
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59422139"
---
# <a name="configuring-a-web-server-for-web-deploy-publishing-offline-deployment"></a>Настройка веб-сервера для публикации веб-развертывания (автономное развертывание)

по [Джейсон Lee](https://github.com/jrjlee)

[Скачать PDF](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> В этом разделе описываются способы настройки веб-сервер IIS для поддержки автономной веб-публикации и развертывания.
> 
> При работе с Internet Information Services (IIS) средства веб-развертывания (Web Deploy) 2.0 или более поздней, существует три основных подхода, которые можно использовать для получения приложений или сайтов на веб-сервер. Можно выполнить следующие действия: 
> 
> - Используйте *веб-развертывания службы удаленного агента*. Этот подход требует сократить количество конфигураций веб-сервера, но необходимо предоставить учетные данные администратора локального сервера для развертывания ничего на сервер.
> - Используйте *обработчик веб-развертывания*. Этот подход гораздо более сложна и требует больше усилий начальной для настройки веб-сервера. Тем не менее при использовании этого подхода, можно настроить службы IIS, чтобы разрешить пользователям без прав администратора для выполнения развертывания. Веб-развертывание обработчик доступна только в службах IIS 7 или более поздней версии.
> - Используйте *автономное развертывание*. Этот подход требует минимальной конфигурации веб-сервера, но администратор сервера необходимо вручную скопировать веб-пакета на сервер и импортировать его в диспетчере IIS.
> 
> Дополнительные сведения о ключевых функций, преимущества и недостатки этих подходов см. в разделе [Выбор оптимального подхода для веб-развертывания справа](choosing-the-right-approach-to-web-deployment.md).


Да, если в вашей сети инфраструктуры и безопасности ограничениям удаленного развертывания. Это, скорее всего, относится к в производственной среде выходом в Интернет, в котором изолированы веб-серверов&#x2014;либо физически или с помощью брандмауэров и подсетей&#x2014;от остальной части серверной инфраструктуры.

Очевидно, что такой подход становится менее предпочтителен, если веб-приложения обновляются на регулярной основе. Если это позволяет инфраструктуре, можно включить удаленное развертывание с помощью веб-развертывание обработчик или веб-развертывание удаленного агента службы.

## <a name="task-overview"></a>Общие сведения о задачах

Чтобы настроить веб-сервер для поддержки автономного импорта и развертывания веб-пакетов, вам потребуется:

- Установите IIS 7.5 и IIS 7, рекомендуемая конфигурация.
- Установите веб-развертывания 2.1 или более поздней версии.
- Создание веб-сайта IIS для размещения развернутого содержимого.
- Отключите службу агента веб-развертывания.

Для размещения примера решения, в частности, также необходимо:

- Установка .NET Framework 4.0.
- Установка ASP.NET MVC 3.

В этом разделе показано, как выполнить каждую из этих процедур. Задачи и пошаговые руководства в этом разделе предполагается, что вы начинаете с построением чистого сервера под управлением Windows Server 2008 R2. Прежде чем продолжить, убедитесь, что:

- Пакет обновления 1 для Windows Server 2008 R2 и все доступные обновления будут установлены.
- Сервер присоединен к домену.
- Сервер имеет статический IP-адрес.

> [!NOTE]
> Дополнительные сведения о присоединении к домену компьютеров, см. в разделе [присоединение к домену и вход](https://technet.microsoft.com/library/cc725618(v=WS.10).aspx). Дополнительные сведения о настройке статического IP-адресов, см. в разделе [настроить статический IP-адрес](https://technet.microsoft.com/library/cc754203(v=ws.10).aspx).


## <a name="install-products-and-components"></a>Установить продукты и компоненты

В этом разделе поможет установке необходимых продуктов и компонентов на веб-сервере. Перед началом работы рекомендуется выполнить обновление Windows, чтобы убедиться, что ваш сервер находится полностью в актуальном состоянии.

В этом случае необходимо установить следующее:

- **Рекомендуемая конфигурация IIS 7**. Это позволяет **веб-сервер (IIS)** роли веб-сервера и устанавливает набор модулей IIS и компоненты, необходимые для размещения приложений ASP.NET.
- **.NET framework 4.0**. Это необходимо для запуска приложений, которые были созданы в этой версии платформы .NET Framework.
- **Средство веб-развертывания 2.1 или более поздняя**. При этом устанавливаются на сервере веб-развертывания (и его базового исполняемого файла, MSDeploy.exe). Веб-развертывание интегрируется со службами IIS и позволяет импортировать и экспортировать веб-пакетов.
- **ASP.NET MVC 3**. Это устанавливает сборки, необходимые для запуска приложения MVC 3.

> [!NOTE]
> В этом пошаговом руководстве описывается использование установщика веб-платформы для установки и настройки различных компонентов. Несмотря на то, что не нужно использовать установщик веб-платформы, это упрощает процесс установки автоматически обнаруживая зависимостей и обеспечение всегда получать последние версии продукта. Дополнительные сведения см. в разделе [веб-платформы Microsoft Installer-3.0](https://go.microsoft.com/?linkid=9805118).


**Чтобы установить необходимые продукты и компоненты**

1. Скачайте и установите [установщика веб-платформы](https://go.microsoft.com/?linkid=9805118).
2. По завершении установки автоматически запустит установщик веб-платформы.

    > [!NOTE]
    > Теперь можно запустить установщик веб-платформы в любое время с **запустить** меню. Для этого на **запустить** меню, щелкните **все программы**, а затем нажмите кнопку **Microsoft Web Platform Installer**.
3. В верхней части **веб-платформы 3.0 установщик** окно, нажмите кнопку **продуктов**.
4. В левой части окна, в области навигации щелкните **платформ**.
5. В **Microsoft .NET Framework 4** строк, если .NET Framework еще не установлен, нажмите кнопку **добавить**.

    > [!NOTE]
    > Вы возможно уже установлены .NET Framework 4.0 через Центр обновления Windows. Если продукт или компонент уже установлен, установщик веб-платформы сообщит об этом, заменив **добавить** кнопка с текстом **установленные**.

    ![](configuring-a-web-server-for-web-deploy-publishing-offline-deployment/_static/image1.png)
6. В **ASP.NET MVC 3 (Visual Studio 2010)** щелкните **добавить**.
7. В области навигации щелкните **сервера**.
8. В **рекомендуемой конфигурации IIS 7** щелкните **добавить**.
9. В **2.1 средства развертывания Web** щелкните **добавить**.
10. Нажмите кнопку **Установить**. Установщик веб-платформы Отображение списка продуктов&#x2014;совместно с любым связанные зависимости&#x2014;должен быть установлен и будет предложено принять условия лицензионного соглашения.

    ![](configuring-a-web-server-for-web-deploy-publishing-offline-deployment/_static/image2.png)
11. Ознакомьтесь с условиями лицензии, а если вы согласны с условиями, нажмите кнопку **я принимаю**.
12. После завершения установки нажмите кнопку **Готово**, а затем закройте **веб-платформы 3.0 установщик** окна.

Если вы установили .NET Framework 4.0 до установки служб IIS, необходимо запустить [ASP.NET IIS Registration Tool](https://msdn.microsoft.com/library/k6h9cz8h(v=VS.100).aspx) (aspnet\_regiis.exe) для регистрации последнюю версию ASP.NET в IIS. Если этого не сделать, обнаружится, что IIS будет обслуживать статическое содержимое (например, HTML-файлы) без проблем, но он будет возвращать **404.0 Ошибка HTTP — не найден** при попытке перейти к содержимому ASP.NET. Можно использовать следующую процедуру, чтобы зарегистрировать ASP.NET 4.0.

**Чтобы зарегистрировать ASP.NET 4.0 в IIS**

1. Нажмите кнопку **запустить**, а затем введите **командной**.
2. В результатах поиска, щелкните правой кнопкой мыши **командной**, а затем нажмите кнопку **Запуск от имени администратора**.
3. В окне командной строки перейдите в раздел **%WINDIR%\Microsoft.NET\Framework\v4.0.30319** каталога.
4. Введите следующую команду и нажмите клавишу ВВОД:

    [!code-console[Main](configuring-a-web-server-for-web-deploy-publishing-offline-deployment/samples/sample1.cmd)]
5. Если вы планируете размещать 64-разрядных веб-приложения в любой момент, то также зарегистрировать 64-разрядной версии ASP.NET в IIS. Чтобы сделать это, в окне командной строки, перейдите к **%WINDIR%\Microsoft.NET\Framework64\v4.0.30319** каталога.
6. Введите следующую команду и нажмите клавишу ВВОД:

    [!code-console[Main](configuring-a-web-server-for-web-deploy-publishing-offline-deployment/samples/sample2.cmd)]

В качестве хорошей практикой используйте Windows Update еще раз на этом этапе для загрузки и установки доступных обновлений для новых продуктов и компонентов, которые вы установили.

## <a name="configure-the-iis-website"></a>Настройка веб-сайта IIS

Перед развертыванием веб-содержимого на сервер, необходимо создать и настроить веб-сайта IIS для размещения содержимого. Веб-развертывание можно развернуть веб-пакетов только для существующих веб-сайт IIS; не удается создать веб-сайт для вас. На высоком уровне необходимо выполнить следующие задачи:

- Создайте папку в файловой системе для размещения содержимого.
- Создание веб-сайта IIS для обслуживания содержимого и свяжите его с локальной папкой.
- Предоставление разрешения на чтение для удостоверения пула приложений в локальной папке.

Хотя ничто не мешает развертывания содержимого на веб-сайт по умолчанию в службах IIS, этот подход не рекомендуется для всего, кроме сценариев тестирования или демонстрации. Для имитации рабочей среде, следует создать новый веб-сайт IIS с параметрами, которые относятся к требованиям приложения.

**Для создания и настройки веб-сайта IIS**

1. В локальной файловой системе, создайте папку для хранения содержимого (например, **C:\DemoSite**).
2. На **запустить** последовательно выберите пункты **Администрирование**, а затем нажмите кнопку **Internet Information Services (IIS) Manager**.
3. В диспетчере служб IIS в **подключений** панели раскройте узел сервера (например, **PROWEB1**).

    ![](configuring-a-web-server-for-web-deploy-publishing-offline-deployment/_static/image3.png)
4. Щелкните правой кнопкой мыши **сайты** узел, а затем щелкните **добавить веб-сайт**.
5. В **имя_сайта** введите имя для веб-сайта IIS (например, **DemoSite**).
6. В **физический путь** введите (или перейдите к) путь к локальной папке (например, **C:\DemoSite**).
7. В **порт** введите номер порта, на котором будет размещаться веб-сайта (например, **85**).

    > [!NOTE]
    > Номера стандартных портов: 80 для HTTP и 443 для HTTPS. Тем не менее если вы размещаете этого веб-сайта через порт 80, необходимо остановить веб-сайт по умолчанию, чтобы обеспечить доступ к веб-узла.
8. Оставьте **имя узла** поле пустым, только если вы хотите настроить запись доменных имен (DNS) для веб-сайта, а затем нажмите кнопку **ОК**.

    ![](configuring-a-web-server-for-web-deploy-publishing-offline-deployment/_static/image4.png)

    > [!NOTE]
    > В рабочей среде скорее всего нужно будет разместить веб-сайт через порт 80 и Настройка заголовка узла, а также соответствующие записи DNS. Дополнительные сведения о настройке заголовков узлов в IIS 7, см. в разделе [Настройка заголовка узла для веб-сайта (IIS 7)](https://technet.microsoft.com/library/cc753195(WS.10).aspx). Дополнительные сведения о роли DNS-сервера в Windows Server 2008 R2, см. в разделе [Обзор DNS-сервера](https://technet.microsoft.com/en-gb/library/cc770392.aspx) и [DNS-сервер](https://technet.microsoft.com/windowsserver/dd448607).
9. В области **Действия** в разделе **Изменение веб-сайта**выберите пункт **Привязки**.
10. В **привязки сайта** диалоговом окне щелкните **добавить**.

    ![](configuring-a-web-server-for-web-deploy-publishing-offline-deployment/_static/image5.png)
11. В **Добавление привязки сайта** диалоговом окне set **IP-адрес** и **порт** в соответствии с существующей конфигурации сайта.
12. В **имя узла** введите имя веб-сервера (например, **PROWEB1**), а затем нажмите кнопку **ОК**.

    ![](configuring-a-web-server-for-web-deploy-publishing-offline-deployment/_static/image6.png)

    > [!NOTE]
    > Первой привязки сайта дает возможность доступа к сайту, локально с помощью IP-адрес и порт или `http://localhost:85`. Вторая привязка сайта дает возможность доступа к сайту с других компьютеров в домене с помощью имени компьютера (например, http://proweb1:85).
13. В **привязки сайта** диалоговом окне щелкните **закрыть**.
14. В **подключений** панели щелкните **пулы приложений**.
15. В **пулы приложений** панели, щелкните правой кнопкой мыши имя пула приложений и нажмите кнопку **основные параметры**. По умолчанию имя пула приложений будет соответствовать имени веб-сайта (например, **DemoSite**).
16. В **версии платформы .NET Framework** выберите **v4.0.30319 .NET Framework**, а затем нажмите кнопку **ОК**.

    ![](configuring-a-web-server-for-web-deploy-publishing-offline-deployment/_static/image7.png)

    > [!NOTE]
    > В примере решения требуется .NET Framework 4.0. Это не является требованием для веб-развертывания в целом.

Чтобы веб-сайт для предоставления содержимого удостоверение пула приложений должно иметь разрешения на чтение локальную папку, в котором хранится содержимое. В IIS 7.5 пулы приложений выполняются с уникальным пула приложений по умолчанию (в отличие от предыдущих версий IIS, где пулы приложений будут обычно выполняются с помощью учетной записи сетевой службы). Удостоверение пула приложений не является реальной учетной записью и не включаются в список пользователей или групп&#x2014;вместо этого оно создается динамически при запуске пула приложений. Каждый удостоверение пула приложений добавляется к локальной **IIS\_IUSRS** группы безопасности как скрытый элемент.

Чтобы предоставить разрешения для удостоверения пула приложений для файла или папки, можно двумя способами:

- Назначить разрешения для удостоверения пула приложений напрямую, используя формат <strong>IIS AppPool\</ strong ><em>[имя пула приложений]</em>(например, <strong>IIS AppPool\DemoSite</strong>).
- Назначение разрешений для **IIS\_IUSRS** группы.

Наиболее распространенным подходом является для назначения разрешений локальной **IIS\_IUSRS** группе, так как этот подход позволяет изменять пулы приложений без повторной настройки разрешений файловой системы. В следующей процедуре используется этот подход на основе групп.

> [!NOTE]
> Дополнительные сведения о удостоверения пула приложений в IIS 7.5 см. в разделе [удостоверения пула приложений](https://go.microsoft.com/?linkid=9805123).


**Чтобы настроить разрешения для веб-сайта IIS**

1. В обозревателе Windows перейдите в расположение своей локальной папки.
2. Щелкните правой кнопкой мыши папку и нажмите кнопку **свойства**.
3. На **безопасности** щелкните **изменить**, а затем нажмите кнопку **добавить**.
4. Нажмите кнопку **расположения**. В **расположения** диалоговом окне выберите локальный сервер, а затем нажмите кнопку **ОК**.

    ![](configuring-a-web-server-for-web-deploy-publishing-offline-deployment/_static/image8.png)
5. В **Выбор пользователей или групп** диалоговом окне **IIS\_IUSRS**, нажмите кнопку **проверить имена**, а затем нажмите кнопку **ОК**.
6. В <strong>разрешения для</strong><em>[имя папки]</em> диалоговом окне Обратите внимание, что назначить новую группу <strong>чтения &amp; выполнение</strong>, <strong>папки содержимое</strong>, и <strong>чтения</strong> разрешения по умолчанию. Оставьте без изменений и нажмите кнопку <strong>ОК</strong>.
7. Нажмите кнопку <strong>ОК</strong> закрыть <em>[имя папки]</em><strong>свойства</strong> диалоговое окно.

## <a name="disable-the-remote-agent-service"></a>Отключите службу удаленного агента

При установке веб-развертывания, службу агента веб-развертывания устанавливается и запускается автоматически. Эта служба позволяет развертывать и публиковать веб-пакеты из удаленного расположения. Надо будет использовать возможность удаленного развертывания таким образом, поэтому следует остановить и отключить службу.

> [!NOTE]
> Остановите службу удаленного агента для импорта и развертывания веб-пакета вручную не нужно. Тем не менее рекомендуется остановить и отключить службу, если вы не планируете использовать его.


Можно остановить и отключить службу в различные операции, используя различные служебные программы командной строки или командлетов Windows PowerShell. Эта процедура описывает простой подход на основе пользовательского интерфейса.

**Чтобы остановить и отключить службу удаленного агента**

1. Нажмите кнопку **Пуск** , выберите команду **Администрирование**, а затем выберите **Службы**.
2. В консоли «службы» найдите **службу агента веб-развертывания** строки.

    ![](configuring-a-web-server-for-web-deploy-publishing-offline-deployment/_static/image9.png)
3. Щелкните правой кнопкой мыши **службу агента веб-развертывания**, а затем нажмите кнопку **свойства**.
4. В **свойства веб-развертывания для службы агента** диалоговом окне щелкните **остановить**.
5. В **тип запуска** выберите **отключено**, а затем нажмите кнопку **ОК**.

    ![](configuring-a-web-server-for-web-deploy-publishing-offline-deployment/_static/image10.png)

## <a name="conclusion"></a>Заключение

На этом этапе веб-сервер готов для развертывания автономного веб-пакета. Прежде чем пытаться импортировать веб-пакеты на веб-сайте IIS, может потребоваться проверить следующие основные моменты:

- Зарегистрировано ASP.NET 4.0 в IIS?
- Имеет ли удостоверение пула приложений доступ на чтение к папке источника для веб-сайта?
- Ли остановить службу агента веб-развертывания?

> [!div class="step-by-step"]
> [Назад](configuring-a-web-server-for-web-deploy-publishing-web-deploy-handler.md)
> [Вперед](configuring-a-database-server-for-web-deploy-publishing.md)
