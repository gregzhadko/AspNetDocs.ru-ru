---
uid: web-forms/overview/deployment/configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment
title: Создание определения сборки, поддерживающего развертывание | Документация Майкрософт
author: jrjlee
description: Если вы хотите выполнить сборку любого типа в Team Foundation Server (TFS) 2010, необходимо создать определение сборки в командном проекте. В этом разделе DES...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: fe47a018-f6d0-4979-80e7-5b1fa75a5865
msc.legacyurl: /web-forms/overview/deployment/configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment
msc.type: authoredcontent
ms.openlocfilehash: e11c91a824446572aaf0b3bc6954b9b8ffb4eaff
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78489012"
---
# <a name="creating-a-build-definition-that-supports-deployment"></a><span data-ttu-id="f6128-104">Создание определения сборки, поддерживающего развертывание</span><span class="sxs-lookup"><span data-stu-id="f6128-104">Creating a Build Definition That Supports Deployment</span></span>

<span data-ttu-id="f6128-105">кто [Джейсон Иванов](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="f6128-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="f6128-106">Скачать в формате PDF</span><span class="sxs-lookup"><span data-stu-id="f6128-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="f6128-107">Если вы хотите выполнить сборку любого типа в Team Foundation Server (TFS) 2010, необходимо создать определение сборки в командном проекте.</span><span class="sxs-lookup"><span data-stu-id="f6128-107">If you want to perform any kind of build in Team Foundation Server (TFS) 2010, you need to create a build definition within your team project.</span></span> <span data-ttu-id="f6128-108">В этом разделе описывается создание нового определения сборки в TFS и управление веб-развертыванием в рамках процесса сборки в Team Build.</span><span class="sxs-lookup"><span data-stu-id="f6128-108">This topic describes how to create a new build definition in TFS and how to control web deployment as part of the build process in Team Build.</span></span>

<span data-ttu-id="f6128-109">Этот раздел является частью серии руководств, основанных на требованиях Enterprise к развертыванию вымышленной компании Fabrikam, Inc. В этой серии руководств используется пример решения&#x2014; [диспетчера контактов](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;для представления веб-приложения с реалистичным уровнем сложности, включая приложение ASP.NET MVC 3, службу Windows Communication Foundation (WCF) и проект базы данных.</span><span class="sxs-lookup"><span data-stu-id="f6128-109">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="f6128-110">Метод развертывания в сердце этих учебников основан на подходе к файлам проекта Split, описанному в разделе [понимание файла проекта](../web-deployment-in-the-enterprise/understanding-the-project-file.md), в котором процесс сборки и развертывания управляется двумя файлами&#x2014;проекта, содержащими инструкции по сборке, которые применяются к каждой целевой среде, и одна содержит параметры сборки и развертывания, относящиеся к конкретной среде.</span><span class="sxs-lookup"><span data-stu-id="f6128-110">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build and deployment process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="f6128-111">Во время сборки файл проекта, зависящий от среды, объединяется в файл проекта независимо от среды, чтобы сформировать полный набор инструкций по сборке.</span><span class="sxs-lookup"><span data-stu-id="f6128-111">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="task-overview"></a><span data-ttu-id="f6128-112">Обзор задач</span><span class="sxs-lookup"><span data-stu-id="f6128-112">Task Overview</span></span>

<span data-ttu-id="f6128-113">Определение сборки — это механизм, который управляет тем, как и когда выполняются сборки для командных проектов в TFS.</span><span class="sxs-lookup"><span data-stu-id="f6128-113">A build definition is the mechanism that controls how and when builds occur for team projects in TFS.</span></span> <span data-ttu-id="f6128-114">Каждое определение сборки определяет:</span><span class="sxs-lookup"><span data-stu-id="f6128-114">Each build definition specifies:</span></span>

- <span data-ttu-id="f6128-115">Объекты, которые необходимо собрать, например файлы решений Visual Studio или файлы проектов пользовательского Microsoft Build Engine (MSBuild).</span><span class="sxs-lookup"><span data-stu-id="f6128-115">The things you want to build, like Visual Studio solution files or custom Microsoft Build Engine (MSBuild) project files.</span></span>
- <span data-ttu-id="f6128-116">Критерии, определяющие, когда должна выполняться сборка, например ручные триггеры, непрерывная интеграция (CI) или условные записи с проверкой изменений.</span><span class="sxs-lookup"><span data-stu-id="f6128-116">The criteria that determine when a build should take place, like manual triggers, continuous integration (CI), or gated check-ins.</span></span>
- <span data-ttu-id="f6128-117">Расположение, в которое Team Build должна отсылать выходные данные сборки, включая артефакты развертывания, такие как веб-пакеты и скрипты базы данных.</span><span class="sxs-lookup"><span data-stu-id="f6128-117">The location to which Team Build should send build outputs, including deployment artifacts like web packages and database scripts.</span></span>
- <span data-ttu-id="f6128-118">Время, в течение которого должна храниться каждая сборка.</span><span class="sxs-lookup"><span data-stu-id="f6128-118">The amount of time that each build should be retained.</span></span>
- <span data-ttu-id="f6128-119">Различные другие параметры процесса сборки.</span><span class="sxs-lookup"><span data-stu-id="f6128-119">Various other parameters of the build process.</span></span>

> [!NOTE]
> <span data-ttu-id="f6128-120">Дополнительные сведения об определениях сборки см. в разделе [Определение процесса сборки](https://msdn.microsoft.com/library/ms181715.aspx).</span><span class="sxs-lookup"><span data-stu-id="f6128-120">For more information on build definitions, see [Define Your Build Process](https://msdn.microsoft.com/library/ms181715.aspx).</span></span>

<span data-ttu-id="f6128-121">В этом разделе будет показано, как создать определение сборки, использующее CI, чтобы сборка активировалась при возврате нового содержимого разработчиком.</span><span class="sxs-lookup"><span data-stu-id="f6128-121">This topic will show you how to create a build definition that uses CI, so that a build is triggered when a developer checks in new content.</span></span> <span data-ttu-id="f6128-122">Если сборка выполняется, служба сборки запускает пользовательский файл проекта для развертывания решения в тестовой среде.</span><span class="sxs-lookup"><span data-stu-id="f6128-122">If the build succeeds, the build service runs a custom project file to deploy the solution to a test environment.</span></span>

<span data-ttu-id="f6128-123">При активации сборки должны произойти следующие действия.</span><span class="sxs-lookup"><span data-stu-id="f6128-123">When you trigger a build, these actions need to happen:</span></span>

- <span data-ttu-id="f6128-124">Во первых, Team Build должен создать решение.</span><span class="sxs-lookup"><span data-stu-id="f6128-124">First, Team Build should build the solution.</span></span> <span data-ttu-id="f6128-125">В рамках этого процесса Team Build будет вызывать конвейер веб-публикации (WPP) для создания пакетов веб-развертывания для каждого из проектов веб-приложений в решении.</span><span class="sxs-lookup"><span data-stu-id="f6128-125">As part of this process, Team Build will invoke the Web Publishing Pipeline (WPP) to generate web deployment packages for each of the web application projects in the solution.</span></span> <span data-ttu-id="f6128-126">Team Build также будет выполнять любые модульные тесты, связанные с решением.</span><span class="sxs-lookup"><span data-stu-id="f6128-126">Team Build will also run any unit tests associated with the solution.</span></span>
- <span data-ttu-id="f6128-127">В случае сбоя сборки решения Командная сборка не должна предпринимать никаких действий.</span><span class="sxs-lookup"><span data-stu-id="f6128-127">If the solution build fails, Team Build should take no further action.</span></span> <span data-ttu-id="f6128-128">Ошибки модульного теста следует рассматривать как сбой сборки.</span><span class="sxs-lookup"><span data-stu-id="f6128-128">Unit test failures should be treated as a build failure.</span></span>
- <span data-ttu-id="f6128-129">Если сборка решения будет выполнена, Team Build должен запустить файл пользовательского проекта, который управляет развертыванием решения.</span><span class="sxs-lookup"><span data-stu-id="f6128-129">If the solution build succeeds, Team Build should run the custom project file that controls the deployment of the solution.</span></span> <span data-ttu-id="f6128-130">В рамках этого процесса Team Build вызовет средство веб-развертывания службы IIS (IIS) (веб-развертывание) для установки упакованных веб-приложений на конечных веб-серверах и вызовет служебную программу VSDBCMD. exe для запуска создания базы данных. сценарии на целевых серверах баз данных.</span><span class="sxs-lookup"><span data-stu-id="f6128-130">As part of this process, Team Build will invoke the Internet Information Services (IIS) Web Deployment Tool (Web Deploy) to install the packaged web applications on the destination web servers, and it will invoke the VSDBCMD.exe utility to run database creation scripts on the destination database servers.</span></span>

<span data-ttu-id="f6128-131">Это иллюстрирует процесс:</span><span class="sxs-lookup"><span data-stu-id="f6128-131">This illustrates the process:</span></span>

![](creating-a-build-definition-that-supports-deployment/_static/image1.png)

<span data-ttu-id="f6128-132">Пример решения [диспетчера контактов](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) включает файл пользовательского проекта MSBuild, *Publish. proj*, который можно запускать из MSBuild или Team Build.</span><span class="sxs-lookup"><span data-stu-id="f6128-132">The [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) sample solution includes a custom MSBuild project file, *Publish.proj*, that you can run from MSBuild or Team Build.</span></span> <span data-ttu-id="f6128-133">Как описано в разделе [Общие сведения о процессе сборки](../web-deployment-in-the-enterprise/understanding-the-build-process.md), этот файл проекта определяет логику, которая развертывает веб-пакеты и базы данных в целевой среде.</span><span class="sxs-lookup"><span data-stu-id="f6128-133">As described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md), this project file defines the logic that deploys your web packages and databases to a target environment.</span></span> <span data-ttu-id="f6128-134">Файл содержит логику, в которой не содержится процесс сборки и упаковки, если он выполняется в Team Build, и при этом выполняются только задачи развертывания.</span><span class="sxs-lookup"><span data-stu-id="f6128-134">The file includes logic that omits the building and packaging process if it's running in Team Build, leaving just the deployment tasks to run.</span></span> <span data-ttu-id="f6128-135">Это связано с тем, что при автоматизации развертывания таким образом, как правило, необходимо убедиться, что решение успешно построено и пройдет все модульные тесты перед началом процесса развертывания.</span><span class="sxs-lookup"><span data-stu-id="f6128-135">This is because when you automate deployment in this way, you'll typically want to ensure that the solution builds successfully and passes any unit tests before the deployment process commences.</span></span>

<span data-ttu-id="f6128-136">В следующем разделе объясняется, как реализовать этот процесс путем создания нового определения сборки.</span><span class="sxs-lookup"><span data-stu-id="f6128-136">The next section explains how to implement this process by creating a new build definition.</span></span>

> [!NOTE]
> <span data-ttu-id="f6128-137">Эта процедура&#x2014;, при которой один автоматизированный процесс создает, тестирует и развертывает решение&#x2014;, скорее всего, будет наиболее подходящим для развертывания в тестовых средах.</span><span class="sxs-lookup"><span data-stu-id="f6128-137">This procedure&#x2014;in which a single automated process builds, tests, and deploys a solution&#x2014;is likely to be most suited to deployment to test environments.</span></span> <span data-ttu-id="f6128-138">Для промежуточной и рабочей сред гораздо чаще требуется развернуть содержимое из предыдущей сборки, которая уже проверена и проверена в тестовой среде.</span><span class="sxs-lookup"><span data-stu-id="f6128-138">For staging and production environments you're a lot more likely to want to deploy content from a previous build that you've already verified and validated in a test environment.</span></span> <span data-ttu-id="f6128-139">Этот подход описан в следующем разделе [развертывание определенной сборки](deploying-a-specific-build.md).</span><span class="sxs-lookup"><span data-stu-id="f6128-139">This approach is described in the next topic, [Deploying a Specific Build](deploying-a-specific-build.md).</span></span>

### <a name="who-performs-this-procedure"></a><span data-ttu-id="f6128-140">Кто выполняет эту процедуру?</span><span class="sxs-lookup"><span data-stu-id="f6128-140">Who Performs This Procedure?</span></span>

<span data-ttu-id="f6128-141">Как правило, эта процедура выполняется администратором Team Foundation Server.</span><span class="sxs-lookup"><span data-stu-id="f6128-141">Typically, a TFS administrator performs this procedure.</span></span> <span data-ttu-id="f6128-142">В некоторых случаях руководитель группы разработчиков может принять участие в данной коллекции командных проектов в TFS.</span><span class="sxs-lookup"><span data-stu-id="f6128-142">In some cases, a developer team leader may take responsibility for the team project collection in TFS.</span></span> <span data-ttu-id="f6128-143">Чтобы создать новое определение сборки, необходимо быть членом группы " **Администраторы сборки коллекции проектов** " для коллекции командных проектов, содержащей ваше решение.</span><span class="sxs-lookup"><span data-stu-id="f6128-143">In order to create a new build definition, you need to be a member of the **Project Collection Build Administrators** group for the team project collection that contains your solution.</span></span>

## <a name="create-a-build-definition-for-ci-and-deployment"></a><span data-ttu-id="f6128-144">Создание определения сборки для CI и Deployment</span><span class="sxs-lookup"><span data-stu-id="f6128-144">Create a Build Definition for CI and Deployment</span></span>

<span data-ttu-id="f6128-145">В следующей процедуре описывается создание определения сборки, запускающего CI.</span><span class="sxs-lookup"><span data-stu-id="f6128-145">The next procedure describes how to create a build definition that CI triggers.</span></span> <span data-ttu-id="f6128-146">Если сборка выполняется, решение развертывается с помощью логики в пользовательском файле проекта MSBuild.</span><span class="sxs-lookup"><span data-stu-id="f6128-146">If the build succeeds, the solution is deployed using the logic in a custom MSBuild project file.</span></span>

<span data-ttu-id="f6128-147">**Создание определения сборки для CI и Deployment**</span><span class="sxs-lookup"><span data-stu-id="f6128-147">**To create a build definition for CI and deployment**</span></span>

1. <span data-ttu-id="f6128-148">В Visual Studio 2010 в окне **Team Explorer** разверните узел командного проекта, щелкните правой кнопкой мыши элемент **сборки**и выберите пункт **создать определение сборки**.</span><span class="sxs-lookup"><span data-stu-id="f6128-148">In Visual Studio 2010, in the **Team Explorer** window, expand your team project node, right-click **Builds**, and then click **New Build Definition**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image2.png)
2. <span data-ttu-id="f6128-149">На вкладке **Общие** присвойте определению сборки имя (например, **деплойтотест**) и необязательное описание.</span><span class="sxs-lookup"><span data-stu-id="f6128-149">On the **General** tab, give the build definition a name (for example, **DeployToTest**) and an optional description.</span></span>
3. <span data-ttu-id="f6128-150">На вкладке **триггер** выберите условия, по которым необходимо активировать новую сборку.</span><span class="sxs-lookup"><span data-stu-id="f6128-150">On the **Trigger** tab, select the criteria on which you want to trigger a new build.</span></span> <span data-ttu-id="f6128-151">Например, если вы хотите создать решение и развернуть его в тестовой среде каждый раз, когда разработчик вернет новый код, выберите **Непрерывная интеграция**.</span><span class="sxs-lookup"><span data-stu-id="f6128-151">For example, if you want to build the solution and deploy to the test environment every time a developer checks in new code, select **Continuous Integration**.</span></span>
4. <span data-ttu-id="f6128-152">На вкладке **сборки по умолчанию** в поле **Копировать выходные данные сборки в следующую папку сброса** введите UNC-путь к транзитной папке (например, **\\тфсбуилд\дропс**).</span><span class="sxs-lookup"><span data-stu-id="f6128-152">On the **Build Defaults** tab, in the **Copy build output to the following drop folder** box, type the Universal Naming Convention (UNC) path of your drop folder (for example, **\\TFSBUILD\Drops**).</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image3.png)

    > [!NOTE]
    > <span data-ttu-id="f6128-153">В этом расположении сброса хранится несколько сборок в зависимости от настроенной политики хранения.</span><span class="sxs-lookup"><span data-stu-id="f6128-153">This drop location stores several builds, depending on the retention policy you configure.</span></span> <span data-ttu-id="f6128-154">Если требуется опубликовать артефакты развертывания из определенной сборки в промежуточную или рабочую среду, здесь они будут найдены.</span><span class="sxs-lookup"><span data-stu-id="f6128-154">When you want to publish deployment artifacts from a specific build to a staging or production environment, this is where you'll find them.</span></span>
5. <span data-ttu-id="f6128-155">На вкладке **процесс** в раскрывающемся списке **файл процесса сборки** оставьте выбранным **дефаулттемплате. XAML** .</span><span class="sxs-lookup"><span data-stu-id="f6128-155">On the **Process** tab, in the **Build process file** dropdown list, leave **DefaultTemplate.xaml** selected.</span></span> <span data-ttu-id="f6128-156">Это один из шаблонов процесса сборки по умолчанию, который добавляется во все новые командные проекты.</span><span class="sxs-lookup"><span data-stu-id="f6128-156">This is one of the default build process templates that get added to all new team projects.</span></span>
6. <span data-ttu-id="f6128-157">В таблице **Параметры процесса сборки** щелкните в строке **элементы для построения** , а затем нажмите кнопку **с многоточием** .</span><span class="sxs-lookup"><span data-stu-id="f6128-157">In the **Build process parameters** table, click in the **Items to Build** row, and then click the **ellipsis** button.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image4.png)
7. <span data-ttu-id="f6128-158">В диалоговом окне **элементы для построения** нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="f6128-158">In the **Items to Build** dialog box, click **Add**.</span></span>
8. <span data-ttu-id="f6128-159">Перейдите к расположению файла решения и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="f6128-159">Browse to the location of your solution file, and then click **OK**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image5.png)
9. <span data-ttu-id="f6128-160">В диалоговом окне **элементы для построения** нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="f6128-160">In the **Items to Build** dialog box, click **Add**.</span></span>
10. <span data-ttu-id="f6128-161">В раскрывающемся списке **элементы типа** выберите **файлы проекта MSBuild**.</span><span class="sxs-lookup"><span data-stu-id="f6128-161">In the **Items of type** dropdown list, select **MSBuild Project files**.</span></span>
11. <span data-ttu-id="f6128-162">Перейдите к расположению файла настраиваемого проекта, в котором вы управляете процессом развертывания, выберите файл и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="f6128-162">Browse to the location of the custom project file with which you control the deployment process, select the file, and then click **OK**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image6.png)
12. <span data-ttu-id="f6128-163">В диалоговом окне **элементы для построения** теперь должны отображаться два элемента.</span><span class="sxs-lookup"><span data-stu-id="f6128-163">The **Items to Build** dialog box should now show two items.</span></span> <span data-ttu-id="f6128-164">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="f6128-164">Click **OK**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image7.png)
13. <span data-ttu-id="f6128-165">На вкладке **процесс** в таблице **Параметры процесса построения** разверните раздел **Дополнительно** .</span><span class="sxs-lookup"><span data-stu-id="f6128-165">On the **Process** tab, in the **Build process parameters** table, expand the **Advanced** section.</span></span>
14. <span data-ttu-id="f6128-166">В строке **Аргументы MSBuild** добавьте аргументы командной строки MSBuild, которые требуются для сборки *любого* из элементов.</span><span class="sxs-lookup"><span data-stu-id="f6128-166">In the **MSBuild Arguments** row, add any MSBuild command-line arguments that *either* of your items to build requires.</span></span> <span data-ttu-id="f6128-167">В сценарии решения диспетчера контактов эти аргументы являются обязательными:</span><span class="sxs-lookup"><span data-stu-id="f6128-167">In the Contact Manager solution scenario, these arguments are required:</span></span>

    [!code-console[Main](creating-a-build-definition-that-supports-deployment/samples/sample1.cmd)]

    ![](creating-a-build-definition-that-supports-deployment/_static/image8.png)
15. <span data-ttu-id="f6128-168">В данном примере:</span><span class="sxs-lookup"><span data-stu-id="f6128-168">In this example:</span></span>

    1. <span data-ttu-id="f6128-169">Аргументы пакета **деплойонбуилд = true** и **деплойтаржет =** являются обязательными при построении решения диспетчера контактов.</span><span class="sxs-lookup"><span data-stu-id="f6128-169">The **DeployOnBuild=true** and **DeployTarget=package** arguments are required when you build the Contact Manager solution.</span></span> <span data-ttu-id="f6128-170">Это указывает MSBuild создавать пакеты веб-развертывания после сборки каждого проекта веб-приложения, как описано в статье [Создание и упаковка проектов веб-приложений](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md).</span><span class="sxs-lookup"><span data-stu-id="f6128-170">This instructs MSBuild to create web deployment packages after building each web application project, as described in [Building and Packaging Web Application Projects](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md).</span></span>
    2. <span data-ttu-id="f6128-171">Аргумент **таржетенвпропсфиле** является обязательным при построении файла *Publish. proj* .</span><span class="sxs-lookup"><span data-stu-id="f6128-171">The **TargetEnvPropsFile** argument is required when you build the *Publish.proj* file.</span></span> <span data-ttu-id="f6128-172">Это свойство указывает расположение файла конфигурации для конкретной среды, как описано в разделе [Основные сведения о процессе сборки](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="f6128-172">This property indicates the location of the environment-specific configuration file, as described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span>
16. <span data-ttu-id="f6128-173">На вкладке **Политика хранения** укажите, сколько сборок каждого типа необходимо хранить в соответствии с требованиями.</span><span class="sxs-lookup"><span data-stu-id="f6128-173">On the **Retention Policy** tab, configure how many builds of each type you want to retain as required.</span></span>
17. <span data-ttu-id="f6128-174">Выберите команду **Сохранить**.</span><span class="sxs-lookup"><span data-stu-id="f6128-174">Click **Save**.</span></span>

## <a name="queue-a-build"></a><span data-ttu-id="f6128-175">Помещение построения в очередь</span><span class="sxs-lookup"><span data-stu-id="f6128-175">Queue a Build</span></span>

<span data-ttu-id="f6128-176">На этом этапе вы создали по крайней мере одно новое определение сборки.</span><span class="sxs-lookup"><span data-stu-id="f6128-176">At this point, you have created at least one new build definition.</span></span> <span data-ttu-id="f6128-177">Определенный процесс сборки теперь будет выполняться в соответствии с триггерами, указанными в определении сборки.</span><span class="sxs-lookup"><span data-stu-id="f6128-177">The build process you defined will now run according to the triggers you specified in the build definition.</span></span>

<span data-ttu-id="f6128-178">Если определение сборки настроено для использования CI, можно проверить определение сборки двумя способами:</span><span class="sxs-lookup"><span data-stu-id="f6128-178">If you've configured your build definition to use CI, you can test your build definition in two ways:</span></span>

- <span data-ttu-id="f6128-179">Верните некоторое содержимое в командный проект, чтобы активировать автоматическую сборку.</span><span class="sxs-lookup"><span data-stu-id="f6128-179">Check in some content to the team project to trigger an automatic build.</span></span>
- <span data-ttu-id="f6128-180">Постановка сборки в очередь вручную.</span><span class="sxs-lookup"><span data-stu-id="f6128-180">Queue a build manually.</span></span>

<span data-ttu-id="f6128-181">**Постановка сборки в очередь вручную**</span><span class="sxs-lookup"><span data-stu-id="f6128-181">**To queue a build manually**</span></span>

1. <span data-ttu-id="f6128-182">В окне **Team Explorer** щелкните правой кнопкой мыши определение сборки и выберите пункт **поставить в очередь новую сборку**.</span><span class="sxs-lookup"><span data-stu-id="f6128-182">In the **Team Explorer** window, right-click the build definition, and then click **Queue New Build**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image9.png)
2. <span data-ttu-id="f6128-183">В диалоговом окне **Создание очереди** просмотрите свойства сборки и нажмите кнопку **очередь**.</span><span class="sxs-lookup"><span data-stu-id="f6128-183">In the **Queue Build** dialog box, review the build properties, and then click **Queue**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image10.png)

<span data-ttu-id="f6128-184">Чтобы проверить ход выполнения и результат сборки&#x2014;независимо от того, был ли он активирован вручную, или автоматически&#x2014;дважды щелкнуть определение сборки в окне **Team Explorer** .</span><span class="sxs-lookup"><span data-stu-id="f6128-184">To review the progress and the outcome of a build&#x2014;regardless of whether it was triggered manually or automatically&#x2014;double-click the build definition in the **Team Explorer** window.</span></span> <span data-ttu-id="f6128-185">Откроется вкладка **Обозреватель сборок** .</span><span class="sxs-lookup"><span data-stu-id="f6128-185">This will open a **Build Explorer** tab.</span></span>

![](creating-a-build-definition-that-supports-deployment/_static/image11.png)

<span data-ttu-id="f6128-186">Здесь можно устранить неполадки сборок со сбоями.</span><span class="sxs-lookup"><span data-stu-id="f6128-186">From here, you can troubleshoot failed builds.</span></span> <span data-ttu-id="f6128-187">Если дважды щелкнуть отдельную сборку, можно просмотреть сводные данные и перейти к подробным файлам журнала.</span><span class="sxs-lookup"><span data-stu-id="f6128-187">If you double-click an individual build, you can view summary information and click through to detailed log files.</span></span>

![](creating-a-build-definition-that-supports-deployment/_static/image12.png)

<span data-ttu-id="f6128-188">Эти сведения можно использовать для устранения неполадок сборок, завершившихся сбоем, и устранения всех проблем, прежде чем пытаться выполнить другую сборку.</span><span class="sxs-lookup"><span data-stu-id="f6128-188">You can use this information to troubleshoot failed builds and address any problems before you attempt another build.</span></span>

> [!NOTE]
> <span data-ttu-id="f6128-189">Сборки, выполняющие логику развертывания, скорее всего, завершатся неудачей, пока вы не предоставили серверу сборки разрешения, необходимые в целевой среде.</span><span class="sxs-lookup"><span data-stu-id="f6128-189">Builds that execute deployment logic are likely to fail until you have granted the build server any permissions required in the destination environment.</span></span> <span data-ttu-id="f6128-190">Дополнительные сведения см. в разделе [Настройка разрешений для развертывания Team Build](configuring-permissions-for-team-build-deployment.md).</span><span class="sxs-lookup"><span data-stu-id="f6128-190">For more information, see [Configuring Permissions for Team Build Deployment](configuring-permissions-for-team-build-deployment.md).</span></span>

## <a name="monitor-the-build-process"></a><span data-ttu-id="f6128-191">Мониторинг процесса сборки</span><span class="sxs-lookup"><span data-stu-id="f6128-191">Monitor the Build Process</span></span>

<span data-ttu-id="f6128-192">TFS предоставляет широкий спектр функций, помогающих отслеживать процесс сборки.</span><span class="sxs-lookup"><span data-stu-id="f6128-192">TFS provides a broad range of functionality to help you monitor the build process.</span></span> <span data-ttu-id="f6128-193">Например, TFS может отправить вам сообщение электронной почты или отобразить оповещения в области уведомлений на панели задач после завершения сборки.</span><span class="sxs-lookup"><span data-stu-id="f6128-193">For example, TFS can send you an email or display alerts in your taskbar notification area when a build has completed.</span></span> <span data-ttu-id="f6128-194">Дополнительные сведения см. в разделе [Запуск и мониторинг сборок](https://msdn.microsoft.com/library/ms181721.aspx).</span><span class="sxs-lookup"><span data-stu-id="f6128-194">For more information, see [Run and Monitor Builds](https://msdn.microsoft.com/library/ms181721.aspx).</span></span>

## <a name="conclusion"></a><span data-ttu-id="f6128-195">Заключение</span><span class="sxs-lookup"><span data-stu-id="f6128-195">Conclusion</span></span>

<span data-ttu-id="f6128-196">В этом разделе описано, как создать определение сборки в TFS.</span><span class="sxs-lookup"><span data-stu-id="f6128-196">This topic described how to create a build definition in TFS.</span></span> <span data-ttu-id="f6128-197">Определение сборки настроено для CI, поэтому процесс сборки выполняется каждый раз, когда разработчик возвращает содержимое в командный проект.</span><span class="sxs-lookup"><span data-stu-id="f6128-197">The build definition is configured for CI, so the build process runs whenever a developer checks in content to the team project.</span></span> <span data-ttu-id="f6128-198">Определение сборки выполняет пользовательский файл проекта MSBuild для развертывания веб-пакетов и скриптов базы данных в среде целевого сервера.</span><span class="sxs-lookup"><span data-stu-id="f6128-198">The build definition executes a custom MSBuild project file to deploy web packages and database scripts to a target server environment.</span></span>

<span data-ttu-id="f6128-199">Чтобы автоматическое развертывание было завершено в рамках процесса сборки, необходимо предоставить соответствующие разрешения учетной записи службы сборки на целевых веб-серверах и целевом сервере базы данных.</span><span class="sxs-lookup"><span data-stu-id="f6128-199">In order for an automated deployment to succeed as part of a build process, you'll need to grant appropriate permissions to the build service account on the target web servers and the target database server.</span></span> <span data-ttu-id="f6128-200">В последнем разделе этого руководства, [настройке разрешений для развертывания Team Build](configuring-permissions-for-team-build-deployment.md), описывается, как определить и настроить разрешения, необходимые для автоматического развертывания с сервера Team Build.</span><span class="sxs-lookup"><span data-stu-id="f6128-200">The final topic in this tutorial, [Configuring Permissions for Team Build Deployment](configuring-permissions-for-team-build-deployment.md), describes how to identify and configure the permissions required for automated deployment from a Team Build server.</span></span>

## <a name="further-reading"></a><span data-ttu-id="f6128-201">Дополнительные материалы</span><span class="sxs-lookup"><span data-stu-id="f6128-201">Further Reading</span></span>

<span data-ttu-id="f6128-202">Дополнительные сведения о создании определений сборки см. в разделе [Создание базового определения сборки](https://msdn.microsoft.com/library/ms181716.aspx) и [Определение процесса сборки](https://msdn.microsoft.com/library/ms181715.aspx).</span><span class="sxs-lookup"><span data-stu-id="f6128-202">For more information on creating build definitions, see [Create a Basic Build Definition](https://msdn.microsoft.com/library/ms181716.aspx) and [Define Your Build Process](https://msdn.microsoft.com/library/ms181715.aspx).</span></span> <span data-ttu-id="f6128-203">Дополнительные рекомендации по построению очередей см. в разделе [очередь сборки](https://msdn.microsoft.com/library/ms181722.aspx).</span><span class="sxs-lookup"><span data-stu-id="f6128-203">For more guidance on queuing builds, see [Queue a Build](https://msdn.microsoft.com/library/ms181722.aspx).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f6128-204">[Назад](configuring-a-tfs-build-server-for-web-deployment.md)
> [Вперед](deploying-a-specific-build.md)</span><span class="sxs-lookup"><span data-stu-id="f6128-204">[Previous](configuring-a-tfs-build-server-for-web-deployment.md)
[Next](deploying-a-specific-build.md)</span></span>
