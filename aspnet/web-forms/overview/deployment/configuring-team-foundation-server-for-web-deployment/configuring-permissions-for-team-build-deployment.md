---
uid: web-forms/overview/deployment/configuring-team-foundation-server-for-web-deployment/configuring-permissions-for-team-build-deployment
title: Настройка разрешений для группы развертывания построения | Документация Майкрософт
author: jrjlee
description: В этом разделе описываются способы настройки разрешения, чтобы включить сервер сборки для развертывания содержимого на веб-серверов и серверов баз данных как часть автоматической b...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 2488a91e-b0a8-465a-b874-3233f724b56b
msc.legacyurl: /web-forms/overview/deployment/configuring-team-foundation-server-for-web-deployment/configuring-permissions-for-team-build-deployment
msc.type: authoredcontent
ms.openlocfilehash: 5699f72af6b8d7f18d1a2c631dfdedd63c66e1e6
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65133854"
---
# <a name="configuring-permissions-for-team-build-deployment"></a><span data-ttu-id="ea289-103">Настройка разрешений для развертывания командной сборки</span><span class="sxs-lookup"><span data-stu-id="ea289-103">Configuring Permissions for Team Build Deployment</span></span>

<span data-ttu-id="ea289-104">по [Джейсон Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="ea289-104">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="ea289-105">Загрузить PDF-файл</span><span class="sxs-lookup"><span data-stu-id="ea289-105">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="ea289-106">В этом разделе описываются способы настройки разрешения, чтобы включить сервер сборки для развертывания содержимого на веб-серверов и серверов баз данных как часть автоматизированного процесса сборки.</span><span class="sxs-lookup"><span data-stu-id="ea289-106">This topic describes how to configure permissions to enable your build server to deploy content to web servers and database servers as part of an automated build process.</span></span>

<span data-ttu-id="ea289-107">Этот раздел является частью серии учебников, исходя из требования к развертыванию enterprise вымышленной компании Fabrikam, Inc. В этой серии руководств используется пример решения&#x2014; [решения диспетчера контактов](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;для представления веб-приложения с более реалистичные уровень сложности, включая приложения ASP.NET MVC 3, Windows Communication Служба Foundation (WCF) и проект базы данных.</span><span class="sxs-lookup"><span data-stu-id="ea289-107">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="ea289-108">Метод развертывания в основе этих учебников основан на разбиение проекта файл подход, описанный в [основные сведения о файле проекта](../web-deployment-in-the-enterprise/understanding-the-project-file.md), в которой процесс построения управляется двумя файлы проекта&#x2014;один с Создание инструкции, которые применяются для каждой целевой среде и содержащего параметры построения и развертывания для конкретной среды.</span><span class="sxs-lookup"><span data-stu-id="ea289-108">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="ea289-109">Во время сборки файл проекта для конкретной среды объединяется в файл проекта независимой от среды, чтобы полный набор инструкций построения.</span><span class="sxs-lookup"><span data-stu-id="ea289-109">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="task-overview"></a><span data-ttu-id="ea289-110">Общие сведения о задачах</span><span class="sxs-lookup"><span data-stu-id="ea289-110">Task Overview</span></span>

<span data-ttu-id="ea289-111">При установке службы Team Foundation Server (TFS) 2010 сборки, необходимо указать удостоверение, с которым требуется, чтобы служба для запуска.</span><span class="sxs-lookup"><span data-stu-id="ea289-111">When you install the Team Foundation Server (TFS) 2010 build service, you specify the identity with which you want the service to run.</span></span> <span data-ttu-id="ea289-112">По умолчанию это учетная запись сетевой службы.</span><span class="sxs-lookup"><span data-stu-id="ea289-112">By default, this is the Network Service account.</span></span> <span data-ttu-id="ea289-113">Кроме того можно настроить службу сборки для запуска под учетной записью домена.</span><span class="sxs-lookup"><span data-stu-id="ea289-113">Alternatively, you can configure the build service to run using a domain account.</span></span>

<span data-ttu-id="ea289-114">Задачи развертывания, требующие проверки подлинности Windows, и вы планируете автоматизировать с помощью Team Build, будут выполняться с использованием удостоверения службы сборки.</span><span class="sxs-lookup"><span data-stu-id="ea289-114">Any deployment tasks that require Windows authentication, and that you plan to automate using Team Build, will run using the build service identity.</span></span> <span data-ttu-id="ea289-115">Таким образом необходимо предоставить удостоверение службы сборки все необходимые разрешения на веб-серверах и серверах баз данных.</span><span class="sxs-lookup"><span data-stu-id="ea289-115">As such, you'll need to grant the build service identity any required permissions on your web servers and your database servers.</span></span>

> [!NOTE]
> <span data-ttu-id="ea289-116">Учетной записи сетевой службы используется учетная запись компьютера для проверки подлинности на других компьютерах.</span><span class="sxs-lookup"><span data-stu-id="ea289-116">The Network Service account uses the machine account to authenticate to other computers.</span></span> <span data-ttu-id="ea289-117">Учетные записи компьютера принимать форму \* [домен]\[имя компьютера] \***$**&#x2014;к примеру, **FABRIKAM\TFSBUILD$**.</span><span class="sxs-lookup"><span data-stu-id="ea289-117">Machine accounts take the form \*[domain name]\[machine name]\***$**&#x2014;for example, **FABRIKAM\TFSBUILD$**.</span></span> <span data-ttu-id="ea289-118">Таким образом Если службе сборки выполняется с помощью удостоверения сетевой службы, следует предоставлять любые разрешения, необходимые для идентификатор учетной записи для сервера сборки.</span><span class="sxs-lookup"><span data-stu-id="ea289-118">As such, if your build service runs using the Network Service identity, you should grant any required permissions to the machine account identity for your build server.</span></span>

## <a name="configuring-web-server-permissions"></a><span data-ttu-id="ea289-119">Настройка разрешений веб-сервера</span><span class="sxs-lookup"><span data-stu-id="ea289-119">Configuring Web Server Permissions</span></span>

<span data-ttu-id="ea289-120">Как описано в разделе [Выбор оптимального подхода для веб-развертывания справа](../configuring-server-environments-for-web-deployment/choosing-the-right-approach-to-web-deployment.md), существует два основных подхода, можно использовать, если вы хотите развернуть веб-пакеты на удаленном веб-сервере:</span><span class="sxs-lookup"><span data-stu-id="ea289-120">As described in [Choosing the Right Approach to Web Deployment](../configuring-server-environments-for-web-deployment/choosing-the-right-approach-to-web-deployment.md), there are two main approaches you can use if you want to deploy web packages to a remote web server:</span></span>

- <span data-ttu-id="ea289-121">Развертывание приложения из удаленного расположения, обращаясь к *службу агента веб-развертывания* (также известный как удаленный агент) на целевом сервере.</span><span class="sxs-lookup"><span data-stu-id="ea289-121">Deploy the application from a remote location by targeting the *Web Deployment Agent Service* (also known as the remote agent) on the destination server.</span></span>
- <span data-ttu-id="ea289-122">Развертывание приложения из удаленного расположения, обращаясь к *Internet Information Services* (*IIS) веб-развертывание обработчик* на целевом сервере.</span><span class="sxs-lookup"><span data-stu-id="ea289-122">Deploy the application from a remote location by targeting the *Internet Information Services* (*IIS) Web Deploy Handler* on the destination server.</span></span>

<span data-ttu-id="ea289-123">Удаленный агент в этом случае есть два ключа ограничения:</span><span class="sxs-lookup"><span data-stu-id="ea289-123">The remote agent has two key limitations in this case:</span></span>

- <span data-ttu-id="ea289-124">Удаленный агент поддерживает только проверку подлинности NTLM.</span><span class="sxs-lookup"><span data-stu-id="ea289-124">The remote agent supports only NTLM authentication.</span></span> <span data-ttu-id="ea289-125">Другими словами, развертывание необходимо использовать удостоверение службы сборки&#x2014;не может олицетворять другую учетную запись.</span><span class="sxs-lookup"><span data-stu-id="ea289-125">In other words, the deployment must use the build service identity&#x2014;you can't impersonate another account.</span></span>
- <span data-ttu-id="ea289-126">Чтобы использовать удаленный агент, учетная запись, которая выполняет развертывание необходимо быть администратором на целевом сервере.</span><span class="sxs-lookup"><span data-stu-id="ea289-126">To use the remote agent, the account that performs the deployment must be an administrator on the target server.</span></span>

<span data-ttu-id="ea289-127">Вместе эти два ограничения сделать подход удаленный агент, нежелательным для автоматизированного развертывания Team Build.</span><span class="sxs-lookup"><span data-stu-id="ea289-127">Together, these two limitations make the remote agent approach undesirable for an automated Team Build deployment.</span></span> <span data-ttu-id="ea289-128">Чтобы использовать этот подход, потребовалось бы для построения службы учетной записи администратора на любой целевой веб-серверах.</span><span class="sxs-lookup"><span data-stu-id="ea289-128">To use this approach, you'd need to make the build service account an administrator on any target web servers.</span></span>

<span data-ttu-id="ea289-129">Напротив веб-развертывание обработчик подход дает различные преимущества.</span><span class="sxs-lookup"><span data-stu-id="ea289-129">In contrast, the Web Deploy Handler approach offers various advantages:</span></span>

- <span data-ttu-id="ea289-130">Веб-развертывание обработчик поддерживает обычную проверку подлинности по протоколу HTTPS, служащее для передачи учетных данных учетной записи альтернативное средство IIS веб-развертывания (веб-развертывания).</span><span class="sxs-lookup"><span data-stu-id="ea289-130">The Web Deploy Handler supports basic authentication over HTTPS, which allows you to pass the credentials of an alternative account to the IIS Web Deployment Tool (Web Deploy).</span></span>
- <span data-ttu-id="ea289-131">Можно настроить целевой веб-серверов, чтобы разрешить пользователям без прав администратора для развертывания содержимого для определенных служб IIS веб-сайтов, с помощью веб-развертывание обработчик.</span><span class="sxs-lookup"><span data-stu-id="ea289-131">You can configure target web servers to allow non-administrator users to deploy content to specific IIS websites using the Web Deploy Handler.</span></span>

<span data-ttu-id="ea289-132">Таким образом очевидно, что предпочтительнее целевой веб-развертывание обработчик при автоматизации развертывания веб-пакета с помощью Team Build.</span><span class="sxs-lookup"><span data-stu-id="ea289-132">As a result, it's clearly preferable to target the Web Deploy Handler when you automate web package deployment from Team Build.</span></span> <span data-ttu-id="ea289-133">Это рекомендуемый процесс:</span><span class="sxs-lookup"><span data-stu-id="ea289-133">This is the recommended process:</span></span>

1. <span data-ttu-id="ea289-134">Создайте учетную запись домена с низким уровнем привилегий для использования для развертывания.</span><span class="sxs-lookup"><span data-stu-id="ea289-134">Create a low-privileged domain account to use for the deployment.</span></span>
2. <span data-ttu-id="ea289-135">Настройка веб-развертывание обработчик и предоставьте учетной записи необходимые разрешения для развертывания содержимого на веб-узла IIS, как описано в разделе [Настройка веб-сервера для публикации веб-развертывания (веб-развертывание обработчик)](../configuring-server-environments-for-web-deployment/configuring-a-web-server-for-web-deploy-publishing-web-deploy-handler.md).</span><span class="sxs-lookup"><span data-stu-id="ea289-135">Configure the Web Deploy Handler and grant the account the required permissions to deploy content to a specific IIS website, as described in [Configuring a Web Server for Web Deploy Publishing (Web Deploy Handler)](../configuring-server-environments-for-web-deployment/configuring-a-web-server-for-web-deploy-publishing-web-deploy-handler.md).</span></span>
3. <span data-ttu-id="ea289-136">Вызвать веб-развертывания и предназначенных для веб-развертывание обработчик, обычная проверка подлинности и предоставление учетных данных учетной записи домена, созданный для выполнения развертывания.</span><span class="sxs-lookup"><span data-stu-id="ea289-136">Invoke Web Deploy and target the Web Deploy Handler, using basic authentication and supplying the credentials of the domain account you created, to perform the deployment.</span></span>

<span data-ttu-id="ea289-137">В [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) образец решения, укажите тип проверки подлинности (базовый или NTLM), учетные данные веб-развертывания и адрес конечной точки (удаленный агент или веб-развертывание обработчик) в файле проекта для конкретной среды.</span><span class="sxs-lookup"><span data-stu-id="ea289-137">In the [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) sample solution, you specify the authentication type (basic or NTLM), the Web Deploy credentials, and the endpoint address (remote agent or Web Deploy Handler) in the environment-specific project file.</span></span> <span data-ttu-id="ea289-138">Эти значения используются для формулирования и выполнения команды веб-развертывания, при выполнении файла проекта.</span><span class="sxs-lookup"><span data-stu-id="ea289-138">These values are used to formulate and run a Web Deploy command when the project file is executed.</span></span> <span data-ttu-id="ea289-139">Дополнительные сведения см. в разделе [развертывание веб-пакеты](../web-deployment-in-the-enterprise/deploying-web-packages.md).</span><span class="sxs-lookup"><span data-stu-id="ea289-139">For more information, see [Deploying Web Packages](../web-deployment-in-the-enterprise/deploying-web-packages.md).</span></span>

<span data-ttu-id="ea289-140">Дополнительные сведения о настройке развертывания веб-обработчик, включая настройку разрешений, см. в разделе [Настройка веб-сервера для публикации веб-развертывания (веб-развертывание обработчик)](../configuring-server-environments-for-web-deployment/configuring-a-web-server-for-web-deploy-publishing-web-deploy-handler.md).</span><span class="sxs-lookup"><span data-stu-id="ea289-140">For more information on configuring the Web Deploy Handler, including how to configure permissions, see [Configuring a Web Server for Web Deploy Publishing (Web Deploy Handler)](../configuring-server-environments-for-web-deployment/configuring-a-web-server-for-web-deploy-publishing-web-deploy-handler.md).</span></span> <span data-ttu-id="ea289-141">Дополнительные сведения о настройке удаленного агента, см. в разделе [Настройка веб-сервера для публикации веб-развертывания (удаленный агент)](../configuring-server-environments-for-web-deployment/configuring-a-web-server-for-web-deploy-publishing-remote-agent.md).</span><span class="sxs-lookup"><span data-stu-id="ea289-141">For more information on configuring the remote agent, see [Configuring a Web Server for Web Deploy Publishing (Remote Agent)](../configuring-server-environments-for-web-deployment/configuring-a-web-server-for-web-deploy-publishing-remote-agent.md).</span></span>

## <a name="configuring-database-server-permissions"></a><span data-ttu-id="ea289-142">Настройка разрешений для сервера базы данных</span><span class="sxs-lookup"><span data-stu-id="ea289-142">Configuring Database Server Permissions</span></span>

<span data-ttu-id="ea289-143">Чтобы развернуть базу данных SQL Server, необходимо сделать следующее:</span><span class="sxs-lookup"><span data-stu-id="ea289-143">To deploy a database to SQL Server, you must:</span></span>

- <span data-ttu-id="ea289-144">Создайте имя входа для учетной записи развертывания на экземпляре SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ea289-144">Create a login for the deploying account on the SQL Server instance.</span></span>
- <span data-ttu-id="ea289-145">Предоставьте имени входа **DBCreator** разрешений на экземпляре SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ea289-145">Grant the login **DBCreator** permissions on the SQL Server instance.</span></span>
- <span data-ttu-id="ea289-146">После первоначального развертывания, добавьте имя входа для **db\_владельца** роль в целевой базе данных.</span><span class="sxs-lookup"><span data-stu-id="ea289-146">After the initial deployment, add the login to the **db\_owner** role on the target database.</span></span> <span data-ttu-id="ea289-147">Это необходимо, так как при последующих развертываниях, вы изменение существующей базы данных, а не создавать новую базу данных.</span><span class="sxs-lookup"><span data-stu-id="ea289-147">This is required because on subsequent deployments, you're modifying an existing database rather than creating a new database.</span></span>

<span data-ttu-id="ea289-148">Можно выполнить проверку подлинности к экземпляру SQL Server, с помощью проверки подлинности NTLM или проверку подлинности SQL Server:</span><span class="sxs-lookup"><span data-stu-id="ea289-148">You can authenticate to a SQL Server instance using either NTLM authentication or SQL Server authentication:</span></span>

- <span data-ttu-id="ea289-149">Если вы используете проверку подлинности NTLM, необходимо предоставить разрешения, описанные выше, для учетной записи службы сборки.</span><span class="sxs-lookup"><span data-stu-id="ea289-149">If you use NTLM authentication, you need to grant the permissions described above to the build service account.</span></span>
- <span data-ttu-id="ea289-150">Если вы используете проверку подлинности SQL Server, необходимо предоставить разрешения, описанные выше, для учетной записи SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ea289-150">If you use SQL Server authentication, you need to grant the permissions described above to the SQL Server account.</span></span> <span data-ttu-id="ea289-151">Необходимо также включать имя пользователя SQL Server и пароль в строке подключения, используемой для развертывания базы данных.</span><span class="sxs-lookup"><span data-stu-id="ea289-151">You also need to include the SQL Server user name and password in the connection string you use to deploy the database.</span></span>

<span data-ttu-id="ea289-152">Пошаговые инструкции по настройке разрешений для развертывания базы данных, см. в разделе [Настройка сервера базы данных для развертывания веб-публикаций](../configuring-server-environments-for-web-deployment/configuring-a-database-server-for-web-deploy-publishing.md).</span><span class="sxs-lookup"><span data-stu-id="ea289-152">For step-by-step details on how to configure permissions for database deployment, see [Configuring a Database Server for Web Deploy Publishing](../configuring-server-environments-for-web-deployment/configuring-a-database-server-for-web-deploy-publishing.md).</span></span>

## <a name="conclusion"></a><span data-ttu-id="ea289-153">Заключение</span><span class="sxs-lookup"><span data-stu-id="ea289-153">Conclusion</span></span>

<span data-ttu-id="ea289-154">На этом этапе следует учитывать разрешения, необходимые, а также параметры проверки подлинности, которая открывает перед вами, при автоматизации веб-приложения и базы данных развертывания из Team Build.</span><span class="sxs-lookup"><span data-stu-id="ea289-154">At this point, you should understand the permissions required, together with the authentication options open to you, when you automate web application and database deployments from Team Build.</span></span> <span data-ttu-id="ea289-155">Также можно реализовать необходимые разрешения в IIS веб-серверов и серверов баз данных SQL Server.</span><span class="sxs-lookup"><span data-stu-id="ea289-155">You should also be able to implement the necessary permissions on IIS web servers and SQL Server database servers.</span></span>

## <a name="further-reading"></a><span data-ttu-id="ea289-156">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="ea289-156">Further Reading</span></span>

<span data-ttu-id="ea289-157">Дополнительные сведения о настройке среды Windows server для поддержки удаленного развертывания см. в разделе [Настройка серверных сред для веб-развертывания](../configuring-server-environments-for-web-deployment/configuring-server-environments-for-web-deployment.md).</span><span class="sxs-lookup"><span data-stu-id="ea289-157">For more information on configuring Windows server environments to support remote deployment, see [Configuring Server Environments for Web Deployment](../configuring-server-environments-for-web-deployment/configuring-server-environments-for-web-deployment.md).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="ea289-158">Назад</span><span class="sxs-lookup"><span data-stu-id="ea289-158">Previous</span></span>](deploying-a-specific-build.md)
