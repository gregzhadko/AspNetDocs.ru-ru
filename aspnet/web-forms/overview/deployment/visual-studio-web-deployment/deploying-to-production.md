---
uid: web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-production
title: 'ASP.NET веб-развертывание с помощью Visual Studio: развертывание в рабочей среде | Документация Майкрософт'
author: tdykstra
description: В этой серии руководств показано, как развернуть (опубликовать) веб-приложение ASP.NET в веб-приложениях службы приложений Azure или поставщике услуг размещения стороннего поставщика, Усин...
ms.author: riande
ms.date: 02/15/2013
ms.assetid: 416438a1-3b2f-4d27-bf53-6b76223c33bf
msc.legacyurl: /web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-production
msc.type: authoredcontent
ms.openlocfilehash: ddc3d15f0436c4c3a24491cf0377111768da67df
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74617640"
---
# <a name="aspnet-web-deployment-using-visual-studio-deploying-to-production"></a>Веб-развертывание ASP.NET с помощью Visual Studio: развертывание в рабочей среде

от [Tom Dykstra)](https://github.com/tdykstra)

[Скачать начальный проект](https://go.microsoft.com/fwlink/p/?LinkId=282627)

> В этой серии руководств показано, как развернуть (опубликовать) веб-приложение ASP.NET в веб-приложениях службы приложений Azure или поставщике услуг размещения стороннего поставщика с помощью Visual Studio 2012 или Visual Studio 2010. Сведения о ряде см. в [первом руководстве по ряду](introduction.md).

## <a name="overview"></a>Обзор

В этом руководстве описано, как настроить учетную запись Microsoft Azure, создать промежуточную и рабочую среду и развернуть веб-приложение ASP.NET в промежуточной и рабочей средах с помощью функции публикации одним щелчком в Visual Studio.

При желании можно выполнить развертывание на сторонних поставщика услуг размещения. Большинство процедур, описанных в этом руководстве, одинаковы для поставщика услуг размещения или для Azure, за исключением того, что каждый поставщик имеет собственный пользовательский интерфейс для управления учетными записями и веб-сайтами. Поставщик услуг размещения можно найти в [коллекции поставщиков](https://www.microsoft.com/web/hosting) на веб-сайте Microsoft.com.

Напоминание. Если вы получаете сообщение об ошибке или что-то не работает при работе с этим руководством, обязательно ознакомьтесь со страницей устранения неполадок в этой серии руководств.

## <a name="get-a-microsoft-azure-account"></a>Получение учетной записи Microsoft Azure

Если у вас еще нет учетной записи Azure, вы можете создать бесплатную пробную учетную запись всего за несколько минут. Дополнительные сведения см. в статье [Бесплатная пробная версия Azure](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).

## <a name="create-a-staging-environment"></a>Создание промежуточной среды

> [!NOTE]
> Поскольку этот учебник написан, служба приложений Azure добавила новую функцию для автоматизации многих процессов создания промежуточных и рабочих сред. См. раздел [Настройка промежуточных сред для веб-приложений в службе приложений Azure](https://azure.microsoft.com/documentation/articles/web-sites-staged-publishing/).

Как описано в [руководстве по развертыванию в среде тестирования](deploying-to-iis.md), самая надежная тестовая среда — это веб-сайт поставщика услуг размещения, который аналогичен рабочему веб-узлу. Во многих поставщиках услуг размещения вам пришлось бы взвесить преимущества этого по значительному дополнительным затратам, но в Azure вы можете создать дополнительное бесплатное веб-приложение в качестве промежуточного приложения. Кроме того, требуется база данных, а дополнительные затраты на это для вашей рабочей базы данных будут не ниже, чем в случае незначительных затрат. В Azure вы платите за используемое количество хранилища базы данных, а не для каждой базы данных, и объем дополнительного хранилища, который будет использоваться в промежуточном хранилище, будет минимальным.

Как описано в [руководстве по развертыванию в тестовой среде](deploying-to-iis.md), в промежуточной и рабочей средах вы собираетесь развернуть две базы данных в одной базе данных. Если вы хотите, чтобы они были раздельными, процесс будет таким же, за исключением того, что вы создадите дополнительную базу данных для каждой среды и при создании профиля публикации выбрали правильную строку назначения для каждой базы данных.

В этом разделе учебника вы создадите веб-приложение и базу данных для промежуточной среды, а затем развернетесь на промежуточное хранение и протестируйте их перед созданием и развертыванием в рабочей среде.

> [!NOTE]
> Ниже описано, как создать веб-приложение в службе приложений Azure с помощью портала управления Azure. В последней версии пакета SDK для Azure это также можно сделать, не открывая Visual Studio с помощью обозреватель сервера. В Visual Studio 2013 можно также создать веб-приложение непосредственно из диалогового окна Публикация. Дополнительные сведения см [. в статье Создание веб-приложения ASP.NET в службе приложений Azure.](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet)

1. В [портал управления Azure](https://manage.windowsazure.com/)щелкните **веб-сайты**, а затем — **создать**.
2. Щелкните **веб-сайт**и выберите **настраиваемое создание**.

    Откроется **новый веб-сайт — настраиваемый мастер создания** . Мастер **настраиваемого создания** позволяет одновременно создавать веб-сайт и базу данных.
3. На шаге **создать веб-сайт** мастера введите строку в поле **URL-адрес** , чтобы использовать его в качестве уникального URL-адреса для промежуточной среды приложения. Например, введите ContosoUniversity-staging123 (включая случайные числа в конце, чтобы сделать его уникальным в случае, если используется ContosoUniversity-промежуточное развертывание).

    Полный URL-адрес будет содержать то, что вы вводите здесь, а также суффикс, который вы видите рядом с текстовым полем.
4. В раскрывающемся списке **регион** выберите ближайший к вам регион.

    Этот параметр указывает центр обработки данных, в котором будет выполняться веб-приложение.
5. В раскрывающемся списке **база данных** выберите **создать новую базу данных SQL**.
6. В поле **имя строки подключения к базе данных** оставьте значение по умолчанию *DefaultConnection*.
7. Щелкните стрелку, расположенную справа внизу окна.

    На следующем рисунке показано диалоговое окно **Создание веб-сайта** с примерами значений в нем. Введенный URL-адрес и регион будут разными.

    ![Шаг создания веб-сайта](deploying-to-production/_static/image1.png)

    Мастер переходит к шагу **Указание параметров базы данных** .
8. В поле **имя** введите *ContosoUniversity* плюс случайное число, чтобы сделать его уникальным, например *ContosoUniversity123*.
9. В поле **сервер** выберите **новый сервер базы данных SQL**.
10. Введите имя администратора и пароль.

    Вы не вводите здесь имя и пароль. Вы вводите новое имя и пароль, которые вы определите сейчас для дальнейшего использования при обращении к базе данных.
11. В поле **регион** выберите тот же регион, который вы выбрали для веб-приложения.

    Поддержание веб-сервера и сервера базы данных в одном регионе обеспечивает максимальную производительность и уменьшает расходы.
12. Установите флажок в нижней части окна, чтобы указать, что все готово.

    На следующем рисунке показано диалоговое окно **Указание параметров базы данных** с примерами значений. Введенные значения могут отличаться.

    ![Шаг "Параметры базы данных" для нового веб-сайта — мастер создания базы данных](deploying-to-production/_static/image2.png)

    Портал управления возвращается на страницу веб-сайтов, а в столбце **состояние** показано, что создается веб-приложение. Через некоторое время (обычно меньше минуты) в столбце **состояние** показано, что веб-приложение успешно создано. На панели навигации слева отображается число веб-приложений в вашей учетной записи рядом со значком **веб-сайтов** , а рядом со значком **базы данных SQL** отображается число баз данных.

    ![Страница веб-сайтов портал управления, созданный веб-сайт](deploying-to-production/_static/image3.png)

    Имя веб-приложения будет отличаться от примера приложения на рисунке.

## <a name="deploy-the-application-to-staging"></a>Развертывание приложения в промежуточной среде

Теперь, когда вы создали веб-приложение и базу данных для промежуточной среды, можно развернуть в ней проект.

> [!NOTE]
> В этих инструкциях показано, как создать профиль публикации, загрузив файл *publishsettings* , который работает не только для Azure, но также и для сторонних поставщиков услуг размещения. Последний пакет Azure SDK также позволяет напрямую подключаться к Azure из Visual Studio и выбирать из списка веб-приложений, которые имеются в вашей учетной записи Azure. В Visual Studio 2013 можно войти в Azure из диалогового окна **веб-публикация** или из окна **Обозреватель сервера** . Дополнительные сведения см. [в статье Создание веб-приложения ASP.NET в службе приложений Azure](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).

### <a name="download-the-publishsettings-file"></a>Скачивание файла publishsettings

1. Щелкните имя только что созданного веб-приложения.

    ![Щелкните сайт, чтобы открыть панель мониторинга.](deploying-to-production/_static/image4.png)
2. В разделе **краткий обзор** на вкладке **панель мониторинга** щелкните **скачать профиль публикации**.

    ![Загрузить ссылку на профиль публикации](deploying-to-production/_static/image5.png)

    На этом шаге загружается файл, содержащий все параметры, необходимые для развертывания приложения в веб-приложении. Вы импортируете этот файл в Visual Studio, поэтому вам не придется вводить эти сведения вручную.
3. Сохраните *publishsettings* -файл в папку, к которой можно получить доступ из Visual Studio.

    ![Сохранение файла. publishsettings](deploying-to-production/_static/image6.png)

    > [!WARNING]
    > Безопасность *. publishsettings* -файл содержит ваши учетные данные (незакодированные), которые используются для администрирования подписок и служб Azure. Для этого файла рекомендуется временно сохранить его за пределами исходных каталогов (например, в папке Libraries\Documents), а затем удалить его после завершения импорта. Злонамеренный пользователь, получивший доступ к *publishsettings* -файлу, может изменять, создавать и удалять службы Azure.

### <a name="create-a-publish-profile"></a>Создание профиля публикации

1. В Visual Studio щелкните правой кнопкой мыши проект ContosoUniversity в **Обозреватель решений** и выберите в контекстном меню пункт **опубликовать** .

    Откроется мастер **публикации веб-сайта** .
2. Перейдите на вкладку **профиль** .
3. Нажмите кнопку **Импортировать**.
4. Перейдите к файлу *publishsettings* , скачанному ранее, и нажмите кнопку **Открыть**.

    ![Диалоговое окно «Импорт параметров публикации»](deploying-to-production/_static/image7.png)
5. На вкладке **Подключение** щелкните **проверить подключение** , чтобы убедиться в правильности параметров.

    После проверки соединения рядом с кнопкой **проверить подключение** отображается зеленая галочка.

    Для некоторых поставщиков услуг размещения при нажатии кнопки **проверить подключение**может появиться диалоговое окно **Ошибка сертификата** . В этом случае убедитесь, что имя сервера отличается от предполагаемого. Если имя сервера указано правильно, выберите **сохранить этот сертификат для будущих сеансов Visual Studio** и нажмите кнопку **принять**. (Эта ошибка означает, что поставщик услуг размещения решил избежать расходов на приобретение сертификата SSL для URL-адреса, на который выполняется развертывание. Если вы предпочитаете установить безопасное подключение с помощью действительного сертификата, обратитесь к поставщику услуг размещения.)
6. Нажмите кнопку **Далее**.

    ![значок успешного подключения и кнопка "Далее" на вкладке "подключение"](deploying-to-production/_static/image8.png)
7. На вкладке **Параметры** разверните узел **Параметры публикации файла**, а затем выберите **исключить файлы из папки\_данных приложения**.

    Дополнительные сведения о других параметрах в разделе **Параметры публикации файлов**см. в учебнике [развертывание в IIS](deploying-to-iis.md) . Снимок экрана, на котором показан результат этого шага, и следующие этапы настройки базы данных выполняются в конце этапов настройки базы данных.
8. В разделе **DefaultConnection** в разделе **базы** данных настройте развертывание базы данных для базы данных членства.
9. 1. Выберите **обновить базу данных**.

        Поле **строки удаленного подключения** , расположенное непосредственно под **DefaultConnection** , заполняется строкой подключения из publishsettings-файла. Строка подключения включает SQL Server учетные данные, которые хранятся в виде обычного текста в файле *pubxml* . Если вы не хотите хранить их окончательно, их можно удалить из профиля публикации после развертывания базы данных и сохранить в Azure. Дополнительные сведения см. в статье [как обеспечить безопасность строк подключения к базе данных ASP.NET при развертывании в Azure из источника](http://www.hanselman.com/blog/HowToKeepYourASPNETDatabaseConnectionStringsSecureWhenDeployingToAzureFromSource.aspx) в блоге Скотта Hanselman.
      2. Щелкните **настроить обновления базы данных**.
      3. В диалоговом окне **Настройка обновлений базы данных** нажмите кнопку **Добавить скрипт SQL**.
      4. В поле **Добавить скрипт SQL** перейдите к скрипту *АСПнет-Дата-прод. SQL* , сохраненному ранее в папке решения, и нажмите кнопку **Открыть**.
      5. Закройте диалоговое окно **Настройка обновлений базы данных** .
10. В разделе **SchoolContext** ( **базы данных** ) выберите **Execute Code First migrations (выполняется при запуске приложения)** .

    Visual Studio отображает **Execute Code First migrations** вместо **базы данных Update** для классов `DbContext`. Если вы хотите использовать поставщик Дбдакфкс вместо миграции для развертывания базы данных, к которой вы обращаетесь с помощью `DbContext` класса, см. раздел [разделы справки развертывание базы данных Code First без миграции?](https://msdn.microsoft.com/library/ee942158.aspx#deploy_code_first_without_migrations) в разделе часто задаваемых вопросов по веб-развертыванию для Visual Studio и ASP.NET на сайте MSDN.

    Вкладка **Параметры** теперь выглядит, как показано в следующем примере:

    ![Вкладка "Параметры" для промежуточного хранения](deploying-to-production/_static/image9.png)
11. Чтобы сохранить профиль и переименовать его в *промежуточное хранение*, выполните следующие действия.

    1. Перейдите на вкладку **профиль** и выберите **Управление профилями**.
    2. Импорт создал два новых профиля: один для FTP и один для веб-развертывание. Вы настроили профиль веб-развертывание: Переименуйте этот профиль в *промежуточный*.

        ![Переименование профиля в промежуточное хранение](deploying-to-production/_static/image10.png)
    3. Закройте диалоговое окно **изменение профилей веб-публикации** .
    4. Закройте мастер **публикации веб-сайта** .

### <a name="configure-a-publish-profile-transform-for-the-environment-indicator"></a>Настройка преобразования профиля публикации для индикатора среды

> [!NOTE]
> В этом разделе показано, как настроить преобразование web. config для индикатора среды. Поскольку индикатор находится в элементе `<appSettings>`, у вас есть еще одна альтернатива для указания преобразования при развертывании в службе приложений Azure. Дополнительные сведения см. [в разделе Указание параметров Web. config в Azure](web-config-transformations.md#watransforms).

1. В **Обозреватель решений**разверните узел **свойства**, а затем разверните узел **PublishProfiles**.
2. Щелкните правой кнопкой мыши файл *промежуточного развертывания. pubxml*и выберите команду **добавить преобразование конфигурации**.

    ![Добавление преобразования конфигурации для промежуточного хранения](deploying-to-production/_static/image11.png)

    Visual Studio создаст файл преобразования *Web. промежуточного файла. config* и откроет его.
3. В файле преобразования *Web. промежуточного файла. config* вставьте следующий код сразу после открывающего тега `configuration`.

    [!code-xml[Main](deploying-to-production/samples/sample1.xml)]

    При использовании профиля промежуточной публикации это преобразование задает для индикатора среды значение "произ.". В развернутом веб-приложении не отображаются суффиксы, такие как "(dev)" или "(тест)" после заголовка "H1" университета Contoso ".
4. Щелкните правой кнопкой мыши файл *Web. промежуточного файла. config* и выберите команду **Просмотр преобразования** , чтобы убедиться, что преобразованное преобразование создает ожидаемые изменения.

    В окне **Предварительный просмотр Web. config** отображается результат применения преобразований *Web. Release. config* и преобразований *Web. промежуточного файла. config* .

### <a name="prevent-public-use-of-the-test-app"></a>Запрет общего использования тестового приложения

Важное замечание для промежуточного приложения заключается в том, что оно будет находиться в Интернете, но вы не хотите, чтобы он использовался в общедоступной среде. Чтобы максимально увеличить вероятность того, что пользователи смогут найти и использовать его, можно использовать один или несколько следующих методов.

- Настройте правила брандмауэра, которые разрешают доступ к промежуточному приложению только с IP-адресов, используемых для проверки промежуточного хранения.
- Используйте скрытый URL-адрес, который невозможно угадать.
- Создайте файл *robots. txt* , чтобы гарантировать, что поисковые системы не будут сканировать тестовое приложение и сообщить о них в результатах поиска.

Первый из этих методов является наиболее эффективным, но не рассматривается в этом руководстве, так как для этого потребуется выполнить развертывание в облачной службе Azure вместо службы приложений Azure. Дополнительные сведения об ограничениях облачных служб и IP-адресов в Azure см. в статье [варианты размещения вычислений, предоставляемые Azure](https://docs.microsoft.com/azure/cloud-services/cloud-services-choose-me) , и [заблокируйте доступ к веб-роли определенным IP-адресам](https://msdn.microsoft.com/library/windowsazure/jj154098.aspx). Если вы развертываете поставщик услуг размещения стороннего производителя, обратитесь к поставщику, чтобы узнать, как реализовать ограничения IP-адресов.

В этом руководстве вы создадите файл *robots. txt* .

1. В **Обозреватель решений**щелкните правой кнопкой мыши проект ContosoUniversity и выберите команду **Добавить новый элемент**.
2. Создайте новый **текстовый файл** с именем *robots. txt*и вставьте в него следующий текст:

    [!code-console[Main](deploying-to-production/samples/sample2.cmd)]

    `User-agent` строка указывает поисковым системам, что правила в файле применяются ко всем поисковым средствам поисковой системы (роботы), а строка `Disallow` указывает, что обход страниц на сайте не должен выполняться.

    Вы хотите, чтобы поисковые системы были в каталоге рабочего приложения, поэтому необходимо исключить этот файл из рабочего развертывания. Для этого вы настроите параметр в рабочем профиле публикации при его создании.

### <a name="deploy-to-staging"></a>Развертывание в промежуточное хранение

1. Откройте мастер **публикации веб-сайта** , щелкнув правой кнопкой мыши проект университета Contoso и выбрав пункт **опубликовать**.
2. Убедитесь, что выбран **промежуточный** профиль.
3. Нажмите кнопку **Опубликовать**.

    В окне **вывод** отображаются действия по развертыванию, которые были выполнены, и сообщает об успешном завершении развертывания. Браузер по умолчанию автоматически открывается по URL-адресу развернутого приложения.

## <a name="test-in-the-staging-environment"></a>Тестирование в промежуточной среде

Обратите внимание, что индикатор среды отсутствует (отсутствует "(тест)" или "(dev)" после заголовка H1, который показывает, что преобразование *Web. config* для индикатора окружения прошло успешно.

![Промежуточное размещение домашней страницы](deploying-to-production/_static/image12.png)

Запустите страницу **учащихся** , чтобы убедиться, что развернутая база данных не содержит учащихся.

Запустите страницу **инструкторы** , чтобы убедиться, что Code First заполнена базой данных с помощью инструкторов:

Выберите **Добавить учащихся** в меню **учащихся** , добавьте учащийся, а затем просмотрите новый учащийся на странице **учащихся** , чтобы убедиться, что вы можете успешно выполнить запись в базу данных.

На странице **курсы** щелкните **Обновить кредиты**. На странице " **Обновление кредитов** " требуются разрешения администратора, поэтому отображается страница **входа** . Введите учетные данные администратора, созданные ранее ("admin" и "продпвд"). Отобразится страница **Обновление кредитов** , которая подтверждает, что учетная запись администратора, созданная в предыдущем руководстве, правильно развернута в тестовой среде.

Запросите недопустимый URL-адрес, чтобы вызвать ошибку, которую будет отчитываться ELMAH, а затем запросите отчет об ошибках ELMAH. При развертывании на поставщик услуг размещения стороннего производителя, вероятно, вы обнаружите, что отчет пуст по той же причине, что он был пустым в предыдущем руководстве. Необходимо использовать средства управления учетными записями поставщика услуг размещения, чтобы настроить разрешения для папки, чтобы разрешить ELMAH запись в папку журнала.

Созданное вами приложение теперь выполняется в облаке в веб-приложении, которое точно похоже на то, что будет использоваться для рабочей среды. Так как все работает правильно, следующий шаг заключается в развертывании в рабочей среде.

## <a name="deploy-to-production"></a>Развертывание в рабочей среде

Процесс создания рабочего веб-приложения и развертывания в рабочей среде аналогичен процессу для промежуточного хранения, за исключением того, что необходимо исключить файл *robots. txt* из развертывания. Для этого необходимо изменить файл профиля публикации.

### <a name="create-the-production-environment-and-the-production-publish-profile"></a>Создание рабочей среды и профиля публикации в рабочей среде

1. Создайте рабочее веб-приложение и базу данных в Azure, следуя той же процедуре, которая использовалась для промежуточного хранения.

    При создании базы данных ее можно выбрать на том же сервере, который был создан ранее, или создать новый сервер.
2. Скачайте файл *publishsettings* .
3. Создайте профиль публикации, импортировав файл Production *. publishsettings* , следуя той же процедуре, которая использовалась для промежуточного хранения.

    Не забудьте настроить скрипт развертывания данных в разделе **DefaultConnection** в разделе **базы данных** на вкладке **Параметры** .
4. Переименуйте профиль публикации в *рабочую среду*.
5. Настройте преобразование профиля публикации для индикатора среды, следуя той же процедуре, которая использовалась для промежуточного хранения.

### <a name="edit-the-pubxml-file-to-exclude-robotstxt"></a>Измените файл pubxml, чтобы исключить robots. txt

Файлы профиля публикации имеют имя &lt;имя_профиля&gt; *. pubxml* и находятся в папке *PublishProfiles* . Папка *PublishProfiles* находится в папке *Properties* проекта C# веб-приложения, в папке *My Project* в проекте веб-приложения VB или в папке *данных приложения\_* в проекте веб-приложения. Каждый файл *. pubxml* содержит параметры, которые применяются к одному профилю публикации. Значения, введенные в мастере публикации веб-сайта, хранятся в этих файлах, и их можно изменить для создания или изменения параметров, которые не становятся доступными в пользовательском интерфейсе Visual Studio.

По умолчанию файлы *. pubxml* включаются в проект при создании профиля публикации, но их можно исключить из проекта, и Visual Studio по-прежнему будет использовать их. Visual Studio ищет в папке *PublishProfiles* файлы *. pubxml* , независимо от того, включены ли они в проект.

Для каждого *pubxml* -файла существует файл *. pubxml. User* . Файл *. pubxml. User* содержит зашифрованный пароль, если выбран параметр **Сохранить пароль** , и по умолчанию он исключается из проекта.

Файл *. pubxml* содержит параметры, относящиеся к конкретному профилю публикации. Если необходимо настроить параметры, применяемые ко всем профилям, можно создать файл *. targets* . Процесс сборки импортирует эти файлы в файл проекта *CSPROJ* или *VBPROJ* , поэтому большинство параметров, которые можно настроить в файле проекта, можно настроить в этих файлах. Дополнительные сведения о файлах *. pubxml* и *. wpp. targets* см. в разделе [как изменить параметры развертывания в файлах профиля публикации (. pubxml) и в файле. wpp. targets в веб-проектах Visual Studio](https://msdn.microsoft.com/library/ff398069.aspx).

1. В **Обозреватель решений**разверните узел **Свойства** и разверните узел **PublishProfiles**.
2. Щелкните правой кнопкой мыши *Production. pubxml* и нажмите кнопку **Открыть**.

    ![Открытие файла pubxml](deploying-to-production/_static/image13.png)
3. Щелкните правой кнопкой мыши *Production. pubxml* и нажмите кнопку **Открыть**.
4. Добавьте следующие строки непосредственно перед закрывающим элементом `PropertyGroup`:

    [!code-xml[Main](deploying-to-production/samples/sample3.xml)]

    Файл. pubxml теперь выглядит как в следующем примере:

    [!code-xml[Main](deploying-to-production/samples/sample4.xml?highlight=18-20)]

    Дополнительные сведения об исключении файлов и папок см. в разделе [можно ли исключить определенные файлы или папки из развертывания?](https://msdn.microsoft.com/library/ee942158.aspx#can_i_exclude_specific_files_or_folders_from_deployment) в статье **вопросы и ответы по веб-развертыванию Visual Studio и ASP.NET** на сайте MSDN.

### <a name="deploy-to-production"></a>Развертывание в рабочей среде

1. Откройте мастер **публикации веб-сайта** и убедитесь, что выбран профиль **рабочей** публикации, а затем нажмите кнопку **запустить предварительный просмотр** на вкладке **Предварительный просмотр** , чтобы убедиться, что файл *robots. txt* не будет скопирован в рабочее приложение.

    ![Предварительный просмотр файлов для публикации в рабочей среде](deploying-to-production/_static/image14.png)

    Проверьте список файлов, которые будут скопированы. Вы увидите, что все файлы *. CS* , включая файлы *. aspx.cs*, *. aspx.Designer.CS*, *master.CS*и *master.Designer.CS* , пропущены. Весь этот код был скомпилирован в файлы *ContosoUniversity. dll* и *ContosoUniversity. pdb* , которые можно найти в папке *bin* . Поскольку для запуска приложения требуется только *DLL-файл* , и вы указали ранее, что только файлы, необходимые для запуска приложения, должны быть развернуты, а файлы *. CS* не были скопированы в целевую среду. Папка *obj* и файлы *ContosoUniversity. csproj* и *. csproj. User* опущены по той же причине.

    Щелкните **опубликовать** , чтобы развернуть в рабочей среде.
2. Протестируйте в рабочей среде, следуя той же процедуре, которая использовалась для промежуточного хранения.

    Все идентично промежуточному развертыванию, за исключением URL-адреса и отсутствия файла *robots. txt* .

## <a name="summary"></a>Сводка

Теперь вы успешно развернули и протестировали веб-приложение и общедоступно через Интернет.

![Рабочая страница Home](deploying-to-production/_static/image15.png)

В следующем руководстве вы обновите код приложения и развернете изменения в тестовой, промежуточной и рабочей средах.

> [!NOTE]
> Хотя приложение используется в рабочей среде, необходимо реализовать план восстановления. Это значит, что необходимо периодически выполнять резервное копирование баз данных из рабочего приложения в защищенное место хранения, а также хранить несколько поколений таких резервных копий. При обновлении базы данных необходимо создать резервную копию непосредственно перед изменением. Если вы сделаете ошибку и не обнаружите ее до тех пор, пока вы не развернете ее в рабочую среду, то сможете восстановить базу данных до состояния, в котором она находилась до повреждения. Дополнительные сведения см. в статье [резервное копирование и восстановление базы данных SQL Azure](https://msdn.microsoft.com/library/windowsazure/jj650016.aspx).
> 
> 
> [!NOTE]
> В этом учебнике SQL Server выпуск, на котором выполняется развертывание, — это база данных SQL Azure. Хотя процесс развертывания аналогичен другим выпускам SQL Server, в некоторых сценариях для работы с базой данных SQL Azure может потребоваться специальный код. Дополнительные сведения см. в статьях [Работа с базой данных SQL Azure](../../../../whitepapers/aspnet-data-access-content-map.md#ssdb) и [Выбор между SQL Server и базой данных SQL Azure](../../../../whitepapers/aspnet-data-access-content-map.md#ssdbchoosing).
> 
> [!div class="step-by-step"]
> [Назад](setting-folder-permissions.md)
> [Вперед](deploying-a-code-update.md)
