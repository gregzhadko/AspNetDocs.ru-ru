---
uid: web-forms/overview/deployment/visual-studio-web-deployment/introduction
title: 'ASP.NET веб-развертывание с помощью Visual Studio: введение | Документация Майкрософт'
author: tdykstra
description: В этой серии руководств показано, как развернуть (опубликовать) веб-приложение ASP.NET в веб-приложениях службы приложений Azure или поставщике услуг размещения стороннего поставщика с помощью V...
ms.author: riande
ms.date: 02/15/2013
ms.assetid: 24ad086d-865e-433c-9ac9-05f1a553da16
msc.legacyurl: /web-forms/overview/deployment/visual-studio-web-deployment/introduction
msc.type: authoredcontent
ms.openlocfilehash: 96dd31d949633e001fc595621bedbf74e98000fc
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74640237"
---
# <a name="aspnet-web-deployment-using-visual-studio-introduction"></a>ASP.NET веб-развертывание с помощью Visual Studio: введение

от [Tom Dykstra)](https://github.com/tdykstra)

[Скачать начальный проект](https://go.microsoft.com/fwlink/p/?LinkId=282627)

> В этой серии руководств показано, как развернуть (опубликовать) веб-приложение ASP.NET в веб-приложениях службы приложений Azure или поставщике услуг размещения стороннего поставщика с помощью Visual Studio 2012 с пакетом Azure SDK для .NET. Большинство процедур похожи на Visual Studio 2013.
> 
> Вы разрабатываете веб-приложение, чтобы оно было доступно пользователям через Интернет. Но учебники по веб-программированию обычно прекращают работу сразу после того, как они показали, как получить что-то на компьютере разработчика. Эта серия руководств начинается с того, что другие пользователи не оставляют: вы создали веб-приложение, тестировали его и готовы к работе. Что дальше? В этих руководствах показано, как сначала выполнить развертывание в IIS на локальном компьютере разработки для тестирования, а затем в Azure или поставщик услуг размещения сторонних поставщиков для промежуточного хранения и рабочей среды. Развертываемый пример приложения — это проект веб-приложения, который использует Entity Framework, SQL Server и систему членства ASP.NET. Пример приложения использует веб-формы ASP.NET, но приведенные процедуры также применяются к ASP.NET MVC и веб-API.
> 
> В этих руководствах предполагается, что вы умеете работать с ASP.NET в Visual Studio. В противном случае лучше всего начать с [учебника по ASP.NET Web Forms](../../older-versions-getting-started/tailspin-spyworks/tailspin-spyworks-part-1.md) или [Basic ASP.NET MVC](../../../../mvc/overview/older-versions/getting-started-with-aspnet-mvc4/intro-to-aspnet-mvc-4.md).
> 
> Если у вас есть вопросы, не связанные непосредственно с этим руководством, их можно опубликовать на форуме по [развертыванию ASP.NET](https://forums.asp.net/26.aspx/1?Configuration+and+Deployment) или [StackOverflow](http://stackoverflow.com).
> 
> Это содержимое также доступно в виде бесплатной электронной книги в [коллекции электронной книги TechNet](https://social.technet.microsoft.com/wiki/contents/articles/11608.e-book-gallery-for-microsoft-technologies.aspx#ASPNETWebDeploymentusingVisualStudio).

## <a name="overview"></a>Обзор

Эти учебники посвящены развертыванию веб-приложения ASP.NET, включающего SQL Server базы данных. Сначала выполняется развертывание в IIS на локальном компьютере разработки для тестирования, а затем в веб-приложения в службе приложений Azure и базе данных SQL Azure для промежуточной и рабочей среды. Вы узнаете, как выполнить развертывание с помощью Visual Studio «публикация одним щелчком», и вы увидите развертывание с помощью командной строки.

Число учебников может сделать процесс развертывания довольно непростой задачей. Фактически основные процедуры просты. Однако в реальных ситуациях часто приходится выполнять дополнительные задачи развертывания, например устанавливать разрешения папки на целевом сервере. Мы продемонстрировали некоторые из этих дополнительных задач, и надеемся, что руководства не оставляют информации, которая может помешать успешному развертыванию реальных приложений.

Руководства предназначены для выполнения последовательно, и каждая часть основана на предыдущей части. Вы можете пропустить части, не относящиеся к вашей ситуации, но, возможно, придется скорректировать процедуры в последующих руководствах.

## <a name="intended-audience"></a>Предполагаемая аудитория

Учебники предназначены для разработчиков ASP.NET, работающих в средах, где:

- Рабочая среда — это веб-приложения службы приложений Azure или поставщик услуг размещения сторонних поставщиков.
- Развертывание не ограничивается процессом непрерывной интеграции, но может быть выполнено непосредственно из Visual Studio.

Развертывание из [системы управления версиями](../../../../aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/source-control.md) с помощью процесса [непрерывной поставки](../../../../aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/continuous-integration-and-continuous-delivery.md) не рассматривается в этих руководствах, за исключением одного учебника, в котором показано, как выполнить развертывание из командной строки. Сведения о непрерывной доставке см. в следующих ресурсах:

- [Непрерывная интеграция и непрерывная поставка (создание облачных приложений в реальном мире с помощью Windows Azure)](../../../../aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/continuous-integration-and-continuous-delivery.md)
- [Развертывание веб-приложения в службе приложений Azure](https://azure.microsoft.com/documentation/articles/web-sites-deploy/)
- [Развертывание веб-приложений в корпоративных сценариях](../deploying-web-applications-in-enterprise-scenarios/deploying-web-applications-in-enterprise-scenarios.md) (более старый набор руководств, написанных для Visual Studio 2010, который по-прежнему содержит полезную информацию для корпоративных сред).

## <a name="using-a-third-party-hosting-provider"></a>Использование стороннего поставщика услуг размещения

В учебниках описывается процесс настройки учетной записи Azure и развертывания приложения в веб-приложениях в службе приложений Azure для промежуточной и рабочей среды. Тем не менее вы можете использовать те же основные процедуры для развертывания в выбранном поставщике услуг размещения стороннего производителя. Там, где руководства переходят на процессы, уникальные для Azure, они объясняют, что и покажут, какие различия можно рассчитывать сторонним поставщикам услуг размещения.

## <a name="deploying-web-app-projects"></a>Развертывание проектов веб-приложений

Пример приложения, скачиваемого и развертываемого для этих руководств, является проектом веб-приложения Visual Studio. Однако при установке последнего обновления веб-публикации для Visual Studio можно использовать те же методы и средства развертывания для проектов веб-приложений.

## <a name="deploying-aspnet-mvc-projects"></a>Развертывание проектов ASP.NET MVC

Пример приложения — это проект веб-форм ASP.NET, но все, что вы научитесь делать, применимо и к ASP.NET MVC. Проект Visual Studio MVC — это просто еще одна форма проекта веб-приложения. Единственное отличие заключается в том, что при развертывании на поставщик услуг размещения, который не поддерживает ASP.NET MVC или целевую версию, необходимо убедиться, что в проекте установлен соответствующий пакет NuGet ([MVC 3](http://nuget.org/packages/AspNetMvc/3.0.20105.0), [MVC 4](http://www.nuget.org/packages/Microsoft.AspNet.Mvc/4.0.30506.0)или [MVC 5](http://www.nuget.org/packages/Microsoft.AspNet.Mvc)).

## <a name="programming-language"></a>Язык программирования

Пример приложения использует C# C#, но руководства не нуждаются в знаниях, а методы развертывания, представленные в руководствах, не относятся к языку.

## <a name="database-deployment-methods"></a>Методы развертывания базы данных

Существует три способа развертывания базы данных SQL Server вместе с веб-развертыванием в Visual Studio.

- Entity Framework Code First Migrations
- Поставщик веб-развертывание Дбдакфкс
- Поставщик веб-развертывание Дбфуллскл

В этом учебнике будут использованы первые два из этих методов. Дбфуллскл веб-развертывание Provider — это устаревший метод, который больше не рекомендуется использовать, за исключением некоторых конкретных сценариев, таких как миграция с SQL Server Compact на SQL Server.

Методы, приведенные в этом руководстве, предназначены для SQL Server баз данных, а не SQL Server Compact. Дополнительные сведения о развертывании базы данных SQL Server Compact см. в разделе [веб-развертывание Visual Studio с SQL Server Compact](../../older-versions-getting-started/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-introduction-1-of-12.md).

Для методов, показанных в этом руководстве, необходимо использовать метод публикации веб-развертывание. Если вы предпочитаете другой метод публикации, например FTP, файловая система или FPSE, см. статью [развертывание базы данных отдельно от развертывания веб-приложения](https://go.microsoft.com/fwlink/p/?LinkId=282413#databaseseparate) в карте содержимого веб-развертывания для Visual Studio и ASP.NET.

### <a name="entity-framework-code-first-migrations"></a>Entity Framework Code First Migrations

В Entity Framework версии 4,3 Корпорация Майкрософт представила Code First Migrations. Code First Migrations автоматизирует процесс внесения добавочных изменений в модель данных и распространяет эти изменения в базу данных. В предыдущих версиях Code First вы обычно разрешите Entity Framework удалять и повторно создавать базу данных каждый раз при изменении модели данных. Это не является проблемой в разработке, так как тестовые данные легко создаются повторно, но в рабочей среде обычно требуется обновить схему базы данных, не удаляя базу данных. Функция миграции позволяет Code First обновлять базу данных без удаления и повторного создания. Вы можете позволить Code First автоматически решить, как внести необходимые изменения в схему, или написать код, который настраивает изменения. Общие сведения о Code First Migrations см. в разделе [Code First migrations](https://msdn.microsoft.com/library/hh770484.aspx).

При развертывании веб-проекта Visual Studio может автоматизировать процесс развертывания базы данных, управляемой Code First Migrations. При создании профиля публикации установите флажок "выполнить Code First Migrations" (выполняется при запуске приложения). Этот параметр приводит к тому, что процесс развертывания автоматически настраивает файл Web. config приложения на целевом сервере, чтобы Code First использует класс инициализатора `MigrateDatabaseToLatestVersion`.

Visual Studio не выполняет никаких действий с базой данных в процессе развертывания. Когда развернутое приложение обращается к базе данных в первый раз после развертывания, Code First автоматически создает базу данных или обновляет схему базы данных до последней версии. Если приложение реализует метод начального заполнения миграции, метод выполняется после создания базы данных или обновления схемы.

В этом руководстве вы будете использовать Code First Migrations для развертывания базы данных приложения.

### <a name="the-dbdacfx-web-deploy-provider"></a>Поставщик веб-развертывание Дбдакфкс

Для SQL Server базы данных, которая не управляется с помощью Entity Framework Code First, можно установить флажок, помеченный как обновить базу данных при настройке профиля публикации. Во время первоначального развертывания поставщик Дбдакфкс создает таблицы и другие объекты базы данных в целевой базе данных в соответствии с исходной базой данных. При последующих развертываниях поставщик определяет, что отличается между исходной и целевой базами данных, и обновляет схему целевой базы данных в соответствии с базой данных-источником. По умолчанию поставщик не вносит изменения, которые приводят к потере данных, например при удалении таблицы или столбца.

Этот метод не автоматизирует развертывание данных в таблицах базы данных, но для этого можно создать скрипты и настроить Visual Studio для их запуска во время развертывания. Другой причиной выполнения сценариев во время развертывания является внесение изменений в схему, которые не могут быть выполнены автоматически, поскольку это приведет к потере данных.

В этом руководстве вы будете использовать поставщик Дбдакфкс для развертывания базы данных членства ASP.NET.

## <a name="troubleshooting-during-this-tutorial"></a>Устранение неполадок во время работы с этим руководством

При возникновении ошибки во время развертывания или в случае неправильного запуска развернутого сайта сообщения об ошибках не всегда предоставляют очевидное решение. Чтобы помочь вам с некоторыми распространенными сценариями проблем, доступна [страница справки по устранению неполадок](troubleshooting.md) . Если появляется сообщение об ошибке или что-то не работает при работе с учебниками, обязательно ознакомьтесь со страницей устранения неполадок.

## <a name="comments-welcome"></a>Добро пожаловать в комментарии

Комментарии в учебниках — это Добро пожаловать, и при обновлении руководства будут внесены все усилия, касающиеся учета исправлений или предложений по усовершенствованиям, предоставленных в комментариях учебника.

<a id="prerequisites"></a>

## <a name="prerequisites"></a>Необходимые компоненты

Этот учебник написан для следующих продуктов:

- Windows 8 или Windows 7.
- Visual Studio 2012 или Visual Studio 2012 Express для Web с [последним обновлением](https://go.microsoft.com/fwlink/?LinkId=272486).
- [Пакет Azure SDK для Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkId=254364)

Вы можете следовать инструкциям руководства, используя Visual Studio 2010 с пакетом обновления 1 (SP1) или Visual Studio 2013, но некоторые снимки экрана будут отличаться, а некоторые функции будут отличаться.

Если вы используете Visual Studio 2013, установите [пакет Azure SDK для Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkID=324322).

Если вы используете Visual Studio 2010 с пакетом обновления 1 (SP1), установите следующее программное обеспечение:

- [Пакет Azure SDK для Visual Studio 2010](https://go.microsoft.com/fwlink/?LinkID=254269)
- [SQL Server Express LocalDB](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=SQLLocalDBOnly_11_0)
- [SQL Server Data Tools](https://msdn.microsoft.com/library/hh500335.aspx).

В зависимости от количества зависимостей пакета SDK, которые вы уже имеете на компьютере, установка пакета Azure SDK может занять много времени, с нескольких минут до половины часа или более. Пакет SDK для Azure необходим, даже если планируется публикация в поставщике услуг размещения стороннего поставщика, а не в Azure, так как пакет SDK включает последние обновления функций веб-публикации Visual Studio.

> [!NOTE]
> Этот учебник написан с помощью версии 1.8.1 пакета Azure SDK. С появления новых версий с дополнительными функциями. В руководствах были добавлены сведения об этих функциях и ссылки на ресурсы с дополнительной информацией о них.

Инструкции и снимки экрана основаны на Windows 8, но в учебниках объясняются различия в Windows 7.

Для работы с руководством требуется другое программное обеспечение, но не обязательно устанавливать его. В этом руководстве описано, как установить его при необходимости.

## <a name="download-the-sample-application"></a>Загрузка примера приложения

Приложение, которое вы будете развертывать, называется Contoso университета и уже создано. Это упрощенная версия веб-сайта университета, на основе которой можно слабо проделать приложения Contoso университета, описанные в [руководствах Entity Framework на сайте ASP.NET](https://asp.net/entity-framework/tutorials).

После установки необходимых компонентов загрузите [веб-приложение Contoso университета](https://go.microsoft.com/fwlink/p/?LinkId=282627). *ZIP* -файл содержит несколько версий проекта. Чтобы выполнить действия, описанные в этом руководстве, начните с проекта, расположенного C# в папке. Чтобы увидеть, как выглядит проект в конце руководства, откройте проект в папке ContosoUniversity-End.

Чтобы подготовить проект для работы с помощью шагов учебника, выполните следующие действия.

1. Сохраните файлы решения ContosoUniversity из C# папки в папке с именем ContosoUniversity в любой папке, используемой для работы с проектами Visual Studio.

    По умолчанию для Visual Studio 2012 используется следующая папка:

    `C:\Users\<username>\Documents\Visual Studio 2012\Projects`

    (Для снимков экрана в этом руководстве папка проекта находится в корневом каталоге на диске `C`:.)
2. Запустите Visual Studio и откройте проект.
3. В **Обозреватель решений**щелкните решение правой кнопкой мыши и выберите **Енабленужет Package Restore (восстановление пакета**).
4. Постройте решение.
5. При возникновении ошибок компиляции вручную восстановите пакеты NuGet.

    1. В **Обозреватель решений**щелкните решение правой кнопкой мыши и выберите пункт **Управление пакетами NuGet для решения**.
    2. В верхней части диалогового окна **Управление пакетами NuGet** вы увидите, что **в этом решении отсутствуют некоторые пакеты NuGet. Щелкните, чтобы восстановить.** Нажмите кнопку **восстановить** .
    3. Выполните повторную сборку решения.
6. Нажмите сочетание клавиш CTRL+F5, чтобы запустить приложение.

    Приложение откроется на домашней странице университета Contoso.

    ![Разработка домашней страницы](introduction/_static/image1.png)

    (Может возникнуть время ожидания, когда Visual Studio запустит экземпляр SQL Server Express LocalDB, и если этот процесс занимает слишком много времени, может возникнуть ошибка времени ожидания. В этом случае просто запустите проект снова.)

Страницы веб-сайта доступны из строки меню и позволяют выполнять следующие функции:

- Отображение статистики учащихся (страница About).
- Отображение, изменение, удаление и добавление учащихся.
- Отображение и изменение курсов.
- Отображение и изменение инструкторов.
- Отображение и изменение отделов.

Ниже приведены снимки экрана нескольких репрезентативных страниц.

![Dev на странице учащихся](introduction/_static/image2.png)

![Добавить страницу "учащиеся — разработка"](introduction/_static/image3.png)

## <a name="review-application-features-that-affect-deployment"></a>Проверка функций приложения, влияющих на развертывание

Следующие функции приложения влияют на то, как развертывать его или что необходимо сделать для развертывания. Каждая из них более подробно описана в следующих руководствах по ряду.

- Университет Contoso использует базу данных SQL Server для хранения данных приложений, таких как имена учащихся и преподавателей. База данных содержит набор тестовых данных и рабочих данных, а при развертывании в рабочей среде необходимо исключить тестовые данные.
- Приложение использует систему членства ASP.NET, в которой данные учетной записи пользователя хранятся в базе данных SQL Server. Приложение определяет пользователя с правами администратора, который имеет доступ к некоторым ограниченным сведениям. Необходимо развернуть базу данных членства без тестовых учетных записей, но с учетной записью администратора.
- Приложение использует сторонние средства протоколирования ошибок и создания отчетов. Эта служебная программа предоставляется в сборке, которая должна быть развернута вместе с приложением.
- Служебная программа ведения журнала ошибок записывает сведения об ошибках в XML-файлы в папку с файлами. Необходимо убедиться, что учетная запись, с которой работает ASP.NET на развернутом сайте, имеет разрешение на запись в эту папку, и необходимо исключить эту папку из развертывания. (В противном случае данные журнала ошибок из тестовой среды могут быть развернуты в рабочей среде или файлы журнала ошибок производства могут быть удалены.)
- Приложение включает некоторые параметры, которые необходимо изменить в развернутом файле *Web. config* в зависимости от среды назначения (тест, промежуточное развертывание или рабочая среда) и других параметров, которые необходимо изменить в зависимости от конфигурации сборки (Отладка или выпуск).
- Решение Visual Studio включает проект библиотеки классов. Только сборка, создаваемая этим проектом, должна быть развернута, а не самим проектом.

## <a name="summary"></a>Сводка

В этом первом учебнике серии вы загрузили пример проекта Visual Studio и проверили компоненты сайта, влияющие на способ развертывания приложения. В следующих руководствах Вы подготовитесь к развертыванию, настроив некоторые из этих действий для автоматической обработки. Другие пользователи самостоятельно позаботится о себе.

> [!div class="step-by-step"]
> [Вперед](preparing-databases.md)
