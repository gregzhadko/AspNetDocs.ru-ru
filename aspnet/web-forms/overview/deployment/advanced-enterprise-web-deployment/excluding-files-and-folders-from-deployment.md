---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/excluding-files-and-folders-from-deployment
title: Исключение файлов и папок из развертывания | Документация Майкрософт
author: jrjlee
description: В этом разделе описывается, как можно исключить файлы и папки из веб-пакета развертывания при построении и упаковать проект веб-приложения.
ms.author: riande
ms.date: 05/04/2012
ms.assetid: f4cc2d40-6a78-429b-b06f-07d000d4caad
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/excluding-files-and-folders-from-deployment
msc.type: authoredcontent
ms.openlocfilehash: 4da291af4042e6e09c6917703b160ca717eecd15
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59407995"
---
# <a name="excluding-files-and-folders-from-deployment"></a>Исключение файлов и папок из развертывания

по [Джейсон Lee](https://github.com/jrjlee)

[Загрузить PDF-файл](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> В этом разделе описывается, как можно исключить файлы и папки из веб-пакета развертывания при построении и упаковать проект веб-приложения.


Этот раздел является частью серии учебников, исходя из требования к развертыванию enterprise вымышленной компании Fabrikam, Inc. В этой серии руководств используется пример решения&#x2014; [решения диспетчера контактов](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;для представления веб-приложения с более реалистичные уровень сложности, включая приложения ASP.NET MVC 3, Windows Communication Служба Foundation (WCF) и проект базы данных.

Метод развертывания в основе этих учебников основан на разбиение проекта файл подход, описанный в [основные сведения о файле проекта](../web-deployment-in-the-enterprise/understanding-the-project-file.md), в которой процесс построения управляется двумя файлы проекта&#x2014;один с Создание инструкции, которые применяются для каждой целевой среде и содержащего параметры построения и развертывания для конкретной среды. Во время сборки файл проекта для конкретной среды объединяется в файл проекта независимой от среды, чтобы полный набор инструкций построения.

## <a name="overview"></a>Обзор

При создании проекта веб-приложения в Visual Studio 2010, конвейер публикации Web (WPP) позволяет расширять этот процесс построения, упаковав скомпилированного веб-приложения в развертывание веб-пакета. Затем можно использовать средство Internet Information Services (IIS) веб-развертывания (веб-развертывание) для развертывания этого веб-пакета на удаленном веб-сервере IIS, или импортировать веб-пакета вручную через диспетчер IIS. Этот процесс упаковки объясняется в [сборка и упаковка проектов веб-приложений](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md).

Таким образом, как вы управляете, что возвращает включено в веб-пакет? Параметры проекта в Visual Studio в файле проекта базового обеспечивает достаточного контроля над для многих сценариев. Тем не менее в некоторых случаях может потребоваться настроить содержимое веб-пакет для определенных целевых средах. Например может потребоваться включить папку для файлов журнала, при развертывании приложения в тестовой среде, но исключить папку при развертывании приложения в промежуточной или рабочей среде. В этом разделе показано, как это сделать.

## <a name="what-gets-included-by-default"></a>Что возвращает включено по умолчанию?

При настройке вашего свойства проекта веб-приложения в Visual Studio **элементы, развертываемые** списке **пакета и публикация веб-** страница позволяет указать, что вы хотите включить в развертывание веб- пакет. По умолчанию, это имеет значение **только файлы, необходимые для запуска этого приложения**.

![](excluding-files-and-folders-from-deployment/_static/image1.png)

При выборе **только файлы, необходимые для запуска этого приложения**, WPP попытается определить, какие файлы должны добавляться к веб-пакета. В том числе следующее:

- Выходные данные всех сборки для проекта.
- Все файлы, помеченные с действием сборки **содержимого**.

> [!NOTE]
> В этом файле содержится логику, которая определяет, какие файлы следует включать:   
> *%PROGRAMFILES%\MSBuild\Microsoft\VisualStudio\v10.0\Web\ Microsoft.Web.Publishing.OnlyFilesToRunTheApp.targets*


## <a name="excluding-specific-files-and-folders"></a>Исключение определенных файлов и папок

В некоторых случаях нужно более точное управление, по которому развертываются файлы и папки. Если вы знаете, какие файлы, которые нужно исключить опережают время и исключение применяется ко всем средам, назначения, можно просто указать **действие при построении** каждого файла **None**.

**Чтобы исключить определенные файлы из развертывания**

1. В **обозревателе решений** окно, щелкните правой кнопкой мыши файл и нажмите кнопку **свойства**.
2. В **свойства** окно в **действие при построении** строку, выберите **None**.

Тем не менее, этот подход не всегда удобно. Например вам может потребоваться выбор какие файлы и папки включены, в соответствии с целевой среды, а вне Visual Studio. Например в примере решения диспетчера контактов, взгляните на содержимое ContactManager.Mvc проекта:

![](excluding-files-and-folders-from-deployment/_static/image2.png)

- Внутренняя папка содержит некоторые скрипты SQL, которые разработчик использует для создания, удаления и заполнения локальных баз данных для целей разработки. Никаких действий в этой папке должны развертываться в промежуточной или рабочей среде.
- Папку «Скрипты» содержит несколько файлов JavaScript. Большое количество этих файлов входят исключительно для поддержки отладки или обеспечивает поддержку технологии IntelliSense в Visual Studio. Некоторые из этих файлов не должны развертываться в промежуточной или рабочей среде. Тем не менее может потребоваться развернуть их в тестовой среде разработчика, чтобы упростить устранение неполадок.

Несмотря на то, что возможность управлять файлы проекта, чтобы исключить определенные файлы и папки, то есть более простой способ. WPP включает механизм для исключения файлов и папок, создав списки элементов с именем **ExcludeFromPackageFolders** и **ExcludeFromPackageFiles**. Этот механизм можно расширить путем добавления собственных элементов этих списков. Чтобы сделать это, необходимо выполнить следующие действия:

1. Создайте файл пользовательского проекта *.wpp.targets [имя_проекта]* в той же папке с файлом проекта.

    > [!NOTE]
    > *. Wpp.targets* файл необходимо перейти в той же папке, как файл проекта веб-приложения&#x2014;к примеру, *ContactManager.Mvc.csproj*&#x2014;, а не в той же папке, что любые пользовательские файлы проекта, используемого для управления процессом построения и развертывания.
2. В *. wpp.targets* добавьте **ItemGroup** элемент.
3. В **ItemGroup** элемента, добавьте **ExcludeFromPackageFolders** и **ExcludeFromPackageFiles** элементов для исключения отдельных файлов и папок при необходимости.

Это базовая структура *. wpp.targets* файла:


[!code-xml[Main](excluding-files-and-folders-from-deployment/samples/sample1.xml)]


Обратите внимание, что каждый элемент содержит элемент метаданных с именем **FromTarget**. Это необязательное значение, которое не влияет на процесс построения; он просто служит для указания того, почему были опущены определенными файлами или папками, если кто-то просматривает журналы построения.

## <a name="excluding-files-and-folders-from-a-web-package"></a>Исключение файлов и папок из веб-пакета

Следующей процедуре показано, как добавить *. wpp.targets* файл в проект веб-приложения и как с помощью файла исключать определенные файлы и папки из веб-пакета при выполнении сборки проекта.

**Чтобы исключить файлы и папки из веб-пакета развертывания**

1. Откройте решение в Visual Studio 2010.
2. В **обозревателе решений** окно, щелкните правой кнопкой мыши узел проекта web application (например, **ContactManager.Mvc**), пункты **добавить**и нажмите кнопку **Новый элемент**.
3. В **Добавление нового элемента** выберите **XML-файл** шаблона.
4. В **имя** введите *[имя_проекта] ***.wpp.targets** (например, **ContactManager.Mvc.wpp.targets**), а затем нажмите кнопку **добавить**.

    ![](excluding-files-and-folders-from-deployment/_static/image3.png)

    > [!NOTE]
    > При добавлении нового элемента к корневому узлу проекта, файл создается в той же папке, что и файл проекта. Это можно проверить, открыв нужную папку в проводнике Windows.
5. Добавьте в файл, **проекта** элемент и **ItemGroup** элемент:

    [!code-xml[Main](excluding-files-and-folders-from-deployment/samples/sample2.xml)]
6. Если вы хотите исключить папки из веб-пакета, добавьте **ExcludeFromPackageFolders** элемент **ItemGroup** элемент:

   1. В **Include** атрибут, укажите разделенный точками с запятой список папок, которую требуется исключить.
   2. В **FromTarget** элемент метаданных, иметь существенного значения для указания того, почему папок исключаются, такие как имя *. wpp.targets* файл.

      [!code-xml[Main](excluding-files-and-folders-from-deployment/samples/sample3.xml)]
7. Если вы хотите исключить файлы из веб-пакета, добавьте **ExcludeFromPackageFiles** элемент **ItemGroup** элемент:

   1. В **Include** атрибут, укажите разделенный точками с запятой список файлов, которую требуется исключить.
   2. В **FromTarget** элемент метаданных, иметь существенного значения для указания того, почему файлы исключаются, такие как имя *. wpp.targets* файл.

      [!code-xml[Main](excluding-files-and-folders-from-deployment/samples/sample4.xml)]
8. *.Wpp.targets [имя_проекта]* файл должен теперь выглядеть примерно следующим образом:

    [!code-xml[Main](excluding-files-and-folders-from-deployment/samples/sample5.xml)]
9. Сохраните и закройте *.wpp.targets [имя_проекта]* файл.

При повторном сборка и упаковка проекта веб-приложения, WPP автоматически обнаруживает *. wpp.targets* файл. Все файлы и папки, которые вы указали не будет включаться в веб-пакета.

## <a name="conclusion"></a>Заключение

В этом разделе описано, как исключить определенные файлы и папки, при построении веб-пакет, с помощью пользовательского *. wpp.targets* файл в той же папке, как файл проекта веб-приложения.

## <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения об использовании пользовательских файлов проекта Microsoft Build Engine (MSBuild) для управления процессом развертывания, см. в разделе [основные сведения о файле проекта](../web-deployment-in-the-enterprise/understanding-the-project-file.md) и [основные сведения о процессе построения](../web-deployment-in-the-enterprise/understanding-the-build-process.md). Дополнительные сведения об упаковке и процесса развертывания см. в разделе [сборка и упаковка проектов веб-приложений](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md), [Настройка параметров для развертывания веб-пакета](../web-deployment-in-the-enterprise/configuring-parameters-for-web-package-deployment.md), и [ Развертывание веб-пакетов](../web-deployment-in-the-enterprise/deploying-web-packages.md).

> [!div class="step-by-step"]
> [Назад](deploying-membership-databases-to-enterprise-environments.md)
> [Вперед](taking-web-applications-offline-with-web-deploy.md)
