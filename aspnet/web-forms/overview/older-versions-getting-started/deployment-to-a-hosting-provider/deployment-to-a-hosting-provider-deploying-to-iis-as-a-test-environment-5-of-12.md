---
uid: web-forms/overview/older-versions-getting-started/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12
title: 'Развертывание веб-приложения ASP.NET с SQL Server Compact с помощью Visual Studio или Visual Web Developer: Развертывание в IIS в качестве тестовой среды — 5, 12 | Документация Майкрософт'
author: tdykstra
description: Этой серии руководств показано, как развернуть (публикации) ASP.NET проекта веб-приложения, который содержит базу данных SQL Server Compact с помощью Visual Stu...
ms.author: riande
ms.date: 11/17/2011
ms.assetid: 493b2a66-816c-485c-8315-952ed1085ccc
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12
msc.type: authoredcontent
ms.openlocfilehash: 191d194d4aaad15ac6c5187105d49a03a2f06bf2
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59413351"
---
# <a name="deploying-an-aspnet-web-application-with-sql-server-compact-using-visual-studio-or-visual-web-developer-deploying-to-iis-as-a-test-environment---5-of-12"></a><span data-ttu-id="15cbc-103">Развертывание веб-приложения ASP.NET с SQL Server Compact с помощью Visual Studio или Visual Web Developer: Развертывание в IIS в качестве тестовой среды — 5, 12</span><span class="sxs-lookup"><span data-stu-id="15cbc-103">Deploying an ASP.NET Web Application with SQL Server Compact using Visual Studio or Visual Web Developer: Deploying to IIS as a Test Environment - 5 of 12</span></span>

<span data-ttu-id="15cbc-104">по [том Дайкстра](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="15cbc-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

[<span data-ttu-id="15cbc-105">Загрузите начальный проект</span><span class="sxs-lookup"><span data-stu-id="15cbc-105">Download Starter Project</span></span>](http://code.msdn.microsoft.com/Deploying-an-ASPNET-Web-4e31366b)

> <span data-ttu-id="15cbc-106">Этой серии руководств показано, как развернуть (публикации) ASP.NET проекта веб-приложения, который содержит базу данных SQL Server Compact с помощью Visual Studio 2012 RC или Visual Studio Express 2012 RC для Web.</span><span class="sxs-lookup"><span data-stu-id="15cbc-106">This series of tutorials shows you how to deploy (publish) an ASP.NET web application project that includes a SQL Server Compact database by using Visual Studio 2012 RC or Visual Studio Express 2012 RC for Web.</span></span> <span data-ttu-id="15cbc-107">Также можно использовать Visual Studio 2010, если установить обновление веб-публикации.</span><span class="sxs-lookup"><span data-stu-id="15cbc-107">You can also use Visual Studio 2010 if you install the Web Publish Update.</span></span> <span data-ttu-id="15cbc-108">Введение в серии, см. в разделе [в первом учебнике серии](deployment-to-a-hosting-provider-introduction-1-of-12.md).</span><span class="sxs-lookup"><span data-stu-id="15cbc-108">For an introduction to the series, see [the first tutorial in the series](deployment-to-a-hosting-provider-introduction-1-of-12.md).</span></span>
> 
> <span data-ttu-id="15cbc-109">Учебник, в котором показаны компоненты развертывания, появившиеся после выпуска версии-КАНДИДАТА Visual Studio 2012, содержит сведения о развертывании выпусков SQL Server, отличных от SQL Server Compact и содержит сведения о развертывании веб-приложения службы приложений Azure, см. в разделе [веб-развертывание ASP.NET с помощью Visual Studio](../../deployment/visual-studio-web-deployment/introduction.md).</span><span class="sxs-lookup"><span data-stu-id="15cbc-109">For a tutorial that shows deployment features introduced after the RC release of Visual Studio 2012, shows how to deploy SQL Server editions other than SQL Server Compact, and shows how to deploy to Azure App Service Web Apps, see [ASP.NET Web Deployment using Visual Studio](../../deployment/visual-studio-web-deployment/introduction.md).</span></span>


## <a name="overview"></a><span data-ttu-id="15cbc-110">Обзор</span><span class="sxs-lookup"><span data-stu-id="15cbc-110">Overview</span></span>

<span data-ttu-id="15cbc-111">Этом руководстве показано, как развернуть веб-приложения ASP.NET в IIS на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="15cbc-111">This tutorial shows how to deploy an ASP.NET web application to IIS on the local computer.</span></span>

<span data-ttu-id="15cbc-112">При разработке приложения, обычно тестируется путем запуска его в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="15cbc-112">When you develop an application, you generally test by running it in Visual Studio.</span></span> <span data-ttu-id="15cbc-113">По умолчанию это означает, что вы используете Visual Studio Development Server (также известном как Cassini).</span><span class="sxs-lookup"><span data-stu-id="15cbc-113">By default, this means you're using the Visual Studio Development Server (also known as Cassini).</span></span> <span data-ttu-id="15cbc-114">Visual Studio Development Server упрощает процесс тестирования во время разработки в Visual Studio, но он не работает так же, как IIS.</span><span class="sxs-lookup"><span data-stu-id="15cbc-114">The Visual Studio Development Server makes it easy to test during development in Visual Studio, but it doesn't work exactly like IIS.</span></span> <span data-ttu-id="15cbc-115">Таким образом вполне возможно, что приложения будут выполняться правильно при тестировании в Visual Studio, но сбой при развертывании в IIS в среде размещения.</span><span class="sxs-lookup"><span data-stu-id="15cbc-115">As a result, it's possible that an application will run correctly when you test it in Visual Studio, but fail when it's deployed to IIS in a hosting environment.</span></span>

<span data-ttu-id="15cbc-116">Приложение можно протестировать надежнее следующими способами:</span><span class="sxs-lookup"><span data-stu-id="15cbc-116">You can test your application more reliably in these ways:</span></span>

1. <span data-ttu-id="15cbc-117">Используйте IIS Express или полноценного сервера IIS вместо Visual Studio Development Server при тестировании в Visual Studio во время разработки.</span><span class="sxs-lookup"><span data-stu-id="15cbc-117">Use IIS Express or full IIS instead of the Visual Studio Development Server when you test in Visual Studio during development.</span></span> <span data-ttu-id="15cbc-118">Этот метод обычно эмулирует более точно как сайт будет работать под управлением служб IIS.</span><span class="sxs-lookup"><span data-stu-id="15cbc-118">This method generally emulates more accurately how your site will run under IIS.</span></span> <span data-ttu-id="15cbc-119">Тем не менее этот метод не нужно проверить процесс развертывания и проверить, что результат процесса развертывания будет работать неправильно.</span><span class="sxs-lookup"><span data-stu-id="15cbc-119">However, this method does not test your deployment process or validate that the result of the deployment process will run correctly.</span></span>
2. <span data-ttu-id="15cbc-120">Разверните приложение в службах IIS на компьютере разработчика, используя тот же процесс, который будет использоваться в дальнейшем для его развертывания в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="15cbc-120">Deploy the application to IIS on your development computer by using the same process that you'll use later to deploy it to your production environment.</span></span> <span data-ttu-id="15cbc-121">Этот метод проверяет процесс развертывания в дополнение к проверке, приложение будет работать под управлением служб IIS.</span><span class="sxs-lookup"><span data-stu-id="15cbc-121">This method validates your deployment process in addition to validating that your application will run correctly under IIS.</span></span>
3. <span data-ttu-id="15cbc-122">Развертывание приложения в тестовой среде, максимально близки к рабочей среды.</span><span class="sxs-lookup"><span data-stu-id="15cbc-122">Deploy the application to a test environment that is as close as possible to your production environment.</span></span> <span data-ttu-id="15cbc-123">Поскольку в рабочую среду для этих учебников стороннего поставщика услуг размещения, идеальный тестовая среда будет вторую учетную запись с помощью поставщика услуг размещения.</span><span class="sxs-lookup"><span data-stu-id="15cbc-123">Since the production environment for these tutorials is a third-party hosting provider, the ideal test environment would be a second account with the hosting provider.</span></span> <span data-ttu-id="15cbc-124">Эта вторая учетная запись используется только для тестирования, но он настраивается так же, как рабочую учетную запись.</span><span class="sxs-lookup"><span data-stu-id="15cbc-124">You would use this second account only for testing, but it would be set up the same way as the production account.</span></span>

<span data-ttu-id="15cbc-125">Мы продемонстрируем этапы вариант 2.</span><span class="sxs-lookup"><span data-stu-id="15cbc-125">This tutorial shows the steps for option 2.</span></span> <span data-ttu-id="15cbc-126">Руководство для варианта 3 предоставляется в конце [развертывание в рабочей среде](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12.md) руководстве и в конце этого руководства находятся ссылки на ресурсы для вариант 1.</span><span class="sxs-lookup"><span data-stu-id="15cbc-126">Guidance for option 3 is provided at the end of the [Deploying to the Production Environment](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12.md) tutorial, and at the end of this tutorial there are links to resources for option 1.</span></span>

<span data-ttu-id="15cbc-127">Напоминание. Если вы получаете сообщение об ошибке, или что-то не работает, как работать с руководством, обязательно проверьте [страница устранения неполадок](deployment-to-a-hosting-provider-creating-and-installing-deployment-packages-12-of-12.md).</span><span class="sxs-lookup"><span data-stu-id="15cbc-127">Reminder: If you get an error message or something doesn't work as you go through the tutorial, be sure to check the [troubleshooting page](deployment-to-a-hosting-provider-creating-and-installing-deployment-packages-12-of-12.md).</span></span>

## <a name="configuring-the-application-to-run-in-medium-trust"></a><span data-ttu-id="15cbc-128">Настройка приложения для выполнения в среднем уровне доверия</span><span class="sxs-lookup"><span data-stu-id="15cbc-128">Configuring the Application to Run in Medium Trust</span></span>

<span data-ttu-id="15cbc-129">Перед установкой служб IIS и развертывание к нему, вам предстоит изменить параметра файла Web.config, чтобы сделать узел выполнения более как в обычной общей среде размещения.</span><span class="sxs-lookup"><span data-stu-id="15cbc-129">Before installing IIS and deploying to it, you'll change a Web.config file setting in order to make the site run more like it will in a typical shared hosting environment.</span></span>

<span data-ttu-id="15cbc-130">Поставщики услуг размещения обычно выполняются веб-сайт в *со средним уровнем доверия*, что означает, что нельзя сделать следующее.</span><span class="sxs-lookup"><span data-stu-id="15cbc-130">Hosting providers typically run your web site in *medium trust*, which means there are some things it is not allowed to do.</span></span> <span data-ttu-id="15cbc-131">Например код приложения нельзя доступа к реестру Windows и не удается прочесть или записывать файлы, которые находятся вне иерархии папок приложения.</span><span class="sxs-lookup"><span data-stu-id="15cbc-131">For example, application code can't access the Windows registry and can't read or write files that are outside of your application's folder hierarchy.</span></span> <span data-ttu-id="15cbc-132">По умолчанию приложение выполняется в *высоким уровнем доверия* на локальном компьютере, что означает, что приложение может иметь возможность выполнять действия, которые будут выполнены при развертывании в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="15cbc-132">By default your application runs in *high trust* on your local computer, which means that the application might be able to do things that would fail when you deploy it to production.</span></span> <span data-ttu-id="15cbc-133">Таким образом чтобы сделать тестовую среду, которая более точно отражает рабочую среду, вы настроите приложение для запуска в среднем уровне доверия.</span><span class="sxs-lookup"><span data-stu-id="15cbc-133">Therefore, to make the test environment more accurately reflect the production environment, you'll configure the application to run in medium trust.</span></span>

<span data-ttu-id="15cbc-134">В файле Web.config приложения добавьте **доверия** элемент в **system.web** элемента, как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="15cbc-134">In the application Web.config file, add a **trust** element in the **system.web** element, as shown in this example.</span></span>

[!code-xml[Main](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/samples/sample1.xml?highlight=4)]

<span data-ttu-id="15cbc-135">Приложение теперь будет выполняться в среднем уровне доверия в службах IIS даже на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="15cbc-135">The application will now run in medium trust in IIS even on your local computer.</span></span> <span data-ttu-id="15cbc-136">Этот параметр позволяет перехватывать любые попытки как можно раньше в коде приложения сделать нечто, вызывавшие сбои в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="15cbc-136">This setting enables you to catch as early as possible any attempts by application code to do something that would fail in production.</span></span>

> [!NOTE]
> <span data-ttu-id="15cbc-137">При использовании Entity Framework Code First Migrations, убедитесь, что у вас есть версии 5.0 или более поздней версии.</span><span class="sxs-lookup"><span data-stu-id="15cbc-137">If you are using Entity Framework Code First Migrations, make sure that you have version 5.0 or later installed.</span></span> <span data-ttu-id="15cbc-138">В Entity Framework версии 4.3 миграция требует полного доверия, чтобы обновить схему базы данных.</span><span class="sxs-lookup"><span data-stu-id="15cbc-138">In Entity Framework version 4.3, Migrations requires full trust in order to update the database schema.</span></span>


## <a name="installing-iis-and-web-deploy"></a><span data-ttu-id="15cbc-139">Установка IIS и веб-развертывание</span><span class="sxs-lookup"><span data-stu-id="15cbc-139">Installing IIS and Web Deploy</span></span>

<span data-ttu-id="15cbc-140">Для развертывания в IIS на компьютере разработчика, требуются службы IIS и веб-развертывания установлены.</span><span class="sxs-lookup"><span data-stu-id="15cbc-140">To deploy to IIS on your development computer, you must have IIS and Web Deploy installed.</span></span> <span data-ttu-id="15cbc-141">Они не включаются в конфигурации по умолчанию Windows 7.</span><span class="sxs-lookup"><span data-stu-id="15cbc-141">These are not included in the default Windows 7 configuration.</span></span> <span data-ttu-id="15cbc-142">Если вы уже установили службы IIS и веб-развертывания, перейдите к следующему разделу.</span><span class="sxs-lookup"><span data-stu-id="15cbc-142">If you have already installed both IIS and Web Deploy, skip to the next section.</span></span>

<span data-ttu-id="15cbc-143">С помощью [установщика веб-платформы](https://www.microsoft.com/web/downloads/platform.aspx) является более предпочтительным для установки IIS и веб-развертывания, поскольку установщик веб-платформы устанавливает рекомендуемые конфигурации для служб IIS и она автоматически устанавливает необходимые компоненты для IIS и веб- Развертывание, при необходимости.</span><span class="sxs-lookup"><span data-stu-id="15cbc-143">Using the [Web Platform Installer](https://www.microsoft.com/web/downloads/platform.aspx) is the preferred way to install IIS and Web Deploy, because the Web Platform Installer installs a recommended configuration for IIS and it automatically installs the prerequisites for IIS and Web Deploy if necessary.</span></span>

<span data-ttu-id="15cbc-144">Чтобы запустить установщик веб-платформы для установки IIS и веб-развертывания, используйте следующую ссылку.</span><span class="sxs-lookup"><span data-stu-id="15cbc-144">To run Web Platform Installer to install IIS and Web Deploy, use the following link.</span></span> <span data-ttu-id="15cbc-145">Если вы уже установили IIS, веб-развертывания или любой из необходимых компонентов для них, установщик веб-платформы устанавливает только что здесь отсутствует.</span><span class="sxs-lookup"><span data-stu-id="15cbc-145">If you already have installed IIS, Web Deploy or any of their required components, the Web Platform Installer installs only what is missing.</span></span>

- [<span data-ttu-id="15cbc-146">Установка служб IIS и веб-развертывания с помощью установщика веб-платформы</span><span class="sxs-lookup"><span data-stu-id="15cbc-146">Install IIS and Web Deploy using WebPI</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=IIS7;ASPNET;NETFramework4;WDeploy)

## <a name="setting-the-default-application-pool-to-net-4"></a><span data-ttu-id="15cbc-147">Установка по умолчанию пула приложений в .NET 4</span><span class="sxs-lookup"><span data-stu-id="15cbc-147">Setting the Default Application Pool to .NET 4</span></span>

<span data-ttu-id="15cbc-148">После установки служб IIS, запустите **диспетчера служб IIS** чтобы убедиться в том, что пул приложений по умолчанию назначается в .NET Framework версии 4.</span><span class="sxs-lookup"><span data-stu-id="15cbc-148">After installing IIS, run **IIS Manager** to make sure that the .NET Framework version 4 is assigned to the default application pool.</span></span>

<span data-ttu-id="15cbc-149">Из Windows **запустить** меню, выберите **запуска**, введите «inetmgr» и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="15cbc-149">From the Windows **Start** menu, select **Run**, enter "inetmgr", and then click **OK**.</span></span> <span data-ttu-id="15cbc-150">(Если **запуска** команды не находится в вашей **запустить** меню, можно нажать клавишу Windows и R, чтобы открыть его.</span><span class="sxs-lookup"><span data-stu-id="15cbc-150">(If the **Run** command is not in your **Start** menu, you can press the Windows Key and R to open it.</span></span> <span data-ttu-id="15cbc-151">Или щелкните правой кнопкой мыши на панели задач, нажмите кнопку **свойства**выберите **меню "Пуск"** щелкните **Настройка**и выберите **выполните команду**.)</span><span class="sxs-lookup"><span data-stu-id="15cbc-151">Or right-click the taskbar, click **Properties**, select the **Start Menu** tab, click **Customize**, and select **Run command**.)</span></span>

<span data-ttu-id="15cbc-152">В **подключений** области, разверните узел сервера и выберите **пулы приложений**.</span><span class="sxs-lookup"><span data-stu-id="15cbc-152">In the **Connections** pane, expand the server node and select **Application Pools**.</span></span> <span data-ttu-id="15cbc-153">В **пулы приложений** области, если **DefaultAppPool** будет назначено .NET framework версии 4, как показано на следующем рисунке, перейдите к следующему разделу.</span><span class="sxs-lookup"><span data-stu-id="15cbc-153">In the **Application Pools** pane, if **DefaultAppPool** is assigned to the .NET framework version 4 as in the following illustration, skip to the next section.</span></span>

<span data-ttu-id="15cbc-154">[![Inetmgr_showing_4.0_app_pools](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image2.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="15cbc-154">[![Inetmgr_showing_4.0_app_pools](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image2.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image1.png)</span></span>

<span data-ttu-id="15cbc-155">Если вы видите только два пула приложений, и они задаются в .NET Framework 2.0, необходимо установить ASP.NET 4 в IIS:</span><span class="sxs-lookup"><span data-stu-id="15cbc-155">If you see only two application pools and both of them are set to the .NET Framework 2.0, you have to install ASP.NET 4 in IIS:</span></span>

- <span data-ttu-id="15cbc-156">Откройте окно командной строки, щелкнув правой кнопкой мыши **командной** в Windows **запустить** меню и выбрав **Запуск от имени администратора**.</span><span class="sxs-lookup"><span data-stu-id="15cbc-156">Open a command prompt window by right-clicking **Command Prompt** in the Windows **Start** menu and selecting **Run as Administrator**.</span></span> <span data-ttu-id="15cbc-157">Затем запустите [aspnet\_regiis.exe](https://msdn.microsoft.com/library/k6h9cz8h.aspx) установить ASP.NET 4 в IIS, с помощью следующих команд.</span><span class="sxs-lookup"><span data-stu-id="15cbc-157">Then run [aspnet\_regiis.exe](https://msdn.microsoft.com/library/k6h9cz8h.aspx) to install ASP.NET 4 in IIS, using the following commands.</span></span> <span data-ttu-id="15cbc-158">(В 64-разрядных системах, замените «Платформа» с «Framework64»).</span><span class="sxs-lookup"><span data-stu-id="15cbc-158">(In 64-bit systems, replace "Framework" with "Framework64".)</span></span>

    [!code-console[Main](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/samples/sample2.cmd)]

    <span data-ttu-id="15cbc-159">[![aspnet_regiis_installing_ASP.NET_4](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image4.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="15cbc-159">[![aspnet_regiis_installing_ASP.NET_4](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image4.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image3.png)</span></span>

    <span data-ttu-id="15cbc-160">Эта команда создает новые пулы приложений для .NET Framework 4, но пул приложений по умолчанию по-прежнему будет указано значение 2.0.</span><span class="sxs-lookup"><span data-stu-id="15cbc-160">This command creates new application pools for the .NET Framework 4, but the default application pool will still be set to 2.0.</span></span> <span data-ttu-id="15cbc-161">Вы будете развертывать приложения, ориентированном на .NET 4 с этим пулом приложений, поэтому вам нужно изменить пул приложений для .NET 4.</span><span class="sxs-lookup"><span data-stu-id="15cbc-161">You'll be deploying an application that targets .NET 4 to that application pool, so you have to change the application pool to .NET 4.</span></span>

<span data-ttu-id="15cbc-162">Если вы закрыли **диспетчера служб IIS**, запустите его снова, раскройте узел сервера и нажмите кнопку **пулы приложений** для отображения **пулы приложений** панель снова.</span><span class="sxs-lookup"><span data-stu-id="15cbc-162">If you closed **IIS Manager**, run it again, expand the server node, and click **Application Pools** to display the **Application Pools** pane again.</span></span>

<span data-ttu-id="15cbc-163">В **пулы приложений** области нажмите кнопку **DefaultAppPool**, а затем в **действия** панели щелкните **основные параметры**.</span><span class="sxs-lookup"><span data-stu-id="15cbc-163">In the **Application Pools** pane, click **DefaultAppPool**, and then in the **Actions** pane click **Basic Settings**.</span></span>

<span data-ttu-id="15cbc-164">[![Inetmgr_selecting_Basic_Settings_for_app_pool](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image6.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="15cbc-164">[![Inetmgr_selecting_Basic_Settings_for_app_pool](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image6.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image5.png)</span></span>

<span data-ttu-id="15cbc-165">В **изменение пула приложений** » диалогового окна «Изменение **версии платформы .NET Framework** для **v4.0.30319 .NET Framework** и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="15cbc-165">In the **Edit Application Pool** dialog box, change **.NET Framework version** to **.NET Framework v4.0.30319** and click **OK**.</span></span>

<span data-ttu-id="15cbc-166">[![Selecting_.NET_4_for_DefaultAppPool](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image8.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="15cbc-166">[![Selecting_.NET_4_for_DefaultAppPool](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image8.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image7.png)</span></span>

<span data-ttu-id="15cbc-167">Теперь вы готовы к публикации в службах IIS.</span><span class="sxs-lookup"><span data-stu-id="15cbc-167">You are now ready to publish to IIS.</span></span>

## <a name="publishing-to-iis"></a><span data-ttu-id="15cbc-168">Публикация в IIS</span><span class="sxs-lookup"><span data-stu-id="15cbc-168">Publishing to IIS</span></span>

<span data-ttu-id="15cbc-169">Существует несколько способов, которые можно развернуть с помощью Visual Studio 2010 и веб-развертывания:</span><span class="sxs-lookup"><span data-stu-id="15cbc-169">There are several ways you can deploy using Visual Studio 2010 and Web Deploy:</span></span>

- <span data-ttu-id="15cbc-170">С помощью Visual Studio, публикация одним щелчком.</span><span class="sxs-lookup"><span data-stu-id="15cbc-170">Use Visual Studio one-click publish.</span></span>
- <span data-ttu-id="15cbc-171">Создание *пакет развертывания* и установить его с помощью пользовательского интерфейса диспетчера IIS.</span><span class="sxs-lookup"><span data-stu-id="15cbc-171">Create a *deployment package* and install it using the IIS Manager UI.</span></span> <span data-ttu-id="15cbc-172">Пакет развертывания состоит из *ZIP-файл* файл, содержащий все файлы и метаданные, необходимые для установки сайта в IIS.</span><span class="sxs-lookup"><span data-stu-id="15cbc-172">The deployment package consists of a *.zip* file that contains all the files and metadata needed to install a site in IIS.</span></span>
- <span data-ttu-id="15cbc-173">Создание пакета развертывания и установить его с помощью командной строки.</span><span class="sxs-lookup"><span data-stu-id="15cbc-173">Create a deployment package and install it using the command line.</span></span>

<span data-ttu-id="15cbc-174">Процесс, который вы выполнили в предыдущих учебных курсах, чтобы настроить Visual Studio для автоматизации задач развертывания применяется ко всем из трех способов.</span><span class="sxs-lookup"><span data-stu-id="15cbc-174">The process you went through in the previous tutorials to set up Visual Studio to automate deployment tasks applies to all of these three methods.</span></span> <span data-ttu-id="15cbc-175">В этих учебниках используется первый из этих методов.</span><span class="sxs-lookup"><span data-stu-id="15cbc-175">In these tutorials you'll use the first of these methods.</span></span> <span data-ttu-id="15cbc-176">Для получения сведений о пакетах развертывания, см. в разделе [Карта содержимого развертывания ASP.NET](https://msdn.microsoft.com/library/bb386521.aspx).</span><span class="sxs-lookup"><span data-stu-id="15cbc-176">For information about using deployment packages, see [ASP.NET Deployment Content Map](https://msdn.microsoft.com/library/bb386521.aspx).</span></span>

<span data-ttu-id="15cbc-177">Перед публикацией, убедитесь, что Visual Studio выполняется в режиме администратора.</span><span class="sxs-lookup"><span data-stu-id="15cbc-177">Before publishing, make sure that you are running Visual Studio in administrator mode.</span></span> <span data-ttu-id="15cbc-178">(В Windows 7 **запустить** меню, щелкните правой кнопкой мыши значок для версии Visual Studio, вы используете и выберите **Запуск от имени администратора**.) Режим администратора является обязательным для публикации, только когда вы публикуете в службах IIS на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="15cbc-178">(In the Windows 7 **Start** menu, right-click the icon for the version of Visual Studio you're using and select **Run as Administrator**.) Administrator mode is required for publishing only when you are publishing to IIS on the local computer.</span></span>

<span data-ttu-id="15cbc-179">В **обозревателе решений**, щелкните правой кнопкой мыши проект ContosoUniversity (не проект ContosoUniversity.DAL) и выберите **публикации**.</span><span class="sxs-lookup"><span data-stu-id="15cbc-179">In **Solution Explorer**, right-click the ContosoUniversity project (not the ContosoUniversity.DAL project) and select **Publish**.</span></span>

<span data-ttu-id="15cbc-180">**Веб-публикации** откроется мастер.</span><span class="sxs-lookup"><span data-stu-id="15cbc-180">The **Publish Web** wizard appears.</span></span>

![Publish_Web_wizard_Profile_tab](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image9.png)

<span data-ttu-id="15cbc-182">В раскрывающемся списке выберите  **&lt;New... &gt;**.</span><span class="sxs-lookup"><span data-stu-id="15cbc-182">In the drop-down list, select **&lt;New...&gt;**.</span></span>

<span data-ttu-id="15cbc-183">В **новый профиль** диалоговое окно, введите «Test» и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="15cbc-183">In the **New Profile** dialog box, enter "Test", and then click **OK**.</span></span>

![New_Profile_dialog_box](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image10.png)

<span data-ttu-id="15cbc-185">Это имя является таким же, как в среднем узел Web.Test.config преобразования файла, который был создан ранее.</span><span class="sxs-lookup"><span data-stu-id="15cbc-185">This name is the same as the middle node of the Web.Test.config transform file that you created earlier.</span></span> <span data-ttu-id="15cbc-186">Это соответствие является, в каком случае Web.Test.config преобразования для применения при публикации с использованием этого профиля.</span><span class="sxs-lookup"><span data-stu-id="15cbc-186">This correspondence is what causes the Web.Test.config transformations to be applied when you publish by using this profile.</span></span>

<span data-ttu-id="15cbc-187">Мастер автоматически переходит к **подключения** вкладки.</span><span class="sxs-lookup"><span data-stu-id="15cbc-187">The wizard automatically advances to the **Connection** tab.</span></span>

<span data-ttu-id="15cbc-188">В **URL-адрес службы** введите *localhost*.</span><span class="sxs-lookup"><span data-stu-id="15cbc-188">In the **Service URL** box, enter *localhost*.</span></span>

<span data-ttu-id="15cbc-189">В **сайт и приложение** введите *веб-сайт по умолчанию/ContosoUniversity*.</span><span class="sxs-lookup"><span data-stu-id="15cbc-189">In the **Site/application** box, enter *Default Web Site/ContosoUniversity*.</span></span>

<span data-ttu-id="15cbc-190">В **URL-адрес назначения** введите `http://localhost/ContosoUniversity`.</span><span class="sxs-lookup"><span data-stu-id="15cbc-190">In the **Destination URL** box, enter `http://localhost/ContosoUniversity`.</span></span>

<span data-ttu-id="15cbc-191">**URL-адрес назначения** параметр не требуется.</span><span class="sxs-lookup"><span data-stu-id="15cbc-191">The **Destination URL** setting isn't required.</span></span> <span data-ttu-id="15cbc-192">Когда Visual Studio завершит развертывание приложения, автоматически откроется браузер по умолчанию этот URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="15cbc-192">When Visual Studio finishes deploying the application, it automatically opens your default browser to this URL.</span></span> <span data-ttu-id="15cbc-193">Если вы не хотите в браузере открывается автоматически после развертывания, оставьте это поле пустым.</span><span class="sxs-lookup"><span data-stu-id="15cbc-193">If you don't want the browser to open automatically after deployment, leave this box blank.</span></span>

![Publish_Web_wizard_Connection_tab_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image11.png)

<span data-ttu-id="15cbc-195">Нажмите кнопку **проверить подключение** для убедитесь, что параметры указаны правильно, и можно подключиться к службам IIS на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="15cbc-195">Click **Validate Connection** to verify that the settings are correct and you can connect to IIS on the local computer.</span></span>

<span data-ttu-id="15cbc-196">Зеленая галочка проверяет, что подключение выполнено успешно.</span><span class="sxs-lookup"><span data-stu-id="15cbc-196">A green check mark verifies that the connection is successful.</span></span>

![Publish_Web_wizard_Connection_tab_validated](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image12.png)

<span data-ttu-id="15cbc-198">Нажмите кнопку **Далее** для перехода к **параметры** вкладки.</span><span class="sxs-lookup"><span data-stu-id="15cbc-198">Click **Next** to advance to the **Settings** tab.</span></span>

<span data-ttu-id="15cbc-199">**Конфигурации** раскрывающемся списке указывает конфигурацию сборки для развертывания.</span><span class="sxs-lookup"><span data-stu-id="15cbc-199">The **Configuration** drop-down box specifies the build configuration to deploy.</span></span> <span data-ttu-id="15cbc-200">Значение по умолчанию — выпуска, которые нужны.</span><span class="sxs-lookup"><span data-stu-id="15cbc-200">The default value is Release, which is what you want.</span></span>

<span data-ttu-id="15cbc-201">Оставьте **удалять дополнительные файлы в месте назначения** флажок снят.</span><span class="sxs-lookup"><span data-stu-id="15cbc-201">Leave the **Remove additional files at destination** check box cleared.</span></span> <span data-ttu-id="15cbc-202">Так как это первый развертывания, не будет все файлы в папке назначения еще.</span><span class="sxs-lookup"><span data-stu-id="15cbc-202">Since this is your first deployment, there won't be any files in the destination folder yet.</span></span>

<span data-ttu-id="15cbc-203">В **баз данных** введите следующее значение в поле Строка подключения для **SchoolContext**:</span><span class="sxs-lookup"><span data-stu-id="15cbc-203">In the **Databases** section, enter the following value in the connection string box for **SchoolContext**:</span></span>

[!code-console[Main](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/samples/sample3.cmd)]

<span data-ttu-id="15cbc-204">Процесс развертывания будет поместить эту строку подключения в развернутый файл Web.config, поскольку **использовать эту строку подключения во время выполнения** выбран.</span><span class="sxs-lookup"><span data-stu-id="15cbc-204">The deployment process will put this connection string in the deployed Web.config file because **Use this connection string at runtime** is selected.</span></span>

<span data-ttu-id="15cbc-205">Также в разделе **SchoolContext**выберите **применить Code First Migrations**.</span><span class="sxs-lookup"><span data-stu-id="15cbc-205">Also under **SchoolContext**, select **Apply Code First Migrations**.</span></span> <span data-ttu-id="15cbc-206">Этот параметр вызывает завершение процесса развертывания для настройки развернутый файл Web.config для указания `MigrateDatabaseToLatestVersion` инициализатор.</span><span class="sxs-lookup"><span data-stu-id="15cbc-206">This option causes the deployment process to configure the deployed Web.config file to specify the `MigrateDatabaseToLatestVersion` initializer.</span></span> <span data-ttu-id="15cbc-207">Это инициализатор автоматически обновляет базу данных до последней версии, когда приложение получает доступ к базе данных в первый раз после развертывания.</span><span class="sxs-lookup"><span data-stu-id="15cbc-207">This initializer automatically updates the database to the latest version when the application accesses the database for the first time after deployment.</span></span>

<span data-ttu-id="15cbc-208">В поле Строка подключения для **DefaultConnection**, введите следующее значение:</span><span class="sxs-lookup"><span data-stu-id="15cbc-208">In the connection string box for **DefaultConnection**, enter the following value:</span></span>

[!code-console[Main](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/samples/sample4.cmd)]

<span data-ttu-id="15cbc-209">Оставьте **обновления базы данных** очищен.</span><span class="sxs-lookup"><span data-stu-id="15cbc-209">Leave **Update database** cleared.</span></span> <span data-ttu-id="15cbc-210">Базы данных членства будет развертываться путем копирования SDF-файл в приложении\_данных и вы не хотите, процесс развертывания, никакие дополнительные действия с этой базой данных.</span><span class="sxs-lookup"><span data-stu-id="15cbc-210">The membership database will be deployed by copying the .sdf file in App\_Data, and you don't want the deployment process to do anything else with this database.</span></span>

![Publish_Web_wizard_Settings_tab_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image13.png)

<span data-ttu-id="15cbc-212">Нажмите кнопку **Далее** для перехода к **предварительной версии** вкладки.</span><span class="sxs-lookup"><span data-stu-id="15cbc-212">Click **Next** to advance to the **Preview** tab.</span></span>

<span data-ttu-id="15cbc-213">В **предварительной версии** щелкните **начать просмотр** для просмотра списка файлов, которые будут скопированы.</span><span class="sxs-lookup"><span data-stu-id="15cbc-213">In the **Preview** tab, click **Start Preview** to see a list of the files that will be copied.</span></span>

![Publish_Web_wizard_Preview_tab_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image14.png)

![Publish_Web_wizard_Preview_tab_Test_with_file_list](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image15.png)

<span data-ttu-id="15cbc-216">Нажмите кнопку **Опубликовать**.</span><span class="sxs-lookup"><span data-stu-id="15cbc-216">Click **Publish**.</span></span>

<span data-ttu-id="15cbc-217">Если Visual Studio не находится в режиме администратора, может появиться сообщение об ошибке, указывающее ошибку.</span><span class="sxs-lookup"><span data-stu-id="15cbc-217">If Visual Studio is not in administrator mode, you might get an error message that indicates a permissions error.</span></span> <span data-ttu-id="15cbc-218">В этом случае закройте Visual Studio, откройте его в режиме администратора и повторите попытку публикации.</span><span class="sxs-lookup"><span data-stu-id="15cbc-218">In that case, close Visual Studio, open it in administrator mode, and try to publish again.</span></span>

<span data-ttu-id="15cbc-219">Если Visual Studio находится в режиме администратора, **вывода** отчеты окно успешной сборки и публикации.</span><span class="sxs-lookup"><span data-stu-id="15cbc-219">If Visual Studio is in administrator mode, the **Output** window reports successful build and publish.</span></span>

![Output_window_publish_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image16.png)

<span data-ttu-id="15cbc-221">В браузере автоматически откроется на Contoso University домашнюю страницу, на сервере IIS на локальном компьютере.</span><span class="sxs-lookup"><span data-stu-id="15cbc-221">The browser automatically opens to the Contoso University Home page running in IIS on the local computer.</span></span>

<span data-ttu-id="15cbc-222">[![Home_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image18.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="15cbc-222">[![Home_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image18.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image17.png)</span></span>

## <a name="testing-in-the-test-environment"></a><span data-ttu-id="15cbc-223">Тестирование в тестовой среде</span><span class="sxs-lookup"><span data-stu-id="15cbc-223">Testing in the Test Environment</span></span>

<span data-ttu-id="15cbc-224">Обратите внимание на то, что среда индикатор отображает «(тест)» вместо «(Dev)», который показывает, что *Web.config* выполнено преобразование для индикатора среды.</span><span class="sxs-lookup"><span data-stu-id="15cbc-224">Notice that the environment indicator shows "(Test)" instead of "(Dev)", which shows that the *Web.config* transformation for the environment indicator was successful.</span></span>

<span data-ttu-id="15cbc-225">[![Home_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image20.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="15cbc-225">[![Home_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image20.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image19.png)</span></span>

<span data-ttu-id="15cbc-226">Запустите **учащихся** страницу, чтобы убедиться, что развернутая база данных имеет не учащихся.</span><span class="sxs-lookup"><span data-stu-id="15cbc-226">Run the **Students** page to verify that the deployed database has no students.</span></span> <span data-ttu-id="15cbc-227">При выборе этой страницы может занять несколько минут, чтобы загрузить, так как Code First создает базу данных и затем запускает `Seed` метод.</span><span class="sxs-lookup"><span data-stu-id="15cbc-227">When you select this page it may take a few minutes to load because Code First creates the database and then runs the `Seed` method.</span></span> <span data-ttu-id="15cbc-228">(Ничего не произошло, когда вы были на домашней странице, так как приложение не пытается получить доступ к базе данных еще.)</span><span class="sxs-lookup"><span data-stu-id="15cbc-228">(It didn't do that when you were on the home page because the application didn't try to access the database yet.)</span></span>

<span data-ttu-id="15cbc-229">[![Students_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image22.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="15cbc-229">[![Students_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image22.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image21.png)</span></span>

<span data-ttu-id="15cbc-230">Запустите **преподавателей** страницу, чтобы убедиться, что Code First заполнена начальными значениями базу данных данными преподавателя:</span><span class="sxs-lookup"><span data-stu-id="15cbc-230">Run the **Instructors** page to verify that Code First seeded the database with instructor data:</span></span>

<span data-ttu-id="15cbc-231">[![Instructors_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image24.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="15cbc-231">[![Instructors_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image24.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image23.png)</span></span>

<span data-ttu-id="15cbc-232">Выберите **добавить учащихся** из **учащихся** меню, добавить учащихся, а затем просмотрите нового учащегося в **учащихся** страницу, чтобы убедиться, что вы можете успешно записи в базу данных :</span><span class="sxs-lookup"><span data-stu-id="15cbc-232">Select **Add Students** from the **Students** menu, add a student, and then view the new student in the **Students** page to verify that you can successfully write to the database:</span></span>

<span data-ttu-id="15cbc-233">[![Add_Students_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image26.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="15cbc-233">[![Add_Students_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image26.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image25.png)</span></span>

<span data-ttu-id="15cbc-234">[![Students_page_with_new_student_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image28.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="15cbc-234">[![Students_page_with_new_student_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image28.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image27.png)</span></span>

<span data-ttu-id="15cbc-235">Из **курсы** меню, выберите **обновления кредиты**.</span><span class="sxs-lookup"><span data-stu-id="15cbc-235">From the **Courses** menu, select **Update Credits**.</span></span> <span data-ttu-id="15cbc-236">**Кредиты обновления** страницы требуются права администратора, поэтому **вход** откроется страница.</span><span class="sxs-lookup"><span data-stu-id="15cbc-236">The **Update Credits** page requires administrator permissions, so the **Log In** page is displayed.</span></span> <span data-ttu-id="15cbc-237">Введите учетные данные учетной записи администратора, что вы создали ранее («admin» и «Pas$ w0rd»).</span><span class="sxs-lookup"><span data-stu-id="15cbc-237">Enter the administrator account credentials that you created earlier ("admin" and "Pas$w0rd").</span></span> <span data-ttu-id="15cbc-238">**Обновления кредиты** отображается страница, которая проверяет, что учетную запись администратора, созданную в предыдущем учебном курсе был правильно развернут в тестовую среду.</span><span class="sxs-lookup"><span data-stu-id="15cbc-238">The **Update Credits** page is displayed, which verifies that the administrator account that you created in the previous tutorial was correctly deployed to the test environment.</span></span>

<span data-ttu-id="15cbc-239">[![Log_In_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image30.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="15cbc-239">[![Log_In_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image30.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image29.png)</span></span>

<span data-ttu-id="15cbc-240">[![Update_Credits_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image32.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="15cbc-240">[![Update_Credits_page_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image32.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image31.png)</span></span>

<span data-ttu-id="15cbc-241">Убедитесь, что *Elmah* существует папка с файлом заполнитель только в ней.</span><span class="sxs-lookup"><span data-stu-id="15cbc-241">Verify that an *Elmah* folder exists with only the placeholder file in it.</span></span>

<span data-ttu-id="15cbc-242">[![Elmah_folder_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image34.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="15cbc-242">[![Elmah_folder_Test](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image34.png)](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image33.png)</span></span>

<a id="efcfmigrations"></a>

## <a name="reviewing-the-automatic-webconfig-changes-for-code-first-migrations"></a><span data-ttu-id="15cbc-243">Просмотрите изменения в автоматической Web.config для Code First Migrations</span><span class="sxs-lookup"><span data-stu-id="15cbc-243">Reviewing the Automatic Web.config Changes for Code First Migrations</span></span>

<span data-ttu-id="15cbc-244">Откройте *Web.config* файл в развернутом приложении в *C:\inetpub\wwwroot\ContosoUniversity* и вы увидите, где процесс развертывания автоматически настроить Code First Migrations для Обновите базу данных до последней версии.</span><span class="sxs-lookup"><span data-stu-id="15cbc-244">Open the *Web.config* file in the deployed application at *C:\inetpub\wwwroot\ContosoUniversity* and you can see where the deployment process configured Code First Migrations to automatically update the database to the latest version.</span></span>

![](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image35.png)

<span data-ttu-id="15cbc-245">Процесс развертывания, также создается новая строка подключения для Code First Migrations для использования исключительно для обновления схемы базы данных:</span><span class="sxs-lookup"><span data-stu-id="15cbc-245">The deployment process also created a new connection string for Code First Migrations to use exclusively for updating the database schema:</span></span>

![DatabasePublish_connection_string](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12/_static/image36.png)

<span data-ttu-id="15cbc-247">Эта строка дополнительные подключения можно указать одну учетную запись пользователя для обновления схемы баз данных и учетной записи другого пользователя для доступа к данным приложения.</span><span class="sxs-lookup"><span data-stu-id="15cbc-247">This additional connection string enables you to specify one user account for database schema updates, and a different user account for application data access.</span></span> <span data-ttu-id="15cbc-248">Например, можно назначить db\_роль владельца для Code First Migrations и db\_datareader и db\_datawriter роли для приложения.</span><span class="sxs-lookup"><span data-stu-id="15cbc-248">For example, you could assign the db\_owner role to Code First Migrations, and db\_datareader and db\_datawriter roles to the application.</span></span> <span data-ttu-id="15cbc-249">Это общий шаблон защиты в глубину, не позволяющая потенциально вредоносного кода в приложении изменять схему базы данных.</span><span class="sxs-lookup"><span data-stu-id="15cbc-249">This is a common defense-in-depth pattern that prevents potentially malicious code in the application from changing the database schema.</span></span> <span data-ttu-id="15cbc-250">(Например, это может произойти в успешной атаки путем внедрения кода SQL.) Этот шаблон не используется в этих учебниках.</span><span class="sxs-lookup"><span data-stu-id="15cbc-250">(For example, this might happen in a successful SQL injection attack.) This pattern is not used by these tutorials.</span></span> <span data-ttu-id="15cbc-251">Он не применяется к SQL Server Compact, и оно не применяется при миграции в SQL Server в следующем руководстве этой серии.</span><span class="sxs-lookup"><span data-stu-id="15cbc-251">It does not apply to SQL Server Compact, and it does not apply when you migrate to SQL Server in a later tutorial in this series.</span></span> <span data-ttu-id="15cbc-252">На сайте Cytanium предлагает только одну учетную запись пользователя для доступа к базе данных SQL Server, созданную на сайте Cytanium.</span><span class="sxs-lookup"><span data-stu-id="15cbc-252">The Cytanium site offers just one user account for accessing the SQL Server database that you create at Cytanium.</span></span> <span data-ttu-id="15cbc-253">Если при реализации этого шаблона в рамках сценария, его можно сделать, выполнив следующие действия:</span><span class="sxs-lookup"><span data-stu-id="15cbc-253">If you are able to implement this pattern in your scenario, you can do it by performing the following steps:</span></span>

1. <span data-ttu-id="15cbc-254">В **параметры** вкладке **веб-публикации** мастер, введите строку подключения, задающий пользователя с помощью разрешений на обновление схемы базы данных полный и очистить **использовать эту строку подключения во время выполнения** "флажок".</span><span class="sxs-lookup"><span data-stu-id="15cbc-254">In the **Settings** tab of the **Publish Web** wizard, enter the connection string that specifies a user with full database schema update permissions, and clear the **Use this connection string at runtime** check box.</span></span> <span data-ttu-id="15cbc-255">В развернутый файл Web.config, это становится `DatabasePublish` строку подключения.</span><span class="sxs-lookup"><span data-stu-id="15cbc-255">In the deployed Web.config file, this becomes the `DatabasePublish` connection string.</span></span>
2. <span data-ttu-id="15cbc-256">Создайте преобразование файла Web.config для строки подключения, приложение для использования во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="15cbc-256">Create a Web.config file transformation for the connection string that you want the application to use at run time.</span></span>

<span data-ttu-id="15cbc-257">Вы развернули приложение в службах IIS на компьютере разработчика и протестировали его там.</span><span class="sxs-lookup"><span data-stu-id="15cbc-257">You have now deployed your application to IIS on your development computer and tested it there.</span></span> <span data-ttu-id="15cbc-258">Это подтверждает, что процесс развертывания копируются содержимое приложения в нужном направлении (за исключением файлов, которые вы не хотите развернуть), а также этой веб-развертывания настроен IIS во время развертывания.</span><span class="sxs-lookup"><span data-stu-id="15cbc-258">This verifies that the deployment process copied the application's content to the right location (excluding the files that you did not want to deploy), and also that Web Deploy configured IIS correctly during deployment.</span></span> <span data-ttu-id="15cbc-259">В следующем руководстве вы выполните еще один тест, который находит задачу развертывания, которая еще не было сделано: Установка разрешений для папки на *Elmah* папки.</span><span class="sxs-lookup"><span data-stu-id="15cbc-259">In the next tutorial, you'll run one more test that finds a deployment task that has not yet been done: setting folder permissions on the *Elmah* folder.</span></span>

## <a name="more-information"></a><span data-ttu-id="15cbc-260">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="15cbc-260">More Information</span></span>

<span data-ttu-id="15cbc-261">Сведения о запуске IIS или IIS Express в Visual Studio см. следующие ресурсы:</span><span class="sxs-lookup"><span data-stu-id="15cbc-261">For information about running IIS or IIS Express in Visual Studio, see the following resources:</span></span>

- <span data-ttu-id="15cbc-262">[Обзор IIS Express](https://www.iis.net/learn/extensions/introduction-to-iis-express/iis-express-overview) на веб-узле IIS.net.</span><span class="sxs-lookup"><span data-stu-id="15cbc-262">[IIS Express Overview](https://www.iis.net/learn/extensions/introduction-to-iis-express/iis-express-overview) on the IIS.net site.</span></span>
- <span data-ttu-id="15cbc-263">[Знакомство с IIS Express](https://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx) в блоге Скотта Гатри.</span><span class="sxs-lookup"><span data-stu-id="15cbc-263">[Introducing IIS Express](https://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx) on Scott Guthrie's blog.</span></span>
- <span data-ttu-id="15cbc-264">[Практическое руководство. Укажите веб-сервера для веб-проектов в Visual Studio](https://msdn.microsoft.com/library/ms178108.aspx).</span><span class="sxs-lookup"><span data-stu-id="15cbc-264">[How to: Specify the Web Server for Web Projects in Visual Studio](https://msdn.microsoft.com/library/ms178108.aspx).</span></span>
- <span data-ttu-id="15cbc-265">[Основные различия между IIS и ASP.NET Development Server](../deploying-web-site-projects/core-differences-between-iis-and-the-asp-net-development-server-cs.md) на веб-сайте ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="15cbc-265">[Core Differences Between IIS and the ASP.NET Development Server](../deploying-web-site-projects/core-differences-between-iis-and-the-asp-net-development-server-cs.md) on the ASP.NET site.</span></span>
- <span data-ttu-id="15cbc-266">[Тестирование приложения ASP.NET MVC или приложения веб-форм в службах IIS 7 в 30 секунд](https://blogs.msdn.com/b/rickandy/archive/2011/04/22/test-you-asp-net-mvc-or-webforms-application-on-iis-7-in-30-seconds.aspx) в блоге Рика Андерсона:.</span><span class="sxs-lookup"><span data-stu-id="15cbc-266">[Test your ASP.NET MVC or Web Forms Application on IIS 7 in 30 seconds](https://blogs.msdn.com/b/rickandy/archive/2011/04/22/test-you-asp-net-mvc-or-webforms-application-on-iis-7-in-30-seconds.aspx) on Rick Anderson's blog.</span></span> <span data-ttu-id="15cbc-267">Эта запись содержит примеры почему тестирование с помощью Visual Studio Development Server (Cassini) не менее надежно, чем тестирование в IIS Express, и почему тестирование в IIS Express не менее надежно, чем тестирование в службах IIS.</span><span class="sxs-lookup"><span data-stu-id="15cbc-267">This entry provides examples of why testing with the Visual Studio Development Server (Cassini) is not as reliable as testing in IIS Express, and why testing in IIS Express is not as reliable as testing in IIS.</span></span>

<span data-ttu-id="15cbc-268">Сведения о проблемах могут возникнуть при запуске приложения в среднем уровне доверия, см. в разделе [размещения приложений ASP.NET в средний уровень доверия](http://www.4guysfromrolla.com/articles/100307-1.aspx) на 4 ребята из Rolla сайта.</span><span class="sxs-lookup"><span data-stu-id="15cbc-268">For information about what issues might arise when your application runs in medium trust, see [Hosting ASP.NET Applications in Medium Trust](http://www.4guysfromrolla.com/articles/100307-1.aspx) on the 4 Guys from Rolla site.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="15cbc-269">[Назад](deployment-to-a-hosting-provider-configuring-project-properties-4-of-12.md)
> [Вперед](deployment-to-a-hosting-provider-setting-folder-permissions-6-of-12.md)</span><span class="sxs-lookup"><span data-stu-id="15cbc-269">[Previous](deployment-to-a-hosting-provider-configuring-project-properties-4-of-12.md)
[Next](deployment-to-a-hosting-provider-setting-folder-permissions-6-of-12.md)</span></span>
