---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/common-configuration-differences-between-development-and-production-cs
title: Распространенные различия в конфигурации между разработкой и производством (C#) | Документация Майкрософт
author: rick-anderson
description: В предыдущих учебных курсах мы развернули наш веб-сайт, скопировав все соответствующие файлы из среды разработки в рабочую среду. Однако...
ms.author: riande
ms.date: 04/01/2009
ms.assetid: 721a5c37-7e21-48e0-832e-535c6351dcae
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/common-configuration-differences-between-development-and-production-cs
msc.type: authoredcontent
ms.openlocfilehash: 60379c87a8cf58b89066a6070ac659e65930b4fa
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74620417"
---
# <a name="common-configuration-differences-between-development-and-production-c"></a><span data-ttu-id="d77bb-104">Распространенные различия в конфигурации между средами разработки и производства (C#)</span><span class="sxs-lookup"><span data-stu-id="d77bb-104">Common Configuration Differences Between Development and Production (C#)</span></span>

<span data-ttu-id="d77bb-105">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d77bb-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

[<span data-ttu-id="d77bb-106">Загрузить PDF-файл</span><span class="sxs-lookup"><span data-stu-id="d77bb-106">Download PDF</span></span>](https://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial05_ConfigDifferences_cs.pdf)

> <span data-ttu-id="d77bb-107">В предыдущих учебных курсах мы развернули наш веб-сайт, скопировав все соответствующие файлы из среды разработки в рабочую среду.</span><span class="sxs-lookup"><span data-stu-id="d77bb-107">In earlier tutorials we deployed our website by copying all of the pertinent files from the development environment to the production environment.</span></span> <span data-ttu-id="d77bb-108">Однако нередко возникает разница в конфигурации между средами, что требует наличия у каждой среды уникального файла Web. config.</span><span class="sxs-lookup"><span data-stu-id="d77bb-108">However, it is not uncommon for there to be configuration differences between environments, which necessitates that each environment have a unique Web.config file.</span></span> <span data-ttu-id="d77bb-109">В этом учебнике рассматриваются типичные различия в конфигурации и рассматриваются стратегии обслуживания отдельных сведений о конфигурации.</span><span class="sxs-lookup"><span data-stu-id="d77bb-109">This tutorial examines typical configuration differences and looks at strategies for maintaining separate configuration information.</span></span>

## <a name="introduction"></a><span data-ttu-id="d77bb-110">Введение</span><span class="sxs-lookup"><span data-stu-id="d77bb-110">Introduction</span></span>

<span data-ttu-id="d77bb-111">В двух последних руководствах просматривается развертывание простого веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="d77bb-111">The last two tutorials walked through deploying a simple web application.</span></span> <span data-ttu-id="d77bb-112">В учебнике [*Развертывание сайта с помощью FTP-клиента*](deploying-your-site-using-an-ftp-client-cs.md) показано, как использовать АВТОНОМный FTP-клиент для копирования необходимых файлов из среды разработки в рабочую среду.</span><span class="sxs-lookup"><span data-stu-id="d77bb-112">The [*Deploying Your Site Using an FTP Client*](deploying-your-site-using-an-ftp-client-cs.md) tutorial showed how to use a stand-alone FTP client to copy the necessary files from the development environment up to production.</span></span> <span data-ttu-id="d77bb-113">Предыдущее руководство по [*развертыванию сайта с помощью Visual Studio*](deploying-your-site-using-visual-studio-cs.md)было рассмотрено в статье Развертывание с помощью средства копирования веб-сайта и публикации в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d77bb-113">The preceding tutorial, [*Deploying Your Site Using Visual Studio*](deploying-your-site-using-visual-studio-cs.md), looked at deployment using Visual Studio's Copy Web Site tool and Publish option.</span></span> <span data-ttu-id="d77bb-114">В обоих руководствах каждый файл в рабочей среде был копией файла в среде разработки.</span><span class="sxs-lookup"><span data-stu-id="d77bb-114">In both tutorials every file in the production environment was a copy of a file on the development environment.</span></span> <span data-ttu-id="d77bb-115">Однако файлы конфигурации в рабочей среде не очень часто отличаются от файлов конфигураций в среде разработки.</span><span class="sxs-lookup"><span data-stu-id="d77bb-115">However, it is not uncommon for configuration files in the production environment to differ from those in the development environment.</span></span> <span data-ttu-id="d77bb-116">Конфигурация веб-приложения хранится в файле `Web.config` и, как правило, содержит сведения о внешних ресурсах, таких как база данных, веб-сервер и серверы электронной почты.</span><span class="sxs-lookup"><span data-stu-id="d77bb-116">A web application's configuration is stored in the `Web.config` file and typically includes information about external resources, such as database, web, and email servers.</span></span> <span data-ttu-id="d77bb-117">В нем также написано поведение приложения в определенных ситуациях, например, выполнение действий при возникновении необработанного исключения.</span><span class="sxs-lookup"><span data-stu-id="d77bb-117">It also spells out the behavior of the application in certain situations, such as the course of action to take when an unhandled exception occurs.</span></span>

<span data-ttu-id="d77bb-118">При развертывании веб-приложения важно, чтобы правильные сведения о конфигурации настроились в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="d77bb-118">When deploying a web application it is important that the correct configuration information end up in the production environment.</span></span> <span data-ttu-id="d77bb-119">В большинстве случаев файл `Web.config` в среде разработки не может быть скопирован в рабочую среду "как есть".</span><span class="sxs-lookup"><span data-stu-id="d77bb-119">In most cases the `Web.config` file in the development environment cannot be copied to the production environment as-is.</span></span> <span data-ttu-id="d77bb-120">Вместо этого необходимо отправить в рабочую среду настроенную версию `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="d77bb-120">Instead, a customized version of `Web.config` needs to be uploaded to production.</span></span> <span data-ttu-id="d77bb-121">В этом учебнике кратко рассматриваются некоторые из наиболее распространенных различий в конфигурации. в нем также приведены некоторые методы для обслуживания различных сведений о конфигурации между средами.</span><span class="sxs-lookup"><span data-stu-id="d77bb-121">This tutorial briefly reviews some of the more common configuration differences; it also summarizes some techniques for maintaining different configuration information between the environments.</span></span>

## <a name="typical-configuration-differences-between-the-development-and-production-environments"></a><span data-ttu-id="d77bb-122">Типичные различия конфигураций между средами разработки и рабочей средой</span><span class="sxs-lookup"><span data-stu-id="d77bb-122">Typical Configuration Differences Between the Development and Production Environments</span></span>

<span data-ttu-id="d77bb-123">Файл `Web.config` содержит сведения о конфигурации для приложения ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="d77bb-123">The `Web.config` file includes an assortment of configuration information for an ASP.NET application.</span></span> <span data-ttu-id="d77bb-124">Некоторые из этих сведений о конфигурации одинаковы, независимо от среды.</span><span class="sxs-lookup"><span data-stu-id="d77bb-124">Some of this configuration information is the same regardless of the environment.</span></span> <span data-ttu-id="d77bb-125">Например, параметры проверки подлинности и правила авторизации URL-адресов, написанные в `Web.config` `<authentication>` и `<authorization>`, обычно одинаковы, независимо от среды.</span><span class="sxs-lookup"><span data-stu-id="d77bb-125">For instance, the authentication settings and URL authorization rules spelled out in the `Web.config` file's `<authentication>` and `<authorization>` elements are usually the same regardless of the environment.</span></span> <span data-ttu-id="d77bb-126">Но другие сведения о конфигурации, такие как сведения о внешних ресурсах, обычно отличаются в зависимости от среды.</span><span class="sxs-lookup"><span data-stu-id="d77bb-126">But other configuration information - such as information about external resources - typically differs depending on the environment.</span></span>

<span data-ttu-id="d77bb-127">Строки подключения к базам данных — это простой пример сведений о конфигурации, которые отличаются в зависимости от среды.</span><span class="sxs-lookup"><span data-stu-id="d77bb-127">Database connections strings are a prime example of configuration information that differs based on the environment.</span></span> <span data-ttu-id="d77bb-128">Когда веб-приложение обменивается данными с сервером базы данных, оно должно сначала установить соединение, которое достигается через [строку подключения](http://www.connectionstrings.com/Articles/Show/what-is-a-connection-string).</span><span class="sxs-lookup"><span data-stu-id="d77bb-128">When a web application communicates with a database server it must first establish a connection, and that is achieved through a [connection string](http://www.connectionstrings.com/Articles/Show/what-is-a-connection-string).</span></span> <span data-ttu-id="d77bb-129">Хотя можно жестко кодировать строку подключения к базе данных непосредственно на веб-страницах или в коде, который подключается к базе данных, лучше поместить его `Web.config`[элемент`<connectionStrings>`](https://msdn.microsoft.com/library/bf7sd233.aspx) , чтобы данные строки подключения находящегося в одном централизованном расположении.</span><span class="sxs-lookup"><span data-stu-id="d77bb-129">While it is possible to hard-code the database connection string directly in the web pages or the code that connects to the database, it is best to place it `Web.config`'s [`<connectionStrings>` element](https://msdn.microsoft.com/library/bf7sd233.aspx) so that the connection string information is in a single, centralized location.</span></span> <span data-ttu-id="d77bb-130">Часто в процессе разработки используется другая база данных, чем в рабочей среде; Следовательно, сведения о строке подключения должны быть уникальными для каждой среды.</span><span class="sxs-lookup"><span data-stu-id="d77bb-130">Oftentimes a different database is used during development than is used in production; consequently, the connection string information must be unique for each environment.</span></span>

> [!NOTE]
> <span data-ttu-id="d77bb-131">В следующих учебных курсах рассматривается развертывание приложений, управляемых данными, а в этом случае мы рассмотрим особенности хранения строк подключения к базе данных в файле конфигурации.</span><span class="sxs-lookup"><span data-stu-id="d77bb-131">Future tutorials explore deploying data-driven applications, at which point we'll dive into the specifics of how database connection strings are stored in the configuration file.</span></span>

<span data-ttu-id="d77bb-132">Предполагаемое поведение сред разработки и рабочей среды существенно различается.</span><span class="sxs-lookup"><span data-stu-id="d77bb-132">The intended behavior of the development and production environments differs substantially.</span></span> <span data-ttu-id="d77bb-133">Веб-приложение в среде разработки создается, тестируется и отлаживается небольшой группой разработчиков.</span><span class="sxs-lookup"><span data-stu-id="d77bb-133">A web application in the development environment is being created, tested, and debugged by a small group of developers.</span></span> <span data-ttu-id="d77bb-134">В рабочей среде, в которой один и тот же приложение посещается многими пользователями одновременно.</span><span class="sxs-lookup"><span data-stu-id="d77bb-134">In the production environment that same application is being visited by many different simultaneous users.</span></span> <span data-ttu-id="d77bb-135">ASP.NET включает ряд функций, помогающих разработчикам в тестировании и отладке приложения, но эти функции должны быть отключены по соображениям производительности и безопасности в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="d77bb-135">ASP.NET includes a number of features that help developers in testing and debugging an application, but these features should be disabled for performance and security reasons when in the production environment.</span></span> <span data-ttu-id="d77bb-136">Давайте рассмотрим несколько таких параметров конфигурации.</span><span class="sxs-lookup"><span data-stu-id="d77bb-136">Let's look at a few such configuration settings.</span></span>

### <a name="configuration-settings-that-impact-performance"></a><span data-ttu-id="d77bb-137">Параметры конфигурации, влияющие на производительность</span><span class="sxs-lookup"><span data-stu-id="d77bb-137">Configuration Settings That Impact Performance</span></span>

<span data-ttu-id="d77bb-138">При первом посещении страницы ASP.NET (или в первый раз после ее изменения) его декларативная разметка должна быть преобразована в класс, а этот класс должен быть скомпилирован.</span><span class="sxs-lookup"><span data-stu-id="d77bb-138">When an ASP.NET page is visited for the first time (or the first time after it has changed), its declarative markup must be converted into a class and this class must be compiled.</span></span> <span data-ttu-id="d77bb-139">Если веб-приложение использует автоматическую компиляцию, то также необходимо скомпилировать класс кода программной части страницы.</span><span class="sxs-lookup"><span data-stu-id="d77bb-139">If the web application uses automatic compilation then the page's code-behind class needs to be compiled, too.</span></span> <span data-ttu-id="d77bb-140">Ассортимент параметров компиляции можно настроить с помощью [элемента`<compilation>`](https://msdn.microsoft.com/library/s10awwz0.aspx)`Web.config` файла.</span><span class="sxs-lookup"><span data-stu-id="d77bb-140">You can configure an assortment of compilation options via the `Web.config` file's [`<compilation>` element](https://msdn.microsoft.com/library/s10awwz0.aspx).</span></span>

<span data-ttu-id="d77bb-141">Атрибут Debug является одним из наиболее важных атрибутов элемента `<compilation>`.</span><span class="sxs-lookup"><span data-stu-id="d77bb-141">The debug attribute is one of the most important attributes in the `<compilation>` element.</span></span> <span data-ttu-id="d77bb-142">Если для атрибута `debug` задано значение "true", скомпилированные сборки содержат отладочные символы, которые необходимы при отладке приложения в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d77bb-142">If the `debug` attribute is set to "true" then the compiled assemblies include debug symbols, which are needed when debugging an application in Visual Studio.</span></span> <span data-ttu-id="d77bb-143">Но символы отладки увеличивают размер сборки и накладывают дополнительные требования к памяти при выполнении кода.</span><span class="sxs-lookup"><span data-stu-id="d77bb-143">But debug symbols increase the size of the assembly and impose additional memory requirements when running the code.</span></span> <span data-ttu-id="d77bb-144">Более того, если атрибуту `debug` присвоено значение true, любое содержимое, возвращенное `WebResource.axd`, не кэшируется, то есть каждый раз, когда пользователь посещает страницу, необходимо повторно скачать статическое содержимое, возвращенное `WebResource.axd`.</span><span class="sxs-lookup"><span data-stu-id="d77bb-144">Furthermore, when the `debug` attribute is set to "true" any content returned by `WebResource.axd` is not cached, meaning that each time a user visits a page they will need to re-download the static content returned by `WebResource.axd`.</span></span>

> [!NOTE]
> <span data-ttu-id="d77bb-145">`WebResource.axd` — это встроенный обработчик HTTP, появившийся в ASP.NET 2,0, который используется серверными элементами управления для получения внедренных ресурсов, таких как файлы скриптов, изображения, CSS-файлы и другое содержимое.</span><span class="sxs-lookup"><span data-stu-id="d77bb-145">`WebResource.axd` is a built-in HTTP Handler introduced in ASP.NET 2.0 that server controls use to retrieve embedded resources, such as script files, images, CSS files, and other content.</span></span> <span data-ttu-id="d77bb-146">Дополнительные сведения о том, как работает `WebResource.axd` и как его можно использовать для доступа к внедренным ресурсам из пользовательских серверных элементов управления, см. [в разделе доступ к внедренным ресурсам через URL-адрес с помощью `WebResource.axd`](http://aspnet.4guysfromrolla.com/articles/080906-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="d77bb-146">For more information on how `WebResource.axd` works and how you can use it to access embedded resources from your custom server controls, see [Accessing Embedded Resources Through a URL Using `WebResource.axd`](http://aspnet.4guysfromrolla.com/articles/080906-1.aspx).</span></span>

<span data-ttu-id="d77bb-147">Атрибут `debug` элемента `<compilation>` обычно имеет значение true в среде разработки.</span><span class="sxs-lookup"><span data-stu-id="d77bb-147">The `<compilation>` element's `debug` attribute is usually set to "true" in the development environment.</span></span> <span data-ttu-id="d77bb-148">Фактически, для отладки веб-приложения этому атрибуту должно быть присвоено значение true. Если вы попытаетесь выполнить отладку приложения ASP.NET из Visual Studio, а атрибуту `debug` задано значение "false", Visual Studio отобразит сообщение о том, что приложение невозможно отладить, пока атрибуту `debug` не будет присвоено значение "true" и предложит внести это изменение.</span><span class="sxs-lookup"><span data-stu-id="d77bb-148">In fact, this attribute must be set to "true" in order to debug a web application; if you try to debug an ASP.NET application from Visual Studio and the `debug` attribute is set to "false", Visual Studio will display a message explaining that the application cannot be debugged until the `debug` attribute is set to "true" and will offer to make this change for you.</span></span>

<span data-ttu-id="d77bb-149">В рабочей среде значение атрибута `debug` **не** должно быть равно "true", так как это влияет на производительность.</span><span class="sxs-lookup"><span data-stu-id="d77bb-149">You should **never** have the `debug` attribute set to "true" in a production environment because of its impact on performance.</span></span> <span data-ttu-id="d77bb-150">Более подробное обсуждение этого раздела см. в записи блога [Скотта Гатри (](https://weblogs.asp.net/scottgu/), [не запуская рабочие ASP.NET приложения с включенным `debug="true"`](https://weblogs.asp.net/scottgu/442448).</span><span class="sxs-lookup"><span data-stu-id="d77bb-150">For a more thorough discussion on this topic, refer to [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog post, [Don't Run Production ASP.NET Applications With `debug="true"` Enabled](https://weblogs.asp.net/scottgu/442448).</span></span>

### <a name="custom-errors-and-tracing"></a><span data-ttu-id="d77bb-151">Пользовательские ошибки и трассировка</span><span class="sxs-lookup"><span data-stu-id="d77bb-151">Custom Errors and Tracing</span></span>

<span data-ttu-id="d77bb-152">При возникновении необработанного исключения в приложении ASP.NET оно переносится в среду выполнения, где происходит одно из трех действий:</span><span class="sxs-lookup"><span data-stu-id="d77bb-152">When an unhandled exception occurs in an ASP.NET application it bubbles up to the runtime at which point one of three things happens:</span></span>

- <span data-ttu-id="d77bb-153">Отображается сообщение об общей ошибке среды выполнения.</span><span class="sxs-lookup"><span data-stu-id="d77bb-153">A generic runtime error message is displayed.</span></span> <span data-ttu-id="d77bb-154">Эта страница информирует пользователя о том, что произошла ошибка времени выполнения, но не содержит сведений об ошибке.</span><span class="sxs-lookup"><span data-stu-id="d77bb-154">This page informs the user that there was a runtime error, but does not provide any details about the error.</span></span>
- <span data-ttu-id="d77bb-155">Отобразится сообщение с подробными сведениями об исключении, содержащее сведения о созданном исключении.</span><span class="sxs-lookup"><span data-stu-id="d77bb-155">An exception details message is displayed, which includes information on the exception that was just thrown.</span></span>
- <span data-ttu-id="d77bb-156">Отобразится настраиваемая страница ошибки, которая представляет собой ASP.NET страницу, на которой отображается любое требуемое сообщение.</span><span class="sxs-lookup"><span data-stu-id="d77bb-156">A custom error page is displayed, which is an ASP.NET page that you create that displays any message you desire.</span></span>

<span data-ttu-id="d77bb-157">Что происходит на стороне необработанного исключения, зависит от [раздела`<customErrors>`](https://msdn.microsoft.com/library/h0hfz6fc.aspx)файла `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="d77bb-157">What happens in the face of an unhandled exception depends on the `Web.config` file's [`<customErrors>` section](https://msdn.microsoft.com/library/h0hfz6fc.aspx).</span></span>

<span data-ttu-id="d77bb-158">При разработке и тестировании приложения оно позволяет просматривать сведения о любом исключении в браузере.</span><span class="sxs-lookup"><span data-stu-id="d77bb-158">When developing and testing an application it helps to see details of any exception in the browser.</span></span> <span data-ttu-id="d77bb-159">Однако отображение сведений об исключениях в приложении в рабочей среде является потенциальной угрозой безопасности.</span><span class="sxs-lookup"><span data-stu-id="d77bb-159">However, showing exception details in an application on production is a potential security risk.</span></span> <span data-ttu-id="d77bb-160">Более того, он унфлаттеринг и делает ваш веб-сайт непрофессиональным.</span><span class="sxs-lookup"><span data-stu-id="d77bb-160">Moreover, it's unflattering and makes your website look unprofessional.</span></span> <span data-ttu-id="d77bb-161">В идеале, в случае необработанного исключения в веб-приложении в среде разработки отображаются сведения об исключении, а в том же приложении в рабочем окружении отображается настраиваемая страница ошибки.</span><span class="sxs-lookup"><span data-stu-id="d77bb-161">Ideally, in the event of an unhandled exception a web application in the development environment will show the exception's details while the same application in production will show a custom error page.</span></span>

> [!NOTE]
> <span data-ttu-id="d77bb-162">Параметр раздела `<customErrors>` по умолчанию отображает сообщение сведения об исключении только в том случае, если страница посещается через localhost, и в противном случае отображается общая страница ошибки времени выполнения.</span><span class="sxs-lookup"><span data-stu-id="d77bb-162">The default `<customErrors>` section setting shows the exception details message only when the page is being visited through localhost, and shows the generic runtime error page otherwise.</span></span> <span data-ttu-id="d77bb-163">Это не идеальный вариант, но мы уверены, что поведение по умолчанию не раскрывает сведения об исключении нелокальным посетителям.</span><span class="sxs-lookup"><span data-stu-id="d77bb-163">This isn't ideal, but it's assuring to know that the default behavior doesn't reveal exception details to non-local visitors.</span></span> <span data-ttu-id="d77bb-164">В следующем учебнике рассматривается раздел `<customErrors>` более подробно и показано, как при возникновении ошибки в рабочей среде отображается настраиваемая страница ошибок.</span><span class="sxs-lookup"><span data-stu-id="d77bb-164">A future tutorial examines the `<customErrors>` section in more detail and shows how to have a custom error page shown when an error occurs in production.</span></span>

<span data-ttu-id="d77bb-165">Другой компонент ASP.NET, который полезен при разработке, — это трассировка.</span><span class="sxs-lookup"><span data-stu-id="d77bb-165">Another ASP.NET feature that is useful during development is tracing.</span></span> <span data-ttu-id="d77bb-166">Трассировка, если она включена, записывает сведения о каждом входящем запросе и предоставляет специальную веб-страницу `Trace.axd`для просмотра последних сведений о запросе.</span><span class="sxs-lookup"><span data-stu-id="d77bb-166">Tracing, if enabled, records information about each incoming request and provides a special web page, `Trace.axd`, for viewing recent request details.</span></span> <span data-ttu-id="d77bb-167">Вы можете включить и настроить трассировку с помощью [элемента`<trace>`](https://msdn.microsoft.com/library/6915t83k.aspx) в `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="d77bb-167">You can turn on and configure tracing via the [`<trace>` element](https://msdn.microsoft.com/library/6915t83k.aspx) in `Web.config`.</span></span>

<span data-ttu-id="d77bb-168">Если включить трассировку, убедитесь, что она отключена в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="d77bb-168">If you enable tracing make sure that it is disabled in production.</span></span> <span data-ttu-id="d77bb-169">Поскольку данные трассировки включают файлы cookie, данные сеанса и другие потенциально конфиденциальные сведения, важно отключить трассировку в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="d77bb-169">Because the trace information includes cookies, session data, and other potentially sensitive information, it is important to disable tracing in production.</span></span> <span data-ttu-id="d77bb-170">Хорошая новость заключается в том, что по умолчанию трассировка отключена, а файл `Trace.axd` доступен только через localhost.</span><span class="sxs-lookup"><span data-stu-id="d77bb-170">The good news is that, by default, tracing is disabled and the `Trace.axd` file is only accessible through localhost.</span></span> <span data-ttu-id="d77bb-171">Если изменить эти параметры по умолчанию в разработке, убедитесь, что они отключены в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="d77bb-171">If you change these default settings in development make sure that they are turned back off in production.</span></span>

## <a name="techniques-for-maintaining-separate-configuration-information"></a><span data-ttu-id="d77bb-172">Методы обслуживания отдельных сведений о конфигурации</span><span class="sxs-lookup"><span data-stu-id="d77bb-172">Techniques for Maintaining Separate Configuration Information</span></span>

<span data-ttu-id="d77bb-173">Наличие различных параметров конфигурации в средах разработки и рабочей среде усложняет процесс развертывания.</span><span class="sxs-lookup"><span data-stu-id="d77bb-173">Having different configuration settings in the development and production environments complicates the deployment process.</span></span> <span data-ttu-id="d77bb-174">В предыдущих двух руководствах процесс развертывания включал в себя копирование всех необходимых файлов из разработки в рабочую среду, но этот подход работает только в том случае, если информация о конфигурации одинакова в обеих средах.</span><span class="sxs-lookup"><span data-stu-id="d77bb-174">In the previous two tutorials the deployment process involved copying all of the necessary files from development to production, but that approach only works if the configuration information is the same in both environments.</span></span> <span data-ttu-id="d77bb-175">Существует множество методов развертывания приложения с различной информацией о конфигурации.</span><span class="sxs-lookup"><span data-stu-id="d77bb-175">There are a variety of techniques for deploying an application with varying configuration information.</span></span> <span data-ttu-id="d77bb-176">Давайте рассмотрим некоторые из этих вариантов для размещенных веб-приложений.</span><span class="sxs-lookup"><span data-stu-id="d77bb-176">Let's catalog some of these options for hosted web applications.</span></span>

### <a name="manually-deploying-the-production-environment-configuration-file"></a><span data-ttu-id="d77bb-177">Развертывание файла конфигурации рабочей среды вручную</span><span class="sxs-lookup"><span data-stu-id="d77bb-177">Manually Deploying the Production Environment Configuration File</span></span>

<span data-ttu-id="d77bb-178">Самый простой подход заключается в поддержке двух версий файла `Web.config`: один для среды разработки и один для рабочей среды.</span><span class="sxs-lookup"><span data-stu-id="d77bb-178">The simplest approach is to maintain two versions of the `Web.config` file: one for the development environment and one for the production environment.</span></span> <span data-ttu-id="d77bb-179">Развертывание сайта в рабочую среду влечет за собой копирование всех файлов на рабочий сервер в среде разработки, *за исключением* файла `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="d77bb-179">Deploying a site to production entails copying all of the files to the production server in the development environment *except* for the `Web.config` file.</span></span> <span data-ttu-id="d77bb-180">Вместо этого файл `Web.config`, относящийся к рабочей среде, будет скопирован в рабочую среду.</span><span class="sxs-lookup"><span data-stu-id="d77bb-180">Instead, the production environment-specific `Web.config` file would be copied to production.</span></span>

<span data-ttu-id="d77bb-181">Этот подход не очень сложен, но его легко реализовать, так как сведения о конфигурации изменяются редко.</span><span class="sxs-lookup"><span data-stu-id="d77bb-181">This approach is not very sophisticated, but it is easy to implement because configuration information changes infrequently.</span></span> <span data-ttu-id="d77bb-182">Он лучше всего подходит для приложений с небольшой командой разработчиков, размещенной на одном веб-сервере, и сведения о конфигурации изменяются редко.</span><span class="sxs-lookup"><span data-stu-id="d77bb-182">It works best for applications with a small development team that are hosted on a single web server and whose configuration information is infrequently changed.</span></span> <span data-ttu-id="d77bb-183">Это наиболее тенабле при ручном развертывании файлов приложения с помощью автономного FTP-клиента.</span><span class="sxs-lookup"><span data-stu-id="d77bb-183">It's most tenable when manually deploying the application files using a stand-alone FTP client.</span></span> <span data-ttu-id="d77bb-184">При использовании средства копирования веб-сайта или варианта публикации Visual Studio необходимо сначала отфильтровать файл `Web.config`, относящийся к развертыванию, с конкретными рабочими элементами перед развертыванием, а затем поменять местами после завершения развертывания.</span><span class="sxs-lookup"><span data-stu-id="d77bb-184">When using Visual Studio's Copy Web Site tool or Publish option you'll need to first swap out the deployment-specific `Web.config` file with the production-specific one before deploying, and then swap them back after deployment completes.</span></span>

### <a name="change-the-configuration-during-the-build-or-deployment-process"></a><span data-ttu-id="d77bb-185">Изменение конфигурации в процессе сборки или развертывания</span><span class="sxs-lookup"><span data-stu-id="d77bb-185">Change the Configuration During the Build or Deployment Process</span></span>

<span data-ttu-id="d77bb-186">До сих пор предполагается, что процесс сборки и развертывания был нерегламентированным.</span><span class="sxs-lookup"><span data-stu-id="d77bb-186">The discussions thus far have assumed an ad-hoc build and deployment process.</span></span> <span data-ttu-id="d77bb-187">Многие более крупные проекты программного обеспечения имеют более формальные процессы, использующие средства с открытым исходным кодом, «дома» или сторонними средствами.</span><span class="sxs-lookup"><span data-stu-id="d77bb-187">Many larger software projects have more formalized processes that make use of open-source, home-grown, or third-party tools.</span></span> <span data-ttu-id="d77bb-188">Для таких проектов, скорее всего, можно настроить процесс сборки или развертывания, чтобы соответствующим образом изменить сведения о конфигурации, прежде чем они будут отправлены в рабочую среду.</span><span class="sxs-lookup"><span data-stu-id="d77bb-188">For such projects you can likely customize the build or deployment process to appropriately modify the configuration information before it is pushed to production.</span></span> <span data-ttu-id="d77bb-189">При создании веб-приложения с помощью [MSBuild](http://en.wikipedia.org/wiki/MSBuild), [NAnt](http://nant.sourceforge.net/)или другого средства сборки, скорее всего, можно добавить шаг сборки, чтобы изменить `Web.config` файл, включив в него параметры, связанные с рабочими средами.</span><span class="sxs-lookup"><span data-stu-id="d77bb-189">If you build your web application using [MSBuild](http://en.wikipedia.org/wiki/MSBuild), [NAnt](http://nant.sourceforge.net/), or some other build tool, you can likely add a build step to modify the `Web.config` file to include the production-specific settings.</span></span> <span data-ttu-id="d77bb-190">Или рабочий процесс развертывания может программно подключиться к серверу системы управления версиями и получить соответствующий файл `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="d77bb-190">Or your deployment workflow could programmatically connect to the source control server and retrieve the appropriate `Web.config` file.</span></span>

<span data-ttu-id="d77bb-191">Фактический подход к получению соответствующих сведений о конфигурации в рабочей среде значительно зависит от ваших инструментов и рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="d77bb-191">The actual approach for getting the appropriate configuration information to production varies widely based on your tools and workflow.</span></span> <span data-ttu-id="d77bb-192">Поэтому мы не будем подробно рассмотрены в этом разделе.</span><span class="sxs-lookup"><span data-stu-id="d77bb-192">As such, we will not delve into this topic further.</span></span> <span data-ttu-id="d77bb-193">Если вы используете популярное средство сборки, например MSBuild или NAnt, вы можете найти статьи и руководства по развертыванию, относящиеся к этим средствам, с помощью поиска в Интернете.</span><span class="sxs-lookup"><span data-stu-id="d77bb-193">If you are using a popular build tool like MSBuild or NAnt you can find deployment articles and tutorials specific to these tools through a web search.</span></span>

### <a name="managing-configuration-differences-via-the-web-deployment-project-add-in"></a><span data-ttu-id="d77bb-194">Управление различиями в конфигурации с помощью надстройки проекта веб-развертывания</span><span class="sxs-lookup"><span data-stu-id="d77bb-194">Managing Configuration Differences via the Web Deployment Project Add-In</span></span>

<span data-ttu-id="d77bb-195">В 2006 Корпорация Майкрософт выпустила надстройку проекта веб-разработки для Visual Studio 2005.</span><span class="sxs-lookup"><span data-stu-id="d77bb-195">In 2006 Microsoft released the Web Development Project Add-In for Visual Studio 2005.</span></span> <span data-ttu-id="d77bb-196">Надстройка для Visual Studio 2008 была выпущена в 2008.</span><span class="sxs-lookup"><span data-stu-id="d77bb-196">An Add-In for Visual Studio 2008 was released in 2008.</span></span> <span data-ttu-id="d77bb-197">Эта надстройка позволяет разработчикам ASP.NET создать отдельный проект веб-развертывания вместе с проектом веб-приложения, который при построении явным образом компилирует веб-приложение и копирует файлы для развертывания в локальный выходной каталог.</span><span class="sxs-lookup"><span data-stu-id="d77bb-197">This Add-In allows for ASP.NET developers to create a separate Web Deployment Project alongside their web application project that, when built, explicitly compiles the web application and copies the files to deploy to a local output directory.</span></span> <span data-ttu-id="d77bb-198">Проект веб-приложения использует MSBuild в фоновом режиме.</span><span class="sxs-lookup"><span data-stu-id="d77bb-198">The Web Application Project uses MSBuild behind the scenes.</span></span>

<span data-ttu-id="d77bb-199">По умолчанию файл `Web.config` среды разработки копируется в выходной каталог, но можно настроить проект веб-развертывания для настройки</span><span class="sxs-lookup"><span data-stu-id="d77bb-199">By default, the development environment's `Web.config` file is copied to the output directory, but you can setup the Web Deployment Project to customize the</span></span>

<span data-ttu-id="d77bb-200">сведения о конфигурации, которые копируются в этот каталог, можно получить следующими способами.</span><span class="sxs-lookup"><span data-stu-id="d77bb-200">configuration information that gets copied to this directory in the following ways:</span></span>

- <span data-ttu-id="d77bb-201">С помощью команды замены раздела файла `Web.config`, в которой указывается раздел для замены, и XML-файл, содержащий замещающий текст.</span><span class="sxs-lookup"><span data-stu-id="d77bb-201">Via `Web.config` file section replacement, in which you specify the section to replace and an XML file that contains the replacement text.</span></span>
- <span data-ttu-id="d77bb-202">Путем указания пути к файлу внешнего источника конфигурации.</span><span class="sxs-lookup"><span data-stu-id="d77bb-202">By providing a path to an external configuration source file.</span></span> <span data-ttu-id="d77bb-203">Если выбран этот параметр, проект веб-развертывания копирует определенный файл `Web.config` в выходной каталог (а не на `Web.config` файл, используемый в среде разработки).</span><span class="sxs-lookup"><span data-stu-id="d77bb-203">With this option selected, the Web Deployment Project copies a particular `Web.config` file to the output directory (rather than the `Web.config` file used in the development environment).</span></span>
- <span data-ttu-id="d77bb-204">Путем добавления настраиваемых правил в файл MSBuild, используемый проектом веб-развертывания.</span><span class="sxs-lookup"><span data-stu-id="d77bb-204">By adding custom rules to the MSBuild file used by the Web Deployment Project.</span></span>

<span data-ttu-id="d77bb-205">Чтобы развернуть веб-приложение, выполните сборку проекта веб-развертывания, а затем скопируйте файлы из выходной папки проекта в рабочую среду.</span><span class="sxs-lookup"><span data-stu-id="d77bb-205">To deploy the web application build the Web Deployment Project and then copy the files from the project's output folder to the production environment.</span></span>

<span data-ttu-id="d77bb-206">Дополнительные сведения об использовании проекта веб-развертывания см. в [этой статье](https://msdn.microsoft.com/magazine/cc163448.aspx) , посвященной выпуску [журнала MSDN Magazine](https://msdn.microsoft.com/magazine/default.aspx)за Апрель 2007, или обратитесь к ссылкам в разделе Дополнительные материалы в конце этого руководства.</span><span class="sxs-lookup"><span data-stu-id="d77bb-206">To learn more about using the Web Deployment Project check out [this Web Deployment Projects article](https://msdn.microsoft.com/magazine/cc163448.aspx) from the April 2007 issue of [MSDN Magazine](https://msdn.microsoft.com/magazine/default.aspx), or consult the links in the Further Reading section at the end of this tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="d77bb-207">Нельзя использовать проект веб-развертывания с Visual Web Developer, поскольку проект веб-развертывания реализован как надстройка Visual Studio, а Visual Studio Express выпуски (включая Visual Web Developer) не поддерживают надстройки.</span><span class="sxs-lookup"><span data-stu-id="d77bb-207">You cannot use the Web Deployment Project with Visual Web Developer because the Web Deployment Project is implemented as a Visual Studio Add-In and the Visual Studio Express Editions (including Visual Web Developer) do not support Add-Ins.</span></span>

## <a name="summary"></a><span data-ttu-id="d77bb-208">Сводка</span><span class="sxs-lookup"><span data-stu-id="d77bb-208">Summary</span></span>

<span data-ttu-id="d77bb-209">Внешние ресурсы и поведение веб-приложения в разработке обычно отличаются от случаев, когда одно приложение находится в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="d77bb-209">The external resources and behavior of a web application in development are typically different than when the same application is in production.</span></span> <span data-ttu-id="d77bb-210">Например, строки подключения к базе данных, параметры компиляции и поведение при возникновении необработанного исключения обычно отличаются между средами.</span><span class="sxs-lookup"><span data-stu-id="d77bb-210">For instance, database connection strings, compilation options, and the behavior when an unhandled exception occurs commonly differ between environments.</span></span> <span data-ttu-id="d77bb-211">Процесс развертывания должен соответствовать этим различиям.</span><span class="sxs-lookup"><span data-stu-id="d77bb-211">The deployment process must accommodate these differences.</span></span> <span data-ttu-id="d77bb-212">Как мы обсуждали в этом руководстве, самый простой подход заключается в том, чтобы вручную скопировать альтернативный файл конфигурации в рабочую среду.</span><span class="sxs-lookup"><span data-stu-id="d77bb-212">As we discussed in this tutorial, the simplest approach is to manually copy an alternate configuration file to the production environment.</span></span> <span data-ttu-id="d77bb-213">Более элегантные решения можно использовать при использовании надстройки проекта веб-развертывания или в более формальном процессе сборки или развертывания, который может поддерживать такие настройки.</span><span class="sxs-lookup"><span data-stu-id="d77bb-213">More elegant solutions are possible when using the Web Deployment Project Add-In or with a more formalized build or deployment process that can accommodate such customizations.</span></span>

<span data-ttu-id="d77bb-214">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="d77bb-214">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="d77bb-215">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="d77bb-215">Further Reading</span></span>

<span data-ttu-id="d77bb-216">Дополнительные сведения о разделах, обсуждаемых в этом руководстве, см. в следующих ресурсах:</span><span class="sxs-lookup"><span data-stu-id="d77bb-216">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="d77bb-217">Описание строк подключения</span><span class="sxs-lookup"><span data-stu-id="d77bb-217">Connection Strings Explained</span></span>](http://www.connectionstrings.com/Articles/Show/what-is-a-connection-string)
- [<span data-ttu-id="d77bb-218">Строки подключения к базе данных @ ConnectionStrings.com</span><span class="sxs-lookup"><span data-stu-id="d77bb-218">Database Connection Strings @ ConnectionStrings.com</span></span>](http://www.connectionstrings.com/)
- [<span data-ttu-id="d77bb-219">Не запускайте рабочие ASP.NET приложения с включенным `debug="true"`</span><span class="sxs-lookup"><span data-stu-id="d77bb-219">Don't Run Production ASP.NET Applications with `debug="true"` Enabled</span></span>](https://weblogs.asp.net/scottgu/Don_1920_t-run-production-ASP.NET-Applications-with-debug_3D001D20_true_1D20_-enabled)
- [<span data-ttu-id="d77bb-220">Корректное реагирование на необработанные исключения — отображение понятных пользователю страниц ошибок</span><span class="sxs-lookup"><span data-stu-id="d77bb-220">Gracefully Responding to Unhandled Exceptions - Displaying User-Friendly Error Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/090606-1.aspx)
- [<span data-ttu-id="d77bb-221">Инструкции. Использование проекта веб-развертывания Visual Studio 2008</span><span class="sxs-lookup"><span data-stu-id="d77bb-221">How Do I: Use a Visual Studio 2008 Web Deployment Project?</span></span>](../../../videos/how-do-i/how-do-i-use-a-visual-studio-2008-web-deployment-project.md)
- [<span data-ttu-id="d77bb-222">Ключевые параметры конфигурации при развертывании базы данных</span><span class="sxs-lookup"><span data-stu-id="d77bb-222">Key Configuration Settings When Deploying a Database</span></span>](http://aspnet.4guysfromrolla.com/articles/121008-1.aspx)
- <span data-ttu-id="d77bb-223">[Развертывание проектов веб-развертывания Visual studio 2008](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en) | [загрузки проектов веб-развертывания Visual Studio 2005](https://download.microsoft.com/download/9/4/9/9496adc4-574e-4043-bb70-bc841e27f13c/WebDeploymentSetup.msi)</span><span class="sxs-lookup"><span data-stu-id="d77bb-223">[Visual Studio 2008 Web Deployment Projects Download](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en) | [Visual Studio 2005 Web Deployment Projects Download](https://download.microsoft.com/download/9/4/9/9496adc4-574e-4043-bb70-bc841e27f13c/WebDeploymentSetup.msi)</span></span>
- <span data-ttu-id="d77bb-224">[Проекты веб-развертывания vs 2008](https://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx) | [Поддержка проектов веб-развертывания VS 2008 выпущена](https://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)</span><span class="sxs-lookup"><span data-stu-id="d77bb-224">[VS 2008 Web Deployment Projects](https://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx) | [VS 2008 Web Deployment Project Support Released](https://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)</span></span>
- [<span data-ttu-id="d77bb-225">Проекты веб-развертываний</span><span class="sxs-lookup"><span data-stu-id="d77bb-225">Web Deployment Projects</span></span>](https://msdn.microsoft.com/magazine/cc163448.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="d77bb-226">[Назад](deploying-your-site-using-visual-studio-cs.md)
> [Вперед](core-differences-between-iis-and-the-asp-net-development-server-cs.md)</span><span class="sxs-lookup"><span data-stu-id="d77bb-226">[Previous](deploying-your-site-using-visual-studio-cs.md)
[Next](core-differences-between-iis-and-the-asp-net-development-server-cs.md)</span></span>
