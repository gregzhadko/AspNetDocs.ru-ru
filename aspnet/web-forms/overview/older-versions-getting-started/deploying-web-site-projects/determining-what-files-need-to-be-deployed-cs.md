---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/determining-what-files-need-to-be-deployed-cs
title: Определение файлов, которые необходимо развернуть (C#) | Документация Майкрософт
author: rick-anderson
description: Файлы, которые необходимо развернуть из среды разработки в рабочей среде, частично зависят от того, было ли приложение ASP.NET создано...
ms.author: riande
ms.date: 04/01/2009
ms.assetid: f8d78a88-cc91-40d8-bce3-3d7954f6033b
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/determining-what-files-need-to-be-deployed-cs
msc.type: authoredcontent
ms.openlocfilehash: 1dd4a1179d32f776626c08a07205dc9aabed588d
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78516582"
---
# <a name="determining-what-files-need-to-be-deployed-c"></a>Определение подлежащих развертыванию файлов (C#)

по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Скачать код](https://download.microsoft.com/download/4/5/F/45F815EC-8B0E-46D3-9FB8-2DC015CCA306/ASPNET_Hosting_Tutorial_02_CS.zip) или [скачать PDF](https://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial02_FilesToDeploy_cs.pdf)

> Файлы, которые необходимо развернуть из среды разработки в рабочей среде, частично зависят от того, было ли приложение ASP.NET построено с использованием модели веб-сайта или модели веб-приложения. Дополнительные сведения об этих двух моделях проектов и о том, как модель проекта влияет на развертывание.

## <a name="introduction"></a>Введение

Развертывание веб-приложения ASP.NET влечет за собой копирование файлов, связанных с ASP.NET, из среды разработки в рабочую среду. Файлы, связанные с ASP.NET, включают разметку веб-страницы ASP.NET и код, а также файлы поддержки на стороне клиента и сервера. Файлы поддержки на стороне клиента — это файлы, на которые ссылаются веб-страницы и которые отправляются непосредственно в изображения браузера, CSS-файлы и файлы JavaScript, например. Файлы поддержки на стороне сервера включают в себя те, которые используются для обработки запроса на стороне сервера. К ним относятся файлы конфигурации, веб-службы, файлы классов, типизированные наборы данных и файлы LINQ to SQL, а также другие.

Как правило, все файлы поддержки на стороне клиента должны копироваться из среды разработки в рабочую среду, но файлы поддержки на стороне сервера копируются в зависимости от того, компилируется ли код на стороне сервера в сборку (файл `.dll`) или если эти сборки создаются автоматически. В этом учебнике показано, какие файлы необходимо развернуть при явной компиляции кода в сборку, в отличие от того, что этот шаг компиляции выполняется автоматически.

## <a name="explicit-compilation-versus-automatic-compilation"></a>Явная компиляция и автоматическая компиляция

Веб-страницы ASP.NET делятся на декларативную разметку и исходный код. Часть декларативной разметки включает HTML, веб-элементы управления и синтаксис привязки данных. часть кода содержит обработчики событий, написанные на C# Visual Basic или в коде. Фрагменты разметки и кода обычно разделяются на разные файлы: `WebPage.aspx` содержит декларативную разметку, а `WebPage.aspx.cs` размещает код.

Рассмотрим страницу ASP.NET с именем Clock. aspx, которая содержит элемент управления Label, для свойства Text которого задана текущая дата и время загрузки страницы. Часть декларативной разметки (в `Clock.aspx`) будет содержать разметку для веб-элемента управления Label —`<asp:Label runat="server" id="TimeLabel" />`, тогда как часть кода (в `Clock.aspx.cs`) будет иметь обработчик событий `Page_Load` с помощью следующего кода:

[!code-csharp[Main](determining-what-files-need-to-be-deployed-cs/samples/sample1.cs)]

Чтобы модуль ASP.NET мог обслуживать запрос для этой страницы, необходимо сначала скомпилировать часть кода страницы (файл `WebPage.aspx.cs`). Такая компиляция может выполняться явно или автоматически.

Если компиляция происходит явно, исходный код приложения компилируется в одну или несколько сборок (`.dll` файлов), расположенных в каталоге `Bin` приложения. Если компиляция происходит автоматически, результирующая автоматически созданная сборка по умолчанию размещается в папке `Temporary ASP.NET` Files, которая находится в `%WINDOWS%\Microsoft.NET\Framework\` *&lt;версии&gt;* , хотя это расположение можно настроить с помощью [элемента`<compilation>`](https://msdn.microsoft.com/library/s10awwz0.aspx) в `Web.config`. При явной компиляции необходимо выполнить некоторые действия по компиляции кода приложения ASP.NET в сборку. Этот шаг выполняется до развертывания. При автоматической компиляции процесс компиляции выполняется на веб-сервере при первом обращении к ресурсу.

Независимо от используемой модели компиляции разметка, часть всех страниц ASP.NET (файлов `WebPage.aspx`) должна быть скопирована в рабочую среду. При явной компиляции необходимо скопировать сборки в папку `Bin`, но не нужно копировать фрагменты кода страниц ASP.NET (файлы `WebPage.aspx.cs`). При автоматической компиляции необходимо скопировать файлы части кода, чтобы код присутствовал и мог быть скомпилирован автоматически при посещении страницы. Часть разметки каждой веб-страницы ASP.NET содержит директиву `@Page` с атрибутами, которые указывают, был ли уже скомпилирован связанный с этой страницей код, или требуется ли его автоматическая компиляция. В результате Рабочая среда может работать с любой моделью компиляции без каких-либо специальных параметров конфигурации, указывающих на то, что используется явная или автоматическая компиляция.

В таблице 1 перечислены различные файлы для развертывания при использовании явной компиляции и автоматической компиляции. Обратите внимание, что независимо от используемой модели компиляции следует всегда развертывать сборки в папке `Bin`, если она существует. В папке `Bin` содержатся сборки, относящиеся к веб-приложению, включая скомпилированный исходный код при использовании явной модели компиляции. `Bin` каталог также содержит сборки из других проектов и любых сборок с открытым кодом или сторонних разработчиков, которые могут использоваться, и должны находиться на рабочем сервере. Поэтому, как правило, при развертывании скопируйте папку `Bin` в рабочую среду. (Если вы используете автоматическую модель компиляции и не используете внешние сборки, у вас не будет `Bin` каталога — это нормально!)

| **Модель компиляции** | **Развернуть файл части разметки?** | **Развернуть файл исходного кода?** | **Развертывать сборки в `Bin` Directory?** |
| --- | --- | --- | --- |
| Явная компиляция | Да | нет | Да |
| Автоматическая компиляция | Да | Да | Да (если он существует) |

**Таблица 1.** Файлы, развертываемые при развертывании, зависят от используемой модели компиляции.

## <a name="taking-a-trip-down-memory-lane"></a>Идет проход полосы памяти

Используемый подход к компиляции зависит от того, как приложение ASP.NET управляется в Visual Studio. Шедших. Начало работы в течение года 2000 существует четыре различные версии Visual Studio — Visual Studio .NET 2002, Visual Studio .NET 2003, Visual Studio 2005 и Visual Studio 2008. Управляемые приложения ASP.NET для Visual Studio .NET 2002 и 2003 с использованием *модели проекта веб-приложения*. Ниже перечислены основные возможности модели проекта веб-приложения.

- Файлы, описывающего проект, определяются в одном файле проекта. Файлы, не определенные в файле проекта, не считаются частью веб-приложения с помощью Visual Studio.
- Использует явную компиляцию. При построении проекта файлы кода в проекте компилируются в одну сборку, размещенную в папке `Bin`.

Когда корпорация Майкрософт выпустила Visual Studio 2005, она удалила поддержку модели проекта веб-приложения и заменила ее на модель проекта веб-сайта. Модель проекта веб-сайта отличает ее от модели проекта веб-приложения следующими способами.

- Вместо одного файла проекта, который содержит файлы проекта, используется файловая система. Вкратце, все файлы в папке веб-приложения (или вложенных папках) считаются частью проекта.
- При построении проекта в Visual Studio сборка не создается в каталоге `Bin`. Вместо этого создание проекта веб-сайта сообщает о любых ошибках во время компиляции.
- Поддержка автоматической компиляции. Проекты веб-сайтов обычно развертываются путем копирования разметки и исходного кода в рабочую среду, хотя код может быть предварительно скомпилирован (явная компиляция).

При выпуске пакета обновления 1 (SP1) для Visual Studio 2005 Microsoft реанимированным модель проекта веб-приложения. Однако Visual Web Developer продолжает поддерживать только модель проекта веб-сайта. Хорошая новость заключается в том, что это ограничение было отброшено с помощью Visual Web Developer 2008 с пакетом обновления 1 (SP1). Сегодня вы можете создавать ASP.NET приложения в Visual Studio (и Visual Web Developer) с помощью модели проекта веб-приложения или модели проекта веб-сайта. Обе модели имеют свои достоинства и недостатки. См. статью [Введение в проекты веб-приложений: Сравнение проектов веб-сайтов и проектов веб-приложений](https://msdn.microsoft.com/library/aa730880.aspx#wapp_topic5) для сравнения двух моделей и помогает решить, какая модель проекта лучше подходит для вашей ситуации.

## <a name="exploring-the-sample-web-application"></a>Изучение примера веб-приложения

Загружаемый файл для этого учебника содержит приложение ASP.NET с именем Book views. Веб-сайт имитирует веб-сайт увлечений, который может быть создан для совместного использования рецензий книги с Интернет-сообществом. Это веб-приложение ASP.NET очень простое и состоит из следующих ресурсов:

- `Web.config`, файл конфигурации приложения.
- Главная страница (`Site.master`).
- Семь различных страниц ASP.NET: 

    - ~`/Default.aspx`— домашнюю страницу сайта.
    - ~`/About.aspx` — страницу "о сайте".
    - ~`/Fiction/Default.aspx` — страница со списком вымышленных книг, которые были проверены. 

        - ~`/Fiction/Blaze.aspx` — обзор романского Бачмана *Блазе*.
    - ~/`Tech/Default.aspx` — страница со списком технических книг, которые были проверены. 

        - ~/`Tech/CYOW.aspx`— обзор *создания собственного веб-сайта*.
        - ~/`Tech/TYASP35.aspx` — Проверка *обучения ASP.NET 3,5 за 24 часа*.
- Три разных CSS-файла в папке Styles.
- Четыре файла изображений — на основе логотипа ASP.NET и изображений, посвященных трем проверенным бюллетеням, которые находятся в папке `Images`.
- Файл `Web.sitemap`, который определяет карту узла и используется для отображения меню на страницах `Default.aspx` в корневом каталоге, а также в папках `Fiction` и `Tech`.
- Файл класса с именем `BasePage.cs`, определяющий базовый класс `Page`. Этот класс расширяет функциональные возможности класса `Page`, автоматически устанавливая свойство `Title` в соответствии с позицией страницы на карте узла. В двух словах, в любом классе кода программной части ASP.NET, который расширяет `BasePage` (вместо `System.Web.UI.Page`), для заголовка задается значение в зависимости от его расположения в карте узла. Например, при просмотре страницы ~/`Tech/CYOW.aspx` для заголовка задается значение "Домашняя страница: технология: создать свой собственный веб-сайт".

На рис. 1 показан снимок экрана веб-сайта рецензий книги при просмотре в браузере. Здесь вы видите страницу ~/`Tech/TYASP35.aspx`, которая просматривает книгу, *изучая ASP.NET 3,5 за 24 часа*. Навигатор, охватывающий верхнюю часть страницы, и меню в левом столбце основаны на структуре схемы узла, определенной в `Web.sitemap`. Изображение в правом верхнем углу является одним из изображений в книге, расположенных в папке `Images`. Внешний вид веб-сайта определяется с помощью правил каскадной таблицы стилей, которые определены в файлах CSS в папке Styles, а на главной странице определяется разметка страницы, в `Site.master`.

[![веб-сайт рецензий на книги предлагает рецензии на ассортимент заголовков](determining-what-files-need-to-be-deployed-cs/_static/image2.png)](determining-what-files-need-to-be-deployed-cs/_static/image1.png)

**Рис. 1.** Веб-сайт обзоры книг предлагает рецензии на ассортимент заголовков ([щелкните, чтобы просмотреть изображение с полным размером](determining-what-files-need-to-be-deployed-cs/_static/image3.png)).

Это приложение не использует базу данных; Каждая проверка реализуется как отдельная веб-страница в приложении. В этом учебнике (и в следующих нескольких учебниках) рассматривается развертывание веб-приложения, не имеющего базы данных. Однако в следующем учебном курсе мы улучшаем это приложение для хранения рецензий, комментариев читателей и других сведений в базе данных, а затем рассмотрю, какие действия необходимо выполнить для правильного развертывания управляемого данными веб-приложения.

> [!NOTE]
> В этих учебниках основное внимание уделяется размещению ASP.NET приложений с помощью поставщика веб-узлов и не рассматриваются вспомогательные темы, такие как ASP. Сетевая система карт сети или базовый класс `Page`. Дополнительные сведения об этих технологиях и о других разделах, рассмотренных в этом руководстве, см. в разделе Дополнительные материалы в конце каждого руководства.

В скачивании этого учебника есть две копии веб-приложения, реализованные как различные типы проектов Visual Studio: Букревиевсвап, проект веб-приложения и Букревиевсвсп, проект веб-сайта. Оба проекта были созданы с помощью Visual Web Developer 2008 с пакетом обновления 1 (SP1) и используют ASP.NET 3,5 SP1. Для работы с этими проектами Начните с распаковки содержимого на Рабочий стол. Чтобы открыть проект веб-приложения (Букревиевсвап), перейдите в папку Букревиевсвап и дважды щелкните файл решения `BookReviewsWAP.sln`. Чтобы открыть проект веб-сайта (Букревиевсвсп), запустите Visual Studio, а затем в меню Файл выберите пункт Открыть веб-сайт, перейдите в папку `BookReviewsWSP` на рабочем столе и нажмите кнопку ОК.

В остальных двух разделах этого учебника рассматриваются файлы, которые необходимо скопировать в рабочую среду при развертывании приложения. Следующие два руководства — *[Развертывание сайта с помощью FTP](deploying-your-site-using-an-ftp-client-cs.md)* и *[Развертывание сайта с помощью Visual Studio](deploying-your-site-using-visual-studio-cs.md)* — демонстрируются различные способы копирования этих файлов в поставщик веб-узла.

## <a name="determining-the-files-to-deploy-for-the-web-application-project"></a>Определение файлов для развертывания в проекте веб-приложения

Модель проекта веб-приложения использует явную компиляцию — исходный код проекта компилируется в одну сборку каждый раз при сборке приложения. Эта компиляция включает файлы кода программной части страниц ASP.NET (~/`Default.aspx.cs`, ~/`About.aspx.cs`и т. д.), а также класс `BasePage.cs`. Полученная сборка называется Букревиевсвап. dll и находится в каталоге `Bin` приложения.

На рис. 2 показаны файлы, составляющие проект веб-приложения для рецензирования книги.

[![обозреватель решений выводит список файлов, составляющих проект веб-приложения.](determining-what-files-need-to-be-deployed-cs/_static/image5.png)](determining-what-files-need-to-be-deployed-cs/_static/image4.png)

**Рис. 2**. Обозреватель решений список файлов, составляющих проект веб-приложения

Чтобы развернуть приложение ASP.NET, разработанное с помощью модели проекта веб-приложения, начните с создания приложения таким образом, чтобы явным образом скомпилировать последний исходный код в сборку. Затем скопируйте следующие файлы в рабочую среду:

- Файлы, содержащие декларативную разметку для каждой ASP.NET страницы, например ~/`Default.aspx`, ~/`About.aspx`и т. д. Кроме того, скопируйте декларативную разметку для всех главных страниц и пользовательских элементов управления.
- Сборки (`.dll` файлы) в папке `Bin`. Вам не нужно копировать файлы базы данных программы (`.pdb`) или любые файлы XML, которые могут находиться в каталоге `Bin`.

Вам не нужно копировать файлы исходного кода страниц ASP.NET в рабочую среду, а также не нужно копировать файл `BasePage.cs` класса.

> [!NOTE]
> Как показано на рис. 2, класс `BasePage` реализован в проекте в виде файла класса, помещенного в папку с именем `HelperClasses`. При компиляции проекта код в файле `BasePage.cs` компилируется вместе с классами кода программной части ASP.NET страниц в одну сборку, `BookReviewsWAP.dll.` ASP.NET имеет специальную папку с именем `App_Code`, предназначенную для хранения файлов классов для проектов веб-сайтов. Код в папке `App_Code` автоматически компилируется, поэтому его не следует использовать с проектами веб-приложений. Вместо этого следует поместить файлы классов приложения в обычную папку с именем `HelperClasses`или `Classes`или что-то подобное. Кроме того, можно разместить файлы классов в отдельном проекте библиотеки классов.

Помимо копирования файлов разметки, связанных с ASP.NET, и сборки в папке `Bin` необходимо также скопировать файлы поддержки на стороне клиента — изображения и файлы CSS, а также другие файлы поддержки на стороне сервера, `Web.config` и `Web.sitemap`. Эти файлы поддержки на стороне клиента и сервера необходимо скопировать в рабочую среду независимо от того, используется ли явная или автоматическая компиляция.

## <a name="determining-the-files-to-deploy-for-the-web-site-project-files"></a>Определение файлов для развертывания в файлах проекта веб-сайта

Модель проекта веб-сайта поддерживает автоматическую компиляцию, а функция недоступна при использовании модели проекта веб-приложения. При явной компиляции необходимо скомпилировать исходный код проекта в сборку и скопировать эту сборку в рабочую среду. С другой стороны, при автоматической компиляции вы просто копируете исходный код в рабочую среду, который при необходимости компилируется средой выполнения по требованию.

Пункт меню "сборка" в Visual Studio имеется как в проектах веб-приложений, так и в проектах веб-сайтов. При построении проектов веб-приложений исходный код проекта компилируется в одну сборку, расположенную в каталоге `Bin`; При построении проекта веб-сайта проверяется наличие ошибок во время компиляции, но не создается ни одна сборка. Чтобы развернуть приложение ASP.NET, разработанное с помощью модели проекта веб-сайта, достаточно скопировать соответствующие файлы в рабочую среду, но я рекомендую сначала выполнить сборку проекта, чтобы убедиться в отсутствии ошибок во время компиляции.

На рис. 3 показаны файлы, составляющие проект веб-сайта рецензий книги.

 [![обозреватель решений выводит список файлов, составляющих проект веб-сайта.](determining-what-files-need-to-be-deployed-cs/_static/image7.png)](determining-what-files-need-to-be-deployed-cs/_static/image6.png) 

**Рис. 3**. Обозреватель решений список файлов, составляющих проект веб-сайта

Развертывание проекта веб-сайта включает копирование всех файлов, связанных с ASP.NET, в рабочую среду, включая страницы разметки для страниц ASP.NET, главных страниц и пользовательских элементов управления, а также их файлы кода. Также необходимо скопировать все файлы классов, например BasePage.cs. Обратите внимание, что файл `BasePage.cs` находится в папке `App_Code`, которая представляет собой специальную папку ASP.NET, используемую в проектах веб-сайтов для файлов классов. Особая папка должна быть создана в рабочей среде, так как файлы классов в папке `App_Code` среды разработки должны быть скопированы в папку `App_Code` в рабочем окружении.

Помимо копирования разметки ASP.NET и файлов исходного кода, также необходимо скопировать файлы поддержки на стороне клиента — изображения и файлы CSS, а также другие файлы поддержки на стороне сервера, `Web.config` и `Web.sitemap`.

> [!NOTE]
> В проектах веб-сайтов также можно использовать явную компиляцию. В следующем учебнике будет рассмотрена явная компиляция проекта веб-сайта.

## <a name="summary"></a>Сводка

Развертывание приложения ASP.NET влечет за собой копирование необходимых файлов из среды разработки в рабочую среду. Точный набор файлов, которые необходимо синхронизировать, зависит от того, является ли код приложения ASP.NET явным или автоматически компилируемым. Стратегия компиляции зависит от того, настроена ли Visual Studio для управления приложением ASP.NET с помощью модели проекта веб-приложения или модели проекта веб-сайта.

Модель проекта веб-приложения использует явную компиляцию и компилирует код проекта в одну сборку в папке `Bin`. При развертывании приложения разметка страниц ASP.NET и содержимое папки `Bin` должны быть помещены в рабочую среду. исходный код в приложении — файлы кода и классы кода программной части, например, не нужно копировать в рабочую среду.

Модель проекта веб-сайта по умолчанию использует автоматическую компиляцию, хотя можно явно скомпилировать проект веб-сайта, как будет показано в следующих учебных курсах. Для развертывания приложения ASP.NET, использующего автоматическую компиляцию, необходимо скопировать часть разметки *и* исходный код в рабочую среду. Код автоматически компилируется в рабочей среде, когда он запрашивается в первый раз.

Теперь, когда мы рассмотрели, какие файлы необходимо синхронизировать между средами разработки и рабочей средой, мы готовы к развертыванию приложения для рецензирования книг в поставщике веб-узла.

Поздравляем с программированием!

### <a name="further-reading"></a>Дополнительные материалы

Дополнительные сведения о разделах, обсуждаемых в этом руководстве, см. в следующих ресурсах:

- [Общие сведения о компиляции ASP.NET](https://msdn.microsoft.com/library/ms178466.aspx)
- [ASP.NET пользовательские элементы управления](https://msdn.microsoft.com/library/y6wb1a0e.aspx)
- [Изучение ASP. Навигация по веб-узлу сети](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)
- [Общие сведения о проектах веб-приложений](https://msdn.microsoft.com/library/aa730880.aspx)
- [Учебники по главной странице](../master-pages/creating-a-site-wide-layout-using-master-pages-cs.md)
- [Совместное использование кода между страницами](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/pages/code.aspx)
- [Использование пользовательского базового класса для классов кода программной части страниц ASP.NET](http://aspnet.4guysfromrolla.com/articles/041305-1.aspx)
- [Система проектов веб-сайтов Visual Studio 2005: что это такое и почему мы сделали это?](https://weblogs.asp.net/scottgu/archive/2005/08/21/423201.aspx)
- [Пошаговое руководство. Преобразование проекта веб-сайта в проект веб-приложения в Visual Studio](https://msdn.microsoft.com/library/aa983476.aspx)

> [!div class="step-by-step"]
> [Назад](asp-net-hosting-options-cs.md)
> [Вперед](deploying-your-site-using-an-ftp-client-cs.md)
