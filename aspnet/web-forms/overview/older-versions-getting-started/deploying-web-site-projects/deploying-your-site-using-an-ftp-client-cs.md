---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/deploying-your-site-using-an-ftp-client-cs
title: Развертывание сайта с помощью FTP-клиента (C#) | Документация Майкрософт
author: rick-anderson
description: Самый простой способ развертывания приложения ASP.NET — вручную скопировать необходимые файлы из среды разработки в рабочую среду. Эт...
ms.author: riande
ms.date: 04/01/2009
ms.assetid: a3599cf7-8474-4006-954a-3bc693736b66
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/deploying-your-site-using-an-ftp-client-cs
msc.type: authoredcontent
ms.openlocfilehash: a3474650939ee220b3fd712e9f5a6cf3db11db09
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74621165"
---
# <a name="deploying-your-site-using-an-ftp-client-c"></a>Развертывание сайта с помощью FTP-клиента (C#)

по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Скачать код](https://download.microsoft.com/download/4/5/F/45F815EC-8B0E-46D3-9FB8-2DC015CCA306/ASPNET_Hosting_Tutorial_03_CS.zip) или [скачать PDF](https://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial03_DeployingViaFTP_cs.pdf)

> Самый простой способ развертывания приложения ASP.NET — вручную скопировать необходимые файлы из среды разработки в рабочую среду. В этом руководстве показано, как использовать FTP-клиент для получения файлов с рабочего стола поставщика веб-узла.

## <a name="introduction"></a>Введение

В предыдущем руководстве было представлено простое веб-приложение обзора книги ASP.NET, которое состоит из нескольких ASP.NET страниц, главной страницы, пользовательского базового класса `Page`, ряда изображений и трех таблиц стилей CSS. Теперь мы готовы развернуть это приложение для поставщика веб-узла, после чего приложение будет доступно любому пользователю с подключением к Интернету.

Из наших обсуждений в учебнике [*Определение файлов для развертывания*](determining-what-files-need-to-be-deployed-cs.md) необходимо знать, какие файлы необходимо скопировать в поставщик веб-узла. (Помните, что копируемые файлы зависят от того, является ли приложение явным или автоматически компилируемым.) Но как получить файлы из среды разработки (Рабочий стол) вплоть до рабочей среды (веб-сервер, управляемый поставщиком веб-узла)? [ **F** Ile **T** рансфер **P** ротокол (FTP)](http://en.wikipedia.org/wiki/File_Transfer_Protocol) — это часто используемый протокол для копирования файлов с одного компьютера на другой по сети. Другой вариант — серверные расширения FrontPage (FPSE). В этом учебнике рассматривается использование автономного клиентского программного обеспечения FTP для развертывания необходимых файлов из среды разработки в рабочей среде.

> [!NOTE]
> Visual Studio включает средства для публикации веб-сайтов через FTP. Эти средства, а также обзор средств, использующих FPSE, рассматриваются в следующем руководстве.

Чтобы скопировать файлы с помощью FTP, требуется *FTP-клиент* в среде разработки. FTP-клиент — это приложение, предназначенное для копирования файлов с компьютера, на котором он установлен, на компьютер, на котором работает *FTP-сервер*. (Если поставщик веб-узла поддерживает передачу файлов по протоколу FTP, то в большинстве случаев на своих веб-серверах работает сервер FTP.) Доступно несколько клиентских приложений FTP. Веб-браузер может даже дважды быть клиентом FTP. Мой любимый FTP-клиент, который я буду использовать в этом руководстве, — это [FileZilla](http://filezilla-project.org/), бесплатный открытый FTP-клиент с открытым кодом, доступный для Windows, Linux и Mac. Однако любой клиент FTP будет работать, поэтому вы можете использовать любой клиент, с которым вы будете знакомы.

Если вы выполняете следующие действия, необходимо создать учетную запись с поставщиком веб-узла, прежде чем можно будет выполнить инструкции из этого руководства или последующих. Как отмечалось в предыдущем руководстве, существует GAGGLE компаний поставщика веб-узлов с широким спектром цен, функций и качества обслуживания. Для этой серии руководств я буду использовать [скидку ASP.NET](http://discountasp.net) в качестве поставщика веб-узла, но вы можете следовать любому поставщику веб-узла при условии, что они поддерживают версию ASP.NET, в которой разрабатывается ваш сайт. (Эти учебники были созданы с помощью ASP.NET 3,5.) Кроме того, поскольку мы будем копировать файлы в поставщик веб-узла с помощью протокола FTP в этом учебнике и в будущем, необходимо, чтобы поставщик веб-узла поддерживал FTP-доступ к своим серверам. Практически все поставщики веб-узлов предлагают эту функцию, но перед регистрацией следует проверить ее еще раз.

## <a name="deploying-the-book-review-web-application-project"></a>Развертывание проекта веб-приложения для проверки книги

Вспомним, что существует две версии веб-приложения для проверки книги: одно реализуется с помощью модели проекта веб-приложения (Букревиевсвап), а другое — с помощью модели проекта веб-сайта (Букревиевсвсп). Тип проекта влияет на то, компилируется ли сайт автоматически или явно, и что модель компиляции определяет, какие файлы необходимо развернуть. Следовательно, мы рассмотрим развертывание проектов Букревиевсвап и Букревиевсвсп отдельно, начиная с Букревиевсвап. Скачайте эти два ASP.NET приложения, если вы еще не сделали этого.

Запустите проект Букревиевсвап, перейдя в папку `BookReviewsWAP` и дважды щелкнув `BookReviewsWAP.sln` файл. Перед развертыванием проекта важно создать его, чтобы убедиться в том, что все изменения в исходном коде включены в скомпилированную сборку. Чтобы выполнить сборку проекта, перейдите в меню "сборка" и выберите пункт меню "построить Букревиевсвап". При этом исходный код в проекте компилируется в одну сборку, `BookReviewsWAP.dll`, которая помещается в папку `Bin`.

Теперь все готово для развертывания необходимых файлов! Запустите FTP-клиент и подключитесь к веб-серверу поставщика веб-узла. (При регистрации в компании для веб-хостинга он будет отправлять вам по электронной почте сведения о подключении к FTP-серверу. сюда входит адрес FTP-сервера, а также имя пользователя и пароль.)

Скопируйте следующие файлы с рабочего стола в корневую папку веб-сайта поставщика веб-узла. При использовании FTP на веб-сервере поставщика веб-узла вы, вероятно, насматриваете корневой каталог веб-сайта. Однако некоторые поставщики веб-узлов имеют вложенную папку с именем `www` или `wwwroot`, которая служит корневой папкой для файлов веб-сайта. Наконец, при Фтпингии файлов может потребоваться создать соответствующую структуру папок в рабочей среде — папку `Bin`, папку `Fiction`, папку `Images` и т. д.

- `~/Default.aspx`
- `~/About.aspx`
- `~/Site.master`
- `~/Web.config`
- `~/Web.sitemap`
- Полное содержимое папки `Styles`
- Полное содержимое папки `Images` (и вложенной в нее `BookCovers`)
- `~/Fiction/Default.aspx`
- `~/Fiction/Blaze.aspx`
- `~/Tech/Default.aspx`
- `~/Tech/CYOW.aspx`
- `~/Tech/TYASP35.aspx`
- `~/Bin/BookReviewsWAP.dll`

На рис. 1 показано FileZilla после копирования необходимых файлов. FileZilla отображает файлы на локальном компьютере слева, а также файлы на удаленном компьютере справа. Как показано на рис. 1, файлы исходного кода ASP.NET, например `About.aspx.cs`, находятся на локальном компьютере (среда разработки), но не были скопированы в поставщик веб-узла (Рабочая среда), так как файлы кода не нужно развертывать при явной компиляции.

> [!NOTE]
> Нет ничего негатива в наличии файлов исходного кода на рабочем сервере, так как они игнорируются. ASP.NET запрещает HTTP-запросы к файлам исходного кода по умолчанию, поэтому даже если файлы исходного кода находятся на рабочем сервере, они недоступны для посетителей веб-сайта. (Т. е. Если пользователь пытается посетить `http://www.yoursite.com/Default.aspx.cs` он получит страницу с сообщением об ошибке, в котором объясняется, что эти типы файлов `.cs` запрещены.)

[![использовать FTP-клиент для копирования необходимых файлов с рабочего стола на веб-сервер поставщика веб-узла](deploying-your-site-using-an-ftp-client-cs/_static/image2.png)](deploying-your-site-using-an-ftp-client-cs/_static/image1.png)

**Рис. 1**. Использование FTP-клиента для копирования необходимых файлов с рабочего стола на веб-сервер поставщика веб-узла ([щелкните, чтобы просмотреть изображение с полным размером](deploying-your-site-using-an-ftp-client-cs/_static/image3.png))

После развертывания сайта потребуется проверить сайт. Если вы приобрели имя домена и правильно настроили параметры DNS, вы можете посетить свой сайт, введя имя домена. Кроме того, поставщик веб-узла должен предоставить вам URL-адрес сайта, который будет выглядеть примерно как *AccountName*. *вебхостпровидер*. com или *вебхостпровидер*. com/*AccountName*. Например, URL-адрес для моей учетной записи в ASP.NET скидка: `http://httpruntime.web703.discountasp.net`.

На рис. 2 показан сайт рецензирования развернутой книги. Обратите внимание, что я просматриваю ее на странице с скидками. Серверы сети на `http://httpruntime.web703.discountasp.net`. На этот момент любой пользователь, имеющий подключение к Интернету, может просмотреть мой веб-сайт! Как и следовало ожидать, сайт выглядит и ведет себя так же, как и при тестировании в среде разработки.

> [!NOTE]
> Если при просмотре приложения появляется сообщение об ошибке, необходимо убедиться, что развернут правильный набор файлов. Затем проверьте сообщение об ошибке, чтобы узнать, не обнаруживает ли оно какие либо подсказки. После этого вы можете активировать службу поддержки компании веб-узла или разместить свой вопрос на соответствующем форуме на [форумах ASP.NET](https://forums.asp.net/).

[![сайт проверки книги теперь доступен любому пользователю с подключением к Интернету.](deploying-your-site-using-an-ftp-client-cs/_static/image5.png)](deploying-your-site-using-an-ftp-client-cs/_static/image4.png)

**Рис. 2**. веб-сайт рецензирования книг теперь доступен любому пользователю с подключением к Интернету ([щелкните, чтобы просмотреть изображение с полным размером](deploying-your-site-using-an-ftp-client-cs/_static/image6.png))

## <a name="deploying-the-book-review-web-site-project"></a>Развертывание проекта веб-сайта проверки книги

При развертывании приложения ASP.NET, использующего автоматическую компиляцию, например проект веб-сайта Букревиевсвсп, в папке `Bin` нет скомпилированной сборки. В результате файлы исходного кода веб-приложения должны быть развернуты в рабочей среде. Давайте подробно рассмотрим этот процесс.

Как и в случае проекта веб-приложения, необходимо сначала построить приложение перед его развертыванием. При сборке проекта веб-сайта не создается сборка, она проверяет наличие ошибок времени компиляции на странице. Лучше найти эти ошибки, а не посетитель вашего веб-узла.

После успешного построения проекта используйте FTP-клиент, чтобы скопировать следующие файлы в корневую папку веб-сайта поставщика веб-узла. Может потребоваться создать соответствующую структуру папок в рабочей среде.

> [!NOTE]
> Если вы уже развернули проект Букревиевсвап, но хотите попробовать развернуть проект Букревиевсвсп, сначала удалите все файлы на веб-сервере, которые были отправлены при развертывании Букревиевсвап, а затем разверните файлы для Букревиевсвсп.

- `~/Default.aspx`
- `~/Default.aspx.cs`
- `~/About.aspx`
- `~/About.aspx.cs`
- `~/Site.master`
- `~/Site.master.cs`
- `~/Web.config`
- `~/Web.sitemap`
- Полное содержимое папки `Styles`
- Полное содержимое папки `Images` (и вложенной в нее `BookCovers`)
- `~/App_Code/BasePage.cs`
- `~/Fiction/Default.aspx`
- `~/Fiction/Default.aspx.cs`
- `~/Fiction/Blaze.aspx`
- `~/Fiction/Blaze.aspx.cs`
- `~/Tech/Default.aspx`
- `~/Tech/Default.aspx.cs`
- `~/Tech/CYOW.aspx`
- `~/Tech/CYOW.aspx.cs`
- `~/Tech/TYASP35.aspx`
- `~/Tech/TYASP35.aspx.cs`

На рис. 3 показано FileZilla после копирования необходимых файлов. Как видите, файлы с исходным кодом ASP.NET, такие как `About.aspx.cs`, существуют как на локальном компьютере (в среде разработки), так и в поставщике веб-узла (в рабочей среде), так как файлы кода необходимо развертывать при использовании автоматической компиляции.

[![использовать FTP-клиент для копирования необходимых файлов с рабочего стола на веб-сервер поставщика веб-узла](deploying-your-site-using-an-ftp-client-cs/_static/image8.png)](deploying-your-site-using-an-ftp-client-cs/_static/image7.png)

**Рис. 3**. Использование FTP-клиента для копирования необходимых файлов с рабочего стола на веб-сервер поставщика веб-узла ([щелкните, чтобы просмотреть изображение с полным размером](deploying-your-site-using-an-ftp-client-cs/_static/image9.png))

На взаимодействие с пользователем не влияет модель компиляции приложения. Одни и те же страницы ASP.NET доступны, и они выглядят и ведут себя одинаково независимо от того, был ли веб-сайт создан с помощью модели проекта веб-приложения или модели проекта веб-сайта.

### <a name="updating-a-web-application-on-production"></a>Обновление веб-приложения в рабочей среде

Разработка и развертывание веб-приложений не являются одноразовыми процессами. Например, при создании веб-сайта обзора книги я создал различные страницы и написал сопутствующий код на моем персональном компьютере (в среде разработки). После достижения определенного стабильного состояния я развернул мое приложение, чтобы другие пользователи могли посетить сайт и прочесть мои рецензии. Но развертывание не помечает окончание разработки на этом сайте. Я могу добавить дополнительные обзоры книг или реализовать новые функции, например Разрешить моим посетителям оценивать книги или оставлять свои комментарии. Такие улучшения будут разрабатываться в среде разработки и, по завершении, потребуется развернуть. Поэтому разработка и развертывание являются циклическими. Вы разрабатываете приложение, а затем развертываете его. Пока сайт находится в режиме реального времени и в рабочей среде, добавляются новые функции, и ошибки исправляются со временем, что требует повторного развертывания приложения. И т. д.

Как вы можете ожидать, при повторном развертывании веб-приложения необходимо скопировать только новые и измененные файлы. Нет необходимости повторно развертывать неизмененные страницы или файлы поддержки на стороне сервера или клиента (хотя это не имеет негативных последствий).

> [!NOTE]
> При использовании явной компиляции следует помнить, что всякий раз, когда вы добавляете в проект новую страницу ASP.NET или вносите изменения, связанные с кодом, необходимо перестроить проект, который обновляет сборку в папке `Bin`. Следовательно, вам потребуется скопировать эту обновленную сборку в рабочую среду при обновлении веб-приложения в рабочей среде (вместе с другим новым и обновленным содержимым).

Также следует понимать, что любые изменения в `Web.config` или файлы в каталоге `Bin` останавливают и перезапускают пул приложений веб-сайта. Если состояние сеанса хранится в режиме `InProc` (по умолчанию), то посетители сайта потеряют состояние сеанса при каждом изменении этих ключевых файлов. Чтобы избежать этой ошибки, рассмотрите возможность хранения сеанса с использованием `StateServer` или `SQLServer` режимов. Дополнительные сведения об этом разделе см. в статье о [режимах состояния сеанса](https://msdn.microsoft.com/library/ms178586.aspx).

Наконец, помните, что повторное развертывание приложения может занять от нескольких секунд до нескольких минут в зависимости от числа и размера файлов, которые необходимо скопировать в рабочую среду. Во время посещения сайта пользователи могут столкнуться с ошибками или нечетным поведением. Вы можете «отключить» все приложение, добавив страницу с именем `App_Offline.htm` в корневой каталог приложения, объясняющую пользователям, что сайт не работает для обслуживания (или что угодно) и скоро начнет создавать резервные копии. При наличии файла `App_Offline.htm` среда выполнения ASP.NET перенаправляет все входящие запросы на эту страницу.

## <a name="summary"></a>Сводка

Развертывание веб-приложения влечет за собой копирование необходимых файлов из среды разработки в рабочую среду. Наиболее распространенным способом передачи файлов по сети является протокол FTP (FTP), а большинство поставщиков веб-узлов поддерживают доступ по FTP к их веб-серверам. В этом учебнике мы рассмотрели использование FTP-клиента для развертывания необходимых файлов на веб-сервере. После развертывания веб-сайт может быть посещен любым пользователем с подключением к Интернету.

Поздравляем с программированием!

### <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения о разделах, обсуждаемых в этом руководстве, см. в следующих ресурсах:

- [Приложение\_автономным. htm и обходит функцию "удобные ошибки IE"](https://weblogs.asp.net/scottgu/App_5F00_Offline.htm-and-working-around-the-_2200_IE-Friendly-Errors_2200_-feature)
- [Режимы состояния сеанса](https://msdn.microsoft.com/library/ms178586.aspx)

> [!div class="step-by-step"]
> [Назад](determining-what-files-need-to-be-deployed-cs.md)
> [Вперед](deploying-your-site-using-visual-studio-cs.md)
