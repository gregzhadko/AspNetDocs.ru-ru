---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/deploying-your-site-using-visual-studio-vb
title: Развертывание сайта с помощью Visual Studio (Visual Basic) | Документация Майкрософт
author: rick-anderson
description: Visual Studio включает средства для развертывания веб-сайта. Дополнительные сведения об этих средствах в этом руководстве.
ms.author: riande
ms.date: 04/01/2009
ms.assetid: 977105f3-7987-4e50-8be7-afb53b4ca28a
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/deploying-your-site-using-visual-studio-vb
msc.type: authoredcontent
ms.openlocfilehash: 0a1dcb9ebd658ebd0d60bf422b4bd6aa20f53c59
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65116688"
---
# <a name="deploying-your-site-using-visual-studio-vb"></a>Развертывание сайта с помощью Visual Studio (VB)

по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Скачать код](http://download.microsoft.com/download/4/5/F/45F815EC-8B0E-46D3-9FB8-2DC015CCA306/ASPNET_Hosting_Tutorial_04_VB.zip) или [скачать PDF](http://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial04_DeployingViaVS_vb.pdf)

> Visual Studio включает средства для развертывания веб-сайта. Дополнительные сведения об этих средствах в этом руководстве.

## <a name="introduction"></a>Вступление

Предыдущем учебном курсе рассмотрели способы развертывания простого веб-приложения ASP.NET к веб-узла. В частности учебник, показал, как использовать FTP-клиента как FileZilla для передачи необходимых файлов из среды разработки в рабочую среду. Visual Studio также предоставляет встроенные средства, помогающие выполнить развертывание поставщике веб-размещения. В этом руководстве рассматриваются два таких средства: средство копирования веб-узла, где можно будет переместить файлы в и из удаленного веб-сервера с помощью FTP или серверных расширений FrontPage; и средство публикации, которое копирует весь веб-сайт в указанном расположении.

> [!NOTE]
> Другие средства, связанных с развертыванием, предлагаемые Visual Studio включают [веб-проектов установки](https://msdn.microsoft.com/library/wx3b589t.aspx) и [Web Deployment Projects](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en) надстройки. Проекты веб-установки пакета, содержимое веб сайта и сведения о конфигурации в единый файл MSI. Этот параметр наиболее полезен в тех случаях, для веб-сайтов, которые развертываются в локальной сети или для компаний, торгующих предварительно упакованные веб-приложение пользователям установить на свои собственные веб-серверах. Развертывание веб-надстройка проектов — Visual Studio надстройки, упрощает указание различия настроек сборки для разработки и рабочих сред. Настройка веб-проектов не рассматриваются в этой серии руководств; Веб-проектов развертывания приведены в [ *распространенные конфигурации различия между разработки и эксплуатации* ](common-configuration-differences-between-development-and-production-vb.md) руководства.

## <a name="deploying-your-site-using-the-copy-web-site-tool"></a>Развертывание сайта с помощью средства копирования веб-сайта

Средство копирования веб-сайта Visual Studio аналогичны функциям автономный клиент FTP. По сути средство копирования веб-узла позволяет соединиться с удаленного веб-сайта через FTP или серверные расширения FrontPage. Как и интерфейс пользователя FileZilla, пользовательском интерфейсе копирования веб-сайта состоит из двух панелей: на левой панели перечисляются локальные файлы, а в правой области перечисляются эти файлы на конечном сервере.

> [!NOTE]
> Средство копирования веб-сайт доступен только для проектов веб-сайтов. Visual Studio предлагают это средство, при работе с проектом веб-приложения.

Давайте рассмотрим, с помощью средства копирования веб-сайт для публикации приложения рецензия на книгу в рабочей среде. Так как средство копирования веб-узла работает только с проектами, которые используют модель проекта веб-сайта можно только проверить BookReviewsWSP проекта с помощью этого средства. Откройте этот проект.

Запустите проект средства копирования веб-сайта, щелкнув значок копирования веб-сайта в обозревателе решений (этот значок выделен на рис. 1); Кроме того можно выбрать параметр копирования веб-сайта в меню веб-сайта. Любой из этих подходов запускает пользовательский интерфейс копирования веб-сайта, показанный на рис. 1; только левой области на рис. 1 заполняется, так как у нас есть еще для подключения к удаленному серверу.

[![Средство копирования веб-узла пользовательского интерфейса — разделить на две панели](deploying-your-site-using-visual-studio-vb/_static/image2.png)](deploying-your-site-using-visual-studio-vb/_static/image1.png)

**Рис. 1**: Средство копирования веб-узла пользовательского интерфейса — разделить на две панели ([Просмотр полноразмерного изображения](deploying-your-site-using-visual-studio-vb/_static/image3.png))

Чтобы развернуть узел, нам нужно сначала подключиться к веб-узла. Нажмите кнопку «Подключить» в верхней части пользовательского интерфейса копирования веб-сайта. Откроется диалоговое окно Открыть веб-сайт, показанное на рис. 2.

Можно подключиться к целевой веб-сайт, выбрав один из четырех вариантов слева:

- **Файловая система** -выберите этот параметр, чтобы развернуть сайт в папку или сетевую папку, доступную с вашего компьютера.
- **Локальный сервер IIS** -используйте этот параметр для развертывания узла веб-сервер IIS, установленных на компьютере.
- **FTP-сайта** -соединиться с удаленного веб-сайта с помощью протокола FTP.
- **Удаленный узел** -подключения к удаленному веб-сайту с помощью серверных расширений FrontPage.

Большинство поставщиков веб-узла поддерживает FTP, но меньше предлагают поддержку в серверных расширений FrontPage. По этой причине вы выбрали вариант FTP-сайта и затем вводить сведения о подключении, как показано на рис. 2.

[![Укажите целевой веб-сайт](deploying-your-site-using-visual-studio-vb/_static/image5.png)](deploying-your-site-using-visual-studio-vb/_static/image4.png)

**Рис. 2**: Укажите целевой веб-сайт ([Просмотр полноразмерного изображения](deploying-your-site-using-visual-studio-vb/_static/image6.png))

После подключения, средство копирования веб-узла загружает файлы на удаленном сайте в правой области и состояние каждого файла: Добавление, удаление, измененные или без изменений. Удаленный сайт или наоборот, можно скопировать файл с локального сайта.

Давайте добавим новый странице BookReviewsWSP проект и затем развернуть его, чтобы мы могли видеть средство копирования веб-узла в действии. Создать новую страницу ASP.NET в Visual Studio в корневом каталоге с именем `Privacy.aspx`. На странице испольузющими эту главную станицу `Site.master` и добавьте политику конфиденциальности веб сайта на эту страницу. Рис. 3 показана система Visual Studio после создания этой странице.

[![Добавление новой страницы с именем &lt;кода&gt;Privacy.aspx&lt;/code&gt; корневую папку веб сайта](deploying-your-site-using-visual-studio-vb/_static/image8.png)](deploying-your-site-using-visual-studio-vb/_static/image7.png)

**Рис. 3**: Добавление новой страницы с именем `Privacy.aspx` корневую папку веб сайта ([Просмотр полноразмерного изображения](deploying-your-site-using-visual-studio-vb/_static/image9.png))

Далее возвращается к пользовательскому интерфейсу копирования веб-сайта. Как показано на рис. 4, в левой области теперь включает новые файлы - `Policy.aspx` и `Policy.aspx.vb`. Более того эти файлы будут отмечены значком стрелки и состояние из новый, указывающее, что они существуют на локальном сайте, но не на удаленном сайте.

[![Средство копирования веб-узла включает в себя New &lt;кода&gt;Privacy.aspx&lt;/code&gt; страницы в ее левой области](deploying-your-site-using-visual-studio-vb/_static/image11.png)](deploying-your-site-using-visual-studio-vb/_static/image10.png)

**Рис. 4**: Средство копирования веб-узла включает в себя New `Privacy.aspx` страницы в ее левой области ([Просмотр полноразмерного изображения](deploying-your-site-using-visual-studio-vb/_static/image12.png))

Чтобы развертывание новых файлов, выделите их и затем щелкните значок со стрелкой для передачи их на удаленный сайт. После завершения передачи `Policy.aspx` и `Policy.aspx.vb` файлы существуют на локальных и удаленных узлах состояние Unchanged.

А также список новых файлов, средство копирования веб-узла выделяет все файлы, которые отличаются от локальных и удаленных узлах. Чтобы увидеть это в действии, вернитесь к `Privacy.aspx` странице и добавить несколько слов в политику конфиденциальности. Сохраните страницу и затем вернуться в средство копирования веб-сайта. Как показано на рис. 5, `Privacy.aspx` страницы в области слева находится в состоянии Changed, указывающее, что он синхронизирован с удаленного узла.

[![Средство копирования веб-узла означает, что &lt;кода&gt;Privacy.aspx&lt;/code&gt; страницы был изменен](deploying-your-site-using-visual-studio-vb/_static/image14.png)](deploying-your-site-using-visual-studio-vb/_static/image13.png)

**Рис. 5**: Средство копирования веб-узла означает, что `Privacy.aspx` страницы был изменен ([Просмотр полноразмерного изображения](deploying-your-site-using-visual-studio-vb/_static/image15.png))

Средство копирования веб-узла также указывается, если файл был удален с момента последней операции копирования. Удалить `Privacy.aspx` из локального проекта и обновить средство копирования веб-узла. `Privacy.aspx` И `Privacy.aspx.vb` файлы остаются в списке в левой области, но имеют состояние Deleted, указывающее, что они были удалены с момента последней операции копирования.

## <a name="publishing-a-web-application"></a>Публикация веб-приложения

Другой способ развертывания веб-приложения из среды Visual Studio — использовать параметр "Опубликовать", который можно получить с помощью меню "сборка". Параметр публикации явно компилирует приложение и затем копирует все необходимые файлы вплоть до указанного удаленного узла. Как скоро можно будет увидеть, параметр публикации — более грубый, чем средство копирования веб-узла. В то время как средство копирования веб-узла позволяет просматривать файлы на локальных и удаленных узлах и позволяет передать или скачать отдельные файлы, при необходимости, параметр публикации развертывает всего веб-приложения.

В дополнение к копированию все необходимые файлы для указанного удаленного узла, опубликовать явным образом компилирует приложение. Учитывая, что проекты веб-приложений должны быть явно скомпилирована он должен иметь неудивительно, что параметр публикации доступен для проектов веб-приложений. Что может быть немного странно, что элемент «опубликовать» также доступны для проектов веб-сайтов. Как отмечалось в [ *определить, какие файлы должны быть развернуты* ](determining-what-files-need-to-be-deployed-vb.md) руководства, проекты веб-сайта можно явно скомпилирована в процессе, называется *предварительная компиляция*. Этот учебник посвящен использованию параметра публикации проектов веб-приложений; следующем учебном курсе рассматривается предварительная компиляция, после чего мы вернемся к взглянем на использование параметра публикации с проектами веб-сайтов.

> [!NOTE]
> Во время публикации доступен в Visual Studio для проектов веб-сайтов и проектов веб-приложений, Visual Web Developer только предоставляет возможность публикации для проектов веб-приложений.

Давайте взглянем на развертывание приложений рецензий на книги, с помощью параметра публикации. Сначала откройте BookReviewsWAP (проекта веб-приложения) в Visual Studio. В меню «опубликовать» выберите BookReviewsWAP сборки проекта. Откроется диалоговое окно, которое запрашивает в целевое расположение, среди других параметров настройки (см. рис. 6). Во многом как с помощью средства копирования веб-сайта можно ввести расположение локальной папки, локальный веб-сайт в IIS, удаленного веб-сайта, поддерживающего серверных расширений FrontPage, или адрес сервера FTP. Можно ли заменить файлы на удаленном веб-сервере развернутые файлы или удалить все содержимое на удаленном сайте перед публикацией. Можно также указать, следует ли копировать:

- Только файлы в проекте, необходимые для запуска приложения, который пропускает ненужные исходный код и файлы, связанные с проектом.
- Все файлы проекта, включая файлы исходного кода и файлы проекта Visual Studio, такие как файл решения.
- Все файлы в папке проекта источника, который копирует все файлы из исходной папки проекта независимо от того, является ли они включаются в проект.

Имеется также возможность отправки содержимого `App_Data` папки.

[![Укажите целевой веб-сайт](deploying-your-site-using-visual-studio-vb/_static/image17.png)](deploying-your-site-using-visual-studio-vb/_static/image16.png)

**Рис. 6**: Укажите целевой веб-сайт ([Просмотр полноразмерного изображения](deploying-your-site-using-visual-studio-vb/_static/image18.png))

Для приложения рецензия на книгу удаленный сайт содержит файлы, развернутых при копировании проекта BookReviewsWSP с помощью средства копирования веб-сайта. Таким образом давайте можете опубликовать удалить все ее содержимое. Кроме того Давайте просто скопировать необходимые файлы, а не засорять в рабочей среде с ненужные исходного кода и файлов проекта. После указания этих параметров, нажмите кнопку "Опубликовать". На следующих нескольких секунд Visual Studio развернет необходимые файлы на конечный сайт, отображая ход его выполнения в окне вывода.

Рис. 7 показаны файлы на FTP-сайта, после завершения операции публикации. Обратите внимание на то, что только разметку страницы и файлы поддержки необходимые sever и стороне клиента были переданы.

[![Только необходимые файлы были опубликованы в рабочей среде](deploying-your-site-using-visual-studio-vb/_static/image20.png)](deploying-your-site-using-visual-studio-vb/_static/image19.png)

**Рис. 7**: Только необходимые файлы были опубликованы в рабочей среде ([Просмотр полноразмерного изображения](deploying-your-site-using-visual-studio-vb/_static/image21.png))

Параметр публикации — менее высококачественную средство, чем средство копирования веб-узла. Средство копирования веб-узла позволяет проверять файлы на локальных и удаленных узлах и см. в разделе, как они отличаются, элемент «опубликовать» предоставляет интерфейс не. Кроме того средство копирования веб-узла позволяет вносить одноразовые, отправка или удаление отдельных файлов. Параметр публикации не поддерживает такой точного управления; Вместо этого он публикует *всей* приложения. Такое поведение имеет свои преимущества и недостатки. Преимущество такого подхода вы знаете, при использовании параметра публикации, вы не забыли для отправки важному файлу. Рассмотрим, что происходит при внесении малого изменения для очень больших веб-сайт - с возможностью публикации не удается обновить эту страницу или два, которые были изменены, но вместо этого необходимо дождаться завершения Visual Studio развертывает всего сайта.

Он не был определенные файлы, содержимое которых отличается от рабочей среды разработки. Ключевой пример – файл конфигурации приложения, `Web.config`. Так как параметр публикации вслепую копирует файлы веб-приложения оно перезаписывает файлы пользовательскую конфигурацию с рабочей среде с версией в среде разработки. Последующие руководства рассматриваются в этом разделе и дает советы по развертыванию веб-приложения, если существует подобные различия.

## <a name="summary"></a>Сводка

Развертывание веб-сайт включает копирование необходимых файлов из среды разработки в рабочую среду. Предыдущем учебном курсе было показано, как передавать файлы с помощью FTP-клиента как FileZilla. Этот учебник проверить два средства развертывания в Visual Studio: средство копирования веб-узла и элемент «опубликовать». Средство копирования веб-узла аналогична FTP-клиент, у нее есть состоящего из двух интерфейса, открыв список файлов на локальном компьютере и указанным удаленном компьютере, который позволяет легко отправлять или загружать файлы между двумя компьютерами. Параметр публикации — это более, тупыми средство, которое явно компилирует проект, а затем развертывает все приложение в указанное место назначения.

Счастливого вам программирования!

### <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения по темам, обсуждавшимся в этом руководстве см. в следующих ресурсах:

- [Копирование веб-сайта с помощью средства копирования веб-сайта](https://msdn.microsoft.com/library/1cc82atw.aspx)
- [Инструкции: Развертывание веб-сайта, с помощью средства копирования веб-сайт](../../../videos/how-do-i/how-do-i-deploy-a-web-site-using-the-copy-web-site-tool.md) (видео)
- [Практическое руководство. Публикация проектов веб-приложений](https://msdn.microsoft.com/library/aa983453.aspx)
- [Практическое руководство. Публикация веб-сайтов](https://msdn.microsoft.com/library/20yh9f1b.aspx)
- [Проекты установки и развертывания в Visual Studio](https://msdn.microsoft.com/library/wx3b589t.aspx)

> [!div class="step-by-step"]
> [Назад](deploying-your-site-using-an-ftp-client-vb.md)
> [Вперед](common-configuration-differences-between-development-and-production-vb.md)
