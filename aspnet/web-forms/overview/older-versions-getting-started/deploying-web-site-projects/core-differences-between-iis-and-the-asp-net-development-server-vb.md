---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/core-differences-between-iis-and-the-asp-net-development-server-vb
title: Основные различия между IIS и ASP.NET Development Server (VB) | Документация Майкрософт
author: rick-anderson
description: При локальном тестировании приложения ASP.NET, вероятно, вы используете веб-сервер разработки ASP.NET. Тем не менее, Рабочий веб-сайт, скорее всего, Pow...
ms.author: riande
ms.date: 04/01/2009
ms.assetid: 090e9205-52f3-4d72-ae31-44775b8b8421
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/core-differences-between-iis-and-the-asp-net-development-server-vb
msc.type: authoredcontent
ms.openlocfilehash: 880bb403e671446a77d7eebccf578a1dc714d1f9
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78438978"
---
# <a name="core-differences-between-iis-and-the-aspnet-development-server-vb"></a><span data-ttu-id="6ac9e-104">Основные различия между IIS и ASP.NET Development Server (VB)</span><span class="sxs-lookup"><span data-stu-id="6ac9e-104">Core Differences Between IIS and the ASP.NET Development Server (VB)</span></span>

<span data-ttu-id="6ac9e-105">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="6ac9e-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="6ac9e-106">[Скачать код](https://download.microsoft.com/download/4/5/F/45F815EC-8B0E-46D3-9FB8-2DC015CCA306/ASPNET_Hosting_Tutorial_06_VB.zip) или [скачать PDF](https://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial06_WebServerDiff_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="6ac9e-106">[Download Code](https://download.microsoft.com/download/4/5/F/45F815EC-8B0E-46D3-9FB8-2DC015CCA306/ASPNET_Hosting_Tutorial_06_VB.zip) or [Download PDF](https://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial06_WebServerDiff_vb.pdf)</span></span>

> <span data-ttu-id="6ac9e-107">При локальном тестировании приложения ASP.NET, вероятно, вы используете веб-сервер разработки ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-107">When testing an ASP.NET application locally, chances are you are using the ASP.NET Development Web Server.</span></span> <span data-ttu-id="6ac9e-108">Однако рабочий веб-сайт, скорее всего, будет включен в IIS.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-108">However, the production website is most likely powered IIS.</span></span> <span data-ttu-id="6ac9e-109">Существуют некоторые различия между обработкой запросов этими веб-серверами, и эти различия могут иметь важные последствия.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-109">There are some differences between how these web servers handle requests, and these differences can have important consequences.</span></span> <span data-ttu-id="6ac9e-110">В этом руководстве рассматриваются некоторые из более различий в немецком языке.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-110">This tutorial explores some of the more germane differences.</span></span>

## <a name="introduction"></a><span data-ttu-id="6ac9e-111">Введение</span><span class="sxs-lookup"><span data-stu-id="6ac9e-111">Introduction</span></span>

<span data-ttu-id="6ac9e-112">Каждый раз, когда пользователь посещает приложение ASP.NET, его браузер отправляет запрос на веб-сайт.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-112">Whenever a user visits an ASP.NET application his browser sends a request to the website.</span></span> <span data-ttu-id="6ac9e-113">Этот запрос выбирается программным обеспечением веб-сервера, которое координирует с исполняющей средой ASP.NET для создания и возврата содержимого для запрошенного ресурса.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-113">That request is picked up by the web server software, which coordinates with the ASP.NET runtime to generate and return the content for the requested resource.</span></span> <span data-ttu-id="6ac9e-114">[Ернет **i** нформатион **S** ервицес (IIS) **—** ](http://en.wikipedia.org/wiki/Internet_Information_Services) это набор служб, которые предоставляют общие Интернет-функции для серверов Windows.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-114">The[**I** nternet **I** nformation **S** ervices (IIS)](http://en.wikipedia.org/wiki/Internet_Information_Services) are a suite of services that provide common Internet-based functionality for Windows servers.</span></span> <span data-ttu-id="6ac9e-115">IIS — это наиболее часто используемый веб-сервер для приложений ASP.NET в рабочих средах. скорее всего, это программное обеспечение веб-сервера, используемое поставщиком веб-узла для обслуживания приложения ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-115">IIS is the most commonly used web server for ASP.NET applications in production environments; it's most likely the web server software being used by your web host provider to serve your ASP.NET application.</span></span> <span data-ttu-id="6ac9e-116">Службы IIS также можно использовать в качестве программного обеспечения веб-сервера в среде разработки, хотя это влечет за собой установку IIS и их правильной настройки.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-116">IIS can also be used as the web server software in the development environment, although this entails installing IIS and properly configuring it.</span></span>

<span data-ttu-id="6ac9e-117">ASP.NET Development Server является альтернативным вариантом веб-сервера для среды разработки; Она поставляется вместе с и интегрирована в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-117">The ASP.NET Development Server is an alternative web server option for the development environment; it ships with and is integrated into Visual Studio.</span></span> <span data-ttu-id="6ac9e-118">Если веб-приложение не настроено для использования служб IIS, то ASP.NET Development Server автоматически запускается и используется в качестве веб-сервера при первом посещении веб-страницы в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-118">Unless the web application has been configured to use IIS, the ASP.NET Development Server is automatically started and used as the web server the first time you visit a web page from within Visual Studio.</span></span> <span data-ttu-id="6ac9e-119">Демонстрационные веб-приложения, которые мы создали в учебнике [*Определение файлов для развертывания*](determining-what-files-need-to-be-deployed-vb.md) , были как веб-приложения на основе файловой системы, которые не были настроены для использования IIS.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-119">The demo web applications we created back in the [*Determining What Files Need to Be Deployed*](determining-what-files-need-to-be-deployed-vb.md) tutorial were both file system-based web applications that were not configured to use IIS.</span></span> <span data-ttu-id="6ac9e-120">Поэтому при посещении любого из этих веб-сайтов в Visual Studio используется ASP.NET Development Server.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-120">Therefore, when visiting either of these websites from within Visual Studio the ASP.NET Development Server is used.</span></span>

<span data-ttu-id="6ac9e-121">В идеальном мире среда разработки и рабочей среды будут идентичны.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-121">In a perfect world the development and production environments would be identical.</span></span> <span data-ttu-id="6ac9e-122">Однако, как мы обсуждали в предыдущем учебном курсе, в средах не очень часто используются разные параметры конфигурации.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-122">However, as we discussed in the preceding tutorial it is not uncommon for the environments to have differing configuration settings.</span></span> <span data-ttu-id="6ac9e-123">Использование различных программного обеспечения веб-сервера в средах добавляет еще одну переменную, которую следует учитывать при развертывании приложения.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-123">Using different web server software in the environments adds another variable that must be taken into consideration when deploying an application.</span></span> <span data-ttu-id="6ac9e-124">В этом учебнике рассматриваются основные различия между IIS и ASP.NET Development Server.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-124">This tutorial covers the key differences between IIS and the ASP.NET Development Server.</span></span> <span data-ttu-id="6ac9e-125">Из-за этих различий существуют сценарии, в которых код, который работает безупречно в среде разработки, создает исключение или ведет себя иначе при выполнении в производстве.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-125">Because of these differences there are scenarios where code that runs flawlessly in the development environment throws an exception or behaves differently when executed in production.</span></span>

## <a name="security-context-differences"></a><span data-ttu-id="6ac9e-126">Различия контекста безопасности</span><span class="sxs-lookup"><span data-stu-id="6ac9e-126">Security Context Differences</span></span>

<span data-ttu-id="6ac9e-127">Каждый раз, когда программное обеспечение веб-сервера обрабатывает входящий запрос, он связывает этот запрос с определенным контекстом безопасности.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-127">Whenever the web server software handles an incoming request it associates that request with a particular security context.</span></span> <span data-ttu-id="6ac9e-128">Эти сведения о контексте безопасности используются операционной системой для определения действий, допустимых для запроса.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-128">This security context information is used by the operating system to determine what actions are permissible by the request.</span></span> <span data-ttu-id="6ac9e-129">Например, страница ASP.NET может содержать код, записывающий некоторое сообщение в файл на диске.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-129">For example, an ASP.NET page might include code that logs some message to a file on disk.</span></span> <span data-ttu-id="6ac9e-130">Чтобы эта страница ASP.NET была выполнена без ошибок, контекст безопасности должен иметь соответствующие разрешения на уровне файловой системы, а именно разрешения на запись в этот файл.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-130">In order for this ASP.NET page to execute without error, the security context must have the appropriate file system-level permissions, namely write permissions on that file.</span></span>

<span data-ttu-id="6ac9e-131">ASP.NET Development Server связывает входящие запросы с контекстом безопасности вошедшего в систему пользователя.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-131">The ASP.NET Development Server associates incoming requests with the security context of the currently logged on user.</span></span> <span data-ttu-id="6ac9e-132">Если вы выполнили вход на Рабочий стол в качестве администратора, то страницы ASP.NET, обслуживаемые ASP.NET Development Server, будут иметь те же права доступа, что и администратор.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-132">If you are logged on to your desktop as an administrator, then the ASP.NET pages served by the ASP.NET Development Server will have the same access rights as an administrator.</span></span> <span data-ttu-id="6ac9e-133">Однако запросы ASP.NET, обрабатываемые службами IIS, связаны с определенной учетной записью компьютера.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-133">However, ASP.NET requests handled by IIS are associated with a specific machine account.</span></span> <span data-ttu-id="6ac9e-134">По умолчанию учетная запись компьютера сетевой службы используется службами IIS версии 6 и 7, хотя поставщик веб-узла может настроить уникальную учетную запись для каждого клиента.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-134">By default, the Network Service machine account is used by IIS versions 6 and 7, although your web host provider may have configured a unique account for each customer.</span></span> <span data-ttu-id="6ac9e-135">Более того, поставщик веб-узла, вероятно, предоставил ограниченные разрешения на эту учетную запись компьютера.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-135">What's more, your web host provider has likely given limited permissions to this machine account.</span></span> <span data-ttu-id="6ac9e-136">В итоге у вас могут быть веб-страницы, которые выполняются без ошибок в среде разработки, но при размещении в рабочей среде создаются исключения, связанные с авторизацией.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-136">The net result is that you may have web pages that execute without error in the development environment, but generate authorization-related exceptions when hosted in the production environment.</span></span>

<span data-ttu-id="6ac9e-137">Чтобы отобразить этот тип ошибки в действии, я создал страницу на веб-сайте обзоров книг, создающий файл на диске, в котором хранится самая последняя Дата и время, когда кто-то просматривает *ASP.NET 3,5 за 24 часа* .</span><span class="sxs-lookup"><span data-stu-id="6ac9e-137">To show this type of error in action I've created a page in the Book Reviews website that creates a file on disk that stores the most recent date and time someone viewed the *Teach Yourself ASP.NET 3.5 in 24 Hours* review.</span></span> <span data-ttu-id="6ac9e-138">Чтобы выполнить переход, откройте страницу `~/Tech/TYASP35.aspx` и добавьте следующий код в обработчик событий `Page_Load`:</span><span class="sxs-lookup"><span data-stu-id="6ac9e-138">To follow along, open the `~/Tech/TYASP35.aspx` page and add the following code to the `Page_Load` event handler:</span></span>

[!code-vb[Main](core-differences-between-iis-and-the-asp-net-development-server-vb/samples/sample1.vb)]

> [!NOTE]
> <span data-ttu-id="6ac9e-139">[Метод`File.WriteAllText`](https://msdn.microsoft.com/library/system.io.file.writealltext.aspx) создает новый файл, если он не существует, а затем записывает в него указанное содержимое.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-139">The [`File.WriteAllText` method](https://msdn.microsoft.com/library/system.io.file.writealltext.aspx) creates a new file if it does not exist and then writes the specified contents to it.</span></span> <span data-ttu-id="6ac9e-140">Если файл уже существует, существующее содержимое перезаписывается.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-140">If the file already exists, it's existing content is overwritten.</span></span>

<span data-ttu-id="6ac9e-141">Затем посетите страницу проверки книги *ASP.NET 3,5 в течение 24 часов* в среде разработки с помощью ASP.NET Development Server.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-141">Next, visit the *Teach Yourself ASP.NET 3.5 in 24 Hours* book review page in the development environment using the ASP.NET Development Server.</span></span> <span data-ttu-id="6ac9e-142">При условии, что вы вошли в систему на компьютере с учетной записью, имеющей достаточные разрешения для создания и изменения текстового файла в корневом каталоге веб-приложения, обзор книги будет таким же, как и раньше, но при каждом посещении страницы в файл `LastTYASP35Access.txt` будет сохранен IP-адрес пользователя.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-142">Assuming that you are logged on to your computer with an account that has adequate permissions to create and modify a text file in the web application's root directory the book review appears the same as before, but each time the page is visited the date and time and user's IP address is stored in the `LastTYASP35Access.txt` file.</span></span> <span data-ttu-id="6ac9e-143">Укажите в браузере этот файл. должно отобразиться примерно такое сообщение, как показано на рис. 1.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-143">Point your browser to this file; you should see a message similar to the one shown in Figure 1.</span></span>

<span data-ttu-id="6ac9e-144">[![текстовый файл содержит последнюю дату и время посещения книги&lt;](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image2.png)](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6ac9e-144">[![The Text File Contains the Last Date and Time the Book Review was Visited&lt;](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image2.png)](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image1.png)</span></span>

<span data-ttu-id="6ac9e-145">**Рис. 1**. текстовый файл содержит дату и время посещения просмотренной книги ([щелкните, чтобы просмотреть изображение с полным размером](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="6ac9e-145">**Figure 1**: The Text File Contains the Last Date and Time the Book Review was Visited([Click to view full-size image](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image3.png))</span></span>

<span data-ttu-id="6ac9e-146">Разверните веб-приложение в рабочей среде, а затем перейдите на страницу проверки книги *ASP.NET 3,5 за 24 часа* .</span><span class="sxs-lookup"><span data-stu-id="6ac9e-146">Deploy the web application to production and then visit the hosted *Teach Yourself ASP.NET 3.5 in 24 Hours* book review page.</span></span> <span data-ttu-id="6ac9e-147">На этом этапе вы должны увидеть страницу проверки книги как обычное или сообщение об ошибке, показанное на рис. 2.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-147">At this point you should either see the book review page as normal or the error message shown in Figure 2.</span></span> <span data-ttu-id="6ac9e-148">Некоторые поставщики веб-узлов предоставляют разрешения на запись для учетной записи анонимного ASP.NET компьютера. в этом случае страница будет работать без ошибок.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-148">Some web host providers grant write permissions to the anonymous ASP.NET machine account, in which case the page will work without error.</span></span> <span data-ttu-id="6ac9e-149">Однако если поставщик веб-узла запрещает доступ на запись для анонимной учетной записи, то [`UnauthorizedAccessException` исключение](https://msdn.microsoft.com/library/system.unauthorizedaccessexception.aspx) возникает, когда `TYASP35.aspx` страница пытается записать текущую дату и время в `LastTYASP35Access.txt` файл.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-149">If, however, your web host provider prohibits write access for the anonymous account then an [`UnauthorizedAccessException` exception](https://msdn.microsoft.com/library/system.unauthorizedaccessexception.aspx) is raised when the `TYASP35.aspx` page attempts to write the current date and time to the `LastTYASP35Access.txt` file.</span></span>

<span data-ttu-id="6ac9e-150">[![учетная запись компьютера по умолчанию, используемая службами IIS, не имеет разрешений на запись в файловую систему](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image5.png)](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="6ac9e-150">[![The Default Machine Account Used by IIS Does Not Have Permissions to Write to the File System](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image5.png)](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image4.png)</span></span>

<span data-ttu-id="6ac9e-151">**Рис. 2**. учетная запись компьютера по умолчанию, ИСПОЛЬЗУЕМАЯ службами IIS, не имеет разрешений на запись в файловую систему ([щелкните, чтобы просмотреть изображение с полным размером](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="6ac9e-151">**Figure 2**: The Default Machine Account Used by IIS Does Not Have Permissions to Write to the File System ([Click to view full-size image](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image6.png))</span></span>

<span data-ttu-id="6ac9e-152">Хорошая новость в том, что большинство поставщиков веб-узлов имеют некоторые средства разрешения, позволяющие указать разрешения файловой системы на веб-сайте.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-152">The good news is that most web host providers have some sort of permissions tool that allows you to specify file system permissions in your website.</span></span> <span data-ttu-id="6ac9e-153">Предоставьте анонимной учетной записи ASP.NET доступ на запись в корневой каталог, а затем снова перейдите на страницу проверки книги.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-153">Grant the anonymous ASP.NET account write access to the root directory and then revisit the book review page.</span></span> <span data-ttu-id="6ac9e-154">(При необходимости обратитесь к поставщику веб-узла за помощью по предоставлению разрешений на запись в учетную запись ASP.NET по умолчанию.) На этот раз страница должна загружаться без ошибок, и файл `LastTYASP35Access.txt` должен быть успешно создан.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-154">(If needed, contact your web host provider for assistance on how to grant write permissions to the default ASP.NET account.) This time the page should load without error and the `LastTYASP35Access.txt` file should be created successfully.</span></span>

<span data-ttu-id="6ac9e-155">Вот что из-за того, что ASP.NET Development Server работает в контексте безопасности, отличном от контекста IIS, возможно, что страницы ASP.NET, которые считывают или записывают в файловую систему, считывают или записывают в журнал событий Windows либо считывают или записывают в Windows.  реестр будет работать должным образом при разработке, но создавать исключения в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-155">The take away here is that because the ASP.NET Development Server operates under a different security context than IIS, it is possible that your ASP.NET pages that read or write to the file system, read from or write to the Windows Event Log, or read or write to the Windows registry will work as expected on development but generate exceptions when on production.</span></span> <span data-ttu-id="6ac9e-156">При создании веб-приложения, которое будет развернуто в общей среде размещения, не следует выполнять чтение или запись в журнал событий или реестр Windows.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-156">When building a web application that will be deployed to a shared web hosting environment, do not read or write to the Event Log or the Windows registry.</span></span> <span data-ttu-id="6ac9e-157">Также запишите все страницы ASP.NET, которые считывают или записывают в файловую систему, так как может потребоваться предоставить права на чтение и запись в соответствующих папках в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-157">Also take note of any ASP.NET pages that read from or write to the file system as you may need to grant read and write privileges on the appropriate folders in the production environment.</span></span>

## <a name="differences-on-serving-static-content"></a><span data-ttu-id="6ac9e-158">Различия в обслуживании статического содержимого</span><span class="sxs-lookup"><span data-stu-id="6ac9e-158">Differences On Serving Static Content</span></span>

<span data-ttu-id="6ac9e-159">Другим основным различием между IIS и ASP.NET Development Server является то, как они обрабатывали запросы к статическому содержимому.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-159">Another core difference between IIS and the ASP.NET Development Server is how they handle requests for static content.</span></span> <span data-ttu-id="6ac9e-160">Каждый запрос, поступающий в ASP.NET Development Server, будь то страница ASP.NET, изображение или файл JavaScript, обрабатывается средой выполнения ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-160">Every request that comes into the ASP.NET Development Server, whether for an ASP.NET page, an image, or a JavaScript file, is processed by the ASP.NET runtime.</span></span> <span data-ttu-id="6ac9e-161">По умолчанию службы IIS вызывают только среду выполнения ASP.NET, когда запрос поступает для ресурса ASP.NET, например веб-страницы ASP.NET, веб-службы и т. д.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-161">By default, IIS only invokes the ASP.NET runtime when a request comes in for an ASP.NET resource, such as an ASP.NET web page, a Web Service, and so forth.</span></span> <span data-ttu-id="6ac9e-162">Запросы на статическое содержимое — изображения, CSS-файлы, файлы JavaScript, PDF-файлы, ZIP-файлы и т. д. извлекаются службами IIS без участия среды выполнения ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-162">Requests for static content - images, CSS files, JavaScript files, PDF files, ZIP files, and the like - are retrieved by IIS without the involvement of the ASP.NET runtime.</span></span> <span data-ttu-id="6ac9e-163">(Можно настроить IIS для работы со средой выполнения ASP.NET при обслуживании статического содержимого. Дополнительные сведения см. в подразделе "выполнение проверки подлинности на основе форм и проверка подлинности URL-адресов для статических файлов с IIS 7" этого руководства.)</span><span class="sxs-lookup"><span data-stu-id="6ac9e-163">(It is possible to instruct IIS to work with the ASP.NET runtime when serving static content; consult the "Performing Forms-Based Authentication and URL Authentication on Static Files with IIS 7" section in this tutorial for more information.)</span></span>

<span data-ttu-id="6ac9e-164">Среда выполнения ASP.NET выполняет ряд действий по формированию запрошенного содержимого, включая проверку подлинности (идентификацию запрашивающей стороны) и авторизацию (определяет, имеет ли запрашивающий разрешение на просмотр запрошенного содержимого).</span><span class="sxs-lookup"><span data-stu-id="6ac9e-164">The ASP.NET runtime performs a number of steps to generate the requested content, including authentication (identifying the requestor) and authorization (determining if the requestor has permission to view the requested content).</span></span> <span data-ttu-id="6ac9e-165">Популярная форма проверки подлинности — это *Проверка подлинности на основе форм*, в которой пользователь вводит свои учетные данные (обычно это имя пользователя и пароль в текстовые поля на веб-странице).</span><span class="sxs-lookup"><span data-stu-id="6ac9e-165">A popular form of authentication is *forms-based authentication*, in which a user is identified by entering their credentials - usually a username and password - into textboxes on a web page.</span></span> <span data-ttu-id="6ac9e-166">После проверки учетных данных веб-сайт сохраняет файл cookie *билета проверки подлинности* в браузере пользователя, который отправляется при каждом последующем запросе к веб-сайту и используется для проверки подлинности пользователя.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-166">Upon validating their credentials, the website stores an *authentication ticket* cookie on the user's browser, which is sent with every subsequent request to the website and is what is used to authenticate the user.</span></span> <span data-ttu-id="6ac9e-167">Кроме того, можно указать правила *авторизации URL-адресов* , определяющие, какие пользователи могут или не могут получить доступ к определенной папке.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-167">Moreover, it is possible to specify *URL authorization* rules that dictate what users can or cannot access a particular folder.</span></span> <span data-ttu-id="6ac9e-168">Многие веб-сайты ASP.NET используют проверку подлинности на основе форм и авторизацию URL-адресов для поддержки учетных записей пользователей и определения частей сайта, которые доступны только пользователям, прошедшим проверку подлинности, или пользователям, принадлежащим к определенной роли.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-168">Many ASP.NET websites use forms-based authentication and URL authorization to support user accounts and to define portions of the site that are only accessible to authenticated users or users that belong to a certain role.</span></span>

> [!NOTE]
> <span data-ttu-id="6ac9e-169">Для тщательного изучения ASP. Проверка подлинности на основе форм, авторизация по URL-адресу и другие функции, связанные с учетными записями пользователей, обязательно изучите [учебники по безопасности веб-сайтов](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="6ac9e-169">For a thorough examination of ASP.NET's forms-based authentication, URL authorization, and other user account-related features, be sure to check out my [Website Security Tutorials](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span>

<span data-ttu-id="6ac9e-170">Рассмотрим веб-сайт, который поддерживает учетные записи пользователей с помощью авторизации на основе форм и имеет папку, которая использует авторизацию по URL-адресу, настроенную на разрешение только пользователей, прошедших проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-170">Consider a website that supports user accounts using forms-based authorization and has a folder that, using URL authorization, is configured to only allow authenticated users.</span></span> <span data-ttu-id="6ac9e-171">Представьте, что эта папка содержит страницы ASP.NET и PDF-файлы, и что цель состоит в том, что только пользователи, прошедшие проверку подлинности, могут просматривать эти PDF-файлы.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-171">Imagine that this folder contains ASP.NET pages and PDF files and that the intent is that only authenticated users can view these PDF files.</span></span>

<span data-ttu-id="6ac9e-172">Что произойдет, если посетитель пытается просмотреть один из этих PDF-файлов, введя его непосредственно в адресной строке браузера?</span><span class="sxs-lookup"><span data-stu-id="6ac9e-172">What happens if a visitor attempts to view one of these PDF files by entering the URL directly in his browser's Address bar?</span></span> <span data-ttu-id="6ac9e-173">Чтобы узнать это, создадим новую папку на сайте рецензий книги, добавим PDF-файлы и настроим сайт на использование авторизации URL-адресов, чтобы запретить анонимным пользователям доступ к этой папке.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-173">To find out, let's create a new folder in the Book Reviews site, add some PDF files, and configure the site to use URL authorization to prohibit anonymous users from visiting this folder.</span></span> <span data-ttu-id="6ac9e-174">Если вы загрузили демонстрационное приложение, вы увидите, что создали папку с именем `PrivateDocs` и добавили PDF-файл из [учебников по безопасности веб-сайта](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md) (как подгонка!).</span><span class="sxs-lookup"><span data-stu-id="6ac9e-174">If you download the demo application you'll see that I created a folder called `PrivateDocs` and added a PDF from my [Website Security Tutorials](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md) (how fitting!).</span></span> <span data-ttu-id="6ac9e-175">В папке `PrivateDocs` также содержится файл `Web.config`, в котором указываются правила авторизации URL-адресов для запрета анонимных пользователей:</span><span class="sxs-lookup"><span data-stu-id="6ac9e-175">The `PrivateDocs` folder also contains a `Web.config` file that specifies the URL authorization rules to deny anonymous users:</span></span>

[!code-xml[Main](core-differences-between-iis-and-the-asp-net-development-server-vb/samples/sample2.xml)]

<span data-ttu-id="6ac9e-176">Наконец, я настроил веб-приложение для использования проверки подлинности на основе форм, обновив файл Web. config в корневом каталоге, заменив:</span><span class="sxs-lookup"><span data-stu-id="6ac9e-176">Finally, I configured the web application to use forms-based authentication by updating the Web.config file in the root directory, replacing:</span></span>

[!code-xml[Main](core-differences-between-iis-and-the-asp-net-development-server-vb/samples/sample3.xml)]

<span data-ttu-id="6ac9e-177">на:</span><span class="sxs-lookup"><span data-stu-id="6ac9e-177">With:</span></span>

[!code-xml[Main](core-differences-between-iis-and-the-asp-net-development-server-vb/samples/sample4.xml)]

<span data-ttu-id="6ac9e-178">Используя ASP.NET Development Server, перейдите на сайт и введите прямой URL-адрес для одного из PDF-файлов в адресной строке браузера.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-178">Using the ASP.NET Development Server, visit the site and enter the direct URL to one of the PDF files in your browser's Address bar.</span></span> <span data-ttu-id="6ac9e-179">Если вы скачали веб-сайт, связанный с этим руководством, URL-адрес должен выглядеть примерно так: `http://localhost:portNumber/PrivateDocs/aspnet_tutorial01_Basics_vb.pdf`</span><span class="sxs-lookup"><span data-stu-id="6ac9e-179">If you downloaded the website associated with this tutorial the URL should look something like: `http://localhost:portNumber/PrivateDocs/aspnet_tutorial01_Basics_vb.pdf`</span></span>

<span data-ttu-id="6ac9e-180">Если ввести этот URL-адрес в адресную строку, браузер отправит запрос в ASP.NET Development Server файла.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-180">Entering this URL into the Address bar causes the browser to send a request to the ASP.NET Development Server for the file.</span></span> <span data-ttu-id="6ac9e-181">ASP.NET Development Server передает запрос в среду выполнения ASP.NET для обработки.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-181">The ASP.NET Development Server hands off the request to the ASP.NET runtime for processing.</span></span> <span data-ttu-id="6ac9e-182">Так как мы еще не выполнили вход, а `Web.config` в папке `PrivateDocs` настроены для запрета анонимного доступа, среда выполнения ASP.NET автоматически перенаправит нас на страницу входа, `Login.aspx` (см. рис. 3).</span><span class="sxs-lookup"><span data-stu-id="6ac9e-182">Because we have not yet logged in, and because the `Web.config` in the `PrivateDocs` folder is configured to deny anonymous access, the ASP.NET runtime automatically redirects us to the login page, `Login.aspx` (see Figure 3).</span></span> <span data-ttu-id="6ac9e-183">При перенаправлении пользователя на страницу входа в ASP.NET включает параметр строки запроса `ReturnUrl`, указывающий страницу, которую пользователь пытался просмотреть.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-183">When redirecting the user to the log in page, ASP.NET includes a `ReturnUrl` querystring parameter that indicates the page the user was attempting to view.</span></span> <span data-ttu-id="6ac9e-184">После успешного входа в систему пользователь может вернуться на эту страницу.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-184">After successfully logging in the user can be returned to this page.</span></span>

<span data-ttu-id="6ac9e-185">[![неавторизованные пользователи автоматически перенаправляются на страницу входа](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image8.png)](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="6ac9e-185">[![Unauthorized Users are Automatically Redirected to the Login Page](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image8.png)](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image7.png)</span></span>

<span data-ttu-id="6ac9e-186">**Рис. 3**. неавторизованные пользователи автоматически перенаправляются на страницу входа ([щелкните, чтобы просмотреть изображение с полным размером](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="6ac9e-186">**Figure 3**: Unauthorized Users are Automatically Redirected to the Login Page ([Click to view full-size image](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image9.png))</span></span>

<span data-ttu-id="6ac9e-187">Теперь давайте посмотрим, как это работает в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-187">Now let's see how this behaves on production.</span></span> <span data-ttu-id="6ac9e-188">Разверните приложение и введите прямой URL-адрес для одного из документов PDF в папке `PrivateDocs` в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-188">Deploy your application and enter the direct URL to one of the PDFs in the `PrivateDocs` folder in production.</span></span> <span data-ttu-id="6ac9e-189">В браузере будет предложено отправить запрос IIS для файла.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-189">This prompts your browser to send a request IIS for the file.</span></span> <span data-ttu-id="6ac9e-190">Поскольку запрашивается статический файл, IIS извлекает и возвращает файл без вызова среды выполнения ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-190">Because a static file is requested, IIS retrieves and returns the file without invoking the ASP.NET runtime.</span></span> <span data-ttu-id="6ac9e-191">В результате Проверка авторизации URL-адреса не выполнялась. содержимое действительно закрытого PDF-документа доступно всем, кто знает прямой URL-адрес файла.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-191">As a result, there was no URL authorization check performed; the contents of the supposedly private PDF are accessible to anyone who knows the direct URL to the file.</span></span>

<span data-ttu-id="6ac9e-192">[![анонимные пользователи могут загружать частные файлы PDF, вводя прямой URL-адрес файла.](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image11.png)](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="6ac9e-192">[![Anonymous Users Can Download the Private PDF Files By Entering the Direct URL to the File](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image11.png)](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image10.png)</span></span>

<span data-ttu-id="6ac9e-193">**Рис. 4**. анонимные пользователи могут скачивать личные PDF-файлы, вводя прямой URL – адрес файла ([щелкните, чтобы просмотреть изображение с полным размером](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image12.png)).</span><span class="sxs-lookup"><span data-stu-id="6ac9e-193">**Figure 4**: Anonymous Users Can Download the Private PDF Files By Entering the Direct URL to the File ([Click to view full-size image](core-differences-between-iis-and-the-asp-net-development-server-vb/_static/image12.png))</span></span>

### <a name="performing-forms-based-authentication-and-url-authentication-on-static-files-with-iis-7"></a><span data-ttu-id="6ac9e-194">Выполнение проверки подлинности на основе форм и URL-адреса для статических файлов с IIS 7</span><span class="sxs-lookup"><span data-stu-id="6ac9e-194">Performing Forms-Based Authentication and URL Authentication on Static Files with IIS 7</span></span>

<span data-ttu-id="6ac9e-195">Существует несколько приемов, которые можно использовать для защиты статического содержимого от неавторизованных пользователей.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-195">There are a couple of techniques you can use to protect static content from unauthorized users.</span></span> <span data-ttu-id="6ac9e-196">В IIS 7 появился *интегрированный конвейер*, сочетает рабочий процесс IIS с рабочим процессом среды выполнения ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-196">IIS 7 introduced the *integrated pipeline*, which marries IIS's workflow with the ASP.NET runtime's workflow.</span></span> <span data-ttu-id="6ac9e-197">В двух словах, вы можете указать службам IIS вызывать модули проверки подлинности и авторизации среды выполнения ASP.NET все входящие запросы (включая статическое содержимое, например PDF-файлы).</span><span class="sxs-lookup"><span data-stu-id="6ac9e-197">In a nutshell, you can instruct IIS to invoke the ASP.NET runtime's authentication and authorization modules all incoming requests (including static content like PDF files).</span></span> <span data-ttu-id="6ac9e-198">Обратитесь к поставщику веб-узла, чтобы узнать, как настроить веб-сайт для использования интегрированного конвейера.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-198">Contact your web host provider to find out how to configure your website to use the integrated pipeline.</span></span>

<span data-ttu-id="6ac9e-199">После настройки IIS для использования интегрированного конвейера добавьте следующую разметку в файл `Web.config` в корневом каталоге:</span><span class="sxs-lookup"><span data-stu-id="6ac9e-199">Once IIS has been configured to use the integrated pipeline add the following markup to the `Web.config` file in the root directory:</span></span>

[!code-xml[Main](core-differences-between-iis-and-the-asp-net-development-server-vb/samples/sample5.xml)]

<span data-ttu-id="6ac9e-200">Эта разметка указывает IIS 7 на использование модулей проверки подлинности и авторизации на основе ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-200">This markup instructs IIS 7 to use the ASP.NET-based authentication and authorization modules.</span></span> <span data-ttu-id="6ac9e-201">Повторно разверните приложение, а затем снова перейдите в PDF-файл.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-201">Re-deploy your application and then re-visit the PDF file.</span></span> <span data-ttu-id="6ac9e-202">На этот раз, когда IIS обрабатывает запрос, он предоставляет логике проверки подлинности и авторизации среды выполнения ASP.NET возможность проверить запрос.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-202">This time when IIS handles the request it gives the ASP.NET runtime's authentication and authorization logic an opportunity to inspect the request.</span></span> <span data-ttu-id="6ac9e-203">Так как только пользователи, прошедшие проверку подлинности, авторизованы для просмотра содержимого в папке `PrivateDocs`, анонимный посетитель автоматически перенаправляется на страницу входа (см. рис. 3).</span><span class="sxs-lookup"><span data-stu-id="6ac9e-203">Because only authenticated users are authorized to view the contents in the `PrivateDocs` folder, the anonymous visitor is automatically redirected to the login page (refer back to Figure 3).</span></span>

> [!NOTE]
> <span data-ttu-id="6ac9e-204">Если поставщик веб-узла все еще использует IIS 6, то нельзя использовать встроенную функцию конвейера.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-204">If your web host provider is still using IIS 6 then you cannot use the integrated pipeline feature.</span></span> <span data-ttu-id="6ac9e-205">Одним из способов решения этой проблемы является помещение частных документов в папку, которая запрещает доступ по протоколу HTTP (например, `App_Data`), а затем создание страницы для обслуживания этих документов.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-205">One workaround is to put your private documents in a folder that prohibits HTTP access (such as `App_Data`) and then create a page to serve these documents.</span></span> <span data-ttu-id="6ac9e-206">Эта страница может называться `GetPDF.aspx`, и ей передается имя PDF-файла с помощью параметра QueryString.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-206">This page might be called `GetPDF.aspx`, and is passed the name of the PDF through a querystring parameter.</span></span> <span data-ttu-id="6ac9e-207">Страница `GetPDF.aspx` сначала проверит, имеет ли пользователь разрешение на просмотр файла, и, если да, будет использовать метод [`Response.WriteFile(filePath)`](https://msdn.microsoft.com/library/system.web.httpresponse.writefile.aspx) для отправки содержимого ЗАПРОШЕННОГО PDF-файла обратно запрашивающему клиенту.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-207">The `GetPDF.aspx` page would first verify that the user has permission to view the file and, if so, would use the [`Response.WriteFile(filePath)`](https://msdn.microsoft.com/library/system.web.httpresponse.writefile.aspx) method to send the contents of the requested PDF file back to the requesting client.</span></span> <span data-ttu-id="6ac9e-208">Этот метод также будет работать для IIS 7, если вы не хотите включать интегрированный конвейер.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-208">This technique would also work for IIS 7 if you did not wish to enable the integrated pipeline.</span></span>

## <a name="summary"></a><span data-ttu-id="6ac9e-209">Сводка</span><span class="sxs-lookup"><span data-stu-id="6ac9e-209">Summary</span></span>

<span data-ttu-id="6ac9e-210">Веб-приложения в рабочей среде размещаются с помощью программного обеспечения веб-сервера IIS корпорации Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-210">Web applications in a production environment are hosted using Microsoft's IIS web server software.</span></span> <span data-ttu-id="6ac9e-211">Однако в среде разработки приложение может размещаться с помощью служб IIS или ASP.NET Development Server.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-211">In the development environment, however, the application may be hosted using IIS or the ASP.NET Development Server.</span></span> <span data-ttu-id="6ac9e-212">В идеале одно и то же программное обеспечение веб-сервера должно использоваться в обеих средах, поскольку использование разных программ добавляет другую переменную в набор.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-212">Ideally, the same web server software should be used in both environments because using different software adds another variable in the mix.</span></span> <span data-ttu-id="6ac9e-213">Однако простота использования ASP.NET Development Server делает его привлекательным выбором в среде разработки.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-213">However, the ease of use of the ASP.NET Development Server makes it an attractive choice in the development environment.</span></span> <span data-ttu-id="6ac9e-214">Хорошая новость состоит в том, что существует лишь несколько фундаментальных различий между IIS и ASP.NET Development Server, и если вы осведомлены об этих различиях, можно предпринять действия по обеспечению работы приложения и работать точно так же, независимо от PXE.</span><span class="sxs-lookup"><span data-stu-id="6ac9e-214">The good news is that there are only a few fundamental differences between IIS and the ASP.NET Development Server, and if you are aware of these differences you can take steps to help ensure that the application works and functions the same way regardless of the environment.</span></span>

<span data-ttu-id="6ac9e-215">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="6ac9e-215">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="6ac9e-216">Дополнительные материалы</span><span class="sxs-lookup"><span data-stu-id="6ac9e-216">Further Reading</span></span>

<span data-ttu-id="6ac9e-217">Дополнительные сведения о разделах, обсуждаемых в этом руководстве, см. в следующих ресурсах:</span><span class="sxs-lookup"><span data-stu-id="6ac9e-217">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="6ac9e-218">Интеграция ASP.NET с IIS 7,0</span><span class="sxs-lookup"><span data-stu-id="6ac9e-218">ASP.NET Integration with IIS 7.0</span></span>](https://www.iis.net/learn/application-frameworks/building-and-running-aspnet-applications/aspnet-integration-with-iis)
- <span data-ttu-id="6ac9e-219">[Использование проверки подлинности на форумах ASP.NET со всеми типами содержимого в IIS 7](https://blogs.iis.net/bills/archive/2007/05/19/using-asp-net-forms-authentication-with-all-types-of-content-with-iis7-video.aspx) (видео)</span><span class="sxs-lookup"><span data-stu-id="6ac9e-219">[Using ASP.NET Forums Authentication With All Types of Content on IIS 7](https://blogs.iis.net/bills/archive/2007/05/19/using-asp-net-forms-authentication-with-all-types-of-content-with-iis7-video.aspx) (Video)</span></span>
- [<span data-ttu-id="6ac9e-220">Веб-серверы в Visual Web Developer</span><span class="sxs-lookup"><span data-stu-id="6ac9e-220">Web Servers in Visual Web Developer</span></span>](https://msdn.microsoft.com/library/58wxa9w5.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="6ac9e-221">[Назад](common-configuration-differences-between-development-and-production-vb.md)
> [Вперед](deploying-a-database-vb.md)</span><span class="sxs-lookup"><span data-stu-id="6ac9e-221">[Previous](common-configuration-differences-between-development-and-production-vb.md)
[Next](deploying-a-database-vb.md)</span></span>
