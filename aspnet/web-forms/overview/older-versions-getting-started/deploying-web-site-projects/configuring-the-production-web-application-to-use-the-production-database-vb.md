---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/configuring-the-production-web-application-to-use-the-production-database-vb
title: Настройка рабочего веб-приложения для использования рабочей базы данных (VB) | Документация Майкрософт
author: rick-anderson
description: Как обсуждалось в предыдущих учебных курсах, информация о конфигурации не часто различается в средах разработки и рабочей среде. Это ES...
ms.author: riande
ms.date: 04/23/2009
ms.assetid: a64a7aa0-6608-449e-83bf-1ef8cceee504
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/configuring-the-production-web-application-to-use-the-production-database-vb
msc.type: authoredcontent
ms.openlocfilehash: 7fe4f545a76992ad687827af447d9a9e95bea73f
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74633681"
---
# <a name="configuring-the-production-web-application-to-use-the-production-database-vb"></a><span data-ttu-id="2ae8c-104">Настройка рабочего веб-приложения для использования рабочей базы данных (VB)</span><span class="sxs-lookup"><span data-stu-id="2ae8c-104">Configuring the Production Web Application to Use the Production Database (VB)</span></span>

<span data-ttu-id="2ae8c-105">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2ae8c-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2ae8c-106">[Скачать код](https://download.microsoft.com/download/E/6/F/E6FE3A1F-EE3A-4119-989A-33D1A9F6F6DD/ASPNET_Hosting_Tutorial_08_VB.zip) или [скачать PDF](https://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial08_DBConfig_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="2ae8c-106">[Download Code](https://download.microsoft.com/download/E/6/F/E6FE3A1F-EE3A-4119-989A-33D1A9F6F6DD/ASPNET_Hosting_Tutorial_08_VB.zip) or [Download PDF](https://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial08_DBConfig_vb.pdf)</span></span>

> <span data-ttu-id="2ae8c-107">Как обсуждалось в предыдущих учебных курсах, информация о конфигурации не часто различается в средах разработки и рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-107">As discussed in earlier tutorials, it is not uncommon for configuration information to differ between the development and production environments.</span></span> <span data-ttu-id="2ae8c-108">Это особенно справедливо для управляемых данными веб-приложений, так как строки подключения к базе данных отличаются в средах разработки и рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-108">This is especially true for data-driven web applications, as the database connection strings differ between the development and production environments.</span></span> <span data-ttu-id="2ae8c-109">В этом руководстве рассматриваются способы настройки рабочей среды для более подробного включения соответствующей строки подключения.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-109">This tutorial explores ways to configure the production environment to include the appropriate connection string in more detail.</span></span>

## <a name="introduction"></a><span data-ttu-id="2ae8c-110">Введение</span><span class="sxs-lookup"><span data-stu-id="2ae8c-110">Introduction</span></span>

<span data-ttu-id="2ae8c-111">Веб-приложения, управляемые данными, обычно используют другую базу данных при разработке, а не в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-111">Data-driven web applications usually use a different database when in development than when in production.</span></span> <span data-ttu-id="2ae8c-112">Для приложений, размещенных в поставщике веб-узла и разработанных локально, база данных разработки обычно находится на компьютере разработчика, а Рабочая база данных размещается на сервере базы данных в компании, размещенной в Интернете.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-112">For applications hosted by a web host provider and developed locally, the development database typically resides on the developer s computer while the production database is hosted on a database server at the web hosting company s facility.</span></span> <span data-ttu-id="2ae8c-113">Развертывание управляемого данными веб-приложения влечет за собой копирование базы данных разработки на сервер рабочей базы данных.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-113">Deploying a data-driven web application entails copying the development database to the production database server.</span></span> <span data-ttu-id="2ae8c-114">В предыдущем учебном курсе мы рассматривали способы выполнения этого шага.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-114">In the previous tutorial we looked at ways to accomplish this step.</span></span>

<span data-ttu-id="2ae8c-115">Веб-приложение использует сведения в *строке подключения* для установления соединения с базой данных.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-115">The web application uses the information in a *connection string* to establish a connection with the database.</span></span> <span data-ttu-id="2ae8c-116">Строка подключения, которая обычно хранится в `Web.config`, указывает имя сервера базы данных, имя базы данных, контекст безопасности и другие сведения.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-116">The connection string, which is typically stored in `Web.config`, specifies the database server name, the name of the database, the security context, and other information.</span></span> <span data-ttu-id="2ae8c-117">Поскольку база данных, используемая веб-приложением, зависит от того, выполняется ли веб-приложение в средах разработки или рабочей среде, строки подключения должны различаться между этими двумя средами.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-117">Because the database used by the web application depends on whether the web application is running in the development or production environments, the connection strings must differ between the two environments.</span></span>

<span data-ttu-id="2ae8c-118">Нередко информация о конфигурации различается в средах разработки и рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-118">It is not uncommon for configuration information to differ between the development and production environments.</span></span> <span data-ttu-id="2ae8c-119">*Общие различия конфигураций* в учебнике по разработке и производству обсуждают методики обслуживания отдельных сведений о конфигурации между этими двумя средами, а также краткое обсуждение строк подключения к базам данных.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-119">The *Common Configuration Differences Between Development and Production* tutorial discussed techniques for maintaining separate configuration information between these two environments, as well as a brief discussion on database connection strings.</span></span> <span data-ttu-id="2ae8c-120">В этом руководстве рассматриваются способы настройки рабочей среды для более подробного включения соответствующей строки подключения.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-120">This tutorial explores ways to configure the production environment to include the appropriate connection string in more detail.</span></span>

## <a name="examining-the-connection-string-information"></a><span data-ttu-id="2ae8c-121">Проверка сведений о строке подключения</span><span class="sxs-lookup"><span data-stu-id="2ae8c-121">Examining the Connection String Information</span></span>

<span data-ttu-id="2ae8c-122">Строка подключения, используемая веб-приложением для рецензирования книги, хранится в файле конфигурации приложения `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-122">The connection string used by the Book Reviews web application is stored in the application s configuration file, `Web.config`.</span></span> <span data-ttu-id="2ae8c-123">`Web.config` включает специальный раздел для хранения строк подключения, выразился с именем [&lt;connectionstring&gt;](https://msdn.microsoft.com/library/bf7sd233.aspx).</span><span class="sxs-lookup"><span data-stu-id="2ae8c-123">`Web.config` includes a special section for storing connection strings, aptly named [&lt;connectionStrings&gt;](https://msdn.microsoft.com/library/bf7sd233.aspx).</span></span> <span data-ttu-id="2ae8c-124">Файл `Web.config` для веб-сайта проверки книги содержит одну строку подключения, определенную в этом разделе с именем `ReviewsConnectionString`:</span><span class="sxs-lookup"><span data-stu-id="2ae8c-124">The `Web.config` file for the Book Reviews website has one connection string defined in this section named `ReviewsConnectionString`:</span></span>

[!code-xml[Main](configuring-the-production-web-application-to-use-the-production-database-vb/samples/sample1.xml)]

<span data-ttu-id="2ae8c-125">Строка подключения — источник данных = .\SQLEXPRESS; AttachDbFilename = | DataDirectory | \Ревиевс.МДФ; Integrated Security = true; User Instance = true — состоит из ряда параметров и значений, в которых пары "ключ-значение" ограничены точкой с запятой, а каждый параметр и значение разделяются знаком равенства.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-125">The connection string - Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\Reviews.mdf;Integrated Security=True;User Instance=True - is composed of a number of options and values, with option/value pairs delimited by a semicolon and each option and value delimited by an equals sign.</span></span> <span data-ttu-id="2ae8c-126">В этой строке подключения используются четыре параметра:</span><span class="sxs-lookup"><span data-stu-id="2ae8c-126">The four options used in this connection string are:</span></span>

- <span data-ttu-id="2ae8c-127">`Data Source` — указывает расположение сервера базы данных и имя экземпляра сервера базы данных (если есть).</span><span class="sxs-lookup"><span data-stu-id="2ae8c-127">`Data Source` - specifies the location of the database server and the database server instance name (if any).</span></span> <span data-ttu-id="2ae8c-128">Значение, `.\SQLEXPRESS`, — это пример, в котором есть сервер базы данных и имя экземпляра.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-128">The value, `.\SQLEXPRESS`, is an example where there is a database server and an instance name.</span></span> <span data-ttu-id="2ae8c-129">Период указывает, что сервер базы данных находится на том же компьютере, что и приложение; имя экземпляра — `SQLEXPRESS`.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-129">The period specifies that the database server is on the same computer as the application; the instance name is `SQLEXPRESS`.</span></span>
- <span data-ttu-id="2ae8c-130">`AttachDbFilename` — указывает расположение файла базы данных.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-130">`AttachDbFilename` - specifies the location of the database file.</span></span> <span data-ttu-id="2ae8c-131">Значение содержит заполнитель `|DataDirectory|`, который разрешается в полный путь к папке приложения `App_Data` во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-131">The value contains the placeholder `|DataDirectory|`, which is resolved to the full path of the application s `App_Data` folder at runtime.</span></span>
- <span data-ttu-id="2ae8c-132">`Integrated Security` — логическое значение, указывающее, следует ли использовать указанное имя пользователя и пароль при подключении к базе данных (false) или учетные данные текущей учетной записи Windows (true).</span><span class="sxs-lookup"><span data-stu-id="2ae8c-132">`Integrated Security` - a Boolean value that indicates whether to use a specified username/password when connecting to the database (false) or the current Windows account credentials (true).</span></span>
- <span data-ttu-id="2ae8c-133">`User Instance` — параметр конфигурации, относящийся к выпускам SQL Server Express, которые указывают, следует ли разрешать пользователям, не являющимся администраторами, на локальном компьютере присоединяться к базе данных SQL Server Express Edition и подключаться к ней.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-133">`User Instance` - a configuration option specific to the SQL Server Express Editions that indicates whether to allow non-Administrative users on the local computer attach and connect to a SQL Server Express Edition database.</span></span> <span data-ttu-id="2ae8c-134">Дополнительные сведения об этом параметре см. в разделе [SQL Server Express User Instances](https://msdn.microsoft.com/library/ms254504.aspx) .</span><span class="sxs-lookup"><span data-stu-id="2ae8c-134">See [SQL Server Express User Instances](https://msdn.microsoft.com/library/ms254504.aspx) for more information on this setting.</span></span>

<span data-ttu-id="2ae8c-135">Допустимые параметры строки подключения зависят от базы данных, к которой вы подключаетесь, и используемого поставщика базы данных [ADO.NET](http://ADO.NET) .</span><span class="sxs-lookup"><span data-stu-id="2ae8c-135">The allowable connection string options depend on the database you are connecting to and the [ADO.NET](http://ADO.NET) database provider being used.</span></span> <span data-ttu-id="2ae8c-136">Например, строка подключения для соединения с Microsoft SQL Server базой данных отличается от той, которая использовалась для подключения к базе данных Oracle.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-136">For example, the connection string for connecting to a Microsoft SQL Server database differs from that used to connect to an Oracle database.</span></span> <span data-ttu-id="2ae8c-137">Аналогичным образом, при подключении к базе данных Microsoft SQL Server с помощью поставщика SqlClient используется строка подключения, отличная от строки соединения, используемой поставщиком OLE DB.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-137">Likewise, connecting to a Microsoft SQL Server database using the SqlClient provider uses a different connection string than when using the OLE-DB provider.</span></span>

<span data-ttu-id="2ae8c-138">Вы можете создать строку подключения к базе данных вручную, используя сайт, например [connectionStrings.com](http://www.connectionstrings.com/) , в качестве ресурса для выбора доступных параметров.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-138">You can build the database connection string by hand using a site like [ConnectionStrings.com](http://www.connectionstrings.com/) as a resource for what options are available.</span></span> <span data-ttu-id="2ae8c-139">Однако проще подходить к добавлению базы данных в обозреватель сервера в Visual Studio, а затем извлечь строку подключения из окно свойств.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-139">However, an easier approach is to add the database to the Server Explorer in Visual Studio and then to grab the connection string from the Properties window.</span></span> <span data-ttu-id="2ae8c-140">Позвольте использовать этот второй метод для создания строки подключения к рабочему серверу базы данных.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-140">Let s use this latter technique for constructing the connection string to the production database server.</span></span>

<span data-ttu-id="2ae8c-141">Откройте Visual Studio и перейдите в окно обозреватель сервера (в Visual Web Developer это окно называется обозреватель базы данных).</span><span class="sxs-lookup"><span data-stu-id="2ae8c-141">Open Visual Studio and then navigate to the Server Explorer window (in Visual Web Developer, this window is called Database Explorer).</span></span> <span data-ttu-id="2ae8c-142">Щелкните правой кнопкой мыши параметр подключения к данным и выберите в контекстном меню пункт Добавить подключение.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-142">Right-click on the Data Connections option and choose the Add Connection option from the context menu.</span></span> <span data-ttu-id="2ae8c-143">Откроется мастер, показанный на рис. 1.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-143">This brings up the wizard shown in Figure 1.</span></span> <span data-ttu-id="2ae8c-144">Выберите соответствующий источник данных и нажмите кнопку продолжить.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-144">Choose the appropriate data source and click Continue.</span></span>

<span data-ttu-id="2ae8c-145">[![выберите Добавление новой базы данных в обозреватель сервера](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image2.jpg)](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image1.jpg)</span><span class="sxs-lookup"><span data-stu-id="2ae8c-145">[![Choose to Add a New Database to the Server Explorer](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image2.jpg)](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image1.jpg)</span></span> 

<span data-ttu-id="2ae8c-146">**Рис. 1**. Добавление новой базы данных в обозреватель сервера ([щелкните, чтобы просмотреть изображение с полным размером](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image3.jpg))</span><span class="sxs-lookup"><span data-stu-id="2ae8c-146">**Figure 1**: Choose to Add a New Database to the Server Explorer ([Click to view full-size image](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image3.jpg))</span></span>

<span data-ttu-id="2ae8c-147">Затем укажите различные сведения о подключении к базе данных (см. рис. 2).</span><span class="sxs-lookup"><span data-stu-id="2ae8c-147">Next, specify the various database connection information (see Figure 2).</span></span> <span data-ttu-id="2ae8c-148">При регистрации в компании для размещения веб-узлов им должны быть предоставлены сведения о подключении к базе данных: имя сервера базы данных, имя базы данных, имя пользователя и пароль, используемые для подключения к базе данных и т. д.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-148">When you signed up with your web hosting company they should have provided information on how to connect to the database - the database server name, the database name, the username and password to use to connect to the database, and so on.</span></span> <span data-ttu-id="2ae8c-149">После ввода этих сведений нажмите кнопку ОК, чтобы завершить работу мастера и добавить базу данных в обозреватель сервера.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-149">After entering this information click OK to complete this wizard and to add the database to the Server Explorer.</span></span>

<span data-ttu-id="2ae8c-150">[![указать сведения о подключении к базе данных](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image5.jpg)](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image4.jpg)</span><span class="sxs-lookup"><span data-stu-id="2ae8c-150">[![Specify the Database Connection Information](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image5.jpg)](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image4.jpg)</span></span> 

<span data-ttu-id="2ae8c-151">**Рис. 2**. Указание сведений о подключении к базе данных ([щелкните, чтобы просмотреть изображение с полным размером](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image6.jpg))</span><span class="sxs-lookup"><span data-stu-id="2ae8c-151">**Figure 2**: Specify the Database Connection Information ([Click to view full-size image](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image6.jpg))</span></span>

<span data-ttu-id="2ae8c-152">Теперь база данных рабочей среды должна быть указана в обозреватель сервера.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-152">The production environment database should now be listed in the Server Explorer.</span></span> <span data-ttu-id="2ae8c-153">Выберите базу данных из обозреватель сервера и перейдите к окно свойств.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-153">Select the database from the Server Explorer and go to the Properties window.</span></span> <span data-ttu-id="2ae8c-154">Здесь вы найдете свойство с именем строка соединения с строкой подключения базы данных.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-154">There you will find a property named Connection String with the database s connection string.</span></span> <span data-ttu-id="2ae8c-155">При условии, что вы используете базу данных Microsoft SQL Server в рабочей среде и Поставщик SqlClient, строка подключения должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="2ae8c-155">Assuming you are using a Microsoft SQL Server database on production and the SqlClient provider your connection string should look similar to the following:</span></span>

<span data-ttu-id="2ae8c-156"><strong>Источник данных =<em>ServerName</em>; Исходный каталог =<em>DatabaseName</em>; Сохранить сведения о безопасности = true; Идентификатор пользователя =<em>username</em>; Password =*пароль</strong>*</span><span class="sxs-lookup"><span data-stu-id="2ae8c-156"><strong>Data Source=<em>serverName</em>; Initial Catalog=<em>databaseName</em>; Persist Security Info=True; User ID=<em>username</em>; Password=*password</strong>*</span></span>

<span data-ttu-id="2ae8c-157">Где *ServerName*, *DatabaseName*, *username*и *Password* имеют значения для имени сервера базы данных, имени базы данных и имени пользователя и пароля, предоставленных вашей компанией веб-узла.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-157">Where *serverName*, *databaseName*, *username*, and *password* are with the values for the database server name, the database name, and the username and password supplied to you by your web host company.</span></span>

## <a name="deploying-the-book-reviews-web-application"></a><span data-ttu-id="2ae8c-158">Развертывание веб-приложения для рецензирования книги</span><span class="sxs-lookup"><span data-stu-id="2ae8c-158">Deploying the Book Reviews Web Application</span></span>

<span data-ttu-id="2ae8c-159">Предыдущая пошаговая руководства повышена при копировании базы данных разработки в рабочую среду, но не изучается при развертывании приложения, управляемого данными.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-159">The preceding tutorial stepped through copying the development database to the production environment, but did not explore deploying the data-driven application.</span></span> <span data-ttu-id="2ae8c-160">На этом этапе Рабочая среда содержит базу данных, но использует версию приложения для рецензирования книги со статическими проверками.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-160">At this point the production environment contains the database but is using the version of the Book Reviews application with static reviews.</span></span> <span data-ttu-id="2ae8c-161">Необходимо развернуть новое приложение, управляемое данными, на рабочем сервере вместе с обновленными сведениями о конфигурации.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-161">We need to deploy the new, data-driven application to the production server along with the updated configuration information.</span></span>

<span data-ttu-id="2ae8c-162">Уделите немного времени развертыванию приложения, управляемого данными, из среды разработки в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-162">Take a moment to deploy the data-driven application from the development environment to production.</span></span> <span data-ttu-id="2ae8c-163">Этот процесс подробно описан в предыдущих руководствах.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-163">This process was covered in detail in previous tutorials.</span></span> <span data-ttu-id="2ae8c-164">Если вам требуется Обновитель, см. раздел *Развертывание веб-сайта с помощью FTP-клиента* или *Развертывание веб-сайта с помощью Visual Studio* .</span><span class="sxs-lookup"><span data-stu-id="2ae8c-164">If you need a refresher, see the *Deploying Your Website Using an FTP Client* or the *Deploying Your Website Using Visual Studio* tutorials.</span></span> <span data-ttu-id="2ae8c-165">Необходимо убедиться, что строка подключения к рабочей базе данных используется в рабочей среде. Это означает, что необходимо развернуть альтернативный файл `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-165">You will need to ensure that the production database connection string is the one used in the production environment, which means that an alternate `Web.config` file must be deployed.</span></span> <span data-ttu-id="2ae8c-166">В частности, этот измененный `Web.config` файл `<connectionStrings>` должен содержать строку подключения к рабочей базе данных и должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="2ae8c-166">Specifically, this modified `Web.config` file s `<connectionStrings>` element needs to contain the production database connection string and should look similar to the following:</span></span>

[!code-xml[Main](configuring-the-production-web-application-to-use-the-production-database-vb/samples/sample2.xml)]

<span data-ttu-id="2ae8c-167">Обратите внимание, что строка подключения в элементе `<connectionStrings>` имеет то же имя (`ReviewsConnectionString`), но теперь содержит строку подключения к рабочей базе данных, а не строку подключения к базе данных разработки.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-167">Note that the connection string in the `<connectionStrings>` element is named the same (`ReviewsConnectionString`), but now contains the production database connection string instead of the development database connection string.</span></span>

<span data-ttu-id="2ae8c-168">Если у вас нет более формального рабочего процесса развертывания, вручную измените файл `Web.config` для использования строки подключения к рабочей базе данных перед развертыванием (не забывайте вернуться к использованию строки подключения к базе данных разработки позже) или сохраните отдельный файл `Web.config` с данными конфигурации рабочей среды, которые передаются в рабочую среду в рамках процесса развертывания.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-168">Unless you have a more formalized deployment workflow, either manually modify the `Web.config` file to use the production database connection string before deploying (remembering to revert it back to using the development database connection string afterwards) or maintain a separate `Web.config` file with the production environment configuration information that gets uploaded to the production environment as part of the deployment process.</span></span>

> [!NOTE]
> <span data-ttu-id="2ae8c-169">Если случайно развернуть `Web.config` файл, содержащий строку подключения к базе данных разработки, то при попытке приложения в рабочей среде подключиться к базе данных произойдет ошибка.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-169">If you accidentally deploy a `Web.config` file that contains the development database connection string then there will be an error when the application on production attempts to connect to the database.</span></span> <span data-ttu-id="2ae8c-170">Эта ошибка манифеста `SqlException` с сообщением о том, что сервер не найден или недоступен.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-170">This error manifests as a `SqlException` with a message reporting that the server was not found or was not accessible.</span></span>

<span data-ttu-id="2ae8c-171">После развертывания сайта в рабочей среде перейдите на рабочий сайт в браузере.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-171">Once the site has been deployed to production, visit the production site through your browser.</span></span> <span data-ttu-id="2ae8c-172">Вы должны увидеть тот же пользовательский интерфейс, что и при локальном запуске приложения, управляемого данными.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-172">You should see and enjoy the same user experience as when running the data-driven application locally.</span></span> <span data-ttu-id="2ae8c-173">Разумеется, при посещении веб-сайта в рабочей среде рабочий сервер базы данных, в то время как на веб-сайте среды разработки используется база данных для разработки.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-173">Of course when you visit the website on production the site is powered by the production database server, whereas visiting the website in the development environment uses the database in development.</span></span> <span data-ttu-id="2ae8c-174">На рис. 3 показана страница проверки *ASP.NET 3,5 в течение 24 часов* с веб-сайта в рабочей среде (Обратите внимание на URL-адрес в адресной строке браузера).</span><span class="sxs-lookup"><span data-stu-id="2ae8c-174">Figure 3 shows the *Teach Yourself ASP.NET 3.5 in 24 Hours* review page from the website in the production environment (note the URL in the browser s Address bar).</span></span>

<span data-ttu-id="2ae8c-175">[![приложение, управляемое данными, теперь доступно в рабочей среде.](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image8.jpg)](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image7.jpg)</span><span class="sxs-lookup"><span data-stu-id="2ae8c-175">[![The Data-Driven Application is Now Available On Production!](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image8.jpg)](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image7.jpg)</span></span> 

<span data-ttu-id="2ae8c-176">**Рис. 3**. приложение, управляемое данными, теперь доступно в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-176">**Figure 3**: The Data-Driven Application is Now Available On Production!</span></span> <span data-ttu-id="2ae8c-177">([Щелкните, чтобы просмотреть изображение с полным размером](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image9.jpg))</span><span class="sxs-lookup"><span data-stu-id="2ae8c-177">([Click to view full-size image](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image9.jpg))</span></span>

### <a name="storing-connection-strings-in-a-separate-configuration-file"></a><span data-ttu-id="2ae8c-178">Хранение строк подключения в отдельном файле конфигурации</span><span class="sxs-lookup"><span data-stu-id="2ae8c-178">Storing Connection Strings in a Separate Configuration File</span></span>

<span data-ttu-id="2ae8c-179">Распространенной методикой для поддержки отдельных сведений о конфигурации в средах разработки и рабочей среде являются две версии `Web.config`: одна для среды разработки, а другая — для рабочей.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-179">A common technique for maintaining separate configuration information on the development and production environments is to have two versions of the `Web.config`: one for the development environment and one for production.</span></span> <span data-ttu-id="2ae8c-180">Во время развертывания соответствующую версию `Web.config` можно скопировать в рабочую среду.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-180">At deploy-time the appropriate `Web.config` version can be copied to the production environment.</span></span> <span data-ttu-id="2ae8c-181">В идеале этот процесс будет автоматизирован в рамках рабочего процесса развертывания.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-181">Ideally, this process would be automated as part of the deployment workflow.</span></span>

<span data-ttu-id="2ae8c-182">Вместо поддержки двух отдельных файлов `Web.config` можно, при необходимости, предоставить более детализированные различия.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-182">Instead of maintaining two separate `Web.config` files you can, optionally, provide more granular differences.</span></span> <span data-ttu-id="2ae8c-183">Элементы, составляющие файл `Web.config`, можно определить во внешних файлах конфигурации, на которые затем ссылаются в файле `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-183">The elements that make up the `Web.config` file can be defined in an external configuration files that are then referenced in the `Web.config` file.</span></span> <span data-ttu-id="2ae8c-184">В двух словах, у обеих сред может быть один файл `Web.config`, который ссылается на файл Датабасеконнектионстрингс. config, который будет содержать строки подключения, используемые приложением, и будет уникальным для каждой среды.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-184">In a nutshell you can have one `Web.config` file for both environments that references a databaseConnectionStrings.config file, which would contain the connection strings used by the application and would be unique for each environment.</span></span> <span data-ttu-id="2ae8c-185">Я вижу, что разделение различных сведений о конфигурации на отдельные файлы предоставляет аккуратная и более простой файл `Web.config` и более четко описывает различия в конфигурации сред разработки и рабочей среды.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-185">I find that separating the differing configuration information into separate files provides a tidier and simpler `Web.config` file and more clearly outlines the configuration differences between the development and production environments.</span></span>

<span data-ttu-id="2ae8c-186">Чтобы использовать этот метод, начните с создания новой папки в веб-приложении с именем `ConfigSections`.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-186">To use this technique, start by creating a new folder in the web application named `ConfigSections`.</span></span> <span data-ttu-id="2ae8c-187">Затем добавьте два файла в эту новую папку с именем Датабасеконнектионстрингс. dev. config и Датабасеконнектионстрингс. Production. config. Затем скопируйте элемент `<connectionStrings>` из `Web.config` в файлы Датабасеконнектионстрингс. dev. config и Датабасеконнектионстрингс. Production. config, а затем измените строку подключения в файле Датабасеконнектионстрингс. Production. config, чтобы указать строку подключения к рабочей базе данных.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-187">Next, add two files to this new folder named databaseConnectionStrings.dev.config and databaseConnectionStrings.production.config. Next, copy the `<connectionStrings>` element from `Web.config` into the databaseConnectionStrings.dev.config and databaseConnectionStrings.production.config files, and then modify the connection string in the databaseConnectionStrings.production.config file so that it specifies the production database connection string.</span></span> <span data-ttu-id="2ae8c-188">Например, файл Датабасеконнектионстрингс. dev. config должен содержать только элемент `<connectionStrings>` со строкой подключения, которая ссылается на базу данных разработки:</span><span class="sxs-lookup"><span data-stu-id="2ae8c-188">For example, the databaseConnectionStrings.dev.config file should contain just the `<connectionStrings>` element with a connection string that references the development database:</span></span>

[!code-xml[Main](configuring-the-production-web-application-to-use-the-production-database-vb/samples/sample3.xml)]

<span data-ttu-id="2ae8c-189">Аналогичным образом файл Датабасеконнектионстрингс. Production. config должен содержать только элемент `<connectionStrings>`, но со строкой подключения к рабочей базе данных.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-189">Similarly, the databaseConnectionStrings.production.config file should contain just a `<connectionStrings>` element, but one that has the production database connection string.</span></span>

<span data-ttu-id="2ae8c-190">Создайте копию файла Датабасеконнектионстрингс. dev. config и назовите ее Датабасеконнектионстрингс. config.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-190">Make a copy of the databaseConnectionStrings.dev.config file and name it databaseConnectionStrings.config.</span></span>

> [!NOTE]
> <span data-ttu-id="2ae8c-191">Можно присвоить файлу конфигурации значение, отличное от Датабасеконнектионстрингс. config, если вы d Like, например `connectionStrings.config` или `dbInfo.config`.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-191">You can name the configuration file something other than databaseConnectionStrings.config, if you d like, such as `connectionStrings.config` or `dbInfo.config`.</span></span> <span data-ttu-id="2ae8c-192">Однако не забудьте присвоить файлу расширение `.config`, так как `.config` файлы по умолчанию не обслуживаются подсистемой ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-192">However, be sure to name the file with a `.config` extension as `.config` files are, by default, not served by the ASP.NET engine.</span></span> <span data-ttu-id="2ae8c-193">Если вы назначите файл в другом месте, например `connectionStrings.txt`, пользователь может указать обозревателю [www.yoursite.com/ConfigSettings/connectionStrings.txt](http://www.yoursite.com/ConfigSettings/connectionStrings.txt) и просмотреть содержимое файла!</span><span class="sxs-lookup"><span data-stu-id="2ae8c-193">If you name the file something else, like `connectionStrings.txt`, a user could point their browser to [www.yoursite.com/ConfigSettings/connectionStrings.txt](http://www.yoursite.com/ConfigSettings/connectionStrings.txt) and view the contents of the file!</span></span>

<span data-ttu-id="2ae8c-194">На этом этапе папка `ConfigSections` должна содержать три файла (см. рис. 4).</span><span class="sxs-lookup"><span data-stu-id="2ae8c-194">At this point the `ConfigSections` folder should contain three files (see Figure 4).</span></span> <span data-ttu-id="2ae8c-195">Файлы Датабасеконнектионстрингс. dev. config и Датабасеконнектионстрингс. Production. config содержат строки подключения для сред разработки и рабочей среды соответственно.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-195">The databaseConnectionStrings.dev.config and databaseConnectionStrings.production.config files contain the connection strings for the development and production environments, respectively.</span></span> <span data-ttu-id="2ae8c-196">Файл Датабасеконнектионстрингс. config содержит сведения строки подключения, которые будут использоваться веб-приложением во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-196">The databaseConnectionStrings.config file contains the connection string information that will be used by the web application at runtime.</span></span> <span data-ttu-id="2ae8c-197">Следовательно, файл Датабасеконнектионстрингс. config должен быть идентичен файлу Датабасеконнектионстрингс. dev. config в среде разработки, в то время как в производстве файл Датабасеконнектионстрингс. config должен быть идентичен Датабасеконнектионстрингс. Production. config.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-197">Consequently, the databaseConnectionStrings.config file should be identical to the databaseConnectionStrings.dev.config file in the development environment, whereas on production the databaseConnectionStrings.config file should be identical to databaseConnectionStrings.production.config.</span></span>

<span data-ttu-id="2ae8c-198">[![ConfigSections](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image11.jpg)](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image10.jpg)</span><span class="sxs-lookup"><span data-stu-id="2ae8c-198">[![ConfigSections](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image11.jpg)](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image10.jpg)</span></span> 

<span data-ttu-id="2ae8c-199">**Рисунок 4**. ConfigSections ([щелкните, чтобы просмотреть изображение с полным размером](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image12.jpg))</span><span class="sxs-lookup"><span data-stu-id="2ae8c-199">**Figure 4**: ConfigSections ([Click to view full-size image](configuring-the-production-web-application-to-use-the-production-database-vb/_static/image12.jpg))</span></span>

<span data-ttu-id="2ae8c-200">Теперь необходимо указать `Web.config` использовать файл Датабасеконнектионстрингс. config для хранилища строк подключения.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-200">We now need to instruct `Web.config` to use the databaseConnectionStrings.config file for its connection string store.</span></span> <span data-ttu-id="2ae8c-201">Откройте файл `Web.config` и замените существующий элемент `<connectionStrings>` следующим кодом:</span><span class="sxs-lookup"><span data-stu-id="2ae8c-201">Open `Web.config` and replace the existing `<connectionStrings>` element with the following:</span></span>

[!code-xml[Main](configuring-the-production-web-application-to-use-the-production-database-vb/samples/sample4.xml)]

<span data-ttu-id="2ae8c-202">Атрибут `configSource` задает физический путь относительно файла `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-202">The `configSource` attribute specifies a physical path relative to the `Web.config` file.</span></span> <span data-ttu-id="2ae8c-203">Если внешний `.config` файл находится в том же каталоге, что и `Web.config`, присвойте этому атрибуту имя файла `.config`.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-203">If the external `.config` file is in the same directory as `Web.config` then set this attribute to the file name of the `.config` file.</span></span> <span data-ttu-id="2ae8c-204">Если он находится в подкаталоге, как в случае с Датабасеконнектионстрингс. config, укажите подпапку с помощью обратной косой черты, чтобы разделить имена папок и файлов, например Конфигсектионс\датабасеконнектионстрингс.Конфиг.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-204">If it s in a subdirectory, as is the case with databaseConnectionStrings.config, specify the subfolder using a backslash to delimit the folder and file names, like ConfigSections\databaseConnectionStrings.config.</span></span>

<span data-ttu-id="2ae8c-205">При таком изменении среды разработки и рабочей среде содержат один и тот же файл `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-205">With this modification, the development and production environments contain the same `Web.config` file.</span></span> <span data-ttu-id="2ae8c-206">Теперь единственным отличием является файл Датабасеконнектионстрингс. config.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-206">Now the only difference is the databaseConnectionStrings.config file.</span></span> <span data-ttu-id="2ae8c-207">Скопируйте файл Датабасеконнектионстрингс. Production. config в рабочую среду и переименуйте его в Датабасеконнектионстрингс. config. Если в будущем в строке подключения к рабочей базе данных будут внесены изменения, необходимо внести их в файл Датабасеконнектионстрингс. Production. config, а затем передать этот файл в рабочую среду, переименовав его Датабасеконнектионстрингс. config.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-207">Copy the databaseConnectionStrings.production.config file to production and rename it to databaseConnectionStrings.config. If, in the future, there are changes to the production database connection string you will need to make them to the databaseConnectionStrings.production.config file and then upload that file to production, renaming it databaseConnectionStrings.config.</span></span>

> [!NOTE]
> <span data-ttu-id="2ae8c-208">Можно указать сведения для любого элемента `Web.config` в отдельном файле и использовать атрибут `configSource` для ссылки на этот файл из `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-208">You may specify the information for any `Web.config` element in a separate file and use the `configSource` attribute to reference that file from within `Web.config`.</span></span>

## <a name="summary"></a><span data-ttu-id="2ae8c-209">Сводка</span><span class="sxs-lookup"><span data-stu-id="2ae8c-209">Summary</span></span>

<span data-ttu-id="2ae8c-210">Приложения, управляемые данными, обычно используют разные базы данных в средах разработки и рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-210">Data-driven applications usually use different databases in the development and production environments.</span></span> <span data-ttu-id="2ae8c-211">Следовательно, строки подключения к базе данных, которые хранятся в конфигурации веб-приложения, должны быть уникальными для каждой среды.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-211">Consequently, the database connection strings stored in the web application s configuration must be unique per environment.</span></span> <span data-ttu-id="2ae8c-212">В этом учебнике мы рассмотрели, как определить строку подключения к рабочей базе данных и способы сохранения уникальных данных строки подключения в двух средах.</span><span class="sxs-lookup"><span data-stu-id="2ae8c-212">In this tutorial we looked at how to determine the production database connection string and ways to maintain unique connection string information in the two environments.</span></span>

<span data-ttu-id="2ae8c-213">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="2ae8c-213">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="2ae8c-214">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="2ae8c-214">Further Reading</span></span>

<span data-ttu-id="2ae8c-215">Дополнительные сведения о разделах, обсуждаемых в этом руководстве, см. в следующих ресурсах:</span><span class="sxs-lookup"><span data-stu-id="2ae8c-215">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="2ae8c-216">Строки подключения и файлы конфигурации</span><span class="sxs-lookup"><span data-stu-id="2ae8c-216">Connection Strings and Configuration Files</span></span>](https://msdn.microsoft.com/library/ms254494.aspx)
- [<span data-ttu-id="2ae8c-217">Сведения о строках конфигурации базы данных @ ConnectionStrings.com</span><span class="sxs-lookup"><span data-stu-id="2ae8c-217">Database Configuration Strings Information @ ConnectionStrings.com</span></span>](http://www.connectionstrings.com/)
- [<span data-ttu-id="2ae8c-218">Переместить параметры из файла Web. config</span><span class="sxs-lookup"><span data-stu-id="2ae8c-218">Move Settings Out of the Web.config File</span></span>](http://www.asp101.com/tips/index.asp?id=154)
- [<span data-ttu-id="2ae8c-219">Техническая документация по &lt;connectionString&gt; element</span><span class="sxs-lookup"><span data-stu-id="2ae8c-219">Technical Documentation for the &lt;connectionStrings&gt; Element</span></span>](https://msdn.microsoft.com/library/bf7sd233.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="2ae8c-220">[Назад](deploying-a-database-vb.md)
> [Вперед](configuring-a-website-that-uses-application-services-vb.md)</span><span class="sxs-lookup"><span data-stu-id="2ae8c-220">[Previous](deploying-a-database-vb.md)
[Next](configuring-a-website-that-uses-application-services-vb.md)</span></span>
