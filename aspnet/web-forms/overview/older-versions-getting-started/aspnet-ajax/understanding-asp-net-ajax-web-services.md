---
uid: web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-asp-net-ajax-web-services
title: Основные сведения о веб-служб ASP.NET AJAX | Документация Майкрософт
author: scottcate
description: Веб-служб являются неотъемлемой частью платформы .NET framework, которые обеспечивают кроссплатформенного решения для обмена данными между распределенных систем. Несмотря на то что Web...
ms.author: riande
ms.date: 03/28/2008
ms.assetid: 3332d6e7-e2e1-4144-b805-e71d51e7e415
msc.legacyurl: /web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-asp-net-ajax-web-services
msc.type: authoredcontent
ms.openlocfilehash: e576e11d63f940f1683ed26d217ff255a31b007c
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59388417"
---
# <a name="understanding-aspnet-ajax-web-services"></a><span data-ttu-id="5004c-104">Общие сведения о веб-службах ASP.NET AJAX</span><span class="sxs-lookup"><span data-stu-id="5004c-104">Understanding ASP.NET AJAX Web Services</span></span>

<span data-ttu-id="5004c-105">по [(Scott cate)](https://github.com/scottcate)</span><span class="sxs-lookup"><span data-stu-id="5004c-105">by [Scott Cate](https://github.com/scottcate)</span></span>

[<span data-ttu-id="5004c-106">Загрузить PDF-файл</span><span class="sxs-lookup"><span data-stu-id="5004c-106">Download PDF</span></span>](http://download.microsoft.com/download/C/1/9/C19A3451-1D14-477C-B703-54EF22E197EE/AJAX_tutorial05_Web_Services_with_MS_Ajax_cs.pdf)

> <span data-ttu-id="5004c-107">Веб-служб являются неотъемлемой частью платформы .NET framework, которые обеспечивают кроссплатформенного решения для обмена данными между распределенных систем.</span><span class="sxs-lookup"><span data-stu-id="5004c-107">Web Services are an integral part of the .NET framework that provide a cross-platform solution for exchanging data between distributed systems.</span></span> <span data-ttu-id="5004c-108">Несмотря на то, что веб-службы обычно используются для разрешения разных операционных систем, объектных моделей и языков программирования для отправки и получения данных, они также могут использоваться для динамически Вставка данных в странице ASP.NET AJAX или отправлять данные со страницы в обслуживающей системе.</span><span class="sxs-lookup"><span data-stu-id="5004c-108">Although Web Services are normally used to allow different operating systems, object models and programming languages to send and receive data, they can also be used to dynamically inject data into an ASP.NET AJAX page or send data from a page to a back-end system.</span></span> <span data-ttu-id="5004c-109">Все это можно сделать, не прибегая к обратной передаче операции.</span><span class="sxs-lookup"><span data-stu-id="5004c-109">All of this can be done without resorting to postback operations.</span></span>


## <a name="calling-web-services-with-aspnet-ajax"></a><span data-ttu-id="5004c-110">Вызов веб-служб с помощью ASP.NET AJAX</span><span class="sxs-lookup"><span data-stu-id="5004c-110">Calling Web Services with ASP.NET AJAX</span></span>

<span data-ttu-id="5004c-111">Дэна Вахлина</span><span class="sxs-lookup"><span data-stu-id="5004c-111">Dan Wahlin</span></span>

<span data-ttu-id="5004c-112">Веб-служб являются неотъемлемой частью платформы .NET framework, которые обеспечивают кроссплатформенного решения для обмена данными между распределенных систем.</span><span class="sxs-lookup"><span data-stu-id="5004c-112">Web Services are an integral part of the .NET framework that provide a cross-platform solution for exchanging data between distributed systems.</span></span> <span data-ttu-id="5004c-113">Несмотря на то, что веб-службы обычно используются для разрешения разных операционных систем, объектных моделей и языков программирования для отправки и получения данных, они также могут использоваться для динамически Вставка данных в странице ASP.NET AJAX или отправлять данные со страницы в обслуживающей системе.</span><span class="sxs-lookup"><span data-stu-id="5004c-113">Although Web Services are normally used to allow different operating systems, object models and programming languages to send and receive data, they can also be used to dynamically inject data into an ASP.NET AJAX page or send data from a page to a back-end system.</span></span> <span data-ttu-id="5004c-114">Все это можно сделать, не прибегая к обратной передаче операции.</span><span class="sxs-lookup"><span data-stu-id="5004c-114">All of this can be done without resorting to postback operations.</span></span>

<span data-ttu-id="5004c-115">Хотя элемент управления ASP.NET AJAX UpdatePanel предоставляет простой способ AJAX включить любой страницы ASP.NET, могут возникнуть ситуации, когда необходимо динамически получить доступ к данным на сервере без использования элемента управления UpdatePanel.</span><span class="sxs-lookup"><span data-stu-id="5004c-115">While the ASP.NET AJAX UpdatePanel control provides a simple way to AJAX enable any ASP.NET page, there may be times when you need to dynamically access data on the server without using an UpdatePanel.</span></span> <span data-ttu-id="5004c-116">В этой статье вы увидите, как выполнить эту задачу путем создания и использования веб-служб в пределах страницы ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="5004c-116">In this article you'll see how to accomplish this by creating and consuming Web Services within ASP.NET AJAX pages.</span></span>

<span data-ttu-id="5004c-117">В этой статье основное внимание уделяется функциям, доступным в расширения AJAX для ASP.NET core, а также элемент управления веб-службы, которые включены в наборе средств AJAX ASP.NET, вызывается AutoCompleteExtender.</span><span class="sxs-lookup"><span data-stu-id="5004c-117">This article will focus on functionality available in the core ASP.NET AJAX Extensions as well as a Web Service enabled control in the ASP.NET AJAX Toolkit called the AutoCompleteExtender.</span></span> <span data-ttu-id="5004c-118">Рассматриваются определение веб-служб с поддержкой AJAX, создания клиентских прокси-серверы и вызова веб-служб с помощью JavaScript.</span><span class="sxs-lookup"><span data-stu-id="5004c-118">Topics covered include defining AJAX-enabled Web Services, creating client proxies and calling Web Services with JavaScript.</span></span> <span data-ttu-id="5004c-119">Вы также увидите, как веб-службы можно вызывать напрямую методы страниц ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="5004c-119">You'll also see how Web Service calls can be made directly to ASP.NET page methods.</span></span>

## <a name="web-services-configuration"></a><span data-ttu-id="5004c-120">Настройка веб-служб</span><span class="sxs-lookup"><span data-stu-id="5004c-120">Web Services Configuration</span></span>

<span data-ttu-id="5004c-121">При создании нового проекта веб-сайта с помощью Visual Studio 2008 в файле web.config имеет ряд дополнений, которые могут быть знакомы пользователям предыдущих версий Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5004c-121">When a new Web Site project is created with Visual Studio 2008, the web.config file has a number of new additions that may be unfamiliar to users of previous versions of Visual Studio.</span></span> <span data-ttu-id="5004c-122">Некоторые из этих изменений сопоставить префикс «asp» к элементам управления ASP.NET AJAX, чтобы можно было использовать на страницах, если другие определяют обязательные HttpHandlers и HttpModules.</span><span class="sxs-lookup"><span data-stu-id="5004c-122">Some of these modifications map the "asp" prefix to ASP.NET AJAX controls so they can be used in pages while others define required HttpHandlers and HttpModules.</span></span> <span data-ttu-id="5004c-123">В листинге 1 показан изменения, внесенные в `<httpHandlers>` элемент в файле web.config, влияющим на вызовы веб-службы.</span><span class="sxs-lookup"><span data-stu-id="5004c-123">Listing 1 shows modifications made to the `<httpHandlers>` element in web.config that affects Web Service calls.</span></span> <span data-ttu-id="5004c-124">По умолчанию, используемые HttpHandler для обработки вызовов .asmx удаляется и заменяется ScriptHandlerFactory класс находится в сборке System.Web.Extensions.dll.</span><span class="sxs-lookup"><span data-stu-id="5004c-124">The default HttpHandler used to process .asmx calls is removed and replaced with a ScriptHandlerFactory class located in the System.Web.Extensions.dll assembly.</span></span> <span data-ttu-id="5004c-125">System.Web.Extensions.dll содержит все основные функциональные возможности, используемые ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="5004c-125">System.Web.Extensions.dll contains all of the core functionality used by ASP.NET AJAX.</span></span>

<span data-ttu-id="5004c-126">**Листинг 1. Конфигурация обработчик ASP.NET AJAX веб-службы**</span><span class="sxs-lookup"><span data-stu-id="5004c-126">**Listing 1. ASP.NET AJAX Web Service Handler Configuration**</span></span>

[!code-xml[Main](understanding-asp-net-ajax-web-services/samples/sample1.xml)]

<span data-ttu-id="5004c-127">Этот обработчик HttpHandler замещения чтобы разрешить вызовы JavaScript Object Notation (JSON) предприниматься из страницы ASP.NET AJAX для веб-служб .NET через прокси JavaScript веб-службы.</span><span class="sxs-lookup"><span data-stu-id="5004c-127">This HttpHandler replacement is made in order to allow JavaScript Object Notation (JSON) calls to be made from ASP.NET AJAX pages to .NET Web Services using a JavaScript Web Service proxy.</span></span> <span data-ttu-id="5004c-128">AJAX для ASP.NET отправляет сообщения JSON веб-служб в отличие от стандартных вызовов Simple Object Access Protocol (SOAP), обычно связаны с веб-служб.</span><span class="sxs-lookup"><span data-stu-id="5004c-128">ASP.NET AJAX sends JSON messages to Web Services as opposed to the standard Simple Object Access Protocol (SOAP) calls typically associated with Web Services.</span></span> <span data-ttu-id="5004c-129">Это приводит небольших запросов и общую сообщений-ответов.</span><span class="sxs-lookup"><span data-stu-id="5004c-129">This results in smaller request and response messages overall.</span></span> <span data-ttu-id="5004c-130">Он также позволяет более эффективную обработку на стороне клиента данных так, как библиотека ASP.NET AJAX JavaScript оптимизирована для работы с объектами JSON.</span><span class="sxs-lookup"><span data-stu-id="5004c-130">It also allows for more efficient client-side processing of data since the ASP.NET AJAX JavaScript library is optimized to work with JSON objects.</span></span> <span data-ttu-id="5004c-131">Листинг 2 и листинге 3 Показать примеры веб-службы сообщений запросов и ответов сериализации в формат JSON.</span><span class="sxs-lookup"><span data-stu-id="5004c-131">Listing 2 and Listing 3 show examples of Web Service request and response messages serialized to JSON format.</span></span> <span data-ttu-id="5004c-132">Сообщение запроса, показанный в листинге 2 передает параметра страны со значением «Бельгия», а ответное сообщение в листинге 3 передает массив объектов клиента и связанные с ними свойства.</span><span class="sxs-lookup"><span data-stu-id="5004c-132">The request message shown in Listing 2 passes a country parameter with a value of "Belgium" while the response message in Listing 3 passes an array of Customer objects and their associated properties.</span></span>

<span data-ttu-id="5004c-133">**Листинг 2. Сообщения запроса веб-службы сериализации в JSON**</span><span class="sxs-lookup"><span data-stu-id="5004c-133">**Listing 2. Web Service Request Message Serialized to JSON**</span></span>

[!code-json[Main](understanding-asp-net-ajax-web-services/samples/sample2.json)]

> <span data-ttu-id="5004c-134">*> [!NOTE] Имя операции, определяется как часть URL-адрес веб-службы; Кроме того запросы всегда отправляются через JSON. Веб-службы можно использовать атрибут ScriptMethod с параметром UseHttpGet значение true, в результате чего параметры для передачи через параметры строки запроса.*</span><span class="sxs-lookup"><span data-stu-id="5004c-134">*> [!NOTE] the operation name is defined as part of the URL to the web service; additionally, request messages are not always submitted via JSON. Web Services can utilize the ScriptMethod attribute with the UseHttpGet parameter set to true, which causes parameters to be passed via a the query string parameters.*</span></span>


<span data-ttu-id="5004c-135">**Листинг 3. Сообщения ответа веб-службы сериализации в JSON**</span><span class="sxs-lookup"><span data-stu-id="5004c-135">**Listing 3. Web Service Response Message Serialized to JSON**</span></span>

[!code-json[Main](understanding-asp-net-ajax-web-services/samples/sample3.json)]

<span data-ttu-id="5004c-136">В следующем разделе вы узнаете, как создавать веб-службы для обработки сообщения запроса JSON и отвечать на запросы с помощью простых и сложных типов.</span><span class="sxs-lookup"><span data-stu-id="5004c-136">In the next section you'll see how to create Web Services capable of handling JSON request messages and responding with both simple and complex types.</span></span>

## <a name="creating-ajax-enabled-web-services"></a><span data-ttu-id="5004c-137">Создании поддерживающих AJAX веб-служб</span><span class="sxs-lookup"><span data-stu-id="5004c-137">Creating AJAX-Enabled Web Services</span></span>

<span data-ttu-id="5004c-138">Платформа AJAX для ASP.NET предоставляет несколько разных способов для вызова веб-служб.</span><span class="sxs-lookup"><span data-stu-id="5004c-138">The ASP.NET AJAX framework provides several different ways to call Web Services.</span></span> <span data-ttu-id="5004c-139">Можно использовать элемент управления AutoCompleteExtender (доступно в наборе средств AJAX ASP.NET) или JavaScript.</span><span class="sxs-lookup"><span data-stu-id="5004c-139">You can use the AutoCompleteExtender control (available in the ASP.NET AJAX Toolkit) or JavaScript.</span></span> <span data-ttu-id="5004c-140">Тем не менее перед вызовом службы AJAX, обеспечив он имеется, может быть вызвана код клиентского скрипта.</span><span class="sxs-lookup"><span data-stu-id="5004c-140">However, before calling a service you have to AJAX-enable it so that it can be called by client-script code.</span></span>

<span data-ttu-id="5004c-141">Ли вы не знакомы с веб-служб ASP.NET, вы найдете его легко создавать и службы с поддержкой AJAX.</span><span class="sxs-lookup"><span data-stu-id="5004c-141">Whether or not you're new to ASP.NET Web Services, you'll find it straightforward to create and AJAX-enable services.</span></span> <span data-ttu-id="5004c-142">.NET framework поддерживала Создание веб-служб ASP.NET с момента своего появления в 2002 г. и расширения AJAX для ASP.NET обеспечивают дополнительные функциональные возможности AJAX, который построен на основе платформы .NET framework по умолчанию набором функций.</span><span class="sxs-lookup"><span data-stu-id="5004c-142">The .NET framework has supported the creation of ASP.NET Web Services since its initial release in 2002 and the ASP.NET AJAX Extensions provide additional AJAX functionality that builds upon the .NET framework's default set of features.</span></span> <span data-ttu-id="5004c-143">Visual Studio .NET 2008 бета-версии 2 имеет встроенную поддержку для создания веб-службы файлы .asmx и автоматически наследует класс System.Web.Services.WebService соответствующий код рядом с классами.</span><span class="sxs-lookup"><span data-stu-id="5004c-143">Visual Studio .NET 2008 Beta 2 has built-in support for creating .asmx Web Service files and automatically derives associated code beside classes from the System.Web.Services.WebService class.</span></span> <span data-ttu-id="5004c-144">Как добавить методы в класс необходимо применить атрибут WebMethod, они должна вызываться потребителей веб-службы.</span><span class="sxs-lookup"><span data-stu-id="5004c-144">As you add methods into the class you must apply the WebMethod attribute in order for them to be called by Web Service consumers.</span></span>

<span data-ttu-id="5004c-145">В листинге 4 показан пример применения атрибут WebMethod метод с именем GetCustomersByCountry().</span><span class="sxs-lookup"><span data-stu-id="5004c-145">Listing 4 shows an example of applying the WebMethod attribute to a method named GetCustomersByCountry().</span></span>

<span data-ttu-id="5004c-146">**Листинг 4. С помощью атрибута WebMethod для веб-службы**</span><span class="sxs-lookup"><span data-stu-id="5004c-146">**Listing 4. Using the WebMethod Attribute in a Web Service**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample4.cs)]

<span data-ttu-id="5004c-147">Метод GetCustomersByCountry() принимает параметр страны и возвращает массив объектов клиента.</span><span class="sxs-lookup"><span data-stu-id="5004c-147">The GetCustomersByCountry() method accepts a country parameter and returns a Customer object array.</span></span> <span data-ttu-id="5004c-148">Значение страны, передаваемый в метод передается класс слоя бизнес, который в свою очередь вызывает класс уровень данных для получения данных из базы данных, заполнить свойства объекта клиента с данными и возвращать массив.</span><span class="sxs-lookup"><span data-stu-id="5004c-148">The country value passed into the method is forwarded to a business layer class which in turn calls a data layer class to retrieve the data from the database, fill the Customer object properties with data and return the array.</span></span>

## <a name="using-the-scriptservice-attribute"></a><span data-ttu-id="5004c-149">С помощью атрибута ScriptService</span><span class="sxs-lookup"><span data-stu-id="5004c-149">Using the ScriptService Attribute</span></span>

<span data-ttu-id="5004c-150">При добавлении WebMethod, атрибут позволяет GetCustomersByCountry() метод, вызываемый клиенты, отправляющие стандартные сообщения SOAP в веб-службу, он не допускает вызовов JSON из приложений ASP.NET AJAX без дополнительной настройки.</span><span class="sxs-lookup"><span data-stu-id="5004c-150">While adding the WebMethod attribute allows the GetCustomersByCountry() method to be called by clients that send standard SOAP messages to the Web Service, it doesn't allow JSON calls to be made from ASP.NET AJAX applications out of the box.</span></span> <span data-ttu-id="5004c-151">Чтобы разрешить применение расширения AJAX ASP.NET, что делать вызовы JSON `ScriptService` атрибута к классу веб-службы.</span><span class="sxs-lookup"><span data-stu-id="5004c-151">To allow JSON calls to be made you have to apply the ASP.NET AJAX Extension's `ScriptService` attribute to the Web Service class.</span></span> <span data-ttu-id="5004c-152">Это позволяет веб-службы для отправки сообщений-ответов в формате с помощью JSON и скрипт на стороне клиента для вызова службы, отправляя сообщения JSON.</span><span class="sxs-lookup"><span data-stu-id="5004c-152">This enables a Web Service to send response messages formatted using JSON and allows client-side script to call a service by sending JSON messages.</span></span>

<span data-ttu-id="5004c-153">В листинге 5 показан пример применения атрибута ScriptService к классу веб-службы с именем CustomersService.</span><span class="sxs-lookup"><span data-stu-id="5004c-153">Listing 5 shows an example of applying the ScriptService attribute to a Web Service class named CustomersService.</span></span>

<span data-ttu-id="5004c-154">**Листинг 5. С помощью атрибута ScriptService на веб-службы с поддержкой AJAX**</span><span class="sxs-lookup"><span data-stu-id="5004c-154">**Listing 5. Using the ScriptService Attribute to AJAX-enable a Web Service**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample5.cs)]

<span data-ttu-id="5004c-155">Атрибут ScriptService действует как маркер, который указывает, что он может вызываться из кода сценария AJAX.</span><span class="sxs-lookup"><span data-stu-id="5004c-155">The ScriptService attribute acts as a marker that indicates it can be called from AJAX script code.</span></span> <span data-ttu-id="5004c-156">Он не обрабатывает фактически любой задачи сериализации или десериализации JSON, которые возникают в фоновом.</span><span class="sxs-lookup"><span data-stu-id="5004c-156">It doesn't actually handle any of the JSON serialization or deserialization tasks that occur behind the scenes.</span></span> <span data-ttu-id="5004c-157">ScriptHandlerFactory, (настраивается в файле web.config) и другие классы и выполняют основную часть обработки JSON.</span><span class="sxs-lookup"><span data-stu-id="5004c-157">The ScriptHandlerFactory (configured in web.config) and other related classes do the bulk of JSON processing.</span></span>

## <a name="using-the-scriptmethod-attribute"></a><span data-ttu-id="5004c-158">С помощью атрибута ScriptMethod</span><span class="sxs-lookup"><span data-stu-id="5004c-158">Using the ScriptMethod Attribute</span></span>

<span data-ttu-id="5004c-159">Атрибут ScriptService является единственным атрибутом ASP.NET AJAX, который должен быть определен в веб-службы .NET для его для использования страниц ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="5004c-159">The ScriptService attribute is the only ASP.NET AJAX attribute that has to be defined in a .NET Web Service in order for it to be used by ASP.NET AJAX pages.</span></span> <span data-ttu-id="5004c-160">Тем не менее другой атрибут с именем ScriptMethod также может применяться непосредственно к веб-методы в службе.</span><span class="sxs-lookup"><span data-stu-id="5004c-160">However, another attribute named ScriptMethod can also be applied directly to Web Methods in a service.</span></span> <span data-ttu-id="5004c-161">ScriptMethod определены три свойства, в том числе `UseHttpGet`, `ResponseFormat` и `XmlSerializeString`.</span><span class="sxs-lookup"><span data-stu-id="5004c-161">ScriptMethod defines three properties including `UseHttpGet`, `ResponseFormat` and `XmlSerializeString`.</span></span> <span data-ttu-id="5004c-162">Изменение значения этих свойств может быть полезно в случаях, где требуется сменить GET, пока веб-метод должен возвращать необработанные данные XML в виде типа запрос принят методом веб- `XmlDocument` или `XmlElement` объекта или при возвращении данных из  службы всегда должно быть сериализовано как XML вместо JSON.</span><span class="sxs-lookup"><span data-stu-id="5004c-162">Changing the values of these properties can be useful in cases where the type of request accepted by a Web Method needs to be changed to GET, when a Web Method needs to return raw XML data in the form of an `XmlDocument` or `XmlElement` object or when data returned from a service should always be serialized as XML instead of JSON.</span></span>

<span data-ttu-id="5004c-163">UseHttpGet, свойство может использоваться при веб-метод должен принимать получение запросов, в отличие от запросов POST.</span><span class="sxs-lookup"><span data-stu-id="5004c-163">The UseHttpGet property can be used when a Web Method should accept GET requests as opposed to POST requests.</span></span> <span data-ttu-id="5004c-164">Запросы, отправляемые с помощью URL-адрес с входными параметрами веб-метода, переведенную в параметры строки запроса.</span><span class="sxs-lookup"><span data-stu-id="5004c-164">Requests are sent using a URL with Web Method input parameters converted to QueryString parameters.</span></span> <span data-ttu-id="5004c-165">UseHttpGet свойство по умолчанию равно false и только следует установить значение `true` при операции известно, что оказываются надежными, а также когда конфиденциальные данные не передается на веб-службу.</span><span class="sxs-lookup"><span data-stu-id="5004c-165">The UseHttpGet property defaults to false and should only be set to `true` when operations are known to be safe and when sensitive data is not passed to a Web Service.</span></span> <span data-ttu-id="5004c-166">В листинге 6 показан пример использования данного атрибута ScriptMethod со свойством UseHttpGet.</span><span class="sxs-lookup"><span data-stu-id="5004c-166">Listing 6 shows an example of using the ScriptMethod attribute with the UseHttpGet property.</span></span>

<span data-ttu-id="5004c-167">**Листинг 6. Используя атрибут ScriptMethod со свойством UseHttpGet.**</span><span class="sxs-lookup"><span data-stu-id="5004c-167">**Listing 6. Using the ScriptMethod attribute with the UseHttpGet property.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample6.cs)]

<span data-ttu-id="5004c-168">Пример заголовков, отправляется, когда вызывается метод веб-HttpGetEcho, показано в листинге 6 показаны далее:</span><span class="sxs-lookup"><span data-stu-id="5004c-168">An example of the headers sent when the HttpGetEcho Web Method shown in Listing 6 is called are shown next:</span></span>

`GET /CustomerViewer/DemoService.asmx/HttpGetEcho?input=%22Input Value%22 HTTP/1.1`

<span data-ttu-id="5004c-169">Кроме веб-методы принимать запросы HTTP GET, атрибут ScriptMethod можно также использовать при XML-ответов должны быть возвращены из службы, а не JSON.</span><span class="sxs-lookup"><span data-stu-id="5004c-169">In addition to allowing Web Methods to accept HTTP GET requests, the ScriptMethod attribute can also be used when XML responses need to be returned from a service rather than JSON.</span></span> <span data-ttu-id="5004c-170">Например веб-службы может получить RSS-канал с удаленного узла и возвращения в качестве объекта XmlDocument или XmlElement.</span><span class="sxs-lookup"><span data-stu-id="5004c-170">For example, a Web Service may retrieve an RSS feed from a remote site and return it as an XmlDocument or XmlElement object.</span></span> <span data-ttu-id="5004c-171">Обработка XML-данных затем наблюдается на стороне клиента.</span><span class="sxs-lookup"><span data-stu-id="5004c-171">Processing of the XML data can then occur on the client.</span></span>

<span data-ttu-id="5004c-172">Листинг 7 показан пример использования свойство ResponseFormat, чтобы указать, что XML-данные будут возвращены из веб-метода.</span><span class="sxs-lookup"><span data-stu-id="5004c-172">Listing 7 shows an example of using the ResponseFormat property to specify that XML data should be returned from a Web Method.</span></span>

<span data-ttu-id="5004c-173">**Листинг 7. Используя атрибут ScriptMethod со свойством ResponseFormat.**</span><span class="sxs-lookup"><span data-stu-id="5004c-173">**Listing 7. Using the ScriptMethod attribute with the ResponseFormat property.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample7.cs)]

<span data-ttu-id="5004c-174">Свойство ResponseFormat может также использоваться вместе со свойством XmlSerializeString.</span><span class="sxs-lookup"><span data-stu-id="5004c-174">The ResponseFormat property can also be used along with the XmlSerializeString property.</span></span> <span data-ttu-id="5004c-175">Свойство XmlSerializeString имеет значение по умолчанию false, это означает, что все возвращаемые типы, за исключением строк, возвращаемых из веб-метода сериализуются в формат XML при `ResponseFormat` свойству `ResponseFormat.Xml`.</span><span class="sxs-lookup"><span data-stu-id="5004c-175">The XmlSerializeString property has a default value of false which means that all return types except strings returned from a Web Method are serialized as XML when the `ResponseFormat` property is set to `ResponseFormat.Xml`.</span></span> <span data-ttu-id="5004c-176">Когда `XmlSerializeString` присваивается `true`, все типы, возвращаемые из веб-метода сериализуются как XML, включая строковые типы.</span><span class="sxs-lookup"><span data-stu-id="5004c-176">When `XmlSerializeString` is set to `true`, all types returned from a Web Method are serialized as XML including string types.</span></span> <span data-ttu-id="5004c-177">Если свойство ResponseFormat имеет значение `ResponseFormat.Json` XmlSerializeString свойство учитывается.</span><span class="sxs-lookup"><span data-stu-id="5004c-177">If the ResponseFormat property has a value of `ResponseFormat.Json` the XmlSerializeString property is ignored.</span></span>

<span data-ttu-id="5004c-178">Листинг 8 показывает пример использования свойства XmlSerializeString для принудительного строк должно быть сериализовано как XML.</span><span class="sxs-lookup"><span data-stu-id="5004c-178">Listing 8 shows an example of using the XmlSerializeString property to force strings to be serialized as XML.</span></span>

<span data-ttu-id="5004c-179">**Листинг 8. Используя атрибут ScriptMethod со свойством XmlSerializeString**</span><span class="sxs-lookup"><span data-stu-id="5004c-179">**Listing 8. Using the ScriptMethod attribute with the XmlSerializeString property**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample8.cs)]

<span data-ttu-id="5004c-180">Значение, возвращаемое из вызова метода веб-GetXmlString, показано в листинге 8 показан далее:</span><span class="sxs-lookup"><span data-stu-id="5004c-180">The value returned from calling the GetXmlString Web Method shown in Listing 8 is shown next:</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample9.cs)]

<span data-ttu-id="5004c-181">Несмотря на то, что формат JSON по умолчанию сокращает общий размер сообщения запроса и ответа и более эффективно используется ASP.NET AJAX клиентами в определенном обозреватели, могут быть свойства ResponseFormat и XmlSerializeString используются, когда клиент приложения, такие как Internet Explorer 5 или более поздней версии ожидают XML-данных, возвращаемых методом веб.</span><span class="sxs-lookup"><span data-stu-id="5004c-181">Although the default JSON format minimizes the overall size of request and response messages and is more readily consumed by ASP.NET AJAX clients in a cross-browser manner, the ResponseFormat and XmlSerializeString properties can be utilized when client applications such as Internet Explorer 5 or higher expect XML data to be returned from a Web Method.</span></span>

## <a name="working-with-complex-types"></a><span data-ttu-id="5004c-182">Работа со сложными типами</span><span class="sxs-lookup"><span data-stu-id="5004c-182">Working with Complex Types</span></span>

<span data-ttu-id="5004c-183">В листинге 5 был приведен пример возвращает сложный тип с именем Customer из веб-службы.</span><span class="sxs-lookup"><span data-stu-id="5004c-183">Listing 5 showed an example of returning a complex type named Customer from a Web Service.</span></span> <span data-ttu-id="5004c-184">Классу "Customer" определяет несколько различных типов простой внутренне как свойства, такие как FirstName и LastName.</span><span class="sxs-lookup"><span data-stu-id="5004c-184">The Customer class defines several different simple types internally as properties such as FirstName and LastName.</span></span> <span data-ttu-id="5004c-185">Сложные типы, используемые в качестве входного параметра или тип возвращаемого значения для метода с поддержкой AJAX Web автоматически сериализуется в JSON перед отправкой на стороне клиента.</span><span class="sxs-lookup"><span data-stu-id="5004c-185">Complex types used as an input parameter or return type on an AJAX-enabled Web Method are automatically serialized into JSON before being sent to the client-side.</span></span> <span data-ttu-id="5004c-186">Тем не менее вложенные сложные типы (наборы, определенные внутри внутри другого типа) не становятся доступными клиенту качестве автономных объектов по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="5004c-186">However, nested complex types (those defined internally within another type) are not made available to the client as standalone objects by default.</span></span>

<span data-ttu-id="5004c-187">В случаях, где вложенным сложным типом, используемые веб-службы также должно использоваться страницей клиента можно добавить атрибут ASP.NET AJAX GenerateScriptType в веб-службу.</span><span class="sxs-lookup"><span data-stu-id="5004c-187">In cases where a nested complex type used by a Web Service must also be used in a client page, the ASP.NET AJAX GenerateScriptType attribute can be added to the Web Service.</span></span> <span data-ttu-id="5004c-188">Например, класс CustomerDetails, показанный в листинге 9 содержит адрес и пол свойства которого ***представляют вложенные сложные типы.***</span><span class="sxs-lookup"><span data-stu-id="5004c-188">For example, the CustomerDetails class shown in Listing 9 contains Address and Gender properties which ***represent nested complex types.***</span></span>

<span data-ttu-id="5004c-189">**Листинг 9. Класс CustomerDetails, показанный здесь содержит две вложенные сложные типы.**</span><span class="sxs-lookup"><span data-stu-id="5004c-189">**Listing 9. The CustomerDetails class shown here contains two nested complex types.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample10.cs)]

<span data-ttu-id="5004c-190">Адрес и пол объекты, определенные в классе CustomerDetails, показано в листинге 9 не будет автоматически доступны для использования на стороне клиента через JavaScript, так как они представляют собой вложенные типы (адрес — это класс и Пол является перечислением).</span><span class="sxs-lookup"><span data-stu-id="5004c-190">The Address and Gender objects defined within the CustomerDetails class shown in Listing 9 won't automatically be made available for use on the client-side via JavaScript since they are nested types (Address is a class and Gender is an enumeration).</span></span> <span data-ttu-id="5004c-191">В ситуациях, где вложенный тип, используемый в веб-службы должны быть доступны на стороне клиента, можно использовать атрибут GenerateScriptType, упомянутых ранее (см. Листинг 10).</span><span class="sxs-lookup"><span data-stu-id="5004c-191">In situations where a nested type used within a Web Service must be available on the client-side, the GenerateScriptType attribute mentioned earlier can be used (see Listing 10).</span></span> <span data-ttu-id="5004c-192">Этот атрибут можно добавить несколько раз в случаях, где различные вложенные сложные типы возвращаются из службы.</span><span class="sxs-lookup"><span data-stu-id="5004c-192">This attribute can be added multiple times in cases where different nested complex types are returned from a service.</span></span> <span data-ttu-id="5004c-193">Оно может применяться непосредственно к классу веб-службы или выше отдельные веб-методы.</span><span class="sxs-lookup"><span data-stu-id="5004c-193">It can be applied directly to the Web Service class or above specific Web Methods.</span></span>

<span data-ttu-id="5004c-194">**Листинг 10. С помощью атрибута GenerateScriptService определить вложенные типы, которые должны быть доступны клиенту.**</span><span class="sxs-lookup"><span data-stu-id="5004c-194">**Listing 10. Using the GenerateScriptService attribute to define nested types that should be available to the client.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample11.cs)]

<span data-ttu-id="5004c-195">Применяя `GenerateScriptType` атрибута в веб-службы, адрес и пол типы будут автоматически доступны для использования с код ASP.NET AJAX JavaScript на стороне клиента.</span><span class="sxs-lookup"><span data-stu-id="5004c-195">By applying the `GenerateScriptType` attribute to the Web Service, the Address and Gender types will automatically be made available for use by client-side ASP.NET AJAX JavaScript code.</span></span> <span data-ttu-id="5004c-196">В листинге 11 показан пример JavaScript, который автоматически создается и отправляется клиенту путем добавления атрибута GenerateScriptType на веб-службы.</span><span class="sxs-lookup"><span data-stu-id="5004c-196">An example of the JavaScript that is automatically generated and sent to the client by adding the GenerateScriptType attribute on a Web Service is shown in Listing 11.</span></span> <span data-ttu-id="5004c-197">Вы узнаете, как использовать вложенные сложные типы чуть позже.</span><span class="sxs-lookup"><span data-stu-id="5004c-197">You'll see how to use nested complex types later in the article.</span></span>

<span data-ttu-id="5004c-198">**Листинг 11. Вложенные сложные типы, становятся доступными для страницы ASP.NET AJAX.**</span><span class="sxs-lookup"><span data-stu-id="5004c-198">**Listing 11. Nested complex types made available to an ASP.NET AJAX page.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample12.cs)]

<span data-ttu-id="5004c-199">Теперь, когда вы узнали, как создать веб-служб и сделать их доступными для страницы ASP.NET AJAX, давайте рассмотрим, как создать и использовать прокси-серверы JavaScript, таким образом, чтобы данные можно извлечь или отправляемые веб-служб.</span><span class="sxs-lookup"><span data-stu-id="5004c-199">Now that you've seen how to create Web Services and make them accessible to ASP.NET AJAX pages, let's take a look at how to create and use JavaScript proxies so that data can be retrieved or sent to Web Services.</span></span>

## <a name="creating-javascript-proxies"></a><span data-ttu-id="5004c-200">Создание прокси-серверы JavaScript</span><span class="sxs-lookup"><span data-stu-id="5004c-200">Creating JavaScript Proxies</span></span>

<span data-ttu-id="5004c-201">Вызов стандартных веб-службы (.NET или другой платформы) обычно включает в себя создание прокси-объект, который абстрагирует вас от необходимости отправки сообщения запроса и ответа SOAP.</span><span class="sxs-lookup"><span data-stu-id="5004c-201">Calling a standard Web Service (.NET or another platform) typically involves creating a proxy object that shields you from the complexities of sending SOAP request and response messages.</span></span> <span data-ttu-id="5004c-202">С помощью вызовов веб-службы ASP.NET AJAX можно создать прокси JavaScript и позволяет без труда вызвать службы, не беспокоясь о сериализации и десериализации сообщений JSON.</span><span class="sxs-lookup"><span data-stu-id="5004c-202">With ASP.NET AJAX Web Service calls, JavaScript proxies can be created and used to easily call services without worrying about serializing and deserializing JSON messages.</span></span> <span data-ttu-id="5004c-203">Прокси-серверы JavaScript может создаваться автоматически с помощью элемента управления ASP.NET AJAX ScriptManager.</span><span class="sxs-lookup"><span data-stu-id="5004c-203">JavaScript proxies can be automatically generated by using the ASP.NET AJAX ScriptManager control.</span></span>

<span data-ttu-id="5004c-204">Создание прокси JavaScript, который может вызывать веб-службы осуществляется с помощью элемента управления ScriptManager свойство служб.</span><span class="sxs-lookup"><span data-stu-id="5004c-204">Creating a JavaScript proxy that can call Web Services is accomplished by using the ScriptManager's Services property.</span></span> <span data-ttu-id="5004c-205">Это свойство можно задать одну или несколько служб, которые страницы ASP.NET AJAX можно асинхронно вызывают отправку или получение данных без необходимости операций обратной передачи.</span><span class="sxs-lookup"><span data-stu-id="5004c-205">This property allows you to define one or more services that an ASP.NET AJAX page can call asynchronously to send or receive data without requiring postback operations.</span></span> <span data-ttu-id="5004c-206">Определения службы с помощью ASP.NET AJAX `ServiceReference` управления и назначения URL веб-службы для элемента управления `Path` свойство.</span><span class="sxs-lookup"><span data-stu-id="5004c-206">You define a service by using the ASP.NET AJAX `ServiceReference` control and assigning the Web Service URL to the control's `Path` property.</span></span> <span data-ttu-id="5004c-207">В листинге 12 показан пример ссылается на службу, с именем CustomersService.asmx.</span><span class="sxs-lookup"><span data-stu-id="5004c-207">Listing 12 shows an example of referencing a service named CustomersService.asmx.</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample13.aspx)]

<span data-ttu-id="5004c-208">**Листинг 12. Определение веб-служба, используемая на странице ASP.NET AJAX.**</span><span class="sxs-lookup"><span data-stu-id="5004c-208">**Listing 12. Defining a Web Service used in an ASP.NET AJAX page.**</span></span>

<span data-ttu-id="5004c-209">Добавление ссылки на CustomersService.asmx элемент управления ScriptManager вызывает прокси JavaScript для динамически сгенерированных и ссылку на страницу.</span><span class="sxs-lookup"><span data-stu-id="5004c-209">Adding a reference to the CustomersService.asmx through the ScriptManager control causes a JavaScript proxy to be dynamically generated and referenced by the page.</span></span> <span data-ttu-id="5004c-210">Прокси-сервера внедряется с помощью &lt;скрипт&gt; теги и динамически загружается путем вызова CustomersService.asmx файл и добавления в конец/js.</span><span class="sxs-lookup"><span data-stu-id="5004c-210">The proxy is embedded by using the &lt;script&gt; tag and dynamically loaded by calling the CustomersService.asmx file and appending /js to the end of it.</span></span> <span data-ttu-id="5004c-211">В следующем примере показано, как прокси JavaScript внедряется в странице, когда отладка была отключена в файле web.config:</span><span class="sxs-lookup"><span data-stu-id="5004c-211">The following example shows how the JavaScript proxy is embedded in the page when debugging is disabled in web.config:</span></span>

[!code-html[Main](understanding-asp-net-ajax-web-services/samples/sample14.html)]

> <span data-ttu-id="5004c-212">*> [!NOTE] Если вы хотите просмотреть фактический код прокси-сервера JavaScript, который создается можно ввести URL-адрес нужного веб-службы .NET в поле адреса Internet Explorer и добавьте в конец/js.*</span><span class="sxs-lookup"><span data-stu-id="5004c-212">*> [!NOTE] If you'd like to see the actual JavaScript proxy code that is generated you can type the URL to the desired .NET Web Service into Internet Explorer's address box and append /js to the end of it.*</span></span>


<span data-ttu-id="5004c-213">Если отладка включена в файле web.config, это отладочная версия прокси JavaScript будет внедрен в страницу, как показано далее:</span><span class="sxs-lookup"><span data-stu-id="5004c-213">If debugging is enabled in web.config a debug version of the JavaScript proxy will be embedded in the page as shown next:</span></span>

[!code-html[Main](understanding-asp-net-ajax-web-services/samples/sample15.html)]

<span data-ttu-id="5004c-214">Созданные ScriptManager прокси JavaScript может быть также внедрен непосредственно в страницу, а не с помощью &lt;скрипт&gt; атрибут src тега.</span><span class="sxs-lookup"><span data-stu-id="5004c-214">The JavaScript proxy created by the ScriptManager can also be embedded directly into the page rather than referenced using the &lt;script&gt; tag's src attribute.</span></span> <span data-ttu-id="5004c-215">Это можно сделать, задав свойство InlineScript ServiceReference элемента управления значение true (по умолчанию — false).</span><span class="sxs-lookup"><span data-stu-id="5004c-215">This can be done by setting the ServiceReference control's InlineScript property to true (the default is false).</span></span> <span data-ttu-id="5004c-216">Это может быть полезно, когда прокси-сервер не предоставлен общий доступ на нескольких страницах и в случае, если вы хотите уменьшить количество сетевых вызовов к серверу.</span><span class="sxs-lookup"><span data-stu-id="5004c-216">This can be useful when a proxy isn't shared across multiple pages and when you'd like to reduce the number of network calls made to the server.</span></span> <span data-ttu-id="5004c-217">Когда InlineScript имеет значение true скрипт прокси-сервера не кэшируются обозревателем, значение по умолчанию false рекомендуется в случаях, где используется прокси-сервера через несколько страниц в приложении ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="5004c-217">When InlineScript is set to true the proxy script won't be cached by the browser so the default value of false is recommended in cases where the proxy is used by multiple pages in an ASP.NET AJAX application.</span></span> <span data-ttu-id="5004c-218">Далее показан пример использования свойства InlineScript:</span><span class="sxs-lookup"><span data-stu-id="5004c-218">An example of using the InlineScript property is shown next:</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample16.aspx)]

## <a name="using-javascript-proxies"></a><span data-ttu-id="5004c-219">С помощью прокси-серверы JavaScript</span><span class="sxs-lookup"><span data-stu-id="5004c-219">Using JavaScript Proxies</span></span>

<span data-ttu-id="5004c-220">После страницы ASP.NET AJAX с помощью элемента управления ScriptManager ссылается на веб-службы, выполняется вызов веб-службе и возвращаемые данные могут обрабатываться с помощью функции обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="5004c-220">Once a Web Service is referenced by an ASP.NET AJAX page using the ScriptManager control, a call can be made to the Web Service and the returned data can be handled using callback functions.</span></span> <span data-ttu-id="5004c-221">Веб-службы вызывается (если он существует), ссылки на пространства имен, имя класса и имя веб-метода.</span><span class="sxs-lookup"><span data-stu-id="5004c-221">A Web Service is called by referencing its namespace (if one exists), class name and Web Method name.</span></span> <span data-ttu-id="5004c-222">А также функцию обратного вызова, который обрабатывает возвращаемые данные могут быть определены все параметры, передаваемые в веб-службу.</span><span class="sxs-lookup"><span data-stu-id="5004c-222">Any parameters passed to the Web Service can be defined along with a callback function that handles the returned data.</span></span>

<span data-ttu-id="5004c-223">Пример использования прокси JavaScript для вызова веб-метода с именем GetCustomersByCountry() показано в листинге 13.</span><span class="sxs-lookup"><span data-stu-id="5004c-223">An example of using a JavaScript proxy to call a Web Method named GetCustomersByCountry() is shown in Listing 13.</span></span> <span data-ttu-id="5004c-224">Функция GetCustomersByCountry() вызывается в том случае, когда пользователь нажимает кнопку на странице.</span><span class="sxs-lookup"><span data-stu-id="5004c-224">The GetCustomersByCountry() function is called when an end user clicks a button on the page.</span></span>

<span data-ttu-id="5004c-225">**Листинг 13. Вызов веб-службы с прокси JavaScript.**</span><span class="sxs-lookup"><span data-stu-id="5004c-225">**Listing 13. Calling a Web Service with a JavaScript proxy.**</span></span>

[!code-javascript[Main](understanding-asp-net-ajax-web-services/samples/sample17.js)]

<span data-ttu-id="5004c-226">Этот вызов ссылается на пространство имен InterfaceTraining, класс CustomersService и веб-метода GetCustomersByCountry определенной в службе.</span><span class="sxs-lookup"><span data-stu-id="5004c-226">This call references the InterfaceTraining namespace, CustomersService class and GetCustomersByCountry Web Method defined in the service.</span></span> <span data-ttu-id="5004c-227">Он передает значение страны, полученное из элемента textbox, а также функцию обратного вызова с именем OnWSRequestComplete, который должен вызываться при возврате асинхронный вызов веб-службы.</span><span class="sxs-lookup"><span data-stu-id="5004c-227">It passes a country value obtained from a textbox as well as a callback function named OnWSRequestComplete that should be invoked when the asynchronous Web Service call returns.</span></span> <span data-ttu-id="5004c-228">OnWSRequestComplete обрабатывает массива объектов клиента, возвращаемый службой и преобразует их в таблицу, которая отображается на странице.</span><span class="sxs-lookup"><span data-stu-id="5004c-228">OnWSRequestComplete handles the array of Customer objects returned from the service and converts them into a table that is displayed in the page.</span></span> <span data-ttu-id="5004c-229">Выходные данные из вызова показан на рис. 1.</span><span class="sxs-lookup"><span data-stu-id="5004c-229">The output generated from the call is shown in Figure 1.</span></span>


<span data-ttu-id="5004c-230">[![Привязка данных, полученные путем внесения асинхронный вызов AJAX на веб-службу.](understanding-asp-net-ajax-web-services/_static/image2.png)](understanding-asp-net-ajax-web-services/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5004c-230">[![Binding data obtained by making an asynchronous AJAX call to a Web Service.](understanding-asp-net-ajax-web-services/_static/image2.png)](understanding-asp-net-ajax-web-services/_static/image1.png)</span></span>

<span data-ttu-id="5004c-231">**Рис. 1**: Привязка данных, полученные путем внесения асинхронный вызов AJAX на веб-службу.</span><span class="sxs-lookup"><span data-stu-id="5004c-231">**Figure 1**: Binding data obtained by making an asynchronous AJAX call to a Web Service.</span></span>  <span data-ttu-id="5004c-232">([Просмотр полноразмерного изображения](understanding-asp-net-ajax-web-services/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="5004c-232">([Click to view full-size image](understanding-asp-net-ajax-web-services/_static/image3.png))</span></span>


<span data-ttu-id="5004c-233">Прокси-серверы JavaScript также может направлять односторонние вызовы к веб-службам в случаях, когда веб-метода должен быть вызван, но прокси-сервер не должен ожидать ответа.</span><span class="sxs-lookup"><span data-stu-id="5004c-233">JavaScript proxies can also make one-way calls to Web Services in cases where a Web Method should be called but the proxy shouldn't wait for a response.</span></span> <span data-ttu-id="5004c-234">Например можно вызвать веб-службу, чтобы начать процесс, например рабочий процесс, но не ждать, пока возвращаемое значение из службы.</span><span class="sxs-lookup"><span data-stu-id="5004c-234">For example, you may want to call a Web Service to start a process such as a work-flow but not wait for a return value from the service.</span></span> <span data-ttu-id="5004c-235">В случаях, где односторонний вызов должен выполняться в службу можно просто опустить функцию обратного вызова, показано в листинге 13.</span><span class="sxs-lookup"><span data-stu-id="5004c-235">In cases where a one-way call needs to be made to a service, the callback function shown in Listing 13 can simply be omitted.</span></span> <span data-ttu-id="5004c-236">Так как функция обратного вызова не определен объект прокси-сервера не будут ожидать веб-службы для возврата данных.</span><span class="sxs-lookup"><span data-stu-id="5004c-236">Since no callback function is defined the proxy object will not wait for the Web Service to return data.</span></span>

## <a name="handling-errors"></a><span data-ttu-id="5004c-237">Обработка ошибок</span><span class="sxs-lookup"><span data-stu-id="5004c-237">Handling Errors</span></span>

<span data-ttu-id="5004c-238">Асинхронные обратные вызовы веб-служб могут возникнуть различные типы ошибок, таких как сети из строя, веб-служба недоступна или исключение возвращается.</span><span class="sxs-lookup"><span data-stu-id="5004c-238">Asynchronous callbacks to Web Services can encounter different types of errors such as the network being down, the Web Service being unavailable or an exception being returned.</span></span> <span data-ttu-id="5004c-239">К счастью JavaScript прокси-объекты, создаваемые ScriptManager разрешить несколько обратных вызовов, должна определяться для обработки ошибок и сбоев в дополнение к успешный обратный вызов, показанный ранее.</span><span class="sxs-lookup"><span data-stu-id="5004c-239">Fortunately, JavaScript proxy objects generated by the ScriptManager allow multiple callbacks to be defined to handle errors and failures in addition to the success callback shown earlier.</span></span> <span data-ttu-id="5004c-240">Можно определить функцию обратного вызова ошибки сразу же после функции стандартный обратного вызова в вызове метода веб-, как показано в листинге 14.</span><span class="sxs-lookup"><span data-stu-id="5004c-240">An error callback function can be defined immediately after the standard callback function in the call to the Web Method as shown in Listing 14.</span></span>

<span data-ttu-id="5004c-241">**Листинг 14. Определение функцию обратного вызова ошибки и отображения ошибок.**</span><span class="sxs-lookup"><span data-stu-id="5004c-241">**Listing 14. Defining an error callback function and displaying errors.**</span></span>

[!code-javascript[Main](understanding-asp-net-ajax-web-services/samples/sample18.js)]

<span data-ttu-id="5004c-242">Функция обратного вызова OnWSRequestFailed() для вызова, принимающий объект, представляющий ошибки в виде параметра будет активирована все ошибки, возникающие при вызове веб-службы.</span><span class="sxs-lookup"><span data-stu-id="5004c-242">Any errors that occur when the Web Service is called will trigger the OnWSRequestFailed() callback function to be called which accepts an object representing the error as a parameter.</span></span> <span data-ttu-id="5004c-243">Объект error предоставляет несколько разных функций для определения причины ошибки, а также того, является ли время ожидания вызова. В листинге 14 показан пример использования функции различных ошибок и рис. 2 показан пример выходных данных, созданных этими функциями.</span><span class="sxs-lookup"><span data-stu-id="5004c-243">The error object exposes several different functions to determine the cause of the error as well as whether or not the call timed out. Listing 14 shows an example of using the different error functions and Figure 2 shows an example of the output generated by the functions.</span></span>


<span data-ttu-id="5004c-244">[![Выходные данные, созданные путем вызова функции ошибок ASP.NET AJAX.](understanding-asp-net-ajax-web-services/_static/image5.png)](understanding-asp-net-ajax-web-services/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="5004c-244">[![Output generated by calling ASP.NET AJAX error functions.](understanding-asp-net-ajax-web-services/_static/image5.png)](understanding-asp-net-ajax-web-services/_static/image4.png)</span></span>

<span data-ttu-id="5004c-245">**Рис. 2**: Выходные данные, созданные путем вызова функции ошибок ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="5004c-245">**Figure 2**: Output generated by calling ASP.NET AJAX error functions.</span></span>  <span data-ttu-id="5004c-246">([Просмотр полноразмерного изображения](understanding-asp-net-ajax-web-services/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="5004c-246">([Click to view full-size image](understanding-asp-net-ajax-web-services/_static/image6.png))</span></span>


## <a name="handling-xml-data-returned-from-a-web-service"></a><span data-ttu-id="5004c-247">Обработка XML-данные, возвращенные из веб-службы</span><span class="sxs-lookup"><span data-stu-id="5004c-247">Handling XML Data Returned from a Web Service</span></span>

<span data-ttu-id="5004c-248">Вы уже видели, как веб-метод может возвращать необработанных XML-данных с помощью атрибута ScriptMethod вместе с его свойство ResponseFormat.</span><span class="sxs-lookup"><span data-stu-id="5004c-248">Earlier you saw how a Web Method could return raw XML data by using the ScriptMethod attribute along with its ResponseFormat property.</span></span> <span data-ttu-id="5004c-249">Если ResponseFormat имеет значение ResponseFormat.Xml, данные, возвращенные из веб-службы сериализуется как XML, а не JSON.</span><span class="sxs-lookup"><span data-stu-id="5004c-249">When ResponseFormat is set to ResponseFormat.Xml, data returned from the Web Service is serialized as XML rather than JSON.</span></span> <span data-ttu-id="5004c-250">Это может быть полезно, если данные XML должны передаваться непосредственно клиенту для обработки с помощью JavaScript или XSLT.</span><span class="sxs-lookup"><span data-stu-id="5004c-250">This can be useful when XML data needs to be passed directly to the client for processing using JavaScript or XSLT.</span></span> <span data-ttu-id="5004c-251">В настоящее время Internet Explorer 5 или более поздней версии обеспечивает оптимальную модель объектов на стороне клиента для синтаксического анализа и фильтрация данных XML из-за его встроенную поддержку для MSXML.</span><span class="sxs-lookup"><span data-stu-id="5004c-251">At the current time, Internet Explorer 5 or higher provides the best client-side object model for parsing and filtering XML data due to its built-in support for MSXML.</span></span>

<span data-ttu-id="5004c-252">Извлечение XML-данных из веб-службы не отличается от извлечения других типов данных.</span><span class="sxs-lookup"><span data-stu-id="5004c-252">Retrieving XML data from a Web Service is no different than retrieving other data types.</span></span> <span data-ttu-id="5004c-253">Начнем с вызова прокси JavaScript вызывает соответствующую функцию и определить функцию обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="5004c-253">Start by invoking the JavaScript proxy to call the appropriate function and define a callback function.</span></span> <span data-ttu-id="5004c-254">После возвращения вызова можно приступить к обработке данных в функции обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="5004c-254">Once the call returns you can then process the data in the callback function.</span></span>

<span data-ttu-id="5004c-255">В листинге 15 показан пример вызова веб-метода с именем GetRssFeed(), который возвращает объект XmlElement.</span><span class="sxs-lookup"><span data-stu-id="5004c-255">Listing 15 shows an example of calling a Web Method named GetRssFeed() that returns an XmlElement object.</span></span> <span data-ttu-id="5004c-256">GetRssFeed() принимает один параметр, представляющий URL-адрес RSS-канала для получения.</span><span class="sxs-lookup"><span data-stu-id="5004c-256">GetRssFeed() accepts a single parameter representing the URL for the RSS feed to retrieve.</span></span>

<span data-ttu-id="5004c-257">**Листинг 15. Работа с XML-данные, возвращенные из веб-службы.**</span><span class="sxs-lookup"><span data-stu-id="5004c-257">**Listing 15. Working with XML data returned from a Web Service.**</span></span>

[!code-html[Main](understanding-asp-net-ajax-web-services/samples/sample19.html)]

<span data-ttu-id="5004c-258">В этом примере передается URL-адрес RSS-канала и обрабатывает полученные данные XML в функции OnWSRequestComplete().</span><span class="sxs-lookup"><span data-stu-id="5004c-258">This example passes a URL to an RSS feed and processes the returned XML data in the OnWSRequestComplete() function.</span></span> <span data-ttu-id="5004c-259">OnWSRequestComplete() сначала проверяет, находится ли браузер Internet Explorer, чтобы узнать, доступно ли средство синтаксического анализа MSXML.</span><span class="sxs-lookup"><span data-stu-id="5004c-259">OnWSRequestComplete() first checks to see if the browser is Internet Explorer to know whether or not the MSXML parser is available.</span></span> <span data-ttu-id="5004c-260">В противном случае инструкция XPath позволяет найти все &lt;элемент&gt; теги в RSS-канала.</span><span class="sxs-lookup"><span data-stu-id="5004c-260">If it is, an XPath statement is used to locate all &lt;item&gt; tags within the RSS feed.</span></span> <span data-ttu-id="5004c-261">Каждый элемент затем выполняется итерация и связанным &lt;title&gt; и &lt;ссылку&gt; теги обнаруживаются и обрабатываются для отображения каждого элемента данных.</span><span class="sxs-lookup"><span data-stu-id="5004c-261">Each item is then iterated through and the associated &lt;title&gt; and &lt;link&gt; tags are located and processed to display each item's data.</span></span> <span data-ttu-id="5004c-262">Рис. 3 показан пример выходных данных, созданных делать вызовы через прокси JavaScript в веб-метода GetRssFeed() AJAX ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="5004c-262">Figure 3 shows an example of the output generated from making an ASP.NET AJAX call through a JavaScript proxy to the GetRssFeed() Web Method.</span></span>

## <a name="handling-complex-types"></a><span data-ttu-id="5004c-263">Обработка сложных типов</span><span class="sxs-lookup"><span data-stu-id="5004c-263">Handling Complex Types</span></span>

<span data-ttu-id="5004c-264">Сложные типы принятые или возвращаемых веб-службой, автоматически предоставляется через прокси JavaScript.</span><span class="sxs-lookup"><span data-stu-id="5004c-264">Complex types accepted or returned by a Web Service are automatically exposed through a JavaScript proxy.</span></span> <span data-ttu-id="5004c-265">Тем не менее вложенные сложные типы не доступны непосредственно на стороне клиента Если атрибут GenerateScriptType не применяется к службе, как обсуждалось выше.</span><span class="sxs-lookup"><span data-stu-id="5004c-265">However, nested complex types are not directly accessible on the client-side unless the GenerateScriptType attribute is applied to the service as discussed earlier.</span></span> <span data-ttu-id="5004c-266">Зачем использовать вложенного сложного типа на стороне клиента?</span><span class="sxs-lookup"><span data-stu-id="5004c-266">Why would you want to use a nested complex type on the client-side?</span></span>

<span data-ttu-id="5004c-267">Чтобы ответить на этот вопрос, предполагается, что страницы ASP.NET AJAX, отображаются данные клиентов и позволяет конечным пользователям Обновить адрес клиента.</span><span class="sxs-lookup"><span data-stu-id="5004c-267">To answer this question, assume that an ASP.NET AJAX page displays customer data and allows end users to update a customer's address.</span></span> <span data-ttu-id="5004c-268">Если веб-службы указывает, что тип адреса (сложный тип, определенный в классе CustomerDetails) могут отправляться клиенту процесс обновления можно разделить на отдельные функции для повышения повторного использования кода.</span><span class="sxs-lookup"><span data-stu-id="5004c-268">If the Web Service specifies that the Address type (a complex type defined within a CustomerDetails class) can be sent to the client then the update process can be divided into separate functions for better code re-use.</span></span>


<span data-ttu-id="5004c-269">[![Выходные данные при создании вызова веб-служб, который возвращает данные RSS.](understanding-asp-net-ajax-web-services/_static/image8.png)](understanding-asp-net-ajax-web-services/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="5004c-269">[![Output creating from calling a Web Service that returns RSS data.](understanding-asp-net-ajax-web-services/_static/image8.png)](understanding-asp-net-ajax-web-services/_static/image7.png)</span></span>

<span data-ttu-id="5004c-270">**Рис. 3**: Выходные данные при создании вызова веб-служб, который возвращает данные RSS.</span><span class="sxs-lookup"><span data-stu-id="5004c-270">**Figure 3**: Output creating from calling a Web Service that returns RSS data.</span></span>  <span data-ttu-id="5004c-271">([Просмотр полноразмерного изображения](understanding-asp-net-ajax-web-services/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="5004c-271">([Click to view full-size image](understanding-asp-net-ajax-web-services/_static/image9.png))</span></span>


<span data-ttu-id="5004c-272">В листинге 16 показан пример кода на стороне клиента, который вызывает объект адрес, определенный в пространстве имен модели, заполняет его с использованием новых данных и присваивает его свойству объекта CustomerDetails адрес.</span><span class="sxs-lookup"><span data-stu-id="5004c-272">Listing 16 shows an example of client-side code that invokes an Address object defined in a Model namespace, fills it with updated data and assigns it to a CustomerDetails object's Address property.</span></span> <span data-ttu-id="5004c-273">CustomerDetails объект затем передается в веб-службу для обработки.</span><span class="sxs-lookup"><span data-stu-id="5004c-273">The CustomerDetails object is then passed to the Web Service for processing.</span></span>

<span data-ttu-id="5004c-274">**Листинг 16. Использование вложенных сложных типов**</span><span class="sxs-lookup"><span data-stu-id="5004c-274">**Listing 16. Using nested complex types**</span></span>

[!code-javascript[Main](understanding-asp-net-ajax-web-services/samples/sample20.js)]

## <a name="creating-and-using-page-methods"></a><span data-ttu-id="5004c-275">Создание и использование методы страниц</span><span class="sxs-lookup"><span data-stu-id="5004c-275">Creating and Using Page Methods</span></span>

<span data-ttu-id="5004c-276">Веб-службы предоставляют прекрасный способ предоставления повторно готовый к применению служб для различных клиентов, включая страницы ASP.NET AJAX.</span><span class="sxs-lookup"><span data-stu-id="5004c-276">Web Services provide an excellent way to expose re-useable services to a variety of clients including ASP.NET AJAX pages.</span></span> <span data-ttu-id="5004c-277">Однако возможны ситуации, где страницу необходимо получить данные, которые никогда не будет использоваться или общими для других страниц.</span><span class="sxs-lookup"><span data-stu-id="5004c-277">However, there may be cases where a page needs to retrieve data that won't ever be used or shared by other pages.</span></span> <span data-ttu-id="5004c-278">Таким образом что ASMX-файла, чтобы разрешить доступ к данным страницы может показаться избыточным, так как служба используется только с одной страницы.</span><span class="sxs-lookup"><span data-stu-id="5004c-278">In this case, making an .asmx file to allow the page to access the data may seem like overkill since the service is only used by a single page.</span></span>

<span data-ttu-id="5004c-279">AJAX для ASP.NET предоставляет другой механизм для выполнения вызовов веб-службы по принципу без создания автономные файлы .asmx.</span><span class="sxs-lookup"><span data-stu-id="5004c-279">ASP.NET AJAX provides another mechanism for making Web Service-like calls without creating standalone .asmx files.</span></span> <span data-ttu-id="5004c-280">Это делается с помощью метода, называются «методы страниц».</span><span class="sxs-lookup"><span data-stu-id="5004c-280">This is done by using a technique referred to as "page methods".</span></span> <span data-ttu-id="5004c-281">Методы страницы являются методы статические (совместно используется в VB.NET), внедренными непосредственно в файл страницы или сторонний код, которые имеют атрибут WebMethod, примененный к ним.</span><span class="sxs-lookup"><span data-stu-id="5004c-281">Page methods are static (shared in VB.NET) methods embedded directly in a page or code-beside file that have the WebMethod attribute applied to them.</span></span> <span data-ttu-id="5004c-282">Применяя атрибут WebMethod они могут вызываться с помощью специальных объекта JavaScript с именем PageMethods, который создается динамически во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="5004c-282">By applying the WebMethod attribute they can be called using a special JavaScript object named PageMethods that gets dynamically created at runtime.</span></span> <span data-ttu-id="5004c-283">Объект PageMethods выступает в качестве прокси-сервера, защита от процесс сериализации и десериализации JSON.</span><span class="sxs-lookup"><span data-stu-id="5004c-283">The PageMethods object acts as a proxy that shields you from the JSON serialization/deserialization process.</span></span> <span data-ttu-id="5004c-284">Обратите внимание на то, что для использования объекта PageMethods необходимо задать свойства EnablePageMethods в ScriptManager значение true.</span><span class="sxs-lookup"><span data-stu-id="5004c-284">Note that in order to use the PageMethods object you must set the ScriptManager's EnablePageMethods property to true.</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample21.aspx)]

<span data-ttu-id="5004c-285">В листинге 17 показан пример определения двух методы страниц в классе побочного кода ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="5004c-285">Listing 17 shows an example of defining two page methods in an ASP.NET code-beside class.</span></span> <span data-ttu-id="5004c-286">Эти методы извлечения данных из слоя бизнес в приложении\_папке кода веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="5004c-286">These methods retrieve data from a business layer class located in the App\_Code folder of the Website.</span></span>

<span data-ttu-id="5004c-287">**Листинг 17. Определение методов страницы.**</span><span class="sxs-lookup"><span data-stu-id="5004c-287">**Listing 17. Defining page methods.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample22.cs)]

<span data-ttu-id="5004c-288">Когда ScriptManager определяет наличие методов веб-страницы, он создает динамическую ссылку на объект PageMethods, упомянутых ранее.</span><span class="sxs-lookup"><span data-stu-id="5004c-288">When ScriptManager detects the presence of Web Methods in the page it generates a dynamic reference to the PageMethods object mentioned earlier.</span></span> <span data-ttu-id="5004c-289">Вызова метода веб-достигается путем ссылки на класс PageMethods, за которым следует имя метода и любые данные обязательного параметра, которые должны быть переданы.</span><span class="sxs-lookup"><span data-stu-id="5004c-289">Calling a Web Method is accomplished by referencing the PageMethods class followed by the name of the method and any necessary parameter data that should be passed.</span></span> <span data-ttu-id="5004c-290">В листинге 18 показан примеры вызова два метода страницы, показанный ранее.</span><span class="sxs-lookup"><span data-stu-id="5004c-290">Listing 18 shows examples of calling the two page methods shown earlier.</span></span>

<span data-ttu-id="5004c-291">**Листинг 18. Вызов методов страницы с помощью объекта PageMethods JavaScript.**</span><span class="sxs-lookup"><span data-stu-id="5004c-291">**Listing 18. Calling page methods with the PageMethods JavaScript object.**</span></span>

[!code-javascript[Main](understanding-asp-net-ajax-web-services/samples/sample23.js)]

<span data-ttu-id="5004c-292">С помощью объекта PageMethods очень похоже на использование прокси-объект JavaScript.</span><span class="sxs-lookup"><span data-stu-id="5004c-292">Using the PageMethods object is very similar to using a JavaScript proxy object.</span></span> <span data-ttu-id="5004c-293">Сначала необходимо указать все данных параметра, которые должны передаваться в метод страницы, а затем определите функцию обратного вызова, который должен быть вызван, когда асинхронный вызов возвращается.</span><span class="sxs-lookup"><span data-stu-id="5004c-293">You first specify all of the parameter data that should be passed to the page method and then define the callback function that should be called when the asynchronous call returns.</span></span> <span data-ttu-id="5004c-294">Также можно задать обратный вызов сбоя (приведены в листинге 14 пример обработки ошибок).</span><span class="sxs-lookup"><span data-stu-id="5004c-294">A failure callback can also be specified (refer to Listing 14 for an example of handling failures).</span></span>

## <a name="the-autocompleteextender-and-the-aspnet-ajax-toolkit"></a><span data-ttu-id="5004c-295">AutoCompleteExtender и набора средств ASP.NET AJAX</span><span class="sxs-lookup"><span data-stu-id="5004c-295">The AutoCompleteExtender and the ASP.NET AJAX Toolkit</span></span>

<span data-ttu-id="5004c-296">Набор AJAX ASP.NET (доступные из [ http://ajax.asp.net ](http://ajax.asp.net)) предлагает несколько элементов управления, которые могут использоваться для доступа к веб-служб.</span><span class="sxs-lookup"><span data-stu-id="5004c-296">The ASP.NET AJAX Toolkit (available from [http://ajax.asp.net](http://ajax.asp.net)) offers several controls that can be used to access Web Services.</span></span> <span data-ttu-id="5004c-297">В частности, этот набор содержит полезные элемента управления с именем `AutoCompleteExtender` , можно использовать для вызова веб-служб и отображение данных на страницах без написания кода JavaScript вообще.</span><span class="sxs-lookup"><span data-stu-id="5004c-297">Specifically, the toolkit contains a useful control named `AutoCompleteExtender` that can be used to call Web Services and show data in pages without writing any JavaScript code at all.</span></span>

<span data-ttu-id="5004c-298">Элемент управления AutoCompleteExtender можно расширить существующие функциональные возможности элемента textbox и позволяют пользователям легко найти данные, которые они ищут.</span><span class="sxs-lookup"><span data-stu-id="5004c-298">The AutoCompleteExtender control can be used to extend existing functionality of a textbox and help users more easily locate data they're looking for.</span></span> <span data-ttu-id="5004c-299">Вводе в текстовое поле элемента управления можно использовать для запроса веб-службе и показывает результаты под текстовым полем динамически.</span><span class="sxs-lookup"><span data-stu-id="5004c-299">As they type into a textbox the control can be used to query a Web Service and shows results below the textbox dynamically.</span></span> <span data-ttu-id="5004c-300">Рис. 4 показан пример использования элемента управления AutoCompleteExtender, чтобы просмотреть идентификаторы клиентов для поддержки приложения.</span><span class="sxs-lookup"><span data-stu-id="5004c-300">Figure 4 shows an example of using the AutoCompleteExtender control to display customer ids for a support application.</span></span> <span data-ttu-id="5004c-301">Как пользователь вводит различными символами в текстовое поле, будут показаны разные элементы под ним в зависимости от своих входных данных.</span><span class="sxs-lookup"><span data-stu-id="5004c-301">As the user types different characters into the textbox, different items will be shown below it based upon their input.</span></span> <span data-ttu-id="5004c-302">Затем пользователи могут выбрать идентификатор нужного клиента.</span><span class="sxs-lookup"><span data-stu-id="5004c-302">Users can then select the desired customer id.</span></span>

<span data-ttu-id="5004c-303">Использование AutoCompleteExtender в пределах страницы ASP.NET AJAX требует, что файл AjaxControlToolkit.dll сборка добавлена в папку bin веб сайта.</span><span class="sxs-lookup"><span data-stu-id="5004c-303">Using the AutoCompleteExtender within an ASP.NET AJAX page requires that the AjaxControlToolkit.dll assembly be added to the Website's bin folder.</span></span> <span data-ttu-id="5004c-304">После добавления сборки набора средств, необходимо сослаться на него в файле web.config, таким образом, чтобы элементы управления, содержащихся в нем доступны для всех страниц в приложении.</span><span class="sxs-lookup"><span data-stu-id="5004c-304">Once the toolkit assembly has been added, you'll want to reference it in web.config so that the controls it contains are available to all pages in an application.</span></span> <span data-ttu-id="5004c-305">Это можно сделать, добавив следующий тег в web.config &lt;элементов управления&gt; тега:</span><span class="sxs-lookup"><span data-stu-id="5004c-305">This can be done by adding the following tag within web.config's &lt;controls&gt; tag:</span></span>

[!code-xml[Main](understanding-asp-net-ajax-web-services/samples/sample24.xml)]

<span data-ttu-id="5004c-306">В случаях, где требуется использовать элемент управления в определенную страницу вы можете обратиться, добавив Reference-директива в верхней части страницы, как показано далее, а не выполняется обновление файла web.config.</span><span class="sxs-lookup"><span data-stu-id="5004c-306">In cases where you only need to use the control in a specific page you can reference it by adding the Reference directive to the top of a page as shown next rather than updating web.config:</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample25.aspx)]


<span data-ttu-id="5004c-307">[![Использование элемента управления AutoCompleteExtender.](understanding-asp-net-ajax-web-services/_static/image11.png)](understanding-asp-net-ajax-web-services/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="5004c-307">[![Using the AutoCompleteExtender control.](understanding-asp-net-ajax-web-services/_static/image11.png)](understanding-asp-net-ajax-web-services/_static/image10.png)</span></span>

<span data-ttu-id="5004c-308">**Рис. 4**: Использование элемента управления AutoCompleteExtender.</span><span class="sxs-lookup"><span data-stu-id="5004c-308">**Figure 4**: Using the AutoCompleteExtender control.</span></span>  <span data-ttu-id="5004c-309">([Просмотр полноразмерного изображения](understanding-asp-net-ajax-web-services/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="5004c-309">([Click to view full-size image](understanding-asp-net-ajax-web-services/_static/image12.png))</span></span>


<span data-ttu-id="5004c-310">После настройки веб-сайта с помощью набора средств AJAX ASP.NET, управляющего элемента AutoCompleteExtender можно добавить на страницу гораздо, как вы добавляете регулярных серверный элемент управления ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="5004c-310">Once the Website has been configured to use the ASP.NET AJAX Toolkit, an AutoCompleteExtender control can be added into the page much like you'd add a regular ASP.NET server control.</span></span> <span data-ttu-id="5004c-311">В листинге 19 показан пример использования элемента управления для вызова веб-службы.</span><span class="sxs-lookup"><span data-stu-id="5004c-311">Listing 19 shows an example of using the control to call a Web Service.</span></span>

<span data-ttu-id="5004c-312">**Листинг 19. Использование элемента управления ASP.NET AJAX Toolkit AutoCompleteExtender.**</span><span class="sxs-lookup"><span data-stu-id="5004c-312">**Listing 19. Using the ASP.NET AJAX Toolkit AutoCompleteExtender control.**</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-web-services/samples/sample26.aspx)]

<span data-ttu-id="5004c-313">AutoCompleteExtender имеет несколько различных свойств, включая стандартные свойства ID и runat, найденных на серверных элементов управления.</span><span class="sxs-lookup"><span data-stu-id="5004c-313">The AutoCompleteExtender has several different properties including the standard ID and runat properties found on server controls.</span></span> <span data-ttu-id="5004c-314">Помимо этого можно задать количество символов, конечный пользователь типы перед веб-службы запрашиваются данные.</span><span class="sxs-lookup"><span data-stu-id="5004c-314">In addition to these, it allows you to define how many characters an end user types before the Web Service is queried for data.</span></span> <span data-ttu-id="5004c-315">Свойство MinimumPrefixLength, показано в листинге 19 вызывает службу, вызываемый каждый раз, когда символ в текстовое поле.</span><span class="sxs-lookup"><span data-stu-id="5004c-315">The MinimumPrefixLength property shown in Listing 19 causes the service to be called each time a character is typed into the textbox.</span></span> <span data-ttu-id="5004c-316">Необходимо соблюдать осторожность, что установка этого значения, так как каждый раз при вводе очередного знака веб-служба будет вызываться для поиска значений, которые определяют сопоставление символов в текстовом поле.</span><span class="sxs-lookup"><span data-stu-id="5004c-316">You'll want to be careful setting this value since each time the user types a character the Web Service will be called to search for values that match the characters in the textbox.</span></span> <span data-ttu-id="5004c-317">Веб-служба для вызова, а также целевой веб-метода определяются с помощью свойства ServicePath и ServiceMethod соответственно.</span><span class="sxs-lookup"><span data-stu-id="5004c-317">The Web Service to call as well as the target Web Method are defined using the ServicePath and ServiceMethod properties respectively.</span></span> <span data-ttu-id="5004c-318">И, наконец свойство TargetControlID указывает какое текстовое поле для привязки элемента управления AutoCompleteExtender.</span><span class="sxs-lookup"><span data-stu-id="5004c-318">Finally, the TargetControlID property identifies which textbox to hook the AutoCompleteExtender control to.</span></span>

<span data-ttu-id="5004c-319">Вызов веб-службы должны иметь атрибут ScriptService, применения как обсуждалось выше и целевой веб-метода должно принимать два параметра с именем prefixText и count.</span><span class="sxs-lookup"><span data-stu-id="5004c-319">The Web Service being called must have the ScriptService attribute applied as discussed earlier and the target Web Method must accept two parameters named prefixText and count.</span></span> <span data-ttu-id="5004c-320">Параметр prefixText представляет символы, введенные конечным пользователем, и параметр count представляет, сколько элементов для возврата (по умолчанию — 10).</span><span class="sxs-lookup"><span data-stu-id="5004c-320">The prefixText parameter represents the characters typed by the end user and the count parameter represents how many items to return (the default is 10).</span></span> <span data-ttu-id="5004c-321">В листинге 20 показан пример метода веб-GetCustomerIDs вызывается элементом управления AutoCompleteExtender, приведенные ранее в листинге 19.</span><span class="sxs-lookup"><span data-stu-id="5004c-321">Listing 20 shows an example of the GetCustomerIDs Web Method called by the AutoCompleteExtender control shown earlier in Listing 19.</span></span> <span data-ttu-id="5004c-322">Веб-метод вызывает метод слоя бизнес, что в свою очередь вызывает данных слоя метод, который выполняет фильтрацию данных и возвращение результатов сопоставления.</span><span class="sxs-lookup"><span data-stu-id="5004c-322">The Web Method calls a business layer method that in turn calls a data layer method that handles filtering the data and returning the matching results.</span></span> <span data-ttu-id="5004c-323">В листинге 21 показан код для метода уровня данных.</span><span class="sxs-lookup"><span data-stu-id="5004c-323">The code for the data layer method is shown in Listing 21.</span></span>

<span data-ttu-id="5004c-324">**Листинг 20. Фильтрация данных, отправленных из элемента управления AutoCompleteExtender.**</span><span class="sxs-lookup"><span data-stu-id="5004c-324">**Listing 20. Filtering data sent from the AutoCompleteExtender control.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample27.cs)]

<span data-ttu-id="5004c-325">**Листинг 21. Фильтрация результатов в зависимости от входных данных конечного пользователя.**</span><span class="sxs-lookup"><span data-stu-id="5004c-325">**Listing 21. Filtering results based upon end user input.**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-web-services/samples/sample28.cs)]

## <a name="conclusion"></a><span data-ttu-id="5004c-326">Заключение</span><span class="sxs-lookup"><span data-stu-id="5004c-326">Conclusion</span></span>

<span data-ttu-id="5004c-327">AJAX для ASP.NET предоставляет отличную поддержку для вызова веб-служб без написания большого объема пользовательский код JavaScript для обработки сообщений запросов и ответов.</span><span class="sxs-lookup"><span data-stu-id="5004c-327">ASP.NET AJAX provides excellent support for calling Web Services without writing a lot of custom JavaScript code to handle the request and response messages.</span></span> <span data-ttu-id="5004c-328">В этой статье вы увидели, как с поддержкой AJAX .NET веб-служб, чтобы включить их для обработки сообщений JSON, а также определение прокси JavaScript, с помощью элемента управления ScriptManager.</span><span class="sxs-lookup"><span data-stu-id="5004c-328">In this article you've seen how to AJAX-enable .NET Web Services to enable them to process JSON messages and how to define JavaScript proxies using the ScriptManager control.</span></span> <span data-ttu-id="5004c-329">Также вы узнали, как JavaScript, прокси-серверы можно использовать для вызова веб-служб, обрабатывать простые и сложные типы и работать со сбоями.</span><span class="sxs-lookup"><span data-stu-id="5004c-329">You've also seen how JavaScript proxies can be used to call Web Services, handle simple and complex types and deal with failures.</span></span> <span data-ttu-id="5004c-330">Наконец вы увидели, как методы страниц позволяют упростить процесс создания и вызова веб-службы и как AutoCompleteExtender элемент управления можно обеспечить справку для конечных пользователей в процессе их набора.</span><span class="sxs-lookup"><span data-stu-id="5004c-330">Finally, you've seen how page methods can be used to simplify the process of creating and making Web Service calls and how the AutoCompleteExtender control can provide help to end users as they type.</span></span> <span data-ttu-id="5004c-331">Несмотря на то, что UpdatePanel в AJAX для ASP.NET, несомненно, будут требуемого для многие программисты AJAX благодаря своей простоте элемента управления, нужно знать, как вызов веб-служб через прокси JavaScript можно использовать во многих приложениях.</span><span class="sxs-lookup"><span data-stu-id="5004c-331">Although the UpdatePanel available in ASP.NET AJAX will certainly be the control of choice for many AJAX programmers due to its simplicity, knowing how to call Web Services through JavaScript proxies can be useful in many applications.</span></span>

## <a name="bio"></a><span data-ttu-id="5004c-332">Биография</span><span class="sxs-lookup"><span data-stu-id="5004c-332">Bio</span></span>

<span data-ttu-id="5004c-333">Дэна Вахлина (Microsoft Most Valuable Professional для ASP.NET и веб-службы) — .NET разработки instructor и архитектура консультант в интерфейс техническое обучение ([http://www.interfacett.com](http://www.interfacett.com)).</span><span class="sxs-lookup"><span data-stu-id="5004c-333">Dan Wahlin (Microsoft Most Valuable Professional for ASP.NET and XML Web Services) is a .NET development instructor and architecture consultant at Interface Technical Training ([http://www.interfacett.com](http://www.interfacett.com)).</span></span> <span data-ttu-id="5004c-334">Дэн основал XML для разработчиков веб-узла ASP.NET ([www.XMLforASP.NET](http://www.XMLforASP.NET)), на Бюро является СПИКЕРОМ INETA и выступает с докладами на нескольких конференциях.</span><span class="sxs-lookup"><span data-stu-id="5004c-334">Dan founded the XML for ASP.NET Developers Web site ([www.XMLforASP.NET](http://www.XMLforASP.NET)), is on the INETA Speaker's Bureau and speaks at several conferences.</span></span> <span data-ttu-id="5004c-335">Дэн соавтором DNA Windows Professional (Wrox), ASP.NET: Советы, учебники и кода (SAM), ASP.NET 1.1 Insider решения, Professional ASP.NET 2.0 AJAX (Wrox), Hacks обладателя звания MVP по ASP.NET 2.0 и созданные XML для разработчиков ASP.NET (SAM).</span><span class="sxs-lookup"><span data-stu-id="5004c-335">Dan co-authored Professional Windows DNA (Wrox), ASP.NET: Tips, Tutorials and Code (Sams), ASP.NET 1.1 Insider Solutions, Professional ASP.NET 2.0 AJAX (Wrox), ASP.NET 2.0 MVP Hacks and authored XML for ASP.NET Developers (Sams).</span></span> <span data-ttu-id="5004c-336">Когда он также не пишет код, статей или книг, Дэн получает записи и записи музыки и играть в Гольф и баскетбольных со своей женой и детьми.</span><span class="sxs-lookup"><span data-stu-id="5004c-336">When he's not writing code, articles or books, Dan enjoys writing and recording music and playing golf and basketball with his wife and kids.</span></span>

<span data-ttu-id="5004c-337">(Scott cate) работает с веб-технологиями Microsoft с 1997 года и является президентом myKB.com ([www.myKB.com](http://www.myKB.com)) приложений, внимание уделяется знаний программных решений, где он специализируется на написание ASP.NET на основе.</span><span class="sxs-lookup"><span data-stu-id="5004c-337">Scott Cate has been working with Microsoft Web technologies since 1997 and is the President of myKB.com ([www.myKB.com](http://www.myKB.com)) where he specializes in writing ASP.NET based applications focused on Knowledge Base Software solutions.</span></span> <span data-ttu-id="5004c-338">Скоттом можно связаться по электронной почте [ scott.cate@myKB.com ](mailto:scott.cate@myKB.com) или его блог по адресу [ScottCate.com](http://ScottCate.com)</span><span class="sxs-lookup"><span data-stu-id="5004c-338">Scott can be contacted via email at [scott.cate@myKB.com](mailto:scott.cate@myKB.com) or his blog at [ScottCate.com](http://ScottCate.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="5004c-339">[Назад](understanding-asp-net-ajax-localization.md)
> [Вперед](understanding-asp-net-ajax-debugging-capabilities.md)</span><span class="sxs-lookup"><span data-stu-id="5004c-339">[Previous](understanding-asp-net-ajax-localization.md)
[Next](understanding-asp-net-ajax-debugging-capabilities.md)</span></span>
