---
uid: web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-asp-net-ajax-authentication-and-profile-application-services
title: Основные сведения о проверки подлинности AJAX ASP.NET и служб профилирования приложений | Документация Майкрософт
author: scottcate
description: Служба проверки подлинности позволяет пользователям вводить учетные данные для получения файл cookie проверки подлинности и является службы шлюза, чтобы разрешить пользовательский...
ms.author: riande
ms.date: 03/14/2008
ms.assetid: 6ab4efb6-aab6-45ac-ad2c-bdec5848ef9e
msc.legacyurl: /web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-asp-net-ajax-authentication-and-profile-application-services
msc.type: authoredcontent
ms.openlocfilehash: 18056c917b32680678c536229e8e26d5cc7db161
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59395138"
---
# <a name="understanding-aspnet-ajax-authentication-and-profile-application-services"></a>Общие сведения о службах проверки подлинности и приложений профилей ASP.NET AJAX

по [(Scott cate)](https://github.com/scottcate)

[Скачать PDF](http://download.microsoft.com/download/C/1/9/C19A3451-1D14-477C-B703-54EF22E197EE/AJAX_tutorial03_MSAjax_ASP.NET_Services_cs.pdf)

> Служба проверки подлинности позволяет пользователям вводить учетные данные для получения файл cookie проверки подлинности и службы шлюза, чтобы разрешить пользовательские профили предоставляется ASP.NET. Использование службы проверки подлинности ASP.NET AJAX совместим с стандартную проверку подлинности форм ASP.NET, поэтому приложения, в настоящее время с помощью форм (например, с именем входа, управления) будет не разбит путем обновления до службы проверки подлинности AJAX.


## <a name="introduction"></a>Вступление

В составе .NET Framework 3.5 корпорация Майкрософт предлагает обновления с расширяемой среде; не только доступна в новую среду разработки, но новые возможности Language-Integrated Query (LINQ) и другие усовершенствования языка будут добавлены позже. Кроме того некоторые другие наборы инструментов, в частности расширения AJAX ASP.NET, знакомые возможности, включены в качестве членов первого класса библиотеки классов .NET Framework Base. Эти расширения позволяют множество новых клиентских функций, включая частичную визуализацию страниц без необходимости полного обновления всей страницы, возможность доступа к веб-служб с помощью клиентского скрипта (в том числе ASP.NET, API профилирования) и расширенного клиентского API-интерфейса разработан для отражения, многие из схемы управления, в набор серверных элементов управления ASP.NET.

Рассматривает этот технический документ по реализации и использовании профилирования ASP.NET и службы проверки подлинности форм, предоставляемых для расширений AJAX Microsoft ASP.NET AJAX ExtensionsThe упростить проверку подлинности форм невероятно для поддержки, так как он (а также Службы профилирования) предоставляется с помощью сценария прокси веб-службы. Расширения AJAX также поддерживает нестандартной проверки подлинности с помощью класса AuthenticationServiceManager.

Этот технический документ основан на бета-версии 2 Visual Studio 2008 и .NET Framework 3.5. Этот технический документ также предполагается, что вы будете работать с Visual Studio 2008 бета-версии 2, не Visual Web Developer Express и предоставит пошаговые руководства, в соответствии с пользовательского интерфейса Visual Studio. Некоторые примеры кода может использовать шаблоны проектов, недоступны в Visual Web Developer Express.

## *<a name="profiles-and-authentication"></a>Профили и проверки подлинности*

Профили Microsoft ASP.NET и служб проверки подлинности предоставляемых системой проверки подлинности форм ASP.NET и — стандартные компоненты ASP.NET. Расширения AJAX для ASP.NET предоставляют сценариям доступ к этим службам через прокси сценария, достаточно простой модели в пространстве имен Sys.Services клиентской библиотеки AJAX.

Служба проверки подлинности позволяет пользователям вводить учетные данные для получения файл cookie проверки подлинности и службы шлюза, чтобы разрешить пользовательские профили предоставляется ASP.NET. Использование службы проверки подлинности ASP.NET AJAX совместим с стандартную проверку подлинности форм ASP.NET, поэтому приложения, в настоящее время с помощью форм (например, с именем входа, управления) будет не разбит путем обновления до службы проверки подлинности AJAX.

Служба профилей позволяет автоматической интеграции и хранение данных пользователя на основе членства, предоставленный службой проверки подлинности. Хранимые данные указываются в файле web.config и различными поставщиками службы профилирования обрабатывать управления данными. Как и в случае со службой проверки подлинности, службы AJAX профиля совместим с стандартная служба профиля ASP.NET, таким образом, путем включения поддержки AJAX не должны разбиваться страниц, в настоящее время включения функции службы профиля ASP.NET.

Включение проверки подлинности ASP.NET и сами службы профилирования в приложение выходит за рамки данной статьи. Дополнительные сведения по этой теме см. в разделе библиотеки MSDN, ссылаются на статье Управление пользователями с использованием членства в [ https://msdn.microsoft.com/library/tw292whz.aspx ](https://msdn.microsoft.com/library/tw292whz.aspx). ASP.NET также включает программу автоматически настраивать членство с SQL Server, который является поставщик службы проверки подлинности по умолчанию для членства ASP.NET. Дополнительные сведения см. в статье средство регистрации ASP.NET SQL Server (Aspnet\_regsql.exe) в [ https://msdn.microsoft.com/library/ms229862(vs.80).aspx ](https://msdn.microsoft.com/library/ms229862(vs.80).aspx).

## *<a name="using-the-aspnet-ajax-authentication-service"></a>Использование службы проверки подлинности ASP.NET AJAX*

В файле web.config необходимо включить службу проверки подлинности AJAX ASP.NET:

[!code-xml[Main](understanding-asp-net-ajax-authentication-and-profile-application-services/samples/sample1.xml)]

Служба проверки подлинности требует включения проверки подлинности форм ASP.NET и чтобы файлы cookie, чтобы включить в клиентском браузере (скрипт не удается включить без поддержки файлов cookie сеанса, так как без поддержки файлов cookie сеансов требуются параметры URL-адреса).

После проверки подлинности службы AJAX включен и настроен, клиентский скрипт можно немедленно получать преимущества от объекта Sys.Services.AuthenticationService. В первую очередь, клиентский скрипт будет хотите воспользоваться преимуществами `login` метод и `isLoggedIn` свойство. Несколько свойств существуют для предоставления значений по умолчанию для имени входа метода, который может принимать большое количество параметров.

*Члены Sys.Services.AuthenticationService*

*метод входа:*

Метод login() начинает запрос для проверки подлинности учетных данных пользователя. Этот метод является асинхронным и не блокирует выполнение.

*Параметры:*

| **имени параметра** | **Значение** |
| --- | --- |
| userName | Обязательный. Имя пользователя для проверки подлинности. |
| пароль | Необязательно (по умолчанию — null). Пароль пользователя. |
| isPersistent | Необязательно (по умолчанию — false). Ли файл cookie проверки подлинности пользователя должен сохраняться между сеансами. Если значение равно false, пользователь будет выход при закрытии браузера или истечения срока действия сеанса. |
| redirectUrl | Необязательно (по умолчанию — null). URL-адрес для перенаправления браузера, чтобы после успешной проверки подлинности. Если этот параметр имеет значение null или является пустой строкой, происходит перенаправление. |
| customInfo | Необязательно (по умолчанию — null). Этот параметр в настоящее время не используется и зарезервировано для использования в будущем. |
| loginCompletedCallback | Необязательно (по умолчанию — null). Функция, вызываемая после успешного входа. Если указано, этот параметр переопределяет свойство defaultLoginCompleted. |
| failedCallback | Необязательно (по умолчанию — null). Функция, вызываемая при не удалось войти. Если указано, этот параметр переопределяет свойство defaultFailedCallback. |
| userContext | Необязательно (по умолчанию — null). Пользовательские данные контекста, который должен быть передан в функции обратного вызова. |

*Возвращаемое значение:*

Эта функция отсутствует возвращаемое значение. Тем не менее ряд поведения включены после завершения вызова этой функции:

- Текущей страницы, либо будет обновлен, или изменить, если `redirectUrl` параметра было null, ни пустой строкой.
- Тем не менее, если параметр имеет значение null или является пустой строкой, `loginCompletedCallback` параметра, или `defaultLoginCompletedCallback` вызывается свойство.
- При сбое вызова веб-службе, `failedCallback` параметр `defaultFailedCallback` вызывается свойство.

*метод выхода:*

Метод logout() удаляет файл cookie учетные данные и выполняет выход текущего пользователя из веб-приложения.

*Параметры:*

| **имени параметра** | **Значение** |
| --- | --- |
| redirectUrl | Необязательно (по умолчанию — null). URL-адрес для перенаправления браузера, чтобы после успешной проверки подлинности. Если этот параметр имеет значение null или является пустой строкой, происходит перенаправление. |
| logoutCompletedCallback | Необязательно (по умолчанию — null). Функция, вызываемая после успешного выхода. Если указано, этот параметр переопределяет свойство defaultLogoutCompleted. |
| failedCallback | Необязательно (по умолчанию — null). Функция, вызываемая при не удалось войти. Если указано, этот параметр переопределяет свойство defaultFailedCallback. |
| userContext | Необязательно (по умолчанию — null). Пользовательские данные контекста, который должен быть передан в функции обратного вызова. |

*Возвращаемое значение:*

Эта функция отсутствует возвращаемое значение. Тем не менее ряд поведения включены после завершения вызова этой функции:

- Текущей страницы, либо будет обновлен, или изменить, если `redirectUrl` параметра было null, ни пустой строкой.
- Тем не менее, если параметр имеет значение null или является пустой строкой, `logoutCompletedCallback` параметра, или `defaultLogoutCompletedCallback` вызывается свойство.
- При сбое вызова веб-службе, `failedCallback` параметр `defaultFailedCallback` вызывается свойство.

*Свойство defaultFailedCallback (get, set):*

Это свойство задает функцию, которая должна вызываться при сбое для взаимодействия с веб-службы. Он должен получать делегата (или ссылка на функцию).

Справочник по функциям, заданного этим свойством должен иметь следующую сигнатуру:

[!code-javascript[Main](understanding-asp-net-ajax-authentication-and-profile-application-services/samples/sample2.js)]

*Параметры:*

| **имени параметра** | **Значение** |
| --- | --- |
| error | Указывает сведения об ошибке. |
| userContext | Указывает сведения о контексте пользователя, при вызове функции входа или выхода. |
| methodName | Имя вызывающего метода. |

*Свойство defaultLoginCompletedCallback (get, set):*

Это свойство задает функцию, которая должна вызываться после завершения вызова веб-службы входа в систему. Он должен получать делегата (или ссылка на функцию).

Справочник по функциям, заданного этим свойством должен иметь следующую сигнатуру:

[!code-javascript[Main](understanding-asp-net-ajax-authentication-and-profile-application-services/samples/sample3.js)]

*Параметры:*

| **имени параметра** | **Значение** |
| --- | --- |
| validCredentials | Указывает, предоставлен ли пользователю действительные учетные данные. `true` Если пользователь успешно вошел в систему; в противном случае `false`. |
| userContext | Указывает сведения о контексте пользователя, при вызове функции входа в систему. |
| methodName | Имя вызывающего метода. |

*Свойство defaultLogoutCompletedCallback (get, set):*

Это свойство задает функцию, которая должна вызываться после завершения вызова веб-службы выхода. Он должен получать делегата (или ссылка на функцию).

Справочник по функциям, заданного этим свойством должен иметь следующую сигнатуру:

[!code-javascript[Main](understanding-asp-net-ajax-authentication-and-profile-application-services/samples/sample4.js)]

*Параметры:*

| **имени параметра** | **Значение** |
| --- | --- |
| result | Этот параметр всегда будет иметь `null`; он зарезервирован для использования в будущем. |
| userContext | Указывает сведения о контексте пользователя, при вызове функции входа в систему. |
| methodName | Имя вызывающего метода. |

*Свойство isLoggedIn (get):*

Это свойство возвращает текущее состояние проверки подлинности пользователя; оно задается объект ScriptManager во время запроса страницы.

Это свойство возвращает `true` Если пользователь вошел в данный момент; в противном случае — значение, он возвращает `false`.

*Свойство Path (get, set):*

Программным образом, это свойство определяет расположение веб-службы проверки подлинности. Он может использоваться для переопределения поставщика проверки подлинности по умолчанию, а также один декларативно задать в свойстве путь элемента управления ScriptManager AuthenticationService дочернего узла (Дополнительные сведения см. в разделе настраиваемого поставщика службы проверки подлинности раздел ниже).

Обратите внимание на то, что расположение службы проверки подлинности по умолчанию не изменяется. Тем не менее ASP.NET AJAX позволяет вам указать расположение веб-службы, который предоставляет тот же интерфейс класса, как прокси-службы проверки подлинности ASP.NET AJAX.

Обратите внимание, что это свойство не задается значение, которое направляет запрос скрипта сайт текущего сайта. Так как текущее приложение не будет получать учетные данные проверки подлинности, он окажется бесполезной; Кроме того базовой технологии AJAX не следует опубликовать межсайтовых запросов и может создавать исключение безопасности в клиентском браузере.

Это свойство является `String` объект, представляющий путь к веб-службе проверки подлинности.

*свойство времени ожидания (get, set):*

Это свойство определяет, что произошел сбой продолжительность времени ожидания для службы проверки подлинности при условии, что запрос на вход. Если время ожидания истекло при ожидании завершения вызова, будет вызван обратный вызов не удалось выполнить запрос и вызов не будет завершен.

Это свойство является `Number` объект, представляющий количество миллисекунд для ожидания результатов от службы аутентификации.

*Пример кода: Войдя в службу проверки подлинности*

Следующая разметка является вызовом простой сценарий входа и выхода методы класса AuthenticationService пример страницы ASP.NET.

[!code-aspx[Main](understanding-asp-net-ajax-authentication-and-profile-application-services/samples/sample5.aspx)]

## <a name="accessing-aspnet-profiling-data-via-ajax"></a>Доступ к профилирования данных с помощью AJAX ASP.NET

Профилирование службы ASP.NET также предоставляется с помощью расширений AJAX для ASP.NET. Поскольку службы профилирования ASP.NET предоставляет подробной API, по которому будут сохраняться и извлекаться данные пользователя, это может быть средством превосходную производительность.

Должна быть включена служба профиля в файле web.config; Это не по умолчанию. Чтобы сделать это, убедитесь, что `profileService` включил дочерний элемент = значение true, указанный в файле web.config, и что указаны свойства, которые можно прочитать или записать следующим образом:

[!code-xml[Main](understanding-asp-net-ajax-authentication-and-profile-application-services/samples/sample6.xml)]

Необходимо также настроить службы профиля. Несмотря на то, что конфигурация профилирования службы выходит за рамки данной статьи, стоит отметить, что группы, как определено в параметрах профиля конфигурации будет доступен как подсвойство имя группы. Например с помощью указанного ниже раздел профиля:

[!code-xml[Main](understanding-asp-net-ajax-authentication-and-profile-application-services/samples/sample7.xml)]

Для доступа к имени, Address.Line1, Address.Line2, Address.City, Address.State, Address.Zip и BackgroundColor как свойства в поле свойств класса ProfileService смогут клиентского скрипта.

Настроив службу профилирования AJAX, она будет немедленно доступна на страницах; Тем не менее он будет загружаться один раз перед использованием.

*Члены Sys.Services.ProfileService*

*поле свойств:*

Поле свойств предоставляет все данные на настроенный профиль как свойства дочерних элементов, которые можно ссылаться по соглашению имя оператора точки. Свойства, являющиеся дочерними для группы свойств, называются GroupName.PropertyName. В примере конфигурации профиля, представленные выше Чтобы получить состояние пользователя, можно использовать следующий идентификатор:

[!code-csharp[Main](understanding-asp-net-ajax-authentication-and-profile-application-services/samples/sample8.cs)]

*метод загрузки:*

Загружает выбранный список или все свойства с сервера.

*Параметры:*

| **имени параметра** | **Значение** |
| --- | --- |
| propertyNames | Необязательно (по умолчанию — null). Свойства для загрузки с сервера. |
| loadCompletedCallback | Необязательно (по умолчанию — null). Функция, вызываемая при завершении загрузки. |
| failedCallback | Необязательно (по умолчанию — null). Функция, вызываемая при возникновении ошибки. |
| userContext | Необязательно (по умолчанию — null). Сведения о контексте передается функции обратного вызова. |

Функция нагрузки не имеет возвращаемого значения. Если вызов успешно завершен, он будет вызывать либо `loadCompletedCallback` параметр или `defaultLoadCompletedCallback` свойство. Если вызов завершился неудачно, или истекло время ожидания, либо `failedCallback` параметр или `defaultFailedCallback` свойство будет вызываться.

Если `propertyNames` параметр не задан, все настройки чтения свойства извлекаются с сервера.

*метод Save:*

Метод save() сохраняет указанное свойство списка (или все свойства) профиля пользователя ASP.NET.

*Параметры:*

| **имени параметра** | **Значение** |
| --- | --- |
| propertyNames | Необязательно (по умолчанию — null). Свойства сохраняются на сервере. |
| saveCompletedCallback | Необязательно (по умолчанию — null). Функция, вызываемая при сохранении завершена. |
| failedCallback | Необязательно (по умолчанию — null). Функция, вызываемая при возникновении ошибки. |
| userContext | Необязательно (по умолчанию — null). Сведения о контексте передается функции обратного вызова. |

Сохранение функция не имеет возвращаемого значения. Если вызов завершается успешно, он будет вызывать либо `saveCompletedCallback` параметр или `defaultSaveCompletedCallback` свойство. Если вызов завершился неудачно, или истекло время ожидания, либо `failedCallback` или `defaultFailedCallback` свойство будет вызываться.

Если `propertyNames` параметр имеет значение null, все свойства профиля будут отправляться на сервер и сервер определит, какие свойства могут быть сохранены, а какие нельзя.

*Свойство defaultFailedCallback (get, set):*

Это свойство задает функцию, которая должна вызываться при сбое для взаимодействия с веб-службы. Он должен получать делегата (или ссылка на функцию).

Справочник по функциям, заданного этим свойством должен иметь следующую сигнатуру:

[!code-javascript[Main](understanding-asp-net-ajax-authentication-and-profile-application-services/samples/sample9.js)]

*Параметры:*

| **имени параметра** | **Значение** |
| --- | --- |
| Error | Указывает сведения об ошибке. |
| userContext | Указывает сведения о контексте пользователя, предоставленных во загрузки или сохранения функция была вызвана. |
| methodName | Имя вызывающего метода. |

*Свойство defaultSaveCompleted (get, set):*

Это свойство задает функцию, которая должна вызываться после завершения сохранения данных профиля пользователя. Он должен получать делегата (или ссылка на функцию).

Справочник по функциям, заданного этим свойством должен иметь следующую сигнатуру:

[!code-javascript[Main](understanding-asp-net-ajax-authentication-and-profile-application-services/samples/sample10.js)]

*Параметры:*

| **имени параметра** | **Значение** |
| --- | --- |
| numPropsSaved | Указывает число свойств, которые были сохранены. |
| userContext | Указывает сведения о контексте пользователя, предоставленных во загрузки или сохранения функция была вызвана. |
| methodName | Имя вызывающего метода. |

*Свойство defaultLoadCompleted (get, set):*

Это свойство задает функцию, которая должна вызываться после завершения загрузки данных профиля пользователя. Он должен получать делегата (или ссылка на функцию).

Справочник по функциям, заданного этим свойством должен иметь следующую сигнатуру:

[!code-javascript[Main](understanding-asp-net-ajax-authentication-and-profile-application-services/samples/sample11.js)]

*Параметры:*

| **имени параметра** | **Значение** |
| --- | --- |
| numPropsLoaded | Указывает количество загружаемых свойств. |
| userContext | Указывает сведения о контексте пользователя, предоставленных во загрузки или сохранения функция была вызвана. |
| methodName | Имя вызывающего метода. |

*Свойство Path (get, set):*

Программным образом, это свойство определяет расположение профиля веб-службы. Он может использоваться для переопределения поставщика службы профиля по умолчанию, а также один декларативно задать в свойстве путь элемента управления ScriptManager ProfileService дочернего узла.

Обратите внимание на то, что расположение службы профиля по умолчанию не изменяется. Тем не менее ASP.NET AJAX позволяет вам указать расположение веб-службы, который предоставляет тот же интерфейс класса, как прокси-службы проверки подлинности ASP.NET AJAX.

Обратите внимание, что это свойство не задается значение, которое направляет запрос скрипта сайт текущего сайта. Базовые технологии AJAX не следует опубликовать межсайтовых запросов и может создавать исключение безопасности в клиентском браузере.

Это свойство является `String` объект, представляющий путь к веб-службе профиля.

*свойство времени ожидания (get, set):*

Это свойство определяет, что произошел сбой продолжительность времени ожидания для службы профиля при условии, что нагрузки или сохранить запрос. Если время ожидания истекло при ожидании завершения вызова, будет вызван обратный вызов не удалось выполнить запрос и вызов не будет завершен.

Это свойство является `Number` объект, представляющий количество миллисекунд для ожидания результатов от службы профиля.

*Пример кода: Загрузка профиля данных при загрузке страницы*

Следующий код проверяет, является ли пользователь проверку подлинности и если да, что и страница загрузит пользователя предпочтительный фоновый цвет.

[!code-javascript[Main](understanding-asp-net-ajax-authentication-and-profile-application-services/samples/sample12.js)]

## *<a name="using-a-custom-authentication-service-provider"></a>С помощью настраиваемого поставщика проверки подлинности службы*

Расширения AJAX для ASP.NET позволяют создать поставщик службы проверки подлинности пользовательского скрипта, предоставляя вашей функциональные возможности с помощью пользовательского веб-службы. Чтобы использовать веб-службы должны предоставлять два метода `Login` и `Logout`; и эти методы должны быть указаны с той же подписью метода веб-служба проверки подлинности AJAX ASP.NET по умолчанию.

После создания пользовательского веб-службы, вам нужно будет указать путь к нему, либо декларативно на странице программно в коде или с помощью клиентского скрипта.

*Чтобы декларативно задать путь:*

Чтобы задать путь декларативно, включите AuthenticationService дочернего объекта ScriptManager на странице ASP.NET:

[!code-aspx[Main](understanding-asp-net-ajax-authentication-and-profile-application-services/samples/sample13.aspx)]

*Чтобы задать путь в коде:*

Чтобы задать путь программно, укажите путь через экземпляр диспетчера скриптов:

[!code-csharp[Main](understanding-asp-net-ajax-authentication-and-profile-application-services/samples/sample14.cs)]

*Чтобы задать путь в скрипте:*

Для присвоения пути к программным образом в скрипте, использовать `path` свойство класса AuthenticationService:

[!code-javascript[Main](understanding-asp-net-ajax-authentication-and-profile-application-services/samples/sample15.js)]

*Пример веб-службы для пользовательской проверки подлинности*

[!code-aspx[Main](understanding-asp-net-ajax-authentication-and-profile-application-services/samples/sample16.aspx)]

## <a name="summary"></a>Сводка

Службы ASP.NET — в частности служб профилирования, членства и проверки подлинности - легко доступны JavaScript в браузере клиента. Это позволяет разработчикам интегр их код на стороне клиента с помощью механизма проверки подлинности, вне зависимости от элементов управления, такие как элементы UpdatePanel для выполнения тяжелой работы. Данные профиля можно защитить от клиента, за счет использования параметров веб-конфигурации; данные недоступны по умолчанию, и разработчики должны согласиться на свойства профиля.

Кроме того создавая упрощенный веб-службами с помощью подписей эквивалентного метода, разработчики могут создавать поставщиков пользовательских скриптов для этих встроенных служб ASP.NET. Поддержка этих методов упрощает разработку полнофункциональных клиентских приложений, одновременно обеспечивая разработчикам широкий спектр гибкость в соответствии с конкретными потребностями.

## *<a name="bio"></a>Биография*

(Scott cate) работает с веб-технологиями Microsoft с 1997 года и является президентом myKB.com ([www.myKB.com](http://www.myKB.com)) приложений, внимание уделяется знаний программных решений, где он специализируется на написание ASP.NET на основе. Скоттом можно связаться по электронной почте [ scott.cate@myKB.com ](mailto:scott.cate@myKB.com) или его блог по адресу [ScottCate.com](http://ScottCate.com)

> [!div class="step-by-step"]
> [Назад](understanding-asp-net-ajax-updatepanel-triggers.md)
> [Вперед](understanding-asp-net-ajax-localization.md)
