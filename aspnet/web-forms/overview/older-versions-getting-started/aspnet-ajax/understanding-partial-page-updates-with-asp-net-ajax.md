---
uid: web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-partial-page-updates-with-asp-net-ajax
title: Основные сведения об обновлениях частичной страницы с помощью ASP.NET AJAX | Документация Майкрософт
author: scottcate
description: Возможно, наиболее видимой функцией расширений AJAX ASP.NET является возможность выполнения частичного или добавочного обновления страницы без выполнения полной обратной передачи в t...
ms.author: riande
ms.date: 03/28/2008
ms.assetid: 54d9df99-1161-4899-b4e8-2679c85915e7
msc.legacyurl: /web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-partial-page-updates-with-asp-net-ajax
msc.type: authoredcontent
ms.openlocfilehash: 4b87cb8f58dbd7f27b16bcb0d488ff361770d4fe
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74623001"
---
# <a name="understanding-partial-page-updates-with-aspnet-ajax"></a><span data-ttu-id="43d48-103">Общие сведения о частичных обновлениях страниц с помощью ASP.NET AJAX</span><span class="sxs-lookup"><span data-stu-id="43d48-103">Understanding Partial Page Updates with ASP.NET AJAX</span></span>

<span data-ttu-id="43d48-104">по [Скотт Cate](https://github.com/scottcate)</span><span class="sxs-lookup"><span data-stu-id="43d48-104">by [Scott Cate](https://github.com/scottcate)</span></span>

[<span data-ttu-id="43d48-105">Загрузить PDF-файл</span><span class="sxs-lookup"><span data-stu-id="43d48-105">Download PDF</span></span>](https://download.microsoft.com/download/C/1/9/C19A3451-1D14-477C-B703-54EF22E197EE/AJAX_tutorial01_Partial_Page_Updates_cs.pdf)

> <span data-ttu-id="43d48-106">Возможно, наиболее видимой функцией расширений AJAX ASP.NET является возможность выполнять частичное или добавочное обновление страницы без выполнения полной обратной передачи на сервер, не внося изменений в код и минимальных изменений разметки.</span><span class="sxs-lookup"><span data-stu-id="43d48-106">Perhaps the most visible feature of the ASP.NET AJAX Extensions is the ability to do a partial or incremental page updates without doing a full postback to the server, with no code changes and minimal markup changes.</span></span> <span data-ttu-id="43d48-107">Преимущества очень обширны — состояние мультимедиа (например, Adobe Flash или Windows Media) не изменяется, затраты на пропускную способность уменьшаются, и клиент не может столкнуться с мерцанием, обычно связанным с обратной передачей.</span><span class="sxs-lookup"><span data-stu-id="43d48-107">The advantages are extensive – the state of your multimedia (such as Adobe Flash or Windows Media) is unchanged, bandwidth costs are reduced, and the client does not experience the flicker usually associated with a postback.</span></span>

## <a name="introduction"></a><span data-ttu-id="43d48-108">Введение</span><span class="sxs-lookup"><span data-stu-id="43d48-108">Introduction</span></span>

<span data-ttu-id="43d48-109">Технология ASP.NET Майкрософт предоставляет объектно-ориентированную и основанную на событиях модель программирования и объединяет их с преимуществами скомпилированного кода.</span><span class="sxs-lookup"><span data-stu-id="43d48-109">Microsoft's ASP.NET technology brings an object-oriented and event-driven programming model and unites it with the benefits of compiled code.</span></span> <span data-ttu-id="43d48-110">Однако модель обработки на стороне сервера имеет несколько недостатков, присущих этой технологии:</span><span class="sxs-lookup"><span data-stu-id="43d48-110">However, its server-side processing model has several drawbacks inherent in the technology:</span></span>

- <span data-ttu-id="43d48-111">Для обновления страниц требуется циклический обмен данными с сервером, для которого требуется обновление страницы.</span><span class="sxs-lookup"><span data-stu-id="43d48-111">Page updates require a round-trip to the server, which requires a page refresh.</span></span>
- <span data-ttu-id="43d48-112">Круговые передачи не сохраняют никаких эффектов, созданных JavaScript или другими клиентскими технологиями (например, Adobe Flash).</span><span class="sxs-lookup"><span data-stu-id="43d48-112">Round-trips do not persist any effects generated by Javascript or other client-side technology (such as Adobe Flash)</span></span>
- <span data-ttu-id="43d48-113">Во время обратной передачи браузеры, отличные от Microsoft Internet Explorer, не поддерживают автоматическое восстановление расположения прокрутки.</span><span class="sxs-lookup"><span data-stu-id="43d48-113">During postback, browsers other than Microsoft Internet Explorer do not support automatically restoring the scroll position.</span></span> <span data-ttu-id="43d48-114">Даже в Internet Explorer по мере обновления страницы все равно возникает мерцание.</span><span class="sxs-lookup"><span data-stu-id="43d48-114">And even in Internet Explorer, there is still a flicker as the page is refreshed.</span></span>
- <span data-ttu-id="43d48-115">Обратная передача может занимать большой объем пропускной способности, так как размер поля формы \_\_VIEWSTATE может увеличиваться, особенно при работе с такими элементами управления, как GridView или Repeater.</span><span class="sxs-lookup"><span data-stu-id="43d48-115">Postbacks may involve a high amount of bandwidth as the \_\_VIEWSTATE form field may grow, especially when dealing with controls such as the GridView control or repeaters.</span></span>
- <span data-ttu-id="43d48-116">Нет единой модели для доступа к веб-службам с помощью JavaScript или другой клиентской технологии.</span><span class="sxs-lookup"><span data-stu-id="43d48-116">There is no unified model for accessing Web Services through JavaScript or other client-side technology.</span></span>

<span data-ttu-id="43d48-117">Введите расширения AJAX для Microsoft ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="43d48-117">Enter Microsoft's ASP.NET AJAX extensions.</span></span> <span data-ttu-id="43d48-118">AJAX, который **означает синхронный** **J** аваскрипт A ND **X** ml, представляет собой интегрированную платформу для обеспечения добавочных обновлений страниц **с** помощью межплатформенного сценария JavaScript, состоящего из кода на стороне сервера, включающего платформу Microsoft AJAX Framework, и компонента скрипта, который называется библиотекой скриптов Microsoft AJAX.</span><span class="sxs-lookup"><span data-stu-id="43d48-118">AJAX, which stands for **A** synchronous **J** avaScript **A** nd **X** ML, is an integrated framework for providing incremental page updates via cross-platform JavaScript, composed of server-side code comprising the Microsoft AJAX Framework, and a script component called the Microsoft AJAX Script Library.</span></span> <span data-ttu-id="43d48-119">Расширения AJAX ASP.NET также обеспечивают кросс-платформенную поддержку для доступа к веб-службам ASP.NET через JavaScript.</span><span class="sxs-lookup"><span data-stu-id="43d48-119">The ASP.NET AJAX extensions also provide cross-platform support for accessing ASP.NET Web Services via JavaScript.</span></span>

<span data-ttu-id="43d48-120">В этом техническом документе рассматриваются функции частичного обновления страниц для расширений AJAX ASP.NET, включая компонент ScriptManager, элемент управления UpdatePanel и элемент управления UpdateProgress, и рассматриваются сценарии, в которых они должны или не должны быть используется.</span><span class="sxs-lookup"><span data-stu-id="43d48-120">This whitepaper examines the partial page updates functionality of the ASP.NET AJAX Extensions, which includes the ScriptManager component, the UpdatePanel control, and the UpdateProgress control, and considers scenarios in which they should or should not be utilized.</span></span>

<span data-ttu-id="43d48-121">Этот технический документ основан на выпуске бета-версии 2 Visual Studio 2008 и .NET Framework 3,5, который интегрирует расширения AJAX ASP.NET в библиотеку базовых классов (где ранее был добавлен компонент, доступный для ASP.NET 2,0).</span><span class="sxs-lookup"><span data-stu-id="43d48-121">This whitepaper is based on the Beta 2 release of the Visual Studio 2008 and the .NET Framework 3.5, which integrates the ASP.NET AJAX Extensions into the Base Class Library (where it was previously an add-on component available for ASP.NET 2.0).</span></span> <span data-ttu-id="43d48-122">В этом техническом документе также предполагается, что вы используете Visual Studio 2008, а не Visual Web Developer Express Edition. Некоторые шаблоны проектов, на которые имеются ссылки, могут быть недоступны пользователям Visual Web Developer Express.</span><span class="sxs-lookup"><span data-stu-id="43d48-122">This whitepaper also assumes that you are using Visual Studio 2008 and not Visual Web Developer Express Edition; some project templates that are referenced may not be available to Visual Web Developer Express users.</span></span>

## <a name="partial-page-updates"></a><span data-ttu-id="43d48-123">Частичные обновления страниц</span><span class="sxs-lookup"><span data-stu-id="43d48-123">Partial Page Updates</span></span>

<span data-ttu-id="43d48-124">Возможно, наиболее видимой функцией расширений AJAX ASP.NET является возможность выполнять частичное или добавочное обновление страницы без выполнения полной обратной передачи на сервер, не внося изменений в код и минимальных изменений разметки.</span><span class="sxs-lookup"><span data-stu-id="43d48-124">Perhaps the most visible feature of the ASP.NET AJAX Extensions is the ability to do a partial or incremental page updates without doing a full postback to the server, with no code changes and minimal markup changes.</span></span> <span data-ttu-id="43d48-125">Преимущества очень обширны — состояние мультимедиа (например, Adobe Flash или Windows Media) не изменяется, затраты на пропускную способность уменьшаются, и клиент не может столкнуться с мерцанием, обычно связанным с обратной передачей.</span><span class="sxs-lookup"><span data-stu-id="43d48-125">The advantages are extensive - the state of your multimedia (such as Adobe Flash or Windows Media) is unchanged, bandwidth costs are reduced, and the client does not experience the flicker usually associated with a postback.</span></span>

<span data-ttu-id="43d48-126">Возможность интеграции частичной отрисовки страниц интегрирована в ASP.NET с минимальными изменениями в проекте.</span><span class="sxs-lookup"><span data-stu-id="43d48-126">The ability to integrate partial page rendering is integrated into ASP.NET with minimal changes into your project.</span></span>

## <a name="walkthrough-integrating-partial-rendering-into-an-existing-project"></a><span data-ttu-id="43d48-127">Пошаговое руководство. Интеграция частичной визуализации в существующий проект</span><span class="sxs-lookup"><span data-stu-id="43d48-127">Walkthrough: Integrating Partial Rendering into an Existing Project</span></span>

1. <span data-ttu-id="43d48-128">В Microsoft Visual Studio 2008 создайте новый проект веб-сайта ASP.NET, последовательно выбрав <em>файл</em> <em>-&gt; новый</em> <em>-&gt; веб-сайт</em> и выбрав в диалоговом окне веб-сайт ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="43d48-128">In Microsoft Visual Studio 2008, create a new ASP.NET Web Site project by going to <em>File</em><em>-&gt; New</em><em>-&gt; Web Site</em> and selecting ASP.NET Web Site from the dialog.</span></span> <span data-ttu-id="43d48-129">Можно присвоить ему любое имя и установить его либо в файловую систему, либо в службы IIS (IIS).</span><span class="sxs-lookup"><span data-stu-id="43d48-129">You can name it whatever you like, and you may install it either to the file system or into Internet Information Services (IIS).</span></span>
2. <span data-ttu-id="43d48-130">Отобразится пустая страница по умолчанию с базовой разметкой ASP.NET (форма на стороне сервера и директива `@Page`).</span><span class="sxs-lookup"><span data-stu-id="43d48-130">You will be presented with the blank default page with basic ASP.NET markup (a server-side form and an `@Page` directive).</span></span> <span data-ttu-id="43d48-131">Перетащите метку с именем `Label1` и кнопку с именем `Button1` на страницу в элементе Form.</span><span class="sxs-lookup"><span data-stu-id="43d48-131">Drop a Label called `Label1` and a Button called `Button1` onto the page within the form element.</span></span> <span data-ttu-id="43d48-132">Можно задать свои свойства текста по своему усмотрению.</span><span class="sxs-lookup"><span data-stu-id="43d48-132">You may set their text properties to whatever you like.</span></span>
3. <span data-ttu-id="43d48-133">В представление конструирования дважды щелкните `Button1`, чтобы создать обработчик событий кода программной части.</span><span class="sxs-lookup"><span data-stu-id="43d48-133">In Design view, double-click `Button1` to generate a code-behind event handler.</span></span> <span data-ttu-id="43d48-134">В этом обработчике событий задайте `Label1.Text`, щелкнув кнопку!</span><span class="sxs-lookup"><span data-stu-id="43d48-134">Within this event handler, set `Label1.Text` to You clicked the button!</span></span> <span data-ttu-id="43d48-135">.</span><span class="sxs-lookup"><span data-stu-id="43d48-135">.</span></span>

<span data-ttu-id="43d48-136">**Листинг 1. Разметка для Default. aspx перед включением частичной визуализации**</span><span class="sxs-lookup"><span data-stu-id="43d48-136">**Listing 1: Markup for default.aspx before partial rendering is enabled**</span></span>

[!code-aspx[Main](understanding-partial-page-updates-with-asp-net-ajax/samples/sample1.aspx)]

<span data-ttu-id="43d48-137">**Листинг 2: CodeBehind (обрезанный) в default.aspx.cs**</span><span class="sxs-lookup"><span data-stu-id="43d48-137">**Listing 2: Codebehind (trimmed) in default.aspx.cs**</span></span>

[!code-csharp[Main](understanding-partial-page-updates-with-asp-net-ajax/samples/sample2.cs)]

1. <span data-ttu-id="43d48-138">Нажмите клавишу F5, чтобы запустить веб-сайт.</span><span class="sxs-lookup"><span data-stu-id="43d48-138">Press F5 to launch your web site.</span></span> <span data-ttu-id="43d48-139">Visual Studio предложит добавить файл Web. config, чтобы включить отладку; Сделайте это.</span><span class="sxs-lookup"><span data-stu-id="43d48-139">Visual Studio will prompt you to add a web.config file to enable debugging; do so.</span></span> <span data-ttu-id="43d48-140">При нажатии кнопки Обратите внимание, что страница обновляется для изменения текста в метке, и при перерисовке страницы возникает небольшая мерцание.</span><span class="sxs-lookup"><span data-stu-id="43d48-140">When you click the button, notice that the page refreshes to change the text in the label, and there is a brief flicker as the page is redrawn.</span></span>
2. <span data-ttu-id="43d48-141">После закрытия окна браузера вернитесь в Visual Studio и на страницу разметки.</span><span class="sxs-lookup"><span data-stu-id="43d48-141">After closing your browser window, return to Visual Studio and to the markup page.</span></span> <span data-ttu-id="43d48-142">Прокрутите окно вниз на панели элементов Visual Studio и найдите вкладку расширения AJAX.</span><span class="sxs-lookup"><span data-stu-id="43d48-142">Scroll down in the Visual Studio toolbox, and find the tab labeled AJAX Extensions.</span></span> <span data-ttu-id="43d48-143">(Если эта вкладка отсутствует, поскольку используется более старая версия расширений AJAX или Atlas, см. Пошаговое руководство по регистрации элементов инструментария расширений AJAX далее в этом техническом документе или установка текущей версии с установщик Windows скачать. с веб-сайта).</span><span class="sxs-lookup"><span data-stu-id="43d48-143">(If you do not have this tab because you are using an older version of AJAX or Atlas extensions, refer to the walkthrough for registering the AJAX Extensions toolbox items later in this whitepaper, or install the current version with the Windows Installer downloadable from the website).</span></span>

[![](understanding-partial-page-updates-with-asp-net-ajax/_static/image2.png)](understanding-partial-page-updates-with-asp-net-ajax/_static/image1.png)

<span data-ttu-id="43d48-144">([Щелкните, чтобы просмотреть изображение с полным размером](understanding-partial-page-updates-with-asp-net-ajax/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="43d48-144">([Click to view full-size image](understanding-partial-page-updates-with-asp-net-ajax/_static/image3.png))</span></span>

1. <span data-ttu-id="43d48-145"><em>Известная ошибка:</em> При установке Visual Studio 2008 на компьютер, на котором уже установлена Visual Studio 2005 с расширениями AJAX ASP.NET 2,0, Visual Studio 2008 импортирует элементы панели элементов расширений AJAX.</span><span class="sxs-lookup"><span data-stu-id="43d48-145"><em>Known Issue:</em>If you install Visual Studio 2008 onto a computer that already has Visual Studio 2005 installed with the ASP.NET 2.0 AJAX Extensions, Visual Studio 2008 will import the AJAX Extensions toolbox items.</span></span> <span data-ttu-id="43d48-146">Определить, является ли это случайным, можно, изучив подсказку компонентов. они должны сказать версию 3.5.0.0.</span><span class="sxs-lookup"><span data-stu-id="43d48-146">You can determine whether this is the case by examining the tooltip of the components; they should say Version 3.5.0.0.</span></span> <span data-ttu-id="43d48-147">Если они говорят как версия 2.0.0.0, вы импортировали старые элементы панели элементов и вам потребуется вручную импортировать их с помощью диалогового окна Выбор элементов панели элементов в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="43d48-147">If they say Version 2.0.0.0, then you have imported your old toolbox items, and will need to manually import them by using the Choose Toolbox Items dialog in Visual Studio.</span></span> <span data-ttu-id="43d48-148">Вы не сможете добавить элементы управления версии 2 с помощью конструктора.</span><span class="sxs-lookup"><span data-stu-id="43d48-148">You will be unable to add Version 2 controls via the designer.</span></span>

2. <span data-ttu-id="43d48-149">Перед началом тега `<asp:Label>` создайте строку пробелов и дважды щелкните элемент управления UpdatePanel на панели элементов.</span><span class="sxs-lookup"><span data-stu-id="43d48-149">Before the `<asp:Label>` tag begins, create a line of whitespace, and double-click on the UpdatePanel control in the toolbox.</span></span> <span data-ttu-id="43d48-150">Обратите внимание, что в верхней части страницы включена новая директива `@Register`, указывающая, что элементы управления в пространстве имен System. Web. UI следует импортировать с помощью префикса `asp:`.</span><span class="sxs-lookup"><span data-stu-id="43d48-150">Note that a new `@Register` directive is included at the top of the page, indicating that controls within the System.Web.UI namespace should be imported using the `asp:` prefix.</span></span>
3. <span data-ttu-id="43d48-151">Перетащите закрывающий тег `</asp:UpdatePanel>` после конца элемента Button, чтобы элемент был правильно сформирован с помощью элемента управления Label и Button.</span><span class="sxs-lookup"><span data-stu-id="43d48-151">Drag the closing `</asp:UpdatePanel>` tag past the end of the Button element, so that the element is well-formed with the Label and Button controls wrapped.</span></span>
4. <span data-ttu-id="43d48-152">После открывающего тега `<asp:UpdatePanel>` Начните открывать новый тег.</span><span class="sxs-lookup"><span data-stu-id="43d48-152">After the opening `<asp:UpdatePanel>` tag, begin opening a new tag.</span></span> <span data-ttu-id="43d48-153">Обратите внимание, что IntelliSense предлагает два варианта.</span><span class="sxs-lookup"><span data-stu-id="43d48-153">Note that IntelliSense prompts you with two options.</span></span> <span data-ttu-id="43d48-154">В этом случае создайте тег `<ContentTemplate>`.</span><span class="sxs-lookup"><span data-stu-id="43d48-154">In this case, create a `<ContentTemplate>` tag.</span></span> <span data-ttu-id="43d48-155">Не забудьте поместить этот тег вокруг метки и кнопки, чтобы разметка была правильно сформирована.</span><span class="sxs-lookup"><span data-stu-id="43d48-155">Be sure to wrap this tag around your Label and Button so that the markup is well-formed.</span></span>

[![](understanding-partial-page-updates-with-asp-net-ajax/_static/image5.png)](understanding-partial-page-updates-with-asp-net-ajax/_static/image4.png)

<span data-ttu-id="43d48-156">([Щелкните, чтобы просмотреть изображение с полным размером](understanding-partial-page-updates-with-asp-net-ajax/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="43d48-156">([Click to view full-size image](understanding-partial-page-updates-with-asp-net-ajax/_static/image6.png))</span></span>

1. <span data-ttu-id="43d48-157">В любом месте элемента `<form>` включите элемент управления ScriptManager, дважды щелкнув элемент `ScriptManager` на панели элементов.</span><span class="sxs-lookup"><span data-stu-id="43d48-157">Anywhere within the `<form>` element, include a ScriptManager control by double-clicking on the `ScriptManager` item in the toolbox.</span></span>
2. <span data-ttu-id="43d48-158">Измените тег `<asp:ScriptManager>`, чтобы он включал `EnablePartialRendering= true`атрибута.</span><span class="sxs-lookup"><span data-stu-id="43d48-158">Edit the `<asp:ScriptManager>` tag so that it includes the attribute `EnablePartialRendering= true`.</span></span>

<span data-ttu-id="43d48-159">**Листинг 3. Разметка для Default. aspx с включенной частичной отрисовкой**</span><span class="sxs-lookup"><span data-stu-id="43d48-159">**Listing 3: Markup for default.aspx with partial rendering enabled**</span></span>

[!code-aspx[Main](understanding-partial-page-updates-with-asp-net-ajax/samples/sample3.aspx)]

1. <span data-ttu-id="43d48-160">Откройте файл Web. config.</span><span class="sxs-lookup"><span data-stu-id="43d48-160">Open your web.config file.</span></span> <span data-ttu-id="43d48-161">Обратите внимание, что Visual Studio автоматически добавила ссылку на компиляцию в библиотеку System. Web. Extensions. dll.</span><span class="sxs-lookup"><span data-stu-id="43d48-161">Notice that Visual Studio has automatically added a compilation reference to System.Web.Extensions.dll.</span></span>

1. <span data-ttu-id="43d48-162">Новые возможности Visual Studio 2008: файл Web. config, поставляемый с шаблонами проекта веб-сайта ASP.NET, автоматически включает все необходимые ссылки на расширения AJAX ASP.NET и включает разделы с комментариями в сведениях о конфигурации, которые могут быть некомментирование для включения дополнительных функций.</span><span class="sxs-lookup"><span data-stu-id="43d48-162">What's New in Visual Studio 2008: The web.config that comes with the ASP.NET Web Site project templates automatically includes all necessary references to the ASP.NET AJAX Extensions, and includes commented sections of configuration information that can be un-commented to enable additional functionality.</span></span> <span data-ttu-id="43d48-163">В Visual Studio 2005 существовали похожие шаблоны при установке расширений AJAX ASP.NET 2,0.</span><span class="sxs-lookup"><span data-stu-id="43d48-163">Visual Studio 2005 had similar templates when ASP.NET 2.0 AJAX Extensions were installed.</span></span> <span data-ttu-id="43d48-164">Однако в Visual Studio 2008 расширения AJAX являются отказаться по умолчанию (то есть на них ссылаются по умолчанию, но их можно удалить в виде ссылок).</span><span class="sxs-lookup"><span data-stu-id="43d48-164">However, in Visual Studio 2008, the AJAX Extensions are opt-out by default (that is, they are referenced by default, but can be removed as references).</span></span>

[![](understanding-partial-page-updates-with-asp-net-ajax/_static/image8.png)](understanding-partial-page-updates-with-asp-net-ajax/_static/image7.png)

<span data-ttu-id="43d48-165">([Щелкните, чтобы просмотреть изображение с полным размером](understanding-partial-page-updates-with-asp-net-ajax/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="43d48-165">([Click to view full-size image](understanding-partial-page-updates-with-asp-net-ajax/_static/image9.png))</span></span>

1. <span data-ttu-id="43d48-166">Нажмите клавишу F5, чтобы запустить веб-сайт.</span><span class="sxs-lookup"><span data-stu-id="43d48-166">Press F5 to launch your website.</span></span> <span data-ttu-id="43d48-167">Обратите внимание, что изменения исходного кода не требовались для поддержки частичной отрисовки разметки.</span><span class="sxs-lookup"><span data-stu-id="43d48-167">Note how no source code changes were required to support partial rendering - only markup was changed.</span></span>

<span data-ttu-id="43d48-168">При запуске веб-сайта вы увидите, что частичная визуализация теперь включена, так как при нажатии кнопки не будет мерцания, а также не будет никаких изменений в положении прокрутки страницы (в этом примере это не демонстрируется).</span><span class="sxs-lookup"><span data-stu-id="43d48-168">When you launch your website, you should see that partial rendering is now enabled, because when you click on the button there will be no flicker, nor will there be any change in the page scroll position (this example does not demonstrate that).</span></span> <span data-ttu-id="43d48-169">Если после нажатия кнопки вы хотите взглянуть на отображаемый источник страницы, он подтвердит, что на самом деле не выполнена обратная передача — исходный текст метки по-прежнему является частью исходной разметки, а метка изменилась с помощью JavaScript.</span><span class="sxs-lookup"><span data-stu-id="43d48-169">If you were to look at the rendered source of the page after clicking the button, it will confirm that in fact a post-back has not occurred - the original label text is still part of the source markup, and the label has changed through JavaScript.</span></span>

<span data-ttu-id="43d48-170">Visual Studio 2008 не поставляется с предварительно определенным шаблоном для веб-сайта с поддержкой AJAX ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="43d48-170">Visual Studio 2008 does not appear to come with a pre-defined template for an ASP.NET AJAX-Enabled web site.</span></span> <span data-ttu-id="43d48-171">Однако такой шаблон был доступен в Visual Studio 2005, если установлены расширения AJAX для Visual Studio 2005 и ASP.NET 2,0.</span><span class="sxs-lookup"><span data-stu-id="43d48-171">However, such a template was available within Visual Studio 2005 if the Visual Studio 2005 and ASP.NET 2.0 AJAX Extensions were installed.</span></span> <span data-ttu-id="43d48-172">Таким образом, Настройка веб-сайта и запуск шаблона веб-сайта с поддержкой AJAX, скорее всего, будут еще проще, так как шаблон должен включать полностью настроенный файл Web. config (поддерживающий все расширения ASP.NET AJAX, включая доступ к веб-службам). и сериализация JSON — нотация объектов JavaScript), которая по умолчанию включает UpdatePanel и ContentTemplate на главной странице веб-форм.</span><span class="sxs-lookup"><span data-stu-id="43d48-172">Consequently, configuring a web site and starting with the AJAX-Enabled Web Site template will likely be even easier, as the template should include a fully-configured web.config file (supporting all of the ASP.NET AJAX Extensions, including Web Services access and JSON serialization - JavaScript Object Notation) and includes an UpdatePanel and ContentTemplate within the main Web Forms page by default.</span></span> <span data-ttu-id="43d48-173">Включение частичной визуализации со страницей по умолчанию сводится к переходу на шаг 10 из этого пошагового руководства и перетаскивании элементов управления на страницу.</span><span class="sxs-lookup"><span data-stu-id="43d48-173">Enabling partial rendering with this default page is as simple as revisiting Step 10 of this walkthrough and dropping controls onto the page.</span></span>

## <a name="the-scriptmanager-control"></a><span data-ttu-id="43d48-174">Элемент управления ScriptManager</span><span class="sxs-lookup"><span data-stu-id="43d48-174">The ScriptManager Control</span></span>

## <a name="scriptmanager-control-reference"></a><span data-ttu-id="43d48-175">Справочник по элементу управления ScriptManager</span><span class="sxs-lookup"><span data-stu-id="43d48-175">ScriptManager Control Reference</span></span>

<span data-ttu-id="43d48-176">Свойства с поддержкой разметки:</span><span class="sxs-lookup"><span data-stu-id="43d48-176">Markup-Enabled Properties:</span></span>

| <span data-ttu-id="43d48-177">**Имя свойства**</span><span class="sxs-lookup"><span data-stu-id="43d48-177">**Property Name**</span></span> | <span data-ttu-id="43d48-178">**Type**</span><span class="sxs-lookup"><span data-stu-id="43d48-178">**Type**</span></span> | <span data-ttu-id="43d48-179">**Описание**</span><span class="sxs-lookup"><span data-stu-id="43d48-179">**Description**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="43d48-180">Алловкустомеррорс — перенаправление</span><span class="sxs-lookup"><span data-stu-id="43d48-180">AllowCustomErrors-Redirect</span></span> | <span data-ttu-id="43d48-181">Bool</span><span class="sxs-lookup"><span data-stu-id="43d48-181">Bool</span></span> | <span data-ttu-id="43d48-182">Указывает, следует ли использовать пользовательский раздел ошибок файла Web. config для работы с ошибками.</span><span class="sxs-lookup"><span data-stu-id="43d48-182">Specifies whether to use the custom error section of the web.config file to handle errors.</span></span> |
| <span data-ttu-id="43d48-183">Асинкпостбаккеррор — сообщение</span><span class="sxs-lookup"><span data-stu-id="43d48-183">AsyncPostBackError-Message</span></span> | <span data-ttu-id="43d48-184">Строковое</span><span class="sxs-lookup"><span data-stu-id="43d48-184">String</span></span> | <span data-ttu-id="43d48-185">Возвращает или задает сообщение об ошибке, отправляемое клиенту при возникновении ошибки.</span><span class="sxs-lookup"><span data-stu-id="43d48-185">Gets or sets the error message sent to the client if an error is raised.</span></span> |
| <span data-ttu-id="43d48-186">Асинкпостбакк — время ожидания</span><span class="sxs-lookup"><span data-stu-id="43d48-186">AsyncPostBack-Timeout</span></span> | <span data-ttu-id="43d48-187">Int32</span><span class="sxs-lookup"><span data-stu-id="43d48-187">Int32</span></span> | <span data-ttu-id="43d48-188">Возвращает или задает количество времени по умолчанию, по истечении которого клиент должен ожидать завершения асинхронного запроса.</span><span class="sxs-lookup"><span data-stu-id="43d48-188">Gets or sets the default amount of a time a client should wait for the asynchronous request to complete.</span></span> |
| <span data-ttu-id="43d48-189">Енаблескрипт — глобализация</span><span class="sxs-lookup"><span data-stu-id="43d48-189">EnableScript-Globalization</span></span> | <span data-ttu-id="43d48-190">Bool</span><span class="sxs-lookup"><span data-stu-id="43d48-190">Bool</span></span> | <span data-ttu-id="43d48-191">Возвращает или задает, включена ли глобализация скриптов.</span><span class="sxs-lookup"><span data-stu-id="43d48-191">Gets or sets whether script globalization is enabled.</span></span> |
| <span data-ttu-id="43d48-192">Енаблескрипт-локализация</span><span class="sxs-lookup"><span data-stu-id="43d48-192">EnableScript-Localization</span></span> | <span data-ttu-id="43d48-193">Bool</span><span class="sxs-lookup"><span data-stu-id="43d48-193">Bool</span></span> | <span data-ttu-id="43d48-194">Возвращает или задает, включена ли локализация скриптов.</span><span class="sxs-lookup"><span data-stu-id="43d48-194">Gets or sets whether script localization is enabled.</span></span> |
| <span data-ttu-id="43d48-195">скриптлоадтимеаут</span><span class="sxs-lookup"><span data-stu-id="43d48-195">ScriptLoadTimeout</span></span> | <span data-ttu-id="43d48-196">Int32</span><span class="sxs-lookup"><span data-stu-id="43d48-196">Int32</span></span> | <span data-ttu-id="43d48-197">Определяет количество секунд, разрешенное для загрузки скриптов в клиент</span><span class="sxs-lookup"><span data-stu-id="43d48-197">Determines the number of seconds allowed for loading scripts into the client</span></span> |
| <span data-ttu-id="43d48-198">скриптмоде</span><span class="sxs-lookup"><span data-stu-id="43d48-198">ScriptMode</span></span> | <span data-ttu-id="43d48-199">Enum (авто, отладка, выпуск, наследовать)</span><span class="sxs-lookup"><span data-stu-id="43d48-199">Enum (Auto, Debug, Release, Inherit)</span></span> | <span data-ttu-id="43d48-200">Возвращает или задает значение, указывающее, следует ли визуализировать окончательные версии скриптов</span><span class="sxs-lookup"><span data-stu-id="43d48-200">Gets or sets whether to render release versions of scripts</span></span> |
| <span data-ttu-id="43d48-201">ScriptPath</span><span class="sxs-lookup"><span data-stu-id="43d48-201">ScriptPath</span></span> | <span data-ttu-id="43d48-202">Строковое</span><span class="sxs-lookup"><span data-stu-id="43d48-202">String</span></span> | <span data-ttu-id="43d48-203">Возвращает или задает корневой путь к расположению файлов скрипта, отправляемых клиенту.</span><span class="sxs-lookup"><span data-stu-id="43d48-203">Gets or sets the root path to the location of script files to be sent to the client.</span></span> |

<span data-ttu-id="43d48-204">Свойства только для кода:</span><span class="sxs-lookup"><span data-stu-id="43d48-204">Code-Only Properties:</span></span>

| <span data-ttu-id="43d48-205">**Имя свойства**</span><span class="sxs-lookup"><span data-stu-id="43d48-205">**Property Name**</span></span> | <span data-ttu-id="43d48-206">**Type**</span><span class="sxs-lookup"><span data-stu-id="43d48-206">**Type**</span></span> | <span data-ttu-id="43d48-207">**Описание**</span><span class="sxs-lookup"><span data-stu-id="43d48-207">**Description**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="43d48-208">AuthenticationService</span><span class="sxs-lookup"><span data-stu-id="43d48-208">AuthenticationService</span></span> | <span data-ttu-id="43d48-209">Диспетчер AuthenticationService</span><span class="sxs-lookup"><span data-stu-id="43d48-209">AuthenticationService-Manager</span></span> | <span data-ttu-id="43d48-210">Возвращает сведения о прокси-сервере службы проверки подлинности ASP.NET, который будет отправлен клиенту.</span><span class="sxs-lookup"><span data-stu-id="43d48-210">Gets details about the ASP.NET Authentication Service proxy that will be sent to the client.</span></span> |
| <span data-ttu-id="43d48-211">исдебуггинженаблед</span><span class="sxs-lookup"><span data-stu-id="43d48-211">IsDebuggingEnabled</span></span> | <span data-ttu-id="43d48-212">Bool</span><span class="sxs-lookup"><span data-stu-id="43d48-212">Bool</span></span> | <span data-ttu-id="43d48-213">Возвращает, включена ли отладка скриптов и кода.</span><span class="sxs-lookup"><span data-stu-id="43d48-213">Gets whether script and code debugging is enabled.</span></span> |
| <span data-ttu-id="43d48-214">исинасинкпостбакк</span><span class="sxs-lookup"><span data-stu-id="43d48-214">IsInAsyncPostback</span></span> | <span data-ttu-id="43d48-215">Bool</span><span class="sxs-lookup"><span data-stu-id="43d48-215">Bool</span></span> | <span data-ttu-id="43d48-216">Возвращает значение, указывающее, находится ли страница в данный момент в асинхронном обратном запросе POST.</span><span class="sxs-lookup"><span data-stu-id="43d48-216">Gets whether the page is currently in an asynchronous post back request.</span></span> |
| <span data-ttu-id="43d48-217">ProfileService</span><span class="sxs-lookup"><span data-stu-id="43d48-217">ProfileService</span></span> | <span data-ttu-id="43d48-218">Диспетчер ProfileService-Manager</span><span class="sxs-lookup"><span data-stu-id="43d48-218">ProfileService-Manager</span></span> | <span data-ttu-id="43d48-219">Возвращает сведения о прокси-сервере службы профилирования ASP.NET, который будет отправлен клиенту.</span><span class="sxs-lookup"><span data-stu-id="43d48-219">Gets details about the ASP.NET Profiling Service proxy that will be sent to the client.</span></span> |
| <span data-ttu-id="43d48-220">Сценарии</span><span class="sxs-lookup"><span data-stu-id="43d48-220">Scripts</span></span> | <span data-ttu-id="43d48-221">Справочник по скрипту&lt;коллекции&gt;</span><span class="sxs-lookup"><span data-stu-id="43d48-221">Collection&lt;Script-Reference&gt;</span></span> | <span data-ttu-id="43d48-222">Возвращает коллекцию ссылок на скрипт, которые будут отправлены клиенту.</span><span class="sxs-lookup"><span data-stu-id="43d48-222">Gets a collection of script references that will be sent to the client.</span></span> |
| <span data-ttu-id="43d48-223">Службы</span><span class="sxs-lookup"><span data-stu-id="43d48-223">Services</span></span> | <span data-ttu-id="43d48-224">Ссылка на службу&lt;коллекции&gt;</span><span class="sxs-lookup"><span data-stu-id="43d48-224">Collection&lt;Service-Reference&gt;</span></span> | <span data-ttu-id="43d48-225">Возвращает коллекцию ссылок прокси веб-службы, которые будут отправлены клиенту.</span><span class="sxs-lookup"><span data-stu-id="43d48-225">Gets a collection of Web Service proxy references that will be sent to the client.</span></span> |
| <span data-ttu-id="43d48-226">SupportsPartialRendering</span><span class="sxs-lookup"><span data-stu-id="43d48-226">SupportsPartialRendering</span></span> | <span data-ttu-id="43d48-227">Bool</span><span class="sxs-lookup"><span data-stu-id="43d48-227">Bool</span></span> | <span data-ttu-id="43d48-228">Возвращает значение, указывающее, поддерживает ли текущий клиент частичную визуализацию.</span><span class="sxs-lookup"><span data-stu-id="43d48-228">Gets whether the current client supports partial rendering.</span></span> <span data-ttu-id="43d48-229">Если это свойство возвращает **значение false**, все запросы страниц будут стандартными обратными вызовами.</span><span class="sxs-lookup"><span data-stu-id="43d48-229">If this property returns **false**, then all page requests will be standard postbacks.</span></span> |

<span data-ttu-id="43d48-230">Методы открытого кода:</span><span class="sxs-lookup"><span data-stu-id="43d48-230">Public Code Methods:</span></span>

| <span data-ttu-id="43d48-231">**Имя метода**</span><span class="sxs-lookup"><span data-stu-id="43d48-231">**Method Name**</span></span> | <span data-ttu-id="43d48-232">**Type**</span><span class="sxs-lookup"><span data-stu-id="43d48-232">**Type**</span></span> | <span data-ttu-id="43d48-233">**Описание**</span><span class="sxs-lookup"><span data-stu-id="43d48-233">**Description**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="43d48-234">SetFocus (String)</span><span class="sxs-lookup"><span data-stu-id="43d48-234">SetFocus(string)</span></span> | <span data-ttu-id="43d48-235">Void</span><span class="sxs-lookup"><span data-stu-id="43d48-235">Void</span></span> | <span data-ttu-id="43d48-236">Устанавливает фокус клиента на определенный элемент управления после завершения запроса.</span><span class="sxs-lookup"><span data-stu-id="43d48-236">Sets the focus of the client to a particular control when the request has completed.</span></span> |

<span data-ttu-id="43d48-237">Дочерние элементы разметки:</span><span class="sxs-lookup"><span data-stu-id="43d48-237">Markup Descendants:</span></span>

| <span data-ttu-id="43d48-238">**Тегами**</span><span class="sxs-lookup"><span data-stu-id="43d48-238">**Tag**</span></span> | <span data-ttu-id="43d48-239">**Описание**</span><span class="sxs-lookup"><span data-stu-id="43d48-239">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="43d48-240">&lt;AuthenticationService&gt;</span><span class="sxs-lookup"><span data-stu-id="43d48-240">&lt;AuthenticationService&gt;</span></span> | <span data-ttu-id="43d48-241">Предоставляет сведения о прокси-сервере для службы проверки подлинности ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="43d48-241">Provides details about the proxy to the ASP.NET authentication service.</span></span> |
| <span data-ttu-id="43d48-242">&lt;ProfileService&gt;</span><span class="sxs-lookup"><span data-stu-id="43d48-242">&lt;ProfileService&gt;</span></span> | <span data-ttu-id="43d48-243">Предоставляет сведения о прокси-сервере для службы профилирования ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="43d48-243">Provides details about the proxy to the ASP.NET profiling service.</span></span> |
| <span data-ttu-id="43d48-244">&lt;Скрипты&gt;</span><span class="sxs-lookup"><span data-stu-id="43d48-244">&lt;Scripts&gt;</span></span> | <span data-ttu-id="43d48-245">Предоставляет дополнительные ссылки на скрипты.</span><span class="sxs-lookup"><span data-stu-id="43d48-245">Provides additional script references.</span></span> |
| <span data-ttu-id="43d48-246">&lt;ASP: ScriptReference&gt;</span><span class="sxs-lookup"><span data-stu-id="43d48-246">&lt;asp:ScriptReference&gt;</span></span> | <span data-ttu-id="43d48-247">Обозначает определенную ссылку на скрипт.</span><span class="sxs-lookup"><span data-stu-id="43d48-247">Denotes a specific script reference.</span></span> |
| <span data-ttu-id="43d48-248">&lt;Service&gt;</span><span class="sxs-lookup"><span data-stu-id="43d48-248">&lt;Service&gt;</span></span> | <span data-ttu-id="43d48-249">Предоставляет дополнительные ссылки на веб-службы, которые будут создаваться классами прокси.</span><span class="sxs-lookup"><span data-stu-id="43d48-249">Provides additional Web Service references which will have proxy classes generated.</span></span> |
| <span data-ttu-id="43d48-250">&lt;ASP: укзать&gt;</span><span class="sxs-lookup"><span data-stu-id="43d48-250">&lt;asp:ServiceReference&gt;</span></span> | <span data-ttu-id="43d48-251">Обозначает определенную ссылку на веб-службу.</span><span class="sxs-lookup"><span data-stu-id="43d48-251">Denotes a specific Web Service reference.</span></span> |

<span data-ttu-id="43d48-252">Элемент управления ScriptManager является основным ядром для расширений AJAX ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="43d48-252">The ScriptManager control is the essential core for the ASP.NET AJAX Extensions.</span></span> <span data-ttu-id="43d48-253">Он предоставляет доступ к библиотеке сценариев (включая обширную систему типов сценариев на стороне клиента), поддерживает частичную визуализацию и обеспечивает расширенную поддержку дополнительных служб ASP.NET (таких как проверка подлинности и профилирование, но также другие веб-службы).</span><span class="sxs-lookup"><span data-stu-id="43d48-253">It provides access to the script library (including the extensive client-side script type system), supports partial rendering, and provides extensive support for additional ASP.NET services (such as authentication and profiling, but also other Web Services).</span></span> <span data-ttu-id="43d48-254">Элемент управления ScriptManager также обеспечивает поддержку глобализации и локализации клиентских сценариев.</span><span class="sxs-lookup"><span data-stu-id="43d48-254">The ScriptManager control also provides globalization and localization support for the client scripts.</span></span>

## <a name="providing-alternative-and-supplemental-scripts"></a><span data-ttu-id="43d48-255">Предоставление альтернативных и дополнительных сценариев</span><span class="sxs-lookup"><span data-stu-id="43d48-255">Providing Alternative and Supplemental Scripts</span></span>

<span data-ttu-id="43d48-256">Хотя расширения AJAX для Microsoft ASP.NET 2,0 включают весь код скрипта как в отладочных, так и в выпусках выпуска как ресурсы, внедренные в упоминаемые сборки, разработчики могут перенаправить ScriptManager на настраиваемые файлы сценариев, а также зарегистрировать Дополнительные необходимые скрипты.</span><span class="sxs-lookup"><span data-stu-id="43d48-256">While the Microsoft ASP.NET 2.0 AJAX Extensions include the entire script code in both debug and release editions as resources embedded in the referenced assemblies, developers are free to redirect the ScriptManager to customized script files, as well as register additional necessary scripts.</span></span>

<span data-ttu-id="43d48-257">Чтобы переопределить привязку по умолчанию для обычно включаемых скриптов (например, для поддержки пространства имен sys. WebForms и пользовательской системы ввода), можно зарегистрировать событие `ResolveScriptReference` класса ScriptManager.</span><span class="sxs-lookup"><span data-stu-id="43d48-257">To override the default binding for the typically-included scripts (such as those which support the Sys.WebForms namespace and the custom typing system), you can register for the `ResolveScriptReference` event of the ScriptManager class.</span></span> <span data-ttu-id="43d48-258">При вызове этого метода обработчик событий имеет возможность изменить путь к файлу скрипта. затем Диспетчер скриптов отправляет клиенту другую или настроенную копию скриптов.</span><span class="sxs-lookup"><span data-stu-id="43d48-258">When this method is called, the event handler has the opportunity to change the path to the script file in question; the script manager will then send a different or customized copy of the scripts to the client.</span></span>

<span data-ttu-id="43d48-259">Кроме того, ссылки на скрипты (представленные классом `ScriptReference`) можно добавить программно или с помощью разметки.</span><span class="sxs-lookup"><span data-stu-id="43d48-259">Additionally, script references (represented by the `ScriptReference` class) can be included programmatically or via markup.</span></span> <span data-ttu-id="43d48-260">Для этого либо программно измените `ScriptManager.Scripts` коллекцию, либо включите теги `<asp:ScriptReference>` в тег `<Scripts>`, который является дочерним элементом первого уровня элемента управления ScriptManager.</span><span class="sxs-lookup"><span data-stu-id="43d48-260">To do so, either programmatically modify the `ScriptManager.Scripts` collection, or include `<asp:ScriptReference>` tags under the `<Scripts>` tag, which is a first-level child of the ScriptManager control.</span></span>

## <a name="custom-error-handling-for-updatepanels"></a><span data-ttu-id="43d48-261">Настраиваемая обработка ошибок для UpdatePanel</span><span class="sxs-lookup"><span data-stu-id="43d48-261">Custom Error Handling for UpdatePanels</span></span>

<span data-ttu-id="43d48-262">Хотя обновления обрабатываются триггерами, заданными элементами управления UpdatePanel, поддержка обработки ошибок и пользовательских сообщений об ошибках обрабатывается экземпляром элемента управления ScriptManager страницы.</span><span class="sxs-lookup"><span data-stu-id="43d48-262">Although updates are handled by triggers specified by UpdatePanel controls, the support for error handling and custom error messages is handled by a page's ScriptManager control instance.</span></span> <span data-ttu-id="43d48-263">Это делается путем предоставления на страницу события `AsyncPostBackError`, которое затем может предоставить настраиваемую логику обработки исключений.</span><span class="sxs-lookup"><span data-stu-id="43d48-263">This is done by exposing an event, `AsyncPostBackError`, to the page which can then provide custom exception-handling logic.</span></span>

<span data-ttu-id="43d48-264">Используя событие Асинкпостбаккеррор, можно указать свойство `AsyncPostBackErrorMessage`, которое затем вызывает появление окна предупреждения после завершения обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="43d48-264">By consuming the AsyncPostBackError event, you may specify the `AsyncPostBackErrorMessage` property, which then causes an alert box to be raised upon completion of the callback.</span></span>

<span data-ttu-id="43d48-265">Настройка на стороне клиента также возможна, вместо использования поля предупреждения по умолчанию. Например, может потребоваться отобразить настроенный элемент `<div>`, а не модальное диалоговое окно браузера по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="43d48-265">Client-side customization is also possible instead of using the default alert box; for instance, you may want to display a customized `<div>` element rather than the default browser modal dialog.</span></span> <span data-ttu-id="43d48-266">В этом случае ошибку можно решить в клиентском скрипте:</span><span class="sxs-lookup"><span data-stu-id="43d48-266">In this case, you can handle the error in client script:</span></span>

<span data-ttu-id="43d48-267">**Листинг 5. сценарий на стороне клиента для отображения пользовательских ошибок**</span><span class="sxs-lookup"><span data-stu-id="43d48-267">**Listing 5: Client-side script to display custom errors**</span></span>

[!code-html[Main](understanding-partial-page-updates-with-asp-net-ajax/samples/sample4.html)]

<span data-ttu-id="43d48-268">Довольно просто, приведенный выше скрипт регистрирует обратный вызов с клиентской средой выполнения AJAX для завершения асинхронного запроса.</span><span class="sxs-lookup"><span data-stu-id="43d48-268">Quite simply, the above script registers a callback with the client-side AJAX runtime for when the asynchronous request has been completed.</span></span> <span data-ttu-id="43d48-269">Затем он проверяет, была ли обнаружена ошибка, и, если это так, обрабатывает сведения о ней, и, наконец, указывает среде выполнения, что ошибка была обработана в пользовательском скрипте.</span><span class="sxs-lookup"><span data-stu-id="43d48-269">It then checks to see whether an error was reported, and if so, processes the details of it, finally indicating to the runtime that the error was handled in custom script.</span></span>

## <a name="globalization-and-localization-support"></a><span data-ttu-id="43d48-270">Поддержка глобализации и локализации</span><span class="sxs-lookup"><span data-stu-id="43d48-270">Globalization and Localization Support</span></span>

<span data-ttu-id="43d48-271">Элемент управления ScriptManager обеспечивает расширенную поддержку локализации строк скриптов и компонентов пользовательского интерфейса. Однако этот раздел находится за пределами области этого технического документа.</span><span class="sxs-lookup"><span data-stu-id="43d48-271">The ScriptManager control provides extensive support for localization of script strings and user interface components; however, that topic is outside of the scope of this whitepaper.</span></span> <span data-ttu-id="43d48-272">Дополнительные сведения см. в техническом документе поддержка глобализации в ASP.NET AJAX Extensions.</span><span class="sxs-lookup"><span data-stu-id="43d48-272">For more information, see the whitepaper, Globalization Support in ASP.NET AJAX Extensions.</span></span>

## <a name="the-updatepanel-control"></a><span data-ttu-id="43d48-273">Элемент управления UpdatePanel</span><span class="sxs-lookup"><span data-stu-id="43d48-273">The UpdatePanel Control</span></span>

## <a name="updatepanel-control-reference"></a><span data-ttu-id="43d48-274">Справочник по элементу UpdatePanel</span><span class="sxs-lookup"><span data-stu-id="43d48-274">UpdatePanel Control Reference</span></span>

<span data-ttu-id="43d48-275">Свойства с поддержкой разметки:</span><span class="sxs-lookup"><span data-stu-id="43d48-275">Markup-Enabled Properties:</span></span>

| <span data-ttu-id="43d48-276">**Имя свойства**</span><span class="sxs-lookup"><span data-stu-id="43d48-276">**Property Name**</span></span> | <span data-ttu-id="43d48-277">**Type**</span><span class="sxs-lookup"><span data-stu-id="43d48-277">**Type**</span></span> | <span data-ttu-id="43d48-278">**Описание**</span><span class="sxs-lookup"><span data-stu-id="43d48-278">**Description**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="43d48-279">ChildrenAsTriggers</span><span class="sxs-lookup"><span data-stu-id="43d48-279">ChildrenAsTriggers</span></span> | <span data-ttu-id="43d48-280">bool</span><span class="sxs-lookup"><span data-stu-id="43d48-280">bool</span></span> | <span data-ttu-id="43d48-281">Указывает, будут ли дочерние элементы управления автоматически вызывать обновление при обратной передаче.</span><span class="sxs-lookup"><span data-stu-id="43d48-281">Specifies whether child controls automatically invoke refresh on postback.</span></span> |
| <span data-ttu-id="43d48-282">RenderMode</span><span class="sxs-lookup"><span data-stu-id="43d48-282">RenderMode</span></span> | <span data-ttu-id="43d48-283">Enum (Block, inline)</span><span class="sxs-lookup"><span data-stu-id="43d48-283">enum (Block, Inline)</span></span> | <span data-ttu-id="43d48-284">Указывает способ визуального представления содержимого.</span><span class="sxs-lookup"><span data-stu-id="43d48-284">Specifies the way the content will be visually presented.</span></span> |
| <span data-ttu-id="43d48-285">UpdateMode</span><span class="sxs-lookup"><span data-stu-id="43d48-285">UpdateMode</span></span> | <span data-ttu-id="43d48-286">Enum (всегда, условный)</span><span class="sxs-lookup"><span data-stu-id="43d48-286">enum (Always, Conditional)</span></span> | <span data-ttu-id="43d48-287">Указывает, всегда ли обновляется UpdatePanel во время частичной визуализации или обновляется только при достижении триггера.</span><span class="sxs-lookup"><span data-stu-id="43d48-287">Specifies whether the UpdatePanel is always refreshed during a partial render or if it is only refreshed when a trigger is hit.</span></span> |

<span data-ttu-id="43d48-288">Свойства только для кода:</span><span class="sxs-lookup"><span data-stu-id="43d48-288">Code-Only Properties:</span></span>

| <span data-ttu-id="43d48-289">**Имя свойства**</span><span class="sxs-lookup"><span data-stu-id="43d48-289">**Property Name**</span></span> | <span data-ttu-id="43d48-290">**Type**</span><span class="sxs-lookup"><span data-stu-id="43d48-290">**Type**</span></span> | <span data-ttu-id="43d48-291">**Описание**</span><span class="sxs-lookup"><span data-stu-id="43d48-291">**Description**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="43d48-292">исинпартиалрендеринг</span><span class="sxs-lookup"><span data-stu-id="43d48-292">IsInPartialRendering</span></span> | <span data-ttu-id="43d48-293">bool</span><span class="sxs-lookup"><span data-stu-id="43d48-293">bool</span></span> | <span data-ttu-id="43d48-294">Возвращает значение, указывающее, поддерживает ли UpdatePanel частичную визуализацию для текущего запроса.</span><span class="sxs-lookup"><span data-stu-id="43d48-294">Gets whether the UpdatePanel is supporting partial rendering for the current request.</span></span> |
| <span data-ttu-id="43d48-295">ContentTemplate</span><span class="sxs-lookup"><span data-stu-id="43d48-295">ContentTemplate</span></span> | <span data-ttu-id="43d48-296">итемплате</span><span class="sxs-lookup"><span data-stu-id="43d48-296">ITemplate</span></span> | <span data-ttu-id="43d48-297">Возвращает шаблон разметки для запроса на обновление.</span><span class="sxs-lookup"><span data-stu-id="43d48-297">Gets the markup template for the update request.</span></span> |
| <span data-ttu-id="43d48-298">контенттемплатеконтаинер</span><span class="sxs-lookup"><span data-stu-id="43d48-298">ContentTemplateContainer</span></span> | <span data-ttu-id="43d48-299">Элемент управления</span><span class="sxs-lookup"><span data-stu-id="43d48-299">Control</span></span> | <span data-ttu-id="43d48-300">Возвращает программный шаблон для запроса на обновление.</span><span class="sxs-lookup"><span data-stu-id="43d48-300">Gets the programmatic template for the update request.</span></span> |
| <span data-ttu-id="43d48-301">Триггеры</span><span class="sxs-lookup"><span data-stu-id="43d48-301">Triggers</span></span> | <span data-ttu-id="43d48-302">UpdatePanel — Тригжерколлектион</span><span class="sxs-lookup"><span data-stu-id="43d48-302">UpdatePanel- TriggerCollection</span></span> | <span data-ttu-id="43d48-303">Возвращает список триггеров, связанных с текущим элементом UpdatePanel.</span><span class="sxs-lookup"><span data-stu-id="43d48-303">Gets the list of triggers associated with the current UpdatePanel.</span></span> |

<span data-ttu-id="43d48-304">Методы открытого кода:</span><span class="sxs-lookup"><span data-stu-id="43d48-304">Public Code Methods:</span></span>

| <span data-ttu-id="43d48-305">**Имя метода**</span><span class="sxs-lookup"><span data-stu-id="43d48-305">**Method Name**</span></span> | <span data-ttu-id="43d48-306">**Type**</span><span class="sxs-lookup"><span data-stu-id="43d48-306">**Type**</span></span> | <span data-ttu-id="43d48-307">**Описание**</span><span class="sxs-lookup"><span data-stu-id="43d48-307">**Description**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="43d48-308">Update ()</span><span class="sxs-lookup"><span data-stu-id="43d48-308">Update()</span></span> | <span data-ttu-id="43d48-309">Void</span><span class="sxs-lookup"><span data-stu-id="43d48-309">Void</span></span> | <span data-ttu-id="43d48-310">Обновляет указанную UpdatePanel программным образом.</span><span class="sxs-lookup"><span data-stu-id="43d48-310">Updates the specified UpdatePanel programmatically.</span></span> <span data-ttu-id="43d48-311">Разрешает серверу запрос на запуск частичной прорисовки UpdatePanel, не активированной в противном случае.</span><span class="sxs-lookup"><span data-stu-id="43d48-311">Allows a server request to trigger a partial render of an otherwise-untriggered UpdatePanel.</span></span> |

<span data-ttu-id="43d48-312">Дочерние элементы разметки:</span><span class="sxs-lookup"><span data-stu-id="43d48-312">Markup Descendants:</span></span>

| <span data-ttu-id="43d48-313">**Тегами**</span><span class="sxs-lookup"><span data-stu-id="43d48-313">**Tag**</span></span> | <span data-ttu-id="43d48-314">**Описание**</span><span class="sxs-lookup"><span data-stu-id="43d48-314">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="43d48-315">&lt;ContentTemplate&gt;</span><span class="sxs-lookup"><span data-stu-id="43d48-315">&lt;ContentTemplate&gt;</span></span> | <span data-ttu-id="43d48-316">Указывает разметку, используемую для визуализации результата частичной визуализации.</span><span class="sxs-lookup"><span data-stu-id="43d48-316">Specifies the markup to be used to render the partial rendering result.</span></span> <span data-ttu-id="43d48-317">Дочерний элемент &lt;ASP: UpdatePanel&gt;.</span><span class="sxs-lookup"><span data-stu-id="43d48-317">Child of &lt;asp:UpdatePanel&gt;.</span></span> |
| <span data-ttu-id="43d48-318">&lt;Триггеры&gt;</span><span class="sxs-lookup"><span data-stu-id="43d48-318">&lt;Triggers&gt;</span></span> | <span data-ttu-id="43d48-319">Указывает коллекцию элементов управления *n* , связанных с обновлением этой UpdatePanel.</span><span class="sxs-lookup"><span data-stu-id="43d48-319">Specifies a collection of *n* controls associated with updating this UpdatePanel.</span></span> <span data-ttu-id="43d48-320">Дочерний элемент &lt;ASP: UpdatePanel&gt;.</span><span class="sxs-lookup"><span data-stu-id="43d48-320">Child of &lt;asp:UpdatePanel&gt;.</span></span> |
| <span data-ttu-id="43d48-321">&lt;ASP: Асинкпостбакктригжер&gt;</span><span class="sxs-lookup"><span data-stu-id="43d48-321">&lt;asp:AsyncPostBackTrigger&gt;</span></span> | <span data-ttu-id="43d48-322">Указывает триггер, который вызывает частичную отрисовку страницы для заданной UpdatePanel.</span><span class="sxs-lookup"><span data-stu-id="43d48-322">Specifies a trigger that invokes a partial page render for the given UpdatePanel.</span></span> <span data-ttu-id="43d48-323">Это может быть или не быть элементом управления в качестве потомка элемента UpdatePanel.</span><span class="sxs-lookup"><span data-stu-id="43d48-323">This may or may not be a control as a descendant of the UpdatePanel in question.</span></span> <span data-ttu-id="43d48-324">Детализация по имени события. Дочерний элемент &lt;триггеры&gt;.</span><span class="sxs-lookup"><span data-stu-id="43d48-324">Granular to the event name.Child of &lt;Triggers&gt;.</span></span> |
| <span data-ttu-id="43d48-325">&lt;ASP: Постбакктригжер&gt;</span><span class="sxs-lookup"><span data-stu-id="43d48-325">&lt;asp:PostBackTrigger&gt;</span></span> | <span data-ttu-id="43d48-326">Указывает элемент управления, который вызывает обновление всей страницы.</span><span class="sxs-lookup"><span data-stu-id="43d48-326">Specifies a control that causes the entire page to refresh.</span></span> <span data-ttu-id="43d48-327">Это может быть или не быть элементом управления в качестве потомка элемента UpdatePanel.</span><span class="sxs-lookup"><span data-stu-id="43d48-327">This may or may not be a control as a descendant of the UpdatePanel in question.</span></span> <span data-ttu-id="43d48-328">Детализация для объекта.</span><span class="sxs-lookup"><span data-stu-id="43d48-328">Granular to the object.</span></span> <span data-ttu-id="43d48-329">Дочерний элемент &lt;триггеры&gt;.</span><span class="sxs-lookup"><span data-stu-id="43d48-329">Child of &lt;Triggers&gt;.</span></span> |

<span data-ttu-id="43d48-330">Элемент управления `UpdatePanel` — это элемент управления, который разделяет содержимое на стороне сервера, которое будет принимать участие в функции частичной визуализации расширений AJAX.</span><span class="sxs-lookup"><span data-stu-id="43d48-330">The `UpdatePanel` control is the control that delimits the server-side content that will take part in the partial rendering functionality of the AJAX Extensions.</span></span> <span data-ttu-id="43d48-331">Количество элементов управления UpdatePanel, которые могут быть на странице, не ограничено, и они могут быть вложенными.</span><span class="sxs-lookup"><span data-stu-id="43d48-331">There is no limit to the number of UpdatePanel controls that can be on a page, and they can be nested.</span></span> <span data-ttu-id="43d48-332">Каждая UpdatePanel изолирована, поэтому каждая из них может работать независимо (одновременно могут выполняться два элемента UpdatePanel, которые отображают различные части страницы независимо от обратной передачи страницы).</span><span class="sxs-lookup"><span data-stu-id="43d48-332">Each UpdatePanel is isolated, so that each can work independently (you can have two UpdatePanels running at the same time, rendering different parts of the page, independent of the page's postback).</span></span>

<span data-ttu-id="43d48-333">Элемент управления UpdatePanel в основном работает с триггерами управления. по умолчанию любой элемент управления, содержащийся в `ContentTemplate` UpdatePanel, который создает обратную передачу, регистрируется в качестве триггера для UpdatePanel.</span><span class="sxs-lookup"><span data-stu-id="43d48-333">The UpdatePanel control primarily deals with control triggers - by default, any control contained within an UpdatePanel's `ContentTemplate` that creates a postback is registered as a trigger for the UpdatePanel.</span></span> <span data-ttu-id="43d48-334">Это означает, что UpdatePanel может работать с элементами управления, привязанными к данным по умолчанию (например, GridView), с пользовательскими элементами управления, и их можно программировать в сценарии.</span><span class="sxs-lookup"><span data-stu-id="43d48-334">This means that the UpdatePanel can work with the default data-bound controls (such as the GridView), with user controls, and they can be programmed in script.</span></span>

<span data-ttu-id="43d48-335">По умолчанию при запуске частичной визуализации страницы все элементы управления UpdatePanel на странице будут обновлены независимо от того, определены ли в элементе управления UpdatePanel триггеры для такого действия.</span><span class="sxs-lookup"><span data-stu-id="43d48-335">By default, when a partial page render is triggered, all UpdatePanel controls on the page will be refreshed, whether or not the UpdatePanel controls defined triggers for such action.</span></span> <span data-ttu-id="43d48-336">Например, если одна UpdatePanel определяет элемент управления Button, и этот элемент управления Button нажат, все элементы управления UpdatePanel на этой странице будут обновляться по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="43d48-336">For example, if one UpdatePanel defines a Button control, and that Button control is clicked, all UpdatePanel controls on that page will be refreshed by default.</span></span> <span data-ttu-id="43d48-337">Это вызвано тем, что по умолчанию свойству `UpdateMode` элемента UpdatePanel присвоено значение `Always`.</span><span class="sxs-lookup"><span data-stu-id="43d48-337">This is because, by default, the `UpdateMode` property of the UpdatePanel is set to `Always`.</span></span> <span data-ttu-id="43d48-338">Кроме того, можно задать для свойства UpdateMode значение `Conditional`. Это означает, что UpdatePanel будет обновляться только при попадании определенного триггера.</span><span class="sxs-lookup"><span data-stu-id="43d48-338">Alternatively, you may set the UpdateMode property to `Conditional`, which means that the UpdatePanel will only be refreshed if a specific trigger is hit.</span></span>

## <a name="custom-control-notes"></a><span data-ttu-id="43d48-339">Заметки пользовательского элемента управления</span><span class="sxs-lookup"><span data-stu-id="43d48-339">Custom Control Notes</span></span>

<span data-ttu-id="43d48-340">UpdatePanel можно добавить к любому пользовательскому элементу управления или пользовательскому элементу управления; Однако страница, на которой включены эти элементы управления, также должна включать элемент управления ScriptManager, свойство EnablePartialRendering которого имеет значение **true**.</span><span class="sxs-lookup"><span data-stu-id="43d48-340">An UpdatePanel can be added to any user control or custom control; however, the page on which these controls are included must also include a ScriptManager control with the property EnablePartialRendering set to **true**.</span></span>

<span data-ttu-id="43d48-341">Один из способов, с помощью которого вы можете учитывать это при использовании пользовательских веб-элементов управления, — переопределить защищенный метод `CreateChildControls()` класса `CompositeControl`.</span><span class="sxs-lookup"><span data-stu-id="43d48-341">One way in which you might account for this when using Web Custom Controls is to override the protected `CreateChildControls()` method of the `CompositeControl` class.</span></span> <span data-ttu-id="43d48-342">Таким образом, вы можете внедрить элемент управления UpdatePanel между дочерними элементами и внешним миром, если вы определили, что страница поддерживает частичную визуализацию. в противном случае дочерние элементы управления можно просто дослойировать в контейнер `Control` экземпляр.</span><span class="sxs-lookup"><span data-stu-id="43d48-342">By doing so, you can inject an UpdatePanel between the control's children and the outside world if you determine the page supports partial rendering; otherwise, you can simply layer the child controls into a container `Control` instance.</span></span>

## <a name="updatepanel-considerations"></a><span data-ttu-id="43d48-343">Рекомендации по UpdatePanel</span><span class="sxs-lookup"><span data-stu-id="43d48-343">UpdatePanel Considerations</span></span>

<span data-ttu-id="43d48-344">UpdatePanel работает как что-нибудь из черного ящика, заключив обратную передачу ASP.NET в контексте JavaScript XMLHttpRequest.</span><span class="sxs-lookup"><span data-stu-id="43d48-344">The UpdatePanel operates as something of a black-box, wrapping ASP.NET postbacks within the context of a JavaScript XMLHttpRequest.</span></span> <span data-ttu-id="43d48-345">Однако существуют значительные соображения по производительности, которые следует учитывать в плане поведения и скорости.</span><span class="sxs-lookup"><span data-stu-id="43d48-345">However, there are significant performance considerations to bear in mind, both in terms of behavior and speed.</span></span> <span data-ttu-id="43d48-346">Чтобы понять, как работает UpdatePanel, вы сможете лучше решить, когда подходит ее использование, следует изучить обмен AJAX.</span><span class="sxs-lookup"><span data-stu-id="43d48-346">To understand how the UpdatePanel works, so that you can best decide when its use is appropriate, you should examine the AJAX exchange.</span></span> <span data-ttu-id="43d48-347">В следующем примере используется существующий сайт и Mozilla Firefox с расширением Firebug (Firebug фиксирует данные XMLHttpRequest).</span><span class="sxs-lookup"><span data-stu-id="43d48-347">The following example uses an existing site and, Mozilla Firefox with the Firebug extension (Firebug captures XMLHttpRequest data).</span></span>

<span data-ttu-id="43d48-348">Рассмотрим форму, которая, помимо прочего, содержит текстовое поле Почтовый индекс, которое должно заполнять поля город и штат в форме или элементе управления.</span><span class="sxs-lookup"><span data-stu-id="43d48-348">Consider a form that, among other things, has a postal code textbox which is supposed to populate a city and state field on a form or control.</span></span> <span data-ttu-id="43d48-349">Эта форма в конечном итоге собирает сведения о членстве, включая имя пользователя, адрес и контактные данные.</span><span class="sxs-lookup"><span data-stu-id="43d48-349">This form ultimately collects membership information, including a user's name, address, and contact information.</span></span> <span data-ttu-id="43d48-350">В зависимости от требований конкретного проекта необходимо учитывать множество аспектов проектирования.</span><span class="sxs-lookup"><span data-stu-id="43d48-350">There are many design considerations to take into account, based on the requirements of a specific project.</span></span>

[![](understanding-partial-page-updates-with-asp-net-ajax/_static/image11.png)](understanding-partial-page-updates-with-asp-net-ajax/_static/image10.png)

<span data-ttu-id="43d48-351">([Щелкните, чтобы просмотреть изображение с полным размером](understanding-partial-page-updates-with-asp-net-ajax/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="43d48-351">([Click to view full-size image](understanding-partial-page-updates-with-asp-net-ajax/_static/image12.png))</span></span>

[![](understanding-partial-page-updates-with-asp-net-ajax/_static/image14.png)](understanding-partial-page-updates-with-asp-net-ajax/_static/image13.png)

<span data-ttu-id="43d48-352">([Щелкните, чтобы просмотреть изображение с полным размером](understanding-partial-page-updates-with-asp-net-ajax/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="43d48-352">([Click to view full-size image](understanding-partial-page-updates-with-asp-net-ajax/_static/image15.png))</span></span>

<span data-ttu-id="43d48-353">В исходной итерации этого приложения был создан элемент управления, включающий все данные регистрации пользователя, включая почтовый индекс, город и штат.</span><span class="sxs-lookup"><span data-stu-id="43d48-353">In the original iteration of this application, a control was built that incorporated the entirety of the user registration data, including the postal code, city, and state.</span></span> <span data-ttu-id="43d48-354">Весь элемент управления был заключен в UpdatePanel и помещен в веб-форму.</span><span class="sxs-lookup"><span data-stu-id="43d48-354">The entire control was wrapped within an UpdatePanel and dropped onto a Web Form.</span></span> <span data-ttu-id="43d48-355">Когда почтовый индекс вводит пользователь, UpdatePanel обнаруживает событие (соответствующее событие TextChanged в серверной части, указывая триггеры или используя свойство ChildrenAsTriggers, установленное в значение true).</span><span class="sxs-lookup"><span data-stu-id="43d48-355">When the postal code is entered by the user, the UpdatePanel detects the event (the corresponding TextChanged event in the back-end, either by specifying triggers or by using the ChildrenAsTriggers property set to true).</span></span> <span data-ttu-id="43d48-356">AJAX отправляет все поля внутри UpdatePanel в соответствии с захватом FireBug (см. диаграмму справа).</span><span class="sxs-lookup"><span data-stu-id="43d48-356">AJAX posts all of the fields within the UpdatePanel, as captured by FireBug (see the diagram on the right).</span></span>

<span data-ttu-id="43d48-357">По мере того как снимок экрана показывает, доставляются значения всех элементов управления в UpdatePanel (в данном случае все они пусты), а также поле ViewState.</span><span class="sxs-lookup"><span data-stu-id="43d48-357">As the screen capture indicates, values from every control within the UpdatePanel are delivered (in this case, they are all empty), as well as the ViewState field.</span></span> <span data-ttu-id="43d48-358">Отправляются все запросы, направленные на 9Kb данных, когда в действительности для выполнения этого запроса требуется только пять байт данных.</span><span class="sxs-lookup"><span data-stu-id="43d48-358">All told, over 9kb of data is sent, when in fact only five bytes of data were needed to make this particular request.</span></span> <span data-ttu-id="43d48-359">Ответ еще более чрезмерно: в итоге 57kb отправляется клиенту, просто для обновления текстового поля и раскрывающегося поля.</span><span class="sxs-lookup"><span data-stu-id="43d48-359">The response is even more bloated: in total, 57kb is sent to the client, simply to update a text field and a drop-down field.</span></span>

<span data-ttu-id="43d48-360">Он также может представлять интерес, чтобы увидеть, как ASP.NET AJAX обновляет презентацию.</span><span class="sxs-lookup"><span data-stu-id="43d48-360">It may also be of interest to see how ASP.NET AJAX updates the presentation.</span></span> <span data-ttu-id="43d48-361">Часть ответа в запросе на обновление UpdatePanel отображается в левой части окна консоли Firebug. Это особая формулировка строки с разделением каналов, которая разбивается клиентским сценарием и затем собирается на странице.</span><span class="sxs-lookup"><span data-stu-id="43d48-361">The response portion of the UpdatePanel's update request is shown in the Firebug console display on the left; it is a specially-formulated pipe-delimited string that is broken up by the client script and then reassembled on the page.</span></span> <span data-ttu-id="43d48-362">В частности, ASP.NET AJAX устанавливает свойство *InnerHtml* элемента HTML на клиенте, который представляет элемент UpdatePanel.</span><span class="sxs-lookup"><span data-stu-id="43d48-362">Specifically, ASP.NET AJAX sets the *innerHTML* property of the HTML element on the client that represents your UpdatePanel.</span></span> <span data-ttu-id="43d48-363">Так как браузер повторно создает модель DOM, возникает небольшая задержка, в зависимости от объема информации, которую необходимо обработать.</span><span class="sxs-lookup"><span data-stu-id="43d48-363">As the browser re-generates the DOM, there is a slight delay, depending on the amount of information that needs to be processed.</span></span>

<span data-ttu-id="43d48-364">Повторное создание модели DOM вызывает ряд дополнительных проблем:</span><span class="sxs-lookup"><span data-stu-id="43d48-364">The regeneration of the DOM triggers a number of additional issues:</span></span>

[![](understanding-partial-page-updates-with-asp-net-ajax/_static/image17.png)](understanding-partial-page-updates-with-asp-net-ajax/_static/image16.png)

<span data-ttu-id="43d48-365">([Щелкните, чтобы просмотреть изображение с полным размером](understanding-partial-page-updates-with-asp-net-ajax/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="43d48-365">([Click to view full-size image](understanding-partial-page-updates-with-asp-net-ajax/_static/image18.png))</span></span>

- <span data-ttu-id="43d48-366">Если элемент HTML с фокусом находится внутри UpdatePanel, фокус будет утерян.</span><span class="sxs-lookup"><span data-stu-id="43d48-366">If the focused HTML element is within the UpdatePanel, it will lose focus.</span></span> <span data-ttu-id="43d48-367">Таким образом, для пользователей, которые нажал клавишу TAB для выхода из текстового поля Почтовый индекс, их следующее назначение было бы текстовым полем город.</span><span class="sxs-lookup"><span data-stu-id="43d48-367">So, for users who pressed the Tab key to exit the postal code text box, their next destination would have been the City text box.</span></span> <span data-ttu-id="43d48-368">Однако после того, как UpdatePanel обновила отображение, форма больше не будет иметь фокус, а нажатие клавиши TAB начнет выделять элементы фокуса (например, ссылки).</span><span class="sxs-lookup"><span data-stu-id="43d48-368">However, once the UpdatePanel refreshed the display, the form would no longer have had focus, and pressing Tab would have started highlighting the focus elements (such as links).</span></span>
- <span data-ttu-id="43d48-369">Если используется любой тип пользовательского клиентского скрипта, обращающегося к элементам DOM, ссылки, сохраняемые функциями, могут быть уничтожены после частичной обратной передачи.</span><span class="sxs-lookup"><span data-stu-id="43d48-369">If any type of custom client-side script is in use that accesses DOM elements, references persisted by functions may become defunct after a partial postback.</span></span>

<span data-ttu-id="43d48-370">UpdatePanel не предназначена для перехватывать все решения.</span><span class="sxs-lookup"><span data-stu-id="43d48-370">UpdatePanels are not intended to be catch-all solutions.</span></span> <span data-ttu-id="43d48-371">Вместо этого они предоставляют быстрое решение для определенных ситуаций, включая создание прототипов, обновление небольших элементов управления и предоставление привычного интерфейса для ASP.NET разработчиков, которые могут быть знакомы с объектной моделью .NET, но меньше, чем с моделью DOM.</span><span class="sxs-lookup"><span data-stu-id="43d48-371">Rather, they provide a quick solution for certain situations, including prototyping, small control updates, and provide a familiar interface to ASP.NET developers who might be familiar with the .NET object model but less-so with the DOM.</span></span> <span data-ttu-id="43d48-372">Существует несколько альтернатив, которые могут привести к лучшей производительности в зависимости от сценария приложения.</span><span class="sxs-lookup"><span data-stu-id="43d48-372">There are a number of alternatives that may result in better performance, depending on the application scenario:</span></span>

- <span data-ttu-id="43d48-373">Рассмотрите возможность использования Pagemethod и JSON (нотация объектов JavaScript), позволяя разработчику вызывать статические методы на странице, как если бы вызывался вызов веб-службы.</span><span class="sxs-lookup"><span data-stu-id="43d48-373">Consider using PageMethods and JSON (JavaScript Object Notation) allows the developer to invoke static methods on a page as if a web service call was being invoked.</span></span> <span data-ttu-id="43d48-374">Поскольку методы являются статическими, состояние не требуется. вызывающий сценарий предоставляет параметры, и результат возвращается асинхронно.</span><span class="sxs-lookup"><span data-stu-id="43d48-374">Because the methods are static, no state is necessary; the script caller supplies the parameters, and the result is returned asynchronously.</span></span>
- <span data-ttu-id="43d48-375">Рассмотрите возможность использования веб-службы и JSON, если один элемент управления необходимо использовать в нескольких местах приложения.</span><span class="sxs-lookup"><span data-stu-id="43d48-375">Consider using a Web Service and JSON if a single control needs to be used in several places across an application.</span></span> <span data-ttu-id="43d48-376">Это снова требует очень небольшой работы и работает асинхронно.</span><span class="sxs-lookup"><span data-stu-id="43d48-376">This again requires very little special work, and works asynchronously.</span></span>

<span data-ttu-id="43d48-377">Включение функций с помощью веб-служб или методов страниц также имеет свои недостатки.</span><span class="sxs-lookup"><span data-stu-id="43d48-377">Incorporating functionality through Web Services or Page Methods has drawbacks as well.</span></span> <span data-ttu-id="43d48-378">В первую и самое главное, разработчики ASP.NET обычно создают небольшие компоненты функциональности в пользовательских элементах управления (ASCX-файлах).</span><span class="sxs-lookup"><span data-stu-id="43d48-378">First and foremost, ASP.NET developers typically tend to build small components of functionality into user controls (.ascx files).</span></span> <span data-ttu-id="43d48-379">Методы страниц не могут размещаться в этих файлах; они должны размещаться в фактическом классе ASPX-страницы.</span><span class="sxs-lookup"><span data-stu-id="43d48-379">Page methods cannot be hosted in these files; they must be hosted within the actual .aspx page class.</span></span> <span data-ttu-id="43d48-380">Веб-службы, аналогично, должны размещаться в классе. asmx.</span><span class="sxs-lookup"><span data-stu-id="43d48-380">Web services, similarly, must be hosted within the .asmx class.</span></span> <span data-ttu-id="43d48-381">В зависимости от приложения эта архитектура может нарушать принцип одной ответственности, в то же самое, что функциональные возможности одного компонента теперь распределены по двум или более физическим компонентам, которые могут иметь небольшую или не имеющую связную взаимосвязей.</span><span class="sxs-lookup"><span data-stu-id="43d48-381">Depending on the application, this architecture may violate the Single Responsibility Principle, in that the functionality for a single component is now spread across two or more physical components which may have little or no cohesive ties.</span></span>

<span data-ttu-id="43d48-382">Наконец, если приложение требует использования UpdatePanel, следующие рекомендации должны помочь при устранении неполадок и обслуживании.</span><span class="sxs-lookup"><span data-stu-id="43d48-382">Finally, if an application requires that UpdatePanels are used, the following guidelines should assist with troubleshooting and maintenance.</span></span>

- <span data-ttu-id="43d48-383">**Старайтесь как можно меньшее количество элементов UpdatePanel, не только внутри единиц, но и в разных единицах кода.**</span><span class="sxs-lookup"><span data-stu-id="43d48-383">**Nest UpdatePanels as little as possible, not only within-units, but also across units of code.**</span></span> <span data-ttu-id="43d48-384">Например, наличие UpdatePanel на странице, которая является оболочкой для элемента управления, а также содержит элемент управления UpdatePanel, который содержит другой элемент управления, содержащий UpdatePanel, — это вложенность между единицами.</span><span class="sxs-lookup"><span data-stu-id="43d48-384">For example, having an UpdatePanel on a Page that wraps a Control, while that Control also contains an UpdatePanel, which contains another Control that contains an UpdatePanel, is cross-unit nesting.</span></span> <span data-ttu-id="43d48-385">Это позволяет не только очищать элементы, которые необходимо обновить, но и предотвращает непредвиденные обновления дочерних элементов UpdatePanel.</span><span class="sxs-lookup"><span data-stu-id="43d48-385">This helps to keep clear which elements should be refreshing, and prevents unexpected refreshes to child UpdatePanels.</span></span>
- <span data-ttu-id="43d48-386">**Установите для свойства *ChildrenAsTriggers* значение false и явно задавайте события, вызывающие срабатывание.**</span><span class="sxs-lookup"><span data-stu-id="43d48-386">**Keep the *ChildrenAsTriggers* property set to false, and explicitly set triggering events.**</span></span> <span data-ttu-id="43d48-387">Использование коллекции `<Triggers>` является намного более четким способом обработки событий и может привести к непредсказуемому поведению, помогая задачам обслуживания и принудительному участию разработчика в отношении события.</span><span class="sxs-lookup"><span data-stu-id="43d48-387">Utilizing the `<Triggers>` collection is a much clearer way to handle events, and may prevent unexpected behavior, helping with maintenance tasks and forcing a developer to opt-in for an event.</span></span>
- <span data-ttu-id="43d48-388">**Используйте наименьшую возможную единицу для достижения функциональных возможностей.**</span><span class="sxs-lookup"><span data-stu-id="43d48-388">**Use the smallest possible unit to achieve functionality.**</span></span> <span data-ttu-id="43d48-389">Как отмечалось в обсуждении службы почтовых индексов, следует заключить в оболочку только минимальное время до сервера, общую обработку и объем обмена данными между клиентом и сервером, повышая производительность.</span><span class="sxs-lookup"><span data-stu-id="43d48-389">As noted in the discussion of the postal code service, wrapping only the bare minimum reduces time to the server, total processing, and the footprint of the client-server exchange, enhancing performance.</span></span>

## <a name="the-updateprogress-control"></a><span data-ttu-id="43d48-390">Элемент управления UpdateProgress</span><span class="sxs-lookup"><span data-stu-id="43d48-390">The UpdateProgress Control</span></span>

## <a name="updateprogress-control-reference"></a><span data-ttu-id="43d48-391">Справочник по элементу управления UpdateProgress</span><span class="sxs-lookup"><span data-stu-id="43d48-391">UpdateProgress Control Reference</span></span>

<span data-ttu-id="43d48-392">Свойства с поддержкой разметки:</span><span class="sxs-lookup"><span data-stu-id="43d48-392">Markup-Enabled Properties:</span></span>

| <span data-ttu-id="43d48-393">**Имя свойства**</span><span class="sxs-lookup"><span data-stu-id="43d48-393">**Property Name**</span></span> | <span data-ttu-id="43d48-394">**Type**</span><span class="sxs-lookup"><span data-stu-id="43d48-394">**Type**</span></span> | <span data-ttu-id="43d48-395">**Описание**</span><span class="sxs-lookup"><span data-stu-id="43d48-395">**Description**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="43d48-396">АссоЦиатедупдате — Панелид</span><span class="sxs-lookup"><span data-stu-id="43d48-396">AssociatedUpdate-PanelID</span></span> | <span data-ttu-id="43d48-397">Строковое</span><span class="sxs-lookup"><span data-stu-id="43d48-397">String</span></span> | <span data-ttu-id="43d48-398">Указывает идентификатор элемента UpdatePanel, по которому должен быть отчет UpdateProgress.</span><span class="sxs-lookup"><span data-stu-id="43d48-398">Specifies the ID of the UpdatePanel that this UpdateProgress should report on.</span></span> |
| <span data-ttu-id="43d48-399">дисплайафтер</span><span class="sxs-lookup"><span data-stu-id="43d48-399">DisplayAfter</span></span> | <span data-ttu-id="43d48-400">Int</span><span class="sxs-lookup"><span data-stu-id="43d48-400">Int</span></span> | <span data-ttu-id="43d48-401">Указывает время ожидания в миллисекундах перед отображением этого элемента управления после начала асинхронного запроса.</span><span class="sxs-lookup"><span data-stu-id="43d48-401">Specifies the timeout in milliseconds before this control is displayed after the asynchronous request begins.</span></span> |
| <span data-ttu-id="43d48-402">динамиклайаут</span><span class="sxs-lookup"><span data-stu-id="43d48-402">DynamicLayout</span></span> | <span data-ttu-id="43d48-403">bool</span><span class="sxs-lookup"><span data-stu-id="43d48-403">bool</span></span> | <span data-ttu-id="43d48-404">Указывает, отображается ли ход выполнения динамически.</span><span class="sxs-lookup"><span data-stu-id="43d48-404">Specifies whether the progress is rendered dynamically.</span></span> |

<span data-ttu-id="43d48-405">Дочерние элементы разметки:</span><span class="sxs-lookup"><span data-stu-id="43d48-405">Markup Descendants:</span></span>

| <span data-ttu-id="43d48-406">**Тегами**</span><span class="sxs-lookup"><span data-stu-id="43d48-406">**Tag**</span></span> | <span data-ttu-id="43d48-407">**Описание**</span><span class="sxs-lookup"><span data-stu-id="43d48-407">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="43d48-408">&lt;Прогресстемплате&gt;</span><span class="sxs-lookup"><span data-stu-id="43d48-408">&lt;ProgressTemplate&gt;</span></span> | <span data-ttu-id="43d48-409">Содержит шаблон элемента управления, заданный для содержимого, которое будет отображаться с этим элементом управления.</span><span class="sxs-lookup"><span data-stu-id="43d48-409">Contains the control template set for the content that will be displayed with this control.</span></span> |

<span data-ttu-id="43d48-410">Элемент управления UpdateProgress дает возможность отследить Отзывы пользователей, чтобы они не изменялись при выполнении необходимой работы для передачи на сервер.</span><span class="sxs-lookup"><span data-stu-id="43d48-410">The UpdateProgress control gives you a measure of feedback to keep your users' interest while doing the necessary work to transport to the server.</span></span> <span data-ttu-id="43d48-411">Это поможет вашим пользователям знать, что вы выполняете какие-либо действия, даже если они не очевидны, особенно потому, что большинство пользователей используются для обновления страницы и отображения выделения в строке состояния.</span><span class="sxs-lookup"><span data-stu-id="43d48-411">This can help your users know that you're doing something even though it may not be apparent, especially since most users are used to the page refreshing and seeing the status bar highlight.</span></span>

<span data-ttu-id="43d48-412">Обратите внимание, что элементы управления UpdateProgress могут располагаться в любом месте иерархии страниц.</span><span class="sxs-lookup"><span data-stu-id="43d48-412">As a note, UpdateProgress controls can appear anywhere on a page hierarchy.</span></span> <span data-ttu-id="43d48-413">Однако в случаях, когда частичная обратная передача инициируется из дочерней UpdatePanel (где UpdatePanel вложена в другую UpdatePanel), обратная передача, вызывающая дочерние элементы UpdatePanel, приведет к отображению шаблонов UpdateProgress для дочернего элемента UpdatePanel и родительская UpdatePanel.</span><span class="sxs-lookup"><span data-stu-id="43d48-413">However, in cases in which a partial postback is initiated from a child UpdatePanel (where an UpdatePanel is nested within another UpdatePanel), postbacks that trigger the child UpdatePanel will cause UpdateProgress templates to be displayed for the child UpdatePanel as well as the parent UpdatePanel.</span></span> <span data-ttu-id="43d48-414">Но если триггер является прямым дочерним элементом родительской UpdatePanel, то будут отображаться только шаблоны UpdateProgress, связанные с родительским элементом.</span><span class="sxs-lookup"><span data-stu-id="43d48-414">But, if the trigger is a direct child of the parent UpdatePanel, then only the UpdateProgress templates associated with the parent will be displayed.</span></span>

## <a name="summary"></a><span data-ttu-id="43d48-415">Сводка</span><span class="sxs-lookup"><span data-stu-id="43d48-415">Summary</span></span>

<span data-ttu-id="43d48-416">Расширения Microsoft ASP.NET AJAX — это сложные продукты, разработанные для упрощения доступа к веб-содержимому и предоставления пользователям возможности работы с веб-приложениями.</span><span class="sxs-lookup"><span data-stu-id="43d48-416">The Microsoft ASP.NET AJAX extensions are sophisticated products designed to assist in making web content more accessible and to provide a richer user experience to your web applications.</span></span> <span data-ttu-id="43d48-417">В рамках расширений AJAX ASP.NET элементы управления частичной отрисовкой страницы, включая ScriptManager, UpdatePanel и UpdateProgress, являются некоторыми из наиболее видимых компонентов набора инструментов.</span><span class="sxs-lookup"><span data-stu-id="43d48-417">As part of the ASP.NET AJAX Extensions, the partial page rendering controls, including the ScriptManager, the UpdatePanel, and UpdateProgress controls are some of the most visible components of the toolkit.</span></span>

<span data-ttu-id="43d48-418">Компонент ScriptManager интегрирует код JavaScript клиента для расширений, а также позволяет различным серверным и клиентским компонентам работать вместе с минимальными вложениями в разработку.</span><span class="sxs-lookup"><span data-stu-id="43d48-418">The ScriptManager component integrates the provision of client JavaScript for the Extensions, as well as enables the various server- and client-side components to work together with minimal development investment.</span></span>

<span data-ttu-id="43d48-419">Элемент управления UpdatePanel является очевидным волшебным полем, разметкой в UpdatePanel может быть фоновый код на стороне сервера и не запускается обновление страницы.</span><span class="sxs-lookup"><span data-stu-id="43d48-419">The UpdatePanel control is the apparent magic box - markup within the UpdatePanel can have server-side Codebehind and not trigger a page refresh.</span></span> <span data-ttu-id="43d48-420">Элементы управления UpdatePanel могут быть вложенными и могут зависеть от элементов управления в других элементах UpdatePanel.</span><span class="sxs-lookup"><span data-stu-id="43d48-420">UpdatePanel controls can be nested, and can be dependent on controls in other UpdatePanels.</span></span> <span data-ttu-id="43d48-421">По умолчанию UpdatePanel обрабатывает любые обратные передачи, вызванные их дочерними элементами управления, хотя эту функцию можно настроить с помощью декларативного или программного кода.</span><span class="sxs-lookup"><span data-stu-id="43d48-421">By default, UpdatePanels handle any postbacks invoked by their descendant controls, although this functionality can be finely tuned, either declaratively or programmatically.</span></span>

<span data-ttu-id="43d48-422">При использовании элемента управления UpdatePanel разработчики должны учитывать воздействие на производительность, которое потенциально может возникнуть.</span><span class="sxs-lookup"><span data-stu-id="43d48-422">When using the UpdatePanel control, developers should be aware of the performance impact that could potentially arise.</span></span> <span data-ttu-id="43d48-423">К потенциальным альтернативам относятся веб-службы и методы страниц, хотя необходимо учитывать структуру приложения.</span><span class="sxs-lookup"><span data-stu-id="43d48-423">Potential alternatives include web services and page methods, though the design of the application should be considered.</span></span>

<span data-ttu-id="43d48-424">Элемент управления UpdateProgress позволяет пользователю знать, что он или он не пропускается, а фоновый запрос выполняется, пока страница не выполняет никаких действий для ответа на вводимые пользователем данные.</span><span class="sxs-lookup"><span data-stu-id="43d48-424">The UpdateProgress control allows the user to know that she or he is not being ignored, and that the behind-the-scenes request is going on while the page is otherwise not doing anything to respond to the user input.</span></span> <span data-ttu-id="43d48-425">Он также включает возможность прерывать результаты частичной визуализации.</span><span class="sxs-lookup"><span data-stu-id="43d48-425">It also includes the ability to abort partial rendering results.</span></span>

<span data-ttu-id="43d48-426">Вместе эти средства помогают создавать полнофункциональный и удобный пользовательский интерфейс, делая сервер более очевидным для пользователя и уменьшая процесс прерывания работы.</span><span class="sxs-lookup"><span data-stu-id="43d48-426">Together, these tools assist creating a rich and seamless user experience by making server work less apparent to the user and interrupting workflow less.</span></span>

## <a name="bio"></a><span data-ttu-id="43d48-427">Биография</span><span class="sxs-lookup"><span data-stu-id="43d48-427">Bio</span></span>

<span data-ttu-id="43d48-428">Скотт Cate работал с веб-технологиями Майкрософт с 1997 и является президентом myKB.com ([www.myKB.com](http://www.myKB.com)), где он специализируется на написании приложений ASP.NET на базе знаний, посвященных программным решениям.</span><span class="sxs-lookup"><span data-stu-id="43d48-428">Scott Cate has been working with Microsoft Web technologies since 1997 and is the President of myKB.com ([www.myKB.com](http://www.myKB.com)) where he specializes in writing ASP.NET based applications focused on Knowledge Base Software solutions.</span></span> <span data-ttu-id="43d48-429">Скотт может связаться по электронной почте по адресу [scott.cate@myKB.com](mailto:scott.cate@myKB.com) или в блоге по адресу [ScottCate.com](http://ScottCate.com)</span><span class="sxs-lookup"><span data-stu-id="43d48-429">Scott can be contacted via email at [scott.cate@myKB.com](mailto:scott.cate@myKB.com) or his blog at [ScottCate.com](http://ScottCate.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="43d48-430">Вперед</span><span class="sxs-lookup"><span data-stu-id="43d48-430">Next</span></span>](understanding-asp-net-ajax-updatepanel-triggers.md)
