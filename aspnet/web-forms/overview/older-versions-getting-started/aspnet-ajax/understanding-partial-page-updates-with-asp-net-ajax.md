---
uid: web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-partial-page-updates-with-asp-net-ajax
title: Основные сведения о частичных обновлениях страниц с помощью ASP.NET AJAX | Документация Майкрософт
author: scottcate
description: Возможно самой заметной функцией расширения AJAX для ASP.NET является возможность выполнить на странице частичной или добавочной обновления, не выполняя полную обратную передачу t...
ms.author: riande
ms.date: 03/28/2008
ms.assetid: 54d9df99-1161-4899-b4e8-2679c85915e7
msc.legacyurl: /web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-partial-page-updates-with-asp-net-ajax
msc.type: authoredcontent
ms.openlocfilehash: 4883046aa16d5e67b7f0c92e15c897ef1a933b67
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/01/2019
ms.locfileid: "57048991"
---
<a name="understanding-partial-page-updates-with-aspnet-ajax"></a>Общие сведения о частичных обновлениях страниц с помощью ASP.NET AJAX
====================
по [(Scott cate)](https://github.com/scottcate)

[Загрузить PDF-файл](http://download.microsoft.com/download/C/1/9/C19A3451-1D14-477C-B703-54EF22E197EE/AJAX_tutorial01_Partial_Page_Updates_cs.pdf)

> Возможно, самой заметной функцией расширения AJAX для ASP.NET является возможность выполнить обновления на странице частичной или добавочной, не выполняя полную обратную передачу на сервер без изменения кода и с минимальными разметки изменения. Преимущества доступны широкие — состояние файлов мультимедиа (например, Adobe Flash или носитель Windows) не изменяется, сокращаются затраты на полосу пропускания и клиент не возникнет мерцание, обычно связанных с обратной передачи.


## <a name="introduction"></a>Вступление

Технологии ASP.NET корпорации Майкрософт предоставляет модель программирования объектно ориентированные и управляемые событиями и объединяет его преимущества скомпилированного кода. Тем не менее его модель обработки на сервере имеет несколько недостатков, присущих технологии.

- Обновления страницы требует кругового обращения к серверу, требующий обновления страницы.
- Циклов приема-передачи не сохраняются все эффекты, созданные Javascript или другие технологии на стороне клиента (например, Adobe Flash)
- Во время обратной передачи обозревателей, отличных от Microsoft Internet Explorer не поддерживают автоматически восстановить позицию прокрутки. И даже в Internet Explorer, по-прежнему эффекта мерцания при обновлении страницы.
- Обратные передачи может включать в себя большой объем пропускной способности \_ \_поля формы VIEWSTATE может увеличиваться, особенно при работе с элементами управления, например элемента управления GridView или знаки повторения.
- Не существует единой модели для доступа к веб-служб через JavaScript или другие технологии на стороне клиента.

Введите расширения AJAX для ASP.NET корпорации Майкрософт. AJAX, предназначенную для **объект** синхронной **J** avaScript **объект** nd **X** машинного Обучения, — это интегрированная платформа для предоставления добавочные страницы обновления с помощью кросс платформенных JavaScript, состоящий из серверного кода, которые платформа Microsoft AJAX и компонент скрипта, называемый скрипт библиотеки Microsoft AJAX. Расширения AJAX для ASP.NET также поддерживает кросс платформенных для доступа к веб-служб ASP.NET с помощью JavaScript.

Функциональные возможности частичного обновления расширений AJAX для ASP.NET, который включает компонент ScriptManager, элемент управления UpdatePanel и элемент управления UpdateProgress и рассматривает ситуации, в которых они должны или не должны быть проверяет этот технический документ загруженные.

Этот технический документ основан на бета-версии 2 Visual Studio 2008 и .NET Framework 3.5, которая интегрирует расширения AJAX для ASP.NET в библиотеке базовых классов (где это было ранее дополнительный компонент для ASP.NET 2.0). Этот технический документ также предполагается, что вы используете Visual Studio 2008 и не Visual Web Developer Express Edition; Некоторые шаблоны проекта, на которые ссылаются, не могут быть доступны для пользователей Visual Web Developer Express.

## <a name="partial-page-updates"></a>Частичного обновления страниц

Возможно, самой заметной функцией расширения AJAX для ASP.NET является возможность выполнить обновления на странице частичной или добавочной, не выполняя полную обратную передачу на сервер без изменения кода и с минимальными разметки изменения. Преимущества доступны широкие — состояние файлов мультимедиа (например, Adobe Flash или носитель Windows) не изменяется, сокращаются затраты на полосу пропускания и клиент не возникнет мерцание, обычно связанных с обратной передачи.

Возможность интеграции частичной отрисовки интегрирована в ASP.NET с минимальными изменениями в проект.

## <a name="walkthrough-integrating-partial-rendering-into-an-existing-project"></a>Пошаговое руководство. Интеграция частичной визуализации в существующий проект


1. В Microsoft Visual Studio 2008, создайте новый проект веб-сайт ASP.NET, выбрав <em>файл</em>  <em>- &gt; New</em>  <em>- &gt; веб-сайт</em> и выбрав веб-сайта ASP.NET в диалоговом окне. Вы можете назвать ее любым и программное обеспечение можно установить в файловую систему или в Internet Information Services (IIS).
2. Откроется с пустым по умолчанию страницы с разметкой basic ASP.NET (формы на сервере и `@Page` директива). Удалить метку с именем `Label1` и кнопки с именем `Button1` на страницу в элемент form. Их свойства text можно установить на любое другое.
3. В конструкторе, дважды щелкните `Button1` Чтобы создать обработчик события кода. В этом обработчике событий задать `Label1.Text` для нажатия кнопки! .

**В листинге 1: Разметка для default.aspx, прежде чем частичная отрисовка разрешена**

[!code-aspx[Main](understanding-partial-page-updates-with-asp-net-ajax/samples/sample1.aspx)]

**В листинге 2: (Фрагмент) в файл default.aspx.cs фонового кода**

[!code-csharp[Main](understanding-partial-page-updates-with-asp-net-ajax/samples/sample2.cs)]

1. Нажмите клавишу F5, чтобы запустить веб-сайт. Visual Studio предложит добавить файл web.config для включения отладки; Сделайте это. При нажатии кнопки, обратите внимание, что обновлении этой страницы, чтобы изменить текст в метке имеется краткое мерцание при обновлении страницы.
2. Закрыв окно браузера, вернитесь в Visual Studio и страницу разметки. Прокрутите вниз на панели элементов Visual Studio и найдите вкладку расширений AJAX. (Если у вас нет этой вкладке так, как вы используете более старую версию расширения AJAX и Atlas, см. пошаговое руководство по регистрации элементы панели инструментов расширений AJAX далее в этом техническом документе, или установить текущую версию с помощью загружаемых установщика Windows на веб-сайте).


[![](understanding-partial-page-updates-with-asp-net-ajax/_static/image2.png)](understanding-partial-page-updates-with-asp-net-ajax/_static/image1.png)

([Просмотр полноразмерного изображения](understanding-partial-page-updates-with-asp-net-ajax/_static/image3.png))


1. <em>Известная проблема:</em>при установке Visual Studio 2008 на компьютер, на котором уже установлена Visual Studio 2005, которые устанавливаются вместе с ASP.NET 2.0 AJAX Extensions, Visual Studio 2008 будет импортировать элементы панели инструментов расширений AJAX. Можно определить, является ли это так, изучив подсказки компонентов; их должно быть указано версии 3.5.0.0. Если бы они сказали версии 2.0.0.0, импортированных старых элементов панели элементов затем будет необходимо вручную импортировать их с помощью диалогового окна Выбор элементов панели элементов в Visual Studio. Нельзя добавлять элементы управления версии 2 с помощью конструктора.

2. Прежде чем `<asp:Label>` тег начинается, создать строку из пробелов и дважды щелкните элемент управления UpdatePanel на панели элементов. Обратите внимание, что новый `@Register` директива включается в верхней части страницы, указывающее, что элементы управления в пространстве имен System.Web.UI должно быть импортировано с использованием `asp:` префикс.
3. Перетащите закрывающий `</asp:UpdatePanel>` тег конца элемента-кнопки, таким образом, элемент правильного формата с элементами управления Label и кнопку в оболочку.
4. После открывающего `<asp:UpdatePanel>` тег, приступать к открытию нового тега. Обратите внимание на то, что IntelliSense предлагает два варианта. В этом случае создайте `<ContentTemplate>` тега. Убедитесь, что охватывать этот тегом метку и кнопку, чтобы разметку имеет правильный формат.


[![](understanding-partial-page-updates-with-asp-net-ajax/_static/image5.png)](understanding-partial-page-updates-with-asp-net-ajax/_static/image4.png)

([Просмотр полноразмерного изображения](understanding-partial-page-updates-with-asp-net-ajax/_static/image6.png))


1. В любом месте в пределах `<form>` элемент, включают элемент управления ScriptManager, дважды щелкнув `ScriptManager` элемент на панели элементов.
2. Изменить `<asp:ScriptManager>` тег таким образом, чтобы он включал атрибут `EnablePartialRendering= true`.

**Листинг 3: Разметка для default.aspx с включенной частичной отрисовкой**

[!code-aspx[Main](understanding-partial-page-updates-with-asp-net-ajax/samples/sample3.aspx)]

1. Откройте файл web.config. Обратите внимание на то, что Visual Studio автоматически добавляет ссылку компиляции System.Web.Extensions.dll.

1. Новые возможности в Visual Studio 2008: Части сведений о конфигурации, который может быть без комментариями, чтобы включить дополнительные комментариями файла web.config, который поставляется с веб-сайт ASP.NET шаблоны проектов, автоматически включает все необходимые ссылки на расширения AJAX для ASP.NET и включает в себя функциональные возможности. Visual Studio 2005 было похожих шаблонов, когда были установлены расширения AJAX для ASP.NET 2.0. Однако в Visual Studio 2008, расширения AJAX являются отказаться по умолчанию (то есть они указываются по умолчанию, но можно удалить ссылки на).


[![](understanding-partial-page-updates-with-asp-net-ajax/_static/image8.png)](understanding-partial-page-updates-with-asp-net-ajax/_static/image7.png)

([Просмотр полноразмерного изображения](understanding-partial-page-updates-with-asp-net-ajax/_static/image9.png))


1. Нажмите клавишу F5 для запуска веб-сайта. Обратите внимание на то, как без изменения исходного кода были должны поддерживать частичная визуализация — только разметку был изменен.

При запуске веб-сайта, вы увидите, что частичная визуализация — теперь включен, так как при нажатии на кнопку существует будет не мерцание, а также будет ли изменения в позиции прокрутки страницы (этот пример не демонстрирует,). Если для поиска в источнике, готовый для просмотра страницы, после нажатия кнопки, он будет убедитесь, что на самом деле не произошла обратная передача — исходный текст метки по-прежнему является частью исходной разметки и изменении метки с помощью JavaScript.

Visual Studio 2008 не поставляются с предварительно определенный шаблон для на веб-сайте с поддержкой ASP.NET AJAX. Однако такой шаблон был доступен в Visual Studio 2005, если были установлены Visual Studio 2005 и ASP.NET 2.0 AJAX Extensions. Следовательно, Настройка веб-узла и начиная с поддержкой AJAX веб-сайт шаблона скорее всего будет еще проще, в шаблоне следует включить в файл web.config, полностью настроен (с поддержкой всех расширений AJAX для ASP.NET, включая доступ к веб-служб и сериализации JSON - JavaScript Object Notation) и включает в себя UpdatePanel и ContentTemplate на главной странице веб-форм по умолчанию. Включение частичной визуализации с этой страницей по умолчанию является просто Возвращаясь к 10 шаге данного пошагового руководства и упорядочивая элементы управления на страницу.

## <a name="the-scriptmanager-control"></a>Элемент управления ScriptManager

## <a name="scriptmanager-control-reference"></a>Ссылки на элемент управления ScriptManager

Свойства с поддержкой разметки:

| **Имя свойства** | **Type** | **Описание** |
| --- | --- | --- |
| AllowCustomErrors-Redirect | Bool | Указывает, следует ли использовать пользовательский раздел ошибок файла web.config для обработки ошибок. |
| AsyncPostBackError-Message | String | Возвращает или задает сообщение об ошибке отправляется клиенту, если возникает ошибка. |
| AsyncPostBack-Timeout | Int32 | Возвращает или задает объем времени, которого клиент должен ждать завершения асинхронного запроса по умолчанию. |
| Глобализация EnableScript | Bool | Возвращает или задает признак включения сценария глобализации. |
| EnableScript локализации | Bool | Возвращает или задает признак включения локализацию сценариев. |
| ScriptLoadTimeout | Int32 | Определяет количество секунд, разрешенное для загрузки скриптов в клиент |
| ScriptMode | Enum (Auto, отладка, выпуск, наследуют) | Возвращает или задает, следует ли отрисовывать окончательным версиям сценариев |
| ScriptPath | String | Возвращает или задает корневой путь к расположению файлов сценариев, отправляемое клиенту. |

Свойства только для кода:

| **Имя свойства** | **Type** | **Описание** |
| --- | --- | --- |
| AuthenticationService | AuthenticationService-Manager | Получает сведения о прокси-службы проверки подлинности ASP.NET, который будет отправлен клиенту. |
| IsDebuggingEnabled | Bool | Получает ли сценарий и код отладки. |
| IsInAsyncPostback | Bool | Получает ли страница в данный момент находится в асинхронный запрос обратной передачи. |
| ProfileService | ProfileService-Manager | Возвращает сведения о прокси-службы профилирования ASP.NET, отправляемое клиенту. |
| Сценарии | Коллекция&lt;ссылки на сценарий&gt; | Возвращает коллекцию ссылок на скрипты, которые будут отправляться клиенту. |
| Службы | Коллекция&lt;ссылки на службу&gt; | Получает коллекцию ссылок на прокси-сервера веб-службы, которые будут отправляться клиенту. |
| SupportsPartialRendering | Bool | Получает значение, указывающее текущий клиент поддерживает частичную визуализацию. Если это свойство возвращает **false**, то все запросы страниц будет стандартных обратных передач. |

Методы открытого кода:

| **Имя метода** | **Type** | **Описание** |
| --- | --- | --- |
| SetFocus(string) | Void | Устанавливает фокус клиента определенному элементу управления, при завершении запроса. |

Потомки разметки:

| **Тег** | **Описание** |
| --- | --- |
| &lt;AuthenticationService&gt; | Сведения о прокси-сервера, служба проверки подлинности ASP.NET. |
| &lt;ProfileService&gt; | Сведения о прокси-сервер для ASP.NET, профилирование службы. |
| &lt;Скрипты&gt; | Предоставляет ссылки на дополнительные сценарии. |
| &lt;asp:ScriptReference&gt; | Обозначает определенный сценарий ссылку. |
| &lt;Service&gt; | Предоставляет дополнительные ссылки веб-службы, в которых будут создаваться классы прокси, созданные. |
| &lt;asp:ServiceReference&gt; | Указывает ссылку на определенной веб-службы. |

Элемент управления ScriptManager представляет essential core для расширения AJAX для ASP.NET. Он предоставляет доступ к библиотеке сценариев (включая систему типов обширной скрипт на стороне клиента), поддерживает частичную визуализацию и предоставляет расширенную поддержку дополнительных служб ASP.NET (например, проверка подлинности и профилирования, а также другие веб-службы). Элемент управления ScriptManager также обеспечивает поддержку глобализации и локализации для клиентских скриптов.

## <a name="providing-alternative-and-supplemental-scripts"></a>Предоставляя альтернативные и дополнительные скрипты

Хотя Microsoft ASP.NET 2.0 AJAX Extensions содержат код весь скрипт в обоих отладки и выпуск выпуски в качестве ресурсов, внедренных в ссылочных сборках, разработчики могут перенаправлять ScriptManager файлы пользовательского сценария, а также для регистрации Дополнительные необходимые сценарии.

Чтобы переопределить привязку по умолчанию для скриптов обычно включается (например, тех, которые поддерживают пространстве имен Sys.WebForms и пользовательского ввода системы), вы можете зарегистрироваться `ResolveScriptReference` класса ScriptManager. При вызове этого метода, обработчик событий имеет возможность изменить путь к файлу скрипта в вопросе; Диспетчер сценариев будет отправлять копию различных или настроенные сценарии клиенту.

Кроме того, ссылки на сценарии (представленный `ScriptReference` класс) можно включить программно или с помощью разметки. Чтобы сделать это, либо программно изменить `ScriptManager.Scripts` коллекции, или включать `<asp:ScriptReference>` теги `<Scripts>` тег, который является дочерним для элемента управления ScriptManager первого уровня.

## <a name="custom-error-handling-for-updatepanels"></a>Настраиваемую обработку ошибок для элементов UpdatePanel

Несмотря на то, что обновления обрабатываются платформой триггеры, заданные элементы управления UpdatePanel, поддержка обработки ошибок и пользовательские сообщения об ошибках обрабатывается экземпляром элемента управления страницы ScriptManager. Это можно сделать, предоставление события, `AsyncPostBackError`, страницу, которая может затем предоставить пользовательскую логику обработки исключений.

Счет потребления событий AsyncPostBackError, можно указать `AsyncPostBackErrorMessage` свойства, после чего окно с предупреждением вызываемого по завершении обратного вызова.

Настройка на стороне клиента можно также вместо использования по умолчанию окно предупреждения; Например, может потребоваться отобразить настраиваемый `<div>` элемент, а не модальное диалоговое окно браузера по умолчанию. В этом случае можно обрабатывать ошибки из клиентского скрипта.

**В листинге 5: Клиентский сценарий для отображения пользовательских ошибок**

[!code-html[Main](understanding-partial-page-updates-with-asp-net-ajax/samples/sample4.html)]

Попросту говоря приведенный выше сценарий регистрирует обратный вызов для среды выполнения AJAX на стороне клиента после завершения асинхронного запроса. Затем она проверяет см. в разделе ли возникла ошибка и если да, обрабатывает данные, и, наконец, указывающее, в среду выполнения, ошибки было обработано в пользовательский скрипт.

## <a name="globalization-and-localization-support"></a>Глобализации и локализации

Элемент управления ScriptManager предоставляет расширенную поддержку локализации строк скрипта и компонентов пользовательского интерфейса; Тем не менее этот раздел выходит за рамки данной статьи. Дополнительные сведения см. в разделе в техническом документе, поддержка глобализации в расширениях AJAX для ASP.NET.

## <a name="the-updatepanel-control"></a>Элемент управления UpdatePanel

## <a name="updatepanel-control-reference"></a>Ссылки на элемент управления UpdatePanel

Свойства с поддержкой разметки:

| **Имя свойства** | **Type** | **Описание** |
| --- | --- | --- |
| ChildrenAsTriggers | bool | Указывает, является ли дочерние элементы управления автоматически вызывать обновление при обратной передаче. |
| Отображается как | enum (блок), встроенной) | Указывает, что его содержимое откроется визуально. |
| UpdateMode | enum (всегда), условное) | Указывает, обновляется ли всегда UpdatePanel во время частичной отрисовки или если они только обновляются при попадании в триггер. |

Свойства только для кода:

| **Имя свойства** | **Type** | **Описание** |
| --- | --- | --- |
| IsInPartialRendering | bool | Получает значение, указывающее UpdatePanel поддерживает частичную визуализацию для текущего запроса. |
| ContentTemplate | ITemplate | Получает разметку шаблона для запроса на обновление. |
| ContentTemplateContainer | Элемент управления | Получает программный шаблона для запроса на обновление. |
| Триггеры | UpdatePanel - TriggerCollection | Получает список триггеров, связанных с текущей UpdatePanel. |

Методы открытого кода:

| **Имя метода** | **Type** | **Описание** |
| --- | --- | --- |
| Update() | Void | Обновляет указанный UpdatePanel программными средствами. Позволяет запросу сервера для запуска частичной визуализации из UpdatePanel, в противном случае без триггеров. |

Потомки разметки:

| **Тег** | **Описание** |
| --- | --- |
| &lt;ContentTemplate&gt; | Задает разметку, чтобы использовать для отображения результатов частичной визуализации. Потомком &lt;asp: UpdatePanel&gt;. |
| &lt;Триггеры&gt; | Указывает коллекцию *n* элементы управления, связанные с обновлением этого элемента управления UpdatePanel. Потомком &lt;asp: UpdatePanel&gt;. |
| &lt;asp:AsyncPostBackTrigger&gt; | Задает триггер, который вызывает частичной визуализации для заданного UpdatePanel. Это может или не может быть элемент управления как потомок элемента управления UpdatePanel в вопросе. Детализированные и имя события. Потомком &lt;триггеры&gt;. |
| &lt;asp:PostBackTrigger&gt; | Указывает элемент управления, который вызывает обновления всей страницы. Это может или не может быть элемент управления как потомок элемента управления UpdatePanel в вопросе. Детализированные к объекту. Потомком &lt;триггеры&gt;. |

`UpdatePanel` Элемент управления является элемент управления, который разделяет содержимое на стороне сервера, будут участвовать в частичной визуализации функциональность расширений AJAX. Нет ограничений на число элементов управления UpdatePanel, которые могут быть на странице, и они могут быть вложенными. Каждый UpdatePanel изолируется, и это каждый может работать независимо друг от друга (может иметь два UpdatePanels, выполняются одновременно, Подготовка к просмотру различных частей страницы, независимо от обратной передачи страницы).

В первую очередь сделки с триггерами управления — по умолчанию любой элемент управления внутри элемента управления UpdatePanel, элемент управления UpdatePanel `ContentTemplate` , создает обратную передачу зарегистрировался в качестве триггера для UpdatePanel. Это означает, что UpdatePanel можно работать с привязкой к данным элементы управления по умолчанию (такие как GridView), с пользовательскими элементами управления, и их можно запрограммировать в скрипте.

По умолчанию при активации частичной визуализации, все элементы управления UpdatePanel на странице будут обновляться, ли элементы управления UpdatePanel определены триггеры для такого действия. Например если один элемент UpdatePanel определяет элемент управления Button и элемент управления кнопки нажата, все элементы управления UpdatePanel на этой странице будут обновляться по умолчанию. Это обусловлено тем, по умолчанию `UpdateMode` свойству элемента управления UpdatePanel присваивается `Always`. Кроме того, можно присвоить свойство UpdateMode `Conditional`, означающее, что UpdatePanel будут обновляться только если достигается конкретного триггера.

## <a name="custom-control-notes"></a>Заметки о пользовательского элемента управления

UpdatePanel можно добавить любой пользовательский элемент управления или пользовательский элемент управления; Тем не менее, страницы, на котором включены эти элементы управления также должен включать элемент управления ScriptManager со свойством, значение EnablePartialRendering **true**.

Один из способов в котором вы может учитывать при использовании пользовательских веб-элементов управления, в Переопределите защищенный `CreateChildControls()` метод `CompositeControl` класса. Таким образом, можно внедрить UpdatePanel между дочернего элемента управления и внешним миром, если вы решили, что страница поддерживает частичной визуализации; в противном случае можно просто добавить уровень дочерних элементов управления в контейнер `Control` экземпляра.

## <a name="updatepanel-considerations"></a>Рекомендации по UpdatePanel

UpdatePanel означает что-то из черного прямоугольника упаковки обратных передач ASP.NET в контексте JavaScript XMLHttpRequest. Тем не менее существуют рекомендации по производительности необходимо понять, как с точки зрения поведения и скорости. Чтобы понять, как работает UpdatePanel, таким образом, вы можете лучше всего подходит при его использования, следует проверить AJAX exchange. В следующем примере существующий сайт и, Mozilla Firefox с расширением Firebug (Firebug фиксирует XMLHttpRequest данных).

Рассмотрим форму, которая, помимо прочего, имеется текстовое поле Почтовый код, который должен заполнить поле Город и штат в форме или элементе управления. В конечном счете, эта форма собирает сведения о членстве, включая имя пользователя, адрес и контактные данные. Существует множество рекомендации по проектированию с весовым коэффициентом учетной записи в зависимости от требований конкретного проекта.


[![](understanding-partial-page-updates-with-asp-net-ajax/_static/image11.png)](understanding-partial-page-updates-with-asp-net-ajax/_static/image10.png)

([Просмотр полноразмерного изображения](understanding-partial-page-updates-with-asp-net-ajax/_static/image12.png))


[![](understanding-partial-page-updates-with-asp-net-ajax/_static/image14.png)](understanding-partial-page-updates-with-asp-net-ajax/_static/image13.png)

([Просмотр полноразмерного изображения](understanding-partial-page-updates-with-asp-net-ajax/_static/image15.png))


В исходном итерации этого приложения был создан элемент управления включен полностью регистрационные данные пользователя, включая почтовый индекс, Город и штат. Весь элемент управления было заключено в UpdatePanel и на веб-формы. При вводе пользователем почтовый индекс UpdatePanel обнаруживает событие (соответствующие событие TextChanged в серверной части, можно указать триггеры, либо с помощью свойство ChildrenAsTriggers равным true). AJAX учитывает все поля внутри UpdatePanel, как захвачено FireBug (см. схему справа).

Как на снимке экрана, значения из каждого элемента управления внутри UpdatePanel доставляются (в этом случае они пусты), а также поле состояния представления. Все говорят более чем 9 КБ данных отправляется, когда на самом деле только пять байт данных были необходимы для выполнения данного конкретного запроса. Ответ — еще более перегруженными: всего 57 КБ отправляется клиенту, просто для того, чтобы обновить текстовое поле и поле раскрывающегося списка.

Он также может представлять интерес для см. в разделе, как ASP.NET AJAX обновляет представление. Часть ответа запрос на обновление UpdatePanel отображается в окне консоли Firebug слева; Это специально сформулировать разделением вертикальной чертой строка, разбитого с помощью скрипта клиента и после собраны на странице. В частности, ASP.NET AJAX задает *innerHTML* свойство элемента HTML на клиенте, который представляет ваш UpdatePanel. Как и в браузере повторно создает модель DOM, имеется небольшая задержка, в зависимости от объема сведений, которые необходимо обработать.

Повторное создание модели DOM запускает ряд дополнительных вопросов:


[![](understanding-partial-page-updates-with-asp-net-ajax/_static/image17.png)](understanding-partial-page-updates-with-asp-net-ajax/_static/image16.png)

([Просмотр полноразмерного изображения](understanding-partial-page-updates-with-asp-net-ajax/_static/image18.png))


- Если элемент с фокусом HTML находится внутри UpdatePanel, он теряет фокус. Таким образом для пользователей, нажал клавишу Tab, чтобы выйти из текстового поля индекс, их назначения следующего было бы текстовое поле Город. Тем не менее после обновления UpdatePanel отображение формы больше не позволило бы фокус и нажатие клавиши Tab должен был запустить выделение элементов фокус (например, ссылки).
- Если любой тип пользовательского скрипта на стороне клиента используется, чтобы функциями сохранены элементы обращается к модели DOM, ссылки могут стать уничтоженные после частичной обратной передачи.

Элементы UpdatePanel не предназначены для быть универсальным решения. Вместо этого они обеспечивают быстрое решение для определенных ситуациях, включая создание прототипов, обновления небольшой элемент управления и предоставляют знакомый интерфейс для разработчиков ASP.NET, которые могут быть знакомы с моделью объектов .NET, но меньше, благодаря чему с моделью DOM. Существует ряд альтернативных вариантов, которые может обеспечить лучшую производительность, в зависимости от сценария приложения:

- Рассмотрите возможность использования PageMethods и JSON (JavaScript Object Notation) позволяет разработчику вызвать статические методы на странице, как если бы был вызван метод вызов веб-службы. Поскольку методы являются статическими, ни одно состояние не требуется; вызывающий скрипт предоставляет параметры, а результат возвращается в асинхронном режиме.
- Рассмотрите возможность использования веб-службы и JSON, если один элемент управления должен использоваться в нескольких местах внутри приложения. Это снова требуется специальные больших усилий, а также работает асинхронно.

Включение функциональности через веб-службы или методы страниц имеет также недостатки. В первую очередь разработчики ASP.NET обычно склонны для создания небольших компонентов функций в пользовательские элементы управления (ASCX). Методы страниц не может размещаться в этих файлах; они должны быть включены в класс страницы фактическое aspx. Аналогичным образом, веб-служб, должны размещаться внутри класса .asmx. В зависимости от приложения эта архитектура может нарушать принципа персональной ответственности, в том, что функциональные возможности для одного компонента теперь распределены между двух или более физические компоненты, которые могут иметь незначительной или нулевой связный ties.

Наконец Если приложение требует использования элементов UpdatePanel, приведенным ниже рекомендациям должна помочь при устранении неполадок и обслуживание.

- **Вложенные элементы UpdatePanel как можно не только в пределах единиц, но и между единицами кода.** Например наличие элемента управления UpdatePanel на странице, который заключает в оболочку элемент управления, пока этот элемент управления также содержит UpdatePanel, который содержит другой элемент управления, содержащий UpdatePanel, — вложение кросс единица. Это позволяет сохранять Очистить элементы, которые должны обновляться и предотвращает непредвиденное обновления дочерних элементов UpdatePanel.
- **Сохранить *ChildrenAsTriggers* свойство значение false и явным образом задать запуска событий.** Использование `<Triggers>` коллекции — это гораздо понятнее способ обработки событий и может избежать непредвиденных результатов, что упрощает задачи обслуживания и поэтому разработчику подписаться на событие.
- **Наименьший можно используйте для реализации функциональности.** Как отмечалось в описании службы почтовый индекс, упаковки, что только минимальный набор сокращает время сервера, общее обработки и объем между клиентом и сервером exchange, чтобы улучшить производительность.

## <a name="the-updateprogress-control"></a>Элемент управления UpdateProgress

## <a name="updateprogress-control-reference"></a>Ссылки на элемент управления UpdateProgress

Свойства с поддержкой разметки:

| **Имя свойства** | **Type** | **Описание** |
| --- | --- | --- |
| AssociatedUpdate PanelID | String | Указывает идентификатор элемента управления UpdatePanel, этот UpdateProgress следует сообщать на. |
| DisplayAfter | Int | Указывает время ожидания в миллисекундах перед отображением этого элемента управления после начала асинхронный запрос. |
| DynamicLayout | bool | Определяет, отображаются ли ход выполнения динамически. |

Потомки разметки:

| **Тег** | **Описание** |
| --- | --- |
| &lt;ProgressTemplate&gt; | Содержит шаблон элемента управления для содержимого, которое будет отображаться с этим элементом управления. |

Элемент управления UpdateProgress позволяет обратной связи для сохранять процент пользователей в процессе выполнения необходимых действий для передачи на сервер. Это может помочь пользователям знать, что вы делаете что-то несмотря на то, что он может быть неочевидно, особенно в том случае, поскольку большинство пользователей используются для страницы, обновление и отображается в строке состояния выделения.

Замечу, что элементы управления UpdateProgress может находиться в любом в иерархии страницы. Тем не менее в случаях, в которых инициируется частичной обратной передачи из дочерний элемент UpdatePanel, (где UpdatePanel вложен в другой экземпляр UpdatePanel), обратные передачи, что триггер дочерние UpdatePanel вызовет UpdateProgress чтобы шаблоны отображались для дочернего элемента UpdatePanel, а также родительского UpdatePanel. Но, если триггер является прямым потомком родительского UpdatePanel, то будут отображаться только шаблоны UpdateProgress, связанное с родителем.

## <a name="summary"></a>Сводка

Расширения Microsoft ASP.NET AJAX являются сложные продуктов, разработанных для помощи в повышение уровня доступности веб-содержимого и для предоставления пользователям более широкие возможности для веб-приложений. Как часть расширений AJAX для ASP.NET, частичной отрисовки элементов управления, включая элементы управления ScriptManager, UpdatePanel и UpdateProgress приведены некоторые из самых заметных компонентов пакета средств.

Компонент ScriptManager интегрируется предоставления клиентский скрипт JavaScript для расширений, а также включает различные компоненты на стороне сервера и клиента для работы совместно с минимальным разработки инвестиций.

Элемент управления UpdatePanel поле очевидным magic веб-разметку внутри UpdatePanel могут иметь фонового кода на стороне сервера и не активирует обновления страницы. Элементы управления UpdatePanel могут быть вложенными и может зависеть от элементов управления в другие UpdatePanel. По умолчанию элементы UpdatePanel обрабатывать любые обратных передач, вызываемых своих дочерних элементов управления, несмотря на то, что эта функция может быть точно настроенных, декларативно или программно.

При использовании элемента управления UpdatePanel, разработчикам следует учитывать влияние на производительность, потенциально может возникнуть. Возможные альтернативы включают веб-служб и методы страниц на то, что следует рассматривать проект приложения.

UpdateProgress, элемент управления позволяет пользователя о том, что он не игнорируется и что фактическая схема запроса происходит во время нахождения страницы в противном случае не делает ничего реагировать на ввод данных пользователем. Она также включает возможность прерывать результатов частичной визуализации.

Вместе эти средства помогают создает широкие возможности и простой пользовательский интерфейс, делая менее повлияют на работу сервера и менее прерывания рабочего процесса.

## <a name="bio"></a>Биография

(Scott cate) работает с веб-технологиями Microsoft с 1997 года и является президентом myKB.com ([www.myKB.com](http://www.myKB.com)) приложений, внимание уделяется знаний программных решений, где он специализируется на написание ASP.NET на основе. Скоттом можно связаться по электронной почте [ scott.cate@myKB.com ](mailto:scott.cate@myKB.com) или его блог по адресу [ScottCate.com](http://ScottCate.com)

> [!div class="step-by-step"]
> [Вперед](understanding-asp-net-ajax-updatepanel-triggers.md)
