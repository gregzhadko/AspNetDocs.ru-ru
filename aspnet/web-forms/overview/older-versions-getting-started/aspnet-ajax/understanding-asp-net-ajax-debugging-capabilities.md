---
uid: web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-asp-net-ajax-debugging-capabilities
title: Основные сведения о возможностях отладки ASP.NET AJAX | Документация Майкрософт
author: scottcate
description: Возможность отладки кода — это навык, который каждый разработчик должен иметь в своих арсеналу, независимо от технологии, которую они используют. Хотя многие разработчики...
ms.author: riande
ms.date: 03/28/2008
ms.assetid: 7f9380c6-19f7-4c82-a019-916ec6dffc9c
msc.legacyurl: /web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-asp-net-ajax-debugging-capabilities
msc.type: authoredcontent
ms.openlocfilehash: 08ced380f3551407d757524dbc84b5feeeb5482b
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74601461"
---
# <a name="understanding-aspnet-ajax-debugging-capabilities"></a>Общие сведения о возможностях отладки ASP.NET AJAX

по [Скотт Cate](https://github.com/scottcate)

[Загрузить PDF-файл](https://download.microsoft.com/download/C/1/9/C19A3451-1D14-477C-B703-54EF22E197EE/AJAX_tutorial06_Debugging_MS_Ajax_Applications_cs.pdf)

> Возможность отладки кода — это навык, который каждый разработчик должен иметь в своих арсеналу, независимо от технологии, которую они используют. Хотя многие разработчики привыкли использовать Visual Studio .NET или Web Developer Express для отладки ASP.NET приложений, использующих VB.NET C# или код, некоторые не знают, что они также чрезвычайно полезны для отладки кода на стороне клиента, например JavaScript. Те же типы методов, которые используются для отладки приложений .NET, также можно применять к приложениям с поддержкой AJAX и более ASP.NET приложениям AJAX.

## <a name="debugging-aspnet-ajax-applications"></a>Отладка приложений ASP.NET AJAX

Вахлин "+ +"

Возможность отладки кода — это навык, который каждый разработчик должен иметь в своих арсеналу, независимо от технологии, которую они используют. Это не говорит о том, что понимание различных доступных возможностей отладки может сэкономить много времени на проекте и, возможно, даже несколько проблем. Хотя многие разработчики привыкли использовать Visual Studio .NET или Web Developer Express для отладки ASP.NET приложений, использующих VB.NET C# или код, некоторые не знают, что они также чрезвычайно полезны для отладки кода на стороне клиента, например JavaScript. Те же типы методов, которые используются для отладки приложений .NET, также можно применять к приложениям с поддержкой AJAX и более ASP.NET приложениям AJAX.

В этой статье вы узнаете, как Visual Studio 2008 и несколько других средств можно использовать для отладки приложений ASP.NET AJAX для быстрого выявления ошибок и других проблем. В этом обсуждении будут содержаться сведения о включении Internet Explorer 6 или более поздней версии для отладки, использовании Visual Studio 2008 и обозревателя скриптов для пошагового выполнения кода, а также других бесплатных средств, таких как вспомогательная программа веб-разработки. Вы также узнаете, как выполнять отладку приложений ASP.NET AJAX в браузере Firefox с помощью расширения Firebug, которое позволяет пошагово выполнять код JavaScript непосредственно в браузере без каких-либо других средств. Наконец, вы будете присутствовать в классах в библиотеке AJAX ASP.NET, которая может помочь в различных задачах отладки, таких как трассировка и операторы утверждения кода.

Прежде чем пытаться отлаживать страницы, просматриваемые в Internet Explorer, необходимо выполнить несколько основных действий, чтобы включить его для отладки. Давайте рассмотрим некоторые базовые требования к настройке, которые необходимо выполнить, чтобы приступить к работе.

## <a name="configuring-internet-explorer-for-debugging"></a>Настройка Internet Explorer для отладки

Большинству пользователей не требуется просматривать проблемы JavaScript, обнаруженные на веб-сайте, который отображается в Internet Explorer. На самом деле, средний пользователь даже не знает, что делать, если они видели сообщение об ошибке. В результате параметры отладки по умолчанию отключены в браузере. Однако очень просто включить отладку и разместить ее для использования при разработке новых приложений AJAX.

Чтобы включить функцию отладки, в меню Internet Explorer выберите Сервис Свойства обозревателя и перейдите на вкладку Дополнительно. В разделе "Обзор" снимите флажки для следующих элементов:

- Отключить отладку скриптов (Internet Explorer)
- Отключить отладку скриптов (другие)

Хотя это и не является обязательным, при попытке отладки приложения, вероятно, потребуется, чтобы все ошибки JavaScript на странице были немедленно видны и очевидны. Можно принудительно отобразить все ошибки с помощью окна сообщения, установив флажок "отображать уведомление о каждой ошибке сценария". Хотя это отличный вариант для включения во время разработки приложения, он может быстро стать нежелательным, если вы просто прорабатываете другие веб-сайты, так как вероятность возникновения ошибок JavaScript довольно хорошая.

На рис. 1 показано, что должно выглядеть диалоговое окно Internet Explorer Advanced после того, как оно будет правильно настроено для отладки.

[![настройке Internet Explorer для отладки.](understanding-asp-net-ajax-debugging-capabilities/_static/image2.png)](understanding-asp-net-ajax-debugging-capabilities/_static/image1.png)

**Рис. 1**. Настройка Internet Explorer для отладки.  ([Щелкните, чтобы просмотреть изображение с полным размером](understanding-asp-net-ajax-debugging-capabilities/_static/image3.png))

После включения отладки в меню "вид" появится новый пункт "отладчик скриптов". Доступно два варианта, включая открытые и разрывы на следующем операторе. Если выбрано значение открыть, вам будет предложено отладить страницу в Visual Studio 2008 (Обратите внимание, что Visual Web Developer Express можно также использовать для отладки). Если Visual Studio .NET выполняется в данный момент, вы можете использовать этот экземпляр или создать новый экземпляр. При выборе прерывания на следующем операторе будет предложено выполнить отладку страницы при выполнении кода JavaScript. Если код JavaScript выполняется в событии OnLoad страницы, можно обновить страницу, чтобы активировать сеанс отладки. Если код JavaScript выполняется после нажатия кнопки, отладчик будет выполняться сразу после нажатия кнопки.

> [!NOTE]
> Если вы используете Windows Vista с включенным контролем учетных записей (UAC), а Visual Studio 2008 настроен для запуска от имени администратора, Visual Studio не сможет присоединиться к процессу при появлении запроса на присоединение. Чтобы обойти эту ошибку, сначала запустите Visual Studio и используйте этот экземпляр для отладки.

В следующем разделе будет продемонстрировано, как выполнить отладку страницы ASP.NET AJAX непосредственно в Visual Studio 2008, используя параметр отладчика сценариев Internet Explorer, если страница уже открыта и вы хотите более полно проверить ее.

## <a name="debugging-with-visual-studio-2008"></a>Отладка с помощью Visual Studio 2008

Visual Studio 2008 предоставляет функциональные возможности отладки, которые разработчики по всему миру полагаются на повседневную работу для отладки приложений .NET. Встроенный отладчик позволяет пошагово выполнять код, просматривать данные объекта, отслеживать конкретные переменные, отслеживать стек вызовов и многое другое. В дополнение к отладке VB.NET C# или кода, отладчик также полезен для отладки приложений ASP.NET AJAX и позволяет выполнять пошаговое выполнение кода JavaScript построчно. Подробные сведения о методах, которые можно использовать для отладки файлов скриптов на стороне клиента, а не об общем процессе отладки приложений с помощью Visual Studio 2008.

Процесс отладки страницы в Visual Studio 2008 может быть запущен различными способами. Сначала можно использовать параметр отладчика сценариев Internet Explorer, упомянутый в предыдущем разделе. Это хорошо работает, когда страница уже загружена в браузере и вы хотите начать ее отладку. Кроме того, можно щелкнуть правой кнопкой мыши страницу ASPX в обозреватель решений и выбрать в меню пункт Задать как начальную страницу. Если вы привыкли к отладке страниц ASP.NET, вы, вероятно, сделали это раньше. После нажатия клавиши F5 страница может быть отлажена. Однако, хотя вы можете задать точку останова в любом месте, где бы вы C# хотели бы вы VB.NET или код, это не всегда так с JavaScript, как вы увидите далее.

*Сравнение внедренных и внешних скриптов*

Отладчик Visual Studio 2008 обрабатывает JavaScript, внедренный на странице, отличной от внешних файлов JavaScript. С помощью внешних файлов скриптов можно открыть файл и установить точку останова в любой выбранной строке. Точки останова можно задать, щелкнув в области серого лотка слева от окна редактора кода. Когда JavaScript внедряется непосредственно в страницу с помощью тега `<script>`, Установка точки останова путем щелчка в области серого лотка не является вариантом. Попытка установить точку останова в строке внедренного скрипта приведет к появлению предупреждения о том, что это не является допустимым расположением точки останова.

Эту ошибку можно обойти, переместив код в внешний файл. js и ссылаясь на него с помощью атрибута src&gt; тега &lt;Script:

[!code-html[Main](understanding-asp-net-ajax-debugging-capabilities/samples/sample1.html)]

Что, если перемещение кода во внешний файл не является вариантом или требует больше работы, чем стоит? Хотя вы не можете задать точку останова с помощью редактора, можно добавить оператор отладчика непосредственно в код, где вы хотите начать отладку. Можно также использовать класс sys. Debug, доступный в библиотеке ASP.NET AJAX, чтобы принудительно запустить отладку. Дополнительные сведения о классе sys. Debug см. Далее в этой статье.

Пример использования ключевого слова `debugger` показан в листинге 1. В этом примере отладчик принудительно разбивается сразу перед вызовом функции Update.

**Листинг 1. Использование ключевого слова Debugger для принудительного прерывания отладчика Visual Studio .NET.**

[!code-javascript[Main](understanding-asp-net-ajax-debugging-capabilities/samples/sample2.js)]

После выполнения инструкции отладчика вам будет предложено отладить страницу с помощью Visual Studio .NET и начать пошаговое выполнение кода. При этом может возникнуть проблема с доступом к файлам скриптов библиотеки ASP.NET AJAX, используемым на странице, поэтому давайте рассмотрим использование Visual Studio. Обозреватель скриптов NET.

## <a name="using-visual-studio-net-windows-to-debug"></a>Использование Windows для отладки в Visual Studio .NET

После запуска сеанса отладки и начала прохода по коду с помощью ключа F11 по умолчанию может появиться диалоговое окно ошибки, показанное в разделе см. рис. 2, если все файлы скриптов, используемые на странице, открыты и недоступны для отладки.

[![диалоговое окно сообщения об ошибке, если исходный код недоступен для отладки.](understanding-asp-net-ajax-debugging-capabilities/_static/image5.png)](understanding-asp-net-ajax-debugging-capabilities/_static/image4.png)

**Рис. 2**. диалоговое окно ошибки, отображаемое, когда исходный код недоступен для отладки.  ([Щелкните, чтобы просмотреть изображение с полным размером](understanding-asp-net-ajax-debugging-capabilities/_static/image6.png))

Это диалоговое окно отображается, поскольку Visual Studio .NET не гарантирует, как получить исходный код некоторых сценариев, на которые ссылается страница. В первую очередь это может оказаться довольно непростой, но есть и простое исправление. После запуска сеанса отладки и попадания в точку останова перейдите в окно Отладка обозревателя скриптов Windows в меню Visual Studio 2008 или используйте сочетание клавиш CTRL + ALT + N.

> [!NOTE]
> Если меню Обозреватель скриптов не отображается в списке, выберите **инструменты** > **настроить** > **команды** в меню Visual Studio .NET. В разделе Категории выберите запись **отладки** и щелкните ее, чтобы отобразить все доступные элементы меню. В списке команды прокрутите вниз до пункта Обозреватель скриптов и перетащите его в меню окна Отладка, упомянутое ранее. Это сделает запись меню обозревателя скриптов доступной при каждом запуске Visual Studio .NET.

Обозреватель скриптов можно использовать для просмотра всех скриптов, используемых на странице, и их открытия в редакторе кода. После открытия обозревателя скриптов дважды щелкните страницу ASPX, которая отлаживается в данный момент, чтобы открыть ее в окне редактора кода. Выполните то же действие для всех других скриптов, показанных в обозревателе скриптов. После открытия всех скриптов в окне кода можно нажать клавишу F11 (и использовать другие горячие клавиши для отладки) для пошагового выполнения кода. На рис. 3 показан пример обозревателя скриптов. В нем указывается текущий отлаживаемый файл (Demo. aspx), а также два пользовательских скрипта и два сценария, динамически добавляемые в страницу с помощью ScriptManager ASP.NET AJAX.

[![Обозреватель скриптов обеспечивает простой доступ к скриптам, используемым на странице.](understanding-asp-net-ajax-debugging-capabilities/_static/image8.png)](understanding-asp-net-ajax-debugging-capabilities/_static/image7.png)

**Рис. 3**. Обозреватель скриптов обеспечивает простой доступ к скриптам, используемым на странице.  ([Щелкните, чтобы просмотреть изображение с полным размером](understanding-asp-net-ajax-debugging-capabilities/_static/image9.png))

Несколько других окон также можно использовать для предоставления полезной информации при пошаговом выполнении кода на странице. Например, можно использовать окно Локальные для просмотра значений различных переменных, используемых на странице, окна интерпретации для вычисления конкретных переменных или условий и просмотра выходных данных. Можно также использовать окно Вывод для просмотра операторов трассировки, написанных с помощью функции sys. Debug. Trace (которая будет рассмотрена далее в этой статье) или функции Debug. writeln в Internet Explorer.

При пошаговом выполнении кода с помощью отладчика можно навести указатель мыши на переменные в коде, чтобы просмотреть назначенное им значение. Однако отладчик сценариев иногда не будет показывать ничего при наведении указателя мыши на указанную переменную JavaScript. Чтобы просмотреть это значение, выделите оператор или переменную, которые вы пытаетесь просмотреть в окне редактора кода, а затем наведите на нее указатель мыши. Несмотря на то, что этот прием не работает во всех ситуациях, вы можете увидеть это значение без необходимости искать в другом окне отладки, например в окне Локальные.

Видеоучебник, демонстрирующий некоторые функции, обсуждаемые здесь, можно просмотреть по адресу [http://www.xmlforasp.net](http://www.xmlforasp.net).

## <a name="debugging-with-web-development-helper"></a>Отладка с помощью вспомогательного приложения веб-разработки

Хотя Visual Studio 2008 (и Visual Web Developer Express 2008) очень хорошо поддерживают средства отладки, существуют дополнительные параметры, которые можно использовать, а значит, это более тонкое. Одним из новейших средств для выпуска является вспомогательная функция веб-разработки. Корпорация Майкрософт Нихила Котари (один из ключевых ASP.NET архитекторов AJAX в корпорации Майкрософт) написала это отличное средство, которое позволяет выполнять различные задачи с помощью простой отладки для просмотра сообщений HTTP-запросов и ответов. Вспомогательный модуль веб-разработки можно скачать по адресу [http://projects.nikhilk.net/Projects/WebDevHelper.aspx](http://projects.nikhilk.net/Projects/WebDevHelper.aspx).

Вспомогательный модуль веб-разработки можно использовать непосредственно в Internet Explorer, что упрощает использование. Для этого выберите Инструменты веб-разработка помощника в меню Internet Explorer. Это позволит открыть средство в нижней части браузера, что удобно, поскольку не нужно оставлять браузер для выполнения нескольких задач, таких как запрос HTTP и ведение журнала ответа. На рис. 4 показано, как выглядит помощник веб-разработки в действии.

[![вспомогательный модуль веб-разработки](understanding-asp-net-ajax-debugging-capabilities/_static/image11.png)](understanding-asp-net-ajax-debugging-capabilities/_static/image10.png)

**Рис. 4**. вспомогательный метод веб-разработки ([щелкните, чтобы просмотреть изображение с полным размером](understanding-asp-net-ajax-debugging-capabilities/_static/image12.png))

Вспомогательный модуль веб-разработки не является средством, которое будет использоваться для пошагового перехода по строке кода, как в Visual Studio 2008. Однако его можно использовать для просмотра выходных данных трассировки, легко оценивать переменные в скрипте или исследовать данные в объекте JSON. Он также очень полезен для просмотра данных, передаваемых в ASP.NET AJAX-страницу и на сервер.

После открытия вспомогательного приложения веб-разработки в Internet Explorer необходимо включить отладку скриптов, выбрав сценарий включить отладку сценариев из меню помощник веб-разработки, как показано выше на рис. 4. Это позволяет средству перехватывать ошибки, происходящие при выполнении страницы. Он также обеспечивает простой доступ к сообщениям трассировки, которые выводятся на странице. Чтобы просмотреть сведения о трассировке или выполнить команды сценария для тестирования различных функций на странице, выберите сценарий Показать консоль сценариев в меню помощник веб-разработки. Это обеспечивает доступ к командному окну и простому окну интерпретации.

*Просмотр сообщений трассировки и данных объектов JSON*

Окно интерпретации можно использовать для выполнения команд сценариев или даже для загрузки или сохранения скриптов, которые используются для тестирования различных функций на странице. В командном окне отображаются сообщения трассировки или отладки, записанные просматриваемой страницей. В листинге 2 показано, как написать сообщение трассировки с помощью функции Debug. writeln в Internet Explorer.

**Листинг 2. Запись сообщения трассировки на стороне клиента с помощью класса Debug.**

[!code-javascript[Main](understanding-asp-net-ajax-debugging-capabilities/samples/sample3.js)]

Если свойство LastName содержит значение Петров, то вспомогательное приложение веб-разработки будет отображать сообщение «Person Name: Петров» в командном окне консоли сценария (при условии, что включена отладка). Вспомогательный метод веб-разработки также добавляет объект Дебугсервице верхнего уровня в страницы, которые можно использовать для записи данных трассировки или просмотра содержимого объектов JSON. В листинге 3 показан пример использования функции трассировки класса Дебугсервице.

**Листинг 3. Использование класса Дебугсервице вспомогательного приложения веб-разработки для записи сообщения трассировки.**

[!code-javascript[Main](understanding-asp-net-ajax-debugging-capabilities/samples/sample4.js)]

Удобная особенность класса Дебугсервице заключается в том, что он будет работать даже в том случае, если отладка не включена в Internet Explorer, что упрощает доступ к данным трассировки при работе вспомогательного приложения веб-разработки. Если средство не используется для отладки страницы, операторы трассировки будут пропущены, так как вызов метода Window. Дебугсервице возвратит значение false.

Класс Дебугсервице также позволяет просматривать данные объекта JSON с помощью окна инспектора помощника веб-разработки. В листинге 4 создается простой объект JSON, содержащий данные Person. После создания объекта выполняется вызов функции проверки класса Дебугсервице, чтобы разрешить визуальную проверку объекта JSON.

**Листинг 4. Использование функции Дебугсервице. исследовать для просмотра данных объекта JSON.**

[!code-javascript[Main](understanding-asp-net-ajax-debugging-capabilities/samples/sample5.js)]

Вызов функции GetObject () на странице или в окне интерпретации приведет к появлению диалогового окна инспектора объектов, как показано на рис. 5. Свойства в объекте можно динамически изменить, выделив их, изменив значение, отображаемое в текстовом поле значение, а затем щелкнув ссылку Обновить. С помощью инспектора объектов можно легко просматривать данные объекта JSON и экспериментировать с применением различных значений к свойствам.

*Ошибки отладки*

Помимо разрешения на отображение данных трассировки и объектов JSON, вспомогательная функция веб-разработки также может помочь в отладке ошибок на странице. Если возникает ошибка, вам будет предложено перейти к следующей строке кода или выполнить отладку сценария (см. рис. 6). В диалоговом окне Ошибка сценария отображается полный стек вызовов, а также номера строк, что позволяет легко находить проблемы в сценарии.

[![с помощью окна инспектора объектов для просмотра объекта JSON.](understanding-asp-net-ajax-debugging-capabilities/_static/image14.png)](understanding-asp-net-ajax-debugging-capabilities/_static/image13.png)

**Рис. 5**. Использование окна инспектора объектов для просмотра объекта JSON.  ([Щелкните, чтобы просмотреть изображение с полным размером](understanding-asp-net-ajax-debugging-capabilities/_static/image15.png))

Выбор параметра отладки позволяет выполнять операторы скриптов непосредственно в окне интерпретации вспомогательного метода веб-разработки для просмотра значений переменных, записи объектов JSON и т. д. Если то же действие, вызвавшее ошибку, будет выполнено снова и Visual Studio 2008 станет доступным на компьютере, вам будет предложено запустить сеанс отладки, чтобы можно было пошагово выполнить код по строке, как описано в предыдущем разделе.

[![диалоговое окно ошибки скрипта в вспомогательном браузере веб-разработки](understanding-asp-net-ajax-debugging-capabilities/_static/image17.png)](understanding-asp-net-ajax-debugging-capabilities/_static/image16.png)

**Рис. 6**. диалоговое окно ошибки скрипта веб-разработки ([щелкните, чтобы просмотреть изображение с полным размером](understanding-asp-net-ajax-debugging-capabilities/_static/image18.png))

*Проверка сообщений о запросах и ответах*

При отладке страниц ASP.NET AJAX часто бывает удобно просматривать сообщения запросов и ответов, отправляемые между страницей и сервером. Просмотр содержимого в сообщениях позволяет определить, передаются ли правильные данные, а также размер сообщений. Модуль поддержки веб-разработки предоставляет отличную функцию средства ведения журнала сообщений HTTP, которая позволяет легко просматривать данные в виде необработанного текста или в более удобном для чтения формате.

Чтобы просмотреть сообщения запросов и ответов AJAX ASP.NET, необходимо включить средство ведения журнала HTTP, выбрав в меню вспомогательного приложения веб-разработки команду HTTP Enable HTTP Logging. После включения все сообщения, отправленные с текущей страницы, можно просмотреть в средстве просмотра журнала HTTP, доступ к которому можно получить, выбрав HTTP отобразить журналы HTTP.

Несмотря на то, что Просмотр необработанного текста, отправленного в каждом сообщении типа "запрос-ответ", безусловно полезен (и вариант в модуле поддержки веб-разработки), часто бывает проще просматривать данные сообщений в более графическом формате. После включения ведения журнала HTTP и регистрации сообщений данные сообщений можно просмотреть, дважды щелкнув сообщение в средстве просмотра журнала HTTP. Это позволяет просматривать все заголовки, связанные с сообщением, а также реальное содержимое сообщения. На рис. 7 показан пример сообщения запроса и ответного сообщения, просматриваемого в окне средства просмотра журнала HTTP.

[![с помощью средства просмотра журнала HTTP для просмотра данных сообщений запросов и ответов.](understanding-asp-net-ajax-debugging-capabilities/_static/image20.png)](understanding-asp-net-ajax-debugging-capabilities/_static/image19.png)

**Рис. 7**. Просмотр данных сообщений запросов и ответов с помощью средства просмотра журнала HTTP.  ([Щелкните, чтобы просмотреть изображение с полным размером](understanding-asp-net-ajax-debugging-capabilities/_static/image21.png))

Средство просмотра журнала HTTP автоматически анализирует объекты JSON и отображает их с помощью представления в виде дерева, что позволяет быстро и легко просматривать данные свойств объекта. При использовании UpdatePanel на странице ASP.NET AJAX средство просмотра разделяет каждую часть сообщения на отдельные части, как показано на рис. 8. Это отличная функция, которая значительно упрощает просмотр и понимание того, что находится в сообщении, по сравнению с просмотром необработанных данных сообщений.

[![сообщение ответа UpdatePanel, просматриваемое с помощью средства просмотра журнала HTTP.](understanding-asp-net-ajax-debugging-capabilities/_static/image23.png)](understanding-asp-net-ajax-debugging-capabilities/_static/image22.png)

**Рис. 8**. сообщение ответа UpdatePanel, просматриваемое с помощью средства просмотра журнала HTTP.  ([Щелкните, чтобы просмотреть изображение с полным размером](understanding-asp-net-ajax-debugging-capabilities/_static/image24.png))

Помимо вспомогательного метода веб-разработки, можно использовать несколько других средств для просмотра сообщений запросов и ответов. Еще один хороший вариант — Fiddler, доступный бесплатно на [http://www.fiddlertool.com](http://www.fiddlertool.com). Хотя Fiddler не будет обсуждаться здесь, он также является хорошим вариантом, когда необходимо тщательно проверить заголовки и данные сообщений.

## <a name="debugging-with-firefox-and-firebug"></a>Отладка с помощью Firefox и Firebug

Хотя Internet Explorer по-прежнему является наиболее широко используемым браузером, другие браузеры, такие как Firefox, стали довольно популярными и используются больше и больше. В результате вы хотите просматривать и отлаживать страницы ASP.NET AJAX в браузере Firefox и Internet Explorer, чтобы обеспечить правильную работу приложений. Хотя браузер Firefox не может напрямую связываться с Visual Studio 2008 для отладки, он имеет расширение Firebug, которое можно использовать для отладки страниц. Firebug можно скачать бесплатно, перейдя по [http://www.getfirebug.com](http://www.getfirebug.com).

Firebug предоставляет полнофункциональную среду отладки, которую можно использовать для пошагового выполнения кода по строке, доступа ко всем сценариям, используемым на странице, просмотра структур DOM, отображения стилей CSS и даже для контроля событий, происходящих на странице. После установки Firebug доступ к нему можно получить, выбрав Инструменты Firebug открыть Firebug в меню Firefox. Как и вспомогательное приложение веб-разработки, Firebug используется непосредственно в браузере, хотя его также можно использовать в качестве автономного приложения.

После запуска Firebug точки останова могут быть установлены в любой строке файла JavaScript независимо от того, внедряется ли скрипт на страницу. Чтобы установить точку останова, сначала загрузите соответствующую страницу, которую вы хотите отладить в браузере Firefox. После загрузки страницы выберите скрипт для отладки из раскрывающегося списка скриптов Firebug. Будут показаны все скрипты, используемые страницей. Точка останова задается щелчком в области серого лотка Firebug в строке, где должна идти точка останова, как в Visual Studio 2008.

После установки точки останова в Firebug можно выполнить действие, необходимое для выполнения сценария, для которого необходимо выполнить отладку, например нажатие кнопки или обновление браузера для активации события OnLoad. Выполнение будет автоматически прервано в строке, содержащей точку останова. На рис. 9 показан пример точки останова, которая была активирована в Firebug.

[![обработки точек останова в Firebug.](understanding-asp-net-ajax-debugging-capabilities/_static/image26.png)](understanding-asp-net-ajax-debugging-capabilities/_static/image25.png)

**Рис. 9**. обработка точек останова в Firebug.  ([Щелкните, чтобы просмотреть изображение с полным размером](understanding-asp-net-ajax-debugging-capabilities/_static/image27.png))

После попадания в точку останова можно выполнить шаг с заходом, шаг с обходом или шаг с выходом из кода с помощью кнопок со стрелками. При пошаговом выполнении кода переменные сценария отображаются в правой части отладчика, что позволяет просматривать значения и детализировать объекты. Firebug также содержит раскрывающийся список стек вызовов для просмотра шагов выполнения сценария, которые привели к отладке текущей строки.

Firebug также включает окно консоли, которое можно использовать для тестирования различных операторов сценария, вычисления переменных и просмотра выходных данных трассировки. Для доступа к нему щелкните вкладку Console (консоль) в верхней части окна Firebug. Страница, для которой выполняется отладка, также может быть "проверена", чтобы просмотреть ее структуру и содержимое DOM, щелкнув вкладку Проверка. При наведении указателя мыши на различные элементы DOM, отображаемые в окне инспектора, будет выделена соответствующая часть страницы, позволяющая легко увидеть, где элемент используется на странице. Значения атрибутов, связанные с данным элементом, можно изменить в динамическом режиме, чтобы поэкспериментировать с применением различных значений ширины, стилей и т. д. к элементу. Это удобная функция, которая избавляет вас от необходимости постоянно переключаться между редактором исходного кода и браузером Firefox, чтобы увидеть, как простые изменения влияют на страницу.

На рис. 10 показан пример использования инспектора DOM для определения местоположения текстового поля с именем Тксткаунтри на странице. Инспектор Firebug также можно использовать для просмотра стилей CSS, используемых на странице, а также событий, которые возникают, например для отслеживания движений мыши, нажатия кнопок и т. д.

[![с помощью инспектора DOM Firebug.](understanding-asp-net-ajax-debugging-capabilities/_static/image29.png)](understanding-asp-net-ajax-debugging-capabilities/_static/image28.png)

**Рис. 10**. Использование инспектора DOM Firebug.  ([Щелкните, чтобы просмотреть изображение с полным размером](understanding-asp-net-ajax-debugging-capabilities/_static/image30.png))

Firebug предоставляет легкий способ быстрой отладки страницы непосредственно в браузере Firefox, а также отличный инструмент для проверки различных элементов на странице.

## <a name="debugging-support-in-aspnet-ajax"></a>Поддержка отладки в ASP.NET AJAX

Библиотека ASP.NET AJAX содержит множество различных классов, которые можно использовать для упрощения процесса добавления возможностей AJAX в веб-страницу. Эти классы можно использовать для нахождение элементов на странице и управления ими, добавления новых элементов управления, вызова веб-служб и даже обработки событий. Библиотека ASP.NET AJAX также содержит классы, которые можно использовать для улучшения процесса отладки страниц. В этом разделе будет представлен класс sys. Debug и показано, как его можно использовать в приложениях.

*Использование класса Sys. Debug*

Класс sys. Debug (класс JavaScript, расположенный в пространстве имен sys) можно использовать для выполнения нескольких различных функций, включая запись выходных данных трассировки, выполнение утверждений кода и принудительное завершение кода, чтобы его можно было отлаживать. Он широко используется в файлах отладки библиотеки ASP.NET AJAX (устанавливается в папке C:\Program Files\Microsoft ASP. НЕТ\АСП.нет 2,0 AJAX Extensions\v1.0.61025\MicrosoftAjaxLibrary\System.Web.Extensions\1.0.61025.0 по умолчанию) для выполнения условных тестов ( называемые утверждениями), обеспечивающие правильную передачу параметров для функций, эти объекты содержат ожидаемые данные и для написания операторов трассировки.

Класс sys. Debug предоставляет несколько различных функций, которые можно использовать для работы с трассировкой, утверждениями или ошибками кода, как показано в таблице 1.

**Таблица 1. Функции класса Sys. Debug.**

| **Имя функции** | **Описание** |
| --- | --- |
| Assert (условие, сообщение, Дисплайкаллер) | Утверждает, что параметр Condition имеет значение true. Если проверяемое условие имеет значение false, для вывода значения параметра сообщения будет использоваться окно сообщения. Если параметр Дисплайкаллер имеет значение true, метод также отображает сведения о вызывающем объекте. |
| Клеартраце () | Стирает выходные данные инструкций из операций трассировки. |
| сбой (сообщение) | Заставляет программу остановить выполнение и переключиться в отладчик. Чтобы указать причину сбоя, можно использовать параметр сообщения. |
| Трассировка (сообщение) | Записывает параметр сообщения в выходные данные трассировки. |
| Трацедумп (объект, имя) | Выводит данные объекта в удобном для чтения формате. Параметр Name можно использовать для предоставления метки для дампа трассировки. Все вложенные объекты в создаваемом объекте будут записаны по умолчанию. |

Трассировка на стороне клиента может использоваться во многом так же, как и функции трассировки, доступные в ASP.NET. Это позволяет легко видеть различные сообщения, не прерывая поток приложения. В листинге 5 показан пример использования функции sys. Debug. Trace для записи в журнал трассировки. Эта функция просто принимает сообщение, которое должно быть записано как параметр.

**Листинг 5. Использование функции sys. Debug. Trace.**

[!code-javascript[Main](understanding-asp-net-ajax-debugging-capabilities/samples/sample6.js)]

Если выполнить код, показанный в листинге 5, на странице не будут отображаться выходные данные трассировки. Единственный способ увидеть это — использовать окно консоли, доступное в Visual Studio .NET, вспомогательное приложение веб-разработки или Firebug. Если вы хотите просмотреть выходные данные трассировки на странице, необходимо добавить тег TextArea и присвоить ему идентификатор Трацеконсоле, как показано далее:

[!code-html[Main](understanding-asp-net-ajax-debugging-capabilities/samples/sample7.html)]

Все инструкции sys. Debug. Trace на странице будут записаны в Трацеконсоле TextArea.

В случаях, когда необходимо просмотреть данные, содержащиеся в объекте JSON, можно использовать функцию Трацедумп класса Sys. Debug. Эта функция принимает два параметра, включая объект, который должен быть выгружен в консоль трассировки, и имя, которое можно использовать для обнаружения объекта в выходных данных трассировки. В листинге 6 показан пример использования функции Трацедумп.

**Листинг 6. С помощью функции sys. Debug. Трацедумп.**

[!code-javascript[Main](understanding-asp-net-ajax-debugging-capabilities/samples/sample8.js)]

На рис. 11 показаны выходные данные вызова функции sys. Debug. Трацедумп. Обратите внимание, что помимо записи данных объекта Person, он также записывает данные подобъекта адреса.

Кроме трассировки, класс sys. Debug также может использоваться для выполнения утверждений кода. Утверждения используются для проверки соблюдения конкретных условий во время выполнения приложения. Отладочная версия скриптов библиотеки ASP.NET AJAX содержит несколько операторов Assert для тестирования различных условий.

В листинге 7 показан пример использования функции sys. Debug. Assert для проверки условия. Перед обновлением объекта Person код проверяет, имеет ли объект адреса значение null.

[![выходные данные функции sys. Debug. Трацедумп.](understanding-asp-net-ajax-debugging-capabilities/_static/image32.png)](understanding-asp-net-ajax-debugging-capabilities/_static/image31.png)

**Рис. 11**. выходные данные функции sys. Debug. трацедумп.  ([Щелкните, чтобы просмотреть изображение с полным размером](understanding-asp-net-ajax-debugging-capabilities/_static/image33.png))

**Листинг 7. Использование функции Debug. Assert.**

[!code-javascript[Main](understanding-asp-net-ajax-debugging-capabilities/samples/sample9.js)]

Передаются три параметра, включая условие для вычисления, сообщение, отображаемое, если проверочное утверждение возвращает значение false и следует ли отображать сведения о вызывающем объекте. В случаях, когда утверждение не выполняется, сообщение будет отображаться, а также сведения о вызывающем объекте, если третий параметр имел значение true. На рис. 12 показан пример диалогового окна сбоя, которое появляется в случае сбоя утверждения, показанного в листинге 7.

Завершающей функцией для покрытия является sys. Debug. Fail. Если требуется принудительно завершить выполнение кода в определенной строке скрипта, можно добавить вызов sys. Debug. Fail вместо инструкции отладчика, обычно используемой в приложениях JavaScript. Функция sys. Debug. Fail принимает один строковый параметр, представляющий причину сбоя, как показано далее:

[!code-css[Main](understanding-asp-net-ajax-debugging-capabilities/samples/sample10.css)]

[![сообщение об ошибке sys. Debug. Assert.](understanding-asp-net-ajax-debugging-capabilities/_static/image35.png)](understanding-asp-net-ajax-debugging-capabilities/_static/image34.png)

**Рис. 12**. сообщение об ошибке sys. Debug. Assert.  ([Щелкните, чтобы просмотреть изображение с полным размером](understanding-asp-net-ajax-debugging-capabilities/_static/image36.png))

Если во время выполнения скрипта обнаруживается инструкция sys. Debug. Fail, значение параметра message будет отображаться в консоли приложения отладки, например Visual Studio 2008, и будет предложено выполнить отладку приложения. Один из случаев, когда это может быть весьма полезен, заключается в том, что нельзя установить точку останова в Visual Studio 2008 во встроенном скрипте, но необходимо, чтобы код был останавливаться в конкретной строке, чтобы можно было проверить значение переменных.

*Основные сведения о свойстве Скриптмоде элемента управления ScriptManager*

Библиотека ASP.NET AJAX содержит версии скриптов отладки и выпуска, которые устанавливаются в каталог C:\Program Files\Microsoft ASP. НЕТ\АСП.нет 2,0 AJAX Extensions\v1.0.61025\MicrosoftAjaxLibrary\System.Web.Extensions\1.0.61025.0 по умолчанию. Скрипты отладки отлично форматируются, просты для чтения и имеют несколько вызовов sys. Debug. Assert, в то время как в сценариях выпуска удаляются пробелы, а класс sys. debug можно сократить, чтобы уменьшить их общий размер.

Элемент управления ScriptManager, добавленный в ASP.NET AJAX Pages, считывает атрибут Debug элемента compilation в файле Web. config, чтобы определить, какие версии скриптов библиотеки нужно загрузить. Однако можно управлять загрузкой скриптов отладки или выпуска (скрипты библиотеки или собственные пользовательские скрипты), изменяя свойство Скриптмоде. Скриптмоде принимает перечисление Скриптмоде, члены которого включают Auto, отладка, выпуск и наследование.

Скриптмоде по умолчанию имеет значение Auto, что означает, что ScriptManager будет проверять атрибут Debug в файле Web. config. Если debug имеет значение false, ScriptManager загрузит окончательную версию скриптов библиотеки ASP.NET AJAX. Если debug имеет значение true, будет загружена отладочная версия скриптов. Изменение свойства Скриптмоде на Release или Debug приведет к принудительной загрузке диспетчером ScriptManager соответствующих скриптов независимо от значения атрибута Debug в файле Web. config. В листинге 8 показан пример использования элемента управления ScriptManager для загрузки скриптов отладки из библиотеки ASP.NET AJAX.

**Листинг 8. Загрузка скриптов отладки с помощью ScriptManager**.

[!code-aspx[Main](understanding-asp-net-ajax-debugging-capabilities/samples/sample11.aspx)]

Можно также загрузить различные версии (Отладка или выпуск) собственных пользовательских скриптов с помощью свойства сценариев ScriptManager вместе с компонентом ScriptReference, как показано в листинге 9.

**Листинг 9. Загрузка пользовательских скриптов с помощью ScriptManager.**

[!code-aspx[Main](understanding-asp-net-ajax-debugging-capabilities/samples/sample12.aspx)]

> [!NOTE]
> Если вы загружаете пользовательские скрипты с помощью компонента ScriptReference, необходимо уведомить ScriptManager о завершении загрузки сценария, добавив следующий код в нижнюю часть скрипта:

[!code-csharp[Main](understanding-asp-net-ajax-debugging-capabilities/samples/sample13.cs)]

Код, приведенный в листинге 9, указывает диспетчеру ScriptManager найти отладочную версию сценария Person, чтобы он автоматически выполнял поиск пользователя. Debug. js вместо Person. js. Если файл Person. Debug. js не найден, возникнет ошибка.

В случаях, когда требуется загрузить отладочную или окончательную версию пользовательского скрипта на основе значения свойства Скриптмоде, заданного для элемента управления ScriptManager, можно задать для свойства Скриптмоде элемента управления ScriptReference значение Inherit. Это приведет к тому, что правильная версия пользовательского скрипта будет загружена на основе свойства Скриптмоде ScriptManager, как показано в листинге 10. Так как свойство Скриптмоде элемента управления ScriptManager имеет значение Debug, скрипт Person. Debug. js будет загружен и использован на странице.

**Список 10. Наследование Скриптмоде от ScriptManager для пользовательских скриптов.**

[!code-aspx[Main](understanding-asp-net-ajax-debugging-capabilities/samples/sample14.aspx)]

Используя свойство Скриптмоде, можно легко отлаживать приложения и упростить общий процесс. Сценарии выпуска библиотеки ASP.NET AJAX, скорее всего, не сложны для пошагового выполнения и чтения, так как форматирование кода было удалено, а отладочные скрипты отформатированы специально для целей отладки.

## <a name="conclusion"></a>Заключение

Технология Microsoft ASP.NET AJAX обеспечивает надежную основу для создания приложений с поддержкой AJAX, которые могут улучшить общий опыт конечного пользователя. Однако, как и в случае любой технологии программирования, ошибки и другие проблемы с приложениями, безусловно, будут возникать. Знание различных доступных вариантов отладки может сэкономить много времени и привести к более стабильному продукту.

В этой статье мы предоставили несколько различных методов для отладки страниц ASP.NET AJAX, включая Internet Explorer с Visual Studio 2008, вспомогательным приложением веб-разработки и Firebug. Эти средства могут упростить общий процесс отладки, так как можно получить доступ к переменным данным, пошаговое выполнение кода по строкам и Просмотр инструкций трассировки. Помимо различных обсуждаемых средств отладки, вы также узнали, как класс sys. Debug библиотеки ASP.NET AJAX можно использовать в приложении и как класс ScriptManager можно использовать для загрузки отладочных и окончательных версий скриптов.

## <a name="bio"></a>Биография

"Вахлин" (самый ценный специалист корпорации Майкрософт для ASP.NET и веб-служб XML) — это консультант по разработке и архитектуре разработки .NET в техническом обучении интерфейса ([www.interfacett.com)](http://www.interfacett.com). Г., посвященный веб-узлу разработчиков XML для ASP.NET ([www.XMLforASP.NET](http://www.XMLforASP.NET)), находится в бюро докладчика INETA и говорит на нескольких конференциях. Г. профессионально разработанная профессиональная Windows ДНК (Wrox), ASP.NET: советы, учебники и код (Sams), решения для предварительной оценки ASP.NET 1,1, профессиональная ASP.NET 2,0 AJAX (Wrox), ASP.NET 2,0 MVP и авторский XML для ASP.NET разработчиков (Sams). Когда он не пишет код, статьи или книги, самое время пишет и записывает музыку и воспроизводила гольф и баскетбол с его женойами и детьми.

Скотт Cate работал с веб-технологиями Майкрософт с 1997 и является президентом myKB.com ([www.myKB.com](http://www.myKB.com)), где он специализируется на написании приложений ASP.NET на базе знаний, посвященных программным решениям. Скотт может связаться по электронной почте по адресу [scott.cate@myKB.com](mailto:scott.cate@myKB.com) или в блоге по адресу [ScottCate.com](http://ScottCate.com)

> [!div class="step-by-step"]
> [Назад](understanding-asp-net-ajax-web-services.md)
