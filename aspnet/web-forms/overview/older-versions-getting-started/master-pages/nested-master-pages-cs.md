---
uid: web-forms/overview/older-versions-getting-started/master-pages/nested-master-pages-cs
title: Вложенные главные страницыC#() | Документация Майкрософт
author: rick-anderson
description: Показывает, как вложить одну главную страницу в другую.
ms.author: riande
ms.date: 07/28/2008
ms.assetid: 32b7fb6e-d74b-4048-91f8-70631b2523ee
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/nested-master-pages-cs
msc.type: authoredcontent
ms.openlocfilehash: 67093266567a97cd22b353115616484fd9ef155e
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78463626"
---
# <a name="nested-master-pages-c"></a><span data-ttu-id="bd44d-103">Вложенные эталонные страницы (C#)</span><span class="sxs-lookup"><span data-stu-id="bd44d-103">Nested Master Pages (C#)</span></span>

<span data-ttu-id="bd44d-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="bd44d-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="bd44d-105">[Скачать код](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_CS.zip) или [скачать PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_CS.pdf)</span><span class="sxs-lookup"><span data-stu-id="bd44d-105">[Download Code](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_CS.zip) or [Download PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_10_CS.pdf)</span></span>

> <span data-ttu-id="bd44d-106">Показывает, как вложить одну главную страницу в другую.</span><span class="sxs-lookup"><span data-stu-id="bd44d-106">Shows how to nest one master page within another.</span></span>

## <a name="introduction"></a><span data-ttu-id="bd44d-107">Введение</span><span class="sxs-lookup"><span data-stu-id="bd44d-107">Introduction</span></span>

<span data-ttu-id="bd44d-108">В течение прошлых девяти учебников мы рассмотрели, как реализовать макет на уровне сайта с помощью главных страниц.</span><span class="sxs-lookup"><span data-stu-id="bd44d-108">Over the course of the past nine tutorials we have seen how to implement a site-wide layout with master pages.</span></span> <span data-ttu-id="bd44d-109">В двух словах, Главная страница позволяет разработчику страницы определить общую разметку на главной странице вместе с конкретными регионами, которые можно настроить на странице содержимого по содержимому.</span><span class="sxs-lookup"><span data-stu-id="bd44d-109">In a nutshell, master pages allow us, the page developer, to define common markup in the master page along with specific regions that can be customized on a content page-by-content page basis.</span></span> <span data-ttu-id="bd44d-110">Элементы управления ContentPlaceHolder на главной странице указывают на настраиваемые регионы. настроенная разметка для элементов управления ContentPlaceHolder определяется на странице содержимого с помощью элементов управления содержимым.</span><span class="sxs-lookup"><span data-stu-id="bd44d-110">The ContentPlaceHolder controls in a master page indicate the customizable regions; the customized markup for the ContentPlaceHolder controls are defined in the content page via Content controls.</span></span>

<span data-ttu-id="bd44d-111">Методы главной страницы, которые мы рассматривали до сих пор, прекрасно подходят, если используется один макет для всего сайта.</span><span class="sxs-lookup"><span data-stu-id="bd44d-111">The master page techniques we've explored thus far are great if you have a single layout used across the entire site.</span></span> <span data-ttu-id="bd44d-112">Однако многие крупные веб-сайты имеют макет сайта, настроенный в различных разделах.</span><span class="sxs-lookup"><span data-stu-id="bd44d-112">However, many large websites have a site layout that is customized across various sections.</span></span> <span data-ttu-id="bd44d-113">Например, рассмотрим приложение для здравоохранения, используемое сотрудниками больницы для управления информацией о пациентах, действиями и выставлением счетов.</span><span class="sxs-lookup"><span data-stu-id="bd44d-113">For example, consider a health care application used by hospital staff to manage patient information, activities, and billing.</span></span> <span data-ttu-id="bd44d-114">В этом приложении может быть три типа веб-страниц:</span><span class="sxs-lookup"><span data-stu-id="bd44d-114">There may be three types of web pages in this application:</span></span>

- <span data-ttu-id="bd44d-115">Страницы, относящиеся к сотрудникам, на которых сотрудники могут обновлять доступность, просматривать расписания или запрашивать время отпуска.</span><span class="sxs-lookup"><span data-stu-id="bd44d-115">Staff member-specific pages where staff members can update availability, view schedules, or request vacation time.</span></span>
- <span data-ttu-id="bd44d-116">Страницы, связанные с пациентами, в которых сотрудники просматривают или изменяют сведения о конкретном пациенте.</span><span class="sxs-lookup"><span data-stu-id="bd44d-116">Patient-specific pages where staff members view or edit information for a specific patient.</span></span>
- <span data-ttu-id="bd44d-117">Страницы, относящиеся к выставлению счетов, где бухгалтеры просматривают текущие состояния утверждений и финансовые отчеты.</span><span class="sxs-lookup"><span data-stu-id="bd44d-117">Billing-specific pages where accountants review current claim statuses and financial reports.</span></span>

<span data-ttu-id="bd44d-118">На каждой странице может использоваться общий макет, например меню в верхней части и ряд часто используемых ссылок внизу.</span><span class="sxs-lookup"><span data-stu-id="bd44d-118">Every page might share a common layout, such as a menu across the top and a series of frequently used links along the bottom.</span></span> <span data-ttu-id="bd44d-119">Но сотрудникам, пациентам и конкретным вопросам выставления счетов может потребоваться настроить этот общий макет.</span><span class="sxs-lookup"><span data-stu-id="bd44d-119">But the staff-, patient-, and billing-specific pages may need to customize this generic layout.</span></span> <span data-ttu-id="bd44d-120">Например, все страницы, относящиеся к персоналу, должны включать календарь и список задач, в которых отображаются сведения о доступности и ежедневном планировании текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="bd44d-120">For example, perhaps all staff-specific pages should include a calendar and task list showing the currently logged on user's availability and daily schedule.</span></span> <span data-ttu-id="bd44d-121">Возможно, все страницы, относящиеся к пациентам, должны отображать имя, адрес и страховую информацию для пациента, сведения о котором редактируются.</span><span class="sxs-lookup"><span data-stu-id="bd44d-121">Perhaps all patient-specific pages need to show the name, address, and insurance information for the patient whose information is being edited.</span></span>

<span data-ttu-id="bd44d-122">Такие настраиваемые макеты можно создавать с помощью *вложенных главных страниц*.</span><span class="sxs-lookup"><span data-stu-id="bd44d-122">It's possible to create such customized layouts by using *nested master pages*.</span></span> <span data-ttu-id="bd44d-123">Для реализации описанного выше сценария мы начнем с создания главной страницы, определяющей макет всего сайта, содержимое меню и нижнего колонтитула с элементов управления ContentPlaceHolder, определяющим настраиваемые регионы.</span><span class="sxs-lookup"><span data-stu-id="bd44d-123">To implement the above scenario, we would start by creating a master page that defined the site-wide layout, the menu and footer content, with ContentPlaceHolders defining the customizable regions.</span></span> <span data-ttu-id="bd44d-124">Затем мы создадим три вложенных главных страницы — по одной для каждого типа веб-страницы.</span><span class="sxs-lookup"><span data-stu-id="bd44d-124">We would then create three nested master pages, one for each type of web page.</span></span> <span data-ttu-id="bd44d-125">Каждая вложенная эталонная страница определяет содержимое по типу страниц содержимого, использующих главную страницу.</span><span class="sxs-lookup"><span data-stu-id="bd44d-125">Each nested master page would define the content among the type of content pages that use the master page.</span></span> <span data-ttu-id="bd44d-126">Другими словами, вложенная эталонная страница для страниц содержимого, относящихся к пациентам, должна включать разметку и программную логику для отображения сведений об изменяемом пациенте.</span><span class="sxs-lookup"><span data-stu-id="bd44d-126">In other words, the nested master page for patient-specific content pages would include markup and programmatic logic for displaying information about the patient being edited.</span></span> <span data-ttu-id="bd44d-127">При создании страницы, относящейся к пациенту, ее следует привязать к этой вложенной главной странице.</span><span class="sxs-lookup"><span data-stu-id="bd44d-127">When creating a new patient-specific page we would bind it to this nested master page.</span></span>

<span data-ttu-id="bd44d-128">Этот учебник начинается с выделения преимуществ вложенных главных страниц.</span><span class="sxs-lookup"><span data-stu-id="bd44d-128">This tutorial starts by highlighting the benefits of nested master pages.</span></span> <span data-ttu-id="bd44d-129">Затем показано, как создавать и использовать вложенные главные страницы.</span><span class="sxs-lookup"><span data-stu-id="bd44d-129">It then shows how to create and use nested master pages.</span></span>

> [!NOTE]
> <span data-ttu-id="bd44d-130">Вложенные главные страницы могли быть доступны после .NET Framework версии 2,0.</span><span class="sxs-lookup"><span data-stu-id="bd44d-130">Nested master pages have been possible since version 2.0 of the .NET Framework.</span></span> <span data-ttu-id="bd44d-131">Однако Visual Studio 2005 не включала поддержку времени разработки для вложенных главных страниц.</span><span class="sxs-lookup"><span data-stu-id="bd44d-131">However, Visual Studio 2005 did not include design-time support for nested master pages.</span></span> <span data-ttu-id="bd44d-132">Хорошая новость заключается в том, что Visual Studio 2008 предлагает широкие возможности разработки вложенных главных страниц.</span><span class="sxs-lookup"><span data-stu-id="bd44d-132">The good news is that Visual Studio 2008 offers a rich design-time experience for nested master pages.</span></span> <span data-ttu-id="bd44d-133">Если вы заинтересованы в использовании вложенных главных страниц, но все еще используете Visual Studio 2005, ознакомьтесь с записью блога [Скотта Гатри (](https://weblogs.asp.net/scottgu/), [советами по вложенным главным страницам в VS 2005 во время разработки](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx).</span><span class="sxs-lookup"><span data-stu-id="bd44d-133">If you are interested in using nested master pages but are still using Visual Studio 2005, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog entry, [Tips for Nested Master Pages in VS 2005 Design-Time](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx).</span></span>

## <a name="the-benefits-of-nested-master-pages"></a><span data-ttu-id="bd44d-134">Преимущества вложенных главных страниц</span><span class="sxs-lookup"><span data-stu-id="bd44d-134">The Benefits of Nested Master Pages</span></span>

<span data-ttu-id="bd44d-135">Многие веб-сайты имеют раздельную структуру сайта, а также более настраиваемые разработки, характерные для определенных типов страниц.</span><span class="sxs-lookup"><span data-stu-id="bd44d-135">Many websites have an overarching site design as well as more customized designs specific to certain types of pages.</span></span> <span data-ttu-id="bd44d-136">Например, в нашем демонстрационном веб-приложении мы создали раздел "элементарное Администрирование" (страницы в папке `~/Admin`).</span><span class="sxs-lookup"><span data-stu-id="bd44d-136">For instance, in our demo web application we have created a rudimentary Administration section (the pages in the `~/Admin` folder).</span></span> <span data-ttu-id="bd44d-137">В настоящее время веб-страницы в папке `~/Admin` используют ту же главную страницу, что и страницы, не находящиеся в разделе Администрирование (а именно, `Site.master` или `Alternate.master`в зависимости от выбора пользователя).</span><span class="sxs-lookup"><span data-stu-id="bd44d-137">Currently the web pages in the `~/Admin` folder use the same master page as those pages not in the administration section (namely, `Site.master` or `Alternate.master`, depending on the user's selection).</span></span>

> [!NOTE]
> <span data-ttu-id="bd44d-138">Сейчас представьте, что наш сайт содержит только одну главную страницу, `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-138">For now, pretend that our site has just one master page, `Site.master`.</span></span> <span data-ttu-id="bd44d-139">Далее в этом руководстве мы будем использовать вложенные главные страницы с двумя (или более) главными страницами, начинающимися с «Использование вложенной главной страницы для администрирования».</span><span class="sxs-lookup"><span data-stu-id="bd44d-139">We'll address using nested master pages with two (or more) master pages starting with "Using a Nested Master Page for the Administration Section" later in this tutorial.</span></span>

<span data-ttu-id="bd44d-140">Представьте, что нам было предложено настроить макет страниц администрирования для включения дополнительных сведений или ссылок, которые в других страницах сайта не будут представлены другим способом.</span><span class="sxs-lookup"><span data-stu-id="bd44d-140">Imagine that we were asked to customize the layout of the Administration pages to include additional information or links that would not otherwise be present in other pages in the site.</span></span> <span data-ttu-id="bd44d-141">Существует четыре метода реализации этого требования:</span><span class="sxs-lookup"><span data-stu-id="bd44d-141">There are four techniques to implement this requirement:</span></span>

1. <span data-ttu-id="bd44d-142">Вручную добавьте сведения, относящиеся к администрированию, и ссылки на каждую страницу содержимого в папке `~/Admin`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-142">Manually add the Administration-specific information and links to every content page in the `~/Admin` folder.</span></span>
2. <span data-ttu-id="bd44d-143">Обновите главную страницу `Site.master`, включив в нее сведения и ссылки, связанные с разделом администрирования, а затем добавьте код на главную страницу, чтобы показать или скрыть эти разделы в зависимости от того, посещается ли одна из страниц администрирования.</span><span class="sxs-lookup"><span data-stu-id="bd44d-143">Update the `Site.master` master page to include the Administration section-specific information and links, and then add code to the master page to show or hide these sections based on whether one of the Administration pages is being visited.</span></span>
3. <span data-ttu-id="bd44d-144">Создайте новую главную страницу специально для раздела Администрирование, скопируйте разметку из `Site.master`, добавьте сведения о разделе администрирования и ссылки, а затем обновите страницы содержимого в папке `~/Admin`, чтобы использовать эту новую главную страницу.</span><span class="sxs-lookup"><span data-stu-id="bd44d-144">Create a new master page specifically for the Administration section, copy over the markup from `Site.master`, add the Administration section-specific information and links, and then update the content pages in the `~/Admin` folder to use this new master page.</span></span>
4. <span data-ttu-id="bd44d-145">Создайте вложенную главную страницу, которая привязывается к `Site.master` и страницы содержимого в папке `~/Admin` используйте эту новую вложенную главную страницу.</span><span class="sxs-lookup"><span data-stu-id="bd44d-145">Create a nested master page that binds to `Site.master` and have the content pages in the `~/Admin` folder use this new nested master page.</span></span> <span data-ttu-id="bd44d-146">Эта вложенная эталонная страница будет включать только дополнительные сведения и ссылки, относящиеся к страницам администрирования, и не придется повторять разметку, уже определенную в `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-146">This nested master page would include just the additional information and links specific to the Administration pages and would not need to repeat the markup already defined in `Site.master`.</span></span>

<span data-ttu-id="bd44d-147">Первым параметром является наименьший терпима.</span><span class="sxs-lookup"><span data-stu-id="bd44d-147">The first option is the least palatable.</span></span> <span data-ttu-id="bd44d-148">Вся точка использования главных страниц заключается в том, чтобы отказаться от необходимости вручную копировать и вставлять общую разметку на новые страницы ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="bd44d-148">The whole point of using master pages is to move away from having to manually copy and paste common markup to new ASP.NET pages.</span></span> <span data-ttu-id="bd44d-149">Второй вариант является приемлемым, но делает приложение менее обслуживаемым, так как в нем настраиваются основные страницы с разметкой, которая может отображаться только в момент времени и требует от разработчиков редактирования главной страницы для обхода этой разметки и необходимости помнить, когда, в точности, определенная разметка отображается и скрыта.</span><span class="sxs-lookup"><span data-stu-id="bd44d-149">The second option is acceptable, but makes the application less maintainable as it bulks up the master pages with markup that is only occasionally displayed and requires developers editing the master page to work around this markup and to have to remember when, exactly, certain markup is displayed versus when it is hidden.</span></span> <span data-ttu-id="bd44d-150">Этот подход будет менее тенабле в качестве настроек из большего числа веб-страниц, необходимых для размещения этой отдельной главной страницы.</span><span class="sxs-lookup"><span data-stu-id="bd44d-150">This approach would be less tenable as customizations from more and more types of web pages needed to be accommodated by this single master page.</span></span>

<span data-ttu-id="bd44d-151">Третий вариант устраняет проблемы ненужных и сложных задач, выводит второй вариант.</span><span class="sxs-lookup"><span data-stu-id="bd44d-151">The third option removes the clutter and complexity issues the surfaced with the second option.</span></span> <span data-ttu-id="bd44d-152">Однако при выборе трех основных недостатков необходимо скопировать и вставить общий макет из `Site.master` на новую главную страницу администрирования.</span><span class="sxs-lookup"><span data-stu-id="bd44d-152">However, option three's main drawback is that it requires us to copy and paste the common layout from `Site.master` to the new Administration section-specific master page.</span></span> <span data-ttu-id="bd44d-153">Если позже мы решили изменить макет в масштабе всего сайта, нужно не забыть изменить его в двух местах.</span><span class="sxs-lookup"><span data-stu-id="bd44d-153">If we later decide to change the site-wide layout we have to remember to change it in two places.</span></span>

<span data-ttu-id="bd44d-154">Четвертый вариант, вложенные главные страницы, дают нам лучшее из второго и третьего вариантов.</span><span class="sxs-lookup"><span data-stu-id="bd44d-154">The fourth option, nested master pages, give us the best of the second and third options.</span></span> <span data-ttu-id="bd44d-155">Сведения о макете для всего сайта хранятся в одном файле — главной странице верхнего уровня, в то время как содержимое, относящееся к конкретным регионам, разделяется на разные файлы.</span><span class="sxs-lookup"><span data-stu-id="bd44d-155">The site-wide layout information is maintained in one file - the top-level master page - while the content specific to particular regions is separated out into different files.</span></span>

<span data-ttu-id="bd44d-156">В этом учебнике начинается создание и использование простой вложенной главной страницы.</span><span class="sxs-lookup"><span data-stu-id="bd44d-156">This tutorial starts with a look at creating and using a simple nested master page.</span></span> <span data-ttu-id="bd44d-157">Мы создадим новую главную страницу верхнего уровня, две вложенные главные страницы и две страницы содержимого.</span><span class="sxs-lookup"><span data-stu-id="bd44d-157">We create a brand new top-level master page, two nested master pages, and two content pages.</span></span> <span data-ttu-id="bd44d-158">Начиная с «Использование вложенной главной страницы для администрирования», мы рассмотрим обновление существующей архитектуры главной страницы, чтобы включить использование вложенных главных страниц.</span><span class="sxs-lookup"><span data-stu-id="bd44d-158">Starting with "Using a Nested Master Page for the Administration Section," we look at updating our existing master page architecture to include the use of nested master pages.</span></span> <span data-ttu-id="bd44d-159">В частности, мы создаем вложенную главную страницу и используем ее для включения дополнительного пользовательского содержимого для страниц содержимого в папке `~/Admin`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-159">Specifically, we create a nested master page and use it to include additional custom content for the content pages in the `~/Admin` folder.</span></span>

## <a name="step-1-creating-a-simple-top-level-master-page"></a><span data-ttu-id="bd44d-160">Шаг 1. Создание простой главной страницы верхнего уровня</span><span class="sxs-lookup"><span data-stu-id="bd44d-160">Step 1: Creating a Simple Top-Level Master Page</span></span>

<span data-ttu-id="bd44d-161">Создание вложенной главной страницы на основе одной из существующих главных страниц и последующее обновление существующей страницы содержимого для использования этой новой вложенной главной странице, а не главной страницы верхнего уровня, усложняется, так как существующие страницы содержимого уже предполагают определенные Элементы управления ContentPlaceHolder, определенные на главной странице верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="bd44d-161">Creating a nested master based on one of the existing master pages and then updating an existing content page to use this new nested master page instead of the top-level master page entails some complexity because the existing content pages already expect certain ContentPlaceHolder controls defined in the top-level master page.</span></span> <span data-ttu-id="bd44d-162">Поэтому вложенная эталонная страница также должна содержать те же элементы управления ContentPlaceHolder с теми же именами.</span><span class="sxs-lookup"><span data-stu-id="bd44d-162">Therefore, the nested master page must also include the same ContentPlaceHolder controls with the same names.</span></span> <span data-ttu-id="bd44d-163">Кроме того, в нашем конкретном демонстрационном приложении есть две главные страницы (`Site.master` и `Alternate.master`), которые динамически назначаются странице содержимого на основе предпочтений пользователя, которые дополнительно добавляются к этой сложности.</span><span class="sxs-lookup"><span data-stu-id="bd44d-163">Furthermore, our particular demo application has two master pages (`Site.master` and `Alternate.master`) that are dynamically assigned to a content page based on a user's preferences, which further adds to this complexity.</span></span> <span data-ttu-id="bd44d-164">Мы рассмотрим обновление существующего приложения для использования вложенных главных страниц далее в этом руководстве, но давайте сначала рассмотрим простой пример вложенных главных страниц.</span><span class="sxs-lookup"><span data-stu-id="bd44d-164">We will look at updating the existing application to use nested master pages later in this tutorial, but let's first focus on a simple nested master pages example.</span></span>

<span data-ttu-id="bd44d-165">Создайте новую папку с именем `NestedMasterPages`, а затем добавьте в нее новый файл главной страницы с именем `Simple.master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-165">Create a new folder named `NestedMasterPages` and then add a new master page file to that folder named `Simple.master`.</span></span> <span data-ttu-id="bd44d-166">(На рисунке 1 показан снимок экрана обозреватель решений после добавления этой папки и файла.) Перетащите `AlternateStyles.css` файл таблицы стилей из обозреватель решений в конструктор.</span><span class="sxs-lookup"><span data-stu-id="bd44d-166">(See Figure 1 for a screen shot of the Solution Explorer after this folder and file have been added.) Drag the `AlternateStyles.css` style sheet file from the Solution Explorer onto the Designer.</span></span> <span data-ttu-id="bd44d-167">В результате элемент `<link>` добавляется в файл таблицы стилей в элементе `<head>`, после чего разметка элемента `<head>` главной страницы должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="bd44d-167">This adds a `<link>` element to the style sheet file in the `<head>` element, after which the master page's `<head>` element's markup should look like:</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample1.aspx)]

<span data-ttu-id="bd44d-168">Затем добавьте следующую разметку в веб-форму `Simple.master`:</span><span class="sxs-lookup"><span data-stu-id="bd44d-168">Next, add the following markup within the Web Form of `Simple.master`:</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample2.aspx)]

<span data-ttu-id="bd44d-169">Эта разметка отображает ссылку "вложенные главные страницы (простые)" в верхней части страницы в виде большого белого шрифта на фоне ВМФ.</span><span class="sxs-lookup"><span data-stu-id="bd44d-169">This markup displays a link titled "Nested Master Pages (Simple)" at the top of the page in a large white font on a navy background.</span></span> <span data-ttu-id="bd44d-170">Под заголовком `MainContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="bd44d-170">Beneath that is the `MainContent` ContentPlaceHolder.</span></span> <span data-ttu-id="bd44d-171">На рис. 1 показана Главная страница `Simple.master` при загрузке в конструкторе Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="bd44d-171">Figure 1 shows the `Simple.master` master page when loaded in the Visual Studio Designer.</span></span>

<span data-ttu-id="bd44d-172">[![вложенная эталонная страница определяет содержимое, относящееся к страницам в разделе "Администрирование"](nested-master-pages-cs/_static/image2.png)](nested-master-pages-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="bd44d-172">[![The Nested Master Page Defines Content Specific to the Pages in the Administration Section](nested-master-pages-cs/_static/image2.png)](nested-master-pages-cs/_static/image1.png)</span></span>

<span data-ttu-id="bd44d-173">**Рис. 01**. вложенная эталонная страница определяет содержимое, относящееся к страницам в разделе "Администрирование" ([щелкните, чтобы просмотреть изображение с полным размером](nested-master-pages-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="bd44d-173">**Figure 01**: The Nested Master Page Defines Content Specific to the Pages in the Administration Section ([Click to view full-size image](nested-master-pages-cs/_static/image3.png))</span></span>

## <a name="step-2-creating-a-simple-nested-master-page"></a><span data-ttu-id="bd44d-174">Шаг 2. Создание простой вложенной главной страницы</span><span class="sxs-lookup"><span data-stu-id="bd44d-174">Step 2: Creating a Simple Nested Master Page</span></span>

<span data-ttu-id="bd44d-175">`Simple.master` содержит два элемента управления ContentPlaceHolder: `MainContent` ContentPlaceHolder, добавленный в веб-форму вместе с `head` ContentPlaceHolder в элементе `<head>`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-175">`Simple.master` contains two ContentPlaceHolder controls: the `MainContent` ContentPlaceHolder we added within the Web Form along with the `head` ContentPlaceHolder in the `<head>` element.</span></span> <span data-ttu-id="bd44d-176">Если бы нам пришлось создать страницу содержимого и привязать ее к `Simple.master` страница содержимого будет иметь два элемента управления содержимым, ссылающихся на два элементов управления ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="bd44d-176">If we were to create a content page and bind it to `Simple.master` the content page would have two Content controls referencing the two ContentPlaceHolders.</span></span> <span data-ttu-id="bd44d-177">Аналогичным образом, если создать вложенную главную страницу и привязать ее к `Simple.master` то вложенная эталонная страница будет иметь два элемента управления содержимым.</span><span class="sxs-lookup"><span data-stu-id="bd44d-177">Similarly, if we create a nested master page and bind it to `Simple.master` then the nested master page will have two Content controls.</span></span>

<span data-ttu-id="bd44d-178">Добавим новую вложенную главную страницу в папку `NestedMasterPages` с именем `SimpleNested.master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-178">Let's add a new nested master page to the `NestedMasterPages` folder named `SimpleNested.master`.</span></span> <span data-ttu-id="bd44d-179">Щелкните правой кнопкой мыши папку `NestedMasterPages` и выберите команду Добавить новый элемент.</span><span class="sxs-lookup"><span data-stu-id="bd44d-179">Right-click on the `NestedMasterPages` folder and choose Add New Item.</span></span> <span data-ttu-id="bd44d-180">Откроется диалоговое окно Добавление нового элемента, показанное на рис. 2.</span><span class="sxs-lookup"><span data-stu-id="bd44d-180">This brings up the Add New Item dialog box shown in Figure 2.</span></span> <span data-ttu-id="bd44d-181">Выберите тип шаблона шаблон главной страницы и введите имя новой главной страницы.</span><span class="sxs-lookup"><span data-stu-id="bd44d-181">Select the Master Page template type and type in the name of the new master page.</span></span> <span data-ttu-id="bd44d-182">Чтобы указать, что новая Главная страница должна быть вложенной главной страницей, установите флажок "выбрать главную страницу".</span><span class="sxs-lookup"><span data-stu-id="bd44d-182">To indicate that the new master page should be a nested master page, check the "Select master page" checkbox.</span></span>

<span data-ttu-id="bd44d-183">Затем нажмите кнопку Добавить.</span><span class="sxs-lookup"><span data-stu-id="bd44d-183">Next, click the Add button.</span></span> <span data-ttu-id="bd44d-184">При этом будет отображаться диалоговое окно Выбор главной страницы, отображаемое при привязке страницы содержимого к главной странице (см. рис. 3).</span><span class="sxs-lookup"><span data-stu-id="bd44d-184">This will display the same Select a Master Page dialog box you see when binding a content page to a master page (see Figure 3).</span></span> <span data-ttu-id="bd44d-185">Выберите главную страницу `Simple.master` в папке `NestedMasterPages` и нажмите кнопку ОК.</span><span class="sxs-lookup"><span data-stu-id="bd44d-185">Choose the `Simple.master` master page in the `NestedMasterPages` folder and click OK.</span></span>

> [!NOTE]
> <span data-ttu-id="bd44d-186">Если вы создали веб-сайт ASP.NET с помощью модели проекта веб-приложения вместо модели проекта веб-сайта, флажок "выбрать главную страницу" в диалоговом окне "Добавление нового элемента", показанном на рис. 2, отображаться не будет.</span><span class="sxs-lookup"><span data-stu-id="bd44d-186">If you created your ASP.NET website using the Web Application Project model instead of the Web Site Project model you will not see the "Select master page" checkbox in the Add New Item dialog box shown in Figure 2.</span></span> <span data-ttu-id="bd44d-187">Чтобы создать вложенную главную страницу при использовании модели проекта веб-приложения, необходимо выбрать шаблон вложенной главной страницы (вместо шаблона главной страницы).</span><span class="sxs-lookup"><span data-stu-id="bd44d-187">To create a nested master page when using the Web Application Project model you must choose the Nested Master Page template (instead of the Master Page template).</span></span> <span data-ttu-id="bd44d-188">После выбора шаблона вложенной главной страницы и нажатия кнопки «Добавить» появится диалоговое окно Выбор главной страницы, показанное на рис. 3.</span><span class="sxs-lookup"><span data-stu-id="bd44d-188">After selecting the Nested Master Page template and clicking Add, the same Select a Master Page dialog box shown in Figure 3 will appear.</span></span>

<span data-ttu-id="bd44d-189">[![установите флажок &quot;выбрать главную страницу&quot;, чтобы добавить вложенную главную страницу.](nested-master-pages-cs/_static/image5.png)](nested-master-pages-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="bd44d-189">[![Check the &quot;Select master page&quot; Checkbox to Add a Nested Master Page](nested-master-pages-cs/_static/image5.png)](nested-master-pages-cs/_static/image4.png)</span></span>

<span data-ttu-id="bd44d-190">**Рис. 02**. Установка флажка "выбрать главную страницу" для добавления вложенной главной страницы ([щелкните, чтобы просмотреть изображение с полным размером](nested-master-pages-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="bd44d-190">**Figure 02**: Check the "Select master page" Checkbox to Add a Nested Master Page ([Click to view full-size image](nested-master-pages-cs/_static/image6.png))</span></span>

<span data-ttu-id="bd44d-191">[![привязать вложенную главную страницу к простой главной странице мастера](nested-master-pages-cs/_static/image8.png)](nested-master-pages-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="bd44d-191">[![Bind the Nested Master Page to the Simple.master Master Page](nested-master-pages-cs/_static/image8.png)](nested-master-pages-cs/_static/image7.png)</span></span>

<span data-ttu-id="bd44d-192">**Рис. 03**. Привязка вложенной главной страницы к главной странице `Simple.master` ([щелкните, чтобы просмотреть изображение с полным размером](nested-master-pages-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="bd44d-192">**Figure 03**: Bind the Nested Master Page to the `Simple.master` Master Page ([Click to view full-size image](nested-master-pages-cs/_static/image9.png))</span></span>

<span data-ttu-id="bd44d-193">Декларативная разметка вложенной главной страницы, показанная ниже, содержит два элемента управления содержимым, ссылающихся на два элемента управления ContentPlaceHolder главной страницы верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="bd44d-193">The nested master page's declarative markup, shown below, contains two Content controls referencing the top-level master page's two ContentPlaceHolder controls.</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample3.aspx)]

<span data-ttu-id="bd44d-194">За исключением директивы `<%@ Master %>`, начальная декларативная разметка вложенной главной страницы идентична разметке, первоначально формируемой при привязке страницы содержимого к той же главной странице верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="bd44d-194">Except for the `<%@ Master %>` directive, the nested master page's initial declarative markup is identical to the markup that is initially generated when binding a content page to the same top-level master page.</span></span> <span data-ttu-id="bd44d-195">Как и директива `<%@ Page %>` страницы содержимого, директива `<%@ Master %>` здесь включает атрибут `MasterPageFile`, указывающий родительскую главную страницу вложенной главной страницы.</span><span class="sxs-lookup"><span data-stu-id="bd44d-195">Like a content page's `<%@ Page %>` directive, the `<%@ Master %>` directive here includes a `MasterPageFile` attribute that specifies the nested master page's parent master page.</span></span> <span data-ttu-id="bd44d-196">Основное различие между вложенной главной страницей и страницей содержимого, привязанной к одной главной странице верхнего уровня, заключается в том, что вложенная эталонная страница может включать элементы управления ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="bd44d-196">The main difference between the nested master page and a content page bound to the same top-level master page is that the nested master page can include ContentPlaceHolder controls.</span></span> <span data-ttu-id="bd44d-197">Элементы управления ContentPlaceHolder вложенной главной страницы определяют регионы, в которых страницы содержимого могут настраивать разметку.</span><span class="sxs-lookup"><span data-stu-id="bd44d-197">The nested master page's ContentPlaceHolder controls define the regions where the content pages can customize the markup.</span></span>

<span data-ttu-id="bd44d-198">Обновите эту вложенную главную страницу, чтобы она отображала текст "Hello, from Симпленестед!".</span><span class="sxs-lookup"><span data-stu-id="bd44d-198">Update this nested master page so that it displays the text "Hello, from SimpleNested!"</span></span> <span data-ttu-id="bd44d-199">в элементе управления содержимым, соответствующем элементу управления `MainContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="bd44d-199">in the Content control that corresponds to the `MainContent` ContentPlaceHolder control.</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample4.aspx)]

<span data-ttu-id="bd44d-200">После выполнения этого добавления сохраните вложенную главную страницу, а затем добавьте новую страницу содержимого в папку `NestedMasterPages` с именем `Default.aspx`и привяжите ее к главной странице `SimpleNested.master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-200">After making this addition, save the nested master page and then add a new content page to the `NestedMasterPages` folder named `Default.aspx`, and bind it to the `SimpleNested.master` master page.</span></span> <span data-ttu-id="bd44d-201">После добавления этой страницы может быть удивлено, что она не содержит элементов управления содержимым (см. рис. 4)!</span><span class="sxs-lookup"><span data-stu-id="bd44d-201">Upon adding this page you may be surprised to see that it contains no Content controls (see Figure 4)!</span></span> <span data-ttu-id="bd44d-202">Страница содержимого может обращаться только к элементов управления ContentPlaceHolder *родительской* главной страницы.</span><span class="sxs-lookup"><span data-stu-id="bd44d-202">A content page can only access its *parent* master page's ContentPlaceHolders.</span></span> <span data-ttu-id="bd44d-203">`SimpleNested.master` не содержит элементов управления ContentPlaceHolder; Таким образом, любая страница содержимого, привязанная к этой главной странице, не может содержать элементы управления содержимым.</span><span class="sxs-lookup"><span data-stu-id="bd44d-203">`SimpleNested.master` does not contain any ContentPlaceHolder controls; therefore, any content page bound to this master page cannot contain any Content controls.</span></span>

<span data-ttu-id="bd44d-204">[![страница "Создание содержимого" не содержит элементов управления содержимым](nested-master-pages-cs/_static/image11.png)](nested-master-pages-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="bd44d-204">[![The New Content Page Contains No Content Controls](nested-master-pages-cs/_static/image11.png)](nested-master-pages-cs/_static/image10.png)</span></span>

<span data-ttu-id="bd44d-205">**Рис. 04**. страница "новое содержимое" не содержит элементов управления содержимым ([щелкните, чтобы просмотреть изображение с полным размером](nested-master-pages-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="bd44d-205">**Figure 04**: The New Content Page Contains No Content Controls ([Click to view full-size image](nested-master-pages-cs/_static/image12.png))</span></span>

<span data-ttu-id="bd44d-206">Нам нужно обновить вложенную главную страницу (`SimpleNested.master`), чтобы включить элементы управления ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="bd44d-206">What we need to do is update the nested master page (`SimpleNested.master`) to include ContentPlaceHolder controls.</span></span> <span data-ttu-id="bd44d-207">Обычно необходимо, чтобы вложенные главные страницы включали ContentPlaceHolder для каждого элемента ContentPlaceHolder, определенного родительской главной страницей, тем самым позволяя дочерней главной странице или странице содержимого работать с любым элементом ContentPlaceHolder главной страницы верхнего уровня. элементы управления.</span><span class="sxs-lookup"><span data-stu-id="bd44d-207">Typically you'll want your nested master pages to include a ContentPlaceHolder for each ContentPlaceHolder defined by its parent master page, thereby allowing its child master page or content page to work with any of the top-level master page's ContentPlaceHolder controls.</span></span>

<span data-ttu-id="bd44d-208">Обновите главную страницу `SimpleNested.master`, чтобы включить ContentPlaceHolder в два элемента управления содержимым.</span><span class="sxs-lookup"><span data-stu-id="bd44d-208">Update the `SimpleNested.master` master page to include a ContentPlaceHolder in its two Content controls.</span></span> <span data-ttu-id="bd44d-209">Присвойте элементам управления ContentPlaceHolder имя, совпадающее с именем элемента управления ContentPlaceHolder, на которое ссылается элемент управления содержимым.</span><span class="sxs-lookup"><span data-stu-id="bd44d-209">Give the ContentPlaceHolder controls the same name as the ContentPlaceHolder control their Content control refers to.</span></span> <span data-ttu-id="bd44d-210">То есть добавьте элемент управления ContentPlaceHolder с именем `MainContent` в элемент управления содержимым в `SimpleNested.master`, который ссылается на `MainContent` ContentPlaceHolder в `Simple.master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-210">That is, add a ContentPlaceHolder control named `MainContent` to the Content control in `SimpleNested.master` that references the `MainContent` ContentPlaceHolder in `Simple.master`.</span></span> <span data-ttu-id="bd44d-211">Сделайте то же самое в элементе управления содержимым, который ссылается на `head` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="bd44d-211">Do the same thing in the Content control that references the `head` ContentPlaceHolder.</span></span>

> [!NOTE]
> <span data-ttu-id="bd44d-212">Хотя я рекомендую назвать элементы управления ContentPlaceHolder во вложенной главной странице так же, как элементов управления ContentPlaceHolder на главной странице верхнего уровня, это имя не является обязательным.</span><span class="sxs-lookup"><span data-stu-id="bd44d-212">While I recommend naming the ContentPlaceHolder controls in the nested master page the same as the ContentPlaceHolders in the top-level master page, this naming symmetry is not required.</span></span> <span data-ttu-id="bd44d-213">Можно присвоить элементам управления ContentPlaceHolder во вложенной главной странице любое имя.</span><span class="sxs-lookup"><span data-stu-id="bd44d-213">You can give the ContentPlaceHolder controls in your nested master page any name you like.</span></span> <span data-ttu-id="bd44d-214">Однако я могу легко запомнить, что элементов управления ContentPlaceHolder соответствует каким областям страницы, если Главная страница верхнего уровня и вложенные главные страницы используют одни и те же имена.</span><span class="sxs-lookup"><span data-stu-id="bd44d-214">However, I find it easier to remember what ContentPlaceHolders correspond with what regions of the page if my top-level master page and nested master pages use the same names.</span></span>

<span data-ttu-id="bd44d-215">После внесения этих дополнений декларативная разметка `SimpleNested.master` главной страницы должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="bd44d-215">After making these additions your `SimpleNested.master` master page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample5.aspx)]

<span data-ttu-id="bd44d-216">Удалите только что созданную страницу содержимого `Default.aspx`, а затем добавьте ее повторно, привязывая ее к главной странице `SimpleNested.master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-216">Delete the `Default.aspx` content page we just created and then re-add it, binding it to the `SimpleNested.master` master page.</span></span> <span data-ttu-id="bd44d-217">На этот раз Visual Studio добавляет два элемента управления содержимым в `Default.aspx`, ссылаясь на элементов управления ContentPlaceHolder, которая теперь определена в `SimpleNested.master` (см. рис. 6).</span><span class="sxs-lookup"><span data-stu-id="bd44d-217">This time Visual Studio adds two Content controls to the `Default.aspx`, referencing the ContentPlaceHolders now defined in `SimpleNested.master` (see Figure 6).</span></span> <span data-ttu-id="bd44d-218">Добавьте текст "Привет, из default. aspx!"</span><span class="sxs-lookup"><span data-stu-id="bd44d-218">Add the text, "Hello, from Default.aspx!"</span></span> <span data-ttu-id="bd44d-219">в элементе управления содержимым, на который указывает ссылка `MainContent`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-219">in the Content control that referenced `MainContent`.</span></span>

<span data-ttu-id="bd44d-220">На рис. 5 показаны три участвующие здесь сущности — `Simple.master`, `SimpleNested.master`и `Default.aspx`, а также их связь друг с другом.</span><span class="sxs-lookup"><span data-stu-id="bd44d-220">Figure 5 shows the three entities involved here - `Simple.master`, `SimpleNested.master`, and `Default.aspx` - and how they relate to one another.</span></span> <span data-ttu-id="bd44d-221">Как видно на диаграмме, вложенная эталонная страница реализует элементы управления содержимым для своего родительского элемента ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="bd44d-221">As the diagram shows, the nested master page implements Content controls for its parent's ContentPlaceHolder.</span></span> <span data-ttu-id="bd44d-222">Если эти регионы должны быть доступны для страницы содержимого, вложенная Главная страница должна добавить собственные элементов управления ContentPlaceHolder к элементам управления содержимым.</span><span class="sxs-lookup"><span data-stu-id="bd44d-222">If these regions need to be accessible to the content page, the nested master page must add its own ContentPlaceHolders to the Content controls.</span></span>

<span data-ttu-id="bd44d-223">[![Главная страница верхнего уровня и вложенные главные страницы определяют макет страницы содержимого](nested-master-pages-cs/_static/image14.png)](nested-master-pages-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="bd44d-223">[![The Top-Level and Nested Master Pages Dictate the Content Page's Layout](nested-master-pages-cs/_static/image14.png)](nested-master-pages-cs/_static/image13.png)</span></span>

<span data-ttu-id="bd44d-224">**Рис. 05**. Главная страница верхнего уровня и вложенные главные страницы определяют макет страницы содержимого ([щелкните, чтобы просмотреть изображение с полным размером](nested-master-pages-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="bd44d-224">**Figure 05**: The Top-Level and Nested Master Pages Dictate the Content Page's Layout ([Click to view full-size image](nested-master-pages-cs/_static/image15.png))</span></span>

<span data-ttu-id="bd44d-225">Это поведение показывает, как страница содержимого или эталонная страница Компания cognizant только ее родительской главной страницы.</span><span class="sxs-lookup"><span data-stu-id="bd44d-225">This behavior illustrates how a content page or master page is only cognizant of its parent master page.</span></span> <span data-ttu-id="bd44d-226">Это поведение также обозначается конструктором Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="bd44d-226">This behavior is also indicated by the Visual Studio Designer.</span></span> <span data-ttu-id="bd44d-227">На рис. 6 показан конструктор для `Default.aspx`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-227">Figure 6 shows the Designer for `Default.aspx`.</span></span> <span data-ttu-id="bd44d-228">Хотя в конструкторе ясно видно, какие регионы доступны для редактирования на странице содержимого, а какие нет, не следует определять, какие неизменяемые регионы находятся на вложенной главной странице и какие регионы находятся на главной странице верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="bd44d-228">While the Designer clearly shows what regions are editable from the content page and what portions aren't, it doesn't disambiguate what non-editable regions are from the nested master page and what regions are from the top-level master page.</span></span>

<span data-ttu-id="bd44d-229">[![страница содержимого теперь включает элементы управления содержимым для элементов управления ContentPlaceHolder вложенной главной страницы.](nested-master-pages-cs/_static/image17.png)](nested-master-pages-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="bd44d-229">[![The Content Page Now Includes Content Controls for the Nested Master Page's ContentPlaceHolders](nested-master-pages-cs/_static/image17.png)](nested-master-pages-cs/_static/image16.png)</span></span>

<span data-ttu-id="bd44d-230">**Рис. 6**. страница содержимого теперь включает элементы управления содержимым для элементов управления ContentPlaceHolder вложенной главной страницы ([щелкните, чтобы просмотреть изображение с полным размером](nested-master-pages-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="bd44d-230">**Figure 06**: The Content Page Now Includes Content Controls for the Nested Master Page's ContentPlaceHolders ([Click to view full-size image](nested-master-pages-cs/_static/image18.png))</span></span>

## <a name="step-3-adding-a-second-simple-nested-master-page"></a><span data-ttu-id="bd44d-231">Шаг 3. Добавление второй простой вложенной главной страницы</span><span class="sxs-lookup"><span data-stu-id="bd44d-231">Step 3: Adding a Second Simple Nested Master Page</span></span>

<span data-ttu-id="bd44d-232">Преимущество вложенных главных страниц более очевидно при наличии нескольких вложенных главных страниц.</span><span class="sxs-lookup"><span data-stu-id="bd44d-232">The benefit of nested master pages is more evident when there are multiple nested master pages.</span></span> <span data-ttu-id="bd44d-233">Чтобы продемонстрировать это преимущество, создайте еще одну вложенную главную страницу в папке `NestedMasterPages`. Назовите эту новую вложенную главную страницу `SimpleNestedAlternate.master` и привяжите ее к главной странице `Simple.master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-233">To illustrate this benefit, create another nested master page in the `NestedMasterPages` folder; name this new nested master page `SimpleNestedAlternate.master` and bind it to the `Simple.master` master page.</span></span> <span data-ttu-id="bd44d-234">Добавьте элементы управления ContentPlaceHolder в два элемента управления содержимым вложенной главной страницы, как в шаге 2.</span><span class="sxs-lookup"><span data-stu-id="bd44d-234">Add ContentPlaceHolder controls in the nested master page's two Content controls like we did in Step 2.</span></span> <span data-ttu-id="bd44d-235">Также добавьте текст "Hello, from Симпленестедалтернате!"</span><span class="sxs-lookup"><span data-stu-id="bd44d-235">Also add the text, "Hello, from SimpleNestedAlternate!"</span></span> <span data-ttu-id="bd44d-236">в элементе управления содержимым, который соответствует `MainContent` ContentPlaceHolder главной страницы верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="bd44d-236">in the Content control that corresponds to the top-level master page's `MainContent` ContentPlaceHolder.</span></span> <span data-ttu-id="bd44d-237">После внесения этих изменений декларативная разметка новой вложенной главной страницы должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="bd44d-237">After making these changes your new nested master page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample6.aspx)]

<span data-ttu-id="bd44d-238">Создайте страницу содержимого с именем `Alternate.aspx` в папке `NestedMasterPages` и привяжите ее к `SimpleNestedAlternate.master` вложенной главной странице.</span><span class="sxs-lookup"><span data-stu-id="bd44d-238">Create a content page named `Alternate.aspx` in the `NestedMasterPages` folder and bind it to the `SimpleNestedAlternate.master` nested master page.</span></span> <span data-ttu-id="bd44d-239">Добавьте текст "Привет, из альтернативного!"</span><span class="sxs-lookup"><span data-stu-id="bd44d-239">Add the text, "Hello, from Alternate!"</span></span> <span data-ttu-id="bd44d-240">в элементе управления содержимым, соответствующем `MainContent`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-240">in the Content control that corresponds to `MainContent`.</span></span> <span data-ttu-id="bd44d-241">На рис. 7 показано, `Alternate.aspx` при просмотре в конструкторе Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="bd44d-241">Figure 7 shows `Alternate.aspx` when viewed through the Visual Studio Designer.</span></span>

<span data-ttu-id="bd44d-242">[![альтернативный aspx-элемент привязан к главной странице Симпленестедалтернате. master](nested-master-pages-cs/_static/image20.png)](nested-master-pages-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="bd44d-242">[![Alternate.aspx is Bound to the SimpleNestedAlternate.master Master Page](nested-master-pages-cs/_static/image20.png)](nested-master-pages-cs/_static/image19.png)</span></span>

<span data-ttu-id="bd44d-243">**Рис. 07**. `Alternate.aspx` привязан к главной странице `SimpleNestedAlternate.master` ([щелкните, чтобы просмотреть изображение с полным размером](nested-master-pages-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="bd44d-243">**Figure 07**: `Alternate.aspx` is Bound to the `SimpleNestedAlternate.master` Master Page ([Click to view full-size image](nested-master-pages-cs/_static/image21.png))</span></span>

<span data-ttu-id="bd44d-244">Сравните конструктор на рис. 7 с конструктором на рис. 6.</span><span class="sxs-lookup"><span data-stu-id="bd44d-244">Compare the Designer in Figure 7 to the Designer in Figure 6.</span></span> <span data-ttu-id="bd44d-245">Обе страницы содержимого имеют одинаковый макет, определенный на главной странице верхнего уровня (`Simple.master`), а именно, заголовок «учебник по вложенным главным страницам (простой)».</span><span class="sxs-lookup"><span data-stu-id="bd44d-245">Both content pages share the same layout defined in the top-level master page (`Simple.master`), namely the "Nested Master Pages Tutorial (Simple)" title.</span></span> <span data-ttu-id="bd44d-246">Однако в их родительских главных страницах определено отдельное содержимое — текст «Hello, from Симпленестед!».</span><span class="sxs-lookup"><span data-stu-id="bd44d-246">Yet both have distinct content defined in their parent master pages - the text "Hello, from SimpleNested!"</span></span> <span data-ttu-id="bd44d-247">на рис. 6 и «Hello, from Симпленестедалтернате!»</span><span class="sxs-lookup"><span data-stu-id="bd44d-247">in Figure 6 and "Hello, from SimpleNestedAlternate!"</span></span> <span data-ttu-id="bd44d-248">на рис. 7.</span><span class="sxs-lookup"><span data-stu-id="bd44d-248">in Figure 7.</span></span> <span data-ttu-id="bd44d-249">Разумеется, эти различия являются тривиальными, но можно расширить этот пример, чтобы включить более значимые различия.</span><span class="sxs-lookup"><span data-stu-id="bd44d-249">Granted, these differences here are trivial, but you could extend this example to include more meaningful differences.</span></span> <span data-ttu-id="bd44d-250">Например, страница `SimpleNested.master` может включать меню с параметрами, относящимися к его страницам содержимого, тогда как `SimpleNestedAlternate.master` может содержать сведения, относящиеся к страницам содержимого, которые привязаны к нему.</span><span class="sxs-lookup"><span data-stu-id="bd44d-250">For instance, the `SimpleNested.master` page might include a menu with options specific to its content pages, whereas `SimpleNestedAlternate.master` might have information pertinent to the content pages that bind to it.</span></span>

<span data-ttu-id="bd44d-251">Теперь представьте, что нам нужно внести изменения в макет сайта с перераспределением.</span><span class="sxs-lookup"><span data-stu-id="bd44d-251">Now, imagine that we needed to make a change to the overarching site layout.</span></span> <span data-ttu-id="bd44d-252">Например, представьте, что нам нужно добавить список общих ссылок на все страницы содержимого.</span><span class="sxs-lookup"><span data-stu-id="bd44d-252">For example, imagine that we wanted to add a list of common links to all content pages.</span></span> <span data-ttu-id="bd44d-253">Для этого мы обновляем главную страницу верхнего уровня `Simple.master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-253">To accomplish this we update the top-level master page, `Simple.master`.</span></span> <span data-ttu-id="bd44d-254">Все изменения немедленно отражаются во вложенных главных страницах и по расширениям, на страницах содержимого.</span><span class="sxs-lookup"><span data-stu-id="bd44d-254">Any changes there are immediately reflected in its nested master pages and, by extension, their content pages.</span></span>

<span data-ttu-id="bd44d-255">Чтобы продемонстрировать простоту, с которой можно изменить макет сайта с перераспределением, откройте `Simple.master` главную страницу и добавьте следующую разметку между `topContent`ными и `mainContent` `<div>`ными элементами:</span><span class="sxs-lookup"><span data-stu-id="bd44d-255">To demonstrate the ease with which we can change the overarching site layout, open the `Simple.master` master page and add the following markup between the `topContent` and `mainContent` `<div>` elements:</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample7.aspx)]

<span data-ttu-id="bd44d-256">Это приводит к добавлению двух ссылок в верхнюю часть каждой страницы, которая привязывается к `Simple.master`, `SimpleNested.master`или `SimpleNestedAlternate.master`. Эти изменения немедленно применяются ко всем вложенным главным страницам и страницам содержимого.</span><span class="sxs-lookup"><span data-stu-id="bd44d-256">This adds two links to the top of every page that binds to `Simple.master`, `SimpleNested.master`, or `SimpleNestedAlternate.master`; these changes apply to all nested master pages and their content pages immediately.</span></span> <span data-ttu-id="bd44d-257">На рис. 8 показано, `Alternate.aspx` при просмотре в браузере.</span><span class="sxs-lookup"><span data-stu-id="bd44d-257">Figure 8 shows `Alternate.aspx` when viewed through a browser.</span></span> <span data-ttu-id="bd44d-258">Обратите внимание на добавление ссылок в верхней части страницы (по сравнению с рис. 7).</span><span class="sxs-lookup"><span data-stu-id="bd44d-258">Note the addition of the links at the top of the page (compared to Figure 7).</span></span>

<span data-ttu-id="bd44d-259">[![, измененные на главную страницу верхнего уровня, немедленно отражаются во вложенных главных страницах и их страницах содержимого.](nested-master-pages-cs/_static/image23.png)](nested-master-pages-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="bd44d-259">[![Changed to the Top-Level Master Page are Immediately Reflected in its Nested Master Pages and Their Content Pages](nested-master-pages-cs/_static/image23.png)](nested-master-pages-cs/_static/image22.png)</span></span>

<span data-ttu-id="bd44d-260">**Рис. 08**. Изменение главной страницы верхнего уровня немедленно отражается во вложенных главных страницах и их страницах содержимого ([щелкните, чтобы просмотреть изображение с полным размером](nested-master-pages-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="bd44d-260">**Figure 08**: Changed to the Top-Level Master Page are Immediately Reflected in its Nested Master Pages and Their Content Pages ([Click to view full-size image](nested-master-pages-cs/_static/image24.png))</span></span>

## <a name="using-a-nested-master-page-for-the-administration-section"></a><span data-ttu-id="bd44d-261">Использование вложенной главной страницы для раздела "Администрирование"</span><span class="sxs-lookup"><span data-stu-id="bd44d-261">Using a Nested Master Page for the Administration Section</span></span>

<span data-ttu-id="bd44d-262">На этом этапе мы рассмотрели преимущества вложенных главных страниц и увидели, как их создавать и использовать в приложении ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="bd44d-262">At this point we have looked at the advantages of nested master pages and have seen how to create and use them in an ASP.NET application.</span></span> <span data-ttu-id="bd44d-263">В примерах, описанных в шагах 1, 2 и 3, участвует создание главной страницы верхнего уровня, новые вложенные главные страницы и новые страницы содержимого.</span><span class="sxs-lookup"><span data-stu-id="bd44d-263">The examples in Steps 1, 2, and 3, however, involved creating a new top-level master page, new nested master pages, and new content pages.</span></span> <span data-ttu-id="bd44d-264">Что насчет добавления новой вложенной главной страницы на веб-сайт с существующей главной страницей верхнего уровня и страницами содержимого?</span><span class="sxs-lookup"><span data-stu-id="bd44d-264">What about adding a new nested master page to a website with an existing top-level master page and content pages?</span></span>

<span data-ttu-id="bd44d-265">Интеграция вложенной главной страницы в существующий веб-сайт и связывание ее с существующими страницами содержимого требует немного больше усилий, чем начиная с нуля.</span><span class="sxs-lookup"><span data-stu-id="bd44d-265">Integrating a nested master page into an existing website and associating it with existing content pages requires a bit more effort than starting from scratch.</span></span> <span data-ttu-id="bd44d-266">В шагах 4, 5, 6 и 7 рассматриваются эти проблемы, когда мы дополним демонстрационное приложение, включив в него новую вложенную главную страницу с именем `AdminNested.master`, которая содержит инструкции для администратора и используется страницами ASP.NET в папке `~/Admin`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-266">Steps 4, 5, 6, and 7 explore these challenges as we augment our demo application to include a new nested master page named `AdminNested.master` that contains instructions for the administrator and is used by the ASP.NET pages in the `~/Admin` folder.</span></span>

<span data-ttu-id="bd44d-267">Интеграция вложенной главной страницы в наше демонстрационное приложение приводит к следующим недостаткам:</span><span class="sxs-lookup"><span data-stu-id="bd44d-267">Integrating a nested master page into our demo application introduces the following hurdles:</span></span>

- <span data-ttu-id="bd44d-268">Существующие страницы содержимого в папке `~/Admin` имеют определенные ожидания на главной странице.</span><span class="sxs-lookup"><span data-stu-id="bd44d-268">The existing content pages in the `~/Admin` folder have certain expectations from their master page.</span></span> <span data-ttu-id="bd44d-269">Для начала они хотят, чтобы были представлены определенные элементы управления ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="bd44d-269">For starters, they expect certain ContentPlaceHolder controls to be present.</span></span> <span data-ttu-id="bd44d-270">Кроме того, страницы `~/Admin/AddProduct.aspx` и `~/Admin/Products.aspx` вызывают открытый метод `RefreshRecentProductsGrid` главной страницы, устанавливают его свойство `GridMessageText` или имеют обработчик событий для его `PricesDoubled` события.</span><span class="sxs-lookup"><span data-stu-id="bd44d-270">Furthermore, the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages call the master page's public `RefreshRecentProductsGrid` method, set its `GridMessageText` property, or have an event handler for its `PricesDoubled` event.</span></span> <span data-ttu-id="bd44d-271">Следовательно, наша вложенная Главная страница должна предоставлять те же элементов управления ContentPlaceHolder и открытые члены.</span><span class="sxs-lookup"><span data-stu-id="bd44d-271">Consequently, our nested master page must provide the same ContentPlaceHolders and public members.</span></span>
- <span data-ttu-id="bd44d-272">В предыдущем учебном курсе мы улучшили класс `BasePage` для динамического задания свойства `MasterPageFile` объекта `Page` на основе переменной сеанса.</span><span class="sxs-lookup"><span data-stu-id="bd44d-272">In the preceding tutorial we enhanced the `BasePage` class to dynamically set the `Page` object's `MasterPageFile` property based on a Session variable.</span></span> <span data-ttu-id="bd44d-273">Поддержка динамических главных страниц при использовании вложенных главных страниц</span><span class="sxs-lookup"><span data-stu-id="bd44d-273">How to we support dynamic master pages when using nested master pages?</span></span>

<span data-ttu-id="bd44d-274">Эти две проблемы появятся при создании вложенной главной страницы и использовании ее из существующих страниц содержимого.</span><span class="sxs-lookup"><span data-stu-id="bd44d-274">These two challenges will surface as we build the nested master page and use it from our existing content pages.</span></span> <span data-ttu-id="bd44d-275">Мы будем исследовать и сурмаунт эти проблемы по мере их возникновения.</span><span class="sxs-lookup"><span data-stu-id="bd44d-275">We'll investigate and surmount these issues as they arise.</span></span>

## <a name="step-4-creating-the-nested-master-page"></a><span data-ttu-id="bd44d-276">Шаг 4. Создание вложенной главной страницы</span><span class="sxs-lookup"><span data-stu-id="bd44d-276">Step 4: Creating the Nested Master Page</span></span>

<span data-ttu-id="bd44d-277">Первая задача — создать вложенную главную страницу, которая будет использоваться страницами в разделе Администрирование.</span><span class="sxs-lookup"><span data-stu-id="bd44d-277">Our first task is to create the nested master page to be used by the pages in the Administration section.</span></span> <span data-ttu-id="bd44d-278">Как было показано на шаге 2, при добавлении новой вложенной главной страницы необходимо указать родительскую главную страницу вложенной главной страницы.</span><span class="sxs-lookup"><span data-stu-id="bd44d-278">As we saw in Step 2, when adding a new nested master page we need to specify the nested master page's parent master page.</span></span> <span data-ttu-id="bd44d-279">Но у нас есть две главные страницы верхнего уровня: `Site.master` и `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-279">But we have two top-level master pages: `Site.master` and `Alternate.master`.</span></span> <span data-ttu-id="bd44d-280">Вспомним, что мы создали `Alternate.master` в предыдущем руководстве и написали код в `BasePage`ном классе, который задает свойство `MasterPageFile` объекта страницы во время выполнения как `Site.master` или `Alternate.master` в зависимости от значения переменной сеанса `MyMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-280">Recall that we created `Alternate.master` in the preceding tutorial and wrote code in the `BasePage` class that set the Page object's `MasterPageFile` property at runtime to either `Site.master` or `Alternate.master` depending on the value of the `MyMasterPage` Session variable.</span></span>

<span data-ttu-id="bd44d-281">Как настроить вложенную главную страницу так, чтобы она использовала соответствующую главную страницу верхнего уровня?</span><span class="sxs-lookup"><span data-stu-id="bd44d-281">How do we configure our nested master page so that it uses the appropriate top-level master page?</span></span> <span data-ttu-id="bd44d-282">Это можно сделать двумя способами.</span><span class="sxs-lookup"><span data-stu-id="bd44d-282">We have two options:</span></span>

- <span data-ttu-id="bd44d-283">Создайте две вложенные главные страницы, `AdminNestedSite.master` и `AdminNestedAlternate.master`и привяжите их к главным страницам верхнего уровня `Site.master` и `Alternate.master`соответственно.</span><span class="sxs-lookup"><span data-stu-id="bd44d-283">Create two nested master pages, `AdminNestedSite.master` and `AdminNestedAlternate.master`, and bind them to the top-level master pages `Site.master` and `Alternate.master`, respectively.</span></span> <span data-ttu-id="bd44d-284">В `BasePage`необходимо установить `MasterPageFile` объекта `Page` на соответствующую вложенную главную страницу.</span><span class="sxs-lookup"><span data-stu-id="bd44d-284">In `BasePage`, then, we'd set the `Page` object's `MasterPageFile` to the appropriate nested master page.</span></span>
- <span data-ttu-id="bd44d-285">Создание одной вложенной главной страницы и использование страниц содержимого этой конкретной главной страницей.</span><span class="sxs-lookup"><span data-stu-id="bd44d-285">Create a single nested master page and have the content pages use this particular master page.</span></span> <span data-ttu-id="bd44d-286">Затем во время выполнения нам нужно было бы задать свойство `MasterPageFile` вложенной главной страницы соответствующей главной странице верхнего уровня во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="bd44d-286">Then, at runtime, we'd need to set the nested master page's `MasterPageFile` property to the appropriate top-level master page at runtime.</span></span> <span data-ttu-id="bd44d-287">(Как вы, возможно, поняли, на главной странице также имеется свойство `MasterPageFile`.)</span><span class="sxs-lookup"><span data-stu-id="bd44d-287">(As you might have figured out by now, master pages also have a `MasterPageFile` property.)</span></span>

<span data-ttu-id="bd44d-288">Давайте будем использовать второй вариант.</span><span class="sxs-lookup"><span data-stu-id="bd44d-288">Let's use the second option.</span></span> <span data-ttu-id="bd44d-289">Создайте один вложенный файл главной страницы в папке `~/Admin` с именем `AdminNested.master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-289">Create a single nested master page file in the `~/Admin` folder named `AdminNested.master`.</span></span> <span data-ttu-id="bd44d-290">Так как `Site.master` и `Alternate.master` имеют одинаковый набор элементов управления ContentPlaceHolder, не имеет значения, к какой главной странице она привязана, хотя я рекомендую привязать его к `Site.master` для обеспечения согласованности.</span><span class="sxs-lookup"><span data-stu-id="bd44d-290">Because both `Site.master` and `Alternate.master` have the same set of ContentPlaceHolder controls, it doesn't matter what master page you bind it to, although I encourage you to bind it to `Site.master` for consistency's sake.</span></span>

<span data-ttu-id="bd44d-291">[![добавить вложенную главную страницу в папку ~/admin.](nested-master-pages-cs/_static/image26.png)](nested-master-pages-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="bd44d-291">[![Add a Nested Master Page to the ~/Admin Folder.](nested-master-pages-cs/_static/image26.png)](nested-master-pages-cs/_static/image25.png)</span></span>

<span data-ttu-id="bd44d-292">**Рис. 09**. Добавление вложенной главной страницы в папку `~/Admin`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-292">**Figure 09**: Add a Nested Master Page to the `~/Admin` Folder.</span></span> <span data-ttu-id="bd44d-293">([Щелкните, чтобы просмотреть изображение с полным размером](nested-master-pages-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="bd44d-293">([Click to view full-size image](nested-master-pages-cs/_static/image27.png))</span></span>

<span data-ttu-id="bd44d-294">Так как вложенная эталонная страница привязана к главной странице с четырьмя элементами управления ContentPlaceHolder, Visual Studio добавляет четыре элемента управления содержимым в исходную разметку файла вложенной главной страницы.</span><span class="sxs-lookup"><span data-stu-id="bd44d-294">Because the nested master page is bound to a master page with four ContentPlaceHolder controls, Visual Studio adds four Content controls to the new nested master page file's initial markup.</span></span> <span data-ttu-id="bd44d-295">Как и в шагах 2 и 3, добавьте элемент управления ContentPlaceHolder в каждый элемент управления содержимым, присваивая ему то же имя, что и элемент управления ContentPlaceHolder главной страницы верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="bd44d-295">Like we did in Steps 2 and 3, add a ContentPlaceHolder control in each Content control, giving it the same name as the top-level master page's ContentPlaceHolder control.</span></span> <span data-ttu-id="bd44d-296">Также добавьте следующую разметку в элемент управления содержимым, соответствующий `MainContent` ContentPlaceHolder:</span><span class="sxs-lookup"><span data-stu-id="bd44d-296">Also add the following markup to the Content control that corresponds to the `MainContent` ContentPlaceHolder:</span></span>

[!code-html[Main](nested-master-pages-cs/samples/sample8.html)]

<span data-ttu-id="bd44d-297">Затем определите класс `instructions` CSS в файлах `Styles.css` и `AlternateStyles.css` CSS.</span><span class="sxs-lookup"><span data-stu-id="bd44d-297">Next, define the `instructions` CSS class in the `Styles.css` and `AlternateStyles.css` CSS files.</span></span> <span data-ttu-id="bd44d-298">Следующие правила CSS приводят к тому, что элементы HTML, отмеченные классом `instructions`, отображаются с светло-желтым цветом фона и черной сплошной границей:</span><span class="sxs-lookup"><span data-stu-id="bd44d-298">The following CSS rules cause HTML elements styled with the `instructions` class to be displayed with a light yellow background color and a black, solid border:</span></span>

[!code-css[Main](nested-master-pages-cs/samples/sample9.css)]

<span data-ttu-id="bd44d-299">Поскольку эта разметка была добавлена на вложенную главную страницу, она будет отображаться только на тех страницах, которые используют эту вложенную главную страницу (а именно страницы в разделе Администрирование).</span><span class="sxs-lookup"><span data-stu-id="bd44d-299">Because this markup has been added to the nested master page, it will only appear in those pages that use this nested master page (namely, the pages in the Administration section).</span></span>

<span data-ttu-id="bd44d-300">После внесения этих дополнений в вложенную главную страницу ее декларативная разметка должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="bd44d-300">After making these additions to your nested master page, its declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample10.aspx)]

<span data-ttu-id="bd44d-301">Обратите внимание, что каждый элемент управления содержимым имеет элемент управления ContentPlaceHolder и свойствам элемента управления ContentPlaceHolder ' `ID` присваиваются те же значения, что и соответствующие элементы управления ContentPlaceHolder на главной странице верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="bd44d-301">Note that each Content control has a ContentPlaceHolder control and that the ContentPlaceHolder controls' `ID` properties are assigned the same values as the corresponding ContentPlaceHolder controls in the top-level master page.</span></span> <span data-ttu-id="bd44d-302">Более того, разметка, относящаяся к разделу администрирования, отображается в `MainContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="bd44d-302">Moreover, the Administration section-specific markup appears in the `MainContent` ContentPlaceHolder.</span></span>

<span data-ttu-id="bd44d-303">На рис. 10 показана `AdminNested.master` вложенная Главная страница при просмотре в конструкторе Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="bd44d-303">Figure 10 shows the `AdminNested.master` nested master page when viewed through Visual Studio's Designer.</span></span> <span data-ttu-id="bd44d-304">Вы можете увидеть инструкции в желтом поле в верхней части `MainContent` элемента управления содержимым.</span><span class="sxs-lookup"><span data-stu-id="bd44d-304">You can see the instructions in the yellow box at the top of the `MainContent` Content control.</span></span>

<span data-ttu-id="bd44d-305">[![вложенная эталонная страница расширяет главную страницу верхнего уровня, добавляя инструкции для администратора.](nested-master-pages-cs/_static/image29.png)](nested-master-pages-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="bd44d-305">[![The Nested Master Page Extends the Top-Level Master Page to Include Instructions for the Administrator.](nested-master-pages-cs/_static/image29.png)](nested-master-pages-cs/_static/image28.png)</span></span>

<span data-ttu-id="bd44d-306">**Рис. 10**. вложенная эталонная страница расширяет главную страницу верхнего уровня, добавляя инструкции для администратора.</span><span class="sxs-lookup"><span data-stu-id="bd44d-306">**Figure 10**: The Nested Master Page Extends the Top-Level Master Page to Include Instructions for the Administrator.</span></span> <span data-ttu-id="bd44d-307">([Щелкните, чтобы просмотреть изображение с полным размером](nested-master-pages-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="bd44d-307">([Click to view full-size image](nested-master-pages-cs/_static/image30.png))</span></span>

## <a name="step-5-updating-the-existing-content-pages-to-use-the-new-nested-master-page"></a><span data-ttu-id="bd44d-308">Шаг 5. обновление существующих страниц содержимого для использования новой вложенной главной страницы</span><span class="sxs-lookup"><span data-stu-id="bd44d-308">Step 5: Updating the Existing Content Pages to Use the New Nested Master Page</span></span>

<span data-ttu-id="bd44d-309">В любой момент, когда мы добавим новую страницу содержимого в раздел Администрирование, необходимо привязать ее к только что созданной главной странице `AdminNested.master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-309">Anytime we add a new content page to the Administration section we need to bind it to the `AdminNested.master` master page we just created.</span></span> <span data-ttu-id="bd44d-310">Но как насчет существующих страниц содержимого?</span><span class="sxs-lookup"><span data-stu-id="bd44d-310">But what about the existing content pages?</span></span> <span data-ttu-id="bd44d-311">В настоящее время все страницы содержимого на сайте являются производными от класса `BasePage`, который программно задает главную страницу страницы содержимого во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="bd44d-311">Currently, all content pages in the site derive from the `BasePage` class, which programmatically sets the content page's master page at runtime.</span></span> <span data-ttu-id="bd44d-312">Это не то, что нужно для страниц содержимого в разделе Администрирование.</span><span class="sxs-lookup"><span data-stu-id="bd44d-312">This is not the behavior we want for the content pages in the Administration section.</span></span> <span data-ttu-id="bd44d-313">Вместо этого мы хотим, чтобы эти страницы содержимого всегда использовали страницу `AdminNested.master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-313">Instead, we want these content pages to always use the `AdminNested.master` page.</span></span> <span data-ttu-id="bd44d-314">Для выбора правой страницы содержимого верхнего уровня во время выполнения будет использоваться вложенная эталонная страница.</span><span class="sxs-lookup"><span data-stu-id="bd44d-314">It will be the responsibility of the nested master page to choose the right top-level content page at runtime.</span></span>

<span data-ttu-id="bd44d-315">Чтобы лучше добиться такого поведения, создайте новый пользовательский класс базовой страницы с именем `AdminBasePage`, который расширяет класс `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-315">To best way to achieve this desired behavior is to create a new custom base page class named `AdminBasePage` that extends the `BasePage` class.</span></span> <span data-ttu-id="bd44d-316">`AdminBasePage` может переопределить `SetMasterPageFile` и задать для `MasterPageFile` `Page` объекта жестко заданное значение "~/админ/админнестед.Мастер".</span><span class="sxs-lookup"><span data-stu-id="bd44d-316">`AdminBasePage` can then override the `SetMasterPageFile` and set the `Page` object's `MasterPageFile` to the hard-coded value "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="bd44d-317">Таким образом, любая страница, производная от `AdminBasePage` будет использовать `AdminNested.master`, в то время как для любой страницы, производной от `BasePage`, ее свойство `MasterPageFile` будет динамически задано как "~/Сите.Мастер" или "~/Алтернате.Мастер" на основе значения переменной сеанса `MyMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-317">In this way, any page that derives from `AdminBasePage` will use `AdminNested.master`, whereas any page that derives from `BasePage` will have its `MasterPageFile` property set dynamically to either "~/Site.master" or "~/Alternate.master" based on the value of the `MyMasterPage` Session variable.</span></span>

<span data-ttu-id="bd44d-318">Начните с добавления нового файла класса в папку `App_Code` с именем `AdminBasePage.cs`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-318">Start by adding a new class file to the `App_Code` folder named `AdminBasePage.cs`.</span></span> <span data-ttu-id="bd44d-319">`AdminBasePage` расширить `BasePage`, а затем переопределить метод `SetMasterPageFile`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-319">Have `AdminBasePage` extend `BasePage` and then override the `SetMasterPageFile` method.</span></span> <span data-ttu-id="bd44d-320">В этом методе присвойте `MasterPageFile` значение "~/админ/админнестед.Мастер".</span><span class="sxs-lookup"><span data-stu-id="bd44d-320">In that method assign the `MasterPageFile` the value "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="bd44d-321">После внесения этих изменений файл класса должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="bd44d-321">After making these changes your class file should look similar to the following:</span></span>

[!code-csharp[Main](nested-master-pages-cs/samples/sample11.cs)]

<span data-ttu-id="bd44d-322">Теперь необходимо, чтобы существующие страницы содержимого в разделе "Администрирование" были производными от `AdminBasePage` вместо `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-322">We now need to have the existing content pages in the Administration section derive from `AdminBasePage` instead of `BasePage`.</span></span> <span data-ttu-id="bd44d-323">Перейдите к файлу класса кода программной части для каждой страницы содержимого в папке `~/Admin` и внесите это изменение.</span><span class="sxs-lookup"><span data-stu-id="bd44d-323">Go to the code-behind class file for each content page in the `~/Admin` folder and make this change.</span></span> <span data-ttu-id="bd44d-324">Например, в `~/Admin/Default.aspx` вы измените объявление класса кода программной части из:</span><span class="sxs-lookup"><span data-stu-id="bd44d-324">For example, in `~/Admin/Default.aspx` you'd change the code-behind class declaration from:</span></span>

[!code-csharp[Main](nested-master-pages-cs/samples/sample12.cs)]

<span data-ttu-id="bd44d-325">на:</span><span class="sxs-lookup"><span data-stu-id="bd44d-325">To:</span></span>

[!code-csharp[Main](nested-master-pages-cs/samples/sample13.cs)]

<span data-ttu-id="bd44d-326">На рис. 11 показано, как Главная страница верхнего уровня (`Site.master` или `Alternate.master`), вложенная Главная страница (`AdminNested.master`) и страницы содержимого раздела Администрирование связаны друг с другом.</span><span class="sxs-lookup"><span data-stu-id="bd44d-326">Figure 11 depicts how the top-level master page (`Site.master` or `Alternate.master`), the nested master page (`AdminNested.master`), and the Administration section content pages relate to one another.</span></span>

<span data-ttu-id="bd44d-327">[![вложенная эталонная страница определяет содержимое, относящееся к страницам в разделе "Администрирование"](nested-master-pages-cs/_static/image32.png)](nested-master-pages-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="bd44d-327">[![The Nested Master Page Defines Content Specific to the Pages in the Administration Section](nested-master-pages-cs/_static/image32.png)](nested-master-pages-cs/_static/image31.png)</span></span>

<span data-ttu-id="bd44d-328">**Рис. 11**. вложенная эталонная страница определяет содержимое, относящееся к страницам в разделе "Администрирование" ([щелкните, чтобы просмотреть изображение с полным размером](nested-master-pages-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="bd44d-328">**Figure 11**: The Nested Master Page Defines Content Specific to the Pages in the Administration Section ([Click to view full-size image](nested-master-pages-cs/_static/image33.png))</span></span>

## <a name="step-6-mirroring-the-master-pages-public-methods-and-properties"></a><span data-ttu-id="bd44d-329">Шаг 6. зеркальное отображение открытых методов и свойств главной страницы</span><span class="sxs-lookup"><span data-stu-id="bd44d-329">Step 6: Mirroring the Master Page's Public Methods and Properties</span></span>

<span data-ttu-id="bd44d-330">Помните, что страницы `~/Admin/AddProduct.aspx` и `~/Admin/Products.aspx` взаимодействуют программно с главной страницей: `~/Admin/AddProduct.aspx` вызывает открытый метод `RefreshRecentProductsGrid` главной страницы и задает его свойство `GridMessageText`; `~/Admin/Products.aspx` имеет обработчик событий для события `PricesDoubled`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-330">Recall that the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages interact programmatically with the master page: `~/Admin/AddProduct.aspx` calls the master page's public `RefreshRecentProductsGrid` method and sets its `GridMessageText` property; `~/Admin/Products.aspx` has an event handler for the `PricesDoubled` event.</span></span> <span data-ttu-id="bd44d-331">В предыдущем учебном курсе мы создали абстрактный `BaseMasterPage` класс, который определил эти открытые члены.</span><span class="sxs-lookup"><span data-stu-id="bd44d-331">In the preceding tutorial we created an abstract `BaseMasterPage` class that defined these public members.</span></span>

<span data-ttu-id="bd44d-332">На страницах `~/Admin/AddProduct.aspx` и `~/Admin/Products.aspx` предполагается, что их Главная страница является производной от класса `BaseMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-332">The `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages assume that their master page derives from the `BaseMasterPage` class.</span></span> <span data-ttu-id="bd44d-333">Однако страница `AdminNested.master`, в настоящее время, расширяет класс `System.Web.UI.MasterPage`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-333">The `AdminNested.master` page, however, currently extends the `System.Web.UI.MasterPage` class.</span></span> <span data-ttu-id="bd44d-334">В результате при посещении `~/Admin/Products.aspx` создается `InvalidCastException` с сообщением: "не удалось привести объект типа" ASP. admin\_админнестед\_Master "к типу" Басемастерпаже ".</span><span class="sxs-lookup"><span data-stu-id="bd44d-334">As a result, when visiting `~/Admin/Products.aspx` an `InvalidCastException` is thrown with the message: "Unable to cast object of type 'ASP.admin\_adminnested\_master' to type 'BaseMasterPage'."</span></span>

<span data-ttu-id="bd44d-335">Чтобы устранить эту проблему, необходимо расширить `BaseMasterPage`класса кода программной части `AdminNested.master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-335">To fix this we need to have the `AdminNested.master` code-behind class extend `BaseMasterPage`.</span></span> <span data-ttu-id="bd44d-336">Обновите объявление класса кода программной части вложенной главной страницы из:</span><span class="sxs-lookup"><span data-stu-id="bd44d-336">Update the nested master page's code-behind class declaration from:</span></span>

[!code-csharp[Main](nested-master-pages-cs/samples/sample14.cs)]

<span data-ttu-id="bd44d-337">на:</span><span class="sxs-lookup"><span data-stu-id="bd44d-337">To:</span></span>

[!code-csharp[Main](nested-master-pages-cs/samples/sample15.cs)]

<span data-ttu-id="bd44d-338">Мы еще не сделали этого.</span><span class="sxs-lookup"><span data-stu-id="bd44d-338">We're not done yet.</span></span> <span data-ttu-id="bd44d-339">Поскольку класс `BaseMasterPage` является абстрактным, необходимо переопределить элементы `abstract`, `RefreshRecentProductsGrid` и `GridMessageText`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-339">Because the `BaseMasterPage` class is abstract, we need to override the `abstract` members, `RefreshRecentProductsGrid` and `GridMessageText`.</span></span> <span data-ttu-id="bd44d-340">Эти члены используются главными страницами верхнего уровня для обновления своих пользовательских интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="bd44d-340">These members are used by the top-level master pages to update their user interfaces.</span></span> <span data-ttu-id="bd44d-341">(На самом деле, только Главная страница `Site.master` использует эти методы, хотя обе главные страницы верхнего уровня реализуют эти методы, так как оба расширения `BaseMasterPage`.)</span><span class="sxs-lookup"><span data-stu-id="bd44d-341">(Actually, only the `Site.master` master page uses these methods, although both top-level master pages implement these methods, since both extend `BaseMasterPage`.)</span></span>

<span data-ttu-id="bd44d-342">Хотя нам нужно реализовать эти члены в `AdminNested.master`, все эти реализации должны просто вызвать тот же элемент на главной странице верхнего уровня, который используется вложенной главной страницей.</span><span class="sxs-lookup"><span data-stu-id="bd44d-342">While we need to implement these members in `AdminNested.master`, all these implementations need to do is simply call the same member in the top-level master page used by the nested master page.</span></span> <span data-ttu-id="bd44d-343">Например, когда страница содержимого в разделе Администрирование вызывает метод `RefreshRecentProductsGrid` для вложенной главной страницы, вся вложенная Главная страница должна, в свою очередь, вызывать метод `Site.master` или `Alternate.master``RefreshRecentProductsGrid`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-343">For instance, when a content page in the Administration section calls the nested master page's `RefreshRecentProductsGrid` method, all the nested master page needs to do is, in turn, call `Site.master` or `Alternate.master`'s `RefreshRecentProductsGrid` method.</span></span>

<span data-ttu-id="bd44d-344">Чтобы добиться этого, начните с добавления следующей директивы `@MasterType` в начало `AdminNested.master`:</span><span class="sxs-lookup"><span data-stu-id="bd44d-344">To achieve this, start by adding the following `@MasterType` directive to the top of `AdminNested.master`:</span></span>

[!code-aspx[Main](nested-master-pages-cs/samples/sample16.aspx)]

<span data-ttu-id="bd44d-345">Помните, что директива `@MasterType` добавляет строго типизированное свойство в класс кода программной части с именем `Master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-345">Recall that the `@MasterType` directive adds a strongly-typed property to the code-behind class named `Master`.</span></span> <span data-ttu-id="bd44d-346">Затем переопределите `RefreshRecentProductsGrid` и `GridMessageText` члены и просто делегируйте вызов соответствующему методу `Master`:</span><span class="sxs-lookup"><span data-stu-id="bd44d-346">Then override the `RefreshRecentProductsGrid` and `GridMessageText` members and simply delegate the call to the `Master`'s corresponding method:</span></span>

[!code-csharp[Main](nested-master-pages-cs/samples/sample17.cs)]

<span data-ttu-id="bd44d-347">Используя этот код, вы сможете посетить и использовать страницы содержимого в разделе Администрирование.</span><span class="sxs-lookup"><span data-stu-id="bd44d-347">With this code in place, you should be able to visit and use the content pages in the Administration section.</span></span> <span data-ttu-id="bd44d-348">На рис. 12 показана страница `~/Admin/Products.aspx` при просмотре в браузере.</span><span class="sxs-lookup"><span data-stu-id="bd44d-348">Figure 12 shows the `~/Admin/Products.aspx` page when viewed through a browser.</span></span> <span data-ttu-id="bd44d-349">Как видите, страница содержит окно инструкции по администрированию, которое определено во вложенной главной странице.</span><span class="sxs-lookup"><span data-stu-id="bd44d-349">As you can see, the page includes the Administration Instructions box, which is defined in the nested master page.</span></span>

<span data-ttu-id="bd44d-350">[![страниц содержимого в разделе "Администрирование" включает инструкции в верхней части каждой страницы.](nested-master-pages-cs/_static/image35.png)](nested-master-pages-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="bd44d-350">[![The Content Pages in the Administration Section Include Instructions at the Top of Each Page](nested-master-pages-cs/_static/image35.png)](nested-master-pages-cs/_static/image34.png)</span></span>

<span data-ttu-id="bd44d-351">**Рис. 12**. страницы содержимого в разделе "Администрирование" содержат инструкции в верхней части каждой страницы ([щелкните, чтобы просмотреть изображение с полным размером](nested-master-pages-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="bd44d-351">**Figure 12**: The Content Pages in the Administration Section Include Instructions at the Top of Each Page ([Click to view full-size image](nested-master-pages-cs/_static/image36.png))</span></span>

## <a name="step-7-using-the-appropriate-top-level-master-page-at-runtime"></a><span data-ttu-id="bd44d-352">Шаг 7. использование соответствующей главной страницы верхнего уровня во время выполнения</span><span class="sxs-lookup"><span data-stu-id="bd44d-352">Step 7: Using the Appropriate Top-Level Master Page at Runtime</span></span>

<span data-ttu-id="bd44d-353">Хотя все страницы содержимого в разделе Администрирование полностью работоспособны, все они используют одну главную страницу верхнего уровня и игнорируют главную страницу, выбранную пользователем на `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-353">While all the content pages in the Administration section are fully functional, they all use the same top-level master page and ignore the master page selected by the user at `ChooseMasterPage.aspx`.</span></span> <span data-ttu-id="bd44d-354">Это происходит из-за того, что вложенная эталонная страница имеет свойство `MasterPageFile` статически установлено в `Site.master` в своей директиве `<%@ Master %>`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-354">This behavior is due to the fact that the nested master page has its `MasterPageFile` property statically set to `Site.master` in its `<%@ Master %>` directive.</span></span>

<span data-ttu-id="bd44d-355">Чтобы использовать главную страницу верхнего уровня, выбранную конечным пользователем, необходимо задать для свойства `MasterPageFile` `AdminNested.master`значение в переменной сеанса `MyMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-355">To use the top-level master page selected by the end user we need to set the `AdminNested.master`'s `MasterPageFile` property to the value in the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="bd44d-356">Так как мы устанавливаем свойства страниц содержимого `MasterPageFile` в `BasePage`, можно подумать, что мы бы настроили свойство `MasterPageFile` вложенной главной страницы в `BaseMasterPage` или в классе кода программной части `AdminNested.master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-356">Because we set the content pages' `MasterPageFile` properties in `BasePage`, you may think that we would set the nested master page's `MasterPageFile` property in `BaseMasterPage` or in the `AdminNested.master`'s code-behind class.</span></span> <span data-ttu-id="bd44d-357">Однако это не сработает, поскольку необходимо задать свойство `MasterPageFile` в конце этапа предварительной инициализации.</span><span class="sxs-lookup"><span data-stu-id="bd44d-357">This won't work, however, because we need to have set the `MasterPageFile` property by the end of the PreInit stage.</span></span> <span data-ttu-id="bd44d-358">Самое раннее время, которое мы можем программно коснуться в жизненном цикле страницы с главной страницы, — этап init (который выполняется после этапа предварительной инициализации).</span><span class="sxs-lookup"><span data-stu-id="bd44d-358">The earliest time that we can programmatically tap into the page lifecycle from a master page is the Init stage (which occurs after the PreInit stage).</span></span>

<span data-ttu-id="bd44d-359">Поэтому необходимо задать свойство `MasterPageFile` для вложенной главной страницы на страницах содержимого.</span><span class="sxs-lookup"><span data-stu-id="bd44d-359">Therefore, we need to set the nested master page's `MasterPageFile` property from the content pages.</span></span> <span data-ttu-id="bd44d-360">Только страницы содержимого, использующие главную страницу `AdminNested.master`, являются производными от `AdminBasePage`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-360">The only content pages that use the `AdminNested.master` master page derive from `AdminBasePage`.</span></span> <span data-ttu-id="bd44d-361">Поэтому эту логику можно разместить там.</span><span class="sxs-lookup"><span data-stu-id="bd44d-361">Therefore, we can put this logic there.</span></span> <span data-ttu-id="bd44d-362">На шаге 5 мы переопределили метод `SetMasterPageFile`, установив для свойства `MasterPageFile` объекта `Page` значение "~/админ/админнестед.Мастер".</span><span class="sxs-lookup"><span data-stu-id="bd44d-362">In Step 5 we overrode the `SetMasterPageFile` method, setting the `Page` object's `MasterPageFile` property to "~/Admin/AdminNested.master".</span></span> <span data-ttu-id="bd44d-363">Обновите `SetMasterPageFile`, чтобы задать для свойства `MasterPageFile` главной страницы результат, хранящийся в сеансе:</span><span class="sxs-lookup"><span data-stu-id="bd44d-363">Update `SetMasterPageFile` to also set the master page's `MasterPageFile` property to the result stored in Session:</span></span>

[!code-csharp[Main](nested-master-pages-cs/samples/sample18.cs)]

<span data-ttu-id="bd44d-364">Метод `GetMasterPageFileFromSession`, добавленный в класс `BasePage` в предыдущем руководстве, возвращает соответствующий путь к файлу главной страницы на основе значения переменной сеанса.</span><span class="sxs-lookup"><span data-stu-id="bd44d-364">The `GetMasterPageFileFromSession` method, which we added to the `BasePage` class in the preceding tutorial, returns the appropriate master page file path based on the Session variable value.</span></span>

<span data-ttu-id="bd44d-365">После этого изменения выбор главной страницы пользователя переносится в раздел Администрирование.</span><span class="sxs-lookup"><span data-stu-id="bd44d-365">With this change in place, the user's master page selection carries over to the Administration section.</span></span> <span data-ttu-id="bd44d-366">На рис. 13 показана та же страница, что и на рис. 12, но после того, как пользователь изменил выбор главной страницы на `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="bd44d-366">Figure 13 shows the same page as Figure 12, but after the user has changed their master page selection to `Alternate.master`.</span></span>

<span data-ttu-id="bd44d-367">[![на странице вложенного администрирования используется Главная страница верхнего уровня, выбранная пользователем.](nested-master-pages-cs/_static/image38.png)](nested-master-pages-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="bd44d-367">[![The Nested Administration Page Uses the Top-Level Master Page Selected by the User](nested-master-pages-cs/_static/image38.png)](nested-master-pages-cs/_static/image37.png)</span></span>

<span data-ttu-id="bd44d-368">**Рис. 13**. страница вложенного администрирования использует главную страницу верхнего уровня, выбранную пользователем ([щелкните, чтобы просмотреть изображение с полным размером](nested-master-pages-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="bd44d-368">**Figure 13**: The Nested Administration Page Uses the Top-Level Master Page Selected by the User ([Click to view full-size image](nested-master-pages-cs/_static/image39.png))</span></span>

## <a name="summary"></a><span data-ttu-id="bd44d-369">Сводка</span><span class="sxs-lookup"><span data-stu-id="bd44d-369">Summary</span></span>

<span data-ttu-id="bd44d-370">Подобно тому, как страницы содержимого могут быть привязаны к главной странице, можно создавать вложенные главные страницы, применяя к родительской главной странице привязку дочерней главной страницы.</span><span class="sxs-lookup"><span data-stu-id="bd44d-370">Much like how content pages can bind to a master page, it is possible to create nested master pages by having a child master page bind to a parent master page.</span></span> <span data-ttu-id="bd44d-371">Дочерняя главная страница может определять элементы управления содержимым для каждого из его родительских элементов управления ContentPlaceHolder. Затем он может добавить собственные элементы управления ContentPlaceHolder (а также другую разметку) к этим элементам управления содержимым.</span><span class="sxs-lookup"><span data-stu-id="bd44d-371">The child master page may define Content controls for each of its parent's ContentPlaceHolders; it can then add its own ContentPlaceHolder controls (as well as other markup) to these Content controls.</span></span> <span data-ttu-id="bd44d-372">Вложенные главные страницы весьма полезны в больших веб-приложениях, где все страницы совместно используют внешний вид, но некоторые разделы узла нуждаются в уникальных настройках.</span><span class="sxs-lookup"><span data-stu-id="bd44d-372">Nested master pages are quite useful in large web applications where all pages share an overarching look and feel, yet certain sections of the site require unique customizations.</span></span>

<span data-ttu-id="bd44d-373">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="bd44d-373">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="bd44d-374">Дополнительные материалы</span><span class="sxs-lookup"><span data-stu-id="bd44d-374">Further Reading</span></span>

<span data-ttu-id="bd44d-375">Дополнительные сведения о разделах, обсуждаемых в этом руководстве, см. в следующих ресурсах:</span><span class="sxs-lookup"><span data-stu-id="bd44d-375">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="bd44d-376">Вложенные главные страницы ASP.NET</span><span class="sxs-lookup"><span data-stu-id="bd44d-376">Nested ASP.NET Master Pages</span></span>](https://msdn.microsoft.com/library/x2b3ktt7.aspx)
- [<span data-ttu-id="bd44d-377">Советы по вложенным главным страницам и времени разработки VS 2005</span><span class="sxs-lookup"><span data-stu-id="bd44d-377">Tips for Nested Master Pages and VS 2005 Design-Time</span></span>](https://weblogs.asp.net/scottgu/archive/2005/11/11/430382.aspx)
- [<span data-ttu-id="bd44d-378">Поддержка вложенных главных страниц VS 2008</span><span class="sxs-lookup"><span data-stu-id="bd44d-378">VS 2008 Nested Master Page Support</span></span>](https://weblogs.asp.net/scottgu/archive/2007/07/09/vs-2008-nested-master-page-support.aspx)

### <a name="about-the-author"></a><span data-ttu-id="bd44d-379">Об авторе</span><span class="sxs-lookup"><span data-stu-id="bd44d-379">About the Author</span></span>

<span data-ttu-id="bd44d-380">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор нескольких книг по ASP/ASP. NET и основатель 4GuysFromRolla.com, работал с веб-технологиями майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="bd44d-380">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="bd44d-381">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="bd44d-381">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="bd44d-382">Его последняя книга — [*Sams обучать себя ASP.NET 3,5 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="bd44d-382">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="bd44d-383">Скотт можно получить по адресу [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) или через свой блог по адресу [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="bd44d-383">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="bd44d-384">Специальная благодарность</span><span class="sxs-lookup"><span data-stu-id="bd44d-384">Special Thanks To</span></span>

<span data-ttu-id="bd44d-385">Эта серия руководств была рассмотрена многими полезными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="bd44d-385">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="bd44d-386">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="bd44d-386">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="bd44d-387">Если да, расположите строку в [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="bd44d-387">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="bd44d-388">[Назад](specifying-the-master-page-programmatically-cs.md)
> [Вперед](creating-a-site-wide-layout-using-master-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="bd44d-388">[Previous](specifying-the-master-page-programmatically-cs.md)
[Next](creating-a-site-wide-layout-using-master-pages-vb.md)</span></span>
