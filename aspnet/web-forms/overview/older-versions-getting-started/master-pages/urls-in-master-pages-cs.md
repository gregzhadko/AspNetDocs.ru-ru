---
uid: web-forms/overview/older-versions-getting-started/master-pages/urls-in-master-pages-cs
title: URL-адреса в главныхC#страницах () | Документация Майкрософт
author: rick-anderson
description: Решает, как могут быть нарушены URL-адреса на главной странице из-за того, что файл главной страницы находится в другом относительном каталоге, чем на странице содержимого. Выполняется поиск в переуровне...
ms.author: riande
ms.date: 06/10/2008
ms.assetid: 48b58a18-5ea4-468c-b326-f35331b3e1e9
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/urls-in-master-pages-cs
msc.type: authoredcontent
ms.openlocfilehash: 2551a5361256234883bb37e46e794037284445a4
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74640975"
---
# <a name="urls-in-master-pages-c"></a><span data-ttu-id="4085c-104">URL-адреса на эталонных страницах (C#)</span><span class="sxs-lookup"><span data-stu-id="4085c-104">URLs in Master Pages (C#)</span></span>

<span data-ttu-id="4085c-105">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="4085c-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="4085c-106">[Скачать код](https://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_04_CS.zip) или [скачать PDF](https://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_04_CS.pdf)</span><span class="sxs-lookup"><span data-stu-id="4085c-106">[Download Code](https://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_04_CS.zip) or [Download PDF](https://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_04_CS.pdf)</span></span>

> <span data-ttu-id="4085c-107">Решает, как могут быть нарушены URL-адреса на главной странице из-за того, что файл главной страницы находится в другом относительном каталоге, чем на странице содержимого.</span><span class="sxs-lookup"><span data-stu-id="4085c-107">Addresses how URLs in the master page can break due to the master page file being in a different relative directory than the content page.</span></span> <span data-ttu-id="4085c-108">Выполняет поиск перенаправленных URL-адресов через ~ в декларативном синтаксисе и программно с помощью Ресолвеурл и Ресолвеклиентурл.</span><span class="sxs-lookup"><span data-stu-id="4085c-108">Looks at rebasing URLs via ~ in the declarative syntax and using ResolveUrl and ResolveClientUrl programmatically.</span></span> <span data-ttu-id="4085c-109">(Также взгляните на</span><span class="sxs-lookup"><span data-stu-id="4085c-109">(Also look at</span></span>

## <a name="introduction"></a><span data-ttu-id="4085c-110">Введение</span><span class="sxs-lookup"><span data-stu-id="4085c-110">Introduction</span></span>

<span data-ttu-id="4085c-111">Во всех примерах, которые мы видели до сих пор, страницы главного и содержимого находятся в той же папке (корневая папка веб-сайта).</span><span class="sxs-lookup"><span data-stu-id="4085c-111">In all the examples we've seen thus far, the master and content pages have been located in the same folder (the website's root folder).</span></span> <span data-ttu-id="4085c-112">Но нет причин, по которым Главная страница и страницы содержимого должны находиться в одной папке.</span><span class="sxs-lookup"><span data-stu-id="4085c-112">But there's no reason why the master and content pages must be in the same folder.</span></span> <span data-ttu-id="4085c-113">Конечно, можно создавать страницы содержимого во вложенных папках.</span><span class="sxs-lookup"><span data-stu-id="4085c-113">You can certainly create content pages in subfolders.</span></span> <span data-ttu-id="4085c-114">Аналогичным образом вы можете создать папку `~/MasterPages/`, в которую будут размещены главные страницы сайта.</span><span class="sxs-lookup"><span data-stu-id="4085c-114">Similarly, you might create a `~/MasterPages/` folder where you place your site's master pages.</span></span>

<span data-ttu-id="4085c-115">Одна из потенциальных проблем, связанная с размещением главных и страниц содержимого в разных папках, заключается в нарушении URL-адресов</span><span class="sxs-lookup"><span data-stu-id="4085c-115">One potential issue with placing master and content pages in different folders involves broken URLs.</span></span> <span data-ttu-id="4085c-116">Если Главная страница содержит относительные URL-адреса в гиперссылках, изображениях или других элементах, ссылка будет недействительной для страниц содержимого, расположенных в другой папке.</span><span class="sxs-lookup"><span data-stu-id="4085c-116">If the master page contains relative URLs in hyperlinks, images, or other elements, the link will be invalid for content pages that reside in a different folder.</span></span> <span data-ttu-id="4085c-117">В этом учебнике рассматривается источник этой проблемы, а также способы их обхода.</span><span class="sxs-lookup"><span data-stu-id="4085c-117">In this tutorial we examine the source of this problem as well as workarounds.</span></span>

## <a name="the-problem-with-relative-urls"></a><span data-ttu-id="4085c-118">Проблема с относительными URL-адресами</span><span class="sxs-lookup"><span data-stu-id="4085c-118">The Problem with Relative URLs</span></span>

<span data-ttu-id="4085c-119">Ссылка на веб-страницу считается *относительным URL-адресом* , если расположение ресурса, на который он указывает, определяется относительно расположения веб-страницы в структуре папок веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="4085c-119">A URL on a web page is said to be a *relative URL* if the location of the resource it points to is relative to the web page's location in the website's folder structure.</span></span> <span data-ttu-id="4085c-120">Любой URL-адрес, не начинающийся с начальной косой черты (`/`) или протокола (например, `http://`), является относительным, так как он разрешается браузером на основе расположения веб-страницы, содержащей URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="4085c-120">Any URL that does not start with a leading forward slash (`/`) or a protocol (such as `http://`) is relative because it is resolved by the browser based on the location of the web page that contains the URL.</span></span>

<span data-ttu-id="4085c-121">Например, наш веб-сайт имеет папку `~/Images/` с одним файлом изображения `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="4085c-121">For example, our website has an `~/Images/` folder with a single image file, `PoweredByASPNET.gif`.</span></span> <span data-ttu-id="4085c-122">Файл главной страницы `Site.master` содержит элемент `<img>` в области `footerContent` со следующей разметкой:</span><span class="sxs-lookup"><span data-stu-id="4085c-122">The master page file `Site.master` has an `<img>` element in the `footerContent` region with the following markup:</span></span>

[!code-html[Main](urls-in-master-pages-cs/samples/sample1.html)]

<span data-ttu-id="4085c-123">Значение атрибута `src` в элементе `<img>` является относительным URL-адресом, так как не начинается с `/` или `http://`.</span><span class="sxs-lookup"><span data-stu-id="4085c-123">The `src` attribute value in the `<img>` element is a relative URL because it does not start with `/` or `http://`.</span></span> <span data-ttu-id="4085c-124">Вкратце, значение атрибута `src` указывает обозревателю искать в подпапке `Images` файла с именем `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="4085c-124">In short, the `src` attribute value tells the browser to look in the `Images` subfolder for a file named `PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="4085c-125">При посещении страницы содержимого приведенная выше разметка отправляется непосредственно в браузер.</span><span class="sxs-lookup"><span data-stu-id="4085c-125">When visiting a content page, the above markup is sent directly to the browser.</span></span> <span data-ttu-id="4085c-126">Уделите время посетить `About.aspx` и просмотреть исходный HTML-код, отправленный в браузер.</span><span class="sxs-lookup"><span data-stu-id="4085c-126">Take a moment to visit `About.aspx` and view the HTML source sent to the browser.</span></span> <span data-ttu-id="4085c-127">Вы обнаружите, что та же разметка на главной странице была отправлена в браузер.</span><span class="sxs-lookup"><span data-stu-id="4085c-127">You will find that the exact same markup in the master page was sent to the browser.</span></span>

[!code-html[Main](urls-in-master-pages-cs/samples/sample2.html)]

<span data-ttu-id="4085c-128">Если страница содержимого находится в корневой папке (как и `About.aspx`), все работает должным образом, так как существует `Images` вложенная папка относительно корневой папки.</span><span class="sxs-lookup"><span data-stu-id="4085c-128">If the content page is in the root folder (as is `About.aspx`) everything works as expected because there is an `Images` subfolder relative to the root folder.</span></span> <span data-ttu-id="4085c-129">Тем не менее, если страница содержимого находится в папке, отличной от папки главной страницы, она разбивается на страницы.</span><span class="sxs-lookup"><span data-stu-id="4085c-129">However, things break down if the content page is in a different folder than the master page.</span></span> <span data-ttu-id="4085c-130">Чтобы проиллюстрировать это, создайте вложенную папку с именем `Admin`.</span><span class="sxs-lookup"><span data-stu-id="4085c-130">To illustrate this, create a subfolder named `Admin`.</span></span> <span data-ttu-id="4085c-131">Затем добавьте страницу содержимого с именем `Default.aspx` в папку `Admin` и убедитесь, что новая страница привязывается к главной странице `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="4085c-131">Next, add a content page named `Default.aspx` to the `Admin` folder, making sure to bind the new page to the `Site.master` master page.</span></span>

> [!NOTE]
> <span data-ttu-id="4085c-132">В разделе [*Указание заголовка, Meta-тегов и других заголовков HTML в*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md) учебнике по главной странице мы создали пользовательский класс базовой страницы с именем `BasePage`, который автоматически задает заголовок страницы содержимого (если он не был явно назначен).</span><span class="sxs-lookup"><span data-stu-id="4085c-132">In the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md) tutorial we created a custom base page class named `BasePage` that automatically set the content page's title (if it was not explicitly assigned).</span></span> <span data-ttu-id="4085c-133">Не забудьте создать класс кода программной части созданной страницы от `BasePage`, чтобы он мог использовать эту функцию.</span><span class="sxs-lookup"><span data-stu-id="4085c-133">Don't forget to have the newly created page's code-behind class derive from `BasePage` so that it can utilize this functionality.</span></span>

<span data-ttu-id="4085c-134">После создания этой страницы содержимого обозреватель решений должны выглядеть примерно так, как показано на рис. 1.</span><span class="sxs-lookup"><span data-stu-id="4085c-134">After you have created this content page, your Solution Explorer should look similar to Figure 1.</span></span>

![В проект добавлены Новая папка и страница ASP.NET](urls-in-master-pages-cs/_static/image1.png)

<span data-ttu-id="4085c-136">**Рис. 01**. в проект добавлены Новая папка и страница ASP.NET</span><span class="sxs-lookup"><span data-stu-id="4085c-136">**Figure 01**: A New Folder and ASP.NET Page Have Been Added to the Project</span></span>

<span data-ttu-id="4085c-137">Затем обновите файл `Web.sitemap`, включив в него новую запись `<siteMapNode>` для этого занятия.</span><span class="sxs-lookup"><span data-stu-id="4085c-137">Next, update the `Web.sitemap` file to include a new `<siteMapNode>` entry for this lesson.</span></span> <span data-ttu-id="4085c-138">В следующем коде XML показана полная разметка `Web.sitemap`, которая теперь включает в себя добавление третьего элемента `<siteMapNode>`.</span><span class="sxs-lookup"><span data-stu-id="4085c-138">The following XML shows the complete `Web.sitemap` markup, which now includes the addition of a third `<siteMapNode>` element.</span></span>

[!code-xml[Main](urls-in-master-pages-cs/samples/sample3.xml)]

<span data-ttu-id="4085c-139">Только что созданная страница `Default.aspx` должна иметь четыре элемента управления содержимым, соответствующие четырем элементов управления ContentPlaceHolder в `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="4085c-139">The newly created `Default.aspx` page should have four Content controls corresponding to the four ContentPlaceHolders in `Site.master`.</span></span> <span data-ttu-id="4085c-140">Добавьте некоторый текст в элемент управления содержимым, ссылающийся на `MainContent` ContentPlaceHolder, а затем откройте страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="4085c-140">Add some text to the Content control referencing the `MainContent` ContentPlaceHolder and then visit the page through a browser.</span></span> <span data-ttu-id="4085c-141">Как показано на рис. 2, браузер не может найти файл изображения `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="4085c-141">As Figure 2 shows, the browser cannot find the `PoweredByASPNET.gif` image file.</span></span> <span data-ttu-id="4085c-142">Что здесь происходит?</span><span class="sxs-lookup"><span data-stu-id="4085c-142">What's going on here?</span></span>

<span data-ttu-id="4085c-143">Страница содержимого `~/Admin/Default.aspx` отправляет тот же код HTML для `footerContent` региона, который был `About.aspx` страницей:</span><span class="sxs-lookup"><span data-stu-id="4085c-143">The `~/Admin/Default.aspx` content page is sent the same HTML for the `footerContent` region as was the `About.aspx` page:</span></span>

[!code-html[Main](urls-in-master-pages-cs/samples/sample4.html)]

<span data-ttu-id="4085c-144">Так как атрибут `src` элемента `<img>` является относительным URL-адресом, браузер пытается найти папку `Images` относительно расположения папки на странице.</span><span class="sxs-lookup"><span data-stu-id="4085c-144">Because the `<img>` element's `src` attribute is a relative URL, the browser attempts to look for an `Images` folder relative to the web page's folder location.</span></span> <span data-ttu-id="4085c-145">Иными словами, браузер ищет файл изображения `Admin/Images/PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="4085c-145">In other words, the browser is looking for the image file `Admin/Images/PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="4085c-146">[![не удается найти файл изображения Повередбяспнет. gif](urls-in-master-pages-cs/_static/image3.png)](urls-in-master-pages-cs/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="4085c-146">[![The PoweredByASPNET.gif Image File Cannot Be Found](urls-in-master-pages-cs/_static/image3.png)](urls-in-master-pages-cs/_static/image2.png)</span></span>

<span data-ttu-id="4085c-147">**Рис. 02**. не удается найти файл изображения `PoweredByASPNET.gif` ([щелкните, чтобы просмотреть изображение с полным размером](urls-in-master-pages-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="4085c-147">**Figure 02**: The `PoweredByASPNET.gif` Image File Cannot Be Found  ([Click to view full-size image](urls-in-master-pages-cs/_static/image4.png))</span></span>

### <a name="replacing-relative-urls-with-absolute-urls"></a><span data-ttu-id="4085c-148">Замена относительных URL-адресов абсолютными URL-адресами</span><span class="sxs-lookup"><span data-stu-id="4085c-148">Replacing Relative URLs with Absolute URLs</span></span>

<span data-ttu-id="4085c-149">Противоположностью относительного URL-адреса является *абсолютный URL-адрес*, который начинается с косой черты (`/`) или протокола, например `http://`.</span><span class="sxs-lookup"><span data-stu-id="4085c-149">The opposite of a relative URL is an *absolute URL*, which is one that starts with a forward slash (`/`) or a protocol such as `http://`.</span></span> <span data-ttu-id="4085c-150">Поскольку абсолютный URL-адрес указывает расположение ресурса из известной фиксированной точки, тот же абсолютный URL-адрес действителен на любой веб-странице, независимо от расположения веб-страницы в структуре папок веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="4085c-150">Because an absolute URL specifies the location of a resource from a known fixed point, the same absolute URL is valid in any web page, regardless of the web page's location in the website's folder structure.</span></span>

<span data-ttu-id="4085c-151">Чтобы исправить неработающий образ, показанный на рис. 2, необходимо обновить атрибут `src` элемента `<img>`, чтобы он использовал абсолютный URL-адрес вместо относительного.</span><span class="sxs-lookup"><span data-stu-id="4085c-151">To remedy the broken image shown in Figure 2, we need to update the `<img>` element's `src` attribute so that it uses an absolute URL instead of a relative one.</span></span> <span data-ttu-id="4085c-152">Чтобы определить правильный абсолютный URL-адрес, посетите одну из веб-страниц на веб-сайте и изучите адресную строку.</span><span class="sxs-lookup"><span data-stu-id="4085c-152">To determine the correct absolute URL, visit one of the web pages in your website and examine the Address bar.</span></span> <span data-ttu-id="4085c-153">Как показано в адресной строке на рис. 2, полный путь к веб-приложению `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_CS/`.</span><span class="sxs-lookup"><span data-stu-id="4085c-153">As the Address bar in Figure 2 shows, the fully qualified path to the web application is `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_CS/`.</span></span> <span data-ttu-id="4085c-154">Поэтому можно обновить атрибут `src` элемента `<img>` до одного из следующих двух абсолютных URL-адресов:</span><span class="sxs-lookup"><span data-stu-id="4085c-154">Therefore, we could update the `<img>` element's `src` attribute to either of the following two absolute URLs:</span></span>

- `/ASPNET_MasterPages_Tutorial_04_CS/Images/PoweredByASPNET.gif`
- `http://localhost:3908/ASPNET_MasterPages_Tutorial_04_CS/Images/PoweredByASPNET.gif`

<span data-ttu-id="4085c-155">Уделите время, чтобы обновить атрибут `src` элемента `<img>` до абсолютного URL-адреса, используя одну из приведенных выше форм, а затем посетить страницу `~/Admin/Default.aspx` в браузере.</span><span class="sxs-lookup"><span data-stu-id="4085c-155">Take a moment to update the `<img>` element's `src` attribute to an absolute URL using one of the forms shown above and then visit the `~/Admin/Default.aspx` page through a browser.</span></span> <span data-ttu-id="4085c-156">На этот раз браузер будет правильно находить и отображать файл изображения `PoweredByASPNET.gif` (см. рис. 3).</span><span class="sxs-lookup"><span data-stu-id="4085c-156">This time the browser will correctly find and display the `PoweredByASPNET.gif` image file (see Figure 3).</span></span>

<span data-ttu-id="4085c-157">[![изображение Повередбяспнет. gif теперь отображается](urls-in-master-pages-cs/_static/image6.png)](urls-in-master-pages-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="4085c-157">[![The PoweredByASPNET.gif Image is Now Displayed](urls-in-master-pages-cs/_static/image6.png)](urls-in-master-pages-cs/_static/image5.png)</span></span>

<span data-ttu-id="4085c-158">**Рис. 03**. теперь отображается изображение `PoweredByASPNET.gif` ([щелкните, чтобы просмотреть изображение с полным размером](urls-in-master-pages-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="4085c-158">**Figure 03**: The `PoweredByASPNET.gif` Image is Now Displayed  ([Click to view full-size image](urls-in-master-pages-cs/_static/image7.png))</span></span>

<span data-ttu-id="4085c-159">Хотя жестко программировать в абсолютном URL-адресе, он тесно прикрепляет ваш код HTML к серверу и расположению папки веб-сайта, что может измениться.</span><span class="sxs-lookup"><span data-stu-id="4085c-159">While hard coding in the absolute URL works, it tightly couples your HTML to the website's server and folder location, which may change.</span></span> <span data-ttu-id="4085c-160">Использование абсолютного URL-адреса формы `http://localhost:3908/...` нестабильным, так как номер порта, предшествующий `localhost`, выбирается автоматически при запуске встроенного веб-сервера ASP.NET Development Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="4085c-160">Using an absolute URL of the form `http://localhost:3908/...` is brittle because the port number preceding `localhost` is selected automatically each time Visual Studio's built-in ASP.NET Development Web Server is started.</span></span> <span data-ttu-id="4085c-161">Аналогичным образом `http://localhost` часть допустима только при локальном тестировании.</span><span class="sxs-lookup"><span data-stu-id="4085c-161">Similarly, the `http://localhost` part is only valid when testing locally.</span></span> <span data-ttu-id="4085c-162">После развертывания кода на рабочем сервере база URL-адреса изменится на что-то другое, например `http://www.yourserver.com`.</span><span class="sxs-lookup"><span data-stu-id="4085c-162">Once the code is deployed to a production server, the URL base will change to something else, like `http://www.yourserver.com`.</span></span> <span data-ttu-id="4085c-163">Абсолютный URL-адрес в форме `/ASPNET_MasterPages_Tutorial_04_CS/...` также пострадает от того же хрупкости, так как часто этот путь к приложению отличается от сервера разработки и рабочих серверов.</span><span class="sxs-lookup"><span data-stu-id="4085c-163">The absolute URL in the form `/ASPNET_MasterPages_Tutorial_04_CS/...` also suffers from the same brittleness because oftentimes this application path differs between development and production servers.</span></span>

<span data-ttu-id="4085c-164">Хорошая новость заключается в том, что ASP.NET предлагает метод для создания допустимого относительного URL-адреса во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="4085c-164">The good news is that ASP.NET offers a method for generating a valid relative URL at runtime.</span></span>

## <a name="usingandresolveclienturl"></a><span data-ttu-id="4085c-165">Использование`~`и`ResolveClientUrl`</span><span class="sxs-lookup"><span data-stu-id="4085c-165">Using`~`and`ResolveClientUrl`</span></span>

<span data-ttu-id="4085c-166">Вместо того, чтобы жестко кодировать абсолютный URL-адрес, ASP.NET позволяет разработчикам страниц использовать тильду (`~`) для указания корневого каталога веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="4085c-166">Rather than hard code an absolute URL, ASP.NET allows page developers to use the tilde (`~`) to indicate the root of the web application.</span></span> <span data-ttu-id="4085c-167">Например, ранее в этом учебнике я использовал нотацию `~/Admin/Default.aspx` в тексте для ссылки на страницу `Default.aspx` в папке `Admin`.</span><span class="sxs-lookup"><span data-stu-id="4085c-167">For example, earlier in this tutorial I used the notation `~/Admin/Default.aspx` in the text to refer to the `Default.aspx` page in the `Admin` folder.</span></span> <span data-ttu-id="4085c-168">`~` указывает, что папка `Admin` является вложенной папкой корневого каталога веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="4085c-168">The `~` indicates that the `Admin` folder is a subfolder of the web application's root.</span></span>

<span data-ttu-id="4085c-169">[Метод`ResolveClientUrl`](https://msdn.microsoft.com/library/system.web.ui.control.resolveclienturl.aspx) `Control` класса принимает URL-адрес и изменяет его на относительный URL-адрес, соответствующий веб странице, на которой находится элемент управления.</span><span class="sxs-lookup"><span data-stu-id="4085c-169">The `Control` class's [`ResolveClientUrl` method](https://msdn.microsoft.com/library/system.web.ui.control.resolveclienturl.aspx) takes a URL and modifies it to a relative URL appropriate for the web page on which the control resides.</span></span> <span data-ttu-id="4085c-170">Например, вызов `ResolveClientUrl("~/Images/PoweredByASPNET.gif")` из `About.aspx` возвращает `Images/PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="4085c-170">For example, calling `ResolveClientUrl("~/Images/PoweredByASPNET.gif")` from `About.aspx` returns `Images/PoweredByASPNET.gif`.</span></span> <span data-ttu-id="4085c-171">Однако вызов его из `~/Admin/Default.aspx`возвращает `../Images/PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="4085c-171">Calling it from `~/Admin/Default.aspx`, however, returns `../Images/PoweredByASPNET.gif`.</span></span>

> [!NOTE]
> <span data-ttu-id="4085c-172">Поскольку все серверные элементы управления ASP.NET являются производными от класса `Control`, все серверные элементы управления имеют доступ к методу `ResolveClientUrl`.</span><span class="sxs-lookup"><span data-stu-id="4085c-172">Because all ASP.NET server controls derive from the `Control` class, all server controls have access to the `ResolveClientUrl` method.</span></span> <span data-ttu-id="4085c-173">Даже класс `Page` является производным от класса `Control`, что позволяет использовать этот метод непосредственно из классов кода программной части страниц ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="4085c-173">Even the `Page` class derives from the `Control` class, meaning that you can use this method directly from your ASP.NET pages' code-behind classes.</span></span>

### <a name="usingin-the-declarative-markup"></a><span data-ttu-id="4085c-174">Использование`~`в декларативной разметке</span><span class="sxs-lookup"><span data-stu-id="4085c-174">Using`~`in the Declarative Markup</span></span>

<span data-ttu-id="4085c-175">Некоторые веб-элементы управления ASP.NET включают свойства, связанные с URL-адресами: элемент управления HyperLink имеет свойство `NavigateUrl`; элемент управления "изображение" имеет свойство `ImageUrl`; и т. д.</span><span class="sxs-lookup"><span data-stu-id="4085c-175">Several ASP.NET Web controls include URL-related properties: the HyperLink control has a `NavigateUrl` property; the Image control has an `ImageUrl` property; and so on.</span></span> <span data-ttu-id="4085c-176">При подготовке к просмотру эти элементы управления передают значения свойств, связанные с URL-адресом, в `ResolveClientUrl`.</span><span class="sxs-lookup"><span data-stu-id="4085c-176">When rendered, these controls pass their URL-related property values to `ResolveClientUrl`.</span></span> <span data-ttu-id="4085c-177">Следовательно, если эти свойства содержат `~` для указания корневого каталога веб-приложения, URL-адрес будет изменен на допустимый относительный URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="4085c-177">Consequently, if these properties contain a `~` to indicate the root of the web application, the URL will be modified to a valid relative URL.</span></span>

<span data-ttu-id="4085c-178">Помните, что `~` в свойствах, связанных с URL-адресами, преобразовывают только элементы управления сервера ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="4085c-178">Keep in mind that only ASP.NET server controls transform the `~` in their URL-related properties.</span></span> <span data-ttu-id="4085c-179">Если `~` появляется в статической HTML-разметке, например `<img src="~/Images/PoweredByASPNET.gif" />`, обработчик ASP.NET отправляет `~` в браузер вместе с остальной частью содержимого HTML.</span><span class="sxs-lookup"><span data-stu-id="4085c-179">If a `~` appears in static HTML markup, such as `<img src="~/Images/PoweredByASPNET.gif" />`, the ASP.NET engine sends the `~` to the browser along with the rest of the HTML content.</span></span> <span data-ttu-id="4085c-180">В браузере предполагается, что `~` является частью URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="4085c-180">The browser assumes that the `~` is part of the URL.</span></span> <span data-ttu-id="4085c-181">Например, если браузер получает разметку `<img src="~/Images/PoweredByASPNET.gif" />` предполагается, что есть вложенная папка с именем `~` с вложенной папкой `Images`, которая содержит файл изображения `PoweredByASPNET.gif`.</span><span class="sxs-lookup"><span data-stu-id="4085c-181">For example, if the browser receives the markup `<img src="~/Images/PoweredByASPNET.gif" />` it assumes there is a subfolder named `~` with a subfolder `Images` that contains the image file `PoweredByASPNET.gif`.</span></span>

<span data-ttu-id="4085c-182">Чтобы исправить разметку изображения в `Site.master`, замените существующий элемент `<img>` веб-элементом управления Image ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="4085c-182">To fix the image markup in `Site.master`, replace the existing `<img>` element with an ASP.NET Image Web control.</span></span> <span data-ttu-id="4085c-183">Задайте для `ID` веб-элемента управления Image значение `PoweredByImage`, его свойство `ImageUrl` `~/Images/PoweredByASPNET.gif`, а для свойства `AlternateText` — значение "на платформе ASP.NET!".</span><span class="sxs-lookup"><span data-stu-id="4085c-183">Set the Image Web control's `ID` to `PoweredByImage`, its `ImageUrl` property to `~/Images/PoweredByASPNET.gif`, and its `AlternateText` property to "Powered by ASP.NET!"</span></span>

[!code-aspx[Main](urls-in-master-pages-cs/samples/sample5.aspx)]

<span data-ttu-id="4085c-184">После внесения этого изменения на главную страницу снова перейдите на страницу `~/Admin/Default.aspx`.</span><span class="sxs-lookup"><span data-stu-id="4085c-184">After making this change to the master page, revisit the `~/Admin/Default.aspx` page again.</span></span> <span data-ttu-id="4085c-185">На этот раз файл изображения `PoweredByASPNET.gif` отображается на странице (см. рис. 3).</span><span class="sxs-lookup"><span data-stu-id="4085c-185">This time the `PoweredByASPNET.gif` image file appears in the page (see Figure 3).</span></span> <span data-ttu-id="4085c-186">При подготовке к просмотру веб-элемента управления изображение использует метод `ResolveClientUrl` для разрешения `ImageUrl` значения свойства.</span><span class="sxs-lookup"><span data-stu-id="4085c-186">When the Image Web control is rendered it uses the `ResolveClientUrl` method to resolve its `ImageUrl` property value.</span></span> <span data-ttu-id="4085c-187">В `~/Admin/Default.aspx` `ImageUrl` преобразуется в соответствующий относительный URL-адрес, как показано в следующем фрагменте кода HTML:</span><span class="sxs-lookup"><span data-stu-id="4085c-187">In `~/Admin/Default.aspx` the `ImageUrl` is converted into an appropriate relative URL, as the following snippet of HTML source shows:</span></span>

[!code-html[Main](urls-in-master-pages-cs/samples/sample6.html)]

> [!NOTE]
> <span data-ttu-id="4085c-188">Помимо использования в свойствах веб-элемента управления на основе URL-адреса, `~` можно также использовать при вызове методов `Response.Redirect` и `Server.MapPath`, помимо прочего.</span><span class="sxs-lookup"><span data-stu-id="4085c-188">In addition to being used in URL-based Web control properties, the `~` can also be used when calling the `Response.Redirect` and `Server.MapPath` methods, among others.</span></span> <span data-ttu-id="4085c-189">Кроме того, при необходимости метод `ResolveClientUrl` можно вызвать непосредственно из декларативной разметки ASP.NET или главной страницы. см. запись блога [Фриц кальки](https://www.pluralsight.com/blogs/fritz/) [с помощью `ResolveClientUrl` в разметке](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx).</span><span class="sxs-lookup"><span data-stu-id="4085c-189">Also, the `ResolveClientUrl` method may be invoked directly from an ASP.NET or master page's declarative markup, if needed; see [Fritz Onion](https://www.pluralsight.com/blogs/fritz/)'s blog entry [Using `ResolveClientUrl` in Markup](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx).</span></span>

## <a name="fixing-the-master-pages-remaining-relative-urls"></a><span data-ttu-id="4085c-190">Исправление оставшихся относительных URL-адресов главной страницы</span><span class="sxs-lookup"><span data-stu-id="4085c-190">Fixing the Master Page's Remaining Relative URLs</span></span>

<span data-ttu-id="4085c-191">В дополнение к элементу `<img>` в `footerContent`, который мы только что устранили, Главная страница содержит еще один относительный URL-адрес, требующий нашего внимания.</span><span class="sxs-lookup"><span data-stu-id="4085c-191">In addition to the `<img>` element in the `footerContent` that we just fixed, the master page contains one more relative URL that requires our attention.</span></span> <span data-ttu-id="4085c-192">В `topContent` области содержатся ссылки «учебники по главным страницам», указывающие на `Default.aspx`.</span><span class="sxs-lookup"><span data-stu-id="4085c-192">The `topContent` region includes the link "Master Pages Tutorials," which points to `Default.aspx`.</span></span>

[!code-html[Main](urls-in-master-pages-cs/samples/sample7.html)]

<span data-ttu-id="4085c-193">Так как этот URL-адрес является относительным, пользователь будет отправлен на страницу `Default.aspx` в папке страницы содержимого, которую он посещает.</span><span class="sxs-lookup"><span data-stu-id="4085c-193">Because this URL is relative, it will send the user to the `Default.aspx` page in the folder of the content page they are visiting.</span></span> <span data-ttu-id="4085c-194">Чтобы эта ссылка всегда указывала на `Default.aspx` в корневой папке, необходимо заменить элемент `<a>` на веб-элемент управления HyperLink, чтобы можно было использовать нотацию `~`.</span><span class="sxs-lookup"><span data-stu-id="4085c-194">To have this link always point to `Default.aspx` in the root folder we need to replace the `<a>` element with a HyperLink Web control so that we can use the `~` notation.</span></span>

<span data-ttu-id="4085c-195">Удалите разметку элемента `<a>` и добавьте на ее место элемент управления HyperLink.</span><span class="sxs-lookup"><span data-stu-id="4085c-195">Remove the `<a>` element markup and add a HyperLink control in its place.</span></span> <span data-ttu-id="4085c-196">Задайте для `ID` гиперссылки значение `lnkHome`, свойство `NavigateUrl` `~/Default.aspx`, а для свойства `Text` — "учебники по главным страницам".</span><span class="sxs-lookup"><span data-stu-id="4085c-196">Set the HyperLink's `ID` to `lnkHome`, its `NavigateUrl` property to `~/Default.aspx`, and its `Text` property to "Master Pages Tutorials."</span></span>

[!code-aspx[Main](urls-in-master-pages-cs/samples/sample8.aspx)]

<span data-ttu-id="4085c-197">Вот и все!</span><span class="sxs-lookup"><span data-stu-id="4085c-197">That's it!</span></span> <span data-ttu-id="4085c-198">На этом этапе все URL-адреса на главной странице должным образом основаны на странице содержимого, независимо от того, в каких папках находится Главная страница и страница содержимого.</span><span class="sxs-lookup"><span data-stu-id="4085c-198">At this point all the URLs in our master page are properly based when rendered by a content page regardless of what folders the master page and content page are located in.</span></span>

### <a name="automatic-url-resolution-in-theheadsection"></a><span data-ttu-id="4085c-199">Автоматическое разрешение URL-адресов в разделе`<head>`</span><span class="sxs-lookup"><span data-stu-id="4085c-199">Automatic URL Resolution in the`<head>`Section</span></span>

<span data-ttu-id="4085c-200">В учебнике [*Создание макета на уровне сайта с помощью главных страниц*](creating-a-site-wide-layout-using-master-pages-cs.md) мы добавили `<link>` в файл `Styles.css` в `<head>`ном регионе:</span><span class="sxs-lookup"><span data-stu-id="4085c-200">In the [*Creating a Site-Wide Layout Using Master Pages*](creating-a-site-wide-layout-using-master-pages-cs.md) tutorial we added a `<link>` to the `Styles.css` file in the `<head>` region:</span></span>

[!code-aspx[Main](urls-in-master-pages-cs/samples/sample9.aspx)]

<span data-ttu-id="4085c-201">Хотя атрибут `href` элемента `<link>` является относительным, он автоматически преобразуется в соответствующий путь во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="4085c-201">While the `<link>` element's `href` attribute is relative, it's automatically converted to an appropriate path at runtime.</span></span> <span data-ttu-id="4085c-202">Как обсуждалось в разделе [*Указание заголовка, Meta-тегов и других заголовков HTML в руководстве по главной странице*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md) , `<head>` регион фактически является элементом управления на стороне сервера, что позволяет ему изменять содержимое его внутренних элементов управления при его подготовке к просмотру.</span><span class="sxs-lookup"><span data-stu-id="4085c-202">As we discussed in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md) tutorial, the `<head>` region is actually a server-side control, which enables it to modify the contents of its inner controls when it is rendered.</span></span>

<span data-ttu-id="4085c-203">Чтобы проверить это, вернитесь на страницу `~/Admin/Default.aspx` и просмотрите исходный HTML-код, отправленный в браузер.</span><span class="sxs-lookup"><span data-stu-id="4085c-203">To verify this, revisit the `~/Admin/Default.aspx` page and view the HTML source sent to the browser.</span></span> <span data-ttu-id="4085c-204">Как показано в следующем фрагменте кода, `href` атрибут элемента `<link>` был автоматически изменен на соответствующий относительный URL-адрес `../Styles.css`.</span><span class="sxs-lookup"><span data-stu-id="4085c-204">As the snippet below illustrates, the `<link>` element's `href` attribute has been automatically modified to an appropriate relative URL, `../Styles.css`.</span></span>

[!code-html[Main](urls-in-master-pages-cs/samples/sample10.html)]

## <a name="summary"></a><span data-ttu-id="4085c-205">Сводка</span><span class="sxs-lookup"><span data-stu-id="4085c-205">Summary</span></span>

<span data-ttu-id="4085c-206">Главные страницы очень часто содержат ссылки, изображения и другие внешние ресурсы, которые необходимо указать с помощью URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="4085c-206">Master pages very often include links, images, and other external resources that must be specified via a URL.</span></span> <span data-ttu-id="4085c-207">Так как эталонная страница и страницы содержимого могут отсутствовать в одной папке, важно абстаин с помощью относительных URL-адресов.</span><span class="sxs-lookup"><span data-stu-id="4085c-207">Because the master page and content pages might not exist in the same folder, it is important to abstain from using relative URLs.</span></span> <span data-ttu-id="4085c-208">Хотя можно использовать жестко закодированные абсолютные URL-адреса, это жестко прикрепляет абсолютный адрес URL к приложению.</span><span class="sxs-lookup"><span data-stu-id="4085c-208">While it is possible to use hard coded absolute URLs, doing so tightly couples the absolute URL to the web application.</span></span> <span data-ttu-id="4085c-209">При изменении абсолютного URL-адреса, как это часто происходит при перемещении или развертывании веб-приложения, необходимо помнить о необходимости вернуться и обновить абсолютные URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="4085c-209">If the absolute URL changes - as it often does when moving or deploying a web application - you'll have to remember to go back and update the absolute URLs.</span></span>

<span data-ttu-id="4085c-210">Идеальным подходом является использование тильды (`~`) для указания корневого каталога приложения.</span><span class="sxs-lookup"><span data-stu-id="4085c-210">The ideal approach is to use the tilde (`~`) to indicate the application root.</span></span> <span data-ttu-id="4085c-211">ASP.NET веб-элементы управления, которые содержат свойства, связанные с URL-адресом, сопоставляют `~` с корнем приложения во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="4085c-211">ASP.NET Web controls that contain URL-related properties map the `~` to the application root at runtime.</span></span> <span data-ttu-id="4085c-212">На внутреннем уровне веб-элементы управления используют метод `ResolveClientUrl` класса `Control` для создания допустимого относительного URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="4085c-212">Internally, the Web controls use the `Control` class's `ResolveClientUrl` method to generate a valid relative URL.</span></span> <span data-ttu-id="4085c-213">Этот метод является открытым и доступен из каждого серверного элемента управления (включая класс `Page`), поэтому его можно использовать программным способом из классов кода программной части, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="4085c-213">This method is public and available from every server control (including the `Page` class), so you can use it programmatically from your code-behind classes, if needed.</span></span>

<span data-ttu-id="4085c-214">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="4085c-214">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="4085c-215">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="4085c-215">Further Reading</span></span>

<span data-ttu-id="4085c-216">Дополнительные сведения о разделах, обсуждаемых в этом руководстве, см. в следующих ресурсах:</span><span class="sxs-lookup"><span data-stu-id="4085c-216">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="4085c-217">Главные страницы в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="4085c-217">Master Pages in ASP.NET</span></span>](http://www.odetocode.com/Articles/419.aspx)
- [<span data-ttu-id="4085c-218">Пересоздание URL-адресов на главной странице</span><span class="sxs-lookup"><span data-stu-id="4085c-218">URL Rebasing in a Master Page</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/masterpages/default.aspx#urls)
- [<span data-ttu-id="4085c-219">Использование `ResolveClientUrl` в разметке</span><span class="sxs-lookup"><span data-stu-id="4085c-219">Using `ResolveClientUrl` in Markup</span></span>](https://www.pluralsight.com/blogs/fritz/archive/2006/02/06/18596.aspx)

### <a name="about-the-author"></a><span data-ttu-id="4085c-220">Об авторе</span><span class="sxs-lookup"><span data-stu-id="4085c-220">About the Author</span></span>

<span data-ttu-id="4085c-221">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор нескольких книг по ASP/ASP. NET и основатель 4GuysFromRolla.com, работал с веб-технологиями майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="4085c-221">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="4085c-222">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="4085c-222">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="4085c-223">Его последняя книга — [*Sams обучать себя ASP.NET 3,5 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="4085c-223">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="4085c-224">Скотт можно получить по адресу [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) или через свой блог по адресу [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="4085c-224">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="4085c-225">Специальная благодарность</span><span class="sxs-lookup"><span data-stu-id="4085c-225">Special Thanks To</span></span>

<span data-ttu-id="4085c-226">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="4085c-226">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="4085c-227">Если это так, расположите строку в [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span><span class="sxs-lookup"><span data-stu-id="4085c-227">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="4085c-228">[Назад](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md)
> [Вперед](control-id-naming-in-content-pages-cs.md)</span><span class="sxs-lookup"><span data-stu-id="4085c-228">[Previous](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md)
[Next](control-id-naming-in-content-pages-cs.md)</span></span>
