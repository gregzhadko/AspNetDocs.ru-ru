---
uid: web-forms/overview/older-versions-getting-started/master-pages/specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb
title: Указание заголовка, Meta-тегов и других заголовков HTML на главной странице (VB) | Документация Майкрософт
author: rick-anderson
description: В этой статье рассматриваются различные методы определения ассортимента &lt;Head&gt; элементов на главной странице со страницы содержимого.
ms.author: riande
ms.date: 05/21/2008
ms.assetid: ea8196f5-039d-43ec-8447-8997ad4d3900
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb
msc.type: authoredcontent
ms.openlocfilehash: 160af664cdf27f9ede1273aaf915da749a39ad48
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78522492"
---
# <a name="specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb"></a>Указание названия, метатегов и других заголовков HTML на эталонной странице (VB)

по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Скачать код](https://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_03_VB.zip) или [скачать PDF](https://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_03_VB.pdf)

> В этой статье рассматриваются различные методы определения ассортимента &lt;Head&gt; элементов на главной странице со страницы содержимого.

## <a name="introduction"></a>Введение

Новые главные страницы, созданные в Visual Studio 2008, по умолчанию имеют два элемента управления ContentPlaceHolder: один с именем `head`и находятся в элементе `<head>`. и один именованный `ContentPlaceHolder1`, помещенный в веб-форму. Целью `ContentPlaceHolder1` является определение области в веб-форме, которую можно настроить отдельно для каждой страницы. `head` ContentPlaceHolder позволяет страницам добавить пользовательское содержимое в раздел `<head>`. (Разумеется, эти две элементов управления ContentPlaceHolder можно изменить или удалить, а на главную страницу можно добавить дополнительные ContentPlaceHolder. Главная страница, `Site.master`, в настоящее время имеет четыре элемента управления ContentPlaceHolder.)

Элемент `<head>` HTML служит в качестве репозитория для сведений о документе веб-страницы, который не является частью самого документа. Сюда входят такие сведения, как заголовок веб-страницы, метаданные, используемые поисковыми машинами или внутренними поисковыми модулями, а также ссылки на внешние ресурсы, такие как RSS-каналы, JavaScript и CSS-файлы. Некоторые из этих сведений могут быть относящимися ко всем страницам на веб-сайте. Например, может потребоваться глобально импортировать одни и те же правила CSS и файлы JavaScript для каждой ASP.NET страницы. Однако существуют части элемента `<head>`, относящиеся к конкретной странице. Заголовок страницы является простым примером.

В этом учебнике мы рассмотрим, как определить глобальную и специфическую `<head>` разметку раздела на главной странице и на страницах содержимого.

## <a name="examining-the-master-pagesheadsection"></a>Изучение раздела`<head>`главной страницы

Файл главной страницы по умолчанию, созданный Visual Studio 2008, содержит следующую разметку в ее `<head>` разделе:

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample1.aspx)]

Обратите внимание, что элемент `<head>` содержит атрибут `runat="server"`, который указывает, что это серверный элемент управления (а не статический HTML). Все страницы ASP.NET являются производными от [класса`Page`](https://msdn.microsoft.com/library/system.web.ui.page.aspx), который находится в пространстве имен `System.Web.UI`. Этот класс содержит [свойство`Header`](https://msdn.microsoft.com/library/system.web.ui.page.header.aspx) , которое обеспечивает доступ к области `<head>` страницы. С помощью свойства `Header` можно задать заголовок страницы ASP.NET или добавить дополнительную разметку в отображаемый `<head>` раздел. Затем можно настроить элемент `<head>` страницы содержимого, записав фрагмент кода в обработчик событий `Page_Load` страницы. Мы изучаем, как программно задать заголовок страницы на шаге 1.

Разметка, показанная в элементе `<head>` выше, также включает элемент управления ContentPlaceHolder с именем `head`. Этот элемент управления ContentPlaceHolder необязателен, так как страницы содержимого могут добавлять настраиваемое содержимое в элемент `<head>` программным способом. Однако это полезно, но в ситуациях, когда странице содержимого необходимо добавить статическую разметку к элементу `<head>`, так как статическая разметка может быть декларативно добавлена к соответствующему элементу управления содержимым, а не программно.

В дополнение к элементу `<title>` и `head` ContentPlaceHolder элемент `<head>` главной страницы должен содержать любую разметку уровня `<head>`, которая является общей для всех страниц. На нашем веб-сайте все страницы используют правила CSS, определенные в файле `Styles.css`. Следовательно, мы обновили элемент `<head>` в учебнике [*Создание макета на уровне сайта с помощью главных страниц*](creating-a-site-wide-layout-using-master-pages-vb.md) , чтобы включить соответствующий элемент `<link>`. Ниже показана разметка текущей `<head>` главной страницы `Site.master`.

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample2.aspx)]

## <a name="step-1-setting-a-content-pages-title"></a>Шаг 1. Задание заголовка страницы содержимого

Заголовок веб-страницы задается с помощью элемента `<title>`. Важно задать в качестве заголовка каждой страницы соответствующее значение. При посещении страницы ее заголовок отображается в заголовке окна браузера. Кроме того, при создании закладки страницы браузеры используют заголовок страницы в качестве предлагаемого имени закладки. Кроме того, многие поисковые системы отображают заголовок страницы при отображении результатов поиска.

> [!NOTE]
> По умолчанию Visual Studio устанавливает элемент `<title>` на главной странице в "безымянная страница". Аналогичным образом, для новых `<title>` страниц ASP.NET также задано значение «безымянная страница». Поскольку можно легко забыть задать для заголовка страницы соответствующее значение, в Интернете будет много страниц с заголовком «безымянная страница». При поиске по Google для веб-страниц этот заголовок возвращает примерно 2 460 000 результатов. Даже корпорация Майкрософт уязвима для публикации веб-страниц с заголовком «безымянная страница». На момент написания этой статьи Поиск Google сообщил 236 таких веб-страниц в домене Microsoft.com.

Страница ASP.NET может указывать ее заголовок одним из следующих способов:

- Путем помещения значения непосредственно в элемент `<title>`
- Использование атрибута `Title` в директиве `<%@ Page %>`
- Программная установка свойства `Title` страницы с помощью кода, например `Page.Title="title"` или `Page.Header.Title="title"`.

На страницах содержимого отсутствует элемент `<title>`, как определено на главной странице. Таким образом, чтобы задать заголовок страницы содержимого, можно либо использовать атрибут `Title` директивы `<%@ Page %>`, либо задать его программным способом.

### <a name="setting-the-pages-title-declaratively"></a>Декларативное задание заголовка страницы

Заголовок страницы содержимого можно задать декларативно с помощью атрибута `Title` [директивы`<%@ Page %>`](https://msdn.microsoft.com/library/ydy4x04a.aspx). Это свойство можно задать путем непосредственного изменения директивы `<%@ Page %>` или с помощью окно свойств. Давайте рассмотрим оба подхода.

В представлении источника выберите директиву `<%@ Page %>`, которая находится в верхней части декларативной разметки страницы. Директива `<%@ Page %>` для `Default.aspx` выглядит следующим образом:

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample3.aspx)]

Директива `<%@ Page %>` задает атрибуты, зависящие от страницы, используемые ядром ASP.NET при синтаксическом анализе и компиляции страницы. К ним относятся файл главной страницы, расположение файла кода и его заголовок, а также другие сведения.

По умолчанию при создании страницы содержимого Visual Studio присваивает атрибуту `Title` значение "безымянная страница". Измените атрибут `Title` `Default.aspx`со страницы "без заголовка" на "учебники по главной странице", а затем просмотрите страницу в браузере. На рис. 1 показан заголовок окна браузера, который отражает заголовок новой страницы.

![В заголовке окна браузера теперь отображаются &quot;руководства главной страницы&quot;, а не &quot;страницы без заголовка&quot;](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image1.png)

**Рис. 01**. в заголовке окна браузера теперь отображаются «учебники по главной странице», а не «безымянная страница»

Заголовок страницы также может быть задан из окно свойств. В окно свойств выберите документ из раскрывающегося списка, чтобы загрузить свойства уровня страницы, включая свойство `Title`. На рис. 2 показан окно свойств после того, как `Title` был установлен в «учебники по главной странице».

![Название можно также настроить в окне Свойства.](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image2.png)

**Рис. 02**. можно также настроить заголовок из окна «Свойства».

### <a name="setting-the-pages-title-programmatically"></a>Программная настройка заголовка страницы

Разметка `<head runat="server">` главной страницы преобразуется в экземпляр [класса`HtmlHead`](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmlhead.aspx) , когда страница готовится к просмотру подсистемой ASP.NET. Класс `HtmlHead` имеет [свойство`Title`](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmlhead.title.aspx) , значение которого отражается в отображаемом элементе `<title>`. Это свойство доступно из класса кода программной части ASP.NET страницы через `Page.Header.Title`; доступ к этому же свойству также можно получить через `Page.Title`.

Чтобы попрактиковаться в программном задании заголовка страницы, перейдите к классу кода программной части `About.aspx` страницы и создайте обработчик событий для `Load` события страницы. Затем задайте заголовок страницы «учебники по главной странице:: about:: *Date*», где *Date* — текущая дата. После добавления этого кода обработчик событий `Page_Load` должен выглядеть следующим образом:

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample4.vb)]

На рис. 3 показан заголовок окна браузера при посещении страницы `About.aspx`.

![Заголовок страницы задается программно и включает текущую дату](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image3.png)

**Рис. 03**. заголовок страницы задан программно и включает текущую дату

## <a name="step-2-automatically-assigning-a-page-title"></a>Шаг 2. Автоматическое назначение заголовка страницы

Как было показано на шаге 1, заголовок страницы можно задать декларативно или программно. Если вы забыли явно изменить заголовок на что-то более описательное, страница будет иметь заголовок по умолчанию "без названия". В идеале заголовок страницы задается автоматически в случае, если его значение не указано явным образом. Например, если в среде выполнения в качестве заголовка страницы указано «безымянная страница», то может потребоваться, чтобы заголовок автоматически обновлялся так же, как и имя файла ASP.NET страницы. Хорошая новость состоит в том, что с небольшим объемом предварительной работы можно автоматически назначить заголовок.

Все веб-страницы ASP.NET являются производными от класса `Page` в пространстве имен System. Web. UI. Класс `Page` определяет минимальную функциональность, необходимую для страницы ASP.NET, и предоставляет необходимые свойства, такие как `IsPostBack`, `IsValid`, `Request`и `Response`, а также многие другие. Часто для каждой страницы веб-приложения требуются дополнительные функции или функции. Распространенный способ предоставления этого — создание пользовательского класса базовой страницы. Пользовательский класс базовой страницы — это создаваемый класс, производный от класса `Page` и включающий дополнительные функциональные возможности. После создания базового класса можно получить от него страницы ASP.NET (а не класс `Page`), тем самым предлагая расширенные функции для страниц ASP.NET.

На этом шаге мы создадим базовую страницу, которая автоматически задает заголовок страницы ASP.NET для имени страницы, если заголовок не был явно задан в противном случае. На шаге 3 выполняется настройка заголовка страницы на основе схемы узла.

> [!NOTE]
> Тщательное изучение создания и использования пользовательских классов базовой страницы выходит за рамки этой серии руководств. Дополнительные сведения см. в статье [Использование пользовательского базового класса для классов кода программной части страниц ASP.NET](http://aspnet.4guysfromrolla.com/articles/041305-1.aspx).

### <a name="creating-the-base-page-class"></a>Создание базового класса страницы

Первая задача — создание базового класса страницы, который расширяет класс `Page`. Для начала добавьте в проект папку `App_Code`, щелкнув правой кнопкой мыши имя проекта в обозреватель решений, выбрав Добавить папку ASP.NET и выбрав пункт `App_Code`. Затем щелкните правой кнопкой мыши папку `App_Code` и добавьте новый класс с именем `BasePage.vb`. На рис. 4 показан обозреватель решений после добавления `App_Code` папки и класса `BasePage.vb`.

![Добавление папки App_Code и класса с именем Басепаже](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image4.png)

**Рис. 04**. добавление папки `App_Code` и класса с именем `BasePage`

> [!NOTE]
> Visual Studio поддерживает два режима управления проектами: проекты веб-сайтов и проекты веб-приложений. Папка `App_Code` предназначена для использования с моделью проекта веб-сайта. Если вы используете модель проекта веб-приложения, поместите класс `BasePage.vb` в папку с именем, отличным от `App_Code`, например `Classes`. Дополнительные сведения об этом разделе см. в статье [Перенос проекта веб-сайта в проект веб-приложения](http://webproject.scottgu.com/VisualBasic/Migration2/Migration2.aspx).

Поскольку настраиваемая базовая страница служит базовым классом для классов кода программной части ASP.NET Pages, ей необходимо расширить класс `Page`.

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample5.vb)]

При запросе страницы ASP.NET она проходит через ряд этапов, улучшалась на запрашиваемой странице в формат HTML. Можно коснуться к этапу, переопределив метод `OnEvent` `Page` класса. Для нашей базовой страницы автоматически задается заголовок, если он не был явно указан на этапе `LoadComplete` (что, как вы могли предположить, происходит после этапа `Load`).

Для этого переопределите метод `OnLoadComplete` и введите следующий код:

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample6.vb)]

Метод `OnLoadComplete` начинается с определения того, было ли свойство `Title` еще не задано явным образом. Если свойство `Title` имеет `Nothing`, пустую строку или имеет значение "безымянная страница", оно назначается имени файла запрошенной страницы ASP.NET. Физический путь к запрошенной странице ASP.NET-`C:\MySites\Tutorial03\Login.aspx`, например, доступен через свойство `Request.PhysicalPath`. Метод `Path.GetFileNameWithoutExtension` используется для извлечения только части имени файла, а затем это имя файла присваивается свойству `Page.Title`.

> [!NOTE]
> Я предлагаю улучшить эту логику, чтобы улучшить формат заголовка. Например, если имя файла страницы — `Company-Products.aspx`, приведенный выше код будет создавать название «Company-Products», но в идеале дефис будет заменен пробелом, как в «продуктах компании». Кроме того, рекомендуется добавлять пробел при изменении регистра. То есть рассмотрите возможность добавления кода, который преобразует имя файла `OurBusinessHours.aspx` в заголовок «наши рабочие часы».

### <a name="having-the-content-pages-inherit-the-base-page-class"></a>Наследование страниц содержимого базовым классом страницы

Теперь нам нужно обновить страницы ASP.NET на сайте, чтобы они были производными от настраиваемой базовой страницы (`BasePage`) вместо класса `Page`. Для этого перейдите к каждому классу кода программной части и измените объявление класса:

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample7.vb)]

на:

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample8.vb)]

После этого посетите сайт в браузере. Если вы посещаете страницу, заголовок которой явно задан, например `Default.aspx` или `About.aspx`, используется явно заданный заголовок. Однако если вы посещаете страницу, заголовок которой не был изменен со страницы по умолчанию («страница без заголовка»), то класс базовой страницы задает для заголовка имя файла страницы.

На рис. 5 показана страница `MultipleContentPlaceHolders.aspx` при просмотре в браузере. Обратите внимание, что заголовок представляет собой точное имя файла страницы (меньше расширения), "Мултиплеконтентплацехолдерс".

[![если заголовок не указан явно, имя файла страницы используется автоматически](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image6.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image5.png)

**Рис. 05**. Если заголовок не указан явно, имя файла страницы используется автоматически ([щелкните, чтобы просмотреть изображение с полным размером](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image7.png))

## <a name="step-3-basing-the-page-title-on-the-site-map"></a>Шаг 3. Создание заголовка страницы на карте узла

ASP.NET предлагает надежную платформу карт сайта, позволяющую разработчикам страниц определять иерархическую карту узла во внешнем ресурсе (например, в XML-файле или таблице базы данных) вместе с веб-элементами управления для отображения сведений о карте узла (например, SiteMapPath). Меню и элементы управления TreeView).

Доступ к структуре карт узла также можно получить программно из класса кода программной части страницы ASP.NET. Таким образом, можно автоматически задать заголовок страницы в качестве заголовка соответствующего узла на карте узла. Попробуем усовершенствовать класс `BasePage`, созданный на шаге 2, чтобы он предложит эту функцию. Но сначала нам нужно создать карту узла для нашего сайта.

> [!NOTE]
> В этом учебнике предполагается, что читатель уже знаком с ASP. Функции схемы веб-узла NET. Дополнительные сведения об использовании карт веб-узлов см. в статье о нескольких статьях, посвященной [ASP. Навигация в Интернете](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx).

### <a name="creating-the-site-map"></a>Создание схемы узла

Система сопоставления узлов построена на основе [модели поставщика](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx), которая отделяет API карт сайта от логики, которая сериализует сведения о карте узла между памятью и постоянным хранилищем. .NET Framework поставляется с [классом`XmlSiteMapProvider`](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx), который является поставщиком схемы сайта по умолчанию. Как следует из названия, `XmlSiteMapProvider` использует XML-файл в качестве хранилища карт веб-узла. Давайте будем использовать этот поставщик для определения схемы узла.

Начните с создания файла схемы узла в корневой папке веб-сайта с именем `Web.sitemap`. Для этого щелкните правой кнопкой мыши имя веб-сайта в обозреватель решений, выберите команду Добавить новый элемент и выберите шаблон "Схема сайта". Убедитесь, что файл имеет имя `Web.sitemap` и нажмите кнопку Добавить.

[![добавить файл с именем Web. Sitemap в корневую папку веб-сайта](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image9.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image8.png)

**Рис. 6**. Добавление файла с именем `Web.sitemap` в корневую папку веб-сайта ([щелкните, чтобы просмотреть изображение с полным размером](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image10.png))

Добавьте следующий XML-код в файл `Web.sitemap`:

[!code-xml[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample9.xml)]

Этот XML-код определяет иерархическую структуру карт узла, показанную на рис. 7.

![В настоящее время схема узла состоит из трех узлов карт узла.](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image11.png)

**Рис. 07**. в настоящее время схема узла состоит из трех узлов карт узла

При добавлении новых примеров мы будем обновлять структуру карт узла в следующих учебных курсах.

### <a name="updating-the-master-page-to-include-navigation-web-controls"></a>Обновление главной страницы для включения навигации через веб-элементы управления

Теперь, когда у нас есть определенная схема узла, обновите главную страницу, чтобы она включала веб-элементы управления для навигации. В частности, добавим элемент управления ListView к левому столбцу в разделе «уроки», который отображает неупорядоченный список с элементом списка для каждого узла, определенного в карте узла.

> [!NOTE]
> Элемент управления ListView является новым для ASP.NET версии 3,5. Если вы используете предыдущую версию ASP.NET, используйте вместо этого элемент управления Repeater. Дополнительные сведения об элементе управления ListView см. в разделе [Использование элементов управления ListView и DataPager для ASP.NET 3.5](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx).

Сначала удалите существующую разметку неупорядоченного списка из раздела уроки. Затем перетащите элемент управления ListView с панели элементов и поместите его под заголовком «уроки». ListView находится в разделе данных панели элементов наряду с другими элементами управления представления: GridView, DetailsView и FormView. Задайте для свойства `ID` ListView значение `LessonsList`.

В мастере настройки источника данных выберите привязку ListView к новому элементу управления SiteMapDataSource с именем `LessonsDataSource`. Элемент управления SiteMapDataSource возвращает иерархическую структуру из системы карт сайта.

[![привязка элемента управления SiteMapDataSource к элементу управления ListView Лессонслист](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image13.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image12.png)

**Рис. 08**. привязка элемента управления SiteMapDataSource к элементу управления ListView Лессонслист ([щелкните, чтобы просмотреть изображение с полным размером](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image14.png))

После создания элемента управления SiteMapDataSource необходимо определить шаблоны ListView таким образом, чтобы он отображал неупорядоченный список с элементом списка для каждого узла, возвращенного элементом управления SiteMapDataSource. Это можно сделать с помощью следующей разметки шаблона:

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample10.aspx)]

`LayoutTemplate` создает разметку для неупорядоченного списка (`<ul>...</ul>`), пока `ItemTemplate` отображает каждый элемент, возвращенный SiteMapDataSource как элемент списка (`<li>`), содержащий ссылку на определенное занятие.

После настройки шаблонов ListView посетите веб-сайт. Как показано на рис. 9, в разделе «уроки» содержится один маркированный элемент Home. Где находятся занятия о и использовании нескольких элементов управления ContentPlaceHolder? SiteMapDataSource предназначен для возврата иерархического набора данных, но элемент управления ListView может отображать только один уровень иерархии. Поэтому отображается только первый уровень узла карт веб-сайта, возвращенный SiteMapDataSource.

[![раздел "уроки" содержит один элемент списка](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image16.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image15.png)

**Рис. 09**. раздел уроки содержит один элемент списка ([щелкните, чтобы просмотреть изображение с полным размером](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image17.png)).

Чтобы отобразить несколько уровней, можно вложить несколько элементов ListView в `ItemTemplate`. Этот метод был проверен на [ *главных страницах и в руководстве по переходу на веб-узел* ](../../data-access/introduction/master-pages-and-site-navigation-vb.md) [статьи работа с учебниками по работе с данными](../../data-access/index.md). Однако в этой серии руководств на карте узла будет содержаться всего два уровня: Главная (верхний уровень); и каждый урок в качестве ребенка дома. Вместо создания вложенного ListView мы можем указать SiteMapDataSource не возвращать начальный узел, задав [свойству`ShowStartingNode`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx) значение `False`. Результатом этого является то, что SiteMapDataSource начинает с возврата второго уровня узлов карт узла.

В результате этого изменения ListView отображает элементы маркированного списка About и using of Controls (элементы управления ContentPlaceHolder), но не содержит элемент маркированного списка для дома. Чтобы устранить эту проблему, можно явно добавить элемент маркированного списка для домашнего `LayoutTemplate`:

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample11.aspx)]

Если настроить SiteMapDataSource на пропуск начального узла и явно добавить элемент маркированного списка, в разделе уроки теперь отображаются предполагаемые выходные данные.

[![разделе "уроки" содержится элемент маркированного списка для домашней страницы и каждого дочернего узла](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image19.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image18.png)

**Рис. 10**. в разделе "уроки" содержится элемент маркированного меню "Главная" и "каждый дочерний узел" ([щелкните, чтобы просмотреть изображение с полным размером](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image20.png))

### <a name="setting-the-title-based-on-the-site-map"></a>Задание заголовка на основе схемы узла

Используя карту узла, мы можем обновить наш `BasePage` класс, чтобы использовать заголовок, указанный на карте узла. Как мы делали на шаге 2, мы хотим использовать заголовок узла «схема узла» только в том случае, если заголовок страницы не был явно задан разработчиком страницы. Если запрашиваемая страница не имеет явно заданного заголовка страницы и не найдена на карте узла, мы вернемся к использованию имени файла запрошенной страницы (меньше расширения), как было сделано на шаге 2. На рис. 11 показан этот процесс принятия решений.

![При отсутствии явно заданного заголовка страницы используется соответствующий заголовок узла схемы узла.](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image21.png)

**Рис. 11**. при отсутствии явно заданного заголовка страницы используется соответствующий заголовок узла схемы узла

Обновите метод `OnLoadComplete` класса `BasePage`, чтобы включить в него следующий код:

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample12.vb)]

Как и ранее, метод `OnLoadComplete` начинается с определения того, задан ли заголовок страницы явно. Если `Page.Title` имеет `Nothing`, пустую строку или присваивается значение "безымянная страница", код автоматически назначает значение `Page.Title`.

Чтобы определить используемый заголовок, код начинается со ссылки на [свойство`CurrentNode`](https://msdn.microsoft.com/library/system.web.sitemap.currentnode.aspx) [класса`SiteMap`](https://msdn.microsoft.com/library/system.web.sitemap.aspx). `CurrentNode` возвращает экземпляр [`SiteMapNode`](https://msdn.microsoft.com/library/system.web.sitemapnode.aspx) в карте узла, соответствующий текущей запрошенной странице. Если запрошенная в данный момент страница найдена в карте узла, свойство `Title` `SiteMapNode`присваивается заголовку страницы. Если запрашиваемая в данный момент страница отсутствует на карте узла, `CurrentNode` возвращает `Nothing` и имя файла запрашиваемой страницы используется в качестве заголовка (как было сделано на шаге 2).

На рис. 12 показана страница `MultipleContentPlaceHolders.aspx` при просмотре в браузере. Так как заголовок этой страницы не задан явно, вместо него используется соответствующий заголовок узла схемы узла.

![Заголовок страницы Мултиплеконтентплацехолдерс. aspx извлекается из схемы узла.](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image22.png)

**Рис. 12**. заголовок страницы мултиплеконтентплацехолдерс. aspx извлекается из схемы узла

## <a name="step-4-adding-other-page-specific-markup-to-theheadsection"></a>Шаг 4. Добавление в раздел`<head>`другой разметки для конкретной страницы

Шаги 1, 2 и 3 Просмотрели настройку элемента `<title>` на каждой странице. Помимо `<title>`, раздел `<head>` может содержать элементы `<meta>` и элементы `<link>`. Как отмечалось ранее в этом руководстве, `<head>` раздел `Site.master`содержит элемент `<link>` для `Styles.css`. Поскольку этот элемент `<link>` определен на главной странице, он включается в раздел `<head>` для всех страниц содержимого. Но как мы добавим `<meta>` и `<link>` элементы по отдельности на странице?

Самый простой способ добавить в раздел `<head>` содержимое, относящееся к странице, — создать элемент управления ContentPlaceHolder на главной странице. У нас уже есть такой элемент ContentPlaceHolder (с именем `head`). Таким образом, чтобы добавить настраиваемую разметку `<head>`, создайте соответствующий элемент управления содержимым на странице и поместите там разметку.

Чтобы продемонстрировать Добавление пользовательской `<head>` разметки на страницу, включите элемент `<meta>` Description в наш текущий набор страниц содержимого. Элемент Description `<meta>` содержит краткое описание веб-страницы. Большинство поисковых систем включают эту информацию в некоторую форму при отображении результатов поиска.

Элемент Description `<meta>` имеет следующую форму:

[!code-html[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample13.html)]

Чтобы добавить эту разметку на страницу содержимого, добавьте приведенный выше текст в элемент управления содержимым, который сопоставляется с `head`ом ContentPlaceHolder главной страницы. Например, чтобы определить элемент описания `<meta>` для `Default.aspx`, добавьте следующую разметку:

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample14.aspx)]

Поскольку `head` ContentPlaceHolder находится не в теле HTML-страницы, разметка, добавленная в элемент управления содержимым, не отображается в представление конструирования. Чтобы просмотреть элемент описания `<meta>` посетите `Default.aspx` через браузер. После загрузки страницы просмотрите источник и обратите внимание, что `<head>` раздел содержит разметку, указанную в элементе управления содержимым.

Потратьте время на добавление элементов описания `<meta>` в `About.aspx`, `MultipleContentPlaceHolders.aspx`и `Login.aspx`.

### <a name="programmatically-adding-markup-to-theheadregion"></a>Добавление разметки в`<head>`область программными средствами

`head` ContentPlaceHolder позволяет декларативно добавлять пользовательскую разметку в область `<head>` главной страницы. Пользовательская разметка также может быть добавлена программно. Помните, что свойство `Header` `Page` класса возвращает экземпляр `HtmlHead`, определенный на главной странице (`<head runat="server">`).

Возможность программного добавления содержимого в `<head>` область полезна, когда добавляемое содержимое является динамическим. Возможно, он основан на посещении страницы пользователем. возможно, он извлекается из базы данных. Независимо от причины можно добавить содержимое в `HtmlHead`, добавив элементы управления в его `Controls`ную коллекцию следующим образом:

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample15.vb)]

Приведенный выше код добавляет элемент `<meta>` keywords в область `<head>`, которая предоставляет разделенный запятыми список ключевых слов, описывающих страницу. Обратите внимание, что для добавления тега `<meta>` можно создать экземпляр [`HtmlMeta`](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmlmeta.aspx) , задать его свойства `Name` и `Content`, а затем добавить его в коллекцию `Header``Controls`. Аналогично, чтобы программно добавить элемент `<link>`, создайте объект [`HtmlLink`](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmllink.aspx) , задайте его свойства, а затем добавьте его в коллекцию `Controls` `Header`.

> [!NOTE]
> Чтобы добавить произвольную разметку, создайте экземпляр [`LiteralControl`](https://msdn.microsoft.com/library/system.web.ui.literalcontrol.aspx) , задайте его свойство `Text`, а затем добавьте его в коллекцию `Controls` `Header`.

## <a name="summary"></a>Сводка

В этом учебнике мы рассмотрели различные способы добавления разметки `<head>` региона в зависимости от страницы. Главная страница должна содержать экземпляр `HtmlHead` (`<head runat="server">`) с ContentPlaceHolder. `HtmlHead` экземпляр позволяет страницам содержимого программно получать доступ к области `<head>`, а также декларативно и программно задавать заголовок страницы; элемент управления ContentPlaceHolder позволяет декларативно добавлять пользовательскую разметку в раздел `<head>` с помощью элемента управления содержимым.

Поздравляем с программированием!

### <a name="further-reading"></a>Дополнительные материалы

Дополнительные сведения о разделах, обсуждаемых в этом руководстве, см. в следующих ресурсах:

- [Динамическое задание заголовка страницы в ASP.NET](http://aspnet.4guysfromrolla.com/articles/051006-1.aspx)
- [Изучение ASP. Навигация по веб-узлу сети](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)
- [Использование meta-тегов HTML](http://searchenginewatch.com/showPage.html?page=2167931)
- [Главные страницы в ASP.NET](http://www.odetocode.com/articles/419.aspx)
- [Использование элементов управления ListView и DataPager для ASP.NET 3.5](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx)
- [Использование пользовательского базового класса для классов кода программной части страниц ASP.NET](http://aspnet.4guysfromrolla.com/articles/041305-1.aspx)

### <a name="about-the-author"></a>Об авторе

[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор нескольких книг по ASP/ASP. NET и основатель 4GuysFromRolla.com, работал с веб-технологиями майкрософт с 1998. Скотт работает как независимый консультант, преподаватель и модуль записи. Его последняя книга — [*Sams обучать себя ASP.NET 3,5 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco). Скотт можно получить по адресу [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) или через свой блог по адресу [http://ScottOnWriting.NET](http://scottonwriting.net/).

### <a name="special-thanks-to"></a>Специальная благодарность

Эта серия руководств была рассмотрена многими полезными рецензентами. Потенциальным рецензентам для этого учебника были Зак Jones и Сучи Банержи. Хотите ознакомиться с моими будущими статьями MSDN? Если это так, расположите строку в [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).

> [!div class="step-by-step"]
> [Назад](multiple-contentplaceholders-and-default-content-vb.md)
> [Вперед](urls-in-master-pages-vb.md)
