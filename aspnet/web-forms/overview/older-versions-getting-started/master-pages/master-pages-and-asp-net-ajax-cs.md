---
uid: web-forms/overview/older-versions-getting-started/master-pages/master-pages-and-asp-net-ajax-cs
title: Главные страницы и ASP.NET AJAX (C#) | Документация Майкрософт
author: rick-anderson
description: Рассматриваются варианты использования ASP.NET AJAX и главных страниц. Рассматривает использование ScriptManagerProxy класса; Описывает, как различные файлы JS загружаются dependi...
ms.author: riande
ms.date: 07/11/2008
ms.assetid: 0c55eb66-ba44-4d49-98e8-5c87fd9b1111
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/master-pages-and-asp-net-ajax-cs
msc.type: authoredcontent
ms.openlocfilehash: 0880b2d6666ec3ae618573aa3a884ca4865c317c
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65132814"
---
# <a name="master-pages-and-aspnet-ajax-c"></a>Эталонные страницы и ASP.NET AJAX (C#)

по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Скачать код](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_08_CS.zip) или [скачать PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_08_CS.pdf)

> Рассматриваются варианты использования ASP.NET AJAX и главных страниц. Рассматривает использование ScriptManagerProxy класса; Описание порядка загрузки различных файлов JS в зависимости от того, используется ли в базе данных Master ScriptManager страницы или страницы содержимого.

## <a name="introduction"></a>Вступление

За последние несколько лет, все больше разработчиков занимаются созданием [AJAX](http://en.wikipedia.org/wiki/Ajax_(programming))-включена веб-приложений. Веб-сайт с поддержкой AJAX используется ряд связанных веб-технологий предлагает более высокую скорость работы пользователя. Создание приложений с поддержкой AJAX ASP.NET — гораздо проще благодаря корпорации Майкрософт [платформа AJAX для ASP.NET](../../../../ajax/index.md). ASP.NET AJAX встроен в ASP.NET 3.5 и Visual Studio 2008; Он также доступен как отдельный загружаемый компонент для приложений ASP.NET 2.0.

При создании веб-страниц с поддержкой AJAX с помощью платформы ASP.NET AJAX, его необходимо добавить точно [управления ScriptManager](https://msdn.microsoft.com/library/bb398863.aspx) для каждой отдельной страницы, использующее платформу. Как понятно из названия, ScriptManager управляет клиентского скрипта, используемый в веб-страниц с поддержкой AJAX. Как минимум ScriptManager создает HTML, браузеру для загрузки файлов JavaScript, состав клиентской библиотеки ASP.NET AJAX. Он также может использоваться для регистрации пользовательские файлы JavaScript, сценарий с поддержкой веб-служб и функциональных возможностей службы пользовательского приложения.

Если сайт использует главной страницы (так же как и его), не нужно обязательно добавьте элемент управления ScriptManager каждой одной страницы содержимого. Вместо этого можно добавить элемент управления ScriptManager на главную страницу. Этом руководстве показано, как добавить элемент управления ScriptManager на главную страницу. Он также рассказывается, как использовать элемент управления ScriptManagerProxy для регистрации пользовательских сценариев и служб сценариев в определенную страницу содержимого.

> [!NOTE]
> Этот учебник не исследовать, разработка или создание поддерживающих AJAX веб-приложений с помощью платформы AJAX для ASP.NET. Дополнительные сведения об использовании AJAX [видеоролики по ASP.NET AJAX](../../../videos/aspnet-ajax/index.md) и [учебники](../aspnet-ajax/understanding-partial-page-updates-with-asp-net-ajax.md), а также как эти ресурсы, перечисленные в разделе «Дополнительные материалы» в конце этого руководства.

## <a name="examining-the-markup-emitted-by-the-scriptmanager-control"></a>Изучение разметке, генерируемой элементом управления ScriptManager

Элемент управления ScriptManager создает разметку, которая заставляет браузер, чтобы скачать файлы JavaScript, состав клиентской библиотеки ASP.NET AJAX. Он также добавляет немного подставляемый код JavaScript на страницу, который инициализирует этой библиотеки. В следующем примере показано содержимое, которое добавляется в выводимые данные страницы, содержащей элемент управления ScriptManager:

[!code-html[Main](master-pages-and-asp-net-ajax-cs/samples/sample1.html)]

`<script src="url"></script>` Теги настроить браузер, чтобы загрузить и выполнить файл JavaScript в *URL-адрес*. ScriptManager выдает три таких тегов; один ссылается на файл `WebResource.axd`, а два других ссылку на файл `ScriptResource.axd`. Фактически эти файлы не существуют как файлы в веб-сайта. Вместо этого при получении запроса для одного из этих файлов на веб-сервер, механизм ASP.NET проверяет строку запроса и возвращает соответствующее содержимое JavaScript. Скрипт, предоставляемые эти три внешние файлы JavaScript составляют платформа AJAX для ASP.NET клиентская библиотека. Другой `<script>` теги, генерируемые ScriptManager включать встроенный сценарий, который инициализирует этой библиотеки.

Ссылки на внешние скрипты и встроенный сценарий, генерируемые ScriptManager важны для страницы, которая использует платформа AJAX для ASP.NET, но не требуется для страниц, не использующих платформу. Таким образом вы причин, что идеально подходит только добавление этих страниц, использующих платформу ASP.NET AJAX ScriptManager. Этого достаточно, но если у вас есть много страниц, использующих платформу в результате получается Добавление элемента управления ScriptManager ко всем страницам - повторяющиеся задачи, как минимум. Кроме того можно добавить ScriptManager на главную страницу, которая затем внедряет этот необходимый сценарий в все страницы содержимого. При таком подходе не забудьте добавить ScriptManager на новую страницу, использующее платформу ASP.NET AJAX, так как он уже включен на главной странице не нужно. Шаг 1 последовательно описан добавления ScriptManager на главную страницу.

> [!NOTE]
> Если вы планируете, в том числе функций AJAX в пользовательском интерфейсе на главной странице, затем у вас нет выбора в нескольких - ScriptManager должен включать на главной странице.

Недостатком добавления ScriptManager на главную страницу является, что приведенный выше скрипт создается в *каждые* страницы, независимо от того, следует ли его необходимые. Очевидно, что это приводит к неиспользуемого пропускной способности для этих страниц, которые имеют ScriptManager, включенных (через главную страницу), но не используйте какие-либо функции платформа AJAX для ASP.NET. Но насколько теряется пропускной способности?

- Фактическое содержимое, генерируемые ScriptManager (как показано выше) суммирует немного превышает 1 КБ.
- Три файла внешнего скрипта, который ссылается `<script>` элемент, тем не менее, составляют примерно 450 КБ данных без сжатия; в веб-сайта со сжатием gzip, это общая пропускная способность может быть сокращен около 100 КБ. Тем не менее эти файлы кэшируются обозревателем в течение одного года, это означает, что они должны только один раз скачать и затем можно повторно использовать на других страницах на сайте.

В лучшем случае затем при кэшируются файлы скриптов, общая стоимость — 1 КБ, которой будет незначительным. В худшем случае тем не менее - когда файлы скриптов имеют еще не был загружен и веб-сервер не использует сжатие в любой форме — попадание пропускную способность примерно 450 КБ, который можно добавить в любом из в секунду или две через широкополосное подключение до 1 минуты для  пользователей за модемов удаленного доступа. Хорошо то, что так как файлы внешних скриптов, кэшируются обозревателем, это Худший случай возникает нечасто.

> [!NOTE]
> Если вы по-прежнему не хотите поместить элемент управления ScriptManager на главной странице, рассмотрите возможность веб-формы ( `<form runat="server">` разметки на главной странице). Каждая страница ASP.NET, которая использует модель обратной передачи должен включать ровно одну веб-форму. При добавлении веб-формы добавляются дополнительные материалы: число скрытых полях формы, `<form>` тег, и при необходимости JavaScript функции для инициирования обратной передачи из скрипта. Эта разметка не требуется для страниц, которые не обратной передачи. Эта разметка лишние удалось устранить, удалив веб-форма с главной страницы и вручную добавлять его в каждую страницу содержимого, которому он требуется. Однако преимущества веб-формы на главной странице перевешивают ее недостатки от необходимости излишне добавлены некоторые содержимого страницы.

## <a name="step-1-adding-a-scriptmanager-control-to-the-master-page"></a>Шаг 1. Добавление элемента управления ScriptManager главной страницы

Каждый веб-страницы, использующее платформу ASP.NET AJAX должен содержать точно один элемент управления ScriptManager. Из-за этого требования обычно имеет смысл для размещения одного элемента управления ScriptManager на главной странице, таким образом, чтобы все страницы содержимого имели автоматически включается элемент управления ScriptManager. Кроме того ScriptManager должен указываться перед любым серверных элементов управления ASP.NET AJAX, такие как элементы управления UpdatePanel и UpdateProgress. Таким образом лучше поместить ScriptManager до элементов управления ContentPlaceHolder в веб-формы.

Откройте `Site.master` главную страницу и добавьте элемент управления ScriptManager к странице в веб-формы, но перед `<div id="topContent">` элемент (см. рис. 1). Если вы используете Visual Web Developer 2008 или Visual Studio 2008, элемент управления ScriptManager находится в панели элементов на вкладке «AJAX Extensions». Если вы используете Visual Studio 2005, необходимо сначала установить платформа AJAX для ASP.NET и добавить элементы управления на панель элементов. Посетите [вики-сайте ASP.NET AJAX](https://github.com/DevExpress/AjaxControlToolkit/wiki) получить framework для ASP.NET 2.0.

После добавления ScriptManager к странице, изменить его `ID` из `ScriptManager1` для `MyManager`.

[![Добавление ScriptManager на главную страницу](master-pages-and-asp-net-ajax-cs/_static/image2.png)](master-pages-and-asp-net-ajax-cs/_static/image1.png)

**Рис 01**: Добавить ScriptManager главной страницы ([Просмотр полноразмерного изображения](master-pages-and-asp-net-ajax-cs/_static/image3.png))

## <a name="step-2-using-the-aspnet-ajax-framework-from-a-content-page"></a>Шаг 2. С помощью платформы ASP.NET AJAX из страницы содержания

В элементе управления ScriptManager, добавлен на главную страницу мы можем теперь добавить функциональность платформы ASP.NET AJAX на любую страницу содержимого. Давайте создадим новую страницу ASP.NET, которая отображает случайно выбранный продукт из базы данных "Борей". Мы будем использовать платформа AJAX для ASP.NET элемент управления Timer для обновления этого отображения каждые 15 секунд, показывающий новый продукт.

Начнем с создания новой страницы в корневом каталоге с именем `ShowRandomProduct.aspx`. Не забудьте этой новой странице, чтобы привязать `Site.master` главной страницы.

[![Добавьте новую страницу ASP.NET на веб-сайт](master-pages-and-asp-net-ajax-cs/_static/image5.png)](master-pages-and-asp-net-ajax-cs/_static/image4.png)

**Рис. 02**: Добавьте новую страницу ASP.NET на веб-сайт ([Просмотр полноразмерного изображения](master-pages-and-asp-net-ajax-cs/_static/image6.png))

Помните, что в [ *указание названия, метатегов и других заголовков HTML на главной странице* ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md) руководстве мы создали пользовательскую страницу базовый класс с именем `BasePage` , создавший заголовок страницы, если он был не задан явно. Перейдите к `ShowRandomProduct.aspx` фонового кода страницы класса, который будет наследовать `BasePage` (а не из `System.Web.UI.Page`).

Наконец, обновите `Web.sitemap` файл, чтобы включить запись для этого занятия. Добавьте следующую разметку под `<siteMapNode>` хозяин занятие взаимодействие содержимого страниц:

[!code-xml[Main](master-pages-and-asp-net-ajax-cs/samples/sample2.xml)]

Добавление этого `<siteMapNode>` отражается на занятиях списке (см. рис. 5).

### <a name="displaying-a-randomly-selected-product"></a>Отображение случайным образом выбранного продукта

Вернитесь к `ShowRandomProduct.aspx`. В режиме конструктора перетащите элемент управления UpdatePanel из области элементов в `MainContent` элемент управления содержимым и задайте его `ID` свойства `ProductPanel`. UpdatePanel представляет область на экране, можно асинхронно обновлять с помощью частичной обратной передачи.

Наша первая задача — для отображения сведений о случайно выбранный продукт в UpdatePanel. Начнем с перетаскивания элемента управления DetailsView в UpdatePanel. Значение элемента управления DetailsView `ID` свойства `ProductInfo` и очистите его `Height` и `Width` свойства. Разверните смарт-теге DetailsView и в раскрывающемся списке "Выбор источника данных", выберите для привязки элемента управления DetailsView для нового элемента управления SqlDataSource с именем `RandomProductDataSource`.

[![Привязка элемента управления DetailsView для нового элемента управления SqlDataSource](master-pages-and-asp-net-ajax-cs/_static/image8.png)](master-pages-and-asp-net-ajax-cs/_static/image7.png)

**Рис 03**: Привязка элемента управления DetailsView для нового элемента управления SqlDataSource ([Просмотр полноразмерного изображения](master-pages-and-asp-net-ajax-cs/_static/image9.png))

Настройка элемента управления SqlDataSource для подключения к базе данных Northwind с помощью `NorthwindConnectionString` (созданный в учебном курсе [ *взаимодействие с главной страницей на странице содержимого* ](interacting-with-the-content-page-from-the-master-page-cs.md) руководстве). При настройке запроса SELECT решили указать пользовательские инструкции SQL, а затем введите следующий запрос:

[!code-sql[Main](master-pages-and-asp-net-ajax-cs/samples/sample3.sql)]

`TOP 1` Ключевое слово в `SELECT` предложение возвращает только первую запись, возвращенных запросом. [ `NEWID()` Функция](https://msdn.microsoft.com/library/ms190348.aspx) создает новую [значение глобальный уникальный идентификатор (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) и может использоваться в `ORDER BY` предложение для возврата записей в таблице в случайном порядке.

[![Настройка элемента управления SqlDataSource для возврата одного, случайно выбранных записи](master-pages-and-asp-net-ajax-cs/_static/image11.png)](master-pages-and-asp-net-ajax-cs/_static/image10.png)

**Рис. 04**: Настройка элемента управления SqlDataSource, чтобы получить одну, произвольно выбранные записи ([Просмотр полноразмерного изображения](master-pages-and-asp-net-ajax-cs/_static/image12.png))

После завершения работы мастера, Visual Studio создает BoundField для двух столбцов, возвращаемых запросом выше. На этом этапе декларативная разметка страницы должна выглядеть следующего вида:

[!code-aspx[Main](master-pages-and-asp-net-ajax-cs/samples/sample4.aspx)]

Рис. 5 показан `ShowRandomProduct.aspx` страницы при просмотре в обозревателе. Нажмите кнопку обновления в браузере, чтобы перезагрузить страницу; Вы должны увидеть `ProductName` и `UnitPrice` значения для новой записи случайно выбранных.

[![Отображается название и цену продукта случайных](master-pages-and-asp-net-ajax-cs/_static/image14.png)](master-pages-and-asp-net-ajax-cs/_static/image13.png)

**05 рис**: Отображается название и цену продукта произвольного ([Просмотр полноразмерного изображения](master-pages-and-asp-net-ajax-cs/_static/image15.png))

### <a name="automatically-displaying-a-new-product-every-15-seconds"></a>Автоматическое отображение нового продукта каждые 15 секунд

Платформа AJAX для ASP.NET включает в себя элемент управления таймер, который выполняет обратную передачу в указанное время; на обратную передачу таймера `Tick` события. Если элемент управления Timer помещается внутри UpdatePanel активируется частичной обратной передачи, во время которого мы можно привязать данные к элементу управления DetailsView для отображения нового случайно выбранного продукта.

Для выполнения этой задачи таймера из области элементов перетащите в UpdatePanel. Изменение таймера `ID` из `Timer1` для `ProductTimer` и его `Interval` свойство от 60000 до 15000. `Interval` Свойство указывает количество миллисекунд между обратными передачами; он 15000 при указании таймер, чтобы вызвать обратную передачу частичной каждые 15 секунд. На этом этапе таймера должен выглядеть следующим образом:

[!code-aspx[Main](master-pages-and-asp-net-ajax-cs/samples/sample5.aspx)]

Создайте обработчик события для таймера `Tick` событий. В этом обработчике событий, нам нужно привязать данные к элементу управления DetailsView, вызвав DetailsView `DataBind` метод. Таким образом предписывает элементу управления DetailsView для повторного получения данных от элемента управления источника данных, который выбирает и отобразить новый случайным образом выбранной записи (так же, как при перезагрузке страницы, щелкнув кнопку обновления браузера).

[!code-csharp[Main](master-pages-and-asp-net-ajax-cs/samples/sample6.cs)]

Вот и все! Вернемся к странице через браузер. Изначально отображаются сведения случайных продукта. Если терпеливо смотреть экрана вы заметите, что, через 15 секунд, сведения о новый продукт волшебным образом заменяет существующий отображения.

Чтобы лучше понять, почему так происходит, давайте добавим элемент управления Label UpdatePanel, время последнего обновления отображения. Добавьте элемент управления Label Web внутри UpdatePanel, задайте его `ID` для `LastUpdateTime`и снимите его `Text` свойство. Создайте обработчик событий для UpdatePanel `Load` событий и отображение текущего времени в метке. (UpdatePanel `Load` событие, возникающее при каждой обратной передаче страницы полным или частичным.)

[!code-csharp[Main](master-pages-and-asp-net-ajax-cs/samples/sample7.cs)]

Благодаря этому изменению полный страницы включает время загрузки текущей отображаемой продукта. Рис. 6 показан при первом посещении страницы. Рис. 7 показана страница 15 секунд позже, после того как элемент управления Timer «установлен» и UpdatePanel обновлялся для отображения сведений о нового продукта.

[![Случайным образом выбрать продукт отображается при загрузке страницы](master-pages-and-asp-net-ajax-cs/_static/image17.png)](master-pages-and-asp-net-ajax-cs/_static/image16.png)

**Рис 06**: При загрузке страницы отображается случайным образом выбрать продукт ([Просмотр полноразмерного изображения](master-pages-and-asp-net-ajax-cs/_static/image18.png))

[![Каждые 15 секунд появится новый случайным образом выбрать продукт](master-pages-and-asp-net-ajax-cs/_static/image20.png)](master-pages-and-asp-net-ajax-cs/_static/image19.png)

**07 рис**: Каждые 15 секунд, отображается новый случайным образом выбрать продукт ([Просмотр полноразмерного изображения](master-pages-and-asp-net-ajax-cs/_static/image21.png))

## <a name="step-3-using-the-scriptmanagerproxy-control"></a>Шаг 3. Использование элемента управления ScriptManagerProxy

А также в том числе необходимый скрипт для клиентской библиотеки платформы AJAX для ASP.NET, ScriptManager также могут регистрировать пользовательские файлы JavaScript, ссылки на сценарий с поддержкой веб-служб и пользовательской проверки подлинности, авторизации и служб профилирования. Обычно такие настройки относятся только к определенной странице. Тем не менее, если пользовательский скрипт, файлы, ссылки на веб-службы или проверки подлинности, авторизации и профиль службы указываются в ScriptManager на главной странице, то они включаются в *все* страниц на веб-сайте.

Для добавления ScriptManager параметры на основе страниц, используйте элемент управления ScriptManagerProxy. Можно добавить на страницу содержимого ScriptManagerProxy и затем зарегистрировать пользовательский файл JavaScript, ссылки на веб-службы, или проверки подлинности, авторизации или службы профилей из ScriptManagerProxy; Это приводит к регистрации этих служб для определенной страницы содержимого.

> [!NOTE]
> Страницы ASP.NET только может иметь не более одного управления ScriptManager. Таким образом невозможно добавить элемент управления ScriptManager со страницей содержимого, если элемент управления ScriptManager уже определен на главной странице. Единственная цель ScriptManagerProxy является позволяют разработчикам определить ScriptManager на главной странице, но по-прежнему иметь возможность добавления ScriptManager настроек на основе страниц.

Чтобы увидеть элемент управления ScriptManagerProxy в действии, давайте дополнить UpdatePanel в `ShowRandomProduct.aspx` для включения кнопка, использующая скрипт на стороне клиента, чтобы приостановить или возобновить элемент управления Timer. Элемент управления Timer имеет три метода со стороны клиента, которые можно использовать для достижения этого нужной функции.

- `_startTimer()` -начинается элемент управления Timer
- `_raiseTick()` -элемент управления таймер «метка», указывающая, тем самым, выполнение обратной передачи и вызов его `Tick` событий на сервере
- `_stopTimer()` — Останавливает элемент управления Timer

Давайте создадим файл JavaScript с помощью переменной с именем `timerEnabled` и функция с именем `ToggleTimer`. `timerEnabled` Переменной указывает состояние элемента управления Timer в настоящее время включено или отключено, по умолчанию используется значение true. `ToggleTimer` Функция принимает два входных параметра: ссылку на кнопку приостанавливать или возобновлять работу и на стороне клиента `id` значение элемента управления Timer. Эта функция переключает `timerEnabled`, возвращает ссылку на элемент управления Timer, запускает или останавливает таймер (в зависимости от значения `timerEnabled`) и обновляет отображаемый текст кнопки «Пауза» или «Возобновление». Эта функция будет вызываться при каждом нажатии кнопки приостановки и возобновления.

Начнем с создания новой папки в веб-сайт с именем `Scripts`. Добавьте новый файл в папку скриптов с именем `TimerScript.js` типа файл JScript.

[![Добавьте новый файл JavaScript в папку Scripts](master-pages-and-asp-net-ajax-cs/_static/image23.png)](master-pages-and-asp-net-ajax-cs/_static/image22.png)

**Рис 08**: Добавьте новый файл JavaScript для `Scripts` папку ([Просмотр полноразмерного изображения](master-pages-and-asp-net-ajax-cs/_static/image24.png))

[![На веб-сайт был добавлен новый файл JavaScript](master-pages-and-asp-net-ajax-cs/_static/image26.png)](master-pages-and-asp-net-ajax-cs/_static/image25.png)

**Рис 09**: На веб-сайт был добавлен новый файл JavaScript ([Просмотр полноразмерного изображения](master-pages-and-asp-net-ajax-cs/_static/image27.png))

Добавьте следующий сценарий в файл TimerScript.js:

[!code-csharp[Main](master-pages-and-asp-net-ajax-cs/samples/sample8.cs)]

Теперь нам нужно зарегистрировать этот пользовательский файл JavaScript в `ShowRandomProduct.aspx`. Вернитесь к `ShowRandomProduct.aspx` и добавить на страницу элемент управления ScriptManagerProxy, задать его `ID` для `MyManagerProxy`. Чтобы зарегистрировать пользовательским кодом JavaScript файл выберите элемент управления ScriptManagerProxy в конструкторе, а затем выберите окно "Свойства". Одно из свойств называется скриптов. При выборе этого свойства отображается редактор коллекции ScriptReference, показанный на рис. 10. Нажмите кнопку Добавить новую ссылку на скрипт и затем введите путь к файлу сценария в свойство Path: `~/Scripts/TimerScript.js`.

[![Добавьте ссылку на элемент управления ScriptManagerProxy скрипт](master-pages-and-asp-net-ajax-cs/_static/image29.png)](master-pages-and-asp-net-ajax-cs/_static/image28.png)

**Рис. 10**: Добавьте ссылку на элемент управления ScriptManagerProxy скрипт ([Просмотр полноразмерного изображения](master-pages-and-asp-net-ajax-cs/_static/image30.png))

После добавления ссылки на сценарий управления ScriptManagerProxy декларативной разметки обновляется для включения `<Scripts>` коллекции с одним `ScriptReference` запись, как в следующем примере разметки показано:

[!code-aspx[Main](master-pages-and-asp-net-ajax-cs/samples/sample9.aspx)]

`ScriptReference` Запись означает, что ScriptManagerProxy, чтобы включить ссылку на файл JavaScript в готовом для просмотра разметку. То есть путем регистрации пользовательского скрипта в ScriptManagerProxy `ShowRandomProduct.aspx` выводимые данные страницы теперь включает в себя другой `<script src="url"></script>` тега: `<script src="Scripts/TimerScript.js" type="text/javascript"></script>`.

Теперь мы можем вызвать `ToggleTimer` функции, определенной в `TimerScript.js` от клиентского скрипта в `ShowRandomProduct.aspx` страницы. Добавьте следующий код HTML внутри UpdatePanel.

[!code-aspx[Main](master-pages-and-asp-net-ajax-cs/samples/sample10.aspx)]

Отобразится кнопка с текстом «Пауза». Каждый раз, когда он выбран, функцию JavaScript `ToggleTimer` вызывается, передавая ссылку на кнопку и значение идентификатора элемента управления Timer (`ProductTimer`). Обратите внимание на синтаксис для получения `id` значение элемента управления Timer. `<%=ProductTimer.ClientID%>` выдает значение `ProductTimer` элемента управления Timer `ClientID` свойство. В [ *именовании Идентификаторов элемента управления на страницах содержимого* ](control-id-naming-in-content-pages-cs.md) руководстве мы обсудили различия между серверным `ID` значение и итоговый клиентская `id` значение и как `ClientID` возвращает клиентский `id`.

Рис. 11 показана эту страницу при первом посещении через браузер. Таймер выполняется в данный момент и обновляет сведения о продукте отображается каждые 15 секунд. Рис. 12 показан экран, после нажатия кнопки «Пауза». Нажмите кнопку Приостановка останавливает таймер и обновляет текст, кнопки «Возобновление». Сведения о продукте обновления (и продолжить обновление каждые 15 секунд), когда пользователь нажимает кнопку возобновления.

[![Нажмите эту кнопку для остановки элемента управления Timer](master-pages-and-asp-net-ajax-cs/_static/image32.png)](master-pages-and-asp-net-ajax-cs/_static/image31.png)

**Рис. 11**: Нажмите эту кнопку для остановки элемента управления Timer ([Просмотр полноразмерного изображения](master-pages-and-asp-net-ajax-cs/_static/image33.png))

[![Нажмите кнопку "Продолжить", чтобы перезапустить таймер](master-pages-and-asp-net-ajax-cs/_static/image35.png)](master-pages-and-asp-net-ajax-cs/_static/image34.png)

**Рис. 12**: Нажмите кнопку "Продолжить", чтобы перезапустить таймер ([Просмотр полноразмерного изображения](master-pages-and-asp-net-ajax-cs/_static/image36.png))

## <a name="summary"></a>Сводка

При создании поддерживающих AJAX веб-приложений с помощью платформы AJAX для ASP.NET крайне важно, что каждая веб-страница с поддержкой AJAX включают элемент управления ScriptManager. Чтобы ускорить этот процесс, мы можем добавить ScriptManager главной страницы, а не нужно запоминать для добавления ScriptManager для каждой страницы содержимого. Шаг 1, показал, как добавить ScriptManager на главную страницу во время шага 2, рассмотрели реализации функциональности AJAX на странице содержимого.

Если необходимо добавить пользовательские сценарии, ссылки на сценарий с поддержкой веб-служб или настраиваемой проверки подлинности, авторизации или служб профилирования на страницах с содержанием, добавление элемента управления ScriptManagerProxy страницы содержимого и настройте существует настроек. Шаг 3 рассмотрел использование ScriptManagerProxy регистрируемый пользовательский файл JavaScript в определенную страницу содержимого.

Счастливого вам программирования!

### <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения по темам, обсуждавшимся в этом руководстве см. в следующих ресурсах:

- [Платформа AJAX для ASP.NET](../../../../ajax/index.md)
- [Учебники по ASP.NET AJAX](../aspnet-ajax/understanding-partial-page-updates-with-asp-net-ajax.md)
- [Видеоролики по ASP.NET AJAX](../../../videos/aspnet-ajax/index.md)
- [Создание интерактивного пользовательского интерфейса с помощью Microsoft ASP.NET AJAX](http://aspnet.4guysfromrolla.com/articles/101007-1.aspx)
- [Использование функции NEWID для случайным образом Сортировка записей](http://www.sqlteam.com/article/using-newid-to-randomly-sort-records)
- [С помощью элемента управления Timer](http://aspnet.4guysfromrolla.com/articles/061808-1.aspx)

### <a name="about-the-author"></a>Об авторе

[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор из нескольких книг по ASP/ASP.NET и основатель веб-узла 4GuysFromRolla.com, работает с веб-технологиями Microsoft с 1998 года. Скотт — независимый консультант, преподаватель и автор. Его последняя книга — [ *Sams Teach самостоятельно ASP.NET 3.5 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco). Скоттом можно связаться по адресу [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com) или через его блог по адресу [ http://ScottOnWriting.NET ](http://scottonwriting.net/).

### <a name="special-thanks-to"></a>Особая благодарность

В этой серии руководств пособий рецензировалась многими компетентными редакторами. Хотите поработать с моих последующих статей для MSDN? Если Да, напишите мне [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)

> [!div class="step-by-step"]
> [Назад](interacting-with-the-content-page-from-the-master-page-cs.md)
> [Вперед](specifying-the-master-page-programmatically-cs.md)
