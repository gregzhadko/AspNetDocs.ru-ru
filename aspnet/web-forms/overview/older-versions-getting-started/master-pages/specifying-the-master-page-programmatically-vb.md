---
uid: web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
title: Программное указание главной страницы (Visual Basic) | Документация Майкрософт
author: rick-anderson
description: Ищет на уровне страницы содержимого главной страницы программно через обработчик событий PreInit.
ms.author: riande
ms.date: 07/28/2008
ms.assetid: 0edcd653-f24a-41aa-aef4-75f868fe5ac2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
msc.type: authoredcontent
ms.openlocfilehash: d075d0b66da8a0f4e2f0155c08b09a02a4ca71fb
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65106944"
---
# <a name="specifying-the-master-page-programmatically-vb"></a><span data-ttu-id="b2d5a-103">Программное указание эталонной страницы (VB)</span><span class="sxs-lookup"><span data-stu-id="b2d5a-103">Specifying the Master Page Programmatically (VB)</span></span>

<span data-ttu-id="b2d5a-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b2d5a-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b2d5a-105">[Скачать код](http://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip) или [скачать PDF](http://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="b2d5a-105">[Download Code](http://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip) or [Download PDF](http://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span></span>

> <span data-ttu-id="b2d5a-106">Ищет на уровне страницы содержимого главной страницы программно через обработчик событий PreInit.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-106">Looks at setting the content page's master page programmatically via the PreInit event handler.</span></span>

## <a name="introduction"></a><span data-ttu-id="b2d5a-107">Вступление</span><span class="sxs-lookup"><span data-stu-id="b2d5a-107">Introduction</span></span>

<span data-ttu-id="b2d5a-108">Так как в примере со вступительной статьей в [ *Создание сайта макета с помощью главных страниц*](creating-a-site-wide-layout-using-master-pages-vb.md), все содержимое страницы ссылаетесь на их главную страницу декларативно с помощью `MasterPageFile` атрибут в `@Page`директива.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-108">Since the inaugural example in [*Creating a Site-Wide Layout Using Master Pages*](creating-a-site-wide-layout-using-master-pages-vb.md), all content pages have referenced their master page declaratively via the `MasterPageFile` attribute in the `@Page` directive.</span></span> <span data-ttu-id="b2d5a-109">Например, следующая `@Page` директива связывает страницы содержимого на главную страницу `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="b2d5a-109">For example, the following `@Page` directive links the content page to the master page `Site.master`:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample1.aspx)]

<span data-ttu-id="b2d5a-110">[ `Page` Класс](https://msdn.microsoft.com/library/system.web.ui.page.aspx) в `System.Web.UI` пространство имен включает [ `MasterPageFile` свойство](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx) , возвращает путь к странице содержимого главной страницы; именно это свойство, которое устанавливается с `@Page` директива.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-110">The [`Page` class](https://msdn.microsoft.com/library/system.web.ui.page.aspx) in the `System.Web.UI` namespace includes a [`MasterPageFile` property](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx) that returns the path to the content page's master page; it is this property that is set by the `@Page` directive.</span></span> <span data-ttu-id="b2d5a-111">Это свойство также может использоваться программное указание главной страницы на странице содержимого.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-111">This property can also be used to programmatically specify the content page's master page.</span></span> <span data-ttu-id="b2d5a-112">Этот подход полезен, если вы хотите динамически назначать главной страницы, в зависимости от внешних факторов, таких как пользователя, посещающего страницу.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-112">This approach is useful if you want to dynamically assign the master page based on external factors, such as the user visiting the page.</span></span>

<span data-ttu-id="b2d5a-113">В этом руководстве мы добавьте второй главную страницу для нашего веб-сайта и динамически решать, какие главной страницы, используемой во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-113">In this tutorial we add a second master page to our website and dynamically decide which master page to use at runtime.</span></span>

## <a name="step-1-a-look-at-the-page-lifecycle"></a><span data-ttu-id="b2d5a-114">Шаг 1. Краткий обзор жизненного цикла страницы</span><span class="sxs-lookup"><span data-stu-id="b2d5a-114">Step 1: A Look at the Page Lifecycle</span></span>

<span data-ttu-id="b2d5a-115">Каждый раз, когда запрос прибывает в веб-сервера для страницы ASP.NET, которая является страницей содержимого, механизм ASP.NET необходимо объединять страницы содержимого элементов управления в файл главной страницы, соответствующая элементов управления ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-115">Whenever a request arrives at the web server for an ASP.NET page that is a content page, the ASP.NET engine must fuse the page's Content controls into the master page's corresponding ContentPlaceHolder controls.</span></span> <span data-ttu-id="b2d5a-116">Этот fusion создает иерархию одного элемента управления, который затем можно перейти через жизненный цикл страницы обычно.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-116">This fusion creates a single control hierarchy that can then proceed through the typical page lifecycle.</span></span>

<span data-ttu-id="b2d5a-117">Рис. 1 иллюстрирует этот fusion.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-117">Figure 1 illustrates this fusion.</span></span> <span data-ttu-id="b2d5a-118">Шаг 1 на рис. 1 показаны исходное содержимое и иерархий управления главной страницы.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-118">Step 1 in Figure 1 shows the initial content and master page control hierarchies.</span></span> <span data-ttu-id="b2d5a-119">Элементы управления страницы добавляются в конец этапа PreInit содержимое соответствующих элементов управления ContentPlaceHolder на главной странице (шаг 2).</span><span class="sxs-lookup"><span data-stu-id="b2d5a-119">At the tail end of the PreInit stage the Content controls in the page are added to the corresponding ContentPlaceHolders in the master page (Step 2).</span></span> <span data-ttu-id="b2d5a-120">После этого fusion главной страницы служит в качестве корневого элемента иерархии склеенную элемента управления.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-120">After this fusion, the master page serves as the root of the fused control hierarchy.</span></span> <span data-ttu-id="b2d5a-121">Это совмещенного управления иерархии затем добавляется на страницу для создания иерархии завершенных элементов управления (шаг 3).</span><span class="sxs-lookup"><span data-stu-id="b2d5a-121">This fused control hierarchy is then added to the page to produce the finalized control hierarchy (Step 3).</span></span> <span data-ttu-id="b2d5a-122">Конечным результатом является, включающее иерархии склеенную элементов управления в иерархии элементов управления страницы.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-122">The net result is that the page's control hierarchy includes the fused control hierarchy.</span></span>

<span data-ttu-id="b2d5a-123">[![Главной страницы и страницы содержимого элемента управления иерархии являются совмещенного друг с другом на этапе PreInit](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b2d5a-123">[![The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span></span>

<span data-ttu-id="b2d5a-124">**Рис 01**: Главной страницы и страницы содержимого элемента управления иерархии являются совмещенного друг с другом на этапе PreInit ([Просмотр полноразмерного изображения](specifying-the-master-page-programmatically-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="b2d5a-124">**Figure 01**: The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image3.png))</span></span>

## <a name="step-2-setting-themasterpagefileproperty-from-code"></a><span data-ttu-id="b2d5a-125">Шаг 2. Параметр`MasterPageFile`свойство из кода</span><span class="sxs-lookup"><span data-stu-id="b2d5a-125">Step 2: Setting the`MasterPageFile`Property from Code</span></span>

<span data-ttu-id="b2d5a-126">Partakes главную страницу в этом fusion зависит от значения `Page` объекта `MasterPageFile` свойство.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-126">What master page partakes in this fusion depends on the value of the `Page` object's `MasterPageFile` property.</span></span> <span data-ttu-id="b2d5a-127">Установка `MasterPageFile` атрибут в `@Page` директива имеет в итоге назначение `Page`в `MasterPageFile` свойства на этапе инициализации, который является самый первый этап жизненного цикла страницы.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-127">Setting the `MasterPageFile` attribute in the `@Page` directive has the net effect of assigning the `Page`'s `MasterPageFile` property during the Initialization stage, which is the very first stage of the page's lifecycle.</span></span> <span data-ttu-id="b2d5a-128">Мы также это свойство можно задать программным образом.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-128">We can alternatively set this property programmatically.</span></span> <span data-ttu-id="b2d5a-129">Тем не менее крайне важно, что это свойство быть задано до выполнения fusion на рис. 1.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-129">However, it is imperative that this property be set before the fusion in Figure 1 takes place.</span></span>

<span data-ttu-id="b2d5a-130">В начале этапа PreInit `Page` объекта вызывает его [ `PreInit` событий](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx) и вызывает его [ `OnPreInit` метод](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx).</span><span class="sxs-lookup"><span data-stu-id="b2d5a-130">At the start of the PreInit stage the `Page` object raises its [`PreInit` event](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx) and calls its [`OnPreInit` method](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx).</span></span> <span data-ttu-id="b2d5a-131">Чтобы программно задать главной страницы, затем мы можно создать обработчик событий для `PreInit` событий или переопределение `OnPreInit` метод.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-131">To set the master page programmatically, then, we can either create an event handler for the `PreInit` event or override the `OnPreInit` method.</span></span> <span data-ttu-id="b2d5a-132">Давайте взглянем на оба подхода.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-132">Let's look at both approaches.</span></span>

<span data-ttu-id="b2d5a-133">Сначала откройте `Default.aspx.vb`, файл класса фонового кода для домашней страницы в нашем сайте.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-133">Start by opening `Default.aspx.vb`, the code-behind class file for our site's homepage.</span></span> <span data-ttu-id="b2d5a-134">Добавьте обработчик событий для страницы `PreInit` событий, введя следующий код:</span><span class="sxs-lookup"><span data-stu-id="b2d5a-134">Add an event handler for the page's `PreInit` event by typing in the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample2.vb)]

<span data-ttu-id="b2d5a-135">Здесь можно задать `MasterPageFile` свойства.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-135">From here we can set the `MasterPageFile` property.</span></span> <span data-ttu-id="b2d5a-136">Обновите код, чтобы он присваивает значение «~ / Site.master» для `MasterPageFile` свойство.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-136">Update the code so that it assigns the value "~/Site.master" to the `MasterPageFile` property.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample3.vb)]

<span data-ttu-id="b2d5a-137">Если установить точку останова и запуск с отладкой, вы увидите, что каждый раз, когда `Default.aspx` посещенные страницы или каждый раз, когда имеется обратную передачу на эту страницу `Page_PreInit` выполнения обработчика событий и `MasterPageFile` назначается свойство «~ / Site.master».</span><span class="sxs-lookup"><span data-stu-id="b2d5a-137">If you set a breakpoint and start with debugging you'll see that whenever the `Default.aspx` page is visited or whenever there's a postback to this page, the `Page_PreInit` event handler executes and the `MasterPageFile` property is assigned to "~/Site.master".</span></span>

<span data-ttu-id="b2d5a-138">Кроме того, можно переопределить `Page` класса `OnPreInit` метод и набор `MasterPageFile` существует свойство.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-138">Alternatively, you can override the `Page` class's `OnPreInit` method and set the `MasterPageFile` property there.</span></span> <span data-ttu-id="b2d5a-139">В этом примере не установим главной страницы в конкретной страницы, а лишь из `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-139">For this example, let's not set the master page in a particular page, but rather from `BasePage`.</span></span> <span data-ttu-id="b2d5a-140">Помните, мы создали пользовательского базового класса страницы (`BasePage`) обратно в [ *указание названия, метатегов и других заголовков HTML на главной странице* ](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) руководства.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-140">Recall that we created a custom base page class (`BasePage`) back in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial.</span></span> <span data-ttu-id="b2d5a-141">В настоящее время `BasePage` переопределяет `Page` класса `OnLoadComplete` метод, где он задает страницы `Title` значение в зависимости от данных карты узла.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-141">Currently `BasePage` overrides the `Page` class's `OnLoadComplete` method, where it sets the page's `Title` property based on the site map data.</span></span> <span data-ttu-id="b2d5a-142">Давайте обновим `BasePage` также переопределить `OnPreInit` метод программное указание главной страницы.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-142">Let's update `BasePage` to also override the `OnPreInit` method to programmatically specify the master page.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample4.vb)]

<span data-ttu-id="b2d5a-143">Так как все наши страницы содержимого являются производными от `BasePage`, все они теперь имеют свои главной страницы, которые назначены программными методами.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-143">Because all our content pages derive from `BasePage`, all of them now have their master page programmatically assigned.</span></span> <span data-ttu-id="b2d5a-144">На этом этапе `PreInit` обработчик событий в `Default.aspx.vb` является излишним; вы можете удалить его.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-144">At this point the `PreInit` event handler in `Default.aspx.vb` is superfluous; feel free to remove it.</span></span>

### <a name="what-about-thepagedirective"></a><span data-ttu-id="b2d5a-145">Как насчет`@Page`директива?</span><span class="sxs-lookup"><span data-stu-id="b2d5a-145">What About the`@Page`Directive?</span></span>

<span data-ttu-id="b2d5a-146">Что может быть немного сбить с толку является то, что страницы содержимого `MasterPageFile` свойства сейчас указываются в двух местах: в обработчике `BasePage` класса `OnPreInit` метод а также `MasterPageFile` атрибут в каждую страницу содержимого `@Page` директива.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-146">What may be a little confusing is that the content pages' `MasterPageFile` properties are now being specified in two places: programmatically in the `BasePage` class's `OnPreInit` method as well as through the `MasterPageFile` attribute in each content page's `@Page` directive.</span></span>

<span data-ttu-id="b2d5a-147">Первый этап в жизненном цикле страницы находится на этапе инициализации.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-147">The first stage in the page lifecycle is the Initialization stage.</span></span> <span data-ttu-id="b2d5a-148">На этом этапе `Page` объекта `MasterPageFile` присваивается значение `MasterPageFile` атрибут в `@Page` директива (если он указан).</span><span class="sxs-lookup"><span data-stu-id="b2d5a-148">During this stage the `Page` object's `MasterPageFile` property is assigned the value of the `MasterPageFile` attribute in the `@Page` directive (if it is provided).</span></span> <span data-ttu-id="b2d5a-149">В рабочей области PreInit следует этап инициализации, и именно здесь где мы программно задать `Page` объекта `MasterPageFile` свойства, тем самым переписывая значение, присвоенное из `@Page` директива.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-149">The PreInit stage follows the Initialization stage, and it is here where we programmatically set the `Page` object's `MasterPageFile` property, thereby overwriting the value assigned from the `@Page` directive.</span></span> <span data-ttu-id="b2d5a-150">Так как мы указываем для `Page` объекта `MasterPageFile` свойства программным способом, можно устранить `MasterPageFile` из атрибута `@Page` директив без ущерба для производительности конечного пользователя.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-150">Because we are setting the `Page` object's `MasterPageFile` property programmatically, we could remove the `MasterPageFile` attribute from the `@Page` directive without affecting the end user's experience.</span></span> <span data-ttu-id="b2d5a-151">Чтобы убедиться в это, продолжим и удалить `MasterPageFile` из атрибута `@Page` директиву `Default.aspx` и перейдите на страницу через обозреватель.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-151">To convince yourself of this, go ahead and remove the `MasterPageFile` attribute from the `@Page` directive in `Default.aspx` and then visit the page through a browser.</span></span> <span data-ttu-id="b2d5a-152">Как и следовало ожидать, выводится так же, как прежде, чем атрибут был удален.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-152">As you would expect, the output is the same as before the attribute was removed.</span></span>

<span data-ttu-id="b2d5a-153">Ли `MasterPageFile` свойство задается с помощью `@Page` директива или программным образом не имеет значения, чтобы взаимодействие с пользователем.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-153">Whether the `MasterPageFile` property is set via the `@Page` directive or programmatically is inconsequential to the end user's experience.</span></span> <span data-ttu-id="b2d5a-154">Тем не менее `MasterPageFile` атрибут в `@Page` директива используется средой Visual Studio во время разработки для создания WYSIWYG представление в конструкторе.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-154">However, the `MasterPageFile` attribute in the `@Page` directive is used by Visual Studio during design-time to produce the WYSIWYG view in the Designer.</span></span> <span data-ttu-id="b2d5a-155">Если вернуться к `Default.aspx` в Visual Studio и перейдите в конструктор вы увидите сообщение «Ошибка главной страницы: Страница содержит элементы управления, которые требуют наличия ссылки главной страницы, но ничего не указано» (см. рис. 2).</span><span class="sxs-lookup"><span data-stu-id="b2d5a-155">If you return to `Default.aspx` in Visual Studio and navigate to the Designer you'll see the message, "Master Page error: The page has controls that require a Master Page reference, but none is specified" (see Figure 2).</span></span>

<span data-ttu-id="b2d5a-156">Иными словами, необходимо оставить `MasterPageFile` атрибут в `@Page` директива слушать получить обширные возможности разработки в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-156">In short, you need to leave the `MasterPageFile` attribute in the `@Page` directive to enjoy a rich design-time experience in Visual Studio.</span></span>

<span data-ttu-id="b2d5a-157">[![Visual Studio использует @Page атрибут MasterPageFile директивы для подготовки к просмотру в режим конструктора](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="b2d5a-157">[![Visual Studio Uses the @Page Directive's MasterPageFile Attribute to Render the Design View](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span></span>

<span data-ttu-id="b2d5a-158">**Рис. 02**: Visual Studio использует `@Page` директивы `MasterPageFile` атрибута для визуализации в режим конструктора ([Просмотр полноразмерного изображения](specifying-the-master-page-programmatically-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b2d5a-158">**Figure 02**: Visual Studio Uses the `@Page` Directive's `MasterPageFile` Attribute to Render the Design View  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image6.png))</span></span>

## <a name="step-3-creating-an-alternative-master-page"></a><span data-ttu-id="b2d5a-159">Шаг 3. Создание альтернатива главную страницу</span><span class="sxs-lookup"><span data-stu-id="b2d5a-159">Step 3: Creating an Alternative Master Page</span></span>

<span data-ttu-id="b2d5a-160">Так как страницу содержимого главной страницы могут устанавливаться программными средствами во время выполнения, которые можно динамически Загрузите определенной главной страницы, на основании некоторых внешних условий.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-160">Because a content page's master page can be set programmatically at runtime it's possible to dynamically load a particular master page based on some external criteria.</span></span> <span data-ttu-id="b2d5a-161">Эта возможность может быть полезна в случаях, где сайта макет должен различаться зависимости от пользователя.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-161">This functionality can be useful in situations where the site's layout needs to vary based on the user.</span></span> <span data-ttu-id="b2d5a-162">К примеру веб-приложение блога ядра может позволяют его выбран макет для их блога, где каждая структура связан с другой главной страницы.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-162">For instance, a blog engine web application may allow its users to choose a layout for their blog, where each layout is associated with a different master page.</span></span> <span data-ttu-id="b2d5a-163">Во время выполнения просматривая блога пользователя посетитель веб-приложения необходимо определить макет блога и динамически связывать соответствующей главной страницы со страницей содержимого.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-163">At runtime, when a visitor is viewing a user's blog, the web application would need to determine the blog's layout and dynamically associate the corresponding master page with the content page.</span></span>

<span data-ttu-id="b2d5a-164">Давайте рассмотрим способ динамической загрузки главной страницы во время выполнения, на основании некоторых внешних условий.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-164">Let's examine how to dynamically load a master page at runtime based on some external criteria.</span></span> <span data-ttu-id="b2d5a-165">Наш веб-сайт содержит только одну главную страницу (`Site.master`).</span><span class="sxs-lookup"><span data-stu-id="b2d5a-165">Our website currently contains just one master page (`Site.master`).</span></span> <span data-ttu-id="b2d5a-166">Нам нужен другой главной страницы, чтобы проиллюстрировать, Выбор главной страницы во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-166">We need another master page to illustrate choosing a master page at runtime.</span></span> <span data-ttu-id="b2d5a-167">Этот шаг рассматривается создание и настройка новой главной страницы.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-167">This step focuses on creating and configuring the new master page.</span></span> <span data-ttu-id="b2d5a-168">Шаг 4 ищет надо определить, какие главной страницы, используемой во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-168">Step 4 looks at determining what master page to use at runtime.</span></span>

<span data-ttu-id="b2d5a-169">Создание новой главной страницы в корневой папке с именем `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-169">Create a new master page in the root folder named `Alternate.master`.</span></span> <span data-ttu-id="b2d5a-170">Также добавить новую таблицу стилей на веб-сайт с именем `AlternateStyles.css`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-170">Also add a new style sheet to the website named `AlternateStyles.css`.</span></span>

<span data-ttu-id="b2d5a-171">[![Добавьте еще один главную страницу и CSS, файл на веб-сайт](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b2d5a-171">[![Add Another Master Page and CSS File to the Website](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span></span>

<span data-ttu-id="b2d5a-172">**Рис 03**: Добавить другой главной страницы и CSS-файл на веб-сайт ([Просмотр полноразмерного изображения](specifying-the-master-page-programmatically-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="b2d5a-172">**Figure 03**: Add Another Master Page and CSS File to the Website  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image9.png))</span></span>

<span data-ttu-id="b2d5a-173">Я разработал `Alternate.master` главной страницы, чтобы заголовок, отображаемый в верхней части страницы, по центру и на темно-синего цвета фона.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-173">I've designed the `Alternate.master` master page to have the title displayed at the top of the page, centered and on a navy background.</span></span> <span data-ttu-id="b2d5a-174">Я выданных левого столбца и перемещены, содержимое под `MainContent` управления ContentPlaceHolder, который теперь распространяется на всю ширину страницы.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-174">I've dispensed of the left column and moved that content beneath the `MainContent` ContentPlaceHolder control, which now spans the entire width of the page.</span></span> <span data-ttu-id="b2d5a-175">Кроме того, одобрила неупорядоченный список занятий и заменены горизонтальный список выше `MainContent`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-175">Furthermore, I nixed the unordered Lessons list and replaced it with a horizontal list above `MainContent`.</span></span> <span data-ttu-id="b2d5a-176">Также обновим шрифтов и цветов, используемых главной страницы (и, следовательно, и его страниц).</span><span class="sxs-lookup"><span data-stu-id="b2d5a-176">I also updated the fonts and colors used by the master page (and, by extension, its content pages).</span></span> <span data-ttu-id="b2d5a-177">Рис. 4 показан `Default.aspx` при использовании `Alternate.master` главной страницы.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-177">Figure 4 shows `Default.aspx` when using the `Alternate.master` master page.</span></span>

> [!NOTE]
> <span data-ttu-id="b2d5a-178">ASP.NET включает в себя возможность определить *темы*.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-178">ASP.NET includes the ability to define *Themes*.</span></span> <span data-ttu-id="b2d5a-179">Тема — коллекция изображений, CSS-файлов, относящихся к стилю параметры и веб-элемента управления свойства, которые могут применяться к странице во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-179">A Theme is a collection of images, CSS files, and style-related Web control property settings that can be applied to a page at runtime.</span></span> <span data-ttu-id="b2d5a-180">Темы — способ перейти, если веб сайта макеты отличаются только в изображений, отображаемых и их правила CSS.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-180">Themes are the way to go if your site's layouts differ only in the images displayed and by their CSS rules.</span></span> <span data-ttu-id="b2d5a-181">Если макеты отличаются более значительно, например с помощью различных веб-элементов управления или необходимости радикально другой макет, затем необходимо будет использовать отдельный главные страницы.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-181">If the layouts differ more substantially, such as using different Web controls or having a radically different layout, then you will need to use separate master pages.</span></span> <span data-ttu-id="b2d5a-182">Обратитесь к дополнительными материалами в конце этого руководства, Дополнительные сведения о темах.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-182">Consult the Further Reading section at the end of this tutorial for more information on Themes.</span></span>

<span data-ttu-id="b2d5a-183">[![Страниц содержимого теперь можно использовать новый интерфейс](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="b2d5a-183">[![Our Content Pages Can Now Use a New Look and Feel](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span></span>

<span data-ttu-id="b2d5a-184">**Рис. 04**: Страниц содержимого теперь можно использовать новый интерфейс ([Просмотр полноразмерного изображения](specifying-the-master-page-programmatically-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="b2d5a-184">**Figure 04**: Our Content Pages Can Now Use a New Look and Feel ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image12.png))</span></span>

<span data-ttu-id="b2d5a-185">Когда главным и разметки страницы содержимого включенные, `MasterPage` класса проверки, чтобы убедиться, что каждый содержимое ContentPlaceHolder на главной странице, ссылается на элемент управления на странице содержимого.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-185">When the master and content pages' markup are fused, the `MasterPage` class checks to ensure that every Content control in the content page references a ContentPlaceHolder in the master page.</span></span> <span data-ttu-id="b2d5a-186">Исключение возникает в том случае, если найден элемент управления содержимым, который ссылается на несуществующий ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-186">An exception is thrown if a Content control that references a non-existent ContentPlaceHolder is found.</span></span> <span data-ttu-id="b2d5a-187">Другими словами, крайне важно наличие ContentPlaceHolder, назначаемый страницы содержимого главной страницы для каждого содержимого элемента управления на странице содержимого.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-187">In other words, it is imperative that the master page being assigned to the content page have a ContentPlaceHolder for each Content control in the content page.</span></span>

<span data-ttu-id="b2d5a-188">`Site.master` Главной страницы включает четыре элемента управления ContentPlaceHolder:</span><span class="sxs-lookup"><span data-stu-id="b2d5a-188">The `Site.master` master page includes four ContentPlaceHolder controls:</span></span>

- `head`
- `MainContent`
- `QuickLoginUI`
- `LeftColumnContent`

<span data-ttu-id="b2d5a-189">Некоторые из страниц содержимого в наш веб-сайт включают только одного или двух элементов управления содержимым; другие варианты включают элемент управления содержимым для каждого из доступных элементов управления ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-189">Some of the content pages in our website include just one or two Content controls; others include a Content control for each of the available ContentPlaceHolders.</span></span> <span data-ttu-id="b2d5a-190">Если новый нас на главной странице (`Alternate.master`) когда-нибудь может назначаться для этих страниц, которые содержат элементы управления содержимым для всех элементов управления ContentPlaceHolder в `Site.master` то очень важно, `Alternate.master` также включают те же элементы управления ContentPlaceHolder, как `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-190">If our new master page (`Alternate.master`) may ever be assigned to those content pages that have Content controls for all of the ContentPlaceHolders in `Site.master` then it is essential that `Alternate.master` also include the same ContentPlaceHolder controls as `Site.master`.</span></span>

<span data-ttu-id="b2d5a-191">Чтобы получить ваши `Alternate.master` главной страницы, чтобы выглядеть примерно так, чтобы анализировать (см. рис. 4), начинается с определения стилей на главной странице в `AlternateStyles.css` стилей.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-191">To get your `Alternate.master` master page to look similar to mine (see Figure 4), start by defining the master page's styles in the `AlternateStyles.css` style sheet.</span></span> <span data-ttu-id="b2d5a-192">Добавьте следующие правила в `AlternateStyles.css`:</span><span class="sxs-lookup"><span data-stu-id="b2d5a-192">Add the following rules into `AlternateStyles.css`:</span></span>

[!code-css[Main](specifying-the-master-page-programmatically-vb/samples/sample5.css)]

<span data-ttu-id="b2d5a-193">Затем добавьте следующие декларативная разметка для `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-193">Next, add the following declarative markup to `Alternate.master`.</span></span> <span data-ttu-id="b2d5a-194">Как вы видите, `Alternate.master` содержит четыре элемента управления ContentPlaceHolder с тем же `ID` значения, что и элементы управления ContentPlaceHolder `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-194">As you can see, `Alternate.master` contains four ContentPlaceHolder controls with the same `ID` values as the ContentPlaceHolder controls in `Site.master`.</span></span> <span data-ttu-id="b2d5a-195">Кроме того он включает элемент управления ScriptManager, который необходим для этих страниц в наш веб-сайт, использующих платформа AJAX для ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-195">Moreover, it includes a ScriptManager control, which is necessary for those pages in our website that use the ASP.NET AJAX framework.</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample6.aspx)]

### <a name="testing-the-new-master-page"></a><span data-ttu-id="b2d5a-196">Тестирование новой главной страницы</span><span class="sxs-lookup"><span data-stu-id="b2d5a-196">Testing the New Master Page</span></span>

<span data-ttu-id="b2d5a-197">Чтобы проверить это новое обновление главной страницы `BasePage` класса `OnPreInit` метод, чтобы `MasterPageFile` свойству присваивается значение `"~/Alternate.maser"` и посетите веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-197">To test this new master page update the `BasePage` class's `OnPreInit` method so that the `MasterPageFile` property is assigned the value `"~/Alternate.maser"` and then visit the website.</span></span> <span data-ttu-id="b2d5a-198">Каждой странице, должны работать без ошибок, за исключением двух: `~/Admin/AddProduct.aspx` и `~/Admin/Products.aspx`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-198">Every page should function without error except for two: `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="b2d5a-199">Добавление продукта к элементу управления DetailsView в `~/Admin/AddProduct.aspx` приводит `NullReferenceException` из строки кода, который пытается установить на главной странице `GridMessageText` свойство.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-199">Adding a product to the DetailsView in `~/Admin/AddProduct.aspx` results in a `NullReferenceException` from the line of code that attempts to set the master page's `GridMessageText` property.</span></span> <span data-ttu-id="b2d5a-200">При посещении `~/Admin/Products.aspx` `InvalidCastException` возникает исключение при загрузке страницы с сообщением: «Не удалось привести объект типа "ASP.alternate\_master" к типу "ASP.site\_master".»</span><span class="sxs-lookup"><span data-stu-id="b2d5a-200">When visiting `~/Admin/Products.aspx` an `InvalidCastException` is thrown on page load with the message: "Unable to cast object of type 'ASP.alternate\_master' to type 'ASP.site\_master'."</span></span>

<span data-ttu-id="b2d5a-201">Эти ошибки возникают, поскольку `Site.master` кода класс содержит открытые события, свойства и методы, которые не определены в `Alternate.master`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-201">These errors occur because the `Site.master` code-behind class includes public events, properties, and methods that are not defined in `Alternate.master`.</span></span> <span data-ttu-id="b2d5a-202">У части эти две страницы, содержащей разметку `@MasterType` директива, которая ссылается на `Site.master` главной страницы.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-202">The markup portion of these two pages have a `@MasterType` directive that references the `Site.master` master page.</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample7.aspx)]

<span data-ttu-id="b2d5a-203">Кроме того, в элементе DetailsView `ItemInserted` обработчик событий в `~/Admin/AddProduct.aspx` включает в себя код, к которому приводятся слабо типизированной `Page.Master` свойство для объекта типа `Site`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-203">Also, the DetailsView's `ItemInserted` event handler in `~/Admin/AddProduct.aspx` includes code that casts the loosely-typed `Page.Master` property to an object of type `Site`.</span></span> <span data-ttu-id="b2d5a-204">`@MasterType` Директива (используется таким образом) и приведения в `ItemInserted` жестко связывает обработчик событий `~/Admin/AddProduct.aspx` и `~/Admin/Products.aspx` страниц к `Site.master` главной страницы.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-204">The `@MasterType` directive (used this way) and the cast in the `ItemInserted` event handler tightly couples the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to the `Site.master` master page.</span></span>

<span data-ttu-id="b2d5a-205">Для прерывания этой тесной связи, мы сможем `Site.master` и `Alternate.master` являются производными от общий базовый класс, который содержит определения для открытых членов.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-205">To break this tight coupling we can have `Site.master` and `Alternate.master` derive from a common base class that contains definitions for the public members.</span></span> <span data-ttu-id="b2d5a-206">После этого, мы можем обновить `@MasterType` директиву, чтобы ссылаться на этот общий базовый тип.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-206">Following that, we can update the `@MasterType` directive to reference this common base type.</span></span>

### <a name="creating-a-custom-base-master-page-class"></a><span data-ttu-id="b2d5a-207">Создание класса пользовательской базы главной страницы</span><span class="sxs-lookup"><span data-stu-id="b2d5a-207">Creating a Custom Base Master Page Class</span></span>

<span data-ttu-id="b2d5a-208">Добавьте новый файл класса для `App_Code` папку с именем `BaseMasterPage.vb` , который будет наследовать `System.Web.UI.MasterPage`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-208">Add a new class file to the `App_Code` folder named `BaseMasterPage.vb` and have it derive from `System.Web.UI.MasterPage`.</span></span> <span data-ttu-id="b2d5a-209">Необходимо определить `RefreshRecentProductsGrid` метод и `GridMessageText` свойство в `BaseMasterPage`, но мы не можем перевести просто туда, из `Site.master` так, как эти члены работают с веб-элементы управления, относящиеся к `Site.master` главной страницы ( `RecentProducts` GridView и `GridMessage` метки).</span><span class="sxs-lookup"><span data-stu-id="b2d5a-209">We need to define the `RefreshRecentProductsGrid` method and the `GridMessageText` property in `BaseMasterPage`, but we can't simply move them there from `Site.master` because these members work with Web controls that are specific to the `Site.master` master page (the `RecentProducts` GridView and `GridMessage` Label).</span></span>

<span data-ttu-id="b2d5a-210">Нам нужно будет настроить `BaseMasterPage` таким образом, что эти члены определяются существует, но на самом деле реализованы с `BaseMasterPage`производных классах (`Site.master` и `Alternate.master`).</span><span class="sxs-lookup"><span data-stu-id="b2d5a-210">What we need to do is configure `BaseMasterPage` in such a way that these members are defined there, but are actually implemented by `BaseMasterPage`'s derived classes (`Site.master` and `Alternate.master`).</span></span> <span data-ttu-id="b2d5a-211">Этот тип наследования возможна, помечая класс как `MustInherit` и его члены как `MustOverride`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-211">This type of inheritance is possible by marking the class as `MustInherit` and its members as `MustOverride`.</span></span> <span data-ttu-id="b2d5a-212">Короче говоря, добавив эти ключевые слова к классу и его членами объявляет о выпуске, `BaseMasterPage` еще не реализован `RefreshRecentProductsGrid` и `GridMessageText`, но это будет его производных классов.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-212">In short, adding these keywords to the class and its two members announces that `BaseMasterPage` hasn't implemented `RefreshRecentProductsGrid` and `GridMessageText`, but that its derived classes will.</span></span>

<span data-ttu-id="b2d5a-213">Мы также необходимо определить `PricesDoubled` событие в `BaseMasterPage` и предоставляют средства производными классами для вызова события.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-213">We also need to define the `PricesDoubled` event in `BaseMasterPage` and provide a means by the derived classes to raise the event.</span></span> <span data-ttu-id="b2d5a-214">Шаблон, используемый в .NET Framework, чтобы упростить это поведение — создайте открытое событие в базовом классе и добавить защищенную, переопределяемую метод с именем `OnEventName`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-214">The pattern used in the .NET Framework to facilitate this behavior is to create a public event in the base class and add a protected, overridable method named `OnEventName`.</span></span> <span data-ttu-id="b2d5a-215">Производные классы затем можно вызвать этот метод для вызова события или его для выполнения кода непосредственно перед или после события можно переопределить.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-215">Derived classes can then call this method to raise the event or can override it to execute code immediately before or after the event is raised.</span></span>

<span data-ttu-id="b2d5a-216">Обновление вашей `BaseMasterPage` таким образом, чтобы он содержит следующий код:</span><span class="sxs-lookup"><span data-stu-id="b2d5a-216">Update your `BaseMasterPage` class so that it contains the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample8.vb)]

<span data-ttu-id="b2d5a-217">Перейдите к `Site.master` кода класса и его производными `BaseMasterPage`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-217">Next, go to the `Site.master` code-behind class and have it derive from `BaseMasterPage`.</span></span> <span data-ttu-id="b2d5a-218">Так как `BaseMasterPage` содержит элементы, отмеченные `MustOverride` нам нужно переопределить эти члены в `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-218">Because `BaseMasterPage` contains members marked `MustOverride` we need to override those members here in `Site.master`.</span></span> <span data-ttu-id="b2d5a-219">Добавление `Overrides` ключевое слово для определения методов и свойств.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-219">Add the `Overrides` keyword to the method and property definitions.</span></span> <span data-ttu-id="b2d5a-220">Также обновить код, который вызывает `PricesDoubled` событие в `DoublePrice` кнопки `Click` обработчик событий с помощью вызова на базовый класс `OnPricesDoubled` метод.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-220">Also update the code that raises the `PricesDoubled` event in the `DoublePrice` Button's `Click` event handler with a call to the base class's `OnPricesDoubled` method.</span></span>

<span data-ttu-id="b2d5a-221">После внесения этих изменений `Site.master` вспомогательного класса должен содержать следующий код:</span><span class="sxs-lookup"><span data-stu-id="b2d5a-221">After these modifications the `Site.master` code-behind class should contain the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample9.vb)]

<span data-ttu-id="b2d5a-222">Необходимо также обновить `Alternate.master`элемента вспомогательного класса для наследования от `BaseMasterPage` и переопределите два `MustOverride` членов.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-222">We also need to update `Alternate.master`'s code-behind class to derive from `BaseMasterPage` and override the two `MustOverride` members.</span></span> <span data-ttu-id="b2d5a-223">Но поскольку `Alternate.master` не содержит элемент управления GridView, что списки самым свежим продуктам и меткой, которая выводит сообщение после нового продукта не добавляется в базу данных, эти методы не нужно ничего делать.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-223">But because `Alternate.master` does not contain a GridView that lists the most recent products nor a Label that displays a message after a new product is added to the database, these methods do not need to do anything.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample10.vb)]

### <a name="referencing-the-base-master-page-class"></a><span data-ttu-id="b2d5a-224">Ссылка на класс страницы Base Master</span><span class="sxs-lookup"><span data-stu-id="b2d5a-224">Referencing the Base Master Page Class</span></span>

<span data-ttu-id="b2d5a-225">Теперь, когда мы завершили `BaseMasterPage` класса и имеете наши два главных страниц, расширяет его, последним этапом является обновление `~/Admin/AddProduct.aspx` и `~/Admin/Products.aspx` страниц для ссылки на данный общий тип.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-225">Now that we have completed the `BaseMasterPage` class and have our two master pages extending it, our final step is to update the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to refer to this common type.</span></span> <span data-ttu-id="b2d5a-226">Сначала измените `@MasterType` директив в обе страницы из:</span><span class="sxs-lookup"><span data-stu-id="b2d5a-226">Start by changing the `@MasterType` directive in both pages from:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample11.aspx)]

<span data-ttu-id="b2d5a-227">В:</span><span class="sxs-lookup"><span data-stu-id="b2d5a-227">To:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample12.aspx)]

<span data-ttu-id="b2d5a-228">Вместо ссылки на путь к файлу, `@MasterType` теперь ссылается на базовый тип (`BaseMasterPage`).</span><span class="sxs-lookup"><span data-stu-id="b2d5a-228">Rather than referencing a file path, the `@MasterType` property now references the base type (`BaseMasterPage`).</span></span> <span data-ttu-id="b2d5a-229">Следовательно, строго типизированный `Master` свойство используется в классах кода обе страницы больше не типа `BaseMasterPage` (вместо типа `Site`).</span><span class="sxs-lookup"><span data-stu-id="b2d5a-229">Consequently, the strongly-typed `Master` property used in both pages' code-behind classes is now of type `BaseMasterPage` (instead of type `Site`).</span></span> <span data-ttu-id="b2d5a-230">Это изменение на месте пересмотреть `~/Admin/Products.aspx`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-230">With this change in place revisit `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="b2d5a-231">Ранее, это привело к ошибке приведения так, как страница настроена для использования `Alternate.master` главной страницы, но `@MasterType` директивы ссылки на `Site.master` файл.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-231">Previously, this resulted in a casting error because the page is configured to use the `Alternate.master` master page, but the `@MasterType` directive referenced the `Site.master` file.</span></span> <span data-ttu-id="b2d5a-232">Но теперь отображает без ошибок.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-232">But now the page renders without error.</span></span> <span data-ttu-id="b2d5a-233">Это обусловлено `Alternate.master` главной страницы может быть приведен к объекту типа `BaseMasterPage` (поскольку он расширяет его).</span><span class="sxs-lookup"><span data-stu-id="b2d5a-233">This is because the `Alternate.master` master page can be cast to an object of type `BaseMasterPage` (since it extends it).</span></span>

<span data-ttu-id="b2d5a-234">Имеется одно небольшое изменение, который должен выполняться в `~/Admin/AddProduct.aspx`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-234">There's one small change that needs to be made in `~/Admin/AddProduct.aspx`.</span></span> <span data-ttu-id="b2d5a-235">Элемента управления DetailsView `ItemInserted` обработчик событий использует оба строго типизированный `Master` свойство и слабо типизированной `Page.Master` свойство.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-235">The DetailsView control's `ItemInserted` event handler uses both the strongly-typed `Master` property and the loosely-typed `Page.Master` property.</span></span> <span data-ttu-id="b2d5a-236">Мы исправили строго типизированную ссылку, когда мы обновили `@MasterType` директива, но мы по-прежнему необходимо обновить слабо типизированную ссылку.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-236">We fixed the strongly-typed reference when we updated the `@MasterType` directive, but we still need to update the loosely-typed reference.</span></span> <span data-ttu-id="b2d5a-237">Замените следующую строку кода:</span><span class="sxs-lookup"><span data-stu-id="b2d5a-237">Replace the following line of code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample13.vb)]

<span data-ttu-id="b2d5a-238">Следующим образом, что приводит к `Page.Master` к базовому типу:</span><span class="sxs-lookup"><span data-stu-id="b2d5a-238">With the following, which casts `Page.Master` to the base type:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample14.vb)]

## <a name="step-4-determining-what-master-page-to-bind-to-the-content-pages"></a><span data-ttu-id="b2d5a-239">Шаг 4. Определить, какие главной страницы для привязки к страницам содержимого</span><span class="sxs-lookup"><span data-stu-id="b2d5a-239">Step 4: Determining What Master Page to Bind to the Content Pages</span></span>

<span data-ttu-id="b2d5a-240">Наши `BasePage` класс в настоящее время устанавливает все страницы содержимого `MasterPageFile` свойства для жестко запрограммированных значений в PreInit этапа жизненного цикла страницы.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-240">Our `BasePage` class currently sets all content pages' `MasterPageFile` properties to a hard-coded value in the PreInit stage of the page lifecycle.</span></span> <span data-ttu-id="b2d5a-241">Мы можем обновить этот код для главной страницы на внешних признакам.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-241">We can update this code to base the master page on some external factor.</span></span> <span data-ttu-id="b2d5a-242">Возможно главной страницы для загрузки зависит от предпочтений пользователя, выполнившего вход.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-242">Perhaps the master page to load depends on the preferences of the currently logged on user.</span></span> <span data-ttu-id="b2d5a-243">В этом случае необходимо написать код `OnPreInit` метод в `BasePage` , ищет главной страницы в настоящее время выполняется посещение пользовательских настроек.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-243">In that case, we'd need to write code in the `OnPreInit` method in `BasePage` that looks up the currently visiting user's master page preferences.</span></span>

<span data-ttu-id="b2d5a-244">Давайте создадим страницу, которая позволяет пользователю выбрать главную страницу для использования - `Site.master` или `Alternate.master` - и сохранить этот выбор в переменной сеанса.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-244">Let's create a web page that allows the user to choose which master page to use - `Site.master` or `Alternate.master` - and save this choice in a Session variable.</span></span> <span data-ttu-id="b2d5a-245">Начнем с создания нового веб-страницы в корневом каталоге с именем `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-245">Start by creating a new web page in the root directory named `ChooseMasterPage.aspx`.</span></span> <span data-ttu-id="b2d5a-246">При создании этой странице (или любые другие страницы содержимого этого момента) не нужно привязать его к главной странице, так как главной страницы устанавливается программно `BasePage`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-246">When creating this page (or any other content pages henceforth) you don't need to bind it to a master page because the master page is set programmatically in `BasePage`.</span></span> <span data-ttu-id="b2d5a-247">Тем не менее если новая страница не привязан к главной странице то декларативная разметка по умолчанию новая страница содержит веб-формы и другие материалы, предоставляемые главной страницы.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-247">However, if you do not bind the new page to a master page then the new page's default declarative markup contains a Web Form and other content supplied by the master page.</span></span> <span data-ttu-id="b2d5a-248">Вам потребуется вручную заменить эту разметку соответствующие элементы управления содержимым.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-248">You'll need to manually replace this markup with the appropriate Content controls.</span></span> <span data-ttu-id="b2d5a-249">По этой причине мне проще привязать новую страницу ASP.NET к главной странице.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-249">For that reason, I find it easier to bind the new ASP.NET page to a master page.</span></span>

> [!NOTE]
> <span data-ttu-id="b2d5a-250">Так как `Site.master` и `Alternate.master` же задали элементов управления ContentPlaceHolder неважно, какие главной страницы, выбирается при создании новой страницы содержимого.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-250">Because `Site.master` and `Alternate.master` have the same set of ContentPlaceHolder controls it doesn't matter what master page you choose when creating the new content page.</span></span> <span data-ttu-id="b2d5a-251">Для обеспечения согласованности, я бы предложил с помощью `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-251">For consistency, I'd suggest using `Site.master`.</span></span>

<span data-ttu-id="b2d5a-252">[![Добавьте новую страницу содержимого на веб-сайт](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="b2d5a-252">[![Add a New Content Page to the Website](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span></span>

<span data-ttu-id="b2d5a-253">**05 рис**: Добавьте новую страницу содержимого на веб-сайт ([Просмотр полноразмерного изображения](specifying-the-master-page-programmatically-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="b2d5a-253">**Figure 05**: Add a New Content Page to the Website ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image15.png))</span></span>

<span data-ttu-id="b2d5a-254">Обновление `Web.sitemap` файл, чтобы включить запись для этого занятия.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-254">Update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="b2d5a-255">Добавьте следующую разметку под `<siteMapNode>` занятия главные страницы и ASP.NET AJAX:</span><span class="sxs-lookup"><span data-stu-id="b2d5a-255">Add the following markup beneath the `<siteMapNode>` for the Master Pages and ASP.NET AJAX lesson:</span></span>

[!code-xml[Main](specifying-the-master-page-programmatically-vb/samples/sample15.xml)]

<span data-ttu-id="b2d5a-256">Прежде чем добавлять любое содержимое, `ChooseMasterPage.aspx` страницы Отвлекитесь и обновить вспомогательному классу страницы, чтобы сделать его производным от `BasePage` (а не `System.Web.UI.Page`).</span><span class="sxs-lookup"><span data-stu-id="b2d5a-256">Before adding any content to the `ChooseMasterPage.aspx` page take a moment to update the page's code-behind class so that it derives from `BasePage` (rather than `System.Web.UI.Page`).</span></span> <span data-ttu-id="b2d5a-257">Затем добавьте элемент управления DropDownList на страницу, задайте его `ID` свойства `MasterPageChoice`, и добавьте два ListItems с `Text` значения «~ / Site.master» и «~ / Alternate.master».</span><span class="sxs-lookup"><span data-stu-id="b2d5a-257">Next, add a DropDownList control to the page, set its `ID` property to `MasterPageChoice`, and add two ListItems with the `Text` values of "~/Site.master" and "~/Alternate.master".</span></span>

<span data-ttu-id="b2d5a-258">Добавьте кнопку веб-элемент управления на страницу и задайте его `ID` и `Text` свойства `SaveLayout` и «Выбор макета сохранить», соответственно.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-258">Add a Button Web control to the page and set its `ID` and `Text` properties to `SaveLayout` and "Save Layout Choice", respectively.</span></span> <span data-ttu-id="b2d5a-259">На этом этапе декларативная разметка страницы должна выглядеть следующего вида:</span><span class="sxs-lookup"><span data-stu-id="b2d5a-259">At this point your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample16.aspx)]

<span data-ttu-id="b2d5a-260">При первом посещении страницы необходимо отобразить выбранный главную страницу выбора пользователя.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-260">When the page is first visited we need to display the user's currently selected master page choice.</span></span> <span data-ttu-id="b2d5a-261">Создание `Page_Load` обработчик событий и добавьте следующий код:</span><span class="sxs-lookup"><span data-stu-id="b2d5a-261">Create a `Page_Load` event handler and add the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample17.vb)]

<span data-ttu-id="b2d5a-262">Приведенный выше код выполняется только при первом посещении страницы (а не при последующих обратных передачах).</span><span class="sxs-lookup"><span data-stu-id="b2d5a-262">The above code executes only on the first page visit (and not on subsequent postbacks).</span></span> <span data-ttu-id="b2d5a-263">Сначала она проверяет наличие переменной сеанса `MyMasterPage` существует.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-263">It first checks to see if the Session variable `MyMasterPage` exists.</span></span> <span data-ttu-id="b2d5a-264">Если Да, предпринимается попытка найти соответствующий элемент списка в `MasterPageChoice` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-264">If it does, it attempts to find the matching ListItem in the `MasterPageChoice` DropDownList.</span></span> <span data-ttu-id="b2d5a-265">Если найден соответствующий ListItem, его `Selected` свойству `True`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-265">If a matching ListItem is found, its `Selected` property is set to `True`.</span></span>

<span data-ttu-id="b2d5a-266">Также необходимо написать код, который сохраняет выбора пользователя в `MyMasterPage` переменной сеанса.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-266">We also need code that saves the user's choice into the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="b2d5a-267">Создайте обработчик событий для `SaveLayout` кнопки `Click` событий и добавьте следующий код:</span><span class="sxs-lookup"><span data-stu-id="b2d5a-267">Create an event handler for the `SaveLayout` Button's `Click` event and add the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample18.vb)]

> [!NOTE]
> <span data-ttu-id="b2d5a-268">К моменту `Click` выполнения обработчика событий при обратной передаче, главной страницы уже выбран.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-268">By the time the `Click` event handler executes on postback, the master page has already been selected.</span></span> <span data-ttu-id="b2d5a-269">Таким образом выбора с раскрывающимся списком пользователя не будет действовать, пока не посетите следующую страницу.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-269">Therefore, the user's drop-down list selection won't be in effect until the next page visit.</span></span> <span data-ttu-id="b2d5a-270">`Response.Redirect` Заставляет браузер, чтобы повторно запросить `ChooseMasterPage.aspx`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-270">The `Response.Redirect` forces the browser to re-request `ChooseMasterPage.aspx`.</span></span>

<span data-ttu-id="b2d5a-271">С помощью `ChooseMasterPage.aspx` страница полностью, наша последняя задача — иметь `BasePage` назначить `MasterPageFile` значение в зависимости от значения `MyMasterPage` переменной сеанса.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-271">With the `ChooseMasterPage.aspx` page complete, our final task is to have `BasePage` assign the `MasterPageFile` property based on the value of the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="b2d5a-272">Если не задано переменной сеанса `BasePage` по умолчанию `Site.master`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-272">If the Session variable is not set have `BasePage` default to `Site.master`.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample19.vb)]

> [!NOTE]
> <span data-ttu-id="b2d5a-273">После перемещения кода, который назначает `Page` объекта `MasterPageFile` свойство из `OnPreInit` обработчик событий и на два отдельных метода.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-273">I moved the code that assigns the `Page` object's `MasterPageFile` property out of the `OnPreInit` event handler and into two separate methods.</span></span> <span data-ttu-id="b2d5a-274">Это первый метод `SetMasterPageFile`, назначает `MasterPageFile` свойства равным значению, возвращенному методом второй `GetMasterPageFileFromSession`.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-274">This first method, `SetMasterPageFile`, assigns the `MasterPageFile` property to the value returned by the second method, `GetMasterPageFileFromSession`.</span></span> <span data-ttu-id="b2d5a-275">Отмеченное `SetMasterPageFile` метод `Overridable` таким образом, чтобы будущие классы, расширяющие `BasePage` можно при необходимости переопределить его, чтобы реализовать пользовательскую логику, при необходимости.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-275">I marked the `SetMasterPageFile` method `Overridable` so that future classes that extend `BasePage` can optionally override it to implement custom logic, if needed.</span></span> <span data-ttu-id="b2d5a-276">Мы рассмотрим пример переопределения `BasePage`в `SetMasterPageFile` свойство в следующем учебном курсе.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-276">We'll see an example of overriding `BasePage`'s `SetMasterPageFile` property in the next tutorial.</span></span>

<span data-ttu-id="b2d5a-277">Этот код в месте, посетите `ChooseMasterPage.aspx` страницы.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-277">With this code in place, visit the `ChooseMasterPage.aspx` page.</span></span> <span data-ttu-id="b2d5a-278">Изначально `Site.master` Главная страница является выбранный (см. рис. 6), но пользователь может выбрать другой главной страницы из раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-278">Initially, the `Site.master` master page is selected (see Figure 6), but the user can pick a different master page from the drop-down list.</span></span>

<span data-ttu-id="b2d5a-279">[![Страницы содержимого, отображаются с помощью Site.master главной страницы](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="b2d5a-279">[![Content Pages are Displayed Using the Site.master Master Page](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span></span>

<span data-ttu-id="b2d5a-280">**Рис 06**: Содержимое страницы, отображаемых с помощью `Site.master` главной страницы ([Просмотр полноразмерного изображения](specifying-the-master-page-programmatically-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="b2d5a-280">**Figure 06**: Content Pages are Displayed Using the `Site.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image18.png))</span></span>

<span data-ttu-id="b2d5a-281">[![Страницы содержимого теперь отображаются с помощью Alternate.master главной страницы](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="b2d5a-281">[![Content Pages are Now Displayed Using the Alternate.master Master Page](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span></span>

<span data-ttu-id="b2d5a-282">**07 рис**: Содержимое страницы, теперь отображаются с помощью `Alternate.master` главной страницы ([Просмотр полноразмерного изображения](specifying-the-master-page-programmatically-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="b2d5a-282">**Figure 07**: Content Pages are Now Displayed Using the `Alternate.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image21.png))</span></span>

## <a name="summary"></a><span data-ttu-id="b2d5a-283">Сводка</span><span class="sxs-lookup"><span data-stu-id="b2d5a-283">Summary</span></span>

<span data-ttu-id="b2d5a-284">При посещении страницы содержимого, его элементы управления содержимым включенные с помощью элементов управления ContentPlaceHolder главной страницы.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-284">When a content page is visited, its Content controls are fused with its master page's ContentPlaceHolder controls.</span></span> <span data-ttu-id="b2d5a-285">Страницы содержимого главной страницы обозначается `Page` класса `MasterPageFile` свойство, которое назначено типу `@Page` директивы `MasterPageFile` атрибут во время этапа инициализации.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-285">The content page's master page is denoted by the `Page` class's `MasterPageFile` property, which is assigned to the `@Page` directive's `MasterPageFile` attribute during the Initialization stage.</span></span> <span data-ttu-id="b2d5a-286">Что в этом учебнике показано, можно назначить значение `MasterPageFile` свойства, пока мы этого до окончания этапа PreInit.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-286">As this tutorial showed, we can assign a value to the `MasterPageFile` property as long as we do so before the end of the PreInit stage.</span></span> <span data-ttu-id="b2d5a-287">Возможность программно указать главную страницу открывает возможность для более сложных сценариев, такие как динамическая привязка страницы содержимого на главную страницу, в зависимости от внешних факторов.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-287">Being able to programmatically specify the master page opens the door for more advanced scenarios, such as dynamically binding a content page to a master page based on external factors.</span></span>

<span data-ttu-id="b2d5a-288">Счастливого вам программирования!</span><span class="sxs-lookup"><span data-stu-id="b2d5a-288">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="b2d5a-289">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="b2d5a-289">Further Reading</span></span>

<span data-ttu-id="b2d5a-290">Дополнительные сведения по темам, обсуждавшимся в этом руководстве см. в следующих ресурсах:</span><span class="sxs-lookup"><span data-stu-id="b2d5a-290">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="b2d5a-291">Схема жизненного цикла страницы ASP.NET</span><span class="sxs-lookup"><span data-stu-id="b2d5a-291">ASP.NET Page Lifecycle Diagram</span></span>](http://emanish.googlepages.com/Asp.Net2.0Lifecycle.PNG)
- [<span data-ttu-id="b2d5a-292">Общие сведения о жизненном цикле страницы ASP.NET</span><span class="sxs-lookup"><span data-stu-id="b2d5a-292">ASP.NET Page Lifecycle Overview</span></span>](https://msdn.microsoft.com/library/ms178472.aspx)
- [<span data-ttu-id="b2d5a-293">ASP.NET темы и обложки</span><span class="sxs-lookup"><span data-stu-id="b2d5a-293">ASP.NET Themes and Skins Overview</span></span>](https://msdn.microsoft.com/library/ykzx33wh.aspx)
- [<span data-ttu-id="b2d5a-294">Главные страницы: Советы, приемы и ловушки</span><span class="sxs-lookup"><span data-stu-id="b2d5a-294">Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="b2d5a-295">Темы в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="b2d5a-295">Themes in ASP.NET</span></span>](http://www.odetocode.com/articles/423.aspx)

### <a name="about-the-author"></a><span data-ttu-id="b2d5a-296">Об авторе</span><span class="sxs-lookup"><span data-stu-id="b2d5a-296">About the Author</span></span>

<span data-ttu-id="b2d5a-297">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор из нескольких книг по ASP/ASP.NET и основатель веб-узла 4GuysFromRolla.com, работает с веб-технологиями Microsoft с 1998 года.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-297">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b2d5a-298">Скотт — независимый консультант, преподаватель и автор.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-298">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b2d5a-299">Его последняя книга — [ *Sams Teach самостоятельно ASP.NET 3.5 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="b2d5a-299">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="b2d5a-300">Скоттом можно связаться по адресу [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com) или через его блог по адресу [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="b2d5a-300">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="b2d5a-301">Особая благодарность</span><span class="sxs-lookup"><span data-stu-id="b2d5a-301">Special Thanks To</span></span>

<span data-ttu-id="b2d5a-302">В этой серии руководств пособий рецензировалась многими компетентными редакторами.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-302">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b2d5a-303">Основной рецензент этого учебного был Банерджи Suchi.</span><span class="sxs-lookup"><span data-stu-id="b2d5a-303">Lead reviewer for this tutorial was Suchi Banerjee.</span></span> <span data-ttu-id="b2d5a-304">Хотите поработать с моих последующих статей для MSDN?</span><span class="sxs-lookup"><span data-stu-id="b2d5a-304">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b2d5a-305">Если Да, напишите мне [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b2d5a-305">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="b2d5a-306">[Назад](master-pages-and-asp-net-ajax-vb.md)
> [Вперед](nested-master-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="b2d5a-306">[Previous](master-pages-and-asp-net-ajax-vb.md)
[Next](nested-master-pages-vb.md)</span></span>
