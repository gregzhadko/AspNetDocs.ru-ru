---
uid: web-forms/overview/older-versions-getting-started/master-pages/creating-a-site-wide-layout-using-master-pages-cs
title: Создание макета на уровне сайта с помощью главных страниц (C#) | Документация Майкрософт
author: rick-anderson
description: В этом учебнике будут показаны основные принципы работы с главной страницей. А именно, что такое главные страницы, как один создает главную страницу, что такое заполнители содержимого, как один CR...
ms.author: riande
ms.date: 05/21/2008
ms.assetid: 78f8d194-03b9-44a5-8255-90e7cd1c2ee1
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/creating-a-site-wide-layout-using-master-pages-cs
msc.type: authoredcontent
ms.openlocfilehash: 1a5e85c443a2a3642ec185ab1897c43cdb2ab1f7
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78507336"
---
# <a name="creating-a-site-wide-layout-using-master-pages-c"></a>Создание макета сайта с помощью эталонных страниц (C#)

по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Скачать код](https://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_01_CS.zip) или [скачать PDF](https://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_01_CS.pdf)

> В этом учебнике будут показаны основные принципы работы с главной страницей. А именно, то, что такое главные страницы, как создать главную страницу, что такое заполнители содержимого, как одна из них создает страницу ASP.NET, использующую главную страницу, как изменение главной страницы автоматически отражается на связанных страницах содержимого и т. д.

## <a name="introduction"></a>Введение

Одним из атрибутов хорошо спроектированного веб-сайта является единообразный макет страницы на уровне всего сайта. Возьмем для примера на веб-сайте [www.asp.net](www.asp.net). На момент написания этой статьи все страницы имеют одинаковое содержимое в верхней и нижней части страницы. Как показано на рис. 1, в верхней части каждой страницы отображается серая линия со списком сообществ Майкрософт. Ниже приведен логотип сайта, список языков, на которые был переведен сайт, а также основные разделы: Домашняя страница, начало работы, обучение, загрузки и т. д. Аналогичным образом в нижней части страницы содержатся сведения об объявлении в www.asp.net, заявлении об авторских правах и ссылка на заявление о конфиденциальности.

[![веб-сайт www.asp.net применяет единообразный вид и поведение на всех страницах](creating-a-site-wide-layout-using-master-pages-cs/_static/image2.png)](creating-a-site-wide-layout-using-master-pages-cs/_static/image1.png)

<strong>Рис. 01</strong>. веб-сайт www.ASP.NET использует единообразный внешний вид и поведение всех страниц ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-site-wide-layout-using-master-pages-cs/_static/image3.png))

Другим атрибутом хорошо спроектированного сайта является простота, с которой можно изменить внешний вид узла. На рис. 1 показана домашняя страница www.asp.net на 2008 марта, но между сейчас и публикацией этого учебника изменился внешний вид. Возможно, пункты меню в верхней части будут расширены, чтобы включить новый раздел для платформы MVC. Или, возможно, совершенно новая разработка с различными цветами, шрифтами и макетом, будет представила. Применение таких изменений ко всему сайту должно быть быстрым и простым процессом, который не требует изменения тысяч веб-страниц, составляющих сайт.

Создание шаблона страницы на уровне сайта в ASP.NET возможно благодаря использованию *главных страниц*. В двух словах, Главная страница — это специальный тип страницы ASP.NET, который определяет разметку, которая является общей для всех *страниц содержимого* , а также области, настраиваемые на основе содержимого страницы. (Страница содержимого — это страница ASP.NET, привязанная к главной странице.) При изменении макета или форматирования главной страницы все ее выходные данные также немедленно обновляются, что делает применение изменений внешнего вида на уровне сайта простым обновлением и развертыванием одного файла (а именно, главной страницы).

Это первый учебник из серии руководств, посвященных использованию главных страниц. В рамках этой серии руководств мы будем:

- Изучите создание главных страниц и связанных с ними страниц содержимого.
- Обсуждение различных советов, приемов и ловушек,
- Выявление общих ловушек главной страницы и обзор решений,
- Узнайте, как получить доступ к главной странице со страницы содержимого и наоборот.
- Сведения о том, как указать главную страницу страницы содержимого во время выполнения и
- Другие дополнительные статьи по главной странице.

Эти учебники предназначены для краткости и содержат пошаговые инструкции с большим количеством снимков экрана для визуального анализа процесса. Каждый учебник доступен в C# и Visual Basic версий, а также содержит загрузку полного кода.

В этом учебнике инаугурационный начинается изучение основ главной страницы. Мы обсудим работу главных страниц, рассмотрим создание главной страницы и связанных с ней страниц содержимого с помощью Visual Web Developer и посмотрим, как изменения на главной странице немедленно отражаются на страницах содержимого. Приступим.

## <a name="understanding-how-master-pages-work"></a>Основные сведения о работе главных страниц

Для создания веб-сайта с единообразным макетом страницы на уровне сайта требуется, чтобы каждая веб-страница выдавала общее форматирование в дополнение к его пользовательскому содержимому. Например, хотя у каждого руководства или форума в www.asp.net есть собственное уникальное содержимое, каждая из этих страниц также отображает ряд общих элементов `<div>`, отображающих ссылки на разделы верхнего уровня: Домашняя страница, начало работы, обучение и т. д.

Существует множество методов создания веб-страниц с единообразным видом и поведением. Упрощенный подход заключается в простом копировании и вставке общей разметки макета на все веб-страницы, но этот подход имеет ряд недостатков. Для начинающих, каждый раз при создании страницы необходимо не забывать скопировать и вставить общее содержимое на страницу. Такие операции копирования и вставления готовых к ошибке, так как вы можете случайно скопировать только подмножество общей разметки на новую страницу. И, как и прежде, этот подход делает замену существующего внешнего вида всего сайта на новое, что очень удобно, так как каждая отдельная страница на сайте должна быть изменена для использования нового внешнего вида и поведения.

До ASP.NET версии 2,0 разработчики страниц часто разместили общую разметку в [пользовательских элементах управления](https://msdn.microsoft.com/library/y6wb1a0e.aspx) , а затем добавили эти пользовательские элементы управления на каждую страницу. При таком подходе требовалось, чтобы разработчик страницы вручную не запомнил Добавление пользовательских элементов управления на каждую новую страницу, но он допускает более простые изменения в масштабах сайта, так как при обновлении общей разметки только те пользовательские элементы управления, которые необходимо изменить. К сожалению, Visual Studio .NET 2002 и 2003 — версии Visual Studio, используемые для создания приложений ASP.NET 1. x — отображаемые пользовательские элементы управления в представление конструирования в виде серых прямоугольников. Следовательно, разработчики страниц, использующие этот подход, не работали с WYSIWYG-средой времени разработки.

Недостатки использования пользовательских элементов управления были устранены в ASP.NET версии 2,0 и Visual Studio 2005 с введением *главных страниц*. Главная страница — это специальный тип страницы ASP.NET, который определяет разметку на уровне сайта и *регионы* , в которых связанные *страницы содержимого* определяют свои собственные разметки. Как будет показано на шаге 1, эти регионы определяются элементами управления ContentPlaceHolder. Элемент управления ContentPlaceHolder просто обозначает позицию в иерархии элементов управления главной страницы, где пользовательское содержимое может быть внедрено страницей содержимого.

> [!NOTE]
> Основные понятия и функциональность главных страниц не изменились после ASP.NET версии 2,0. Однако Visual Studio 2008 предлагает поддержку во время разработки для вложенных главных страниц — функции, которая отсутствовала в Visual Studio 2005. В следующем учебном курсе рассматривается использование вложенных главных страниц.

На рис. 2 показано, как может выглядеть Главная страница для www.asp.net. Обратите внимание, что на главной странице определяется общий макет всего сайта — разметка в верхней, нижней и правой части каждой страницы, а также ContentPlaceHolder в середине слева, где размещается уникальное содержимое каждой отдельной веб-страницы.

![Эталонная страница определяет макет всего сайта и области, изменяемые на странице содержимого.](creating-a-site-wide-layout-using-master-pages-cs/_static/image4.png)

**Рис. 02**. Эталонная страница определяет макет на уровне сайта и области, изменяемые на странице содержимого страница по содержимому

После определения главной страницы ее можно привязать к новым ASP.NET страницам с помощью такта флажка. Эти страницы ASP.NET, называемые страницами содержимого, включают элемент управления содержимым для каждой из элементов управления ContentPlaceHolder главной страницы. При посещении страницы содержимого через браузер подсистема ASP.NET создает иерархию элементов управления главной страницы и внедряет иерархию элементов управления страницы содержимого в соответствующие места. Эта объединенная иерархия элементов управления готовится к просмотру, а полученный код HTML возвращается браузеру конечного пользователя. Следовательно, страница содержимого выдает как общую разметку, определенную на главной странице, за пределы элементов управления ContentPlaceHolder, так и разметку страницы, определенную в собственных элементах управления содержимым. Эта концепция показана на рис. 3.

[![разметке запрошенной страницы является плавкий предохранитель на главной странице](creating-a-site-wide-layout-using-master-pages-cs/_static/image6.png)](creating-a-site-wide-layout-using-master-pages-cs/_static/image5.png)

**Рис. 03**. Разметка запрошенной страницы — это значок с плавким предохранителем на главной странице ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-site-wide-layout-using-master-pages-cs/_static/image7.png))

Теперь, когда мы обсуждали работу главных страниц, давайте взглянем на создание главной страницы и связанных с ней страниц содержимого с помощью Visual Web Developer.

> [!NOTE]
> Чтобы достичь самой широкой аудитории, веб-сайт ASP.NET, который мы создаем в рамках этой серии руководств, будет создан с помощью ASP.NET 3,5 с бесплатной версией Visual Studio 2008, Visual [Web Developer 2008](https://www.microsoft.com/express/vwd/). Если вы еще не выполнили обновление до ASP.NET 3,5, не беспокойтесь: концепции, обсуждаемые в этих учебниках, работают одинаково хорошо с ASP.NET 2,0 и Visual Studio 2005. Однако некоторые демонстрационные приложения могут использовать новые возможности .NET Framework версии 3,5; При использовании компонентов, относящихся к 3,5, я включил замечание, в котором обсуждается реализация аналогичной функциональности в версии 2,0. Помните, что демонстрационные приложения, доступные для загрузки из каждого руководства, предназначены для .NET Framework версии 3,5, что приводит к `Web.config` файлу, который содержит элементы конфигурации, относящиеся к 3,5, и ссылки на пространства имен 3,5 в инструкциях `using` в классах кода программной части ASP.NET Pages. Короткая история. Если вы еще не установили .NET 3,5 на компьютере, загружаемое веб-приложение не будет работать без предварительного удаления разметки, относящейся к 3,5, из `Web.config`. Дополнительные сведения по этой теме см. в разделе [которая разбила ASP.NET версии 3.5 `Web.config` File](http://www.4guysfromrolla.com/articles/121207-1.aspx) . Также необходимо удалить инструкции `using`, которые ссылаются на пространства имен, относящиеся к 3,5.

## <a name="step-1-creating-a-master-page"></a>Шаг 1. Создание главной страницы

Прежде чем мы сможем изучить создание и использование главных и страниц содержимого, нам сначала нужен веб-сайт ASP.NET. Начните с создания нового веб-сайта ASP.NET на основе файловой системы. Для этого запустите Visual Web Developer, а затем перейдите в меню файл и выберите пункт Создать веб-сайт, в котором отображается диалоговое окно Новый веб-сайт (см. рис. 4). Выберите шаблон веб-сайт ASP.NET, в раскрывающемся списке Расположение выберите Файловая система, укажите папку для размещения веб-сайта и задайте для C#параметра язык значение. При этом будет создан новый веб-сайт со страницей `Default.aspx` ASP.NET, `App_Data` папкой и `Web.config`ным файлом.

> [!NOTE]
> Visual Studio поддерживает два режима управления проектами: проекты веб-сайтов и проекты веб-приложений. В проектах веб-сайтов отсутствует файл проекта, в то время как проекты веб-приложений имитирует архитектуру проекта в Visual Studio .NET 2002/2003 — они включают файл проекта и компилируются исходный код проекта в одну сборку, которая помещается в папку `/bin`. В Visual Studio 2005 изначально поддерживаются только проекты веб-сайтов, хотя [модель проекта веб-приложения](https://msdn.microsoft.com/library/aa730880(vs.80).aspx) была повторно введена с пакетом обновления 1 (SP1). Visual Studio 2008 предлагает обе модели проекта. Однако выпуски Visual Web Developer 2005 и 2008 поддерживают только проекты веб-сайтов. Я использую модель проекта веб-сайта для моих демонстраций в этой серии руководств. Если вы используете не Express Edition и хотите использовать модель проекта веб-приложения, вы можете сделать это, но имейте в виду, что на экране могут возникнуть некоторые несоответствия, а также действия, которые необходимо выполнить, а также отобразить снимки экрана и инструктио в этих учебниках указана служба NS.

[![создать новый веб-сайт на основе файловой системы](creating-a-site-wide-layout-using-master-pages-cs/_static/image9.png)](creating-a-site-wide-layout-using-master-pages-cs/_static/image8.png)

**Рис. 04**. Создание нового веб-сайта на основе файловой системы ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-site-wide-layout-using-master-pages-cs/_static/image10.png))

Затем добавьте главную страницу к сайту в корневом каталоге, щелкнув правой кнопкой мыши имя проекта, выбрав Добавить новый элемент и выбрав шаблон главной страницы. Обратите внимание, что главные страницы заканчиваются расширением `.master`. Назовите эту новую главную страницу `Site.master` и нажмите кнопку Добавить.

[![добавить главную страницу с именем site. master на веб-сайт](creating-a-site-wide-layout-using-master-pages-cs/_static/image12.png)](creating-a-site-wide-layout-using-master-pages-cs/_static/image11.png)

**Рис. 05**. Добавление главной страницы с именем `Site.master` на веб-сайт ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-site-wide-layout-using-master-pages-cs/_static/image13.png))

При добавлении нового файла главной страницы с помощью Visual Web Developer создается Главная страница со следующей декларативной разметкой:

[!code-aspx[Main](creating-a-site-wide-layout-using-master-pages-cs/samples/sample1.aspx)]

Первой строкой декларативной разметки является [директива`@Master`](https://msdn.microsoft.com/library/ms228176.aspx). Директива `@Master` похожа на [директиву`@Page`](https://msdn.microsoft.com/library/ydy4x04a.aspx) , которая отображается на страницах ASP.NET. Он определяет язык на стороне сервера (C#) и сведения о расположении и наследовании класса кода программной части главной страницы.

Под директивой `@Master` появляется `DOCTYPE` и декларативная разметка страницы. Страница включает статический HTML и четыре элемента управления на стороне сервера:

- **Веб-форма (`<form runat="server">`)** — поскольку все страницы ASP.NET обычно имеют веб-форму, а Главная страница может содержать веб-элементы управления, которые должны отображаться в веб-форме, обязательно добавьте веб-форму на главную страницу (вместо того, чтобы добавлять веб-форму на каждую страницу содержимого).
- **Элемент управления ContentPlaceHolder с именем `ContentPlaceHolder1`** — этот элемент управления ContentPlaceHolder отображается в веб-форме и выступает в качестве региона для пользовательского интерфейса страницы содержимого.
- **Элемент `<head>` на стороне сервера** — элемент `<head>` имеет атрибут `runat="server"`, делая его доступным в коде на стороне сервера. Элемент `<head>` реализуется таким образом, чтобы заголовок страницы и другая разметка, связанная с `<head>`, могли быть добавлены или скорректированы программно. Например, установка свойства `Title` страницы ASP.NET изменяет элемент `<title>`, отображаемый серверным элементом управления `<head>`.
- **Элемент управления ContentPlaceHolder с именем `head`** — этот элемент управления ContentPlaceHolder появляется в элементе управления `<head>` Server и может использоваться для декларативного добавления содержимого в элемент `<head>`.

Эта декларативная разметка главной страницы по умолчанию служит отправной точкой для разработки собственных главных страниц. Вы можете изменить код HTML или добавить дополнительные веб-элементы управления или элементов управления ContentPlaceHolder на главную страницу.

> [!NOTE]
> При проектировании главной страницы убедитесь, что эталонная страница содержит веб-форму и что в этой веб-форме отображается по крайней мере один элемент управления ContentPlaceHolder.

### <a name="creating-a-simple-site-layout"></a>Создание простого макета узла

Развернув `Site.master`декларативную разметку по умолчанию, можно создать макет сайта, в котором все страницы имеют общий заголовок. левый столбец с навигацией, новостями и другим содержимым для всего сайта; и нижний колонтитул, отображающий значок "питание от Microsoft ASP.NET". На рис. 6 показан конечный результат главной страницы при просмотре одной из страниц содержимого в браузере. Красная круговая область на рис. 6 относится к посещаемой странице (`Default.aspx`); другое содержимое определяется на главной странице и, следовательно, согласовано на всех страницах содержимого.

[![на главной странице определена разметка для верхних, левых и нижних частей](creating-a-site-wide-layout-using-master-pages-cs/_static/image15.png)](creating-a-site-wide-layout-using-master-pages-cs/_static/image14.png)

**Рис. 06**. Главная страница определяет разметку для верхних, левых и нижних частей ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-site-wide-layout-using-master-pages-cs/_static/image16.png)).

Чтобы получить макет сайта, показанный на рис. 6, начните с обновления главной страницы `Site.master`, чтобы она содержала следующую декларативную разметку:

[!code-aspx[Main](creating-a-site-wide-layout-using-master-pages-cs/samples/sample2.aspx)]

Макет главной страницы определяется с помощью ряда `<div>` элементов HTML. `topContent` `<div>` содержит разметку, которая отображается в верхней части каждой страницы, а `mainContent`, `leftContent`и `footerContent` `<div>` s используются для отображения содержимого страницы, левого столбца и значка "питание от Microsoft ASP.NET" соответственно. Помимо добавления этих `<div>` элементов, я также переименовал свойство `ID` основного элемента управления ContentPlaceHolder из `ContentPlaceHolder1` в `MainContent`.

Правила форматирования и макета для этих элементов `<div>` ассортимента написаны в [каскадном файле таблицы стилей (CSS)](http://en.wikipedia.org/wiki/Cascading_Style_Sheets) `Styles.css`, который задается с помощью элемента &lt;ссылки&gt; в элементе &lt;Head&gt; главной страницы. Эти различные правила определяют внешний вид и поведение каждого элемента `<div>`, упомянутого выше. Например, элемент `topContent` `<div>`, который отображает текст и компоновку учебников по главным страницам, имеет правила форматирования, указанные в `Styles.css` следующим образом:

[!code-css[Main](creating-a-site-wide-layout-using-master-pages-cs/samples/sample3.css)]

Если вы используете компьютер, вам потребуется скачать сопутствующий код этого руководства и добавить файл `Styles.css` в проект. Аналогичным образом также потребуется создать папку с именем Images и скопировать значок "питание на Microsoft ASP.NET" из скачанного демонстрационного веб-сайта в проект.

> [!NOTE]
> Обсуждение форматирования CSS и веб-страницы выходит за рамки этой статьи. Дополнительные сведения о CSS см. в [учебниках по CSS](http://www.w3schools.com/css/default.asp) по адресу [W3Schools.com](http://www.w3schools.com/). Я также рекомендую скачать сопутствующий код этого учебника и воспроизвести параметры CSS в `Styles.css`, чтобы увидеть влияние различных правил форматирования.

### <a name="creating-a-master-page-using-an-existing-design-template"></a>Создание главной страницы с помощью существующего шаблона проекта

В течение многих лет я создал ряд ASP.NET веб-приложений для компаний малого и среднего размера. Для некоторых из моих клиентов существовала существующая структура сайта, которую они хотят использовать; другие лица, нанятые компетентного Graphics Designer. Несколько сохранность мне, чтобы разработать макет веб-сайта. Как можно узнать на рис. 6, задача разработки макета веб-сайта обычно так же хорошо, как и у вашего бухгалтера, хирургии на то время, когда врач выполняет свои налоги.

К счастью, существует множество веб-сайтов, которые предлагают бесплатные шаблоны проектирования HTML — Google вернул более 6 000 000 результатов поиска в термине "бесплатные шаблоны веб-сайтов". Одним из моих любимых является [OpenDesigns.org](http://opendesigns.org/). Найдя нужный шаблон веб-сайта, добавьте файлы CSS и изображения в проект веб-сайта и Интегрируйте HTML-код шаблона в главную страницу.

> [!NOTE]
> Корпорация Майкрософт также предлагает ряд [бесплатных шаблонов ASP.NET Design Kit](https://msdn.microsoft.com/asp.net/aa336613.aspx) , которые интегрируются в диалоговое окно Новый веб-сайт в Visual Studio.

## <a name="step-2-creating-associated-content-pages"></a>Шаг 2. Создание связанных страниц содержимого

После создания главной страницы мы готовы приступить к созданию страниц ASP.NET, привязанных к главной странице. Такие страницы называются *страницами содержимого*.

Добавим новую страницу ASP.NET в проект и привяжите ее к главной странице `Site.master`. Щелкните правой кнопкой мыши имя проекта в обозреватель решений и выберите команду "добавить новый элемент". Выберите шаблон веб-формы, введите имя `About.aspx`, а затем установите флажок "выбрать главную страницу", как показано на рис. 7. Это приведет к отображению диалогового окна Выбор главной страницы (см. рис. 8), где можно выбрать используемую эталонную страницу.

> [!NOTE]
> Если вы создали веб-сайт ASP.NET, используя модель проекта веб-приложения, а не модель проекта веб-сайта, флажок "выбрать главную страницу" в диалоговом окне "Добавление нового элемента", показанном на рис. 7, не отображается. Чтобы создать страницу содержимого при использовании модели проекта веб-приложения, необходимо выбрать шаблон формы веб-содержимого вместо шаблона веб-формы. После выбора шаблона формы веб-содержимого и нажатия кнопки «Добавить» появится диалоговое окно Выбор главной страницы, показанное на рис. 8.

[![добавить новую страницу содержимого](creating-a-site-wide-layout-using-master-pages-cs/_static/image18.png)](creating-a-site-wide-layout-using-master-pages-cs/_static/image17.png)

**Рис. 07**. Добавление новой страницы содержимого ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-site-wide-layout-using-master-pages-cs/_static/image19.png))

[![выберите главную страницу site. master.](creating-a-site-wide-layout-using-master-pages-cs/_static/image21.png)](creating-a-site-wide-layout-using-master-pages-cs/_static/image20.png)

**Рис. 08**. Выбор главной страницы `Site.master` ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-site-wide-layout-using-master-pages-cs/_static/image22.png))

Как показано в следующей декларативной разметке, Новая страница содержимого содержит директиву `@Page`, которая указывает на главную страницу и элемент управления содержимым для каждой из элементов управления ContentPlaceHolder главной страницы.

[!code-aspx[Main](creating-a-site-wide-layout-using-master-pages-cs/samples/sample4.aspx)]

> [!NOTE]
> В разделе "Создание простого макета сайта" на шаге 1 я переименовал `ContentPlaceHolder1` `MainContent`. Если не переименовать `ID` элемента управления ContentPlaceHolder таким же образом, декларативная разметка страницы содержимого будет немного отличаться от показанной выше разметки. А именно, второй `ContentPlaceHolderID` элемента управления содержимым будет отражать `ID` соответствующего элемента управления ContentPlaceHolder на главной странице.

При подготовке страницы содержимого подсистема ASP.NET должна запредохранительить элементы управления содержимым страницы с помощью элементов управления ContentPlaceHolder главной страницы. Подсистема ASP.NET определяет эталонную страницу страницы содержимого на основе `MasterPageFile` атрибута директивы `@Page`. Как показано в приведенной выше разметке, эта страница содержимого привязана к `~/Site.master`.

Так как эталонная страница имеет два элемента управления ContentPlaceHolder — `head` и `MainContent`-Visual Web Developer создал два элемента управления содержимым. Каждый элемент управления содержимым ссылается на конкретный ContentPlaceHolder через свойство `ContentPlaceHolderID`.

Когда главные страницы по-прежнему находятся на предыдущих методах шаблона всего сайта, они поддерживаются во время разработки. На рис. 9 показана страница `About.aspx` содержимого при просмотре с помощью представление конструирования Visual Web Developer. Обратите внимание, что в то время как содержимое главной страницы отображается серым и не может быть изменено. Однако элементы управления содержимым, соответствующие элементов управления ContentPlaceHolder главной страницы, могут быть изменены. И, как и любая другая страница ASP.NET, можно создать интерфейс страницы содержимого, добавив веб-элементы управления с помощью представлений исходного кода или конструктора.

[![в режиме конструктора страницы содержимого отображаются как содержимое страницы, так и страница главной страницы.](creating-a-site-wide-layout-using-master-pages-cs/_static/image24.png)](creating-a-site-wide-layout-using-master-pages-cs/_static/image23.png)

**Рис. 09**. в конструкторе страницы содержимого отображается как содержимое страницы, так и страница главной страницы ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-site-wide-layout-using-master-pages-cs/_static/image25.png)).

### <a name="adding-markup-and-web-controls-to-the-content-page"></a>Добавление разметки и веб-элементов управления на страницу содержимого

Уделите немного времени созданию содержимого для страницы `About.aspx`. Как можно увидеть на рис. 10, я указал заголовок «о авторе» и несколько абзацев текста, но также можете добавить веб-элементы управления. После создания этого интерфейса посетите страницу `About.aspx` в браузере.

[![посетить страницу About. aspx в браузере](creating-a-site-wide-layout-using-master-pages-cs/_static/image27.png)](creating-a-site-wide-layout-using-master-pages-cs/_static/image26.png)

**Рис. 10**. посещение страницы `About.aspx` в браузере ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-site-wide-layout-using-master-pages-cs/_static/image28.png))

Важно понимать, что запрошенная страница содержимого и связанная с ней эталонная страница имеют плавкие предохранители и полностью подготовлены к просмотру на веб-сервере. Затем браузер конечного пользователя отправляет полученный код HTML с плавким предохранителем. Чтобы проверить это, просмотрите HTML-код, полученный браузером, выбрав в меню Вид пункт Источник. Обратите внимание, что отсутствуют кадры или другие специализированные методы отображения двух разных веб-страниц в одном окне.

### <a name="binding-a-master-page-to-an-existing-aspnet-page"></a>Привязка главной страницы к существующей странице ASP.NET

Как было показано на этом шаге, Добавление новой страницы содержимого в веб-приложение ASP.NET — это так же просто, как установка флажка "выбрать главную страницу" и выбор главной страницы. К сожалению, преобразование существующей страницы ASP.NET в главную страницу не так просто.

Чтобы привязать главную страницу к существующей странице ASP.NET, необходимо выполнить следующие действия.

1. Добавьте атрибут `MasterPageFile` в директиву `@Page` страницы ASP.NET, указывающую на соответствующую главную страницу.
2. Добавьте элементы управления содержимым для каждого элементов управления ContentPlaceHolder на главной странице.
3. Выборочно вырезать и вставить существующее содержимое страницы ASP.NET в соответствующие элементы управления содержимым. Я говорю «выборочно», так как страница ASP.NET, вероятно, содержит разметку, уже выраженную главной страницей, например `DOCTYPE`, элемент `<html>` и веб-форму.

Пошаговые инструкции по этому процессу вместе с снимками экрана см. в статье Руководство по [использованию главных страниц и навигации по веб-узлу](http://webproject.scottgu.com/CSharp/MasterPages/MasterPages.aspx) [Скотта Гатри (](https://weblogs.asp.net/scottgu/). Эти действия описаны в разделе "обновление `Default.aspx` и `DataSample.aspx` для использования главной страницы".

Поскольку гораздо проще создавать новые страницы содержимого, чем преобразование существующих страниц ASP.NET в страницы содержимого, я рекомендую, что при создании нового веб-сайта ASP.NET на него будет добавлена эталонная страница. Привяжите все новые страницы ASP.NET к этой эталонной странице. Не беспокойтесь, если начальная Главная страница очень простая или обычная. Вы можете обновить главную страницу позже.

> [!NOTE]
> При создании нового приложения ASP.NET в Visual Web Developer добавляется страница `Default.aspx`, которая не привязана к главной странице. Если вы хотите попрактиковаться в преобразовании существующей страницы ASP.NET в страницу содержимого, сделайте это с помощью `Default.aspx`. Кроме того, можно удалить `Default.aspx`, а затем повторно добавить его, но на этот раз установив флажок "выбрать главную страницу".

## <a name="step-3-updating-the-master-pages-markup"></a>Шаг 3. обновление разметки главной страницы

Одно из основных преимуществ главных страниц состоит в том, что одну главную страницу можно использовать для определения общего макета для множества страниц на сайте. Таким образом, обновление внешнего вида сайта требует обновления одного файла — главной страницы.

Чтобы продемонстрировать это поведение, обновите главную страницу, включив в нее текущую дату в верхней части левого столбца. Добавьте метку с именем `DateDisplay` в `<div>``leftContent`.

[!code-aspx[Main](creating-a-site-wide-layout-using-master-pages-cs/samples/sample5.aspx)]

Затем создайте обработчик событий `Page_Load` для главной страницы и добавьте следующий код:

[!code-csharp[Main](creating-a-site-wide-layout-using-master-pages-cs/samples/sample6.cs)]

Приведенный выше код задает для свойства `Text` метки текущую дату и время в формате дня недели, название месяца и двузначное обозначение дня (см. рис. 11). После этого изменения перейдите на одну из страниц содержимого. Как показано на рис. 11, полученная разметка немедленно обновляется для включения изменений на главную страницу.

[![изменения на главной странице отображаются при просмотре страницы содержимого](creating-a-site-wide-layout-using-master-pages-cs/_static/image30.png)](creating-a-site-wide-layout-using-master-pages-cs/_static/image29.png)

**Рис. 11**. изменения, внесенные в главную страницу, отображаются при просмотре страницы содержимого ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-site-wide-layout-using-master-pages-cs/_static/image31.png))

> [!NOTE]
> Как показано в этом примере, главные страницы могут содержать веб-элементы управления, код и обработчики событий на стороне сервера.

## <a name="summary"></a>Сводка

Главные страницы позволяют разработчикам ASP.NET создавать единообразные макеты всего сайта, которые легко обновлять. Создание главных страниц и связанных с ними страниц содержимого сводится к созданию стандартных страниц ASP.NET, так как Visual Web Developer обеспечивает расширенную поддержку во время разработки.

Пример главной страницы, созданный в этом руководстве, содержал два элемента управления ContentPlaceHolder, `head` и `MainContent`. Однако мы указали разметку для элемента управления `MainContent` ContentPlaceHolder на странице содержимого. В следующем учебном курсе мы рассмотрим использование нескольких элементов управления содержимым на странице содержимого. Мы также посмотрим, как определить разметку по умолчанию для элементов управления содержимым на главной странице, а также как переключаться между использованием разметки по умолчанию, определенной на главной странице, и предоставлением пользовательской разметки на странице содержимое.

Поздравляем с программированием!

### <a name="further-reading"></a>Дополнительные материалы

Дополнительные сведения о разделах, обсуждаемых в этом руководстве, см. в следующих ресурсах:

- [ASP.NET for Designers: Бесплатные шаблоны проектирования и руководство по созданию веб-сайтов ASP.NET с использованием стандартов Интернета](https://msdn.microsoft.com/asp.net/aa336602.aspx)
- [Общие сведения о главных страницах ASP.NET](https://msdn.microsoft.com/library/wtxbf3hh.aspx)
- [Учебники по каскадным таблицам стилей (CSS)](http://www.w3schools.com/css/default.asp)
- [Динамическое задание заголовка страницы](http://aspnet.4guysfromrolla.com/articles/051006-1.aspx)
- [Главные страницы в ASP.NET](http://www.odetocode.com/articles/419.aspx)
- [Краткие руководства по главным страницам](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/masterpages/default.aspx)

### <a name="about-the-author"></a>Об авторе

[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор нескольких книг по ASP/ASP. NET и основатель 4GuysFromRolla.com, работал с веб-технологиями майкрософт с 1998. Скотт работает как независимый консультант, преподаватель и модуль записи. Его последняя книга — [*Sams обучать себя ASP.NET 3,5 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco). Скотт можно получить по адресу [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) или через свой блог по адресу [http://ScottOnWriting.NET](http://scottonwriting.net/).

### <a name="special-thanks-to"></a>Специальная благодарность

Хотите ознакомиться с моими будущими статьями MSDN? Если это так, расположите строку в [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).

> [!div class="step-by-step"]
> [Дальше](multiple-contentplaceholders-and-default-content-cs.md)
