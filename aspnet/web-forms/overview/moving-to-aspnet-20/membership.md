---
uid: web-forms/overview/moving-to-aspnet-20/membership
title: Членство | Документация Майкрософт
author: microsoft
description: Членство в ASP.NET построено на успешности модели проверки подлинности на основе форм из ASP.NET 1. x. ASP.NET Forms Authentication предоставляет удобный способ для Организации...
ms.author: riande
ms.date: 02/20/2005
ms.assetid: f2339485-5d78-4c5e-8c0a-dc9b8a315345
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/membership
msc.type: authoredcontent
ms.openlocfilehash: da6fc205bd852a818d65425586cec38fdb08d310
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78521706"
---
# <a name="membership"></a><span data-ttu-id="31ce8-104">Членство</span><span class="sxs-lookup"><span data-stu-id="31ce8-104">Membership</span></span>

<span data-ttu-id="31ce8-105">по [Майкрософт](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="31ce8-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="31ce8-106">Членство в ASP.NET построено на успешности модели проверки подлинности на основе форм из ASP.NET 1. x.</span><span class="sxs-lookup"><span data-stu-id="31ce8-106">ASP.NET Membership builds on the success of the Forms authentication model from ASP.NET 1.x.</span></span> <span data-ttu-id="31ce8-107">ASP.NET Forms Authentication — это удобный способ включения формы входа в приложение ASP.NET и проверки пользователей в базе данных или другом хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="31ce8-107">ASP.NET Forms authentication provides a convenient way to incorporate a login form into your ASP.NET application and validate users against a database or other data store.</span></span>

<span data-ttu-id="31ce8-108">Членство в ASP.NET построено на успешности модели проверки подлинности на основе форм из ASP.NET 1. x.</span><span class="sxs-lookup"><span data-stu-id="31ce8-108">ASP.NET Membership builds on the success of the Forms authentication model from ASP.NET 1.x.</span></span> <span data-ttu-id="31ce8-109">ASP.NET Forms Authentication — это удобный способ включения формы входа в приложение ASP.NET и проверки пользователей в базе данных или другом хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="31ce8-109">ASP.NET Forms authentication provides a convenient way to incorporate a login form into your ASP.NET application and validate users against a database or other data store.</span></span> <span data-ttu-id="31ce8-110">Члены класса FormsAuthentication позволяют управлять файлами cookie для проверки подлинности, проверять допустимость имени входа, регистрировать пользователя и т. д. Однако реализация проверки подлинности с помощью форм в приложении ASP.NET 1. x может потребовать достаточного объема кода.</span><span class="sxs-lookup"><span data-stu-id="31ce8-110">The members of the FormsAuthentication class make it possible to handle cookies for authentication, check for a valid login, log a user out etc. However, implementing Forms authentication in an ASP.NET 1.x application can require a fair amount of code.</span></span>

<span data-ttu-id="31ce8-111">Членство в ASP.NET 2,0 является значительным перебором только проверки подлинности с помощью форм.</span><span class="sxs-lookup"><span data-stu-id="31ce8-111">Membership in ASP.NET 2.0 is a major advancement over using Forms authentication alone.</span></span> <span data-ttu-id="31ce8-112">(Членство в наиболее надежном сочетании с проверкой подлинности с помощью форм, но использование проверки подлинности на основе форм не является обязательным.) Как вы вскоре увидите, вы можете использовать членство ASP.NET и элементы управления входа в ASP.NET 2,0 для реализации мощной системы членства без написания большого объема кода.</span><span class="sxs-lookup"><span data-stu-id="31ce8-112">(Membership is most robust when coupled with Forms authentication, but using Forms authentication is not a requirement.) As you'll soon see, you can use ASP.NET Membership and the login controls in ASP.NET 2.0 to implement a powerful membership system without writing much code at all.</span></span>

## <a name="implementing-membership-in-aspnet-20"></a><span data-ttu-id="31ce8-113">Реализация членства в ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="31ce8-113">Implementing Membership in ASP.NET 2.0</span></span>

<span data-ttu-id="31ce8-114">Членство реализуется в следующих четырех шагах.</span><span class="sxs-lookup"><span data-stu-id="31ce8-114">Membership is implemented by following four steps.</span></span> <span data-ttu-id="31ce8-115">Помните, что существует множество подшагов, а также дополнительная настройка, которую также можно реализовать.</span><span class="sxs-lookup"><span data-stu-id="31ce8-115">Keep in mind that there are many sub-steps that are involved as well as optional configuration that can be implemented as well.</span></span> <span data-ttu-id="31ce8-116">Эти шаги предназначены для иллюстрации общей картины настройки членства.</span><span class="sxs-lookup"><span data-stu-id="31ce8-116">These steps are meant to illustrate the big picture of configuring membership.</span></span>

1. <span data-ttu-id="31ce8-117">Создайте базу данных членства (если SQL Server используется в качестве хранилища членства.)</span><span class="sxs-lookup"><span data-stu-id="31ce8-117">Create your membership database (if SQL Server is used as the membership store.)</span></span>
2. <span data-ttu-id="31ce8-118">Укажите параметры членства в файлах конфигурации приложений.</span><span class="sxs-lookup"><span data-stu-id="31ce8-118">Specify the membership options in your applications configuration files.</span></span> <span data-ttu-id="31ce8-119">(Членство включено по умолчанию.)</span><span class="sxs-lookup"><span data-stu-id="31ce8-119">(Membership is enabled by default.)</span></span>
3. <span data-ttu-id="31ce8-120">Определите тип хранилища членства, которое вы хотите использовать.</span><span class="sxs-lookup"><span data-stu-id="31ce8-120">Determine the type of membership store you want to use.</span></span> <span data-ttu-id="31ce8-121">Возможные варианты:</span><span class="sxs-lookup"><span data-stu-id="31ce8-121">Options are:</span></span> 

    - <span data-ttu-id="31ce8-122">Microsoft SQL Server (версия 7,0 или более поздняя)</span><span class="sxs-lookup"><span data-stu-id="31ce8-122">Microsoft SQL Server (version 7.0 or later)</span></span>
    - <span data-ttu-id="31ce8-123">Хранилище Active Directory</span><span class="sxs-lookup"><span data-stu-id="31ce8-123">Active Directory Store</span></span>
    - <span data-ttu-id="31ce8-124">Пользовательский поставщик членства</span><span class="sxs-lookup"><span data-stu-id="31ce8-124">Custom membership provider</span></span>
4. <span data-ttu-id="31ce8-125">Настройте приложение для проверки подлинности с помощью ASP.NET Forms.</span><span class="sxs-lookup"><span data-stu-id="31ce8-125">Configure the application for ASP.NET Forms authentication.</span></span> <span data-ttu-id="31ce8-126">Опять же, членство призвано воспользоваться преимуществами проверки подлинности на основе форм, но использование проверки подлинности с помощью форм не является обязательным.</span><span class="sxs-lookup"><span data-stu-id="31ce8-126">Once again, Membership is designed to take advantage of Forms authentication, but using Forms authentication is not a requirement.</span></span>
5. <span data-ttu-id="31ce8-127">Определите учетные записи пользователей для членства и при необходимости настройте роли.</span><span class="sxs-lookup"><span data-stu-id="31ce8-127">Define user accounts for membership and configure roles if desired.</span></span>

## <a name="creating-the-membership-database"></a><span data-ttu-id="31ce8-128">Создание базы данных членства</span><span class="sxs-lookup"><span data-stu-id="31ce8-128">Creating the Membership Database</span></span>

<span data-ttu-id="31ce8-129">Если вы используете SQL Server 7,0 или более поздней версии в качестве вашего хранилища членства, вы можете настроить базу данных с помощью служебной программы ASPNET\_регскл (которая легко доступна в командной строке Visual Studio .NET 2005).</span><span class="sxs-lookup"><span data-stu-id="31ce8-129">If you're using SQL Server 7.0 or later as your membership store, you can use the aspnet\_regsql utility (available most easily from the Visual Studio .NET 2005 Command Prompt) to configure your database.</span></span> <span data-ttu-id="31ce8-130">Служебную программу ASPNET\_регскл можно использовать в качестве средства командной строки или с помощью мастера графического пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="31ce8-130">The aspnet\_regsql utility can be used as a command prompt tool or via a GUI wizard.</span></span> <span data-ttu-id="31ce8-131">Метод мастера является самым простым способом настройки базы данных.</span><span class="sxs-lookup"><span data-stu-id="31ce8-131">The wizard method is the easiest way to configure your database.</span></span> <span data-ttu-id="31ce8-132">Для доступа к мастеру просто выполните следующую команду:</span><span class="sxs-lookup"><span data-stu-id="31ce8-132">To access the wizard, simply run the following command:</span></span>

`aspnet_regsql W`

<span data-ttu-id="31ce8-133">После выполнения этой команды вы увидите мастер установки ASP.NET SQL Server, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="31ce8-133">Once you run that command, you will be presented with the ASP.NET SQL Server Setup Wizard as shown below.</span></span>

![](membership/_static/image1.jpg)

<span data-ttu-id="31ce8-134">**Рисунок 1**</span><span class="sxs-lookup"><span data-stu-id="31ce8-134">**Figure 1**</span></span>

<span data-ttu-id="31ce8-135">Мастер установки SQL Server ASP.NET создает веб-сайт в экземпляре, указанном в мастере.</span><span class="sxs-lookup"><span data-stu-id="31ce8-135">The ASP.NET SQL Server Setup Wizard creates the Web site in the instance you specify in the wizard.</span></span> <span data-ttu-id="31ce8-136">Однако ASP.NET будет использовать строку подключения в файле Machine. config для подключения к базе данных.</span><span class="sxs-lookup"><span data-stu-id="31ce8-136">However, ASP.NET will use the connection string in the machine.config file to connect to your database.</span></span> <span data-ttu-id="31ce8-137">По умолчанию эта строка подключения указывает на экземпляр SQL Server 2005, поэтому при использовании экземпляра SQL Server 2000 или SQL Server 7,0 необходимо будет изменить строку подключения в файле Machine. config.</span><span class="sxs-lookup"><span data-stu-id="31ce8-137">By default, this connection string will point to a SQL Server 2005 instance, so if you are using a SQL Server 2000 or SQL Server 7.0 instance, you will need to modify the connection string in the machine.config file.</span></span> <span data-ttu-id="31ce8-138">Эту строку подключения можно найти здесь:</span><span class="sxs-lookup"><span data-stu-id="31ce8-138">That connection string can be located here:</span></span>

[!code-xml[Main](membership/samples/sample1.xml)]

<span data-ttu-id="31ce8-139">К сожалению, если не изменить строку подключения, ASP.NET не даст вам описательные ошибки.</span><span class="sxs-lookup"><span data-stu-id="31ce8-139">Unfortunately, if you don't modify the connection string, ASP.NET will not give you a descriptive error.</span></span> <span data-ttu-id="31ce8-140">Он просто будет сообщать о том, что вы еще не создали базу данных.</span><span class="sxs-lookup"><span data-stu-id="31ce8-140">It will just continue to complain saying that you haven't created the database.</span></span> <span data-ttu-id="31ce8-141">В приведенном выше примере я изменил строку подключения так, чтобы она указывала на мой локальный экземпляр SQL Server 2000.</span><span class="sxs-lookup"><span data-stu-id="31ce8-141">In the case above, I have modified the connection string to point to my local SQL Server 2000 instance.</span></span>

## <a name="specifying-configuration-and-adding-users-and-roles"></a><span data-ttu-id="31ce8-142">Указание конфигурации и Добавление пользователей и ролей</span><span class="sxs-lookup"><span data-stu-id="31ce8-142">Specifying Configuration and Adding Users and Roles</span></span>

<span data-ttu-id="31ce8-143">Следующим шагом в настройке членства является добавление необходимых сведений в файл Web. config приложения.</span><span class="sxs-lookup"><span data-stu-id="31ce8-143">The next step in configuring Membership is to add the necessary information to the web.config file of the application.</span></span> <span data-ttu-id="31ce8-144">В ASP.NET 1. x изменение файла Web. config иногда усложняется из-за использования Ловеркамелкасе и отсутствия технологии IntelliSense.</span><span class="sxs-lookup"><span data-stu-id="31ce8-144">In ASP.NET 1.x, modifying the web.config file was sometimes difficult because of the use of lowerCamelCase and the lack of Intellisense.</span></span> <span data-ttu-id="31ce8-145">Visual Studio .NET 2005 значительно упрощает задачу с помощью технологии IntelliSense для файлов конфигурации, но ASP.NET 2,0 переходит на один шаг вперед, предоставляя веб-интерфейс для редактирования файлов конфигурации.</span><span class="sxs-lookup"><span data-stu-id="31ce8-145">Visual Studio .NET 2005 makes the task much easier with Intellisense for configuration files, but ASP.NET 2.0 goes one step further by providing a Web interface for editing configuration files.</span></span>

<span data-ttu-id="31ce8-146">Чтобы запустить веб-интерфейс, нажмите кнопку Конфигурация ASP.NET на панели инструментов обозреватель решений, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="31ce8-146">You can launch the Web interface by clicking the ASP.NET Configuration button on the Solution Explorer toolbar as shown below.</span></span> <span data-ttu-id="31ce8-147">Также можно запустить веб-интерфейс с помощью всплывающих окон, отображаемых при вставке элементов управления входа.</span><span class="sxs-lookup"><span data-stu-id="31ce8-147">You can also launch the Web interface via pop-ups that are displayed when Login controls are inserted.</span></span>

![](membership/_static/image2.jpg)

<span data-ttu-id="31ce8-148">**Рис. 2**</span><span class="sxs-lookup"><span data-stu-id="31ce8-148">**Figure 2**</span></span>

<span data-ttu-id="31ce8-149">Запустится средство администрирования веб-сайта ASP.NET, показанное ниже.</span><span class="sxs-lookup"><span data-stu-id="31ce8-149">This launches the ASP.NET Web Site Administration Tool shown below.</span></span> <span data-ttu-id="31ce8-150">Администрирование веб-узла ASP.NET — это интерфейс с четырьмя вкладками, который упрощает управление параметрами приложения.</span><span class="sxs-lookup"><span data-stu-id="31ce8-150">The ASP.NET Web Site Administration is a four-tab interface that makes it easy to manage application settings.</span></span> <span data-ttu-id="31ce8-151">Доступны следующие вкладки:</span><span class="sxs-lookup"><span data-stu-id="31ce8-151">The following tabs are available:</span></span>

- <span data-ttu-id="31ce8-152">**Главная**</span><span class="sxs-lookup"><span data-stu-id="31ce8-152">**Home**</span></span>
- <span data-ttu-id="31ce8-153">**Безопасность** Настройка пользователей, ролей и доступа.</span><span class="sxs-lookup"><span data-stu-id="31ce8-153">**Security** Configure users, roles, and access.</span></span>
- <span data-ttu-id="31ce8-154">**Приложение** Настройка параметров приложения.</span><span class="sxs-lookup"><span data-stu-id="31ce8-154">**Application** Configure application settings.</span></span>
- <span data-ttu-id="31ce8-155">**Поставщик услуг** Настройка и тестирование поставщика членства в приложениях.</span><span class="sxs-lookup"><span data-stu-id="31ce8-155">**Provider** Configure and test your applications membership provider.</span></span>

<span data-ttu-id="31ce8-156">Средство администрирования веб-сайтов позволяет легко создавать новых пользователей, создавать новые роли и управлять пользователями и ролями.</span><span class="sxs-lookup"><span data-stu-id="31ce8-156">The Web Site Administration Tool allows you to easily create new users, create new roles, and to manage users and roles.</span></span> <span data-ttu-id="31ce8-157">Эта возможность недоступна в интерфейсе Windows.</span><span class="sxs-lookup"><span data-stu-id="31ce8-157">This ability is not available in the Windows interface.</span></span> <span data-ttu-id="31ce8-158">Интерфейс Windows позволяет легко определять параметры авторизации, а также добавлять, удалять и управлять поставщиками, возможностями, которые не входят в средство администрирования веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="31ce8-158">The Windows interface allows you to easily define authorization settings and to add, delete, and manage providers, capabilities that are not in the Web Site Administration Tool.</span></span>

<span data-ttu-id="31ce8-159">Чтобы запустить интерфейс Windows, откройте оснастку службы IIS, щелкните правой кнопкой мыши приложение и выберите пункт Свойства.</span><span class="sxs-lookup"><span data-stu-id="31ce8-159">To launch the Windows interface, open the Internet Information Services snap-in, right-click on your application, and choose Properties.</span></span> <span data-ttu-id="31ce8-160">Перейдите на вкладку ASP.NET и нажмите кнопку Edit Configuration (изменить конфигурацию).</span><span class="sxs-lookup"><span data-stu-id="31ce8-160">Click the ASP.NET tab and then click the Edit Configuration button.</span></span> <span data-ttu-id="31ce8-161">(Чтобы включить кнопку "изменить конфигурацию", приложение должно работать под ASP.NET 2,0.</span><span class="sxs-lookup"><span data-stu-id="31ce8-161">(The application must be running under ASP.NET 2.0 for the Edit Configuration button to be enabled.</span></span> <span data-ttu-id="31ce8-162">Можно также настроить версию ASP.NET в диалоговом окне ASP.NET.) Откроется диалоговое окно Параметры конфигурации ASP.NET, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="31ce8-162">You can configure the ASP.NET version in the ASP.NET dialog as well.) The ASP.NET Configuration Settings dialog is displayed as shown below.</span></span>

![](membership/_static/image3.jpg)

<span data-ttu-id="31ce8-163">**Рис. 3**</span><span class="sxs-lookup"><span data-stu-id="31ce8-163">**Figure 3**</span></span>

<span data-ttu-id="31ce8-164">На вкладке Общие отображаются строки подключения и параметры приложения.</span><span class="sxs-lookup"><span data-stu-id="31ce8-164">On the General tab, connection strings and application settings are listed.</span></span> <span data-ttu-id="31ce8-165">Все параметры курсивом задаются в родительском файле конфигурации (Machine. config или Web. config на более высоком уровне), а параметры, не заданные курсивом, — из файла конфигурации приложений.</span><span class="sxs-lookup"><span data-stu-id="31ce8-165">Any settings in italics are defined in a parent configuration file (either the machine.config or a web.config at a higher level) and settings not in italics are from the applications configuration file.</span></span> <span data-ttu-id="31ce8-166">Если параметр добавляется, удаляется или изменяется на уровне приложения, ASP.NET добавляет, удаляет или изменяет параметр на уровнях приложения Web. config, а не удаляет параметр из файла конфигурации, из которого он унаследован.</span><span class="sxs-lookup"><span data-stu-id="31ce8-166">If a setting is added, removed, or edited at the application level, ASP.NET will add, remove, or modify the setting at the application levels web.config instead of removing the setting from the configuration file from which it is inherited.</span></span>

<span data-ttu-id="31ce8-167">Вкладка Проверка подлинности показана ниже.</span><span class="sxs-lookup"><span data-stu-id="31ce8-167">The Authentication tab is shown below.</span></span> <span data-ttu-id="31ce8-168">Здесь вы будете настраивать параметры членства.</span><span class="sxs-lookup"><span data-stu-id="31ce8-168">This is where you will configure your membership settings.</span></span> <span data-ttu-id="31ce8-169">Параметры проверки подлинности на формах, поставщиков членства и поставщиков ролей можно настроить здесь.</span><span class="sxs-lookup"><span data-stu-id="31ce8-169">Forms authentication settings, membership providers, and role providers can be configured here.</span></span>

![](membership/_static/image4.jpg)

<span data-ttu-id="31ce8-170">**Рис. 4**</span><span class="sxs-lookup"><span data-stu-id="31ce8-170">**Figure 4**</span></span>

## <a name="implementing-membership-in-your-application"></a><span data-ttu-id="31ce8-171">Реализация членства в приложении</span><span class="sxs-lookup"><span data-stu-id="31ce8-171">Implementing Membership in Your Application</span></span>

<span data-ttu-id="31ce8-172">Самым простым способом реализации членства ASP.NET 2,0 в приложении является использование указанных элементов управления входом в систему.</span><span class="sxs-lookup"><span data-stu-id="31ce8-172">The easiest way to implement ASP.NET 2.0 membership in your application is to use the provided Logon controls.</span></span> <span data-ttu-id="31ce8-173">Этот метод позволяет реализовать основы членства в ASP.NET 2,0 без написания кода.</span><span class="sxs-lookup"><span data-stu-id="31ce8-173">This method allows you to implement the basics of ASP.NET 2.0 membership without writing any code at all.</span></span>

<span data-ttu-id="31ce8-174">В ASP.NET 2,0 доступны следующие элементы управления входом:</span><span class="sxs-lookup"><span data-stu-id="31ce8-174">The following Logon controls are available in ASP.NET 2.0:</span></span>

## <a name="login-control"></a><span data-ttu-id="31ce8-175">Элемент управления Login</span><span class="sxs-lookup"><span data-stu-id="31ce8-175">Login Control</span></span>

<span data-ttu-id="31ce8-176">Элемент управления Login предоставляет интерфейс для входа в систему членства.</span><span class="sxs-lookup"><span data-stu-id="31ce8-176">The Login control provides an interface for someone to log into your membership system.</span></span> <span data-ttu-id="31ce8-177">Он предоставляет текстовое поле имя пользователя и пароль и кнопку входа.</span><span class="sxs-lookup"><span data-stu-id="31ce8-177">It provides you with a username and password textbox and a login button.</span></span> <span data-ttu-id="31ce8-178">Многие другие распространенные функции, такие как ссылка для регистрации пользователей, которые еще не сделали этого, — флажок, позволяющий пользователю автоматически войти в систему при последующих посещениях, ссылку на напоминание о пароле и т. д. Все функции элемента управления Login можно настраивать с помощью свойств элемента управления.</span><span class="sxs-lookup"><span data-stu-id="31ce8-178">Many other common features such as a link to register for people who have not yet done so, a checkbox that allows the user to automatically login on subsequent visits, a link for a password reminder, etc. All features of the Login control are customizable via the properties of the control.</span></span>

<span data-ttu-id="31ce8-179">В ASP.NET 1. x разработчикам пришлось писать адекватный объем кода для уточняющего запроса при использовании проверки подлинности с помощью форм.</span><span class="sxs-lookup"><span data-stu-id="31ce8-179">In ASP.NET 1.x, developers had to write a fair amount of code to do a lookup when using Forms authentication.</span></span> <span data-ttu-id="31ce8-180">Членство в ASP.NET 2,0 позволяет проверять подлинность пользователей без написания кода.</span><span class="sxs-lookup"><span data-stu-id="31ce8-180">With ASP.NET 2.0 membership, you can validate users without writing any code at all.</span></span> <span data-ttu-id="31ce8-181">ASP.NET автоматически выполняет поиск пользователя.</span><span class="sxs-lookup"><span data-stu-id="31ce8-181">ASP.NET will automatically do the look-up of the user for you.</span></span> <span data-ttu-id="31ce8-182">(Если вы используете элемент управления Login без использования членства ASP.NET, для проверки пользователя можно использовать метод **onauthenticat** .)</span><span class="sxs-lookup"><span data-stu-id="31ce8-182">(If you are using the Login control without using ASP.NET membership, you can use the **OnAuthenticate** method to validate the user.)</span></span>

## <a name="loginview-control"></a><span data-ttu-id="31ce8-183">Элемент управления LoginView</span><span class="sxs-lookup"><span data-stu-id="31ce8-183">LoginView Control</span></span>

<span data-ttu-id="31ce8-184">Элемент управления LoginView — это шаблонный элемент управления, который по умолчанию предоставляет два шаблона. Анонимаустемплате и Логжединтемплате.</span><span class="sxs-lookup"><span data-stu-id="31ce8-184">The LoginView control is a templated control that provides two templates by default; the AnonymousTemplate and the LoggedInTemplate.</span></span> <span data-ttu-id="31ce8-185">Отображаемый шаблон определяется тем, входит ли пользователь в систему членства.</span><span class="sxs-lookup"><span data-stu-id="31ce8-185">The template that is displayed is determined by whether or not the user is logged into your membership system.</span></span> <span data-ttu-id="31ce8-186">Этот элемент управления обычно используется для вывода элемента управления Login, когда пользователь еще не вошел в систему, а также элемент управления LoginStatus и (или) другие элементы управления входом, когда пользователь выполнил вход.</span><span class="sxs-lookup"><span data-stu-id="31ce8-186">This control is typically used to display a Login control when a user has not yet logged in and a LoginStatus control and/or other login controls when the user has logged in.</span></span> <span data-ttu-id="31ce8-187">Если вы используете управление ролями в приложении ASP.NET, элемент управления LoginView может отображать конкретный шаблон на основе роли пользователей.</span><span class="sxs-lookup"><span data-stu-id="31ce8-187">If you are using role management in your ASP.NET application, the LoginView control can display a specific template based upon the users role.</span></span> <span data-ttu-id="31ce8-188">(Дополнительные сведения об управлении ролями ASP.NET будут рассмотрены позже.)</span><span class="sxs-lookup"><span data-stu-id="31ce8-188">(More on ASP.NET role management will be covered later.)</span></span>

## <a name="passwordrecovery-control"></a><span data-ttu-id="31ce8-189">Элемент управления Пассвордрековери</span><span class="sxs-lookup"><span data-stu-id="31ce8-189">PasswordRecovery Control</span></span>

<span data-ttu-id="31ce8-190">Элемент управления Пассвордрековери позволяет пользователям получить сообщение электронной почты с его текущим паролем или сбросить свой пароль.</span><span class="sxs-lookup"><span data-stu-id="31ce8-190">The PasswordRecovery control allows users to receive an email with his or her current password or reset his or her password.</span></span> <span data-ttu-id="31ce8-191">Открытый текст и зашифрованные пароли могут быть восстановлены и отправлены пользователям по электронной почте.</span><span class="sxs-lookup"><span data-stu-id="31ce8-191">Clear text and encrypted passwords can be recovered and emailed to users.</span></span> <span data-ttu-id="31ce8-192">Если пароль хэширован, восстановить его невозможно.</span><span class="sxs-lookup"><span data-stu-id="31ce8-192">If the password is hashed, it cannot be recovered.</span></span> <span data-ttu-id="31ce8-193">Вместо этого пользователю потребуется выполнить сброс пароля.</span><span class="sxs-lookup"><span data-stu-id="31ce8-193">Instead the user will be required to perform a password reset.</span></span>

## <a name="loginstatus-control"></a><span data-ttu-id="31ce8-194">Элемент управления LoginStatus</span><span class="sxs-lookup"><span data-stu-id="31ce8-194">LoginStatus Control</span></span>

<span data-ttu-id="31ce8-195">Элемент управления LoginStatus используется для отображения индикатора входа для пользователей, которые не выполнили вход, и индикатора выхода для пользователей, которые в данный момент вошли в систему.</span><span class="sxs-lookup"><span data-stu-id="31ce8-195">The LoginStatus control is used to display a login indicator to users who are not logged in and a logout indicator to users who are currently logged in.</span></span> <span data-ttu-id="31ce8-196">Свойство Request. Authenticator используется для определения отображаемого индикатора.</span><span class="sxs-lookup"><span data-stu-id="31ce8-196">The Request.IsAuthenticated property is used to determine which indicator to display.</span></span> <span data-ttu-id="31ce8-197">Индикатором, отображаемым элементом управления LoginStatus, может быть текст (реализован через свойства **логинтекст** и **логауттекст** ) или изображения (реализованные с помощью свойств **логинимажеурл** и **логаутимажеурл** ).</span><span class="sxs-lookup"><span data-stu-id="31ce8-197">The indicator displayed by the LoginStatus control can be text (implemented via the **LoginText** and **LogoutText** properties) or images (implemented via the **LoginImageUrl** and **LogoutImageUrl** properties.)</span></span>

<span data-ttu-id="31ce8-198">Когда пользователь выходит через элемент управления LoginStatus, он перенаправляется на URL-адрес, указанный свойством **логаутпажеурл** .</span><span class="sxs-lookup"><span data-stu-id="31ce8-198">When a user logs out via the LoginStatus control, he or she is redirected to the URL specified by the **LogoutPageUrl** property.</span></span> <span data-ttu-id="31ce8-199">Если это свойство не задано, обновляется текущая страница.</span><span class="sxs-lookup"><span data-stu-id="31ce8-199">If that property is not set, the current page is refreshed.</span></span> <span data-ttu-id="31ce8-200">Поскольку сайт, вероятно, защищен проверкой подлинности с помощью форм, обновление текущей страницы перенаправит пользователя на страницу входа для сайта.</span><span class="sxs-lookup"><span data-stu-id="31ce8-200">Since the site is likely protected by Forms authentication, the refresh of the current page will redirect the user to the login page for the site.</span></span>

## <a name="loginname-control"></a><span data-ttu-id="31ce8-201">Элемент управления LoginName</span><span class="sxs-lookup"><span data-stu-id="31ce8-201">LoginName Control</span></span>

<span data-ttu-id="31ce8-202">Элемент управления LoginName отображает имя пользователя, который в данный момент вошел в систему сайта.</span><span class="sxs-lookup"><span data-stu-id="31ce8-202">The LoginName control displays the username of the user currently logged into the site.</span></span>

## <a name="createuserwizard-control"></a><span data-ttu-id="31ce8-203">Элемент управления CreateUserWizard</span><span class="sxs-lookup"><span data-stu-id="31ce8-203">CreateUserWizard Control</span></span>

<span data-ttu-id="31ce8-204">Элемент управления CreateUserWizard предоставляет пользователям удобный способ регистрации в системе членства.</span><span class="sxs-lookup"><span data-stu-id="31ce8-204">The CreateUserWizard control provides users with a convenient way to register for your membership system.</span></span> <span data-ttu-id="31ce8-205">Вы можете добавить шаги (реализованные в виде коллекции WizardSteps) через интерфейс, показанный ниже.</span><span class="sxs-lookup"><span data-stu-id="31ce8-205">You can add steps (implemented as a collection of WizardSteps) via the interface shown below.</span></span>

![](membership/_static/image5.jpg)

<span data-ttu-id="31ce8-206">**Рис. 5**</span><span class="sxs-lookup"><span data-stu-id="31ce8-206">**Figure 5**</span></span>

<span data-ttu-id="31ce8-207">CreateUserWizard — это шаблонный элемент управления, производный от класса Wizard, который предоставляет следующие шаблоны:</span><span class="sxs-lookup"><span data-stu-id="31ce8-207">The CreateUserWizard is a templated control that derives from the Wizard class and provides the following templates:</span></span>

- <span data-ttu-id="31ce8-208">**HeaderTemplate** Этот шаблон управляет внешним видом заголовка мастера.</span><span class="sxs-lookup"><span data-stu-id="31ce8-208">**HeaderTemplate** This template controls the appearance of the header of the wizard.</span></span>
- <span data-ttu-id="31ce8-209">**SidebarTemplate** Этот шаблон управляет внешним видом боковой панели мастера.</span><span class="sxs-lookup"><span data-stu-id="31ce8-209">**SidebarTemplate** This template controls the appearance of the sidebar of the wizard.</span></span>
- <span data-ttu-id="31ce8-210">**Стартнавигатионтемплате** Этот шаблон определяет внешний вид навигации в мастере на шаге "начало".</span><span class="sxs-lookup"><span data-stu-id="31ce8-210">**StartNavigationTemplate** This template controls the appearance of the navigation are of the wizard at the start step.</span></span>
- <span data-ttu-id="31ce8-211">**StepNavigationTemplate** Этот шаблон управляет внешним видом области навигации, если не находится на шаге начало или конец.</span><span class="sxs-lookup"><span data-stu-id="31ce8-211">**StepNavigationTemplate** This template controls the appearance of the navigation area when not in the start or finish step.</span></span>
- <span data-ttu-id="31ce8-212">**FinishNavigationTemplate** Этот шаблон управляет внешним видом области навигации на этапе завершения.</span><span class="sxs-lookup"><span data-stu-id="31ce8-212">**FinishNavigationTemplate** This template controls the appearance of the navigation area when on the finish step.</span></span>

<span data-ttu-id="31ce8-213">Кроме того, для каждого шага, добавляемого в мастер, ASP.NET создаст пользовательский шаблон, который содержит как ContentTemplate, так и CustomNavigationTemplate для этого шага.</span><span class="sxs-lookup"><span data-stu-id="31ce8-213">Additionally, for each step that you add to the Wizard, ASP.NET will create a custom template that contains both a ContentTemplate and a CustomNavigationTemplate for that step.</span></span> <span data-ttu-id="31ce8-214">Полные сведения о настройке CreateUserWizard см. в документации по VS.NET 2005:</span><span class="sxs-lookup"><span data-stu-id="31ce8-214">For full details on customizing the CreateUserWizard, see the VS.NET 2005 documentation:</span></span>

## <a name="changepassword-control"></a><span data-ttu-id="31ce8-215">ChangePassword, элемент управления</span><span class="sxs-lookup"><span data-stu-id="31ce8-215">ChangePassword Control</span></span>

<span data-ttu-id="31ce8-216">Элемент управления ChangePassword позволяет пользователям изменять свой пароль.</span><span class="sxs-lookup"><span data-stu-id="31ce8-216">The ChangePassword control allows users to change his or her password.</span></span> <span data-ttu-id="31ce8-217">Если свойство DisplayUserName имеет значение true (по умолчанию имеет значение false), пользователь может изменить свой пароль, если он не вошел в систему.</span><span class="sxs-lookup"><span data-stu-id="31ce8-217">If the DisplayUserName property is true (it is false by default), the user can change his or her password when they are not logged in.</span></span> <span data-ttu-id="31ce8-218">Если *пользователь уже выполнил* вход и свойство DisplayUserName имеет значение true, пользователь сможет изменить пароль другого пользователя, который не вошел в систему, ПРЕДОСТАВИВ ему идентификатор пользователя.</span><span class="sxs-lookup"><span data-stu-id="31ce8-218">If the user *is* already logged in and the DisplayUserName property is true, the user will be able to change the password of another user that is not logged in providing they know the user ID of that user.</span></span>

<span data-ttu-id="31ce8-219">Помните, что если нужно, чтобы пользователи могли изменять пароли без входа в систему, необходимо убедиться, что страница, на которой отображается элемент управления ChangePassword, разрешает анонимный доступ.</span><span class="sxs-lookup"><span data-stu-id="31ce8-219">Keep in mind that if you want users to be able to change passwords without having to log in, you will need to ensure that the page on which the ChangePassword control is displayed allows anonymous access.</span></span> <span data-ttu-id="31ce8-220">Очевидно, чтобы изменить пароль, пользователям придется предоставить свой старый пароль.</span><span class="sxs-lookup"><span data-stu-id="31ce8-220">Obviously, users will have to provide their old password in order to change their password.</span></span>

## <a name="role-management"></a><span data-ttu-id="31ce8-221">Управление ролями</span><span class="sxs-lookup"><span data-stu-id="31ce8-221">Role Management</span></span>

<span data-ttu-id="31ce8-222">Управление ролями позволяет назначить пользователей определенной роли, а затем ограничить доступ к определенным файлам и папкам на основе этой роли.</span><span class="sxs-lookup"><span data-stu-id="31ce8-222">Role management allows you to assign users to a particular role and then restrict access to certain file or folders based on that role.</span></span> <span data-ttu-id="31ce8-223">Управление ролями также предоставляет API, чтобы можно было программным образом определить роль пользователя или определить всех пользователей в определенной роли и ответить соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="31ce8-223">Role management also provides an API so that you can programmatically determine someones role or determine all users in a particular role and respond accordingly.</span></span>

<span data-ttu-id="31ce8-224">Управление ролями не является обязательным для членства в ASP.NET и не является обязательным для использования управления ролями.</span><span class="sxs-lookup"><span data-stu-id="31ce8-224">Role management is not a requirement in ASP.NET membership, nor is membership a requirement in order to use role management.</span></span> <span data-ttu-id="31ce8-225">Тем не менее, эти два дополнения к друг другу хорошо, и вполне вероятно, что разработчики будут использовать их совместно друг с другом.</span><span class="sxs-lookup"><span data-stu-id="31ce8-225">However, the two supplement each other nicely and it is likely that developers will use them in conjunction with each other.</span></span>

<span data-ttu-id="31ce8-226">Чтобы включить управление ролями в приложении, внесите следующее изменение в файл Web. config:</span><span class="sxs-lookup"><span data-stu-id="31ce8-226">To enable role management in your application, make the following change in your web.config file:</span></span>

[!code-xml[Main](membership/samples/sample2.xml)]

<span data-ttu-id="31ce8-227">Если атрибут **качеролесинкукие** имеет значение true, ASP.NET кэширует членство в роли пользователей в файле cookie на клиенте.</span><span class="sxs-lookup"><span data-stu-id="31ce8-227">When the **cacheRolesInCookie** attribute is set to true, ASP.NET caches a users role membership in a cookie on the client.</span></span> <span data-ttu-id="31ce8-228">Это позволяет выполнять поиск ролей без вызова RoleProvider.</span><span class="sxs-lookup"><span data-stu-id="31ce8-228">This allows role lookups to occur without calls into the RoleProvider.</span></span> <span data-ttu-id="31ce8-229">При использовании этого атрибута разработчики должны убедиться, что атрибут **кукиепротектион** имеет значение ALL.</span><span class="sxs-lookup"><span data-stu-id="31ce8-229">When using this attribute, developers are encouraged to ensure that the **cookieProtection** attribute is set to All.</span></span> <span data-ttu-id="31ce8-230">(Это значение по умолчанию.) Это обеспечивает шифрование данных файлов cookie и помогает гарантировать, что содержимое файлов cookie не было изменено.</span><span class="sxs-lookup"><span data-stu-id="31ce8-230">(This is the default setting.) This ensures that the cookie data are encrypted and helps to ensure that the cookies contents haven't been altered.</span></span> <span data-ttu-id="31ce8-231">Роли можно добавлять с помощью средства администрирования веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="31ce8-231">Roles can be added using the Web Site Administration Tool.</span></span> <span data-ttu-id="31ce8-232">Он позволяет легко определять роли, настраивать доступ к частям сайта на основе этих ролей и назначать пользователей ролям.</span><span class="sxs-lookup"><span data-stu-id="31ce8-232">It allows you to easily define roles, configure access to parts of the site based on those roles, and assign users to roles.</span></span>

![](membership/_static/image6.jpg)

<span data-ttu-id="31ce8-233">**Рис. 6**</span><span class="sxs-lookup"><span data-stu-id="31ce8-233">**Figure 6**</span></span>

<span data-ttu-id="31ce8-234">Как показано выше, новые роли можно добавить, просто введя имя роли и нажав кнопку Добавить роль.</span><span class="sxs-lookup"><span data-stu-id="31ce8-234">As shown above, new roles can be added by simply entering the name of the role and then clicking Add Role.</span></span> <span data-ttu-id="31ce8-235">Существующие роли можно управлять или удалять, щелкнув соответствующую ссылку в списке существующих ролей.</span><span class="sxs-lookup"><span data-stu-id="31ce8-235">Existing roles can be managed or deleted by clicking the appropriate link in the list of existing roles.</span></span>

<span data-ttu-id="31ce8-236">При управлении ролью можно добавлять или удалять пользователей, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="31ce8-236">When you manage a role, you can add or remove users as shown below.</span></span>

![](membership/_static/image7.jpg)

<span data-ttu-id="31ce8-237">**Рис. 7**</span><span class="sxs-lookup"><span data-stu-id="31ce8-237">**Figure 7**</span></span>

<span data-ttu-id="31ce8-238">Установив флажок пользователь входит в роль, можно легко добавить пользователя в определенную роль.</span><span class="sxs-lookup"><span data-stu-id="31ce8-238">By checking the User Is In Role checkbox, you can easily add a user to a specific role.</span></span> <span data-ttu-id="31ce8-239">ASP.NET автоматически обновит вашу базу данных членства соответствующими записями.</span><span class="sxs-lookup"><span data-stu-id="31ce8-239">ASP.NET will automatically update your membership database with the appropriate entries.</span></span> <span data-ttu-id="31ce8-240">Кроме того, необходимо настроить правила доступа для приложения.</span><span class="sxs-lookup"><span data-stu-id="31ce8-240">You will also want to configure access rules for your application.</span></span> <span data-ttu-id="31ce8-241">Разработчики ASP.NET 1. x знакомы с этим, используя элемент&gt; авторизации &lt;в файле Web. config, и этот параметр по-прежнему доступен в ASP.NET 2,0.</span><span class="sxs-lookup"><span data-stu-id="31ce8-241">ASP.NET 1.x developers are familiar with doing this via the &lt;authorization&gt; element in the web.config file, and that option is still available in ASP.NET 2.0.</span></span> <span data-ttu-id="31ce8-242">Однако проще управлять правилами доступа с помощью средства администрирования веб-сайта, как показано ниже.</span><span class="sxs-lookup"><span data-stu-id="31ce8-242">However, its easier to manage access rules using the Web Site Administration Tool as shown below.</span></span>

![](membership/_static/image8.jpg)

<span data-ttu-id="31ce8-243">**Рис. 8**</span><span class="sxs-lookup"><span data-stu-id="31ce8-243">**Figure 8**</span></span>

<span data-ttu-id="31ce8-244">В этом случае папка администрирования выделяется (ее трудно увидеть, поскольку она выделяется светло-серым цветом), а роли "Администраторы" предоставлен доступ.</span><span class="sxs-lookup"><span data-stu-id="31ce8-244">In this case, the Administration folder is highlighted (its difficult to see because the tool highlights it in light gray) and the Administrators role has been granted access.</span></span> <span data-ttu-id="31ce8-245">Все остальные пользователи отклоняются.</span><span class="sxs-lookup"><span data-stu-id="31ce8-245">All other users are denied.</span></span> <span data-ttu-id="31ce8-246">Можно щелкнуть значок заголовка, чтобы выбрать правило, а затем воспользоваться кнопками вверх и вниз, чтобы расположить правила.</span><span class="sxs-lookup"><span data-stu-id="31ce8-246">You can click on the head icon to select a rule and then use the Move Up and Move Down buttons to arrange the rules.</span></span> <span data-ttu-id="31ce8-247">Как и в случае с элементом&gt; авторизации ASP.NET &lt;, правила обрабатываются в том порядке, в котором они отображаются.</span><span class="sxs-lookup"><span data-stu-id="31ce8-247">As with the ASP.NET &lt;authorization&gt; element, rules are processed in the order in which they appear.</span></span> <span data-ttu-id="31ce8-248">Иными словами, если порядок правил на приведенном выше снимке был изменен, никто не будет иметь доступа к папке администрирования, так как первым правилом, которое ASP.NET бы, является правило, запрещающее всех пользователей в папке.</span><span class="sxs-lookup"><span data-stu-id="31ce8-248">In other words, if the order of rules in the shot above were reversed, no one would have access to the Administration folder because the first rule that ASP.NET would encounter would be the rule that denies everyone to the folder.</span></span>

<span data-ttu-id="31ce8-249">ASP.NET 2,0 добавляет файл Web. config в папку, для которой указывается правило доступа.</span><span class="sxs-lookup"><span data-stu-id="31ce8-249">ASP.NET 2.0 adds a web.config file to the folder for which you are specifying an access rule.</span></span> <span data-ttu-id="31ce8-250">Правила доступа можно изменять с помощью файла конфигурации или средства администрирования веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="31ce8-250">Access rules can be edited via the configuration file or via the Web Site Administration Tool.</span></span> <span data-ttu-id="31ce8-251">Иными словами, средство администрирования веб-сайта — это просто интерфейс, с помощью которого файл конфигурации можно редактировать в удобной для пользователя среде.</span><span class="sxs-lookup"><span data-stu-id="31ce8-251">In other words, the Web Site Administration Tool is simply an interface through which the configuration file can be edited in a user-friendly environment.</span></span>

## <a name="using-roles-in-code"></a><span data-ttu-id="31ce8-252">Использование ролей в коде</span><span class="sxs-lookup"><span data-stu-id="31ce8-252">Using Roles in Code</span></span>

<span data-ttu-id="31ce8-253">API для управления ролями не изменился с версии 1. x.</span><span class="sxs-lookup"><span data-stu-id="31ce8-253">The API for role management has not changed since version 1.x.</span></span> <span data-ttu-id="31ce8-254">Метод **IsInRole** используется для определения того, входит ли пользователь в конкретную роль.</span><span class="sxs-lookup"><span data-stu-id="31ce8-254">The **IsInRole** method is used to determine if a user is in a particular role.</span></span>

[!code-csharp[Main](membership/samples/sample3.cs)]

<span data-ttu-id="31ce8-255">ASP.NET также создает экземпляр РолепринЦипал в качестве члена текущего контекста.</span><span class="sxs-lookup"><span data-stu-id="31ce8-255">ASP.NET also creates a RolePrincipal instance as a member of the current context.</span></span> <span data-ttu-id="31ce8-256">Объект РолепринЦипал можно использовать для получения всех ролей, к которым принадлежит пользователь, следующим образом.</span><span class="sxs-lookup"><span data-stu-id="31ce8-256">The RolePrincipal object can be used to obtain all of the roles to which the user belongs as follows:</span></span>

[!code-csharp[Main](membership/samples/sample4.cs)]

## <a name="using-rolegroups-with-the-loginview-control"></a><span data-ttu-id="31ce8-257">Использование группы ролей с элементом управления LoginView</span><span class="sxs-lookup"><span data-stu-id="31ce8-257">Using RoleGroups with the LoginView Control</span></span>

<span data-ttu-id="31ce8-258">Теперь, когда у вас есть знания об управлении ролями и членстве в нем, можно обсудить, как элемент управления LoginView использует преимущества этой возможности в ASP.NET 2,0.</span><span class="sxs-lookup"><span data-stu-id="31ce8-258">Now that you have an understanding of role management and membership, lets discuss briefly how the LoginView control takes advantage of this capability in ASP.NET 2.0.</span></span> <span data-ttu-id="31ce8-259">Как уже говорилось, элемент управления LoginView является шаблонным элементом управления, который по умолчанию содержит два шаблона. Анонимаустемплате и Логжединтемплате.</span><span class="sxs-lookup"><span data-stu-id="31ce8-259">As previously discussed, the LoginView control is a templated control that contains two templates by default; the AnonymousTemplate and the LoggedInTemplate.</span></span> <span data-ttu-id="31ce8-260">В диалоговом окне Задачи LoginView находится ссылка (показана ниже), позволяющая изменить группы ролей.</span><span class="sxs-lookup"><span data-stu-id="31ce8-260">Within the LoginView Tasks dialog is a link (shown below) that allows you to edit RoleGroups.</span></span>

![](membership/_static/image9.jpg)

<span data-ttu-id="31ce8-261">**Рис. 9**</span><span class="sxs-lookup"><span data-stu-id="31ce8-261">**Figure 9**</span></span>

<span data-ttu-id="31ce8-262">Каждый объект группы ролей содержит массив строк, который определяет, к каким ролям применяется группы ролей.</span><span class="sxs-lookup"><span data-stu-id="31ce8-262">Each RoleGroup object contains an array of strings that defines which roles that RoleGroup applies to.</span></span> <span data-ttu-id="31ce8-263">Чтобы добавить новый группы ролей в элемент управления LoginView, щелкните ссылку Edit группы ролей (изменить).</span><span class="sxs-lookup"><span data-stu-id="31ce8-263">To add a new RoleGroup to the LoginView control, click the Edit RoleGroups link.</span></span> <span data-ttu-id="31ce8-264">На приведенном выше рисунке видно, что я добавил новый группы ролей для администраторов.</span><span class="sxs-lookup"><span data-stu-id="31ce8-264">In the image above, you can see that I have added a new RoleGroup for Administrators.</span></span> <span data-ttu-id="31ce8-265">Выбрав этот группы ролей (группы ролей [0]) в раскрывающемся списке представления, можно настроить шаблон, который будет отображаться только членам роли "Администраторы".</span><span class="sxs-lookup"><span data-stu-id="31ce8-265">By selecting that RoleGroup (RoleGroup[0]) from the Views dropdown, I can configure a template that will only be displayed to members of the Administrators role.</span></span> <span data-ttu-id="31ce8-266">На приведенном ниже рисунке я добавил новый группы ролей, который применяется к членам роли Sales и роли распределения.</span><span class="sxs-lookup"><span data-stu-id="31ce8-266">In the image below, I have added a new RoleGroup that applies to members of the Sales role and the Distribution role.</span></span> <span data-ttu-id="31ce8-267">Это добавляет второй группы ролей в раскрывающийся список "представления" в диалоговом окне "Задачи LoginView" и все, что добавляется в этот шаблон, будет отображаться любым пользователем в роли "продажи" или "распределение".</span><span class="sxs-lookup"><span data-stu-id="31ce8-267">This adds a second RoleGroup to the Views dropdown in the LoginView Tasks dialog and anything added to that template will be visible by any user in either the Sales or Distribution role.</span></span>

![](membership/_static/image10.jpg)

<span data-ttu-id="31ce8-268">**Рис. 10**</span><span class="sxs-lookup"><span data-stu-id="31ce8-268">**Figure 10**</span></span>

## <a name="overriding-the-existing-membership-provider"></a><span data-ttu-id="31ce8-269">Переопределение существующего поставщика членства</span><span class="sxs-lookup"><span data-stu-id="31ce8-269">Overriding the Existing Membership Provider</span></span>

<span data-ttu-id="31ce8-270">Существует несколько способов расширения функциональности членства в ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="31ce8-270">There are a couple of ways that you can extend the functionality of ASP.NET membership.</span></span> <span data-ttu-id="31ce8-271">Во – первых, можно изменить существующие функциональные возможности класса SqlMembershipProvider, наследуя от него наследование и переопределив его методы.</span><span class="sxs-lookup"><span data-stu-id="31ce8-271">First of all, you can obviously change the existing functionality of the SqlMembershipProvider class by inheriting from it and overriding its methods.</span></span> <span data-ttu-id="31ce8-272">Например, если вы хотите реализовать собственные функции при создании пользователей, можно создать собственный класс, наследующий от SqlMembershipProvider, следующим образом:</span><span class="sxs-lookup"><span data-stu-id="31ce8-272">For example, if you want to implement your own functionality when users are created, you can create your own class that inherits from SqlMembershipProvider as follows:</span></span>

[!code-csharp[Main](membership/samples/sample5.cs)]

<span data-ttu-id="31ce8-273">Если, с другой стороны, нужно создать собственный поставщик (например, для хранения сведений о членстве в базе данных Access), можно создать собственный поставщик.</span><span class="sxs-lookup"><span data-stu-id="31ce8-273">If, on the other hand, you want to create your own provider (to store your membership information in an Access database, for example), you can create your own provider.</span></span>

## <a name="creating-your-own-membership-provider"></a><span data-ttu-id="31ce8-274">Создание собственного поставщика членства</span><span class="sxs-lookup"><span data-stu-id="31ce8-274">Creating Your Own Membership Provider</span></span>

<span data-ttu-id="31ce8-275">Для создания собственного поставщика членства сначала необходимо создать класс, наследующий от класса MembershipProvider.</span><span class="sxs-lookup"><span data-stu-id="31ce8-275">To create your own membership provider, you will first need to create a class that inherits from the MembershipProvider class.</span></span> <span data-ttu-id="31ce8-276">Если вы используете VB.NET, Visual Studio 2005 добавит заглушки для всех методов, которые необходимо переопределить.</span><span class="sxs-lookup"><span data-stu-id="31ce8-276">If you are using VB.NET, Visual Studio 2005 will add the stubs for all of the methods that you need to override.</span></span> <span data-ttu-id="31ce8-277">Если вы используете C#, добавьте заглушки.</span><span class="sxs-lookup"><span data-stu-id="31ce8-277">If you are using C#, its up to you to add the stubs.</span></span>

<span data-ttu-id="31ce8-278">Необходимо переопределить следующее:</span><span class="sxs-lookup"><span data-stu-id="31ce8-278">You will need to override the following:</span></span>

- <span data-ttu-id="31ce8-279">Свойство ApplicationName</span><span class="sxs-lookup"><span data-stu-id="31ce8-279">ApplicationName property</span></span>
- <span data-ttu-id="31ce8-280">Функция ChangePassword</span><span class="sxs-lookup"><span data-stu-id="31ce8-280">ChangePassword function</span></span>
- <span data-ttu-id="31ce8-281">Функция Чанжепассвордкуестионандансвер</span><span class="sxs-lookup"><span data-stu-id="31ce8-281">ChangePasswordQuestionAndAnswer function</span></span>
- <span data-ttu-id="31ce8-282">Функция CreateUser</span><span class="sxs-lookup"><span data-stu-id="31ce8-282">CreateUser function</span></span>
- <span data-ttu-id="31ce8-283">Функция Делетеусер</span><span class="sxs-lookup"><span data-stu-id="31ce8-283">DeleteUser function</span></span>
- <span data-ttu-id="31ce8-284">Енаблепассвордресет, свойство</span><span class="sxs-lookup"><span data-stu-id="31ce8-284">EnablePasswordReset property</span></span>
- <span data-ttu-id="31ce8-285">Енаблепассвордретриевал, свойство</span><span class="sxs-lookup"><span data-stu-id="31ce8-285">EnablePasswordRetrieval property</span></span>
- <span data-ttu-id="31ce8-286">Функция Финдусерсбемаил</span><span class="sxs-lookup"><span data-stu-id="31ce8-286">FindUsersByEmail function</span></span>
- <span data-ttu-id="31ce8-287">Функция Финдусерсбинаме</span><span class="sxs-lookup"><span data-stu-id="31ce8-287">FindUsersByName function</span></span>
- <span data-ttu-id="31ce8-288">Функция Жеталлусерс</span><span class="sxs-lookup"><span data-stu-id="31ce8-288">GetAllUsers function</span></span>
- <span data-ttu-id="31ce8-289">Функция Жетнумберофусерсонлине</span><span class="sxs-lookup"><span data-stu-id="31ce8-289">GetNumberOfUsersOnline function</span></span>
- <span data-ttu-id="31ce8-290">Функция onpassword</span><span class="sxs-lookup"><span data-stu-id="31ce8-290">GetPassword function</span></span>
- <span data-ttu-id="31ce8-291">Функция onuser</span><span class="sxs-lookup"><span data-stu-id="31ce8-291">GetUser function</span></span>
- <span data-ttu-id="31ce8-292">Функция Жетусернамебемаил</span><span class="sxs-lookup"><span data-stu-id="31ce8-292">GetUserNameByEmail function</span></span>
- <span data-ttu-id="31ce8-293">Максинвалидпассвордаттемптс, свойство</span><span class="sxs-lookup"><span data-stu-id="31ce8-293">MaxInvalidPasswordAttempts property</span></span>
- <span data-ttu-id="31ce8-294">Минрекуиредноналфанумерикчарактерс, свойство</span><span class="sxs-lookup"><span data-stu-id="31ce8-294">MinRequiredNonAlphanumericCharacters property</span></span>
- <span data-ttu-id="31ce8-295">Минрекуиредпассвордленгс, свойство</span><span class="sxs-lookup"><span data-stu-id="31ce8-295">MinRequiredPasswordLength property</span></span>
- <span data-ttu-id="31ce8-296">Пассвордаттемптвиндов, свойство</span><span class="sxs-lookup"><span data-stu-id="31ce8-296">PasswordAttemptWindow property</span></span>
- <span data-ttu-id="31ce8-297">Пассвордформат, свойство</span><span class="sxs-lookup"><span data-stu-id="31ce8-297">PasswordFormat property</span></span>
- <span data-ttu-id="31ce8-298">Пассвордстренгсрегуларекспрессион, свойство</span><span class="sxs-lookup"><span data-stu-id="31ce8-298">PasswordStrengthRegularExpression property</span></span>
- <span data-ttu-id="31ce8-299">Рекуирескуестионандансвер, свойство</span><span class="sxs-lookup"><span data-stu-id="31ce8-299">RequiresQuestionAndAnswer property</span></span>
- <span data-ttu-id="31ce8-300">Рекуиресуникуимаил, свойство</span><span class="sxs-lookup"><span data-stu-id="31ce8-300">RequiresUniqueEmail property</span></span>
- <span data-ttu-id="31ce8-301">Функция Ресетпассворд</span><span class="sxs-lookup"><span data-stu-id="31ce8-301">ResetPassword function</span></span>
- <span data-ttu-id="31ce8-302">Разблокировать пользовательскую функцию</span><span class="sxs-lookup"><span data-stu-id="31ce8-302">Unlock user function</span></span>
- <span data-ttu-id="31ce8-303">Функция Упдатеусер</span><span class="sxs-lookup"><span data-stu-id="31ce8-303">UpdateUser function</span></span>
- <span data-ttu-id="31ce8-304">Функция ValidateUser</span><span class="sxs-lookup"><span data-stu-id="31ce8-304">ValidateUser function</span></span>

<span data-ttu-id="31ce8-305">Поддерживающие аттестацию список для реализации в качестве C# разработчика.</span><span class="sxs-lookup"><span data-stu-id="31ce8-305">Thats quite a list to implement as a C# developer.</span></span> <span data-ttu-id="31ce8-306">Может оказаться проще создать класс в VB.NET без какой-либо реализации, а затем использовать отражатель .NET или аналогичное средство для преобразования кода в C#.</span><span class="sxs-lookup"><span data-stu-id="31ce8-306">You may find it easier to create the class in VB.NET without any implementation and then use .NET Reflector or a similar tool to convert the code to C#.</span></span>

<span data-ttu-id="31ce8-307">Для строки подключения и других свойств следует задать значения по умолчанию в методе Initialize.</span><span class="sxs-lookup"><span data-stu-id="31ce8-307">The connection string and other properties should be set to their defaults in the Initialize method.</span></span> <span data-ttu-id="31ce8-308">(Метод Initialize срабатывает, когда поставщик загружается во время выполнения.) Второй параметр метода Initialize имеет тип System. Collections. Custom. NameValueCollection и является ссылкой на &lt;добавить&gt; элемент, связанный с настраиваемым поставщиком в файле Web. config.</span><span class="sxs-lookup"><span data-stu-id="31ce8-308">(The Initialize method is fired when the provider is loaded at runtime.) The second parameter to the Initialize method is of type System.Collections.Specialized.NameValueCollection and is a reference to the &lt;add&gt; element that is associated with your custom provider in the web.config file.</span></span> <span data-ttu-id="31ce8-309">Эта запись выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="31ce8-309">That entry looks like the following:</span></span>

[!code-xml[Main](membership/samples/sample6.xml)]

<span data-ttu-id="31ce8-310">Ниже приведен пример метода Initialize.</span><span class="sxs-lookup"><span data-stu-id="31ce8-310">Here is an example of the Initialize method.</span></span>

[!code-csharp[Main](membership/samples/sample7.cs)]

<span data-ttu-id="31ce8-311">Чтобы проверить пользователя при отправке формы входа, необходимо использовать метод ValidateUser.</span><span class="sxs-lookup"><span data-stu-id="31ce8-311">In order to validate the user when they submit your login form, you will need to use the ValidateUser method.</span></span> <span data-ttu-id="31ce8-312">Этот метод срабатывает, когда пользователь нажимает кнопку входа в элементе управления Login.</span><span class="sxs-lookup"><span data-stu-id="31ce8-312">This method fires when the user clicks the login button in the Login control.</span></span> <span data-ttu-id="31ce8-313">В этом методе будет размещен код, который выполняет поиск пользователя.</span><span class="sxs-lookup"><span data-stu-id="31ce8-313">You will place your code that does the user lookup in this method.</span></span>

<span data-ttu-id="31ce8-314">Как видите, написание собственного поставщика членства не является сложным и позволяет расширить эту функциональность ASP.NET 2,0.</span><span class="sxs-lookup"><span data-stu-id="31ce8-314">As you can see, writing your own membership provider is not difficult and allows you to extend this powerful functionality of ASP.NET 2.0.</span></span>
