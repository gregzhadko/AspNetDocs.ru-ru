---
uid: web-forms/overview/moving-to-aspnet-20/improvements-in-visual-studio-2005
title: Улучшения в Visual Studio 2005 | Документация Майкрософт
author: microsoft
description: Visual Studio 2005 предоставляет разработчикам веб-приложений полный список улучшений и усовершенствований веб-проектов.
ms.author: riande
ms.date: 02/20/2005
ms.assetid: 72d90cd0-b3d9-454c-b2eb-ed0d9812f32c
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/improvements-in-visual-studio-2005
msc.type: authoredcontent
ms.openlocfilehash: 64215d556ded0850537a13856fe69b094116ebca
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78464652"
---
# <a name="improvements-in-visual-studio-2005"></a>Усовершенствования в Visual Studio 2005

по [Майкрософт](https://github.com/microsoft)

> Visual Studio 2005 предоставляет разработчикам веб-приложений полный список улучшений и усовершенствований веб-проектов.

Visual Studio 2005 предоставляет разработчикам веб-приложений полный список улучшений и усовершенствований веб-проектов. Так же, как Visual Studio .NET 2002 и 2003, существует много жалоб на способ обработки веб-проектов. Visual Studio 2005 добавляет значительное количество новых функций для решения этих жалоб. Для тех, кто предпочитает, как Visual Studio .NET 2003 обрабатывает компиляцию веб-приложений, см. статью [проекты веб-приложений](https://go.microsoft.com/fwlink/?LinkId=57870).

В этом модуле вы узнаете о усовершенствованиях по созданию, управлению и разработке веб-проекта. В более позднем модуле вы узнаете о усовершенствованиях в разработке веб-проектов и их развертывании.

## <a name="frontpage-server-extensions"></a>Серверные расширения FrontPage

Для создания или сборки веб-проектов в Visual Studio .NET 2002 и 2003 требуются серверные расширения FrontPage. У разработчиков есть выбор между двумя разными режимами доступа (серверные расширения FrontPage или режим доступа к файлам), которые используют серверные расширения FrontPage для выполнения таких задач, как настройка корневого каталога приложения в IIS и т. д.

Visual Studio 2005 устраняет зависимость от серверных расширений FrontPage для локальных проектов. Visual Studio 2005 теперь обращается непосредственно к метабазе IIS вместо использования серверных расширений FrontPage. В Visual Studio 2005 также добавлена поддержка FTP, которая обеспечивает удаленный доступ к проекту, не требуя наличия серверных расширений FrontPage.

Для тех разработчиков, которые хотят использовать серверные расширения FrontPage в своих проектах, этот вариант по-прежнему доступен. Однако на основе надежных отзывов от сообщества разработчиков ASP.NET это не обязательно.

> [!NOTE]
> Серверные расширения FrontPage по-прежнему требуются для создания удаленных проектов, их открытия и т. д.

## <a name="aspnet-development-server"></a>Сервер ASP.NET Development Server

Visual Studio 2005 поставляется с новым веб-сервером, который называется ASP.NET Development Server. (Этот веб-сервер ранее назывался Cassini.)

Существует несколько преимуществ ASP.NET Development Server.

- Теперь не администраторы могут разрабатывать и отлаживать веб-сервер.
- ASP.NET Development Server динамически сопоставляет виртуальные каталоги с любым расположением в файловой системе, что позволяет использовать гибкие расположения проектов.
- Пользователи Windows XP Professional, которые уже используют IIS, теперь смогут создавать новые веб-приложения, которые не влияют на структуру файлов и папок веб-сайта по умолчанию в службах IIS.

Для использования ASP.NET Development Server не требуется специальная настройка. При отладке или просмотре веб-проекта, размещенного в файловой системе, Visual Studio 2005 автоматически запустит экземпляр ASP.NET Development Server на случайном порту для обслуживания запроса.

Дополнительные сведения будут обсуждаться в ASP.NET Development Server далее в этом модуле.

## <a name="improved-file-management"></a>Улучшенное управление файлами

В Visual Studio 2002 и 2003 файл проекта (VBPROJ для VB.NET и. csproj для C#) хранит сведения обо всех файлах в веб-приложении. Обозреватель решений отображается на основе сведений о файле в файле проекта. По этой причине обозреватель решений часто отображает неточные сведения в случаях, когда использовались внешние редакторы. Visual Studio 2002 и 2003 часто перезапишут изменения файлов или не отображают последние версии файлов.

Visual Studio 2005 не поддерживает файл проекта. Вместо этого он считывает сведения о файле и папке непосредственно с диска, что приводит к точному отображению файлов в проекте. Так как папка References в Visual Studio 2002 и 2003 не представляет фактическую папку в веб-приложении, Visual Studio 2005 также удаляет папку References из обозреватель решений. Чтобы получить доступ к ссылкам для проекта в Visual Studio 2005, следует использовать страницы свойств для проекта.

## <a name="creating-web-projects"></a>Создание веб-проектов

Веб-разработчики имеют много новых возможностей для создания проектов в Visual Studio 2005. Теперь веб-сайты можно создавать в любом месте файловой системы, а затем выполнять их отладку или Просмотр с помощью нового ASP.NET Development Server. Разработчики также могут создавать новые веб-сайты с помощью FTP.

Щелкните здесь, чтобы просмотреть видео пошаговое руководство по созданию веб-проектов в Visual Studio 2005.

![](improvements-in-visual-studio-2005/_static/image1.png)

[Открыть полноэкранное видео](improvements-in-visual-studio-2005/_static/creating_projects1.wmv)

### <a name="file-system-projects"></a>Проекты файловой системы

Как вы видели в этом пошаговом руководстве, вы можете создавать веб-сайты в файловой системе либо на локальном компьютере, либо в удаленном расположении через общую папку. Веб-сайты, созданные в файловой системе, просматриваются и отлаживаться с помощью ASP.NET Development Server.

> [!NOTE]
> ASP.NET Development Server может вызвать некоторую путаницу для клиентов. Если веб-проект создается в файловой системе в структуре каталогов Иисс (т. е. c:/Inetpub/Wwwroot), веб-сайт по-прежнему будет просмотрен с помощью ASP.NET Development Server при запуске из Visual Studio 2005. Таким образом, любая конфигурация IIS (т. е. методы проверки подлинности) неприменима.

Веб-проект по умолчанию также удаляет массу издержек, включая только страницу Default. aspx, файл default.cs и папку App/_Data. Файл Web. config и специальные папки (например, приложение/_code) добавляются по мере необходимости. Веб-проект включает в себя только необходимые файлы и папки.

### <a name="http-projects"></a>Проекты HTTP

Проекты HTTP могут быть либо проектами, созданными на локальном веб-сайте IIS, либо на удаленном веб-сайте. Расположение проекта по умолчанию — `http://localhost`. При нажатии кнопки Обзор есть два варианта HTTP: local IIS и Remote Site. Основное различие в этих двух вариантах — метод, в котором сведения о веб-сайте отображаются в диалоговом окне Выбор расположения и при копировании файлов на веб-сервер.

Параметр local IIS Считывает сведения о сайте из метабазы на локальном компьютере, а файлы копируются с помощью файловой системы. Параметр удаленный сайт использует серверные расширения FrontPage, а сведения о сайте и файлы копируются с помощью вызовов RPC HTTP и FrontPage Server Extensions.

> [!NOTE]
> Файл VS # # #/_tmp. htm и Get/_aspx/_ver. aspx больше не используются для определения сведений о версии.

Параметр HTTP по умолчанию — Local IIS. Этот параметр считывает метабазу IIS, чтобы определить доступные сайты и расположение для создания содержимого. Можно выбрать другую папку или виртуальный каталог, выбрав его в представлении в виде дерева. Можно также создать новый виртуальный каталог, пометить папки как приложения, а также удалить существующие виртуальные каталоги из этого диалогового окна.

![Диалоговое окно выбора расположения](improvements-in-visual-studio-2005/_static/image1.gif)

**Рис. 1**. диалоговое окно выбора расположения

В отличие от более ранних версий Visual Studio, если установлен флажок **Use SSL** и SSL-сертификат не совпадает с просматриваемым URL, отобразится диалоговое окно с предупреждением системы безопасности с вопросом о том, что вы хотите продолжить. При использовании Visual Studio .NET 2003, если сертификат не соответствует ни одному, создание проекта завершится ошибкой.

![Оповещение системы безопасности о SSL-сертификате](improvements-in-visual-studio-2005/_static/image2.gif)

**Рис. 2**. Оповещение системы безопасности о SSL-сертификате

### <a name="note-on-host-headers"></a>Примечание к заголовкам узлов

При создании веб-приложения на сайте, привязанном к определенному IP-адресу, необходимо убедиться, что заголовок узла настроен. В противном случае Visual Studio создаст сайт на `http://localhost`, но IP-адрес не будет правильно разрешаться при просмотре или отладке сайта в интегрированной среде разработки.

Если выбран вариант удаленный сайт, диалоговое окно изменяется, чтобы можно было ввести URL-адрес назначения для нового веб-сайта. Этот URL-адрес должен находиться на сервере, на котором включены серверные расширения FrontPage. Если вы хотите работать с локальным веб-сервером с помощью серверных расширений FrontPage, можно использовать параметр удаленный сайт и указать локальный URL-адрес.

![Создание веб-сайта на удаленном сервере](improvements-in-visual-studio-2005/_static/image1.jpg)

**Рис. 3**. Создание веб-сайта на удаленном сервере

При создании приложения на удаленном сайте по протоколу SSL, если SSL-сертификат не совпадает, диалоговое окно подтверждения немного отличается от диалогового окна, отображаемого при использовании параметра local IIS.

![Оповещение безопасности удаленного сайта](improvements-in-visual-studio-2005/_static/image3.gif)

**Рис. 4**. оповещение безопасности удаленного сайта

<a id="_Toc116100243"></a>

#### <a name="ftp"></a>FTP

В Visual Studio 2005 появился параметр для создания веб-сайтов через FTP. При использовании этого параметра интегрированная среда разработки создает файлы локально в папке User Temp, а затем использует FTP для перемещения файлов в расположение FTP.

> [!NOTE]
> Папка Temp находится в папке c:/Documents and Settings/&lt;User&gt;/Local Settings/Temp/Ввдвебкаче/&lt;Server&gt;/_&lt;имя приложения&gt;

При использовании параметра FTP появится диалоговое окно Выбор расположения. Введите необходимые сведения о подключении к FTP-серверу в этом диалоговом окне, как показано ниже.

![Диалоговое окно выбора расположения для FTP](improvements-in-visual-studio-2005/_static/image2.jpg)

**Рис. 5**. диалоговое окно выбора расположения для FTP

## <a name="lab-setup-ftp-site-and-create-a-project"></a>Лаборатория: Настройка FTP-сайта и создание проекта

Следующие шаги позволяют настроить FTP-сайт таким образом, чтобы у пользователя было расположение, которое может быть отправлено только через FTP.

### <a name="install-the-ftp-service"></a>Установка службы FTP

1. Откройте окно "Установка и удаление программ" и выберите пункт "Установка компонентов Windows".
2. Выберите службы IIS (сервер приложений в Windows 2003) и нажмите кнопку **сведения**.
3. Проверьте **службу протокол FTP (FTP)** и нажмите кнопку **ОК**.
4. Нажмите кнопку **Далее** , чтобы установить службу FTP.

### <a name="create-a-new-folder-for-content"></a>Создать новую папку для содержимого

1. В проводнике Windows создайте новую папку с именем **User1** в папке c:/Inetpub/Wwwroot.

#### <a name="configure-folders-and-permissions-on-folders"></a>Настройка папок и разрешений для папок.

1. Откройте оснастку "службы IIS" в меню "Администрирование". Теперь в узле имя компьютера есть папка FTP-узлов.
2. Разверните **Узлы FTP**.
3. Щелкните правой кнопкой мыши **FTP-сайт по умолчанию**, выберите **создать**, а затем **виртуальный каталог**, а затем нажмите кнопку **Далее**.
4. Введите **Пользователь1** в качестве имени виртуального каталога и нажмите кнопку **Далее**.
5. Введите **c:/Inetpub/Wwwroot/User1** в качестве пути и нажмите кнопку **Далее**.
6. Нажмите кнопку **Далее** , а затем **Готово** , чтобы завершить работу мастера.
7. Щелкните правой кнопкой мыши виртуальный каталог **User1** в разделе FTP-сайт по умолчанию и выберите пункт **свойства**.
8. Установите флажок **запись** и нажмите кнопку **ОК** , чтобы закрыть диалоговое окно.
9. Щелкните правой кнопкой мыши **FTP-сайт по умолчанию** и выберите пункт **свойства**.
10. На вкладке **учетные записи безопасности** снимите флажок **Разрешить анонимные подключения**.
11. Нажмите кнопку **Да** в диалоговом окне с предложением продолжить.
12. Нажмите кнопку **ОК**, чтобы закрыть диалоговое окно.
13. Разверните **веб-сайт по умолчанию** в узле **веб-сайты** .
14. Щелкните правой кнопкой мыши каталог **User1** и выберите пункт **свойства** .
15. В разделе **Параметры приложения** нажмите кнопку **создать** , чтобы пометить папку как приложение.
16. Нажмите кнопку **ОК**, чтобы закрыть диалоговое окно.
17. Закройте оснастку службы IIS.

### <a name="create-web-project"></a>Создание веб-проекта

1. Откройте Visual Studio 2005.
2. В меню **файл** выберите пункт **создать веб-сайт**.
3. В раскрывающемся списке **Расположение** выберите **FTP**.
4. Нажмите кнопку **Обзор**.
5. В текстовом поле **сервер** введите **localhost** .
6. В текстовое поле Directory (каталог) введите **Пользователь1** .
7. Нажмите кнопку **Открыть**. Расположение FTP будет введено в диалоговом окне Новый веб-сайт.
8. Нажмите кнопку **ОК**.
9. Снимите флажок **Анонимный вход** в диалоговом окне Вход в FTP, введите свои учетные данные и нажмите кнопку **ОК**.
10. Что такое URL-адрес проекта? (URL-адрес проекта будет отображаться в обозреватель решений.)
11. В меню **Сборка** выберите команду **построить веб-сайт** или **построить решение**.
12. Щелкните правой кнопкой мыши Default. aspx в обозреватель решений и выберите **Просмотреть в браузере**.
13. В диалоговом окне обязательный URL-адрес сайта введите `http://localhost/user1` для URL-адреса и нажмите кнопку **ОК**.

> [!NOTE]
> Если появляется сообщение об ошибке, указывающее на невозможность загрузки типа/_Default, убедитесь, что на веб-сайте выполняется ASP.NET 2,0, а не более ранняя версия. Это можно сделать на вкладке ASP.NET в службы IIS.

## <a name="opening-web-projects"></a>Открытие веб-проектов

Открытие веб-проектов аналогично созданию проектов. В следующих разделах рассматриваются области, которые необходимо учитывать при работе в интегрированной среде разработки. Также рассматривается работа с веб-проектами с использованием HTTP и FTP.

Чтобы открыть веб-проект, выберите в меню Файл пункт Открыть веб-сайт. Появится запрос с тем же диалоговым окном Выбор расположения, которое было рассмотрено ранее, и доступны четыре варианта: файловая система, локальный сервер IIS, FTP и удаленный сайт.

<a id="_Toc116100245"></a>

## <a name="file-system"></a>Файловая система

Как указано ранее в этом модуле, Visual Studio больше не использует файл проекта. Поэтому, если вы решили открыть веб-сайт из файловой системы, на самом деле вы можете выбрать любую папку, даже если выбранная папка не была изначально создана в Visual Studio в качестве веб-проекта. Например, можно открыть папку «Мои документы» как веб-сайт, и Visual Studio будет открывать его и отображать файлы, как показано ниже.

![Мои документы, открытые в качестве веб-сайта](improvements-in-visual-studio-2005/_static/image3.jpg)

**Рис. 6**. Открытие *папки "Мои документы* " в качестве веб-сайта

Поскольку при необходимости в Visual Studio создаются только дополнительные файлы и папки, дополнительные файлы и папки не добавляются в открываемое расположение. Побочным результатом этой архитектуры является предотвращение вложенности веб-узлов в файловую систему. Например, рассмотрим следующую структуру каталогов.

Веб-проект на языке C:/MyWebSite

Другой веб-проект на C:/MyWebSite/Nested

При открытии веб-сайта по адресу c:/MyWebSite вложенная папка будет отображаться в виде вложенной папки этого приложения.

<a id="_Toc116100246"></a>

## <a name="http"></a>HTTP

При открытии веб-сайтов по протоколу HTTP параметры считываются либо из метабазы IIS (Local IIS), либо с помощью серверных расширений FrontPage (удаленный сайт). При наличии вложенных веб-приложений они отображаются также со значком, идентифицирующим их как приложение. Если вы знакомы с работой с веб-приложениями в FrontPage, поведение в Visual Studio 2005 будет аналогичным.

Хотя в Visual Studio отображается значок для приложений, вложенных в приложение, которое в данный момент открыто в интегрированной среде разработки, оно не позволит развернуть их, чтобы увидеть их содержимое. Однако можно дважды щелкнуть их, чтобы открыть. После этого появится диалоговое окно с предложением открыть веб-приложение (и заменить открытое в настоящее время решение) или добавить веб-приложение в текущее решение.

![Дважды щелкнув значок вложенного приложения, вы повлечете это диалоговое окно](improvements-in-visual-studio-2005/_static/image4.jpg)

**Рис. 7**. при двойном щелчке вложенного значка приложения отображается это диалоговое окно

<a id="_Toc116100247"></a>

## <a name="ftp-site"></a>FTP-сайт

При открытии сайта через FTP все файлы копируются локально во временную папку. Полный путь к локальному хранилищу отображается на панели свойств проекта и создается с использованием следующего формата.

C:/Documents and Settings/&lt;User&gt;/Local Settings/Temp/Ввдвебкаче/&lt;Server&gt;/_&lt;имя приложения&gt;

При использовании FTP Visual Studio необходимо указать базовый URL-адрес проекта, чтобы можно было просмотреть его, как показано ниже. Если базовый URL-адрес не указан, Visual Studio предложит его при первой попытке просмотра страницы на веб-сайте.

![Указание базового URL-адреса для FTP-сайтов](improvements-in-visual-studio-2005/_static/image5.jpg)

**Рис. 8**. Указание базового URL-адреса для FTP-узлов

## <a name="improvements-in-compilation"></a>Улучшения в компиляции

Работа с веб-приложениями в Visual Studio 2005 выполняется заметно быстрее, чем в предыдущих версиях. Это связано с незначительной частью изменений в архитектуре компиляции.

В Visual Studio 2002 и 2003 веб-приложения были скомпилированы в одну основную сборку, размещенную в папке "переключить". В Visual Studio 2005 была добавлена папка App/_Code. Классы и другие коды, не относящиеся к пользовательскому интерфейсу, добавляются в папку App/_Code. Когда Visual Studio выполняет сборку проекта, все файлы в папке App/_Code компилируются в один файл приложения или _Code. dll. Результатом этого изменения является то, что последующие сборки выполняются гораздо быстрее, чем в предыдущих версиях.

> [!NOTE]
> Служебную программу командной строки MSBuild можно также использовать для создания веб-приложений ASP.NET. Это средство будет рассмотрено в модуле 9.

Еще одним улучшением компиляции является команда создать страницу сборки в меню Сборка. Эта функция позволяет разработчику перестраивать только текущую страницу (вместе с, разумеется и зависимости), чтобы изменения могли быть скомпилированы быстрее. Поскольку C# не поддерживает фоновую компиляцию для целей обновления IntelliSense и т. д., они будут сильно выгодны из этой функции, так как это позволит быстро обновлять IntelliSense, просто перестроив одну страницу.

Свойства сборки для проекта позволяют настроить тип сборки, которая выполняется перед выполнением стартовой страницы. Разработчики могут создать только текущую страницу, чтобы Visual Studio могла быстрее начать отладку приложений после внесения изменений в код.

![Действие при запуске страницы сборки](improvements-in-visual-studio-2005/_static/image6.jpg)

**Рис. 9**. действие при запуске страницы сборки

Еще одно отличное усовершенствование Visual Studio и Архитектура ASP.NET находится в области "изменить и продолжить". В Visual Studio 2005 разработчики могут начать отладку проекта и внести изменения в код проекта без отключения отладчика. Фактически, можно начать отладку проекта, добавить новый класс, добавить код в этот класс, добавить код на страницу, который создает новый экземпляр этого класса и выполнить метод класса без отсоединения отладчика. Выполнять новый код буквально так же просто, как обновление браузера!

Щелкните здесь, чтобы просмотреть видео пошаговое руководство по функции "изменить и продолжить" в Visual Studio 2005.

![](improvements-in-visual-studio-2005/_static/image2.png)

[Открыть полноэкранное видео](improvements-in-visual-studio-2005/_static/editcontinue1.wmv)

Надежные функции "изменить и продолжить" в ASP.NET 2,0 и Visual Studio 2005 обусловлены изменением архитектуры для приложений ASP.NET. В ASP.NET 1. x приложения, созданные в Visual Studio 2002/2003, были скомпилированы в основную сборку, которая хранилась в папке "переключить". Все классы, страницы и т. д. для приложения были скомпилированы в одну библиотеку DLL. Затем во время выполнения ASP.NET будет компилировать все элементы управления, разметку и код ASP.NET на страницах и скопировать эти библиотеки DLL во временную папку ASP.NET.

В Visual Studio 2005 с использованием ASP.NET 2,0 две модели компиляции выше (одна для Visual Studio и одна для ASP.NET в среде выполнения) были объединены в одну общую модель компиляции. Это означает, что все проблемы компиляции теперь перехватываются на этапе разработки, а не во время выполнения. Он также обеспечивает поддержку конструктора и IntelliSense для таких функций, как пользовательские элементы управления и главные страницы.

Щелкните здесь, чтобы просмотреть видео пошаговое руководство по поддержке конструктора для пользовательских элементов управления.

![](improvements-in-visual-studio-2005/_static/image3.png)

[Открыть полноэкранное видео](improvements-in-visual-studio-2005/_static/usercontrols1.wmv)

> [!NOTE]
> При удалении пользовательского элемента управления со страницы директива @Register остается в разметке и должна быть удалена вручную, чтобы избежать ошибок синтаксического анализатора, если пользовательский элемент управления удален с веб-сайта.

Еще одно улучшение в модели компиляции Visual Studio — функция публикации веб-сайта. Поскольку функция публикации выполняет предварительную компиляцию веб-сайта, разработчики могут получить доступ к повышению производительности, не требуя компиляции по запросу. Он также предварительно компилирует весь исходный код в папке App/_Code в библиотеку DLL, чтобы не развертывать исходный код.

![Диалоговое окно "опубликовать веб-сайт"](improvements-in-visual-studio-2005/_static/image7.jpg)

**Рис. 10**. диалоговое окно «Публикация веб-сайта»

> [!NOTE]
> Служебную программу ASPNET/_compile. exe также можно использовать для предварительной компиляции веб-приложения ASP.NET. Это средство будет рассмотрено в модуле 9.

При публикации веб-сайта предкомпилированные файлы хранятся в папке Temporary ASP.NET Files, как показано ниже. Файлы с расширением *скомпилированных* файлов — это XML-файлы, определяющие зависимости для определенных библиотек DLL. Любые веб-формы или пользовательские элементы управления компилируются в случайные библиотеки DLL, которые начинаются с *app/_Web/_* .

Если оставить флажок *Разрешить обновление предварительно скомпилированного сайта* установленным, разметка в веб-формах и пользовательских элементах управления не будет скомпилирована в библиотеку DLL, что позволит вносить изменения после развертывания. Если вы предпочитаете заблокировать разметку таким образом, чтобы изменения в развернутом содержимом не были разрешены, снимите этот флажок.

Флажок *использовать фиксированное именование и одностраничные сборки* позволяет отключить пакетную компиляцию таким образом, чтобы каждая страница была скомпилирована в сборку с фиксированным именем. Если этот флажок снят, вы можете воспользоваться преимуществами пакетной компиляции.

Флажок *Включить строгое именование в предварительно скомпилированных сборках* позволяет использовать строгие имена для предварительно скомпилированных сборок.

> [!NOTE]
> В ASP.NET 1. x сборки со строгими именами должны быть установлены в глобальный кэш сборок (GAC). В ASP.NET 2,0 не требуется устанавливать сборки со строгими именами в глобальный кэш сборок.

![Предварительно скомпилированные файлы ASP.NET приложений](improvements-in-visual-studio-2005/_static/image8.jpg)

**Рис. 11**. предварительно скомпилированные файлы ASP.NET приложений

> [!NOTE]
> В приведенном выше приложении файл Web. config отсутствует. Если они существовали, он был бы называться *прекомпиледапп. config* после процесса публикации веб-сайта.

## <a name="improvements-in-deployment"></a>Улучшения в развертывании

Как и в Visual Studio 2002 и 2003, Visual Studio 2005 предлагает функцию копирования проекта. Однако эта функция была реализована в Visual Studio 2005 и теперь называется копированием веб-сайта.

Диалоговое окно Копировать веб-сайт разбивается на левую рамку и правый фрейм. Левый фрейм называется исходным веб-сайтом, а правый — удаленным веб-сайтом. Одна вещь, которая может запутать некоторых разработчиков, заключается в том, что сайт, отображаемый в правом фрейме, не обязательно является удаленным сайтом. Это может быть сайт в локальной файловой системе или локальный экземпляр служб IIS. Кроме того, сайт, отображаемый в левом фрейме, не обязательно является исходным веб-сайтом, так как диалоговое окно позволяет публиковать с удаленного веб-сайта *на* исходном веб-сайте.

Если вы копируете проект на удаленный веб-сайт, на этом сайте должны быть установлены серверные расширения FrontPage. В противном случае необходимо будет подключиться по протоколу FTP. С другой стороны, при копировании проекта в локальный экземпляр IIS серверные расширения FrontPage не требуются.

> [!NOTE]
> При попытке создать новый веб-сайт на локальном экземпляре IIS и установке серверных расширений FrontPage 2002 вы получите сообщение об ошибке, уведомляющее о том, что создание веб-сайтов на сервере SharePoint не поддерживается. В этом случае у вас есть возможность установить серверные расширения FrontPage 2000 или удалить серверные расширения FrontPage.

Щелкните здесь для видео пошагового руководства по функции копирования веб-сайта.

![](improvements-in-visual-studio-2005/_static/image4.png)

[Открыть полноэкранное видео](improvements-in-visual-studio-2005/_static/copysite1.wmv)

## <a name="improvements-in-debugging"></a>Улучшения в отладке

В Visual Studio 2005 есть четыре основных улучшения в отладке.

- Локальная отладка без прав администратора может быть недоступна.
- Атрибут Debug для элемента compilation теперь по умолчанию имеет значение false.
- Настройка и Настройка удаленной отладки проще, чем раньше.
- Теперь можно выполнить отладку веб-сайта, открытого через расположение FTP.

## <a name="debugging-as-a-non-administrator"></a>Отладка без прав администратора

Добавление ASP.NET Development Server позволяет пользователям без прав администратора легко отлаживать ASP.NET приложения прямо из Box. При отладке приложения ASP.NET, запущенного в локальной файловой системе, Visual Studio запускает ASP.NET Development Server в контексте вошедшего в систему пользователя. Этот пользователь может затем отлаживать это приложение без дополнительной настройки.

## <a name="debug-is-false-by-default"></a>По умолчанию debug имеет значение false

В ASP.NET 1. x атрибут *Debug* в элементе *compilation* файла Web. config был установлен по умолчанию равным *true* . Всегда было рекомендовано разработчикам присвоить этому атрибуту *значение false* перед развертыванием приложения в рабочей среде, но, поскольку большинство разработчиков не полностью понимают последствия того, что атрибут debug имеет значение true, они просто оставили его как есть.

Наиболее серьезная проблема с атрибутом Debug, установленным в значение true, заключается в том, что он отключает модель пакетной компиляции ASP. мультисети. Таким образом, каждая страница компилируется в отдельную библиотеку DLL. Если веб-приложение состоит из тысяч страниц (не воспроизводится ни одним из способов), это означает, что приложение будет создавать несколько тысяч небольших библиотек DLL. Хотя эти библиотеки DLL имеют небольшой размер, они не загружаются в определенное место в памяти. Таким образом, они приводят к фрагментации в системной памяти и могут участвовать в OutOfMemoryException экземплярах.

В ASP.NET 2,0 атрибут Debug по умолчанию имеет значение false. Как вы уже видели, когда разработчик выдает ошибку в приложении ASP.NET в Visual Studio 2005, ему предлагается добавить файл Web. config с включенной отладкой. Это влечет те же недостатки, которые присутствовали в ASP.NET 1. x, но теперь разработчику ясно выдается предупреждение о том, что перед перемещением приложения в рабочую среду этот атрибут должен быть сброшен в значение false.

## <a name="remote-debugging-setup-and-configuration"></a>Настройка и Настройка удаленной отладки

В Visual Studio 2002/2003 удаленная отладка основывалась на работе диспетчера отладки (MDM. exe) и процесса vs7jit. exe. В связи с этим устранение неполадок с удаленной отладкой часто является черным полем для клиентов, и оно часто не намного лучше для PSS.

Visual Studio 2005 устраняет зависимость от процессов MDM. exe и vs7jit. exe. Вместо этого он использует службу монитора удаленной отладки (msvsmon. exe).

Необходимость в удаленной отладке в Visual Studio 2005 довольно проста. Перед отладкой необходимо запустить msvsmon. exe на удаленном сервере. Вы можете установить монитор удаленной отладки с компакт-диска Visual Studio или просто запустить msvsmon. exe из общего ресурса, не устанавливая ничего на веб-сервере.

При запуске msvsmon. exe, скорее всего, будет выводится информация о том, что порты заблокированы для удаленной отладки. К счастью, можно легко разблокировать порты непосредственно в диалоговом окне предупреждения, как показано ниже.

![Уведомление о том, что брандмауэр Windows блокирует удаленную отладку](improvements-in-visual-studio-2005/_static/image9.jpg)

**Рис. 12**. уведомление о том, что брандмауэр Windows блокирует удаленную отладку

После разблокировки портов, необходимых для отладки, вы увидите Монитор удаленной отладки, как показано ниже. С использованием этого интерфейса можно отслеживать подключения и легко изменять разрешения на отладку.

![Монитор удаленной отладки](improvements-in-visual-studio-2005/_static/image10.jpg)

**Рис. 13**. монитор удаленной отладки

Кроме того, можно удаленно выполнять отладку веб-приложения, открытого через FTP. Эти шаги те же, что и ранее охваченные. Тем не менее необходимо указать базовый URL-адрес для обзора FTP-проекта, как описано выше в этом модуле.

## <a name="lab-2"></a>Лаборатория 2

## <a name="remote-debugging-with-visual-studio-2005"></a>Удаленная отладка с помощью Visual Studio 2005

В этом лабораторном занятии будет рассмотрена удаленная отладка с помощью Visual Studio 2005.

Щелкните здесь для видео пошагового руководства по этой лабораторной работе.

![](improvements-in-visual-studio-2005/_static/image5.png)

[Открыть полноэкранное видео](improvements-in-visual-studio-2005/_static/remdebug1.wmv)

Для работы с этим лабораторным занятием требуется два компьютера: один с Visual Studio 2005, а другой — IIS 5 или более поздней версии.

1. Откройте Visual Studio 2005 и создайте новый веб-сайт на удаленном сервере.

> [!NOTE]
> Вы можете создать веб-сайт на удаленном экземпляре IIS или через FTP.

1. На удаленном веб-сервере откройте файл msvsmon. exe на компьютере разработки, используя UNC-путь и выполните его.  
 По умолчанию для msvsmon. exe используется расположение//сервер/к $/програм Files/Microsoft Visual Studio 8/Common7/IDE/Remote Debugger/x86.
2. Если будет предложено разблокировать порты для удаленной отладки, сделайте это.
3. На компьютере разработки откройте код программной части для Default. aspx и установите точку останова в методе Page/_Load.
4. Начните отладку с компьютера разработки.

Необходимо достигнуть ожидаемой точки останова.

## <a name="aspnet-development-server"></a>Сервер ASP.NET Development Server

Как уже говорилось, Visual Studio 2005 поставляется с веб-сервером, который называется ASP.NET Development Server. (ASP.NET Development Server иногда называют Cassini.) Этот веб-сервер является удобным средством для просмотра и отладки веб-приложений, работающих в файловой системе.

ASP.NET Development Server является ограниченным веб-сервером. Он не разрешает удаленные соединения, но не разрешает запросы от любого пользователя, отличного от пользователя, запустившего веб-сервер. Он также не имеет возможности обслуживания страниц ASP. Обслуживаются только ресурсы ASP.NET и HTML (включая изображения, CSS-файлы и т. д.).

ASP.NET Development Server можно запустить с помощью командной строки, запустив файл WebDev... exe, расположенный в папке c:/Windows/Microsoft. NET/Framework/v 2.0./ */* / */* /*. В следующем диалоговом окне отображаются доступные параметры.

![](improvements-in-visual-studio-2005/_static/image11.jpg)

**Рис. 14**

> [!NOTE]
> ASP.NET Development Server не поддерживается при явном запуске с помощью командной строки.
