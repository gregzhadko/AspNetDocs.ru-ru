---
uid: web-forms/overview/moving-to-aspnet-20/data-bound-controls
title: Элементы управления с привязкой к данным | Документация Майкрософт
author: microsoft
description: Большинство приложений ASP.NET используют несколько уровень представления данных из источника данных серверной части. Элементы управления с привязкой данных были ключевую часть взаимодействующих w...
ms.author: riande
ms.date: 02/20/2005
ms.assetid: 0e23ff32-646d-43f3-8bec-6b2313d3abd6
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/data-bound-controls
msc.type: authoredcontent
ms.openlocfilehash: 016dfa2a5a5fb9aaed0e1c60194e53ac9ccb8b36
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59419591"
---
# <a name="data-bound-controls"></a>Элементы управления привязкой к данным

по [Microsoft](https://github.com/microsoft)

> Большинство приложений ASP.NET используют несколько уровень представления данных из источника данных серверной части. Элементы управления с привязкой данных были ключевую часть взаимодействия с данными в динамических веб-приложений. В ASP.NET 2.0 появились некоторые значительные улучшения для элементов управления с привязкой данных, включая новый класс BaseDataBoundControl и декларативный синтаксис.


Большинство приложений ASP.NET используют несколько уровень представления данных из источника данных серверной части. Элементы управления с привязкой данных были ключевую часть взаимодействия с данными в динамических веб-приложений. В ASP.NET 2.0 появились некоторые значительные улучшения для элементов управления с привязкой данных, включая новый класс BaseDataBoundControl и декларативный синтаксис.

BaseDataBoundControl действует как базовый класс для класса DataBoundControl и класса HierarchicalDataBoundControl. В этом модуле будут рассмотрены следующие классы, производные от DataBoundControl:

- AdRotator
- Список элементов управления
- GridView
- FormView
- DetailsView

Мы также рассмотрим следующие классы, производные от класса HierarchicalDataBoundControl:

- TreeView
- Меню
- SiteMapPath

## <a name="databoundcontrol-class"></a>Класс DataBoundControl

Класс DataBoundControl — это абстрактный класс (помеченные MustInherit в VB), используемый для взаимодействия с табличными или данных в формате списка. Следующие элементы управления являются некоторые элементы управления, которые являются производными от DataBoundControl.

## <a name="adrotator"></a>AdRotator

Элемента управления AdRotator позволяет отображать графические баннер на веб-странице, которая связана с определенного URL-адреса. Рисунок, отображаемый поворачивается с использованием свойства для элемента управления. Частота отображения конкретного ad на странице можно настроить с помощью **просмотров** свойство и рекламных объявлений можно фильтровать с помощью фильтрации по ключевым словам.

Элементы управления AdRotator используют XML-файл или таблицу в базе данных. Следующие атрибуты используются в XML-файлы для настройки элемента управления AdRotator.

### <a name="imageurl"></a>ImageUrl
URL-адрес изображения для рекламы.

### <a name="navigateurl"></a>NavigateUrl
URL-адрес, который пользователь потребуется выполнить, чтобы при щелчке рекламы. Это должно быть в кодировке URL-адрес.

### <a name="alternatetext"></a>AlternateText
Альтернативный текст, отображаемый в подсказке и чтения с экрана. Также отображается, если изображение, указанное ImageUrl не доступен.

### <a name="keyword"></a>Ключевое слово
Определяет ключевое слово, которое может использоваться при использовании фильтрации по ключевым словам. Если указано, будет отображаться только эти рекламы с помощью ключевого слова, соответствующих фильтру ключевое слово.

### <a name="impressions"></a>Просмотров
Взвешенное число, определяющее, как часто определенного ad скорее всего, проявятся. Это относительно эффекта других объявлений в тот же файл. Максимальное значение общую просмотров для всех объявлений в XML-файл является 2,048,000,000 1.

### <a name="height"></a>Высота
Высота ad в пикселях.

### <a name="width"></a>По ширине
Ширина ad в пикселях.


> [!NOTE]
> Атрибуты ширины и высоты переопределить высоту и ширину элемента управления AdRotator сам.


Стандартный файл XML может выглядеть следующим образом:

[!code-xml[Main](data-bound-controls/samples/sample1.xml)]

В приведенном выше примере ad компании Contoso дважды — как вероятнее всего, появятся в AD для веб-узла ASP.NET из-за значения для атрибута просмотров.

Отображение баннера из XML-файле выше, добавьте элемент управления AdRotator на страницу и задайте **AdvertisementFile** свойство, чтобы указать XML-файл, как показано ниже:

[!code-aspx[Main](data-bound-controls/samples/sample2.aspx)]

Если вы решили использовать таблицу базы данных в качестве источника данных для элемента управления AdRotator, необходимо сначала установить базу данных, используя следующую схему:

| **Имя столбца** | **Тип данных** | **Описание** |
| --- | --- | --- |
| ID | int | Первичный ключ. Этот столбец может иметь любое имя. |
| ImageUrl | nvarchar(*length*) | Относительный или абсолютный URL-адрес изображения для рекламы. |
| NavigateUrl | nvarchar(*length*) | Целевой URL-адрес для рекламы. Если значение не указано, ad не являющегося гиперссылкой. |
| AlternateText | nvarchar(*length*) | Текст, отображаемый, если изображение не удается найти. В некоторых браузерах текст отображается в виде всплывающей подсказки. Альтернативный текст также используется для объекта специальных возможностей, чтобы пользователи не см. рисунок можно узнать ее описание чтение вслух. |
| Ключевое слово | nvarchar(*length*) | Категория для рекламы, на котором можно фильтровать страницы. |
| Просмотров | int(4) | Число, определяющее, как часто будет отображаться реклама. Чем больше число, тем чаще реклама будет отображаться. Общее количество всех этих значений в XML-файл не может превышать 2,048,000,000-1. |
| По ширине | int(4) | Ширина изображения в пикселях. |
| Высота | int(4) | Высота изображения в пикселях. |

В случаях, где уже имеется база данных с разными схемами, можно использовать **AlternateTextField**, **ImageUrlField**, и **NavigateUrlField** свойства для сопоставления Атрибуты AdRotator к существующей базе данных. Для отображения данных из базы данных в элементе управления AdRotator, добавьте на страницу элемент управления источником данных, настроить строку подключения для элемента управления источником данных для указания базы данных и задать для элемента управления AdRotator **DataSourceID** Свойство идентификатора элемента управления источником данных. В случаях, где нет необходимости для программной настройки AdRotator рекламы использование AdCreated события. Событие AdCreated принимает два параметра; один объект и другой экземпляр AdCreatedEventArgs. AdCreatedEventArgs является ссылкой на ad, который создается.

В следующем фрагменте кода ImageUrl, NavigateUrl и AlternateText для рекламы программно задает:

[!code-csharp[Main](data-bound-controls/samples/sample3.cs)]

## <a name="list-controls"></a>Список элементов управления

Элементы управления списка включают ListBox, DropDownList, CheckBoxList, RadioButtonList и маркированный список. Все эти элементы управления могут быть данные, привязанные к источнику данных. Они использовать одно поле в источнике данных в качестве отображаемого текста и при необходимости можно использовать второе поле в качестве значения элемента. Элементы можно также добавить статически во время разработки, и можно смешивать статические элементы и динамические элементы, добавленные из источника данных.

Для данных привязать элемент управления списка, добавьте элемент управления источником данных на страницу. Укажите команды SELECT для элемента управления источником данных и задайте идентификатор элемента управления источником данных элемента управления задано свойство DataSourceID. Используйте **DataTextField** и **DataValueField используются** свойства, которые определяют отображение текста и значение для элемента управления. Кроме того, можно использовать **DataTextFormatString** свойства для управления внешним видом отображаемый текст следующим образом:

| **Выражение** | **Описание** |
| --- | --- |
| Цена: {0:C} | Для числовых и десятичных данных. Отображает литерала «Цена:» идут числа в денежном формате. Денежный формат зависит от языка и региональных параметров, указанные в атрибуте языка и региональных параметров на **страницы** директив или в файле Web.config. |
| {0:D4} | Для целочисленных данных. Нельзя использовать вместе с десятичными числами. Целые числа отображаются в поле нулями, шириной в четыре знака. |
| {0:N2}% | Для числовых данных. Отображает число с 2-десятичный разряд точности следуют литерала «%». |
| {0:000.0} | Для числовых и десятичных данных. Числа округляются до одного десятичного разряда. Числа, меньшие чем трехзначные, заполняются нулями. |
| {0:D} | Для данных даты и времени. Отображает длинный формат даты («четверг, 6 августа 1996 г»). Формат даты зависит от параметра языка и региональных параметров в файле Web.config. |
| {0:d} | Для данных даты и времени. Отображает короткий формат даты («12/31/99»). |
| {0:гг-мм-дд} | Для данных даты и времени. Отображает дату в числовом формате год месяц день (96-08-06) |

## <a name="gridview"></a>GridView

Элемент управления GridView позволяет для отображения и редактирования с использованием декларативного табличных данных и является преемником элемента управления DataGrid. Следующие функции доступны в элементе управления GridView.

- Привязка к данным управления версиями, такие как SqlDataSource.
- Встроенные функции сортировки.
- Встроенные возможности обновления и удаления.
- Встроенные возможности разбиения по страницам.
- Встроенные возможности выбора строки.
- Программный доступ к объектной модели GridView, чтобы динамически задать свойства, обрабатывать события и так далее.
- Несколько ключевых полей.
- Несколько полей данных для столбцов гиперссылок.
- Настройка внешнего вида темы и стили.

**Поля столбцов**

Каждый столбец в элементе управления GridView будет представлен объект DataControlField. По умолчанию, присваивается свойству AutoGenerateColumns **true**, который создает объект AutoGeneratedField для каждого поля в источнике данных. Каждое поле выводятся в виде столбца в элементе управления GridView в порядке, в котором они расположены в источнике данных. Можно также вручную управлять какому столбцу, поля отображаются в **GridView** управления **AutoGenerateColumns** свойства **false** и затем определения собственного Коллекция полей столбцов. Различные типы полей столбцов определить поведение столбцов в элементе управления.

В следующей таблице перечислены различные типы полей столбцов, которые могут использоваться.

| **Тип поля столбца** | **Описание** |
| --- | --- |
| BoundField | Отображает значение поля в источнике данных. Это тип столбца по умолчанию элемента управления GridView. |
| ButtonField | Отображает кнопки для каждого элемента в элементе управления GridView. Это позволяет создать столбец пользовательских кнопок, такие как добавление или кнопка "Удалить". |
| CheckBoxField | Отображает флажок для каждого элемента в элементе управления GridView. Данный тип поля столбца обычно используется для отображения поля с логическим значением. |
| CommandField | Отображает стандартные кнопки для выполнения выбора, редактирование или удаление операций. |
| HyperLinkField | Отображает значение поля в источнике данных как гиперссылку. Данный тип поля столбца позволяет привязывать второе поле URL-адрес гиперссылки. |
| ImageField | Отображает изображение для каждого элемента в элементе управления GridView. |
| TemplateField | Отображает определенное пользователем содержимое для каждого элемента в элементе управления GridView, в соответствии с указанным шаблоном. Данный тип поля столбца позволяет создавать поля пользовательского столбца. |

Чтобы определить коллекцию полей столбца декларативно, сначала добавьте открывающих и закрывающих **&lt;столбцы&gt;** теги между открывающим и закрывающим тегами данного элемента управления GridView. Затем получите список полей, которые необходимо включить между открывающим и закрывающим **&lt;столбцы&gt;** теги. Столбцы, указанные добавляются в коллекцию столбцов в указанном порядке. **Столбцы** коллекции хранятся все столбца полей в элементе управления и позволяет программно управлять полей столбцов в элементе управления GridView.

Явно заданные поля столбцов могут отображаться в сочетании с автоматически созданные поля столбцов. При использовании обоих явно заданные поля столбцов отрисовываются во-первых, следуют поля автоматически создаваемых столбцов.

## <a name="binding-to-data"></a>Привязка к данным

Элемент управления GridView можно привязать к элементу управления источником данных (таких как **SqlDataSource**, **ObjectDataSource**, и так далее), а также как любой источник данных, который реализует System.Collections.IEnumerable интерфейс (например, System.Data.DataView, System.Collections.ArrayList или System.Collections.Hashtable). Используйте один из следующих методов для привязки элемента управления GridView к соответствующему типу источника данных:

- Чтобы привязать к элементу управления источником данных, присвоено значение идентификатора элемента управления источника данных задано свойство DataSourceID элемента управления GridView. Элемент управления GridView автоматически привязывается к элементу управления источника данных и может использовать функции элемента управления для выполнения сортировки, обновление, удаление и разбиения по страницам. Это предпочтительный метод для привязки к данным.
- Для привязки к источнику данных, который реализует интерфейс System.Collections.IEnumerable программно задать свойство DataSource элемента управления GridView к источнику данных, а затем вызывается метод DataBind. При использовании этого метода, элемент управления GridView не поддерживает встроенные сортировки, обновление, удаление и разбиения по страницам. Необходимо указать эту функцию самостоятельно.

## <a name="data-operations"></a>Операции с данными

Элемент управления GridView предоставляет множество встроенных возможностей, которые позволяют пользователю сортировать, обновлять, удалять, выберите и постраничного просмотра элементов в элементе управления. При привязке элемента управления GridView к элементу управления источником данных, элемент управления GridView можно воспользоваться преимуществами источнике возможностей элемента управления и предоставить автоматическая сортировка, обновление и удаление функциональные возможности.

> [!NOTE]
> Элемент управления GridView могут обеспечить поддержку для сортировки, обновления и удаления с другими типами источников данных; Тем не менее необходимо будет предоставить подходящий обработчик событий с реализацией этих операций.


Сортировка позволяет пользователю сортировать элементы в элементе управления GridView по отношению к определенному столбцу, щелкнув заголовок столбца. Чтобы включить сортировку, присвойте свойству AllowSorting **true**.

Автоматическое обновление, удаление и выбор функциональные возможности включены в том случае, если кнопки в **ButtonField** или **TemplateField** поля столбца, в котором имя команды «Изменить», «Удалить» и «Выбрать», соответственно нажатии. Элемент управления GridView может автоматически добавлять **CommandField** поле столбца с Edit, Delete или кнопки "выбрать" Если свойство AutoGenerateEditButton, AutoGenerateDeleteButton или AutoGenerateSelectButton присвоено **true**, соответственно.

> [!NOTE]
> Вставка новых записей в источнике данных не поддерживается напрямую с помощью элемента управления GridView. Тем не менее существует возможность вставки записей с помощью элемента управления GridView в сочетании с DetailsView или элемента управления FormView.


Вместо отображения всех записей в источнике данных, в то же время, элемент управления GridView может автоматически разделить записи на страницах. Чтобы включить разбиение по страницам, присвойте свойству AllowPaging **true**.

## <a name="customizing-the-user-interface"></a>Настройка пользовательского интерфейса

Можно настроить внешний вид элемента управления GridView, задав свойства стиля для различных частей элемента управления. В следующей таблице перечислены различных свойств стиля.

| **Свойство стиля** | **Описание** |
| --- | --- |
| AlternatingRowStyle | Параметры стиля для чередующихся строк данных в элементе управления GridView. Если это свойство имеет значение, строки данных отображаются переключаясь между параметрами RowStyle и **AlternatingRowStyle** параметры. |
| EditRowStyle | Параметры стиля для редактируемой строки в элементе управления GridView. |
| EmptyDataRowStyle | Параметры стиля для пустой строки данных отображаются в элементе управления GridView, когда источник данных не содержит какие-либо записи. |
| FooterStyle | Параметры стиля строки нижнего колонтитула элемента управления GridView. |
| HeaderStyle | Параметры стиля для верхнего колонтитула элемента управления GridView. |
| PagerStyle | Параметры стиля для строки страницы элемента управления GridView. |
| RowStyle | Параметры стиля для строк данных в элементе управления GridView. Когда **AlternatingRowStyle** задается, отображаются строки данных, переключаясь между **RowStyle** параметры и **AlternatingRowStyle** параметры. |
| SelectedRowStyle | Параметры стиля для выбранной строки в элементе управления GridView. |

Кроме того, можно отобразить или скрыть различные части элемента управления. Ниже перечислены свойства, определяющие, какие части показано или скрыто.

| **Свойство** | **Описание** |
| --- | --- |
| ShowFooter | Отображение или скрытие нижнего колонтитула элемента управления GridView. |
| ShowHeader | Показывает или скрывает раздел заголовка элемента управления GridView. |

### <a name="events"></a>События

Элемент управления GridView предоставляет несколько событий, которые можно запрограммировать. Это позволяет запускать пользовательские процедуры при возникновении события. В следующей таблице перечислены события, поддерживаемые элементом управления GridView.

| **событие** | **Описание** |
| --- | --- |
| PageIndexChanged | Происходит при нажатии кнопок страничного навигатора, но после элемента управления GridView обрабатывает операции разбиения по страницам. Это событие обычно используется для выполнения задачи после перехода пользователя на другую страницу в элементе управления. |
| PageIndexChanging | Происходит при нажатии кнопок страничного навигатора, но перед GridView обработки операции разбиения по страницам элементом управления. Это событие часто используется для отмены операции разбиения по страницам. |
| RowCancelingEdit | Происходит при нажатии кнопки "Отмена" в строке, но перед элементом управления GridView выходит из режима правки. Это событие часто используется для остановки операции отмены. |
| RowCommand | Происходит при нажатии кнопки в элементе управления GridView. Это событие часто используется для выполнения задачи при нажатии кнопки в элементе управления. |
| RowCreated | Возникает при создании новой строки в элементе управления GridView. Это событие часто используется для изменения содержимого строки после ее создания. |
| RowDataBound | Происходит, когда строки данных привязан к данным в элементе управления GridView. Это событие часто используется для изменения содержимого строки после ее привязки к данным. |
| RowDeleted | Происходит при нажатии кнопки "Удалить" в строке, но после элемента управления GridView удаляет запись из источника данных. Это событие часто используется для проверки результатов операции удаления. |
| RowDeleting | Происходит при нажатии кнопки "Удалить" в строке, но перед GridView управления удаляет запись из источника данных. Это событие часто используется для отмены операции удаления. |
| RowEditing | Происходит, когда нажата кнопка "Изменить" в строке, но перед GridView элемент управления переходит в режим правки. Это событие часто используется для отмены операции редактирования. |
| RowUpdated | Происходит при нажатии кнопки "Обновить" в строке, но после элемента управления GridView обновляет строку. Это событие часто используется для проверки результатов операции обновления. |
| RowUpdating | Происходит при нажатии кнопки "Обновить" в строке, но перед GridView обновления строки элементом управления. Это событие часто используется для отмены операции обновления. |
| SelectedIndexChanged | Происходит при нажатии кнопки "выбрать" в строке, но после элемента управления GridView обработки операции выбора. Это событие часто используется для выполнения задачи после выбора строки в элементе управления. |
| SelectedIndexChanging | Происходит при нажатии кнопки "выбрать" в строке, но перед GridView обработки операции выбора элементом управления. Это событие часто используется для отмены операции выбора. |
| Сортировка | Происходит при щелчке по гиперссылке для сортировки столбца, но после элемента управления GridView обработал операцию сортировки. Это событие обычно используется для выполнения задачи, при нажатии на гиперссылку для сортировки столбца. |
| Сортировка | Происходит при щелчке по гиперссылке для сортировки столбца, но перед GridView обработки операции сортировки элементом управления. Это событие часто используется для отмены операции сортировки или выполнения настраиваемой сортировки. |

## <a name="formview"></a>FormView

Элемент управления FormView используется для отображения одной записи из источника данных. Это похоже на элементе управления DetailsView, за исключением того, он отображает пользовательские шаблоны вместо полей строк. Создание собственных шаблонов обеспечивает большую гибкость в управлении отображением данных. Элемент управления FormView поддерживает следующие функции:

- Привязка к данным элементов управления источниками, такими как SqlDataSource и ObjectDataSource.
- Встроенные возможности вставки.
- Встроенные возможности обновления и удаления.
- Встроенные возможности разбиения по страницам.
- Программный доступ к объектной модели FormView, чтобы динамически задать свойства, обрабатывать события и так далее.
- Настройка внешнего вида через определенные пользователем шаблоны, темы и стили.

## <a name="templates"></a>Шаблоны

Для элемента управления FormView для отображения содержимого необходимо создать шаблоны для различных частей элемента управления. Большинство шаблонов являются необязательными. Тем не менее необходимо создать шаблон для режима, в котором настроен элемент управления. Например элемент управления FormView, который поддерживает вставку записей должен иметь определенный шаблон элемента вставки. В следующей таблице перечислены различные шаблоны, которые можно создать.

| **Тип шаблона** | **Описание** |
| --- | --- |
| EditItemTemplate | Определяет содержимое для строки данных, когда элемент управления FormView находится в режиме редактирования. Этот шаблон обычно содержит элементы управления для ввода и кнопки команд, с помощью которого пользователь может изменять существующую запись. |
| EmptyDataTemplate | Определяет содержимое для пустой строки данных отображаются, когда элемент управления FormView привязан к источнику данных, не имеющему записей. Этот шаблон обычно содержит содержимое, чтобы предупредить пользователя о том, что источник данных не содержит какие-либо записи. |
| FooterTemplate | Определяет содержимое строки нижнего колонтитула. Этот шаблон обычно содержит дополнительное содержимое, которое вы хотите отобразить в строке нижнего колонтитула. Кроме того можно просто указать текст, отображаемый в строке нижнего колонтитула, задав свойство FooterText. |
| HeaderTemplate | Определяет содержимое строки верхнего колонтитула. Этот шаблон обычно содержит дополнительное содержимое, которое вы хотите отобразить в строке заголовка. Кроме того можно просто указать текст, отображаемый в строке заголовка, задав свойство HeaderText. |
| ItemTemplate | Определяет содержимое для строки данных, когда элемент управления FormView находится в режиме только для чтения. Этот шаблон обычно содержит содержимое для отображения значений из существующей записи. |
| InsertItemTemplate | Определяет содержимое для строки данных, когда элемент управления FormView, находится в режиме вставки. Этот шаблон обычно содержит элементы управления для ввода и кнопки команд, с помощью которого пользователь может добавлять новую запись. |
| PagerTemplate | Определяет содержимое строки страничного навигатора, отображаемый при включенном разбиении по страницам (если присвоить свойство AllowPaging **true**). Этот шаблон обычно содержит элементы управления, с которыми пользователь может перейти к другой записи. |

Элементы управления для ввода в шаблоне элемента редактирования и вставки можно привязать к поля источника данных с помощью двухсторонней привязки выражения. Это позволяет автоматически извлекать значения элемента управления вводом для обновления или операции вставки элемента управления FormView. Выражения двусторонней привязки также позволяют элементы управления для ввода в шаблоне элемента редактирования автоматически отображать исходные значения полей.

### <a name="binding-to-data"></a>Привязка к данным

Элемент управления FormView можно привязать к элементу управления источником данных (таких как **SqlDataSource**, AccessDataSource, **ObjectDataSource** и т. д), или к любому источнику данных, который реализует Интерфейс System.Collections.IEnumerable (например, System.Data.DataView System.Collections.ArrayList и System.Collections.Hashtable). Используйте один из следующих методов для привязки элемента управления FormView к соответствующему типу источника данных:

- Чтобы привязать к элементу управления источником данных, присвоено значение идентификатора элемента управления источника данных задано свойство DataSourceID элемента управления FormView. Элемент управления FormView автоматически привязывается к элементу управления источника данных и может использовать функции элемента управления для выполнения вставки, обновления, удаления и разбиения по страницам. Это предпочтительный метод для привязки к данным.
- Для привязки к источнику данных, который реализует **System.Collections.IEnumerable** интерфейс, программно задать свойство DataSource элемента управления FormView к источнику данных и затем вызывается метод DataBind. При использовании этого метода, элемент управления FormView не поддерживает встроенные возможности вставки, обновления, удаления и разбиения по страницам. Необходимо указать эту функцию с помощью соответствующего события.

## <a name="data-operations"></a>Операции с данными

Элемент управления FormView предоставляет множество встроенных возможностей, которые позволяют пользователю обновлять, удалять, вставлять и постраничного просмотра элементов в элементе управления. При привязке элемента управления FormView к элементу управления источником данных, элемент управления FormView можно воспользоваться преимуществами источнике возможностей элемента управления и обеспечивают автоматическое обновление, удаление, вставка и разбиения по страницам. Элемент управления FormView могут обеспечить поддержку для update, delete, insert и операции разбиения на страницы с другими типами источников данных; Тем не менее необходимо указать подходящий обработчик событий с реализацией этих операций.

Так как элемент управления FormView использует шаблоны, она предоставляет возможность автоматически создавать кнопки для выполнения обновления, удаления или вставки операций. Эти кнопки команд необходимо вручную включить в соответствующий шаблон. Элемент управления FormView распознает определенные кнопки, которые имеют свои **CommandName** присвоены определенные значения свойства. В следующей таблице перечислены кнопки команд, который распознается элементом управления FormView.

| **Кнопка** | **Значение CommandName** | **Описание** |
| --- | --- | --- |
| Отмена | «Отмена» | Используется в операциях обновления или вставки для отмены операции и отменить значений, введенных пользователем. Элемент управления FormView Возвращает режим, указанный в свойстве DefaultMode. |
| Оператор delete | "Удалить" | Используется в операциях удаления для удаления записи из источника данных. Вызывает события ItemDeleting и ItemDeleted. |
| Правка | «Edit» | Используется в операциях обновления для размещения этого элемента управления FormView в режиме редактирования. Содержимого, заданного в **EditItemTemplate** свойство отображается для строки данных. |
| Insert | «Вставить» | Используется в операциях вставки для попытки вставить новую запись в источнике данных, используя значения, заданные пользователем. Вызывает события ItemInserting и ItemInserted. |
| Оператор new | «New» | Используется в операциях вставки для размещения этого элемента управления FormView в режиме вставки. Содержимого, заданного в **InsertItemTemplate** свойство отображается для строки данных. |
| Страница | «Страница» | Используется в операции разбиения на страницы для представления кнопки в страничного навигатора, которая выполняет разбиение по страницам. Операции разбиения по страницам, установите **CommandArgument** кнопки «Далее», «Назад», "First", «Последнее» или индекс страницы для перехода. Вызывает события PageIndexChanging и PageIndexChanged. |
| Обновление | «Обновление» | Используется в операциях обновления для обновления текущей записи в источнике данных значениями, предоставленными пользователем. Вызывает события ItemUpdating и ItemUpdated. |

В отличие от удаления кнопку (которая удаляет отображаемой записи немедленно), при нажатии кнопок редактирования и создания FormView, элемент управления переходит в редактирования или вставки в режиме вставки соответственно. В режиме редактирования, содержимое включало в **EditItemTemplate** свойство отображается для текущего элемента данных. Как правило таким образом, "Изменить" заменяется на обновление и кнопки "Отмена", определяется шаблоном элемента. Элементы управления вводом, которые подходят для типа данных поля (например, текстовое поле или элемент управления CheckBox) также обычно отображаются со значением поля для пользователя для изменения. Обновляет запись в источнике данных, щелкнув кнопкой "Обновить", хотя нажатие кнопки "Отмена" отменяет все изменения.

Аналогичным образом, содержимое, находящееся в **InsertItemTemplate** свойство отображается для элемента данных, когда элемент управления находится в режиме вставки. Шаблон элемента вставки обычно определяется таким образом, "Создать" заменяется на "Вставить" и "Отмена", и элементы управления вводом отображаются для пользователя ввести значения для новой записи. Кнопки "Вставить" вставляет запись в источнике данных, хотя нажатие кнопки "Отмена" отменяет все изменения.

Элемент управления FormView предоставляет функцию разбиения по страницам, что позволяет пользователю переходить к другим записям в источнике данных. Если этот параметр включен, строку страничного навигатора отображается в элементе управления FormView, который содержит элементы управления навигацией. Чтобы включить разбиение на страницы, задайте **AllowPaging** свойства **true**. Можно настроить строку страничного навигатора, задав свойства объектов, содержащихся в PagerStyle и свойство PagerSettings. Вместо использования встроенных строки пользовательского интерфейса, можно создать собственный пользовательский Интерфейс, с помощью **PagerTemplate** свойство.

## <a name="customizing-the-user-interface"></a>Настройка пользовательского интерфейса

Можно настроить внешний вид элемента управления FormView, задав свойства стиля для различных частей элемента управления. В следующей таблице перечислены различных свойств стиля.

| **Свойство стиля** | **Описание** |
| --- | --- |
| EditRowStyle | Параметры стиля для строки данных, когда элемент управления FormView находится в режиме редактирования. |
| EmptyDataRowStyle | Параметры стиля для пустой строки данных отображаются в элементе управления FormView, когда источник данных не содержит какие-либо записи. |
| FooterStyle | Параметры стиля строки нижнего колонтитула элемента управления FormView. |
| HeaderStyle | Параметры стиля для верхнего колонтитула элемента управления FormView. |
| InsertRowStyle | Параметры стиля для строки данных, когда элемент управления FormView находится в режиме вставки. |
| PagerStyle | Параметры стиля строки страничного навигатора, отображаемый в элементе управления FormView при включенном разбиении по страницам. |
| RowStyle | Параметры стиля для строки данных, когда элемент управления FormView находится в режиме только для чтения. |

## <a name="events"></a>События

Элемент управления FormView предоставляет несколько событий, которые можно запрограммировать. Это позволяет запускать пользовательские процедуры при возникновении события. В следующей таблице перечислены события, поддерживаемые элементом управления FormView.

| **событие** | **Описание** |
| --- | --- |
| ItemCommand | Происходит при нажатии кнопки в элементе управления FormView. Это событие часто используется для выполнения задачи при нажатии кнопки в элементе управления. |
| ItemCreated | Происходит после создания всех объектов FormViewRow в элементе управления FormView. Это событие часто используется для изменения значения записи, перед его отображением. |
| ItemDeleted | Происходит, когда кнопку «Удалить» (кнопка с его **CommandName** , имеющим значение «Удалить») выбран, но после элемента управления FormView удаляет запись из источника данных. Это событие часто используется для проверки результатов операции удаления. |
| ItemDeleting | Происходит при нажатии кнопки Delete, но перед FormView управления удаляет запись из источника данных. Это событие часто используется для отмены операции удаления. |
| ItemInserted | Происходит, когда кнопки вставки (кнопка с его **CommandName** свойство, значение «Insert») выбран, но после элемента управления FormView вставляет запись. Это событие часто используется для проверки результатов операции вставки. |
| ItemInserting | Происходит при нажатии кнопки "Вставить", но перед FormView управления вставляет запись. Это событие часто используется для отмены операции вставки. |
| ItemUpdated | Происходит, когда кнопка обновления (кнопка с его **CommandName** , имеющим значение «Update») выбран, но после элемента управления FormView обновляет строку. Это событие часто используется для проверки результатов операции обновления. |
| ItemUpdating | Происходит при нажатии кнопки "Обновить", но перед FormView управления обновляет запись. Это событие часто используется для отмены операции обновления. |
| ModeChanged | Происходит после элемента управления FormView изменения режимов (для редактирования, вставки или режим только для чтения). Это событие часто используется для выполнения задачи, изменении режимов управления FormView. |
| ModeChanging | Происходит перед изменением режима элемента управления FormView (для редактирования, вставки или режим только для чтения). Это событие часто используется для отмены изменения режима. |
| PageIndexChanged | Происходит при нажатии кнопок страничного навигатора, но после элемента управления FormView обрабатывает операции разбиения по страницам. Это событие обычно используется для выполнения задачи после пользователь переходит на другую запись в элементе управления. |
| PageIndexChanging | Происходит при нажатии кнопок страничного навигатора, но перед FormView обработки операции разбиения по страницам элементом управления. Это событие часто используется для отмены операции разбиения по страницам. |

## <a name="detailsview"></a>DetailsView

Элемент управления DetailsView, используемый для отображения одной записи из источника данных в таблице, где каждое поле записи отображается в строке таблицы. Его можно использовать в сочетании с элементом управления GridView для сценариев «основной-подробности». Элемент управления DetailsView поддерживает следующие функции:

- Привязка к данным управления версиями, такие как SqlDataSource.
- Встроенные возможности вставки.
- Встроенные возможности обновления и удаления.
- Встроенные возможности разбиения по страницам.
- Программный доступ к модели объектов DetailsView, чтобы динамически задать свойства, обрабатывать события и так далее.
- Настройка внешнего вида темы и стили.

## <a name="row-fields"></a>Поля строк

Каждая строка данных в элементе управления DetailsView создается путем объявления в поле элемента управления. Типы полей в другой строке определяют поведение строк в элементе управления. Элементы управления полями, являются производными от DataControlField. Ниже перечислены типы полей разных строк, которые могут использоваться.

| **Тип поля столбца** | **Описание** |
| --- | --- |
| BoundField | Отображает значение поля в источнике данных в виде текста. |
| ButtonField | Отображает кнопки в элементе управления DetailsView. Это позволяет отобразить строку с настраиваемой кнопки элемента управления, например Add или Remove кнопки. |
| CheckBoxField | Отображает типа "флажок" в элементе управления DetailsView. Данный тип поля строки обычно используется для отображения поля с логическим значением. |
| CommandField | Встроенная команда отображает кнопки для выполнения редактирования, вставки или удаления операции в элементе управления DetailsView. |
| HyperLinkField | Отображает значение поля в источнике данных как гиперссылку. Данный тип поля строки позволяет привязывать второе поле URL-адрес гиперссылки. |
| ImageField | Отображает изображение в элементе управления DetailsView. |
| TemplateField | Отображает определенное пользователем содержимое для строки в элементе управления DetailsView в соответствии с указанным шаблоном. Данный тип поля строки позволяет создать настраиваемое поле строки. |

По умолчанию, присваивается свойству AutoGenerateRows **true**, который автоматически создает строки с привязкой к объекту поля для каждого поля, типа привязки в источнике данных. Допустимые типы привязки: строка, DateTime, Decimal, Guid и набор типов-примитивов. Каждое поле отображается в строке как текст, в том порядке, в котором отображается каждое поле в источнике данных.

Автоматическое генерирование строк предоставляет быстрый и простой способ отображения каждого поля в записи. Тем не менее чтобы использовать DetailsView элемента управления расширенных возможностей, необходимо явно объявить поля строк для включения в элементе управления DetailsView. Чтобы объявить полей строк, сначала установите **AutoGenerateRows** свойства **false**. Затем добавьте открывающих и закрывающих **&lt;поля&gt;** теги между открывающим и закрывающим тегами данного элемента управления DetailsView. Наконец, список полей строк, которые необходимо включить между открывающим и закрывающим **&lt;поля&gt;** теги. Поля строки, указанные добавляются к коллекции полей в указанном порядке. **Поля** коллекции позволяет программно управлять поля строк в элементе управления DetailsView.

> [!NOTE]
> Автоматически созданные поля не добавляются в коллекцию полей строки.


## <a name="binding-to-data"></a>Привязка к данным

Элемент управления DetailsView можно привязать к элементу управления источником данных, таких как **SqlDataSource** или AccessDataSource, или к любому источнику данных, который реализует интерфейс "System.Collections.IEnumerable", например System.Data.DataView, System.Collections.ArrayList и System.Collections.Hashtable.

Используйте один из следующих методов для привязки элемента управления DetailsView к соответствующему типу источника данных:

- Чтобы привязать к элементу управления источником данных, присвоено значение идентификатора элемента управления источника данных задано свойство DataSourceID элемента управления DetailsView. Элемент управления DetailsView автоматически привязывается к элементу управления источника данных. Это предпочтительный метод для привязки к данным.
- Для привязки к источнику данных, который реализует **System.Collections.IEnumerable** интерфейс, программно задать свойство DataSource элемента управления DetailsView для источника данных и затем вызывается метод DataBind.

## <a name="security"></a>Безопасность

Этот элемент управления можно использовать для отображения введенных данных, в которых может содержаться вредоносный клиентский сценарий. Проверьте все сведения, отправляется от клиента исполняемый сценарий, инструкции SQL или другой код, прежде чем отображать их в приложении. ASP.NET предоставляет функцию проверки ввода запроса в блок скрипта и HTML во входных данных пользователя.

## <a name="data-operations"></a>Операции с данными

Элемент управления DetailsView предоставляет встроенные возможности, позволяющие пользователям обновлять, удалять, вставлять и постраничного просмотра элементов в элементе управления. Когда элемент управления DetailsView привязан к элементу управления источником данных, элемент управления DetailsView можно воспользоваться преимуществами источнике возможностей элемента управления и обеспечивают автоматическое обновление, удаление, вставка и разбиения по страницам.

Элемент управления DetailsView могут обеспечить поддержку для update, delete, insert и операции разбиения на страницы с другими типами источников данных; Тем не менее необходимо предоставить реализацию для выполнения этих операций в соответствующем обработчике событий.

Может автоматически добавлять элемент управления DetailsView **CommandField** поле строки с помощью кнопки изменять, удалять и создать, задав свойства AutoGenerateEditButton, AutoGenerateDeleteButton или AutoGenerateInsertButton **true**, соответственно. В отличие от удаления кнопку (которая удаляет выбранную запись немедленно), при нажатии кнопок редактирования и создания DetailsView, элемент управления переходит в редактирования или вставки в режиме вставки, соответственно. В режиме редактирования "Изменить" заменяется обновления и кнопки "Отмена". Элементы управления вводом, которые подходят для типа данных поля (например, текстовое поле или элемент управления CheckBox) отображаются значения поля для пользователя для изменения. Обновляет запись в источнике данных, щелкнув кнопкой "Обновить", хотя нажатие кнопки "Отмена" отменяет все изменения. Аналогичным образом в режиме вставки "Создать" будет заменена "Вставить" и "Отмена", и элементы управления вводом отображаются для пользователя ввести значения для новой записи.

Элемент управления DetailsView обеспечивает возможность разбиения по страницам, что позволяет пользователю переходить к другим записям в источнике данных. Если этот параметр включен, в строку страничного навигатора отображаются элементы управления навигацией. Чтобы включить разбиение по страницам, присвойте свойству AllowPaging **true**. Можно настроить строку страничного навигатора, используя свойства PagerStyle и PagerSettings.

## <a name="customizing-the-user-interface"></a>Настройка пользовательского интерфейса

Можно настроить внешний вид элемента управления DetailsView, задав свойства стиля для различных частей элемента управления. В следующей таблице перечислены различных свойств стиля.

| **Свойство стиля** | **Описание** |
| --- | --- |
| AlternatingRowStyle | Параметры стиля для чередующихся строк данных в элементе управления DetailsView. Если это свойство имеет значение, строки данных отображаются переключаясь между параметрами RowStyle и **AlternatingRowStyle** параметры. |
| CommandRowStyle | Параметры стиля для строки, содержащей встроенные кнопки в элементе управления DetailsView. |
| EditRowStyle | Параметры стиля для строк данных, когда элемент управления DetailsView находится в режиме редактирования. |
| EmptyDataRowStyle | Параметры стиля для пустой строки данных отображаются в элементе управления DetailsView, когда источник данных не содержит какие-либо записи. |
| FooterStyle | Параметры стиля строки нижнего колонтитула элемента управления DetailsView. |
| HeaderStyle | Параметры стиля для верхнего колонтитула элемента управления DetailsView. |
| InsertRowStyle | Параметры стиля для строк данных, когда элемент управления DetailsView находится в режиме вставки. |
| PagerStyle | Параметры стиля для строки страницы элемента управления DetailsView. |
| RowStyle | Параметры стиля для строк данных в элементе управления DetailsView. Когда **AlternatingRowStyle** задается, отображаются строки данных, переключаясь между **RowStyle** параметры и **AlternatingRowStyle** параметры. |
| FieldHeaderStyle | Параметры стиля для столбца верхнего колонтитула элемента управления DetailsView. |

## <a name="events"></a>События

Элемент управления DetailsView обеспечивает несколько событий, которые можно запрограммировать. Это позволяет запускать пользовательские процедуры при возникновении события. В следующей таблице перечислены события, поддерживаемые элементом управления DetailsView. Элемент управления DetailsView также наследует эти события из его базовых классов: Привязка данных, с привязкой к данным, удален, Init, Load, PreRender и визуализации.

| **событие** | **Описание** |
| --- | --- |
| ItemCommand | Происходит при нажатии кнопки в элементе управления DetailsView. |
| ItemCreated | Происходит после создания всех объектов DetailsViewRow в элементе управления DetailsView. Это событие часто используется для изменения значения записи, перед его отображением. |
| ItemDeleted | Происходит при нажатии кнопки "Удалить", но после элемента управления DetailsView удаляет запись из источника данных. Это событие часто используется для проверки результатов операции удаления. |
| ItemDeleting | Происходит при нажатии кнопки Delete, но перед DetailsView управления удаляет запись из источника данных. Это событие часто используется для отмены операции удаления. |
| ItemInserted | Происходит при нажатии кнопки "Вставить", но после элемента управления DetailsView вставляет запись. Это событие часто используется для проверки результатов операции вставки. |
| ItemInserting | Происходит при нажатии кнопки "Вставить", но перед DetailsView управления вставляет запись. Это событие часто используется для отмены операции вставки. |
| ItemUpdated | Происходит при нажатии кнопки "Обновить", но после элемента управления DetailsView обновляет строку. Это событие часто используется для проверки результатов операции обновления. |
| ItemUpdating | Происходит при нажатии кнопки "Обновить", но перед DetailsView управления обновляет запись. Это событие часто используется для отмены операции обновления. |
| ModeChanged | Происходит, когда элемент управления DetailsView изменит режимов (редактирования, вставки или режим только для чтения). Это событие часто используется для выполнения задачи, изменении режимов управления DetailsView. |
| ModeChanging | Происходит перед изменением режимов (редактирования, вставки или режим только для чтения) в элементе управления DetailsView. Это событие часто используется для отмены изменения режима. |
| PageIndexChanged | Происходит при нажатии кнопок страничного навигатора, но после элемента управления DetailsView обрабатывает операции разбиения по страницам. Это событие обычно используется для выполнения задачи после пользователь переходит на другую запись в элементе управления. |
| PageIndexChanging | Происходит при нажатии кнопок страничного навигатора, но перед DetailsView обработки операции разбиения по страницам элементом управления. Это событие часто используется для отмены операции разбиения по страницам. |

## <a name="the-menu-control"></a>Элемент управления Menu

Элемент управления Menu в ASP.NET 2.0 должна быть полнофункциональный навигационные системы. Это может быть с привязкой к данным, легко к источникам иерархических данных, таких как SiteMapDataSource.

Структуры элементов управления меню можно определить декларативно или динамически он включает один корневой узел и любое количество вложенных узлов. Следующий код декларативно определяет меню для элемента управления меню.

[!code-aspx[Main](data-bound-controls/samples/sample4.aspx)]

В приведенном выше примере Home.aspx узел является корневым узлом. Все остальные узлы вкладываются в корневой узел на различных уровнях.

Существует два типа меню, которые могут отображаться в элементе управления меню; статические и динамические меню. Статические меню состоят из меню, которые отображаются всегда. Динамические меню состоят из пунктов меню, которые видны только при наведении на них с помощью мыши. Клиенты могут часто путают статического меню с меню, декларативно определенных и динамических меню с меню, которые являются привязкой к данным во время выполнения. На самом деле динамических и статических меню не связаны с метод заполнения. Условия *статический* и *динамическое* касается только ли меню статически отображаться по умолчанию или только отображаемое, когда пользователь выполняет некоторое действие.

**StaticDisplayLevels** свойство используется для настройки того, какое количество уровней меню статические и поэтому отображается по умолчанию. В приведенном выше примере, установка **StaticDisplayLevels** свойства со значением 2 приведет к меню для статически отображения начальный узел, узел музыки и фильмов узла. Все остальные узлы динамически отображалось при наведении указателя мыши на родительский узел.

**MaximumDynamicDisplayLevels** свойство можно настроить максимальное число динамических уровней может отображать меню. Все динамические меню на уровень выше значения, указанного в **MaximumDynamicDisplayLevels** свойство отбрасываются.

> [!NOTE]
> Это некоторые из них, которые могут возникнуть ситуации, где меню не отображаются для подготовки к просмотру из-за свойства MaximumDynamicDisplayLevels. В этом случае убедитесь, что свойство достаточно для отображения меню клиентов.


## <a name="data-binding-the-menu-control"></a>Привязка элемента управления меню данных

Элемент управления Menu можно привязать к любому источнику иерархических данных, например SiteMapDataSource или XMLDataSource. SiteMapDataSource является наиболее часто используемые метод для привязки данных к элементу управления меню, так как веб-каналы из файла Web.sitemap и его схемы предоставляет известных API-Интерфейс для элемента управления меню. Ниже показан простой файл Web.sitemap.

[!code-xml[Main](data-bound-controls/samples/sample5.xml)]

Обратите внимание, что только один корневой элемент siteMapNode, таким образом, элемент «Home». Несколько атрибутов можно настроить для каждого siteMapNode. Ниже приведены наиболее часто используемые атрибуты.

- **URL-адрес** указывает URL-адрес, отображаемый, когда пользователь выбирает пункт меню. Если этот атрибут отсутствует, узел просто будет учитывать обратно при щелчке.
- **Заголовок** текст, который отображается в элементе меню.
- **Описание** используется в качестве документации для узла. Также отображает в виде всплывающей подсказки при наведении курсора мыши над узлом.
- **siteMapFile** позволяет для создания вложенных карт. Этот атрибут должен указывать на правильный формат файла карты веб-узла ASP.NET.
- **роли** позволяет внешний вид узла для контролируется фильтрация по ролям безопасности ASP.NET.

Обратите внимание, что хотя эти атрибуты являются необязательными, поведение меню может не иметь ожидаемого, если они не указаны. Например если *URL-адрес* атрибут указан, но *описание* атрибут не, этот узел не будет видимым и будет существовать не способ перехода к URL-адрес.

## <a name="controlling-a-menus-operation"></a>Управление операцию меню

Существует несколько свойств, которые влияют на работу элемента управления меню ASP.NET; **ориентации** свойство, **DisappearAfter** свойство, **StaticItemFormatString** свойство и **StaticPopoutImageUrl**свойство представлены лишь некоторые из них.

- **Ориентации** можно задать либо *горизонтальной* или *вертикальной* и управляет ли пунктов статического меню горизонтально в строке или по вертикали и с накоплением после друг с другом. Это свойство не влияет на динамические меню.
- **DisappearAfter** настраивает свойство сколько динамического меню всегда отображать после мыши смещены от его. Значение указывается в миллисекундах и значение по умолчанию — 500. Этому свойству присвоить значение -1 будет открывал меню на никогда не исчезают автоматически. В этом случае меню, исчезнет только в том случае, когда пользователь щелкает вне меню.
- **StaticItemFormatString** свойство позволяет легко поддерживать согласованное формулировки в системе меню. При указании этого свойства *{0}* следует ввести вместо описания, которое появляется в источнике данных. Например, чтобы получить элемент меню из say Упражнение 1 посетите наш страница "Продукты", т. д., следует указать посещение наших {0} страницы для StaticItemFormatString. Во время выполнения ASP.NET заменит все вхождения {0} с описанием правильный для пункта меню.
- **StaticPopoutImageUrl** свойство определяет образ, который используется для указания, что данное меню узел имеет дочерние узлы, которые доступны при наведении на него. Динамические меню будет продолжать использовать образ по умолчанию.

## <a name="templated-menu-controls"></a>Элементы управления шаблонного меню

Элемент управления Menu шаблонного элемента управления и обеспечивает два различных элементов; StaticItemTemplate и DynamicItemTemplate. С помощью этих шаблонов, можно легко добавить серверные элементы управления или пользовательских элементов управления для меню.

Для редактирования шаблонов в Visual Studio .NET, нажмите кнопку смарт-тега в меню и либо изменить шаблоны. Затем можно выбрать редактирования StaticItemTemplate или DynamicItemTemplate.

Любые элементы управления, добавляемые StaticItemTemplate будет отображаться в статическом меню, при загрузке страницы. Все элементы управления, добавляемые DynamicItemTemplate будут отображаться все всплывающее меню.

## <a name="menu-events"></a>События меню

Элемент управления меню имеет два события, которые являются уникальными **MenuItemClicked** и **MenuItemDatabound** событий.

Событие MenuItemClicked возникает в том случае, при выборе пункта меню. Событие MenuItemDatabound возникает в том случае, если элемент меню с привязкой к данным. **MenuEventArgs** , передаваемый событию обработчик предоставляет доступ к пункту меню с помощью свойства элемента.

## <a name="controlling-a-menus-appearance"></a>Управление внешним видом меню

Можно также изменять внешний вид элемента управления меню, используя один или несколько из многих стили, доступные в меню Формат. Среди них — **StaticMenuStyle**, **DynamicMenuStyle**, **DynamicMenuItemStyle**, **DynamicSelectedStyle**и **DynamicHoverStyle**. Эти свойства настраиваются с помощью стандартной строки стиля HTML. Например ниже повлияет на стиль динамического меню.

[!code-aspx[Main](data-bound-controls/samples/sample6.aspx)]

> [!NOTE]
> Если вы используете любой стиль при наведении указателя мыши, необходимо добавить &lt;head&gt; элемент на страницу с *runat* элемента задано значение *сервера*.


Элементы управления меню также поддерживают использование тем в ASP.NET 2.0.

## <a name="the-treeview-control"></a>Элемент управления TreeView

Элемент управления TreeView отображает данные в виде древовидной структуры. Как и в случае с элементом управления меню, ее можно легко данные, привязанные к любому источнику иерархических данных, таких как SiteMapDataSource.

Первый вопрос, заказчики, скорее всего запросить об элементе управления TreeView в ASP.NET 2.0 является ли она связана с WebControl IE TreeView, которая была доступна для ASP.NET 1.x. Нет. Элемент управления ASP.NET 2.0 TreeView был записан с нуля и обеспечивает значительное улучшение по сравнению WebControl IE TreeView, которые были доступны ранее.

Я не буду подробно о том, как привязать элемент управления TreeView к карте узла, так как он выполняется точно так же, как элемент управления Menu. Тем не менее элемент управления TreeView есть некоторые определенные отличия в то, что он работает.

По умолчанию элемент управления TreeView отображается полностью развернутой. Чтобы изменить уровень расширения после начальной загрузки, измените **ExpandDepth** свойство элемента управления. Это особенно важно в случаях, когда TreeView привязкой к данным, после развертывание определенными узлами.

## <a name="databinding-the-treeview-control"></a>Привязка данных элемента управления TreeView

В отличие от элемент управления Menu TreeView хорошо подходит для обработки больших объемов данных. Поэтому Помимо привязки данных к XMLDataSource или SiteMapDataSource TreeView часто является данными, привязанными к набора данных или других реляционных данных. В случаях, где элемент управления TreeView привязан к большим объемам данных рекомендуется привязать только к данным, который фактически отображается в элементе управления. Затем можно привязать к дополнительным данным как узлы в TreeView развертываются.

В этих случаях **свойству PopulateOnDemand** должно быть присвоено свойству элемента управления TreeView *true*. Затем необходимо предоставить реализацию **TreeNodePopulate** метод.

## <a name="data-binding-without-postback"></a>Привязка без обратной передачи данных

Обратите внимание на то, что при первом развертывании узла в предыдущем примере, страница инициирующий обратную передачу и обновляет. Thats не проблема в этом примере, но вы можете себе представить, возможно, в рабочей среде с большим объемом данных. Сценарий лучше бы один, TreeView будет по-прежнему динамически заполнить его узлы, но без отправки обратно на сервер.

Установив **PopulateNodesFromClient** и **свойству PopulateOnDemand** свойства значение true, элемент управления ASP.NET TreeView динамически заполнит узлов без обратной передачи. При развертывании родительский узел XMLHttp запрос от клиента, и событие OnTreeNodePopulate. Сервер отправляет остров данных XML, который затем используется для данных привязать дочерние узлы.

ASP.NET динамически создает код клиента, который реализует эту функцию. &lt;Скрипт&gt; тегов, которые содержат сценарий создаются указывает на файл AXD. Например ниже показан сценарий ссылки, чтобы получить код сценария, который создает запрос XMLHttp.

[!code-html[Main](data-bound-controls/samples/sample7.html)]

Если при просмотре файла AXD выше в браузере откройте его, вы увидите код, который реализует запрос XMLHttp. Этот метод предотвращает изменение файла скрипта для клиентов.

## <a name="controlling-the-operation-of-the-treeview-control"></a>Управление работой элемента управления TreeView

Элемент управления TreeView имеет несколько свойств, которые влияют на работу элемента управления. Наиболее очевидная свойства являются **ShowCheckBoxes**, **ShowExpandCollapse**, и **ShowLines**.

**ShowCheckBoxes** свойство влияет ли узлы отображения типа "флажок" при подготовке к просмотру. Допустимые значения для этого свойства: **None**, **корневой**, **родительского**, **конечного**, и **все**. Элемент управления TreeView влияют следующим образом:

| **Значение свойства** | **Действие** |
| --- | --- |
| Нет | Флажки не отображаются ни на одном узле. Этот параметр используется по умолчанию. |
| Корневой | Флажок отображается только в корневом узле. |
| Родительский | Флажок отображается только на те узлы, которые могут иметь дочерних узлов. Эти дочерние узлы можно родительские узлы или листовых узлов. |
| Конечный | Флажок отображается только на те узлы, которые не имеют дочерних узлов. |
| Все | Флажок отображается на всех узлах. |

При использовании флажки **CheckedNodes** свойство будет возвращать коллекцию узлов TreeView, которые проверяются после обратной передачи.

**ShowExpandCollapse** свойство определяет внешний вид изображение развернуть или свернуть рядом с теми узлами корневой и родительский. Если это свойство имеет значение **false**, узлы элемента управления TreeView, преобразуются в гиперссылки и развернуть/свернуть, щелкнув ссылку.

**ShowLines** свойство управляет ли линии отображаются соединяющие узлы родительского на дочерние узлы. Когда **false** (по умолчанию), строки не отображаются. Когда **true**, элемента управления TreeView будет использовать строки изображения в папке, заданной параметром **LineImagesFolder** свойство.

Чтобы настроить внешний вид линий TreeView, Visual Studio .NET 2005 включает средство строки конструктора. Чтобы открыть это средство, с помощью кнопки смарт-тега элемента управления TreeView ниже.


![](data-bound-controls/_static/image1.jpg)

**Рис. 1**


Если флажок **настроить изображения линий** пункт меню будет запущено средство строки конструктора позволяет настроить внешний вид линий TreeView.

## <a name="treeview-events"></a>События TreeView

Элемент управления TreeView имеет уникальный следующие события:

- SelectedNodeChanged происходит при выборе узла в зависимости от **SelectAction** свойство.
- TreeNodeCheckChanged происходит при изменении состояния checkboxs узлов.
- TreeNodeExpanded возникает при разворачивании узла в зависимости от **SelectAction** свойство.
- TreeNodeCollapsed происходит при сворачивании узла.
- Граница TreeNodeDataBound происходит, когда узел данных.
- TreeNodePopulate происходит, когда узел будет заполнено.

**SelectAction** свойство можно настроить, какие события при выборе узла. Свойство SelectAction предоставляет следующие действия:

- TreeNodeSelectAction.Expand вызывает TreeNodeExpanded при выборе узла.
- TreeNodeSelectAction.None событие не при выборе узла.
- TreeNodeSelectAction.Select событие SelectedNodeChanged при выборе узла.
- TreeNodeSelectAction.SelectExpand вызывает SelectedNodeChanged события и события TreeNodeExpanded при выборе узла.

## <a name="controlling-appearance-with-styles"></a>Управление внешним видом с использованием стилей

Элемент управления TreeView предоставляет множество свойств для Управление внешним видом элемента управления с использованием стилей. Доступны следующие свойства.

| **Имя свойства** | **Элементы управления** |
| --- | --- |
| HoverNodeStyle | Определяет стиль узлов при наведении курсора мыши над ними. |
| LeafNodeStyle | Определяет стиль конечных узлов. |
| NodeStyle | Определяет стиль для всех узлов. Стили конкретного узла (например, LeafNodeStyle) переопределить этот стиль. |
| ParentNodeStyle | Определяет стиль для всех родительских узлов. |
| RootNodeStyle | Определяет стиль для корневого узла. |
| SelectedNodeStyle | Определяет стиль для выбранного узла. |

Каждое из этих свойств только для чтения. Тем не менее, они будут каждой точкой возврата **TreeNodeStyle** объектов и свойств этого объекта можно изменить с помощью *подчиненное свойство* формат. Например, чтобы задать **ForeColor** свойство **SelectedNodeStyle**, используется следующий синтаксис:

[!code-aspx[Main](data-bound-controls/samples/sample8.aspx)]

Обратите внимание на то, что выше тег не закрыт. Том, что при использовании декларативный синтаксис, показанный здесь, следует включить в HTML-код, а также узлов элементов TreeView.

Свойства стиля можно также указать в коде с помощью *property.subproperty* формат. Например, чтобы задать **ForeColor** свойство **RootNodeStyle** в коде используется следующий синтаксис:

[!code-csharp[Main](data-bound-controls/samples/sample9.cs)]

> [!NOTE]
> Полный список различных свойств стиля см. в документации MSDN в объекте TreeNodeStyle.


## <a name="the-sitemappath-control"></a>Элемент управления SiteMapPath

Элемент управления SiteMapPath предоставляет интерфейс хлеб иерархической навигации для разработчиков ASP.NET. Как и других элементов управления навигацией на его можно легко данными, связанным с иерархическими данными источников, таких как XmlDataSource или SiteMapDataSource.

Элемент управления SiteMapPath состоит из объектов SiteMapNodeItem. Существует три типа узлов; Корневой узел, родительские узлы и текущего узла. Корневым узлом является узел, в верхней части иерархической структуры. Текущий узел, представляющий текущую страницу. Все другие узлы находятся в родительских узлов.

## <a name="controlling-the-operation-of-the-sitemappath-control"></a>Управление работой элемента управления SiteMapPath

Ниже приведены свойства, которые управляют работой элемента управления SiteMapPath инфраструктуры.

| **Свойство** | **Описание свойства** |
| --- | --- |
| ParentLevelsDisplayed | Определяет отображаемые сколько родительских узлов. Значение по умолчанию равно -1, которое налагает ограничения на количество отображаемых родительских узлов. |
| PathDirection | Определяет направление SiteMapPath. Допустимые значения: RootToCurrent (по умолчанию) и CurrentToRoot. |
| PathSeparator | Строка, управляющий символ, разделяющий узлов в элемент управления SiteMapPath. Значение по умолчанию:. |
| RenderCurrentNodeAsLink | Логическое значение, управляет ли текущий узел отображается в виде ссылки. Значение по умолчанию — False. |
| SkipLinkText | Помогает использовать специальные возможности при просмотре страницы средствами чтения с экрана. Это свойство позволяет средства чтения с экрана пропустить элемента управления SiteMapPath инфраструктуры. Чтобы отключить эту функцию, свойства значение String.Empty. |

## <a name="templated-sitemappath-controls"></a>Элементы управления SiteMapPath на основе шаблона

SiteMapControl является шаблонного элемента управления, и таким образом, можно определить различные шаблоны для использования при отображении элемента управления. Чтобы изменить шаблоны в элемент управления SiteMapPath, нажмите кнопку смарт-тег на элементе управления и выберите в меню Правка шаблонов. Откроется меню SiteMapTasks, как показано ниже, где можно выбрать различные шаблоны, доступные.


![](data-bound-controls/_static/image2.jpg)

**Рис. 2**


**NodeTemplate** шаблон ссылается на любом узле SiteMapPath. Если узел является корневой узел или текущий узел и **RootNodeTemplate** или **CurrentNodeTemplate** будет настроена, NodeTemplate переопределяется.

## <a name="sitemappath-events"></a>События SiteMapPath

Элемент управления SiteMapPath имеет два события, которые не являются производными от класса элемента управления. **ItemCreated** событий и **ItemDataBound** событий. При создании элемента SiteMapPath, возникает событие ItemCreated. ItemDataBound возникает в том случае, когда во время привязки данных SiteMapPath узла вызывается метод DataBind. Объект **SiteMapNodeItemEventArgs** объекта предоставляет доступ к определенной SiteMapNodeItem через свойство элемента.

## <a name="controlling-appearance-with-styles"></a>Управление внешним видом с использованием стилей

Для форматирования элемента управления SiteMapPath доступны следующие стили.

| **Имя свойства** | **Элементы управления** |
| --- | --- |
| CurrentNodeStyle | Определяет стиль текста для текущего узла. |
| RootNodeStyle | Определяет стиль текста для корневого узла. |
| NodeStyle | Определяет стиль текста для всех узлов, при условии, что CurrentNodeStyle или RootNodeStyle не применяется. |

Свойство NodeStyle переопределяется параметром CurrentNodeStyle или RootNodeStyle. Каждое из этих свойств только для чтения и возвращает **стиля** объекта. Чтобы повлиять на внешний вид узла с помощью одного из этих свойств, необходимо задать свойства объекта стиля, который возвращается. Например приведенный ниже код изменяет свойство forecolor текущего узла.

[!code-aspx[Main](data-bound-controls/samples/sample10.aspx)]

Свойства могут также применяться программным способом, как показано ниже:

[!code-csharp[Main](data-bound-controls/samples/sample11.cs)]

> [!NOTE]
> При применении шаблона стиля не применяются.


## <a name="lab-1-configuring-an-aspnet-menu-control"></a>Практическое занятие 1. Настройка элемента управления меню ASP.NET

1. Создайте новый веб-сайт.
2. Добавьте файл карты узла, выбрав файл, создать, файл и выбрав список шаблонов файлов карты узла.
3. Откройте карты узла (Web.sitemap по умолчанию) и измените его, чтобы он выглядел ниже списка. Страницы, на которых выполняется связывание в файл карты узла не существуют, но не, может возникнуть проблема, для этого упражнения.

    [!code-xml[Main](data-bound-controls/samples/sample12.xml)]
4. Откройте веб-форму по умолчанию в режиме конструктора.
5. В области навигации панели элементов добавьте новый элемент управления Menu на страницу.
6. Из раздела данных панели элементов добавьте Новый SiteMapDataSource. SiteMapDataSource автоматически будет использовать файл Web.sitemap узла. (Файл Web.sitemap *необходимо* находиться в корневой папке сайта.)
7. Щелкните элемент управления меню и нажмите кнопку смарт-тег, чтобы открыть диалоговое окно задачи меню.
8. В раскрывающемся списке выберите источник данных выберите SiteMapDataSource1.
9. Щелкните ссылку Автоформат и выберите формат для меню.
10. В панели «Свойства» задайте **StaticDisplayLevels** значение 2. Элемент управления меню должно отображаться узел Home, продуктов и служб в конструкторе.
11. Перейдите на страницу в браузере, чтобы использовать в меню. (Так как в самом деле нет страниц, то я добавил в карту узла, вы увидите ошибку при попытке перейти к ним.)

Поэкспериментировать с изменением StaticDisplayLevels, так и свойствами MaximumDynamicDisplayLevels и определения их влияния на отображение меню.

## <a name="lab-2-dynamically-binding-a-treeview-control"></a>Лабораторное занятие 2. Динамическая привязка элемента управления TreeView

В этом упражнении предполагается, что у вас есть локальный сервер SQL, и что базе данных "Борей" присутствует в экземпляре SQL Server. Если эти условия не выполняются, измените строку подключения в образце. Обратите внимание на то, что может также потребоваться проверку подлинности SQL Server вместо доверенного соединения.

1. Создайте новый веб-сайт.
2. Переключитесь в представление кода для Default.aspx и замените весь код приведенным ниже программным кодом. 

    [!code-aspx[Main](data-bound-controls/samples/sample13.aspx)]
3. Сохраните страницу как treeview.aspx.
4. Перейдите к странице.
5. При первом отображении страницы, просмотрите исходный код страницы в браузере. Обратите внимание, что только видимые узлы были отправлены клиенту.
6. Щелкните знак «плюс» рядом с любого узла.
7. Просмотр исходного кода на странице еще раз. Обратите внимание на то, что вновь отображаемых узлы теперь присутствуют.

## <a name="lab-3-details-view-and-editing-data-using-a-gridview-and-detailsview"></a>Лабораторное занятие 3. Представление сведений и редактирования данных с помощью GridView и DetailsView

1. Создайте новый веб-сайт.
2. Добавьте новый файл web.config для веб-сайта.
3. Добавьте строку подключения в файле web.config, как показано ниже: 

    [!code-xml[Main](data-bound-controls/samples/sample14.xml)]

    > [!NOTE]
    > Может потребоваться изменить строку подключения, в зависимости от среды.
4. Сохраните изменения и закройте файл web.config.
5. Откройте страницу Default.aspx и добавьте новый элемент управления SqlDataSource.
6. Изменить идентификатор элемента управления SqlDataSource **продуктов**.
7. В **Задачи SqlDataSource** меню, щелкните **Настройка источника данных**.
8. Выберите **Northwind** в раскрывающемся списке подключения и нажмите кнопку Далее.
9. Выберите **продуктов** из **имя** раскрывающийся список и проверьте **ProductID**, **ProductName**, **UnitPrice**, и **UnitsInStock** флажков, как показано ниже. 

![](data-bound-controls/_static/image3.jpg)

    **Figure 3**
10. Нажмите кнопку **Далее**.
11. Нажмите кнопку **Готово**.
12. Переключитесь в режим конструктора и изучить код, который был создан. Обратите внимание, что **SelectCommand**, **DeleteCommand**, **InsertCommand**, и **UpdateCommand** , были добавлены для элемента управления SqlDataSource элемент управления. Также Обратите внимание, что параметры, которые были добавлены.
13. Переключитесь в конструктор и добавьте новый элемент управления GridView на страницу.
14. Выберите **продуктов** из **Выбор источника данных** раскрывающегося списка.
15. Проверьте **Enable Paging** и **разрешить выделение** как показано ниже. 

![](data-bound-controls/_static/image4.jpg)

    **Figure 4**
16. Нажмите кнопку **Правка столбцов** ссылку и убедитесь, что **автоматически создавать поля** проверяется.
17. Нажмите кнопку **ОК**.
18. С помощью выбранного элемента управления GridView, нажмите кнопку рядом с полем **DataKeyNames** свойство на панели свойств.
19. Выберите **ProductID** из **доступные поля данных** списке и нажмите кнопку **&gt;** , чтобы добавить его.
20. Нажмите кнопку ОК.
21. Добавьте новый элемент управления SqlDataSource на страницу.
22. Изменить идентификатор элемента управления SqlDataSource **сведения**.
23. Выберите в меню Задачи SqlDataSource, **Настройка источника данных**.
24. Выберите **Northwind** из раскрывающегося списка и нажмите кнопку **Далее**.
25. Выберите <strong>продуктов</strong> из <strong>имя</strong> раскрывающийся список и проверьте <strong> \</ strong > * флажок в <strong>столбцы</strong> listbox.
26. Нажмите кнопку **ГДЕ** кнопки.
27. Выберите **ProductID** из **столбец** раскрывающегося списка.
28. Выберите **=** в раскрывающемся списке оператор.
29. Выберите **управления** из **источника** раскрывающегося списка.
30. Выберите **GridView1** из **идентификатор элемента управления** раскрывающегося списка.
31. Нажмите кнопку **добавить** кнопку, чтобы добавить предложение WHERE.
32. Нажмите кнопку **ОК**.
33. Нажмите кнопку **Дополнительно** кнопку и установите флажок **создать инструкции INSERT, UPDATE и DELETE** флажок.
34. Нажмите кнопку **ОК**.
35. Нажмите кнопку **Далее** и нажмите кнопку **Готово**.
36. Добавьте элемент управления DetailsView на страницу.
37. В **Выбор источника данных** раскрывающемся списке выберите **сведения**.
38. Проверьте **Разрешить изменение** флажок, как показано ниже. 

![](data-bound-controls/_static/image1.gif)

    **Figure 5**
39. Сохраните страницу и найдите Default.aspx.
40. Нажмите кнопку **выберите** ссылку рядом с разных записей, чтобы увидеть обновление DetailsView автоматически.
41. Нажмите кнопку **изменить** ссылки в элементе управления DetailsView.
42. Внесите изменения в запись и нажмите кнопку **обновления**.
