---
uid: web-forms/overview/moving-to-aspnet-20/master-pages
title: Главные страницы | Документация Майкрософт
author: microsoft
description: Одним из ключевых компонентов успешного веб-сайта является согласованного внешнего вида и поведения. В ASP.NET 1.x, разработчики использовали пользовательские элементы управления для репликации общих elem. страницы...
ms.author: riande
ms.date: 02/20/2005
ms.assetid: 9c0cce4d-efd9-4c14-b0e8-a1a140abb3f4
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/master-pages
msc.type: authoredcontent
ms.openlocfilehash: f40eb338a1b6b8eebb6578dd7938e96a05b1617f
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/01/2019
ms.locfileid: "57055121"
---
<a name="master-pages"></a><span data-ttu-id="421d7-104">Эталонные страницы</span><span class="sxs-lookup"><span data-stu-id="421d7-104">Master Pages</span></span>
====================
<span data-ttu-id="421d7-105">по [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="421d7-105">by [Microsoft](https://github.com/microsoft)</span></span>

> <span data-ttu-id="421d7-106">Одним из ключевых компонентов успешного веб-сайта является согласованного внешнего вида и поведения.</span><span class="sxs-lookup"><span data-stu-id="421d7-106">One of the key components to a successful Web site is a consistent look and feel.</span></span> <span data-ttu-id="421d7-107">В ASP.NET 1.x, разработчики использовали пользовательские элементы управления для репликации общих элементов страницы на веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="421d7-107">In ASP.NET 1.x, developers used user controls to replicate common page elements across a Web application.</span></span> <span data-ttu-id="421d7-108">Хотя это определенно приемлемым решением, с помощью пользовательских элементов управления есть свои недостатки.</span><span class="sxs-lookup"><span data-stu-id="421d7-108">While that is certainly a workable solution, using user controls does have some drawbacks.</span></span> <span data-ttu-id="421d7-109">Например изменение позиции элемента управления требует изменения на несколько страниц на сайте.</span><span class="sxs-lookup"><span data-stu-id="421d7-109">For example, a change in position of a user control requires a change to multiple pages across a site.</span></span> <span data-ttu-id="421d7-110">Пользовательские элементы управления также не подготавливаются к просмотру в режиме конструктора после, вставляемых на странице.</span><span class="sxs-lookup"><span data-stu-id="421d7-110">User controls are also not rendered in Design view after being inserted on a page.</span></span>


<span data-ttu-id="421d7-111">Одним из ключевых компонентов успешного веб-сайта является согласованного внешнего вида и поведения.</span><span class="sxs-lookup"><span data-stu-id="421d7-111">One of the key components to a successful Web site is a consistent look and feel.</span></span> <span data-ttu-id="421d7-112">В ASP.NET 1.x, разработчики использовали пользовательские элементы управления для репликации общих элементов страницы на веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="421d7-112">In ASP.NET 1.x, developers used user controls to replicate common page elements across a Web application.</span></span> <span data-ttu-id="421d7-113">Хотя это определенно приемлемым решением, с помощью пользовательских элементов управления есть свои недостатки.</span><span class="sxs-lookup"><span data-stu-id="421d7-113">While that is certainly a workable solution, using user controls does have some drawbacks.</span></span> <span data-ttu-id="421d7-114">Например изменение позиции элемента управления требует изменения на несколько страниц на сайте.</span><span class="sxs-lookup"><span data-stu-id="421d7-114">For example, a change in position of a user control requires a change to multiple pages across a site.</span></span> <span data-ttu-id="421d7-115">Пользовательские элементы управления также не подготавливаются к просмотру в режиме конструктора после, вставляемых на странице.</span><span class="sxs-lookup"><span data-stu-id="421d7-115">User controls are also not rendered in Design view after being inserted on a page.</span></span>

<span data-ttu-id="421d7-116">В ASP.NET 2.0 появились Master страницы как способ сохранения согласованного внешнего вида и поведения, а как вы скоро увидите, Master страницы представляют существенным усовершенствованием по метода управления пользователя.</span><span class="sxs-lookup"><span data-stu-id="421d7-116">ASP.NET 2.0 introduces Master pages as a way of maintaining a consistent look and feel, and as you'll soon see, Master pages represent a significant improvement over the user control method.</span></span>

## <a name="why-master-pages"></a><span data-ttu-id="421d7-117">Почему мастер-страниц?</span><span class="sxs-lookup"><span data-stu-id="421d7-117">Why Master Pages?</span></span>

<span data-ttu-id="421d7-118">Читатель может спросить, почему были необходимы главных страниц в ASP.NET 2.0.</span><span class="sxs-lookup"><span data-stu-id="421d7-118">You may be wondering why master pages were needed in ASP.NET 2.0.</span></span> <span data-ttu-id="421d7-119">В конце концов, веб-сайта разработчики уже используют пользовательские элементы управления в ASP.NET 1.x для совместного использования содержимого области между страницами.</span><span class="sxs-lookup"><span data-stu-id="421d7-119">After all, Web site developers are already using user controls in ASP.NET 1.x to share content areas between pages.</span></span> <span data-ttu-id="421d7-120">Существует фактически несколько причин, почему пользовательские элементы управления будут менее оптимальные решения для создания макета страницы.</span><span class="sxs-lookup"><span data-stu-id="421d7-120">There are actually several reasons why user controls are a less-than-optimal solution for creating a common layout.</span></span>

<span data-ttu-id="421d7-121">Пользовательские элементы управления фактически не определить макет страницы.</span><span class="sxs-lookup"><span data-stu-id="421d7-121">User controls don't actually define page layout.</span></span> <span data-ttu-id="421d7-122">Вместо этого они определяют, макет и функциональные возможности для части страницы.</span><span class="sxs-lookup"><span data-stu-id="421d7-122">Instead, they define the layout and functionality for a portion of a page.</span></span> <span data-ttu-id="421d7-123">Различие между этими двумя важно, поскольку это повышает управляемость решения управления пользователя гораздо сложнее.</span><span class="sxs-lookup"><span data-stu-id="421d7-123">The distinction between these two is important because it makes manageability of a user control solution much more difficult.</span></span> <span data-ttu-id="421d7-124">Например если вы хотите изменить его позицию пользовательского элемента управления на странице, необходимо изменить фактическую страницу, на которой отображается пользовательский элемент управления.</span><span class="sxs-lookup"><span data-stu-id="421d7-124">For example, when you want to change the position of a user control on your page, you must edit the actual page on which the user control appears.</span></span> <span data-ttu-id="421d7-125">Если у вас есть несколько страниц, но в больших веб-узлов, быстро становится настоящим кошмаром управления сайта, тонкую thats!</span><span class="sxs-lookup"><span data-stu-id="421d7-125">Thats fine if you have only a few pages, but in large sites, it quickly becomes a site management nightmare!</span></span>

<span data-ttu-id="421d7-126">Другим недостатком использования пользовательских элементов управления для определения макета основывается на архитектуре самой ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="421d7-126">Another drawback of using user controls for defining a common layout is rooted in the architecture of ASP.NET itself.</span></span> <span data-ttu-id="421d7-127">Если изменяется любой открытый член пользовательского элемента управления, он требует повторной компиляции всех страниц, использующих пользовательский элемент управления.</span><span class="sxs-lookup"><span data-stu-id="421d7-127">If any public member of a user control is changed, it requires you to recompile all of the pages that use the user control.</span></span> <span data-ttu-id="421d7-128">В свою очередь ASP.NET будет, а затем получить доступ к страницам при первом повторной JIT.</span><span class="sxs-lookup"><span data-stu-id="421d7-128">In turn, ASP.NET will then re-JIT your pages when they are first accessed.</span></span> <span data-ttu-id="421d7-129">Это, опять же, создает-масштабируемой архитектуры и проблемы управления сайта для больших сайтах.</span><span class="sxs-lookup"><span data-stu-id="421d7-129">This, once again, produces a non-scalable architecture and a site management problem for larger sites.</span></span>

<span data-ttu-id="421d7-130">Обе эти проблемы (и многих других) аккуратно обращаться, главных страниц в ASP.NET 2.0.</span><span class="sxs-lookup"><span data-stu-id="421d7-130">Both of these problems (and many more) are nicely addressed by master pages in ASP.NET 2.0.</span></span>

## <a name="how-master-pages-work"></a><span data-ttu-id="421d7-131">Как функционируют главные страницы</span><span class="sxs-lookup"><span data-stu-id="421d7-131">How Master Pages Work</span></span>

<span data-ttu-id="421d7-132">Главная страница является аналогом шаблона для других страниц.</span><span class="sxs-lookup"><span data-stu-id="421d7-132">A master page is analogous to a template for other pages.</span></span> <span data-ttu-id="421d7-133">Элементы страницы, которые должны совместно использоваться других страниц (т. е. меню, границы, и т.д.) добавляются на главную страницу.</span><span class="sxs-lookup"><span data-stu-id="421d7-133">Page elements that should be shared among other pages (i.e. menus, borders, etc.) are added to the master page.</span></span> <span data-ttu-id="421d7-134">При добавлении новых страниц к сайту можно связать их с главной страницей.</span><span class="sxs-lookup"><span data-stu-id="421d7-134">When new pages are added to the site, you can associate them with a master page.</span></span> <span data-ttu-id="421d7-135">Вызова страницы, которая связана с главной страницей **страницы содержимого**.</span><span class="sxs-lookup"><span data-stu-id="421d7-135">A page that is associated with a master page is called a **content page**.</span></span> <span data-ttu-id="421d7-136">По умолчанию страницы содержимого принимает от главной страницы.</span><span class="sxs-lookup"><span data-stu-id="421d7-136">By default, a content page takes on the appearance from the master page.</span></span> <span data-ttu-id="421d7-137">Тем не менее при создании главной страницы, можно определить части страницы, страницы содержимого можно заменить его собственного содержимого.</span><span class="sxs-lookup"><span data-stu-id="421d7-137">However, when you create a master page, you can define portions of the page that the content page can replace with its own content.</span></span> <span data-ttu-id="421d7-138">Эти части определяются с помощью нового элемента управления, появившиеся в ASP.NET 2.0. **ContentPlaceHolder** элемента управления.</span><span class="sxs-lookup"><span data-stu-id="421d7-138">These portions are defined using a new control introduced in ASP.NET 2.0; the **ContentPlaceHolder** control.</span></span>

<span data-ttu-id="421d7-139">Главная страница может содержать любое количество элементов управления ContentPlaceHolder (или вообще.) На странице содержимого от элементов управления ContentPlaceHolder содержимое внутри элемента **содержимого** элементы управления, другой новый элемент управления в ASP.NET 2.0.</span><span class="sxs-lookup"><span data-stu-id="421d7-139">A master page can contain any number of ContentPlaceHolder controls (or none at all.) On the content page, the content from the ContentPlaceHolder controls appears inside of **Content** controls, another new control in ASP.NET 2.0.</span></span> <span data-ttu-id="421d7-140">По умолчанию страницы содержимого, которые элементы управления содержимым пусты, таким образом, чтобы обеспечить собственное содержимое.</span><span class="sxs-lookup"><span data-stu-id="421d7-140">By default, the content pages Content controls are empty so that you can provide your own content.</span></span> <span data-ttu-id="421d7-141">Если вы хотите использовать содержимое из главной страницы внутри элементов управления содержимым, это можно сделать так, как вы увидите далее в этом модуле.</span><span class="sxs-lookup"><span data-stu-id="421d7-141">If you want to use the content from the master page inside of the Content controls, you can do so as you will see later in this module.</span></span> <span data-ttu-id="421d7-142">Элемент управления содержимым, сопоставлен с управления ContentPlaceHolder через атрибут ContentPlaceHolderID элемента управления содержимым.</span><span class="sxs-lookup"><span data-stu-id="421d7-142">The Content control is mapped to the ContentPlaceHolder control via the ContentPlaceHolderID attribute of the Content control.</span></span> <span data-ttu-id="421d7-143">Код ниже maps элементу управления содержимым к элементу управления ContentPlaceHolder, вызывается mainBody на главной странице.</span><span class="sxs-lookup"><span data-stu-id="421d7-143">The code below maps a Content control to a ContentPlaceHolder control called mainBody on a master page.</span></span>

[!code-aspx[Main](master-pages/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="421d7-144">Часто можно слышать людей, которые описывают главных страниц, как базовый класс для других страниц.</span><span class="sxs-lookup"><span data-stu-id="421d7-144">You will often hear people describe master pages as being a base class for other pages.</span></span> <span data-ttu-id="421d7-145">Thats фактически не равно true.</span><span class="sxs-lookup"><span data-stu-id="421d7-145">Thats actually not true.</span></span> <span data-ttu-id="421d7-146">Связь между главных страниц и страниц содержимого не является одним из наследования.</span><span class="sxs-lookup"><span data-stu-id="421d7-146">The relationship between master pages and content pages is not one of inheritance.</span></span>


<span data-ttu-id="421d7-147">**Рис. 1** показано главной страницы и связана страница содержимого, как они отображаются в Visual Studio 2005.</span><span class="sxs-lookup"><span data-stu-id="421d7-147">**Figure 1** shows a master page and an associated content page as they appear in Visual Studio 2005.</span></span> <span data-ttu-id="421d7-148">Вы увидите элемент управления ContentPlaceHolder на главной странице и соответствующего содержимого элемента управления на странице содержимого.</span><span class="sxs-lookup"><span data-stu-id="421d7-148">You can see the ContentPlaceHolder control in the master page and the corresponding Content control in the content page.</span></span> <span data-ttu-id="421d7-149">Обратите внимание на то, что содержимое главных страниц, которое находится вне элемента ContentPlaceHolder будет видима, но серым, на странице содержимого.</span><span class="sxs-lookup"><span data-stu-id="421d7-149">Notice that the master pages content that is outside of the ContentPlaceHolder is visible but grayed out in the content page.</span></span> <span data-ttu-id="421d7-150">Только содержимое внутри элемента ContentPlaceHolder могут быть заменены на странице содержимого.</span><span class="sxs-lookup"><span data-stu-id="421d7-150">Only the content inside of the ContentPlaceHolder can be supplanted by the content page.</span></span> <span data-ttu-id="421d7-151">Все остальное содержимое из главной страницы является неизменяемым.</span><span class="sxs-lookup"><span data-stu-id="421d7-151">All other content that comes from the master page is immutable.</span></span>


![Главная страница и связанные с ней содержимого страницы](master-pages/_static/image1.jpg)

<span data-ttu-id="421d7-153">**Рис. 1**: Главная страница и связанные с ней содержимого страницы</span><span class="sxs-lookup"><span data-stu-id="421d7-153">**Figure 1**: A master page and its associated content page</span></span>


## <a name="creating-a-master-page"></a><span data-ttu-id="421d7-154">Создание главной страницы</span><span class="sxs-lookup"><span data-stu-id="421d7-154">Creating a Master Page</span></span>

<span data-ttu-id="421d7-155">Создание новой главной страницы:</span><span class="sxs-lookup"><span data-stu-id="421d7-155">To create a new master page:</span></span>

1. <span data-ttu-id="421d7-156">Откройте Visual Studio 2005 и создайте новый веб-сайт.</span><span class="sxs-lookup"><span data-stu-id="421d7-156">Open Visual Studio 2005 and create a new Web site.</span></span>
2. <span data-ttu-id="421d7-157">Щелкните файл, новый, файла.</span><span class="sxs-lookup"><span data-stu-id="421d7-157">Click File, New, File.</span></span>
3. <span data-ttu-id="421d7-158">Выберите файл мастера в диалоговом окне Добавление нового элемента, как показано на **рис. 2**.</span><span class="sxs-lookup"><span data-stu-id="421d7-158">Choose Master File from the Add New Item dialog as shown in **figure 2**.</span></span>
4. <span data-ttu-id="421d7-159">Нажмите кнопку Добавить.</span><span class="sxs-lookup"><span data-stu-id="421d7-159">Click Add.</span></span>


![Создание новой главной страницы](master-pages/_static/image2.jpg)

<span data-ttu-id="421d7-161">**Рис. 2**: Создание новой главной страницы</span><span class="sxs-lookup"><span data-stu-id="421d7-161">**Figure 2**: Creating a New Master Page</span></span>


<span data-ttu-id="421d7-162">Обратите внимание, что расширение файла для главной страницы <em>.master</em>.</span><span class="sxs-lookup"><span data-stu-id="421d7-162">Notice that the file extension for a master page is <em>.master</em>.</span></span> <span data-ttu-id="421d7-163">Это один из способов, Главная страница отличается от обычных страниц.</span><span class="sxs-lookup"><span data-stu-id="421d7-163">This is one of the ways that a master page differs from an ordinary page.</span></span> <span data-ttu-id="421d7-164">Основным различием является, вместо @Page директив, Главная страница содержит @Master директива.</span><span class="sxs-lookup"><span data-stu-id="421d7-164">The other primary difference is that in lieu of a @Page directive, the master page contains a @Master directive.</span></span> <span data-ttu-id="421d7-165">Переключитесь в режим конструктора для главной страницы, вы только что создали и просмотрите код.</span><span class="sxs-lookup"><span data-stu-id="421d7-165">Switch to Source View for the master page youve just created and review the code.</span></span>

<span data-ttu-id="421d7-166">По умолчанию в новой главной страницы будут иметь один элемент управления ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="421d7-166">A new master page will have one ContentPlaceHolder control by default.</span></span> <span data-ttu-id="421d7-167">В большинстве случаев более разумно сначала создать общие элементы страницы, а затем добавить элементы управления ContentPlaceHolder где требуется пользовательское содержимое.</span><span class="sxs-lookup"><span data-stu-id="421d7-167">In most cases, it makes more sense to create the common page elements first and then insert ContentPlaceHolder controls where custom content is desired.</span></span> <span data-ttu-id="421d7-168">В таких случаях разработчикам может потребоваться удалить элемент управления ContentPlaceHolder по умолчанию и вставить новые как разрабатывается страницы.</span><span class="sxs-lookup"><span data-stu-id="421d7-168">In those cases, developers will want to delete the default ContentPlaceHolder control and insert new ones as the page is developed.</span></span> <span data-ttu-id="421d7-169">Элементы управления ContentPlaceHolder не изменяется, несмотря на то, что они отображают маркеры изменения размера.</span><span class="sxs-lookup"><span data-stu-id="421d7-169">ContentPlaceHolder controls are not resizable despite the fact that they do display sizing handles.</span></span> <span data-ttu-id="421d7-170">Размеры элемента управления ContentPlaceHolder, автоматически на основе содержимого, содержащейся в ней за одним исключением; Если вы поместили элемент управления ContentPlaceHolder внутри блока, например в ячейку таблицы, он будет масштабироваться в соответствии с размером элемента.</span><span class="sxs-lookup"><span data-stu-id="421d7-170">The ContentPlaceHolder control sizes automatically based upon the content that it contains with one exception; if you place a ContentPlaceHolder control inside of a block element such as a table cell, it will size according to the size of the element.</span></span>

## <a name="lab-1-working-with-master-pages"></a><span data-ttu-id="421d7-171">Лабораторное занятие 1 Работа с главными страницами</span><span class="sxs-lookup"><span data-stu-id="421d7-171">Lab 1 Working with Master Pages</span></span>

<span data-ttu-id="421d7-172">В этой лабораторной работе вы создадите новую главную страницу и определить три элемента управления ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="421d7-172">In this lab, you will create a new master page and define three ContentPlaceHolder controls.</span></span> <span data-ttu-id="421d7-173">Кроме того, будет затем создать новую страницу содержимого и замените его содержимое по крайней мере один из элементов управления ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="421d7-173">You will then create a new Content page and replace the content from at least one of the ContentPlaceHolder controls.</span></span>

1. <span data-ttu-id="421d7-174">Создание главной страницы и вставка элементов управления ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="421d7-174">Create a master page and insert ContentPlaceHolder controls.</span></span> 

    1. <span data-ttu-id="421d7-175">Создание новой главной страницы, как описано выше.</span><span class="sxs-lookup"><span data-stu-id="421d7-175">Create a new master page as described above.</span></span>
    2. <span data-ttu-id="421d7-176">Удалите элемент управления ContentPlaceHolder по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="421d7-176">Delete the default ContentPlaceHolder control.</span></span>
    3. <span data-ttu-id="421d7-177">Выберите элемент управления ContentPlaceHolder, щелкнув на затененную рамку верхнего элемента управления, а затем удалите его, нажав клавишу DEL на клавиатуре.</span><span class="sxs-lookup"><span data-stu-id="421d7-177">Select the ContentPlaceHolder control by clicking the shaded top border of the control and then delete it by hitting the DEL key on your keyboard.</span></span>
    4. <span data-ttu-id="421d7-178">Вставка новой таблицы с помощью *заголовок и сторона* шаблона, как показано на рис. 3.</span><span class="sxs-lookup"><span data-stu-id="421d7-178">Insert a new table using the *Header and side* template as shown in figure 3.</span></span> <span data-ttu-id="421d7-179">Измените ширину и высоту до 90%, так что вся таблица становится видимым в конструкторе.</span><span class="sxs-lookup"><span data-stu-id="421d7-179">Change the width and height to 90% each so that the entire table is visible in the designer.</span></span>


![](master-pages/_static/image3.jpg)

<span data-ttu-id="421d7-180">**Рис. 3**</span><span class="sxs-lookup"><span data-stu-id="421d7-180">**Figure 3**</span></span>


1. <span data-ttu-id="421d7-181">Поместите курсор в каждой ячейке таблицы и задать *valign* свойства *верхней*.</span><span class="sxs-lookup"><span data-stu-id="421d7-181">Place the cursor into each cell of the table and set the *valign* property to *top*.</span></span>
2. <span data-ttu-id="421d7-182">Из панели элементов вставьте элемент управления ContentPlaceHolder верхнюю ячейку таблицы (ячейку заголовка.)</span><span class="sxs-lookup"><span data-stu-id="421d7-182">From the Toolbox, insert a ContentPlaceHolder control in the top cell of the table (the header cell.)</span></span>
3. <span data-ttu-id="421d7-183">При вставке этого элемента управления ContentPlaceHolder, вы заметите, что высота строки займет около почти всю страницу, как показано на рис. 4.</span><span class="sxs-lookup"><span data-stu-id="421d7-183">When you insert this ContentPlaceHolder control, you will notice that the row height will take up almost the entire page as shown in figure 4.</span></span> <span data-ttu-id="421d7-184">Было бы заботиться о, на этом этапе.</span><span class="sxs-lookup"><span data-stu-id="421d7-184">Dont be concerned about that at this point.</span></span>


![Пустое место находится в той же ячейке, как ContentPlaceHolder](master-pages/_static/image1.gif)

<span data-ttu-id="421d7-186">**Рис. 4**: Пустое место находится в той же ячейке, как ContentPlaceHolder</span><span class="sxs-lookup"><span data-stu-id="421d7-186">**Figure 4**: The empty space is in the same cell as the ContentPlaceHolder</span></span>


1. <span data-ttu-id="421d7-187">Поместите элемент управления ContentPlaceHolder остальные две ячейки.</span><span class="sxs-lookup"><span data-stu-id="421d7-187">Place a ContentPlaceHolder control in the other two cells.</span></span> <span data-ttu-id="421d7-188">После вставки других элементов управления ContentPlaceHolder должен быть размер ячеек таблицы, как и следовало ожидать.</span><span class="sxs-lookup"><span data-stu-id="421d7-188">Once the other ContentPlaceHolder controls have been inserted, the size of the table cells should be as you would expect.</span></span> <span data-ttu-id="421d7-189">Страницы теперь должен выглядеть страница, показанная на **рис. 5**.</span><span class="sxs-lookup"><span data-stu-id="421d7-189">The page should now look like the page shown in **figure 5**.</span></span>


![Образец с каждым элементом управления ContentPlaceHolder.](master-pages/_static/image2.gif)

<span data-ttu-id="421d7-192">**Рис. 5**: Образец с каждым элементом управления ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="421d7-192">**Figure 5**: The Master with all ContentPlaceHolder controls.</span></span> <span data-ttu-id="421d7-193">Обратите внимание, что высота ячейки для ячейки заголовка теперь какой должна быть</span><span class="sxs-lookup"><span data-stu-id="421d7-193">Notice that the cell height for the header cell is now what it should be</span></span>


1. <span data-ttu-id="421d7-194">Введите текст по своему усмотрению, в каждой из трех элементов управления ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="421d7-194">Enter some text of your choice into each of the three ContentPlaceHolder controls.</span></span>
2. <span data-ttu-id="421d7-195">Сохранение exercise1.master главной страницы.</span><span class="sxs-lookup"><span data-stu-id="421d7-195">Save the master page as exercise1.master.</span></span>
3. <span data-ttu-id="421d7-196">Создайте новый веб-формы и связать его с главной страницей exercise1.master.</span><span class="sxs-lookup"><span data-stu-id="421d7-196">Create a new Web Form and associate it with the exercise1.master master page.</span></span>
4. <span data-ttu-id="421d7-197">Выберите новый файл, файл в Visual Studio 2005.</span><span class="sxs-lookup"><span data-stu-id="421d7-197">Select File, New, File in Visual Studio 2005.</span></span>
5. <span data-ttu-id="421d7-198">Выберите **веб-формы** в диалоговом окне Добавление нового элемента.</span><span class="sxs-lookup"><span data-stu-id="421d7-198">Select **Web Form** in the Add New Item dialog.</span></span>
6. <span data-ttu-id="421d7-199">Убедитесь, что установлен флажок, выбрать главную страницу, как показано на рис. 6.</span><span class="sxs-lookup"><span data-stu-id="421d7-199">Make sure that the Select master page checkbox is checked as shown in figure 6.</span></span>


![Добавление новой страницы содержимого](master-pages/_static/image3.gif)

<span data-ttu-id="421d7-201">**Рис. 6**: Добавление новой страницы содержимого</span><span class="sxs-lookup"><span data-stu-id="421d7-201">**Figure 6**: Adding a new Content Page</span></span>


1. <span data-ttu-id="421d7-202">Нажмите кнопку Добавить.</span><span class="sxs-lookup"><span data-stu-id="421d7-202">Click Add.</span></span>
2. <span data-ttu-id="421d7-203">Выберите exercise1.master в выберите главную страницу диалоговое окно как показано на рис. 7.</span><span class="sxs-lookup"><span data-stu-id="421d7-203">Select exercise1.master in the Select a master page dialog as shown in figure 7.</span></span>
3. <span data-ttu-id="421d7-204">Нажмите кнопку ОК, чтобы добавить новую страницу содержимого.</span><span class="sxs-lookup"><span data-stu-id="421d7-204">Click OK to add the new content page.</span></span>

<span data-ttu-id="421d7-205">Новая страница содержимого отображается в Visual Studio с помощью одного элемента управления содержимым для каждого элемента управления ContentPlaceHolder на главной странице.</span><span class="sxs-lookup"><span data-stu-id="421d7-205">The new content page appears in Visual Studio with one Content control for each ContentPlaceHolder control on the master page.</span></span> <span data-ttu-id="421d7-206">По умолчанию элементы управления содержимым пусты, таким образом, можно добавить собственное содержимое.</span><span class="sxs-lookup"><span data-stu-id="421d7-206">By default, the Content controls are empty so that you can add your own content.</span></span> <span data-ttu-id="421d7-207">Если вы для них для использования содержимого из элемента управления ContentPlaceHolder на главной странице, просто щелкните смарт-тег символа (маленькой черной стрелки в правом верхнем углу элемента управления) и выберите *по умолчанию образцы содержимого* в смарт-теге, как показано в **рис. 8**.</span><span class="sxs-lookup"><span data-stu-id="421d7-207">If youd like for them to use the content from the ContentPlaceHolder control on the master page, simply click on the smart tag symbol (the small black arrow in the upper-right corner of the control) and choose *Default to Masters Content* from the smart tag as shown in **figure 8**.</span></span> <span data-ttu-id="421d7-208">При этом элемент меню изменяется на *создать настраиваемый содержимое*.</span><span class="sxs-lookup"><span data-stu-id="421d7-208">When you do so, the menu item changes to *Create Custom Content*.</span></span> <span data-ttu-id="421d7-209">Удаляет содержимое из главной страницы, позволяющая определить пользовательское содержимое для этого конкретного содержимого элемента управления, щелкнув его в этот момент.</span><span class="sxs-lookup"><span data-stu-id="421d7-209">Clicking it at that point removes the content from the master page allowing you to define custom content for that particular Content control.</span></span>


![Настройка элемента управления содержимым к значениям по умолчанию для содержимого страницы мастера](master-pages/_static/image4.gif)

<span data-ttu-id="421d7-211">**Рис. 7**: Настройка элемента управления содержимым к значениям по умолчанию для содержимого страницы мастера</span><span class="sxs-lookup"><span data-stu-id="421d7-211">**Figure 7**: Setting a Content Control to Default to the Master Pages Content</span></span>


## <a name="connecting-master-page-and-content-pages"></a><span data-ttu-id="421d7-212">Подключение главной страницы и страницы содержимого</span><span class="sxs-lookup"><span data-stu-id="421d7-212">Connecting Master Page and Content Pages</span></span>

<span data-ttu-id="421d7-213">Связь между главной страницы и страницы содержимого может настраиваться в одном из четырех способов:</span><span class="sxs-lookup"><span data-stu-id="421d7-213">The association between a master page and a content page can be configured in one of four different ways:</span></span>

- <span data-ttu-id="421d7-214"><strong>MasterPageFile</strong> атрибут @Page директива</span><span class="sxs-lookup"><span data-stu-id="421d7-214">The <strong>MasterPageFile</strong> attribute of the @Page directive</span></span>
- <span data-ttu-id="421d7-215">Установка **Page.MasterPageFile** свойства в коде.</span><span class="sxs-lookup"><span data-stu-id="421d7-215">Setting the **Page.MasterPageFile** property in code.</span></span>
- <span data-ttu-id="421d7-216">**&lt;Страниц&gt;** элемент в файле конфигурации приложения (web.config в корневой папке приложения)</span><span class="sxs-lookup"><span data-stu-id="421d7-216">The **&lt;pages&gt;** element in the applications configuration file (web.config in the root folder of the application)</span></span>
- <span data-ttu-id="421d7-217">**&lt;Страниц&gt;** элемент в файле конфигурации (web.config во вложенной папке) вложенные папки</span><span class="sxs-lookup"><span data-stu-id="421d7-217">The **&lt;pages&gt;** element in a subfolders configuration file (web.config in a subfolder)</span></span>

## <a name="masterpagefile-attribute"></a><span data-ttu-id="421d7-218">MasterPageFile-атрибут</span><span class="sxs-lookup"><span data-stu-id="421d7-218">MasterPageFile Attribute</span></span>

<span data-ttu-id="421d7-219">MasterPageFile-атрибут позволяет легко применить главную страницу на определенной странице ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="421d7-219">The MasterPageFile attribute makes it easy to apply a master page to a particular ASP.NET page.</span></span> <span data-ttu-id="421d7-220">Это также метод, используемый для применения главной страницы, при проверке **выбрать главную страницу** флажок, как описано в упражнении 1.</span><span class="sxs-lookup"><span data-stu-id="421d7-220">It is also the method used to apply the master page when you check the **Select Master Page** checkbox as you did in Exercise 1.</span></span>

## <a name="setting-pagemasterpagefile-in-code"></a><span data-ttu-id="421d7-221">Установка Page.MasterPageFile в коде</span><span class="sxs-lookup"><span data-stu-id="421d7-221">Setting Page.MasterPageFile in Code</span></span>

<span data-ttu-id="421d7-222">Задав свойство MasterPageFile в коде, можно применить к содержимому во время выполнения определенной главной страницы.</span><span class="sxs-lookup"><span data-stu-id="421d7-222">By setting the MasterPageFile property in code, you can apply a particular master page to your content at runtime.</span></span> <span data-ttu-id="421d7-223">Это полезно в случаях, где может потребоваться применить определенной главной страницей, в зависимости от роли пользователей или некоторых других критериев.</span><span class="sxs-lookup"><span data-stu-id="421d7-223">This is useful in cases where you may need to apply a specific master page based upon a users role or some other criteria.</span></span> <span data-ttu-id="421d7-224">Свойство MasterPageFile должен устанавливаться в методе PreInit.</span><span class="sxs-lookup"><span data-stu-id="421d7-224">The MasterPageFile property must be set in the PreInit method.</span></span> <span data-ttu-id="421d7-225">Если он установлен после метода PreInit, возникает исключение InvalidOperationException.</span><span class="sxs-lookup"><span data-stu-id="421d7-225">If it is set after the PreInit method, an InvalidOperationException will be thrown.</span></span> <span data-ttu-id="421d7-226">Страница, на котором это свойство имеет значение также должен иметь содержимое элемента управления как элемент верхнего уровня для страницы.</span><span class="sxs-lookup"><span data-stu-id="421d7-226">The page on which this property is being set must also have a Content control as the top-level control for the page.</span></span> <span data-ttu-id="421d7-227">В противном случае HttpException возникает, если установить свойство MasterPageFile.</span><span class="sxs-lookup"><span data-stu-id="421d7-227">Otherwise an HttpException will be thrown when the MasterPageFile property is set.</span></span>

## <a name="using-the-ltpagesgt-element"></a><span data-ttu-id="421d7-228">С помощью &lt;страниц&gt; элемент</span><span class="sxs-lookup"><span data-stu-id="421d7-228">Using the &lt;pages&gt; Element</span></span>

<span data-ttu-id="421d7-229">Можно настроить главной страницы для страниц, установив в атрибуте masterPageFile &lt;страниц&gt; в файле web.config.</span><span class="sxs-lookup"><span data-stu-id="421d7-229">You can configure a master page for your pages by setting the masterPageFile attribute in the &lt;pages&gt; element of the web.config file.</span></span> <span data-ttu-id="421d7-230">При использовании этого метода, имейте в виду, что этот параметр можно переопределить файлов web.config, более низком уровне структуры приложения.</span><span class="sxs-lookup"><span data-stu-id="421d7-230">When using this method, keep in mind that web.config files lower in the application structure can override this setting.</span></span> <span data-ttu-id="421d7-231">Любой атрибут MasterPageFile, установленный в @Page директива также может изменить это значение.</span><span class="sxs-lookup"><span data-stu-id="421d7-231">Any MasterPageFile attribute set in a @Page directive will also override this setting.</span></span> <span data-ttu-id="421d7-232">С помощью &lt;страниц&gt; элемента вы можете легко создать <em>master</em> главной страницы, который можно переопределить при необходимости в папках или файлах.</span><span class="sxs-lookup"><span data-stu-id="421d7-232">Using the &lt;pages&gt; element makes it simple to create a <em>master</em> master page that can be overridden if necessary in particular folders or files.</span></span>

## <a name="properties-in-master-pages"></a><span data-ttu-id="421d7-233">Свойства на главных страницах</span><span class="sxs-lookup"><span data-stu-id="421d7-233">Properties in Master Pages</span></span>

<span data-ttu-id="421d7-234">Главная страница может предоставлять свойства, просто этих свойств в рамках главной страницы.</span><span class="sxs-lookup"><span data-stu-id="421d7-234">A master page can expose properties by simply making those properties public within the master page.</span></span> <span data-ttu-id="421d7-235">Например следующий код определяет свойство с именем SomeProperty:</span><span class="sxs-lookup"><span data-stu-id="421d7-235">For example, the following code defines a property called SomeProperty:</span></span>

[!code-csharp[Main](master-pages/samples/sample2.cs)]

<span data-ttu-id="421d7-236">Для доступа к свойству SomeProperty на странице содержимого, необходимо использовать хозяину свойства следующим образом:</span><span class="sxs-lookup"><span data-stu-id="421d7-236">To access the SomeProperty property from the Content page, you will need to use the Master property like so:</span></span>

[!code-csharp[Main](master-pages/samples/sample3.cs)]

## <a name="nesting-master-pages"></a><span data-ttu-id="421d7-237">Вложенные главные страницы</span><span class="sxs-lookup"><span data-stu-id="421d7-237">Nesting Master Pages</span></span>

<span data-ttu-id="421d7-238">Главные страницы являются идеальным решением для обеспечения общего вида и впечатления для больших веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="421d7-238">Master pages are the perfect solution for ensuring a common look and feel across a large Web application.</span></span> <span data-ttu-id="421d7-239">Тем не менее это не часто имеет определенные части большого сайта совместно используют общий интерфейс, хотя другие части имеют другой интерфейс.</span><span class="sxs-lookup"><span data-stu-id="421d7-239">However, it's not uncommon to have certain parts of a large site share a common interface while other parts share a different interface.</span></span> <span data-ttu-id="421d7-240">Удовлетворить эту потребность, несколько главных страниц являются идеальным решением.</span><span class="sxs-lookup"><span data-stu-id="421d7-240">To address that need, multiple master pages are the perfect solution.</span></span> <span data-ttu-id="421d7-241">Тем не менее, по-прежнему не рассматриваются тот факт, что большого приложения могут иметь некоторые компоненты (например, меню, например), которые являются общими для всех страниц и других компонентов, которые являются общими только для определенных разделов узла.</span><span class="sxs-lookup"><span data-stu-id="421d7-241">However, that still doesn't address the fact that a large application may have certain components (such as a menu, for example) that are shared among all pages and other components that are shared only among certain sections of the site.</span></span> <span data-ttu-id="421d7-242">Для такого типа ситуаций вложенные главные страницы удовлетворяет сопутствующим потребностям хорошо.</span><span class="sxs-lookup"><span data-stu-id="421d7-242">For that type of situation, nested master pages fill the need nicely.</span></span> <span data-ttu-id="421d7-243">Как вы убедились, обычный главной страницы состоит из главной страницы и страницы содержимого.</span><span class="sxs-lookup"><span data-stu-id="421d7-243">As you've seen, a normal master page consists of a master page and a content page.</span></span> <span data-ttu-id="421d7-244">В случае вложенной главной страницы существует две главные страницы; главной родительского и дочернего главного сервера.</span><span class="sxs-lookup"><span data-stu-id="421d7-244">In a nested master page situation, there are two master pages; a parent master and a child master.</span></span> <span data-ttu-id="421d7-245">Дочерняя главная страница также страницу содержимого и его шаблон имеет родительскую главную страницу.</span><span class="sxs-lookup"><span data-stu-id="421d7-245">The child master page is also a content page and its master is the parent master page.</span></span>

<span data-ttu-id="421d7-246">Ниже приведен код для типичных главной страницы:</span><span class="sxs-lookup"><span data-stu-id="421d7-246">Here is the code for a typical master page:</span></span>

[!code-aspx[Main](master-pages/samples/sample4.aspx)]

<span data-ttu-id="421d7-247">В случае вложенных master это будет родительским.</span><span class="sxs-lookup"><span data-stu-id="421d7-247">In a nested master scenario, this would be the parent master.</span></span> <span data-ttu-id="421d7-248">Другой главной страницы будет Используйте эту страницу, как его главной страницы, и этот код будет выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="421d7-248">Another master page would use this page as its master page, and that code would look like this:</span></span>

[!code-aspx[Main](master-pages/samples/sample5.aspx)]

<span data-ttu-id="421d7-249">Обратите внимание, что в этом случае master дочерних также содержимого страницы для родительского шаблона.</span><span class="sxs-lookup"><span data-stu-id="421d7-249">Note that in this scenario, the child master is also a content page for the parent master.</span></span> <span data-ttu-id="421d7-250">Все содержимое дочерних главной страницы содержатся внутри элемента управления содержимым, которое получает его содержимого из родительского элемента управления ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="421d7-250">All of the child master's content appears inside of a Content control that gets its content from the parent's ContentPlaceHolder control.</span></span>

> [!NOTE]
> <span data-ttu-id="421d7-251">Конструктора не поддерживается для вложенных главных страниц.</span><span class="sxs-lookup"><span data-stu-id="421d7-251">Designer support is not available for nested master pages.</span></span> <span data-ttu-id="421d7-252">При разработке с помощью вложенных главных серверов, необходимо использовать представление источника.</span><span class="sxs-lookup"><span data-stu-id="421d7-252">When you are developing using nested masters, you will need to use source view.</span></span>


<span data-ttu-id="421d7-253">В этом видео показано Пошаговое руководство по использованию вложенных главных страниц.</span><span class="sxs-lookup"><span data-stu-id="421d7-253">This video shows a walkthrough of using nested master pages.</span></span>


![](master-pages/_static/image1.png)


[<span data-ttu-id="421d7-254">Открыть весь экран</span><span class="sxs-lookup"><span data-stu-id="421d7-254">Open Full-Screen Video</span></span>](master-pages/_static/nested1.wmv)


![Выбор главной страницы](master-pages/_static/image4.jpg)

<span data-ttu-id="421d7-256">**Рис. 8**: Выбор главной страницы</span><span class="sxs-lookup"><span data-stu-id="421d7-256">**Figure 8**: Selecting a Master Page</span></span>
