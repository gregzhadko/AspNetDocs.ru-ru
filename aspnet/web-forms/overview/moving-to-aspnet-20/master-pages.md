---
uid: web-forms/overview/moving-to-aspnet-20/master-pages
title: Главные страницы | Документация Майкрософт
author: microsoft
description: Одним из ключевых компонентов успешного веб-сайта является согласованного внешнего вида и поведения. В ASP.NET 1.x, разработчики использовали пользовательские элементы управления для репликации общих elem. страницы...
ms.author: riande
ms.date: 02/20/2005
ms.assetid: 9c0cce4d-efd9-4c14-b0e8-a1a140abb3f4
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/master-pages
msc.type: authoredcontent
ms.openlocfilehash: 36f2caf7c2c9bcafd22c8f6681c1d6b19fe5078a
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65131069"
---
# <a name="master-pages"></a>Эталонные страницы

по [Microsoft](https://github.com/microsoft)

> Одним из ключевых компонентов успешного веб-сайта является согласованного внешнего вида и поведения. В ASP.NET 1.x, разработчики использовали пользовательские элементы управления для репликации общих элементов страницы на веб-приложения. Хотя это определенно приемлемым решением, с помощью пользовательских элементов управления есть свои недостатки. Например изменение позиции элемента управления требует изменения на несколько страниц на сайте. Пользовательские элементы управления также не подготавливаются к просмотру в режиме конструктора после, вставляемых на странице.

Одним из ключевых компонентов успешного веб-сайта является согласованного внешнего вида и поведения. В ASP.NET 1.x, разработчики использовали пользовательские элементы управления для репликации общих элементов страницы на веб-приложения. Хотя это определенно приемлемым решением, с помощью пользовательских элементов управления есть свои недостатки. Например изменение позиции элемента управления требует изменения на несколько страниц на сайте. Пользовательские элементы управления также не подготавливаются к просмотру в режиме конструктора после, вставляемых на странице.

В ASP.NET 2.0 появились Master страницы как способ сохранения согласованного внешнего вида и поведения, а как вы скоро увидите, Master страницы представляют существенным усовершенствованием по метода управления пользователя.

## <a name="why-master-pages"></a>Почему мастер-страниц?

Читатель может спросить, почему были необходимы главных страниц в ASP.NET 2.0. В конце концов, веб-сайта разработчики уже используют пользовательские элементы управления в ASP.NET 1.x для совместного использования содержимого области между страницами. Существует фактически несколько причин, почему пользовательские элементы управления будут менее оптимальные решения для создания макета страницы.

Пользовательские элементы управления фактически не определить макет страницы. Вместо этого они определяют, макет и функциональные возможности для части страницы. Различие между этими двумя важно, поскольку это повышает управляемость решения управления пользователя гораздо сложнее. Например если вы хотите изменить его позицию пользовательского элемента управления на странице, необходимо изменить фактическую страницу, на которой отображается пользовательский элемент управления. Если у вас есть несколько страниц, но в больших веб-узлов, быстро становится настоящим кошмаром управления сайта, тонкую thats!

Другим недостатком использования пользовательских элементов управления для определения макета основывается на архитектуре самой ASP.NET. Если изменяется любой открытый член пользовательского элемента управления, он требует повторной компиляции всех страниц, использующих пользовательский элемент управления. В свою очередь ASP.NET будет, а затем получить доступ к страницам при первом повторной JIT. Это, опять же, создает-масштабируемой архитектуры и проблемы управления сайта для больших сайтах.

Обе эти проблемы (и многих других) аккуратно обращаться, главных страниц в ASP.NET 2.0.

## <a name="how-master-pages-work"></a>Как функционируют главные страницы

Главная страница является аналогом шаблона для других страниц. Элементы страницы, которые должны совместно использоваться других страниц (т. е. меню, границы, и т.д.) добавляются на главную страницу. При добавлении новых страниц к сайту можно связать их с главной страницей. Вызова страницы, которая связана с главной страницей **страницы содержимого**. По умолчанию страницы содержимого принимает от главной страницы. Тем не менее при создании главной страницы, можно определить части страницы, страницы содержимого можно заменить его собственного содержимого. Эти части определяются с помощью нового элемента управления, появившиеся в ASP.NET 2.0. **ContentPlaceHolder** элемента управления.

Главная страница может содержать любое количество элементов управления ContentPlaceHolder (или вообще.) На странице содержимого от элементов управления ContentPlaceHolder содержимое внутри элемента **содержимого** элементы управления, другой новый элемент управления в ASP.NET 2.0. По умолчанию страницы содержимого, которые элементы управления содержимым пусты, таким образом, чтобы обеспечить собственное содержимое. Если вы хотите использовать содержимое из главной страницы внутри элементов управления содержимым, это можно сделать так, как вы увидите далее в этом модуле. Элемент управления содержимым, сопоставлен с управления ContentPlaceHolder через атрибут ContentPlaceHolderID элемента управления содержимым. Код ниже maps элементу управления содержимым к элементу управления ContentPlaceHolder, вызывается mainBody на главной странице.

[!code-aspx[Main](master-pages/samples/sample1.aspx)]

> [!NOTE]
> Часто можно слышать людей, которые описывают главных страниц, как базовый класс для других страниц. Thats фактически не равно true. Связь между главных страниц и страниц содержимого не является одним из наследования.

**Рис. 1** показано главной страницы и связана страница содержимого, как они отображаются в Visual Studio 2005. Вы увидите элемент управления ContentPlaceHolder на главной странице и соответствующего содержимого элемента управления на странице содержимого. Обратите внимание на то, что содержимое главных страниц, которое находится вне элемента ContentPlaceHolder будет видима, но серым, на странице содержимого. Только содержимое внутри элемента ContentPlaceHolder могут быть заменены на странице содержимого. Все остальное содержимое из главной страницы является неизменяемым.

![Главная страница и связанные с ней содержимого страницы](master-pages/_static/image1.jpg)

**Рис. 1**: Главная страница и связанные с ней содержимого страницы

## <a name="creating-a-master-page"></a>Создание главной страницы

Создание новой главной страницы:

1. Откройте Visual Studio 2005 и создайте новый веб-сайт.
2. Щелкните файл, новый, файла.
3. Выберите файл мастера в диалоговом окне Добавление нового элемента, как показано на **рис. 2**.
4. Нажмите кнопку Добавить.

![Создание новой главной страницы](master-pages/_static/image2.jpg)

**Рис. 2**: Создание новой главной страницы

Обратите внимание, что расширение файла для главной страницы *.master*. Это один из способов, Главная страница отличается от обычных страниц. Основным различием является, вместо @Page директив, Главная страница содержит @Master директива. Переключитесь в режим конструктора для главной страницы, вы только что создали и просмотрите код.

По умолчанию в новой главной страницы будут иметь один элемент управления ContentPlaceHolder. В большинстве случаев более разумно сначала создать общие элементы страницы, а затем добавить элементы управления ContentPlaceHolder где требуется пользовательское содержимое. В таких случаях разработчикам может потребоваться удалить элемент управления ContentPlaceHolder по умолчанию и вставить новые как разрабатывается страницы. Элементы управления ContentPlaceHolder не изменяется, несмотря на то, что они отображают маркеры изменения размера. Размеры элемента управления ContentPlaceHolder, автоматически на основе содержимого, содержащейся в ней за одним исключением; Если вы поместили элемент управления ContentPlaceHolder внутри блока, например в ячейку таблицы, он будет масштабироваться в соответствии с размером элемента.

## <a name="lab-1-working-with-master-pages"></a>Лабораторное занятие 1 Работа с главными страницами

В этой лабораторной работе вы создадите новую главную страницу и определить три элемента управления ContentPlaceHolder. Кроме того, будет затем создать новую страницу содержимого и замените его содержимое по крайней мере один из элементов управления ContentPlaceHolder.

1. Создание главной страницы и вставка элементов управления ContentPlaceHolder. 

    1. Создание новой главной страницы, как описано выше.
    2. Удалите элемент управления ContentPlaceHolder по умолчанию.
    3. Выберите элемент управления ContentPlaceHolder, щелкнув на затененную рамку верхнего элемента управления, а затем удалите его, нажав клавишу DEL на клавиатуре.
    4. Вставка новой таблицы с помощью *заголовок и сторона* шаблона, как показано на рис. 3. Измените ширину и высоту до 90%, так что вся таблица становится видимым в конструкторе.

![](master-pages/_static/image3.jpg)

**Рис. 3**

1. Поместите курсор в каждой ячейке таблицы и задать *valign* свойства *верхней*.
2. Из панели элементов вставьте элемент управления ContentPlaceHolder верхнюю ячейку таблицы (ячейку заголовка.)
3. При вставке этого элемента управления ContentPlaceHolder, вы заметите, что высота строки займет около почти всю страницу, как показано на рис. 4. Не стоит беспокоиться об этом на этом этапе.

![Пустое место находится в той же ячейке, как ContentPlaceHolder](master-pages/_static/image1.gif)

**Рис. 4**: Пустое место находится в той же ячейке, как ContentPlaceHolder

1. Поместите элемент управления ContentPlaceHolder остальные две ячейки. После вставки других элементов управления ContentPlaceHolder должен быть размер ячеек таблицы, как и следовало ожидать. Страницы теперь должен выглядеть страница, показанная на **рис. 5**.

![Образец с каждым элементом управления ContentPlaceHolder. Обратите внимание, что высота ячейки для ячейки заголовка теперь какой должна быть](master-pages/_static/image2.gif)

**Рис. 5**: Образец с каждым элементом управления ContentPlaceHolder. Обратите внимание, что высота ячейки для ячейки заголовка теперь какой должна быть

1. Введите текст по своему усмотрению, в каждой из трех элементов управления ContentPlaceHolder.
2. Сохранение exercise1.master главной страницы.
3. Создайте новый веб-формы и связать его с главной страницей exercise1.master.
4. Выберите новый файл, файл в Visual Studio 2005.
5. Выберите **веб-формы** в диалоговом окне Добавление нового элемента.
6. Убедитесь, что установлен флажок, выбрать главную страницу, как показано на рис. 6.

![Добавление новой страницы содержимого](master-pages/_static/image3.gif)

**Рис. 6**: Добавление новой страницы содержимого

1. Нажмите кнопку Добавить.
2. Выберите exercise1.master в выберите главную страницу диалоговое окно как показано на рис. 7.
3. Нажмите кнопку ОК, чтобы добавить новую страницу содержимого.

Новая страница содержимого отображается в Visual Studio с помощью одного элемента управления содержимым для каждого элемента управления ContentPlaceHolder на главной странице. По умолчанию элементы управления содержимым пусты, таким образом, можно добавить собственное содержимое. При желании для них для использования содержимого из элемента управления ContentPlaceHolder на главной странице, просто щелкните смарт-тег символа (маленькой черной стрелки в правом верхнем углу элемента управления) и выберите *по умолчанию образцы содержимого* в смарт-теге, как показано в **рис. 8.**. При этом элемент меню изменяется на *создать настраиваемый содержимое*. Удаляет содержимое из главной страницы, позволяющая определить пользовательское содержимое для этого конкретного содержимого элемента управления, щелкнув его в этот момент.

![Настройка элемента управления содержимым к значениям по умолчанию для содержимого страницы мастера](master-pages/_static/image4.gif)

**Рис. 7**: Настройка элемента управления содержимым к значениям по умолчанию для содержимого страницы мастера

## <a name="connecting-master-page-and-content-pages"></a>Подключение главной страницы и страницы содержимого

Связь между главной страницы и страницы содержимого может настраиваться в одном из четырех способов:

- <strong>MasterPageFile</strong> атрибут @Page директива
- Установка **Page.MasterPageFile** свойства в коде.
- **&lt;Страниц&gt;** элемент в файле конфигурации приложения (web.config в корневой папке приложения)
- **&lt;Страниц&gt;** элемент в файле конфигурации (web.config во вложенной папке) вложенные папки

## <a name="masterpagefile-attribute"></a>MasterPageFile-атрибут

MasterPageFile-атрибут позволяет легко применить главную страницу на определенной странице ASP.NET. Это также метод, используемый для применения главной страницы, при проверке **выбрать главную страницу** флажок, как описано в упражнении 1.

## <a name="setting-pagemasterpagefile-in-code"></a>Установка Page.MasterPageFile в коде

Задав свойство MasterPageFile в коде, можно применить к содержимому во время выполнения определенной главной страницы. Это полезно в случаях, где может потребоваться применить определенной главной страницей, в зависимости от роли пользователей или некоторых других критериев. Свойство MasterPageFile должен устанавливаться в методе PreInit. Если он установлен после метода PreInit, возникает исключение InvalidOperationException. Страница, на котором это свойство имеет значение также должен иметь содержимое элемента управления как элемент верхнего уровня для страницы. В противном случае HttpException возникает, если установить свойство MasterPageFile.

## <a name="using-the-ltpagesgt-element"></a>С помощью &lt;страниц&gt; элемент

Можно настроить главной страницы для страниц, установив в атрибуте masterPageFile &lt;страниц&gt; в файле web.config. При использовании этого метода, имейте в виду, что этот параметр можно переопределить файлов web.config, более низком уровне структуры приложения. Любой атрибут MasterPageFile, установленный в @Page директива также может изменить это значение. С помощью &lt;страниц&gt; элемента вы можете легко создать *master* главной страницы, который можно переопределить при необходимости в папках или файлах.

## <a name="properties-in-master-pages"></a>Свойства на главных страницах

Главная страница может предоставлять свойства, просто этих свойств в рамках главной страницы. Например следующий код определяет свойство с именем SomeProperty:

[!code-csharp[Main](master-pages/samples/sample2.cs)]

Для доступа к свойству SomeProperty на странице содержимого, необходимо использовать хозяину свойства следующим образом:

[!code-csharp[Main](master-pages/samples/sample3.cs)]

## <a name="nesting-master-pages"></a>Вложенные главные страницы

Главные страницы являются идеальным решением для обеспечения общего вида и впечатления для больших веб-приложения. Тем не менее это не часто имеет определенные части большого сайта совместно используют общий интерфейс, хотя другие части имеют другой интерфейс. Удовлетворить эту потребность, несколько главных страниц являются идеальным решением. Тем не менее, по-прежнему не рассматриваются тот факт, что большого приложения могут иметь некоторые компоненты (например, меню, например), которые являются общими для всех страниц и других компонентов, которые являются общими только для определенных разделов узла. Для такого типа ситуаций вложенные главные страницы удовлетворяет сопутствующим потребностям хорошо. Как вы убедились, обычный главной страницы состоит из главной страницы и страницы содержимого. В случае вложенной главной страницы существует две главные страницы; главной родительского и дочернего главного сервера. Дочерняя главная страница также страницу содержимого и его шаблон имеет родительскую главную страницу.

Ниже приведен код для типичных главной страницы:

[!code-aspx[Main](master-pages/samples/sample4.aspx)]

В случае вложенных master это будет родительским. Другой главной страницы будет Используйте эту страницу, как его главной страницы, и этот код будет выглядеть следующим образом:

[!code-aspx[Main](master-pages/samples/sample5.aspx)]

Обратите внимание, что в этом случае master дочерних также содержимого страницы для родительского шаблона. Все содержимое дочерних главной страницы содержатся внутри элемента управления содержимым, которое получает его содержимого из родительского элемента управления ContentPlaceHolder.

> [!NOTE]
> Конструктора не поддерживается для вложенных главных страниц. При разработке с помощью вложенных главных серверов, необходимо использовать представление источника.

В этом видео показано Пошаговое руководство по использованию вложенных главных страниц.

![](master-pages/_static/image1.png)

[Открыть весь экран](master-pages/_static/nested1.wmv)

![Выбор главной страницы](master-pages/_static/image4.jpg)

**Рис. 8**: Выбор главной страницы
