---
uid: web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-vb
title: Создание интерфейса для выбора одной учетной записи пользователя из множества (VB) | Документация Майкрософт
author: rick-anderson
description: В этом учебнике мы создадим пользовательский интерфейс с постраничной и фильтруемой сеткой. В частности, наш интерфейс пользователя будет состоять из серии LinkButton для...
ms.author: riande
ms.date: 04/01/2008
ms.assetid: da53380c-a16b-41c7-a20d-24343c735c52
msc.legacyurl: /web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-vb
msc.type: authoredcontent
ms.openlocfilehash: 6c711cdaab113d589d9c2535cb1b422de3f38103
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74614686"
---
# <a name="building-an-interface-to-select-one-user-account-from-many-vb"></a>Создание интерфейса для выбора одной учетной записи пользователя из многих (VB)

по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Скачать код](https://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/VB.12.zip) или [скачать PDF](https://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_vb.pdf)

> В этом учебнике мы создадим пользовательский интерфейс с постраничной и фильтруемой сеткой. В частности, наш интерфейс пользователя будет состоять из ряда элементов управления LinkButton для фильтрации результатов на основе начальной буквы имени пользователя, а также для отображения соответствующих пользователей. Мы начнем с перечисления всех учетных записей пользователей в элементе управления GridView. Затем в шаге 3 мы добавим фильтры LinkButton. Шаг 4 рассматривает разбивку отфильтрованных результатов. Интерфейс, созданный в шагах 2 – 4, будет использоваться в последующих руководствах для выполнения административных задач для конкретной учетной записи пользователя.

## <a name="introduction"></a>Введение

<a id="_msoanchor_1"> </a>В руководстве [*назначение ролей пользователям*](../roles/assigning-roles-to-users-vb.md) мы создали элементарный интерфейс для администратора, чтобы выбрать пользователя и управлять его ролями. В частности, интерфейс представил администратору раскрывающийся список всех пользователей. Такой интерфейс подходит, если имеется, но не более десятка учетных записей пользователей, но это неудобно для сайтов с сотнями или тысячами учетных записей. Постраничная и фильтруемая сетка — более подходящий пользовательский интерфейс для веб-сайтов с большими базами пользователей.

В этом учебнике мы создадим такой пользовательский интерфейс. В частности, наш интерфейс пользователя будет состоять из ряда элементов управления LinkButton для фильтрации результатов на основе начальной буквы имени пользователя, а также для отображения соответствующих пользователей. Мы начнем с перечисления всех учетных записей пользователей в элементе управления GridView. Затем в шаге 3 мы добавим фильтры LinkButton. Шаг 4 рассматривает разбивку отфильтрованных результатов. Интерфейс, созданный в шагах 2 – 4, будет использоваться в последующих руководствах для выполнения административных задач для конкретной учетной записи пользователя.

Приступим к работе!

## <a name="step-1-adding-new-aspnet-pages"></a>Шаг 1. Добавление новых страниц ASP.NET

В этом руководстве и следующих двух мы будем изучать различные функции и возможности, связанные с администрированием. Для реализации разделов, которые были проверены в рамках этих руководств, потребуется серия ASP.NET страниц. Давайте создадим эти страницы и обновляем карту узла.

Начните с создания новой папки в проекте с именем `Administration`. Затем добавьте в папку две новые страницы ASP.NET, связав каждую страницу с главной страницей `Site.master`. Назовите страницы:

- `ManageUsers.aspx`
- `UserInformation.aspx`

Кроме того, добавьте две страницы в корневой каталог веб-сайта: `ChangePassword.aspx` и `RecoverPassword.aspx`.

На этом этапе на этих четырех страницах должно быть два элемента управления содержимым — по одному для каждой элементов управления ContentPlaceHolder главной страницы: `MainContent` и `LoginContent`.

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample1.aspx)]

Мы хотим отобразить разметку главной страницы по умолчанию для `LoginContent` ContentPlaceHolder для этих страниц. Поэтому удалите декларативную разметку для элемента управления содержимым `Content2`. После этого разметка страниц должна содержать только один элемент управления содержимым.

Страницы ASP.NET в папке `Administration` предназначены исключительно для пользователей с правами администратора. Роль администраторов добавлена в систему в <a id="_msoanchor_2"> </a>учебнике [*Создание ролей и управление ими*](../roles/creating-and-managing-roles-vb.md) . Ограничьте доступ к этим двум страницам с этой ролью. Для этого добавьте `Web.config` файл в папку `Administration` и настройте его элемент `<authorization>`, чтобы присвоить пользователям роль «Администраторы» и запретить все остальные.

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample2.xml)]

На этом этапе обозреватель решений проекта должны выглядеть примерно так, как показано на снимке экрана, показанном на рис. 1.

[![на веб-сайт были добавлены четыре новые страницы и файл Web. config.](building-an-interface-to-select-one-user-account-from-many-vb/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image1.png)

**Рис. 1**. на веб-сайт добавлены четыре новые страницы и файл `Web.config` ([щелкните, чтобы просмотреть изображение с полным размером](building-an-interface-to-select-one-user-account-from-many-vb/_static/image3.png)).

Наконец, обновите карту узла (`Web.sitemap`), чтобы добавить запись на страницу `ManageUsers.aspx`. Добавьте следующий XML-код после `<siteMapNode>`, добавленного для учебника по ролям.

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample3.xml)]

Обновив карту узла, перейдите на сайт через браузер. Как показано на рис. 2, Навигация в левой части включает элементы учебников по администрированию.

[![на карте узла имеется узел Администрирование пользователей](building-an-interface-to-select-one-user-account-from-many-vb/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image4.png)

**Рис. 2**. схема узла включает узел с названием Администрирование пользователя ([щелкните, чтобы просмотреть изображение с полным размером](building-an-interface-to-select-one-user-account-from-many-vb/_static/image6.png)).

## <a name="step-2-listing-all-user-accounts-in-a-gridview"></a>Шаг 2. Перечисление всех учетных записей пользователей в элементе управления GridView

Наша конечная цель этого руководства — создать отфильтрованную, фильтруемую по страницам сетку, с помощью которой администратор может выбрать учетную запись пользователя для управления. Начнем с перечисления *всех* пользователей в элементе управления GridView. После завершения этой работы мы добавим интерфейсы фильтрации и разбиения на страницы.

Откройте страницу `ManageUsers.aspx` в папке `Administration` и добавьте GridView, установив для него `ID` `UserAccounts`, мы создадим код для привязки набора учетных записей пользователей к GridView с помощью метода `Membership` класса `GetAllUsers`. Как обсуждалось в предыдущих учебных курсах, метод `GetAllUsers` возвращает объект `MembershipUserCollection`, который является коллекцией объектов `MembershipUser`. Каждый `MembershipUser` в коллекции включает такие свойства, как `UserName`, `Email`, `IsApproved`и т. д.

Чтобы отобразить нужные сведения об учетной записи пользователя в GridView, установите свойство `AutoGenerateColumns` GridView в значение false и добавьте BoundFields для свойств `UserName`, `Email`и `Comment` и Чеккбоксфиелдс для свойств `IsApproved`, `IsLockedOut`и `IsOnline`. Эту конфигурацию можно применить с помощью декларативной разметки элемента управления или с помощью диалогового окна «поля». На рис. 3 показан снимок экрана диалогового окна «поля» после того, как флажок Автоматическое создание полей снят, а BoundFields и Чеккбоксфиелдс были добавлены и настроены.

[![добавить три BoundFields и три Чеккбоксфиелдс в GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image7.png)

**Рис. 3**. Добавление в GridView трех BoundFields и трех Чеккбоксфиелдс ([щелкните, чтобы просмотреть изображение с полным размером](building-an-interface-to-select-one-user-account-from-many-vb/_static/image9.png))

После настройки элемента управления GridView убедитесь, что его декларативная разметка похожа на следующую:

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample4.aspx)]

Далее нам нужно написать код, который привязывает учетные записи пользователей к GridView. Создайте метод с именем `BindUserAccounts` для выполнения этой задачи, а затем вызовите его из обработчика событий `Page_Load` на первой странице посещения.

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample5.vb)]

Уделите время на тестирование страницы в браузере. Как показано на рис. 4, `UserAccounts` GridView перечисляет имя пользователя, адрес электронной почты и другие сведения об учетной записи для всех пользователей в системе.

[![учетные записи пользователей перечислены в элементе управления GridView.](building-an-interface-to-select-one-user-account-from-many-vb/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image10.png)

**Рис. 4**. учетные записи пользователей перечислены в элементе управления GridView ([щелкните, чтобы просмотреть изображение с полным размером](building-an-interface-to-select-one-user-account-from-many-vb/_static/image12.png))

## <a name="step-3-filtering-the-results-by-the-first-letter-of-the-username"></a>Шаг 3. Фильтрация результатов по первой букве имени пользователя

В настоящее время `UserAccounts` GridView отображает *все* учетные записи пользователей. Для веб-сайтов с сотнями или тысячами учетных записей пользователей крайне важно, чтобы пользователь мог быстро немного очистить отображаемые учетные записи. Это можно сделать, добавив на страницу фильтрацию LinkButton. Давайте добавим на страницу 27 элементов LinkButton: для каждой буквы алфавита задается по одному элементу LinkButton. Если посетитель щелкнет элемент управления LinkButton, в GridView будут показаны все пользователи. Если щелкнуть определенную букву, будут отображены только те пользователи, имена которых начинаются с выбранной буквы.

Нашей первой задачей является добавление 27 элементов управления LinkButton. Один из вариантов — создать 27 LinkButton декларативно, по одному за раз. Более гибкий подход заключается в использовании элемента управления Repeater с `ItemTemplate`, который визуализирует LinkButton, а затем привязывает параметры фильтрации к элементу Repeater в качестве массива `String`.

Начните с добавления элемента управления Repeater на страницу над `UserAccounts` GridView. Задайте для свойства `ID` Repeater значение `FilteringUI` настроить шаблоны Repeater таким образом, чтобы его `ItemTemplate` отображала элемент LinkButton, свойства `Text` и `CommandName` которых привязаны к текущему элементу массива. Как было показано в <a id="_msoanchor_3"> </a>руководстве [*назначение ролей пользователям*](../roles/assigning-roles-to-users-vb.md) , это можно сделать с помощью синтаксиса `Container.DataItem` DataBinding. Используйте `SeparatorTemplate` Repeater, чтобы отобразить вертикальную линию между каждой ссылкой.

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample6.aspx)]

Чтобы заполнить этот Repeater с помощью требуемых параметров фильтрации, создайте метод с именем `BindFilteringUI`. Не забудьте вызвать этот метод из обработчика событий `Page_Load` при первой загрузке страницы.

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample7.vb)]

Этот метод задает параметры фильтрации в виде элементов в массиве `String` `filterOptions` для каждого элемента в массиве элемент Repeater будет отображать элемент LinkButton с его `Text` и `CommandName` свойствами, назначенными значению элемента массива.

На рис. 5 показана страница `ManageUsers.aspx` при просмотре в браузере.

[![список Repeater 27 фильтрует LinkButton](building-an-interface-to-select-one-user-account-from-many-vb/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image13.png)

**Рис. 5**. элемент Repeater содержит 27 фильтров LinkButton ([щелкните, чтобы просмотреть изображение с полным размером](building-an-interface-to-select-one-user-account-from-many-vb/_static/image15.png))

> [!NOTE]
> Имена пользователей могут начинаться с любого символа, включая цифры и знаки препинания. Чтобы просмотреть эти учетные записи, администратор должен использовать параметр ALL LinkButton. Кроме того, можно добавить LinkButton для возврата всех учетных записей пользователей, начинающихся с цифры. Я оставлю это в качестве упражнения для читателя.

Если щелкнуть любую из фильтров LinkButton, произойдет обратная передача и будет вызвано событие `ItemCommand` Repeater, но в сетке нет изменений, так как мы еще записали код для фильтрации результатов. Класс `Membership` включает [метод`FindUsersByName`](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) , который возвращает учетные записи пользователей, имена которых совпадают с указанным шаблоном поиска. Этот метод можно использовать для получения только тех учетных записей пользователей, имена которых начинаются с буквы, указанной `CommandName` отфильтрованной LinkButton, которая была нажата.

Начните с обновления класса кода программной части страницы `ManageUser.aspx`, чтобы он включал свойство с именем `UsernameToMatch` это свойство сохраняет строку фильтра username между обратными передачами:

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample8.vb)]

Свойство `UsernameToMatch` сохраняет свое значение, которое присваивается коллекции `ViewState` с помощью ключевого значения UsernameToMatch. При считывании значения этого свойства проверяет, существует ли значение в коллекции `ViewState`. Если нет, возвращается значение по умолчанию — пустая строка. Свойство `UsernameToMatch` имеет общий шаблон, а именно сохраняет значение в состоянии представления, чтобы любые изменения свойства сохранялись во всех обратных передачах. Дополнительные сведения об этом шаблоне см. в статье [Основные сведения о состоянии представления ASP.NET](https://msdn.microsoftn-us/library/ms972976.aspx).

Затем обновите метод `BindUserAccounts` так, чтобы вместо вызова `Membership.GetAllUsers`он вызывал `Membership.FindUsersByName`, передавая значение свойства `UsernameToMatch`, к которому добавляется символ-шаблон SQL,%.

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample9.vb)]

Чтобы отобразить только тех пользователей, имена которых начинаются с буквы а, присвойте свойству `UsernameToMatch` значение, а затем вызовите `BindUserAccounts` это приведет к вызову `Membership.FindUsersByName("A%")`, который возвратит всех пользователей, чье имя пользователя начинается с. Аналогично, чтобы вернуть *всех* пользователей, присвойте свойству `UsernameToMatch` пустую строку, чтобы метод `BindUserAccounts` вызывал `Membership.FindUsersByName("%")`, тем самым возвращая все учетные записи пользователей.

Создайте обработчик событий для `ItemCommand` события Repeater. Это событие возникает при нажатии одной из фильтров LinkButton. ему передается `CommandName` значение LinkButton с помощью объекта `RepeaterCommandEventArgs`. Необходимо присвоить соответствующее значение свойству `UsernameToMatch`, а затем вызвать метод `BindUserAccounts`. Если `CommandName` все, назначьте пустую строку для `UsernameToMatch`, чтобы отображались все учетные записи пользователей. В противном случае назначьте значение `CommandName` `UsernameToMatch`

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample10.vb)]

Используя этот код, протестируйте функцию фильтрации. При первом посещении страницы отображаются все учетные записи пользователей (см. рис. 5). Если щелкнуть элемент LinkButton, произойдет обратная передача и отфильтрованы результаты, отображая только те учетные записи пользователей, которые начинаются с.

[![использовать фильтры LinkButton для вывода пользователей, имена которых начинаются с определенной буквы.](building-an-interface-to-select-one-user-account-from-many-vb/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image16.png)

**Рис. 6**. Использование фильтрации LinkButton для отображения пользователей, имена которых начинаются с определенной буквы ([щелкните, чтобы просмотреть изображение с полным размером](building-an-interface-to-select-one-user-account-from-many-vb/_static/image18.png))

## <a name="step-4-updating-the-gridview-to-use-paging"></a>Шаг 4. обновление элемента управления GridView для использования разбиения на страницы

В элементе управления GridView, показанном на рис. 5 и 6, перечислены все записи, возвращенные методом `FindUsersByName`. При наличии сотен или тысяч учетных записей пользователей это может привести к перегрузке информации при просмотре всех учетных записей (как в случае щелчка элемента LinkButton или при первом посещении страницы). Чтобы обеспечить предоставление учетных записей пользователей более управляемыми фрагментами, давайте настроим в GridView отображение 10 учетных записей пользователей за раз.

Элемент управления GridView предлагает два типа подкачки:

- **Разбиение по страницам по умолчанию** — простота реализации, но неэффективно. Вкратце, с разбиением по страницам по умолчанию GridView принимает *все* записи из своего источника данных. Затем отображается только соответствующая страница записей.
- **Пользовательское разбиение на страницы** . для реализации требуется больше работы, но это более эффективно, чем разбиение по страницам по умолчанию, поскольку при использовании пользовательского разбиения на страницы источник данных возвращает только точный набор отображаемых записей.

Разница в производительности между по умолчанию и пользовательским разбиением на страницы может быть довольно существенной при разбиении по тысячам записей. Поскольку мы создаем этот интерфейс, предполагая, что могут быть сотни или тысячи учетных записей пользователей, давайте будем использовать пользовательское разбиение по страницам.

> [!NOTE]
> Дополнительные сведения о различиях между стандартным и пользовательским разбиением на страницы, а также о проблемах, связанных с реализацией пользовательского разбиения по страницам, см. в разделе [эффективное разбиение больших объемов данных](https://asp.net/learn/data-access/tutorial-25-vb.aspx). Для анализа разницы в производительности между по умолчанию и пользовательским разбиением на страницы см. раздел [Настраиваемое разбиение по страницам в ASP.NET с SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).

Для реализации пользовательского разбиения на страницы сначала нужен механизм, позволяющий получить точное подмножество записей, отображаемых элементом GridView. Хорошая новость состоит в том, что метод `FindUsersByName` `Membership` класса имеет перегрузку, которая позволяет указать индекс страницы и размер страницы, а также возвращает только те учетные записи пользователей, которые попадают в этот диапазон записей.

В частности, эта перегрузка имеет следующую сигнатуру: [`FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)`](https://msdn.microsoft.com/library/fa5st8b2.aspx).

Параметр *pageIndex* указывает страницу возвращаемых учетных записей пользователей. *pageSize* указывает количество записей, отображаемых на страницу. Параметр *тоталрекордс* — это `ByRef` параметр, возвращающий общее количество учетных записей пользователей в хранилище пользователя.

> [!NOTE]
> Данные, возвращаемые `FindUsersByName`, сортируются по имени пользователя. невозможно настроить критерии сортировки.

GridView можно настроить для использования пользовательского разбиения на страницы, но только при привязке к элементу управления ObjectDataSource. Для реализации пользовательского разбиения по страницам в элементе управления ObjectDataSource требуются два метода: один, который передает начальный индекс строки и максимальное число отображаемых записей, и возвращает точное подмножество записей, которые попадают в этот диапазон. и метод, возвращающий общее количество записей, на которые размещается страница. Перегрузка `FindUsersByName` принимает индекс страницы и размер страницы, а также возвращает общее количество записей с помощью параметра `ByRef`. Поэтому здесь есть несоответствие интерфейсов.

Один из вариантов — создать прокси-класс, который предоставляет интерфейс, который требуется ObjectDataSource, а затем внутренне вызывает метод `FindUsersByName`. Другой вариант — и тот, который мы будем использовать в этой статье, — создать наш интерфейс разбиения по страницам и использовать его вместо встроенного интерфейса разбиения по страницам GridView.

### <a name="creating-a-first-previous-next-last-paging-interface"></a>Создание первого, предыдущего, следующего, последнего интерфейса разбиения на страницы

Давайте создадим интерфейс разбиения по страницам с помощью первой, предыдущей, следующей и последней элемента LinkButton. При нажатии первой страницы LinkButton пользователь перейдет на первую страницу данных, тогда как предыдущий будет возвращен на предыдущую страницу. Аналогично, Next и Last переместит пользователя на следующую и последнюю страницу соответственно. Добавьте четыре элемента управления LinkButton под `UserAccounts` GridView.

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample11.aspx)]

Затем создайте обработчик событий для каждого `Click` событий элемента LinkButton.

На рис. 7 показаны четыре элемента LinkButton при просмотре с помощью Visual Web Developer представление конструирования.

[![добавления первой, предыдущей, следующей и последней элементов управления LinkButton под элементом управления GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image19.png)

**Рис. 7**. Добавление первой, предыдущей, следующей и последней элементов управления LinkButton под элементом управления GridView ([щелкните, чтобы просмотреть изображение с полным размером](building-an-interface-to-select-one-user-account-from-many-vb/_static/image21.png))

### <a name="keeping-track-of-the-current-page-index"></a>Отслеживание индекса текущей страницы

Когда пользователь впервые посещает страницу `ManageUsers.aspx` или щелкает одну из кнопок фильтрации, нам нужно отобразить первую страницу данных в GridView. Однако когда пользователь щелкает одну из элементов LinkButton навигации, необходимо обновить индекс страницы. Чтобы сохранить индекс страницы и количество записей, отображаемых на странице, добавьте следующие два свойства в класс кода программной части страницы:

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample12.vb)]

Как и свойство `UsernameToMatch`, свойство `PageIndex` сохраняет свое значение в состоянии представления. Свойство `PageSize` только для чтения возвращает жестко заданное значение 10. Я приглашаю заинтересованному читателю обновить это свойство, чтобы использовать тот же шаблон, что и `PageIndex`, а затем дополнить `ManageUsers.aspx`ную страницу таким образом, чтобы пользователь, посещающий страницу, мог указать количество учетных записей пользователей, отображаемых на странице.

### <a name="retrieving-just-the-current-pages-records-updating-the-page-index-and-enabling-and-disabling-the-paging-interface-linkbuttons"></a>Получение только записей текущей страницы, обновление индекса страницы, включение и отключение элемента LinkButton с интерфейсом подкачки

При наличии интерфейса разбиения на страницы и добавления свойств `PageIndex` и `PageSize` мы готовы обновить метод `BindUserAccounts`, чтобы он использовал соответствующую перегрузку `FindUsersByName`. Кроме того, этот метод должен включать или отключать интерфейс разбиения на страницы в зависимости от того, какая страница отображается. При просмотре первой страницы данных первая и Предыдущая ссылки должны быть отключены. Следующие и последние должны быть отключены при просмотре последней страницы.

Обновите метод `BindUserAccounts`, используя следующий код:

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample13.vb)]

Обратите внимание, что общее число страниц, на которые выполняется переход, определяется последним параметром метода `FindUsersByName`. После того как указанная страница учетных записей пользователей будет возвращена, четыре элемента LinkButton будут включены или отключены в зависимости от того, просматриваются первая или последняя страница данных.

Последним шагом является написание кода для четырех обработчиков событий LinkButton `Click`. Эти обработчики событий должны обновить свойство `PageIndex`, а затем повторно привязать данные к GridView через вызов `BindUserAccounts` первому, предыдущему и следующем обработчике событий. Однако обработчик событий `Click` последнего элемента LinkButton является немного более сложным, так как нам нужно определить, сколько записей отображается, чтобы определить последний индекс страницы.

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample14.vb)]

На рисунках 8 и 9 показан пользовательский интерфейс разбиения на страницы в действии. На рис. 8 показана страница `ManageUsers.aspx` при просмотре первой страницы данных для всех учетных записей пользователей. Обратите внимание, что отображаются только 10 из 13 учетных записей. Если щелкнуть следующую или последнюю ссылку, то обратная передача обновится `PageIndex` до 1 и привязывает вторую страницу учетных записей пользователей к сетке (см. рис. 9).

[![отображаются первые 10 учетных записей пользователей](building-an-interface-to-select-one-user-account-from-many-vb/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image22.png)

**Рис. 8**. отображаются первые 10 учетных записей пользователей ([щелкните, чтобы просмотреть изображение с полным размером](building-an-interface-to-select-one-user-account-from-many-vb/_static/image24.png))

[![щелкнув ссылку "Далее", вы увидите вторую страницу учетных записей пользователей.](building-an-interface-to-select-one-user-account-from-many-vb/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image25.png)

**Рис. 9**. при щелчке по следующей ссылке отображается вторая страница учетных записей пользователей ([щелкните, чтобы просмотреть изображение с полным размером](building-an-interface-to-select-one-user-account-from-many-vb/_static/image27.png))

## <a name="summary"></a>Сводка

Администраторам часто требуется выбрать пользователя из списка учетных записей. В предыдущих руководствах мы рассматривали использование раскрывающегося списка, заполненного пользователями, но этот подход плохо масштабируется. В этом учебнике мы изучили лучшую альтернативу: интерфейс с фильтрацией, результаты которого отображаются в элементе GridView с страничным просмотром. С помощью этого пользовательского интерфейса администраторы могут быстро и эффективно находить и выбирать одну учетную запись пользователя из тысяч.

Поздравляем с программированием!

### <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения о разделах, обсуждаемых в этом руководстве, см. в следующих ресурсах:

- [Пользовательское разбиение по страницам в ASP.NET с SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx)
- [Эффективное разбиение на страницы больших объемов данных](https://asp.net/learn/data-access/tutorial-25-vb.aspx)
- [Развертывание собственного средства администрирования веб-сайта](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a>Об авторе

Скотт Митчелл, автор нескольких книг по ASP/ASP. NET и основатель 4GuysFromRolla.com, работал с веб-технологиями Майкрософт с 1998. Скотт работает как независимый консультант, преподаватель и модуль записи. Его последняя книга — *[Sams обучать себя ASP.NET 2,0 за 24 часа](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* . Скотт можно получить по адресу [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) или через свой блог по адресу [http://ScottOnWriting.NET](http://scottonwriting.net/).

### <a name="special-thanks-to"></a>Специальная благодарность

Эта серия руководств была рассмотрена многими полезными рецензентами. Специалист по интересу для этого руководства был Аликжа Мазиарз. Хотите ознакомиться с моими будущими статьями MSDN? Если да, перетащите строку в

> [!div class="step-by-step"]
> [Назад](unlocking-and-approving-user-accounts-cs.md)
> [Вперед](recovering-and-changing-passwords-vb.md)
