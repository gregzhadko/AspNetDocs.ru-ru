---
uid: web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-vb
title: Проверка учетных данных пользователя в хранилище пользователей членства (VB) | Документация Майкрософт
author: rick-anderson
description: В этом учебнике мы рассмотрим, как проверить учетные данные пользователя в хранилище пользователей членства с помощью программных средств и элемента управления Login....
ms.author: riande
ms.date: 01/18/2008
ms.assetid: 17772912-b47b-4557-9ce9-80f22df642f7
msc.legacyurl: /web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-vb
msc.type: authoredcontent
ms.openlocfilehash: 37574e4cdc86f518d01d12da58cc2862bc77d463
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74643245"
---
# <a name="validating-user-credentials-against-the-membership-user-store-vb"></a><span data-ttu-id="4b992-103">Проверка учетных данных пользователей в хранилище авторизованных пользователей (VB)</span><span class="sxs-lookup"><span data-stu-id="4b992-103">Validating User Credentials Against the Membership User Store (VB)</span></span>

<span data-ttu-id="4b992-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="4b992-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="4b992-105">[Скачать код](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_VB.zip) или [скачать PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="4b992-105">[Download Code](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_VB.zip) or [Download PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_vb.pdf)</span></span>

> <span data-ttu-id="4b992-106">В этом учебнике мы рассмотрим, как проверить учетные данные пользователя в хранилище пользователей членства с помощью программных средств и элемента управления Login.</span><span class="sxs-lookup"><span data-stu-id="4b992-106">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="4b992-107">Также будет рассмотрена настройка внешнего вида и поведения элемента управления Login.</span><span class="sxs-lookup"><span data-stu-id="4b992-107">We will also look at how to customize the login control's appearance and behavior.</span></span>

## <a name="introduction"></a><span data-ttu-id="4b992-108">Введение</span><span class="sxs-lookup"><span data-stu-id="4b992-108">Introduction</span></span>

<span data-ttu-id="4b992-109"><a id="Tutorial05"> </a>В [предыдущем учебном курсе](creating-user-accounts-vb.md) мы рассматривали, как создать новую учетную запись пользователя в инфраструктуре членства.</span><span class="sxs-lookup"><span data-stu-id="4b992-109">In the <a id="Tutorial05"></a>[preceding tutorial](creating-user-accounts-vb.md) we looked at how to create a new user account in the Membership framework.</span></span> <span data-ttu-id="4b992-110">Сначала мы рассмотрели программное создание учетных записей пользователей с помощью метода `CreateUser` класса `Membership`, а затем проверили с помощью веб-элемента управления CreateUserWizard.</span><span class="sxs-lookup"><span data-stu-id="4b992-110">We first looked at programmatically creating user accounts via the `Membership` class's `CreateUser` method, and then examined using the CreateUserWizard Web control.</span></span> <span data-ttu-id="4b992-111">Однако страница входа в настоящее время проверяет предоставленные учетные данные по жестко закодированному списку пар имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="4b992-111">However, the login page currently validates the supplied credentials against a hard-coded list of username and password pairs.</span></span> <span data-ttu-id="4b992-112">Необходимо обновить логику страницы входа таким образом, чтобы она проверяла учетные данные в хранилище пользователя инфраструктуры членства.</span><span class="sxs-lookup"><span data-stu-id="4b992-112">We need to update the login page's logic so that it validates credentials against the Membership framework's user store.</span></span>

<span data-ttu-id="4b992-113">Подобно созданию учетных записей пользователей, учетные данные можно проверять программно или декларативно.</span><span class="sxs-lookup"><span data-stu-id="4b992-113">Much like with creating user accounts, credentials can be validated programmatically or declaratively.</span></span> <span data-ttu-id="4b992-114">API членства включает метод для программной проверки учетных данных пользователя в хранилище пользователя.</span><span class="sxs-lookup"><span data-stu-id="4b992-114">The Membership API includes a method for programmatically validating a user's credentials against the user store.</span></span> <span data-ttu-id="4b992-115">И ASP.NET поставляется с веб-элементом управления Login, который отображает пользовательский интерфейс с текстовыми полями для имени пользователя и пароля, а также кнопку для входа.</span><span class="sxs-lookup"><span data-stu-id="4b992-115">And ASP.NET ships with the Login Web control, which renders a user interface with textboxes for the username and password and a button to log in.</span></span>

<span data-ttu-id="4b992-116">В этом учебнике мы рассмотрим, как проверить учетные данные пользователя в хранилище пользователей членства с помощью программных средств и элемента управления Login.</span><span class="sxs-lookup"><span data-stu-id="4b992-116">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="4b992-117">Также будет рассмотрена настройка внешнего вида и поведения элемента управления Login.</span><span class="sxs-lookup"><span data-stu-id="4b992-117">We will also look at how to customize the login control's appearance and behavior.</span></span> <span data-ttu-id="4b992-118">Приступим к работе!</span><span class="sxs-lookup"><span data-stu-id="4b992-118">Let's get started!</span></span>

## <a name="step-1-validating-credentials-against-the-membership-user-store"></a><span data-ttu-id="4b992-119">Шаг 1. Проверка учетных данных в хранилище пользователей членства</span><span class="sxs-lookup"><span data-stu-id="4b992-119">Step 1: Validating Credentials Against the Membership User Store</span></span>

<span data-ttu-id="4b992-120">Для веб-сайтов, использующих проверку подлинности с помощью форм, пользователь входит на веб-сайт, посетив страницу входа и вводя свои учетные данные.</span><span class="sxs-lookup"><span data-stu-id="4b992-120">For web sites that use forms authentication, a user logs on to the website by visiting a login page and entering their credentials.</span></span> <span data-ttu-id="4b992-121">Затем эти учетные данные сравниваются с хранилищем пользователя.</span><span class="sxs-lookup"><span data-stu-id="4b992-121">These credentials are then compared against the user store.</span></span> <span data-ttu-id="4b992-122">Если они являются допустимыми, пользователю предоставляется билет проверки подлинности форм, который является маркером безопасности, указывающим удостоверение и подлинность посетителя.</span><span class="sxs-lookup"><span data-stu-id="4b992-122">If they are valid, then the user is granted a forms authentication ticket, which is a security token that indicates the identity and authenticity of the visitor.</span></span>

<span data-ttu-id="4b992-123">Чтобы проверить подлинность пользователя в инфраструктуре членства, используйте [метод`ValidateUser`](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx)класса `Membership`.</span><span class="sxs-lookup"><span data-stu-id="4b992-123">To validate a user against the Membership framework, use the `Membership` class's [`ValidateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx).</span></span> <span data-ttu-id="4b992-124">Метод `ValidateUser` принимает два входных параметра — `username` и `password` — и возвращает логическое значение, указывающее, являются ли учетные данные допустимыми.</span><span class="sxs-lookup"><span data-stu-id="4b992-124">The `ValidateUser` method takes in two input parameters - `username` and `password` - and returns a Boolean value indicating whether the credentials were valid.</span></span> <span data-ttu-id="4b992-125">Как и в случае с `CreateUser`ным методом, который мы рассматривали в предыдущем руководстве, метод `ValidateUser` делегирует фактическую проверку настроенному поставщику членства.</span><span class="sxs-lookup"><span data-stu-id="4b992-125">Like with the `CreateUser` method we examined in the previous tutorial, the `ValidateUser` method delegates the actual validation to the configured Membership provider.</span></span>

<span data-ttu-id="4b992-126">`SqlMembershipProvider` проверяет предоставленные учетные данные, получая пароль указанного пользователя с помощью хранимой процедуры `aspnet_Membership_GetPasswordWithFormat`.</span><span class="sxs-lookup"><span data-stu-id="4b992-126">The `SqlMembershipProvider` validates the supplied credentials by obtaining the specified user's password via the `aspnet_Membership_GetPasswordWithFormat` stored procedure.</span></span> <span data-ttu-id="4b992-127">Помните, что `SqlMembershipProvider` хранит пароли пользователей с помощью одного из трех форматов: Clear, encrypted или Hashed.</span><span class="sxs-lookup"><span data-stu-id="4b992-127">Recall that the `SqlMembershipProvider` stores users' passwords using one of three formats: clear, encrypted, or hashed.</span></span> <span data-ttu-id="4b992-128">Хранимая процедура `aspnet_Membership_GetPasswordWithFormat` возвращает пароль в необработанном формате.</span><span class="sxs-lookup"><span data-stu-id="4b992-128">The `aspnet_Membership_GetPasswordWithFormat` stored procedure returns the password in its raw format.</span></span> <span data-ttu-id="4b992-129">Для зашифрованных или хэшированных паролей `SqlMembershipProvider` преобразует значение `password`, передаваемое в метод `ValidateUser`, в эквивалентное ему зашифрованное или хэшированное состояние, а затем сравнивает его с тем, что было возвращено из базы данных.</span><span class="sxs-lookup"><span data-stu-id="4b992-129">For encrypted or hashed passwords, the `SqlMembershipProvider` transforms the `password` value passed into the `ValidateUser` method into its equivalent encrypted or hashed state and then compares it with what was returned from the database.</span></span> <span data-ttu-id="4b992-130">Если пароль, хранящийся в базе данных, соответствует форматированному паролю, введенному пользователем, то учетные данные являются действительными.</span><span class="sxs-lookup"><span data-stu-id="4b992-130">If the password stored in the database matches the formatted password entered by the user, the credentials are valid.</span></span>

<span data-ttu-id="4b992-131">Давайте изменим страницу входа (~/`Login.aspx`), чтобы она проверяла предоставленные учетные данные в хранилище пользователя инфраструктуры членства.</span><span class="sxs-lookup"><span data-stu-id="4b992-131">Let's update our login page (~/`Login.aspx`) so that it validates the supplied credentials against the Membership framework user store.</span></span> <span data-ttu-id="4b992-132">Мы создали эту страницу входа обратно в <a id="Tutorial02"> </a>обзоре учебника по [*проверке подлинности*](../introduction/an-overview-of-forms-authentication-vb.md) с помощью форм, создав интерфейс с двумя текстовыми полями для имени пользователя и пароля, флажок Запомнить учетные данные и кнопку входа (см. рис. 1).</span><span class="sxs-lookup"><span data-stu-id="4b992-132">We created this login page back in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial, creating an interface with two TextBoxes for the username and password, a Remember Me checkbox, and a Login button (see Figure 1).</span></span> <span data-ttu-id="4b992-133">Код проверяет указанные учетные данные по жестко закодированному списку пар "имя пользователя и пароль" (Скотт/Password, Цзисунь/пароль, SAM/Password).</span><span class="sxs-lookup"><span data-stu-id="4b992-133">The code validates the entered credentials against a hard-coded list of username and password pairs (Scott/password, Jisun/password, and Sam/password).</span></span> <span data-ttu-id="4b992-134"><a id="Tutorial03"> </a>В учебнике [*Настройка проверки подлинности с помощью форм и дополнительные разделы*](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md) мы обновили код страницы входа для хранения дополнительных сведений в свойстве `UserData` билета проверки подлинности на формах.</span><span class="sxs-lookup"><span data-stu-id="4b992-134">In the <a id="Tutorial03"></a>[*Forms Authentication Configuration and Advanced Topics*](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md) tutorial we updated the login page's code to store additional information in the forms authentication ticket's `UserData` property.</span></span>

<span data-ttu-id="4b992-135">[![интерфейс страницы входа содержит два текстовых поля, CheckBoxList и кнопку](validating-user-credentials-against-the-membership-user-store-vb/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="4b992-135">[![The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button](validating-user-credentials-against-the-membership-user-store-vb/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image1.png)</span></span>

<span data-ttu-id="4b992-136">**Рис. 1**. интерфейс страницы входа содержит два текстовых поля, CheckBoxList и кнопку ([щелкните, чтобы просмотреть изображение с полным размером](validating-user-credentials-against-the-membership-user-store-vb/_static/image3.png)).</span><span class="sxs-lookup"><span data-stu-id="4b992-136">**Figure 1**: The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image3.png))</span></span>

<span data-ttu-id="4b992-137">Пользовательский интерфейс страницы входа может остаться неизменным, но необходимо заменить обработчик событий `Click` кнопки входа на код, проверяющий пользователя в соответствии с хранилищем пользователей инфраструктуры членства.</span><span class="sxs-lookup"><span data-stu-id="4b992-137">The login page's user interface can remain unchanged, but we need to replace the Login button's `Click` event handler with code that validates the user against the Membership framework user store.</span></span> <span data-ttu-id="4b992-138">Обновите обработчик событий таким образом, чтобы его код выявлялся следующим образом:</span><span class="sxs-lookup"><span data-stu-id="4b992-138">Update the event handler so that its code appears as follows:</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample1.vb)]

<span data-ttu-id="4b992-139">Этот код очень прост.</span><span class="sxs-lookup"><span data-stu-id="4b992-139">This code is remarkably simple.</span></span> <span data-ttu-id="4b992-140">Начнем с вызова метода `Membership.ValidateUser`, передав предоставленные имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="4b992-140">We start by calling the `Membership.ValidateUser` method, passing in the supplied username and password.</span></span> <span data-ttu-id="4b992-141">Если этот метод возвращает значение true, то пользователь подписывается на сайт с помощью метода RedirectFromLoginPage класса `FormsAuthentication`.</span><span class="sxs-lookup"><span data-stu-id="4b992-141">If that method returns True, then the user is signed into the site via the `FormsAuthentication` class's RedirectFromLoginPage method.</span></span> <span data-ttu-id="4b992-142">(Как мы обсуждали в <a id="Tutorial02"> </a> [*обзоре учебника по проверке подлинности*](../introduction/an-overview-of-forms-authentication-vb.md) с помощью форм, `FormsAuthentication.RedirectFromLoginPage` создает билет проверки подлинности с помощью форм, а затем перенаправляет пользователя на соответствующую страницу.) Однако если учетные данные недействительны, отображается метка `InvalidCredentialsMessage`, информирующее пользователя о неправильном имени пользователя или пароле.</span><span class="sxs-lookup"><span data-stu-id="4b992-142">(As we discussed in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial, the `FormsAuthentication.RedirectFromLoginPage` creates the forms authentication ticket and then redirects the user to the appropriate page.) If the credentials are invalid, however, the `InvalidCredentialsMessage` Label is displayed, informing the user that their username or password was incorrect.</span></span>

<span data-ttu-id="4b992-143">Вот и все!</span><span class="sxs-lookup"><span data-stu-id="4b992-143">That's all there is to it!</span></span>

<span data-ttu-id="4b992-144">Чтобы проверить, правильно работает страница входа, попробуйте войти с помощью одной из учетных записей пользователя, созданных в предыдущем руководстве.</span><span class="sxs-lookup"><span data-stu-id="4b992-144">To test that the login page works as expected, attempt to login with one of the user accounts you created in the preceding tutorial.</span></span> <span data-ttu-id="4b992-145">Если вы еще не создали учетную запись, создайте ее на странице `~/Membership/CreatingUserAccounts.aspx`.</span><span class="sxs-lookup"><span data-stu-id="4b992-145">Or, if you have not yet created an account, go ahead and create one from the `~/Membership/CreatingUserAccounts.aspx` page.</span></span>

> [!NOTE]
> <span data-ttu-id="4b992-146">Когда пользователь вводит свои учетные данные и отправляет форму страницы входа, учетные данные, включая пароль, передаются через Интернет на веб-сервер в *виде обычного текста*.</span><span class="sxs-lookup"><span data-stu-id="4b992-146">When the user enters her credentials and submits the login page form, the credentials, including her password, are transmitted over the Internet to the web server in *plain text*.</span></span> <span data-ttu-id="4b992-147">Это означает, что любой злоумышленник, прослушивать сетевой трафик, может видеть имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="4b992-147">That means any hacker sniffing the network traffic can see the username and password.</span></span> <span data-ttu-id="4b992-148">Чтобы избежать этого, важно зашифровать сетевой трафик с помощью [SSL](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span><span class="sxs-lookup"><span data-stu-id="4b992-148">To prevent this, it is essential to encrypt the network traffic by using [Secure Socket Layers (SSL)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span></span> <span data-ttu-id="4b992-149">Это гарантирует, что учетные данные (а также все HTML-разметка страницы) будут зашифрованы с момента выхода из браузера, пока они не будут получены веб-сервером.</span><span class="sxs-lookup"><span data-stu-id="4b992-149">This will ensure that the credentials (as well as the entire page's HTML markup) are encrypted from the moment they leave the browser until they are received by the web server.</span></span>

### <a name="how-the-membership-framework-handles-invalid-login-attempts"></a><span data-ttu-id="4b992-150">Как инфраструктура членства обрабатывает недопустимые попытки входа</span><span class="sxs-lookup"><span data-stu-id="4b992-150">How the Membership Framework Handles Invalid Login Attempts</span></span>

<span data-ttu-id="4b992-151">Когда посетитель достигает страницы входа и отправляет свои учетные данные, браузер отправляет запрос HTTP на страницу входа.</span><span class="sxs-lookup"><span data-stu-id="4b992-151">When a visitor reaches the login page and submits their credentials, their browser makes an HTTP request to the login page.</span></span> <span data-ttu-id="4b992-152">Если учетные данные допустимы, HTTP-ответ содержит билет проверки подлинности в файле cookie.</span><span class="sxs-lookup"><span data-stu-id="4b992-152">If the credentials are valid, the HTTP response includes the authentication ticket in a cookie.</span></span> <span data-ttu-id="4b992-153">Таким образом, злоумышленник, пытающийся перейти на ваш сайт, может создать программу, которая последовательно отправляет HTTP-запросы на страницу входа с допустимым именем пользователя и предположением пароля.</span><span class="sxs-lookup"><span data-stu-id="4b992-153">Therefore, a hacker attempting to break into your site could create a program that exhaustively sends HTTP requests to the login page with a valid username and a guess at the password.</span></span> <span data-ttu-id="4b992-154">Если предположение пароля правильное, страница входа будет возвращать файл cookie билета проверки подлинности, после чего программа знает, что она трудностями по допустимой паре имени пользователя и пароля.</span><span class="sxs-lookup"><span data-stu-id="4b992-154">If the password guess is correct, the login page will return the authentication ticket cookie, at which point the program knows it has stumbled upon a valid username/password pair.</span></span> <span data-ttu-id="4b992-155">С помощью принудительного подбора такая программа может наткнулись на пароль пользователя, особенно в том случае, если пароль слабый.</span><span class="sxs-lookup"><span data-stu-id="4b992-155">Through brute force, such a program might be able to stumble upon a user's password, especially if the password is weak.</span></span>

<span data-ttu-id="4b992-156">Чтобы предотвратить подобные атаки методом подбора, инфраструктура членства блокирует пользователя, если имеется определенное количество неудачных попыток входа в течение определенного периода времени.</span><span class="sxs-lookup"><span data-stu-id="4b992-156">To prevent such brute force attacks, the Membership framework locks out a user if there are a certain number of unsuccessful login attempts within a certain period of time.</span></span> <span data-ttu-id="4b992-157">Точные параметры настраиваются с помощью следующих двух параметров конфигурации поставщика членства:</span><span class="sxs-lookup"><span data-stu-id="4b992-157">The exact parameters are configurable through the following two Membership provider configuration settings:</span></span>

- <span data-ttu-id="4b992-158">`maxInvalidPasswordAttempts` — указывает, сколько недопустимых попыток ввода пароля разрешено для пользователя в течение периода времени, по истечении которого учетная запись блокируется. Значение по умолчанию — 5.</span><span class="sxs-lookup"><span data-stu-id="4b992-158">`maxInvalidPasswordAttempts` - specifies how many invalid password attempts are allowed for the user within the time period before the account is locked out. The default value is 5.</span></span>
- <span data-ttu-id="4b992-159">`passwordAttemptWindow` — указывает период времени в минутах, в течение которого указанное число неудачных попыток входа в систему приведет к блокировке учетной записи. Значение по умолчанию — 10.</span><span class="sxs-lookup"><span data-stu-id="4b992-159">`passwordAttemptWindow` - indicates the time period in minutes during which the specified number of invalid login attempts will cause the account to be locked out. The default value is 10.</span></span>

<span data-ttu-id="4b992-160">Если пользователь заблокирован, он не может войти в систему, пока администратор не разблокирует свою учетную запись.</span><span class="sxs-lookup"><span data-stu-id="4b992-160">If a user has been locked out, she cannot login until an administrator unlocks her account.</span></span> <span data-ttu-id="4b992-161">Когда пользователь заблокирован, метод `ValidateUser` *всегда* будет возвращать `False`, даже если предоставлены действительные учетные данные.</span><span class="sxs-lookup"><span data-stu-id="4b992-161">When a user is locked out, the `ValidateUser` method will *always* return `False`, even if valid credentials are supplied.</span></span> <span data-ttu-id="4b992-162">Хотя такое поведение уменьшает вероятность того, что злоумышленник будет разбиваться на ваш сайт с помощью методов подбора, он может завершить блокировку допустимого пользователя, который просто забыл пароль или случайно заблокировал блокировку или имеет неверный день ввода.</span><span class="sxs-lookup"><span data-stu-id="4b992-162">While this behavior lessens the likelihood that a hacker will break into your site through brute force methods, it can end up locking out a valid user who has simply forgotten her password or accidentally has the Caps Lock on or is having a bad typing day.</span></span>

<span data-ttu-id="4b992-163">К сожалению, нет встроенного средства для разблокировки учетной записи пользователя.</span><span class="sxs-lookup"><span data-stu-id="4b992-163">Unfortunately, there is no built-in tool for unlocking a user account.</span></span> <span data-ttu-id="4b992-164">Чтобы разблокировать учетную запись, можно изменить базу данных напрямую — изменить `IsLockedOut` поле в таблице `aspnet_Membership` для соответствующей учетной записи пользователя или создать веб-интерфейс, содержащий заблокированные учетные записи с параметрами для их разблокировки.</span><span class="sxs-lookup"><span data-stu-id="4b992-164">In order to unlock an account, you can modify the database directly - change the `IsLockedOut` field in the `aspnet_Membership` table for the appropriate user account - or create a web-based interface that lists locked out accounts with options to unlock them.</span></span> <span data-ttu-id="4b992-165">Мы рассмотрим создание административных интерфейсов для выполнения общих задач, связанных с учетными записями и ролями пользователей, в будущем руководстве.</span><span class="sxs-lookup"><span data-stu-id="4b992-165">We will examine creating administrative interfaces for accomplishing common user account- and role-related tasks in a future tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="4b992-166">Недостаток метода `ValidateUser` заключается в том, что когда предоставленные учетные данные недопустимы, они не предоставляют объяснения, почему.</span><span class="sxs-lookup"><span data-stu-id="4b992-166">One downside of the `ValidateUser` method is that when the supplied credentials are invalid, it does not provide any explanation as to why.</span></span> <span data-ttu-id="4b992-167">Учетные данные могут быть недопустимыми, так как в хранилище пользователя отсутствует совпадающая пара имя пользователя и пароль или пользователь не был утвержден или пользователь заблокирован. На этапе 4 мы покажем, как показать пользователю более подробное сообщение при неудачной попытке входа.</span><span class="sxs-lookup"><span data-stu-id="4b992-167">The credentials may be invalid because there is no matching username/password pair in the user store, or because the user has not yet been approved, or because the user has been locked out. In Step 4 we will see how to show a more detailed message to the user when their login attempt fails.</span></span>

## <a name="step-2-collecting-credentials-through-the-login-web-control"></a><span data-ttu-id="4b992-168">Шаг 2. сбор учетных данных с помощью веб-элемента управления Login</span><span class="sxs-lookup"><span data-stu-id="4b992-168">Step 2: Collecting Credentials through the Login Web Control</span></span>

<span data-ttu-id="4b992-169">[Веб-элемент управления Login](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) визуализирует пользовательский интерфейс по умолчанию, очень похожий на тот, который мы <a id="Tutorial02"> </a>создали в обзоре учебника по [*проверке подлинности*](../introduction/an-overview-of-forms-authentication-vb.md) с помощью форм.</span><span class="sxs-lookup"><span data-stu-id="4b992-169">The [Login Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) renders a default user interface very similar to the one we created back in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial.</span></span> <span data-ttu-id="4b992-170">Использование элемента управления Login позволяет нам создавать интерфейс для получения учетных данных посетителя.</span><span class="sxs-lookup"><span data-stu-id="4b992-170">Using the Login control saves us the work of having to create the interface to collect the visitor's credentials.</span></span> <span data-ttu-id="4b992-171">Более того, элемент управления Login автоматически подписывает пользователя (предполагая, что предоставленные учетные данные действительны), тем самым экономя от необходимости писать код.</span><span class="sxs-lookup"><span data-stu-id="4b992-171">Moreover, the Login control automatically signs in the user (assuming the submitted credentials are valid), thereby saving us from having to write any code.</span></span>

<span data-ttu-id="4b992-172">Попробуем обновить `Login.aspx`, заменив вручную созданный интерфейс и код элементом управления Login.</span><span class="sxs-lookup"><span data-stu-id="4b992-172">Let's update `Login.aspx`, replacing the manually created interface and code with a Login control.</span></span> <span data-ttu-id="4b992-173">Начните с удаления существующей разметки и кода в `Login.aspx`.</span><span class="sxs-lookup"><span data-stu-id="4b992-173">Start by removing the existing markup and code in `Login.aspx`.</span></span> <span data-ttu-id="4b992-174">Вы можете удалить это право или просто закомментировать его. Чтобы закомментировать декларативную разметку, заключите ее в `<%--` и `--%>` разделители.</span><span class="sxs-lookup"><span data-stu-id="4b992-174">You may delete it outright, or simply comment it out. To comment out declarative markup, surround it with the `<%--` and `--%>` delimiters.</span></span> <span data-ttu-id="4b992-175">Эти разделители можно вводить вручную, или, как показано на рис. 2, можно выбрать текст для комментирования и щелкнуть значок закомментировать выбранные строки на панели инструментов.</span><span class="sxs-lookup"><span data-stu-id="4b992-175">You can enter these delimiters manually, or, as Figure 2 shows, you may select the text to comment out and then click the Comment out the selected lines icon in the Toolbar.</span></span> <span data-ttu-id="4b992-176">Аналогичным образом можно использовать закомментировать значок выбранные строки, чтобы закомментировать выбранный код в классе кода программной части.</span><span class="sxs-lookup"><span data-stu-id="4b992-176">Similarly, you can use the Comment out the selected lines icon to comment out the selected code in the code-behind class.</span></span>

<span data-ttu-id="4b992-177">[![закомментировать существующую декларативную разметку и исходный код в файле Login. aspx](validating-user-credentials-against-the-membership-user-store-vb/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="4b992-177">[![Comment Out the Existing Declarative Markup and Source Code in Login.aspx](validating-user-credentials-against-the-membership-user-store-vb/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image4.png)</span></span>

<span data-ttu-id="4b992-178">**Рис. 2**. Добавление в комментарий существующей декларативной разметки и исходного кода в файле Login. aspx ([щелкните, чтобы просмотреть изображение с полным размером](validating-user-credentials-against-the-membership-user-store-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="4b992-178">**Figure 2**: Comment Out the Existing Declarative Markup and Source Code in Login.aspx  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image6.png))</span></span>

> [!NOTE]
> <span data-ttu-id="4b992-179">При просмотре декларативной разметки в Visual Studio 2005 значок выбранные строки недоступен.</span><span class="sxs-lookup"><span data-stu-id="4b992-179">The Comment out the selected lines icon is not available when viewing the declarative markup in Visual Studio 2005.</span></span> <span data-ttu-id="4b992-180">Если Visual Studio 2008 не используется, потребуется вручную добавить `<%--` и `--%>` разделители.</span><span class="sxs-lookup"><span data-stu-id="4b992-180">If you are not using Visual Studio 2008 you will need to manually add the `<%--` and `--%>` delimiters.</span></span>

<span data-ttu-id="4b992-181">Затем перетащите элемент управления Login с панели элементов на страницу и задайте для свойства `ID` значение `myLogin`.</span><span class="sxs-lookup"><span data-stu-id="4b992-181">Next, drag a Login control from the Toolbox on to the page and set its `ID` property to `myLogin`.</span></span> <span data-ttu-id="4b992-182">На этом этапе экран должен выглядеть примерно так, как показано на рис. 3.</span><span class="sxs-lookup"><span data-stu-id="4b992-182">At this point your screen should look similar to Figure 3.</span></span> <span data-ttu-id="4b992-183">Обратите внимание, что интерфейс по умолчанию элемента управления Login включает в себя элементы управления TextBox для имени пользователя и пароля, флажок Запомнить меня в следующий раз и кнопку войти в систему.</span><span class="sxs-lookup"><span data-stu-id="4b992-183">Note that the Login control's default interface includes TextBox controls for the username and password, a Remember me next time CheckBox, and a Log In Button.</span></span> <span data-ttu-id="4b992-184">Есть также `RequiredFieldValidator` элементы управления для двух текстовых полей.</span><span class="sxs-lookup"><span data-stu-id="4b992-184">There are also `RequiredFieldValidator` controls for the two TextBoxes.</span></span>

<span data-ttu-id="4b992-185">[![добавить элемент управления Login на страницу](validating-user-credentials-against-the-membership-user-store-vb/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="4b992-185">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-vb/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image7.png)</span></span>

<span data-ttu-id="4b992-186">**Рис. 3**. Добавление элемента управления Login на страницу ([щелкните, чтобы просмотреть изображение с полным размером](validating-user-credentials-against-the-membership-user-store-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="4b992-186">**Figure 3**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image9.png))</span></span>

<span data-ttu-id="4b992-187">И все готово!</span><span class="sxs-lookup"><span data-stu-id="4b992-187">And we're done!</span></span> <span data-ttu-id="4b992-188">При нажатии кнопки входа в систему элемента управления Login произойдет обратная передача, и элемент управления Login вызовет метод `Membership.ValidateUser`, передавая ему указанное имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="4b992-188">When the Login control's Log In button is clicked, a postback will occur and the Login control will call the `Membership.ValidateUser` method, passing in the entered username and password.</span></span> <span data-ttu-id="4b992-189">Если учетные данные недопустимы, элемент управления Login отображает сообщение, уведомляющее об этом.</span><span class="sxs-lookup"><span data-stu-id="4b992-189">If the credentials are invalid, the Login control displays a message stating such.</span></span> <span data-ttu-id="4b992-190">Однако если учетные данные действительны, то элемент управления Login создает билет проверки подлинности форм и перенаправляет пользователя на соответствующую страницу.</span><span class="sxs-lookup"><span data-stu-id="4b992-190">If, however, the credentials are valid, then the Login control creates the forms authentication ticket and redirects the user to the appropriate page.</span></span>

<span data-ttu-id="4b992-191">Элемент управления Login использует четыре фактора для определения соответствующей страницы для перенаправления пользователя при успешном входе:</span><span class="sxs-lookup"><span data-stu-id="4b992-191">The Login control uses four factors to determine the appropriate page to redirect the user to upon a successful login:</span></span>

- <span data-ttu-id="4b992-192">Указывает, находится ли элемент управления Login на странице входа, как определено `loginUrl` параметром в конфигурации проверки подлинности с помощью форм. значение по умолчанию этого параметра — `Login.aspx`</span><span class="sxs-lookup"><span data-stu-id="4b992-192">Whether the Login control is on the login page as defined by `loginUrl` setting in the forms authentication configuration; this setting's default value is `Login.aspx`</span></span>
- <span data-ttu-id="4b992-193">Присутствие параметра строки запроса `ReturnUrl`</span><span class="sxs-lookup"><span data-stu-id="4b992-193">The presence of a `ReturnUrl` querystring parameter</span></span>
- <span data-ttu-id="4b992-194">Значение [свойства`DestinationUrl`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx) элемента управления Login</span><span class="sxs-lookup"><span data-stu-id="4b992-194">The value of the Login control's [`DestinationUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx)</span></span>
- <span data-ttu-id="4b992-195">Значение `defaultUrl`, указанное в параметрах конфигурации проверки подлинности с помощью форм; по умолчанию этот параметр имеет значение Default. aspx.</span><span class="sxs-lookup"><span data-stu-id="4b992-195">The `defaultUrl` value specified in the forms authentication configuration settings; this setting's default value is Default.aspx</span></span>

<span data-ttu-id="4b992-196">На рис. 4 показано, как элемент управления Login использует эти четыре параметра для получения соответствующего решения страницы.</span><span class="sxs-lookup"><span data-stu-id="4b992-196">Figure 4 depicts the how the Login control uses these four parameters to arrive at its appropriate page decision.</span></span>

<span data-ttu-id="4b992-197">[![добавить элемент управления Login на страницу](validating-user-credentials-against-the-membership-user-store-vb/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="4b992-197">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-vb/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image10.png)</span></span>

<span data-ttu-id="4b992-198">**Рис. 4**. Добавление элемента управления Login на страницу ([щелкните, чтобы просмотреть изображение с полным размером](validating-user-credentials-against-the-membership-user-store-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="4b992-198">**Figure 4**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image12.png))</span></span>

<span data-ttu-id="4b992-199">Уделите время на тестирование элемента управления Login, посетив сайт в браузере и войдя в систему в качестве существующего пользователя в инфраструктуре членства.</span><span class="sxs-lookup"><span data-stu-id="4b992-199">Take a moment to test out the Login control by visiting the site through a browser and logging in as an existing user in the Membership framework.</span></span>

<span data-ttu-id="4b992-200">Отображаемый интерфейс элемента управления Login имеет широкие возможности настройки.</span><span class="sxs-lookup"><span data-stu-id="4b992-200">The Login control's rendered interface is highly configurable.</span></span> <span data-ttu-id="4b992-201">Существует ряд свойств, влияющих на его внешний вид. более того, элемент управления Login можно преобразовать в шаблон для точного управления макетом элементов пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="4b992-201">There are a number of properties that influence its appearance; what's more, the Login control can be converted into a template for precise control over the layout the user interface elements.</span></span> <span data-ttu-id="4b992-202">В оставшейся части этого шага рассматривается настройка внешнего вида и макета.</span><span class="sxs-lookup"><span data-stu-id="4b992-202">The remainder of this step examines how to customize the appearance and layout.</span></span>

### <a name="customizing-the-login-controls-appearance"></a><span data-ttu-id="4b992-203">Настройка внешнего вида элемента управления Login</span><span class="sxs-lookup"><span data-stu-id="4b992-203">Customizing the Login Control's Appearance</span></span>

<span data-ttu-id="4b992-204">Параметры свойства по умолчанию для элемента управления Login отображают пользовательский интерфейс с заголовком (вход), TextBox и элементом управления Label для ввода имени пользователя и пароля, флажок Запомнить меня в следующий раз и кнопку Вход в систему.</span><span class="sxs-lookup"><span data-stu-id="4b992-204">The Login control's default property settings render a user interface with a title ( Log In ), TextBox and Label controls for the username and password inputs, a Remember me next time CheckBox, and a Log In button.</span></span> <span data-ttu-id="4b992-205">Внешний вид этих элементов можно настроить с помощью многочисленных свойств элемента управления Login.</span><span class="sxs-lookup"><span data-stu-id="4b992-205">The appearances of these elements are all configurable through the Login control's numerous properties.</span></span> <span data-ttu-id="4b992-206">Кроме того, дополнительные элементы пользовательского интерфейса, например ссылка на страницу для создания новой учетной записи пользователя, можно добавить, задав свойство или два.</span><span class="sxs-lookup"><span data-stu-id="4b992-206">Furthermore, additional user interface elements - such as a link to a page to create a new user account - can be added by setting a property or two.</span></span>

<span data-ttu-id="4b992-207">Подождите несколько секунд, чтобы Гусси внешний вид элемента управления входом.</span><span class="sxs-lookup"><span data-stu-id="4b992-207">Let's spend a few moments to gussy up the appearance of our Login control.</span></span> <span data-ttu-id="4b992-208">Поскольку страница `Login.aspx` уже содержит текст в верхней части страницы с текстом Login, заголовок элемента управления Login является излишним.</span><span class="sxs-lookup"><span data-stu-id="4b992-208">Since the `Login.aspx` page already has text at the top of the page that says Login, the Login control's title is superfluous.</span></span> <span data-ttu-id="4b992-209">Таким образом, очистите значение [свойства`TitleText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) , чтобы удалить заголовок элемента управления Login.</span><span class="sxs-lookup"><span data-stu-id="4b992-209">Therefore, clear out the [`TitleText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) value in order to remove the Login control's title.</span></span>

<span data-ttu-id="4b992-210">Метки имя пользователя: и пароль: слева от двух элементов управления TextBox можно настроить с помощью свойств [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) и [`PasswordLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx)соответственно.</span><span class="sxs-lookup"><span data-stu-id="4b992-210">The User Name: and Password: Labels to the left of the two TextBox controls can be customized through the [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) and [`PasswordLabelText` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx), respectively.</span></span> <span data-ttu-id="4b992-211">Давайте изменим имя пользователя: метка на чтение имя пользователя:.</span><span class="sxs-lookup"><span data-stu-id="4b992-211">Let's change the User Name: Label to read Username:.</span></span> <span data-ttu-id="4b992-212">Стили меток и текстовых полей можно настраивать с помощью свойств [`LabelStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) и [`TextBoxStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx)соответственно.</span><span class="sxs-lookup"><span data-stu-id="4b992-212">The Label and TextBox styles are configurable through the [`LabelStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) and [`TextBoxStyle` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx), respectively.</span></span>

<span data-ttu-id="4b992-213">Свойство Text этого флажка Запомнить время может быть задано с помощью [свойства`RememberMeText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx)элемента управления Login, и его состояние по умолчанию можно настроить с помощью [Свойства`RememberMeSet`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx) (значение по умолчанию — false).</span><span class="sxs-lookup"><span data-stu-id="4b992-213">The Remember me next time CheckBox's Text property can be set through the Login control's [`RememberMeText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx), and its default checked state is configurable through the [`RememberMeSet` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx) (which defaults to False).</span></span> <span data-ttu-id="4b992-214">Присвойте свойству `RememberMeSet` значение true, чтобы флажок Запомнить меня в следующий раз проверялся по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="4b992-214">Go ahead and set the `RememberMeSet` property to True so that the Remember me next time CheckBox will be checked by default.</span></span>

<span data-ttu-id="4b992-215">Элемент управления Login предлагает два свойства для настройки макета элементов управления пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="4b992-215">The Login control offers two properties for adjusting the layout of its user interface controls.</span></span> <span data-ttu-id="4b992-216">[Свойство`TextLayout`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx) указывает, отображаются ли метки username: и Password: слева от соответствующих текстовых полей (по умолчанию) или над ними.</span><span class="sxs-lookup"><span data-stu-id="4b992-216">The [`TextLayout` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx) indicates whether the Username: and Password: Labels appear to the left of their corresponding TextBoxes (the default), or above them.</span></span> <span data-ttu-id="4b992-217">[Свойство`Orientation`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx) указывает, расположены ли входные данные имени пользователя и пароля по вертикали (один над другим) или по горизонтали.</span><span class="sxs-lookup"><span data-stu-id="4b992-217">The [`Orientation` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx) indicates whether the username and password inputs are situated vertically (one above the other) or horizontally.</span></span> <span data-ttu-id="4b992-218">Я собираюсь оставить эти два свойства по умолчанию, но я рекомендую попробовать установить эти два свойства в значения, отличные от значений по умолчанию, чтобы увидеть полученный результат.</span><span class="sxs-lookup"><span data-stu-id="4b992-218">I am going to leave these two properties set to their defaults, but I encourage you to try setting these two properties to their non-default values to see the resulting effect.</span></span>

> [!NOTE]
> <span data-ttu-id="4b992-219">В следующем разделе Настройка макета элемента управления Login будет рассмотрено использование шаблонов для определения точного макета элементов пользовательского интерфейса элемента управления макета.</span><span class="sxs-lookup"><span data-stu-id="4b992-219">In the next section, Configuring the Login Control's Layout, we will look at using templates to define the precise layout of the Layout control's user interface elements.</span></span>

<span data-ttu-id="4b992-220">Заключить параметры свойств элемента управления для входа, установив для свойств [`CreateUserText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) и [`CreateUserUrl`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) значение "еще не зарегистрировано"?</span><span class="sxs-lookup"><span data-stu-id="4b992-220">Wrap up the Login control's property settings by setting the [`CreateUserText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) and [`CreateUserUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) to Not registered yet?</span></span> <span data-ttu-id="4b992-221">Создайте учетную запись.</span><span class="sxs-lookup"><span data-stu-id="4b992-221">Create an account!</span></span> <span data-ttu-id="4b992-222">и `~/Membership/CreatingUserAccounts.aspx`соответственно.</span><span class="sxs-lookup"><span data-stu-id="4b992-222">and `~/Membership/CreatingUserAccounts.aspx`, respectively.</span></span> <span data-ttu-id="4b992-223">При этом добавляется гиперссылка на интерфейс элемента управления Login, указывающий на страницу, <a id="Tutorial05"> </a>созданную в [предыдущем руководстве](creating-user-accounts-vb.md).</span><span class="sxs-lookup"><span data-stu-id="4b992-223">This adds a hyperlink to the Login control's interface pointing to the page we created in the <a id="Tutorial05"></a>[preceding tutorial](creating-user-accounts-vb.md).</span></span> <span data-ttu-id="4b992-224">Свойства [`HelpPageText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) и [`HelpPageUrl`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) элемента управления Login, а также свойства [`PasswordRecoveryText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) и [`PasswordRecoveryUrl`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx) работают аналогичным образом, выводят ссылки на страницу справки и страницу восстановления пароля.</span><span class="sxs-lookup"><span data-stu-id="4b992-224">The Login control's [`HelpPageText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) and [`HelpPageUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) and [`PasswordRecoveryText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) and [`PasswordRecoveryUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx) work in the same manner, rendering links to a help page and a password recovery page.</span></span>

<span data-ttu-id="4b992-225">После внесения этих изменений в свойства декларативная разметка и внешний вид элемента управления входа должны выглядеть примерно так, как показано на рис. 5.</span><span class="sxs-lookup"><span data-stu-id="4b992-225">After making these property changes, your Login control's declarative markup and appearance should look similar to that shown in Figure 5.</span></span>

<span data-ttu-id="4b992-226">[![значения свойств элемента управления Login определяют его внешний вид](validating-user-credentials-against-the-membership-user-store-vb/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="4b992-226">[![The Login Control's Properties' Values Dictate Its Appearance](validating-user-credentials-against-the-membership-user-store-vb/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image13.png)</span></span>

<span data-ttu-id="4b992-227">**Рис. 5**. значения свойств элемента управления для входа определяют его внешний вид ([щелкните, чтобы просмотреть изображение с полным размером](validating-user-credentials-against-the-membership-user-store-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="4b992-227">**Figure 5**: The Login Control's Properties' Values Dictate Its Appearance  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image15.png))</span></span>

### <a name="configuring-the-login-controls-layout"></a><span data-ttu-id="4b992-228">Настройка макета элемента управления Login</span><span class="sxs-lookup"><span data-stu-id="4b992-228">Configuring the Login Control's Layout</span></span>

<span data-ttu-id="4b992-229">Пользовательский интерфейс веб-элемента управления Login по умолчанию располагает интерфейсом в HTML-`<table>`.</span><span class="sxs-lookup"><span data-stu-id="4b992-229">The Login Web control's default user interface lays out the interface in an HTML `<table>`.</span></span> <span data-ttu-id="4b992-230">Но что делать, если нам нужен более точный контроль над отображаемыми выходными данными?</span><span class="sxs-lookup"><span data-stu-id="4b992-230">But what if we need finer control over the rendered output?</span></span> <span data-ttu-id="4b992-231">Возможно, мы хотим заменить `<table>` на ряд тегов `<div>`.</span><span class="sxs-lookup"><span data-stu-id="4b992-231">Maybe we want to replace the `<table>` with a series of `<div>` tags.</span></span> <span data-ttu-id="4b992-232">Или что делать, если нашему приложению требуются дополнительные учетные данные для проверки подлинности?</span><span class="sxs-lookup"><span data-stu-id="4b992-232">Or what if our application requires additional credentials for authentication?</span></span> <span data-ttu-id="4b992-233">Многие финансовые веб-сайты, например, должны предоставлять пользователям не только имя пользователя и пароль, но и персональный идентификационный номер (ПИН-код) или другие идентификационные данные.</span><span class="sxs-lookup"><span data-stu-id="4b992-233">Many financial websites, for instance, require users to supply not only a username and password, but also a Personal Identification Number (PIN), or other identifying information.</span></span> <span data-ttu-id="4b992-234">По каким-либо причинам можно преобразовать элемент управления Login в шаблон, из которого мы можем явно определить декларативную разметку интерфейса.</span><span class="sxs-lookup"><span data-stu-id="4b992-234">Whatever the reasons may be, it is possible to convert the Login control into a template, from which we can explicitly define the interface's declarative markup.</span></span>

<span data-ttu-id="4b992-235">Чтобы обновить элемент управления Login для получения дополнительных учетных данных, необходимо выполнить две операции:</span><span class="sxs-lookup"><span data-stu-id="4b992-235">We need to do two things in order to update the Login control to collect additional credentials:</span></span>

1. <span data-ttu-id="4b992-236">Обновите интерфейс элемента управления входа, чтобы включить веб-элементы управления для получения дополнительных учетных данных.</span><span class="sxs-lookup"><span data-stu-id="4b992-236">Update the Login control's interface to include Web control(s) to collect the additional credentials.</span></span>
2. <span data-ttu-id="4b992-237">Переопределите внутреннюю логику проверки подлинности элемента управления Login, чтобы пользователь прошел проверку подлинности только в том случае, если его имя пользователя и пароль действительны, а их дополнительные учетные данные являются действительными.</span><span class="sxs-lookup"><span data-stu-id="4b992-237">Override the Login control's internal authentication logic so that a user is only authenticated if their username and password is valid and their additional credentials are valid, too.</span></span>

<span data-ttu-id="4b992-238">Чтобы выполнить первую задачу, необходимо преобразовать элемент управления Login в шаблон и добавить необходимые веб-элементы управления.</span><span class="sxs-lookup"><span data-stu-id="4b992-238">To accomplish the first task, we need to convert the Login control into a template and add the necessary Web controls.</span></span> <span data-ttu-id="4b992-239">Как и для второй задачи, логику проверки подлинности элемента управления входа можно заменить путем создания обработчика событий для [события`Authenticate`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx)элемента управления.</span><span class="sxs-lookup"><span data-stu-id="4b992-239">As for the second task, the Login control's authentication logic can be superseded by creating an event handler for the control's [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span>

<span data-ttu-id="4b992-240">Давайте изменим элемент управления Login таким образом, чтобы он задавал пользователю запрос на ввод имени пользователя, пароля и адреса электронной почты и прошел проверку подлинности только в том случае, если указанный адрес электронной почты совпадает с адресом электронной почты в файле.</span><span class="sxs-lookup"><span data-stu-id="4b992-240">Let's update the Login control so that it prompts users for their username, password, and email address and only authenticates the user if the email address supplied matches their email address on file.</span></span> <span data-ttu-id="4b992-241">Сначала необходимо преобразовать интерфейс элемента управления Login в шаблон.</span><span class="sxs-lookup"><span data-stu-id="4b992-241">We first need to convert the Login control's interface to a template.</span></span> <span data-ttu-id="4b992-242">В смарт-теге элемента управления Login выберите параметр преобразовать в шаблон.</span><span class="sxs-lookup"><span data-stu-id="4b992-242">From the Login control's Smart Tag, choose the Convert to template option.</span></span>

<span data-ttu-id="4b992-243">[![преобразование элемента управления Login в шаблон](validating-user-credentials-against-the-membership-user-store-vb/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="4b992-243">[![Convert the Login Control to a Template](validating-user-credentials-against-the-membership-user-store-vb/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image16.png)</span></span>

<span data-ttu-id="4b992-244">**Рис. 6**. Преобразование элемента управления Login в шаблон ([щелкните, чтобы просмотреть изображение с полным размером](validating-user-credentials-against-the-membership-user-store-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="4b992-244">**Figure 6**: Convert the Login Control to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="4b992-245">Чтобы вернуть элемент управления Login к версии, предшествующей шаблону, щелкните ссылку сбросить в смарт-теге элемента управления.</span><span class="sxs-lookup"><span data-stu-id="4b992-245">To revert the Login control to its pre-template version, click the Reset link from the control's Smart Tag.</span></span>

<span data-ttu-id="4b992-246">Преобразование элемента управления Login в шаблон добавляет `LayoutTemplate` к декларативной разметке элемента управления с элементами HTML и веб-элементами управления, определяющими пользовательский интерфейс.</span><span class="sxs-lookup"><span data-stu-id="4b992-246">Converting the Login control to a template adds a `LayoutTemplate` to the control's declarative markup with HTML elements and Web controls defining the user interface.</span></span> <span data-ttu-id="4b992-247">Как показано на рис. 7, преобразование элемента управления в шаблон удаляет ряд свойств из окно свойств, например `TitleText`, `CreateUserUrl`и т. д., так как эти значения свойств игнорируются при использовании шаблона.</span><span class="sxs-lookup"><span data-stu-id="4b992-247">As Figure 7 shows, converting the control to a template removes a number of properties from the Properties window, such as `TitleText`, `CreateUserUrl`, and so forth, since these property values are ignored when using a template.</span></span>

<span data-ttu-id="4b992-248">[При преобразовании элемента управления Login в шаблон можно ![меньшее число свойств](validating-user-credentials-against-the-membership-user-store-vb/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="4b992-248">[![Fewer Properties are Available When the Login Control is Converted to a Template](validating-user-credentials-against-the-membership-user-store-vb/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image19.png)</span></span>

<span data-ttu-id="4b992-249">**Рис. 7**. Если элемент управления для входа преобразуется в шаблон ([щелкните, чтобы просмотреть изображение с полным размером](validating-user-credentials-against-the-membership-user-store-vb/_static/image21.png)), доступно меньшее число свойств</span><span class="sxs-lookup"><span data-stu-id="4b992-249">**Figure 7**: Fewer Properties are Available When the Login Control is Converted to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image21.png))</span></span>

<span data-ttu-id="4b992-250">Разметка HTML в `LayoutTemplate` может быть изменена по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="4b992-250">The HTML markup in the `LayoutTemplate` may be modified as needed.</span></span> <span data-ttu-id="4b992-251">Аналогичным образом вы можете добавить в шаблон новые веб-элементы управления.</span><span class="sxs-lookup"><span data-stu-id="4b992-251">Likewise, feel free to add any new Web controls to the template.</span></span> <span data-ttu-id="4b992-252">Однако важно, чтобы основные веб-элементы управления входа оставались в шаблоне и сохранили назначенные значения `ID`.</span><span class="sxs-lookup"><span data-stu-id="4b992-252">However, it is important that Login control's core Web controls remain in the template and keep their assigned `ID` values.</span></span> <span data-ttu-id="4b992-253">В частности, не удаляйте и не переименовывайте `UserName` или `Password` текстовые поля, флажок `RememberMe`, кнопку `LoginButton`, метку `FailureText` или элементы управления `RequiredFieldValidator`.</span><span class="sxs-lookup"><span data-stu-id="4b992-253">In particular, do not remove or rename the `UserName` or `Password` TextBoxes, the `RememberMe` CheckBox, the `LoginButton` Button, the `FailureText` Label, or the `RequiredFieldValidator` controls.</span></span>

<span data-ttu-id="4b992-254">Чтобы получить адрес электронной почты посетителя, необходимо добавить в шаблон текстовое поле.</span><span class="sxs-lookup"><span data-stu-id="4b992-254">To collect the visitor's email address, we need to add a TextBox to the template.</span></span> <span data-ttu-id="4b992-255">Добавьте следующую декларативную разметку между строкой таблицы (`<tr>`), которая содержит текстовое поле `Password`, и строку таблицы, которая содержит флажок Запомнить меня в следующий раз:</span><span class="sxs-lookup"><span data-stu-id="4b992-255">Add the following declarative markup between the table row (`<tr>`) that contains the `Password` TextBox and the table row that holds the Remember me next time CheckBox:</span></span>

[!code-aspx[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample2.aspx)]

<span data-ttu-id="4b992-256">После добавления `Email` текстовое поле, перейдите на страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="4b992-256">After adding the `Email` TextBox, visit the page through a browser.</span></span> <span data-ttu-id="4b992-257">Как показано на рис. 8, Пользовательский интерфейс элемента управления Login теперь включает в себя третье текстовое поле.</span><span class="sxs-lookup"><span data-stu-id="4b992-257">As Figure 8 shows, the Login control's user interface now includes a third textbox.</span></span>

<span data-ttu-id="4b992-258">[![элемент управления Login теперь содержит текстовое поле для адреса электронной почты пользователя](validating-user-credentials-against-the-membership-user-store-vb/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="4b992-258">[![The Login Control Now Includes a Textbox for the User's Email Address](validating-user-credentials-against-the-membership-user-store-vb/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image22.png)</span></span>

<span data-ttu-id="4b992-259">**Рис. 8**. Теперь элемент управления Login содержит текстовое поле для адреса электронной почты пользователя ([щелкните, чтобы просмотреть изображение с полным размером](validating-user-credentials-against-the-membership-user-store-vb/_static/image24.png)).</span><span class="sxs-lookup"><span data-stu-id="4b992-259">**Figure 8**: The Login Control Now Includes a Textbox for the User's Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image24.png))</span></span>

<span data-ttu-id="4b992-260">На этом этапе элемент управления Login по-прежнему использует метод `Membership.ValidateUser` для проверки предоставленных учетных данных.</span><span class="sxs-lookup"><span data-stu-id="4b992-260">At this point, the Login control is still using the `Membership.ValidateUser` method to validate the supplied credentials.</span></span> <span data-ttu-id="4b992-261">Соответственно, значение, указанное в текстовом поле `Email`, не зависит от того, может ли пользователь войти в систему.</span><span class="sxs-lookup"><span data-stu-id="4b992-261">Correspondingly, the value entered into the `Email` TextBox has no bearing on whether the user can log in.</span></span> <span data-ttu-id="4b992-262">На этапе 3 мы рассмотрим, как переопределить логику проверки подлинности элемента управления Login, чтобы учетные данные считались допустимыми только в том случае, если имя пользователя и пароль действительны, а предоставленный адрес электронной почты совпадает с адресом электронной почты в файле.</span><span class="sxs-lookup"><span data-stu-id="4b992-262">In Step 3 we will look at how to override the Login control's authentication logic so that the credentials are only considered valid if the username and password are valid and the supplied email address matches up with the email address on file.</span></span>

## <a name="step-3-modifying-the-login-controls-authentication-logic"></a><span data-ttu-id="4b992-263">Шаг 3. изменение логики проверки подлинности элемента управления Login</span><span class="sxs-lookup"><span data-stu-id="4b992-263">Step 3: Modifying the Login Control's Authentication Logic</span></span>

<span data-ttu-id="4b992-264">Когда посетитель передает свои учетные данные и нажимает кнопку Вход, выполняется обратная передача, и элемент управления входа проходит через рабочий процесс проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="4b992-264">When a visitor supplies her credentials and clicks the Log In button, a postback ensues and the Login control progresses through its authentication workflow.</span></span> <span data-ttu-id="4b992-265">Рабочий процесс начинается с вызова [события`LoggingIn`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span><span class="sxs-lookup"><span data-stu-id="4b992-265">The workflow starts by raising the [`LoggingIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span></span> <span data-ttu-id="4b992-266">Все обработчики событий, связанные с этим событием, могут отменить операцию входа, присвоив свойству `e.Cancel` значение `True`.</span><span class="sxs-lookup"><span data-stu-id="4b992-266">Any event handlers associated with this event may cancel the log in operation by setting the `e.Cancel` property to `True`.</span></span>

<span data-ttu-id="4b992-267">Если операция входа в систему не отменена, Рабочий процесс выполняется путем вызова [события`Authenticate`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span><span class="sxs-lookup"><span data-stu-id="4b992-267">If the log in operation is not cancelled, the workflow progresses by raising the [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span> <span data-ttu-id="4b992-268">Если имеется обработчик события `Authenticate`, он отвечает за определение того, являются ли предоставленные учетные данные допустимыми.</span><span class="sxs-lookup"><span data-stu-id="4b992-268">If there is an event handler for the `Authenticate` event, then it is responsible for determining whether the supplied credentials are valid or not.</span></span> <span data-ttu-id="4b992-269">Если обработчик событий не указан, элемент управления Login использует метод `Membership.ValidateUser` для определения допустимости учетных данных.</span><span class="sxs-lookup"><span data-stu-id="4b992-269">If no event handler is specified, the Login control uses the `Membership.ValidateUser` method to determine the validity of the credentials.</span></span>

<span data-ttu-id="4b992-270">Если предоставлены допустимые учетные данные, создается билет проверки подлинности форм, вызывается [событие`LoggedIn`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) , а пользователь перенаправляется на соответствующую страницу.</span><span class="sxs-lookup"><span data-stu-id="4b992-270">If the supplied credentials are valid, then the forms authentication ticket is created, the [`LoggedIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) is raised, and the user is redirected to the appropriate page.</span></span> <span data-ttu-id="4b992-271">Однако если учетные данные считаются недопустимыми, то вызывается [событие`LoginError`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) и отображается сообщение, информирующее пользователя о том, что его учетные данные недопустимы.</span><span class="sxs-lookup"><span data-stu-id="4b992-271">If, however, the credentials are deemed invalid, then the [`LoginError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) is raised and a message is displayed informing the user that their credentials were invalid.</span></span> <span data-ttu-id="4b992-272">По умолчанию при сбое элемент управления Login просто задает свойству Text элемента управления Label `FailureText` сообщение об ошибке (попытка входа не удалась.</span><span class="sxs-lookup"><span data-stu-id="4b992-272">By default, on failure the Login control simply sets its `FailureText` Label control's Text property to a failure message ( Your login attempt was not successful.</span></span> <span data-ttu-id="4b992-273">Повторите попытку).</span><span class="sxs-lookup"><span data-stu-id="4b992-273">Please try again ).</span></span> <span data-ttu-id="4b992-274">Однако если [свойство`FailureAction`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) элемента управления Login имеет значение `RedirectToLoginPage`, то элемент управления Login выдает `Response.Redirect` на страницу входа, добавляя параметр QueryString `loginfailure=1` (что приводит к тому, что элемент управления входа отображает сообщение об ошибке).</span><span class="sxs-lookup"><span data-stu-id="4b992-274">However, if the Login control's [`FailureAction` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) is set to `RedirectToLoginPage`, then the Login control issues a `Response.Redirect` to the login page appending the querystring parameter `loginfailure=1` (which causes the Login control to display the failure message).</span></span>

<span data-ttu-id="4b992-275">На рис. 9 имеется блок-схема рабочего процесса проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="4b992-275">Figure 9 offers a flow chart of the authentication workflow.</span></span>

<span data-ttu-id="4b992-276">[![рабочего процесса проверки подлинности элемента управления Login](validating-user-credentials-against-the-membership-user-store-vb/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="4b992-276">[![The Login Control's Authentication Workflow](validating-user-credentials-against-the-membership-user-store-vb/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image25.png)</span></span>

<span data-ttu-id="4b992-277">**Рис. 9**. Рабочий процесс проверки подлинности элемента управления Login ([щелкните, чтобы просмотреть изображение с полным размером](validating-user-credentials-against-the-membership-user-store-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="4b992-277">**Figure 9**: The Login Control's Authentication Workflow  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image27.png))</span></span>

> [!NOTE]
> <span data-ttu-id="4b992-278">Если вы заинтересовались тем, как использовать параметр страницы `RedirectToLogin` `FailureAction`, рассмотрим следующий сценарий.</span><span class="sxs-lookup"><span data-stu-id="4b992-278">If you are wondering when you would use the `FailureAction`'s `RedirectToLogin` page option, consider the following scenario.</span></span> <span data-ttu-id="4b992-279">Сейчас Главная страница `Site.master` в данный момент содержит текст Hello, Стрэнджер отображается в левом столбце при посещении анонимного пользователя, но представьте, что мы хотим заменить этот текст элементом управления Login.</span><span class="sxs-lookup"><span data-stu-id="4b992-279">Right now our `Site.master` master page currently has the text, Hello, stranger displayed in the left column when visited by an anonymous user, but imagine that we wanted to replace that text with a Login control.</span></span> <span data-ttu-id="4b992-280">Это позволит анонимному пользователю входить в систему с любой страницы на сайте, а не требовать непосредственного посещения страницы входа.</span><span class="sxs-lookup"><span data-stu-id="4b992-280">This would allow an anonymous user to log in from any page on the site, instead of requiring them to visit the login page directly.</span></span> <span data-ttu-id="4b992-281">Однако если пользователь не смог войти в систему с помощью элемента управления входа, подготовленного к просмотру на главной странице, может иметь смысл перенаправить их на страницу входа (`Login.aspx`), так как эта страница, вероятно, содержит дополнительные инструкции, ссылки и другие справочные материалы, например ссылки для создания новой учетной записи или получения утерянного пароля, которые не были добавлены на главную страницу.</span><span class="sxs-lookup"><span data-stu-id="4b992-281">However, if a user was unable to log in via the Login control rendered by the master page, it might make sense to redirect them to the login page (`Login.aspx`) because that page likely includes additional instructions, links, and other help - such as links to create a new account or retrieve a lost password - that were not added to the master page.</span></span>

### <a name="creating-theauthenticateevent-handler"></a><span data-ttu-id="4b992-282">Создание обработчика событий`Authenticate`</span><span class="sxs-lookup"><span data-stu-id="4b992-282">Creating the`Authenticate`Event Handler</span></span>

<span data-ttu-id="4b992-283">Чтобы подключить собственную логику проверки подлинности, необходимо создать обработчик событий для события `Authenticate` элемента управления Login.</span><span class="sxs-lookup"><span data-stu-id="4b992-283">In order to plug in our custom authentication logic, we need to create an event handler for the Login control's `Authenticate` event.</span></span> <span data-ttu-id="4b992-284">Создание обработчика событий для `Authenticate` события приведет к созданию следующего определения обработчика событий:</span><span class="sxs-lookup"><span data-stu-id="4b992-284">Creating an event handler for the `Authenticate` event will generate the following event handler definition:</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample3.vb)]

<span data-ttu-id="4b992-285">Как видите, обработчику `Authenticate` событий передается объект типа [`AuthenticateEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) в качестве второго входного параметра.</span><span class="sxs-lookup"><span data-stu-id="4b992-285">As you can see, the `Authenticate` event handler is passed an object of type [`AuthenticateEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) as its second input parameter.</span></span> <span data-ttu-id="4b992-286">Класс `AuthenticateEventArgs` содержит логическое свойство с именем `Authenticated`, которое используется, чтобы указать, являются ли предоставленные учетные данные допустимыми.</span><span class="sxs-lookup"><span data-stu-id="4b992-286">The `AuthenticateEventArgs` class contains a Boolean property named `Authenticated` that is used to specify whether the supplied credentials are valid.</span></span> <span data-ttu-id="4b992-287">Наша задача, в своюмся, заключается в написании кода, который определяет, являются ли предоставленные учетные данные допустимыми или нет, а также устанавливает соответствующее свойство `e.Authenticate`.</span><span class="sxs-lookup"><span data-stu-id="4b992-287">Our task, then, is to write code here that determines whether the supplied credentials are valid or not, and to set the `e.Authenticate` property accordingly.</span></span>

### <a name="determining-and-validating-the-supplied-credentials"></a><span data-ttu-id="4b992-288">Определение и Проверка предоставленных учетных данных</span><span class="sxs-lookup"><span data-stu-id="4b992-288">Determining and Validating the Supplied Credentials</span></span>

<span data-ttu-id="4b992-289">Для определения учетных данных пользователя и пароля, вводимых пользователем, используйте свойства [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) и [`Password`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx) элемента управления Login.</span><span class="sxs-lookup"><span data-stu-id="4b992-289">Use the Login control's [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) and [`Password` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx) to determine the username and password credentials entered by the user.</span></span> <span data-ttu-id="4b992-290">Чтобы определить значения, введенные в любые дополнительные веб-элементы управления (например, текстовое поле `Email`, добавленное на предыдущем шаге), используйте `LoginControlID.FindControl`(" *`controlID`* "), чтобы получить программную ссылку на веб-элемент управления в шаблоне, свойство `ID` которого равно *`controlID`* .</span><span class="sxs-lookup"><span data-stu-id="4b992-290">In order to determine the values entered into any additional Web controls (such as the `Email` TextBox we added in the previous step), use `LoginControlID.FindControl`("*`controlID`*") to obtain a programmatic reference to the Web control in the template whose `ID` property is equal to *`controlID`*.</span></span> <span data-ttu-id="4b992-291">Например, чтобы получить ссылку на текстовое поле `Email`, используйте следующий код:</span><span class="sxs-lookup"><span data-stu-id="4b992-291">For example, to get a reference to the `Email` TextBox, use the following code:</span></span>

`Dim EmailTextBox As TextBox = CType(myLogin.FindControl("Email"), TextBox)`

<span data-ttu-id="4b992-292">Чтобы проверить учетные данные пользователя, необходимо выполнить два действия:</span><span class="sxs-lookup"><span data-stu-id="4b992-292">In order to validate the user's credentials we need to do two things:</span></span>

1. <span data-ttu-id="4b992-293">Убедитесь, что указанные имя пользователя и пароль действительны.</span><span class="sxs-lookup"><span data-stu-id="4b992-293">Ensure that the provided username and password are valid</span></span>
2. <span data-ttu-id="4b992-294">Убедитесь, что введенный адрес электронной почты соответствует адресу электронной почты в файле для пользователя, пытающегося войти в систему.</span><span class="sxs-lookup"><span data-stu-id="4b992-294">Ensure that email address entered matches the email address on file for the user attempting to log in</span></span>

<span data-ttu-id="4b992-295">Чтобы выполнить первую проверку, можно просто использовать метод `Membership.ValidateUser`, как было показано на шаге 1.</span><span class="sxs-lookup"><span data-stu-id="4b992-295">To accomplish the first check we can simply use the `Membership.ValidateUser` method like we saw in Step 1.</span></span> <span data-ttu-id="4b992-296">Для второй проверки необходимо определить адрес электронной почты пользователя, чтобы можно было сравнить его с адресом электронной почты, введенным в элемент управления TextBox.</span><span class="sxs-lookup"><span data-stu-id="4b992-296">For the second check, we need to determine the user's email address so that we can compare it to the email address they entered into the TextBox control.</span></span> <span data-ttu-id="4b992-297">Чтобы получить сведения об определенном пользователе, используйте [метод`GetUser`](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx)класса `Membership`.</span><span class="sxs-lookup"><span data-stu-id="4b992-297">To get information about a particular user, use the `Membership` class's [`GetUser` method](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx).</span></span>

<span data-ttu-id="4b992-298">Метод `GetUser` имеет ряд перегрузок.</span><span class="sxs-lookup"><span data-stu-id="4b992-298">The `GetUser` method has a number of overloads.</span></span> <span data-ttu-id="4b992-299">Если используется без передачи каких бы то ни было параметров, он возвращает сведения о текущем пользователе, вошедшем в систему.</span><span class="sxs-lookup"><span data-stu-id="4b992-299">If used without passing in any parameters, it returns information about the currently logged in user.</span></span> <span data-ttu-id="4b992-300">Чтобы получить сведения о конкретном пользователе, вызовите `GetUser` передачи имени пользователя.</span><span class="sxs-lookup"><span data-stu-id="4b992-300">To get information about a particular user, call `GetUser` passing in their username.</span></span> <span data-ttu-id="4b992-301">В любом случае `GetUser` возвращает [объект`MembershipUser`](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), имеющий такие свойства, как `UserName`, `Email`, `IsApproved`, `IsOnline`и т. д.</span><span class="sxs-lookup"><span data-stu-id="4b992-301">Either way, `GetUser` returns a [`MembershipUser` object](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), which has properties like `UserName`, `Email`, `IsApproved`, `IsOnline`, and so on.</span></span>

<span data-ttu-id="4b992-302">Следующий код реализует эти две проверки.</span><span class="sxs-lookup"><span data-stu-id="4b992-302">The following code implements these two checks.</span></span> <span data-ttu-id="4b992-303">Если оба этих параметра выполнены, `e.Authenticate` устанавливается равным `True`, в противном случае назначается `False`.</span><span class="sxs-lookup"><span data-stu-id="4b992-303">If both pass, then `e.Authenticate` is set to `True`, otherwise it is assigned `False`.</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample4.vb)]

<span data-ttu-id="4b992-304">Используя этот код, попытайтесь войти в качестве допустимого пользователя, введя правильное имя пользователя, пароль и адрес электронной почты.</span><span class="sxs-lookup"><span data-stu-id="4b992-304">With this code in place, attempt to log in as a valid user, entering the correct username, password, and email address.</span></span> <span data-ttu-id="4b992-305">Попробуйте еще раз, но на этот раз намеренно использовать неверный адрес электронной почты (см. рис. 10).</span><span class="sxs-lookup"><span data-stu-id="4b992-305">Try it again, but this time purposefully use an incorrect email address (see Figure 10).</span></span> <span data-ttu-id="4b992-306">Наконец, попробуйте использовать несуществующее имя пользователя в третий раз.</span><span class="sxs-lookup"><span data-stu-id="4b992-306">Finally, try it a third time using a non-existent username.</span></span> <span data-ttu-id="4b992-307">В первом случае вы успешно вошли на сайт, но в двух последних случаях вы увидите сообщение об ошибке "недопустимые учетные данные элемента управления входа".</span><span class="sxs-lookup"><span data-stu-id="4b992-307">In the first case you should be successfully logged on to the site, but in the last two cases you should see the Login control's invalid credentials message.</span></span>

<span data-ttu-id="4b992-308">[![Тито не удается войти в систему при указании неправильного адреса электронной почты](validating-user-credentials-against-the-membership-user-store-vb/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="4b992-308">[![Tito Cannot Log In When Supplying an Incorrect Email Address](validating-user-credentials-against-the-membership-user-store-vb/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image28.png)</span></span>

<span data-ttu-id="4b992-309">**Рис. 10**. Тито не удается войти в систему при вводе неправильного адреса электронной почты ([щелкните, чтобы просмотреть изображение с полным размером](validating-user-credentials-against-the-membership-user-store-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="4b992-309">**Figure 10**: Tito Cannot Log In When Supplying an Incorrect Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image30.png))</span></span>

> [!NOTE]
> <span data-ttu-id="4b992-310">Как описано в разделе Инфраструктура членства обрабатывает недопустимые попытки входа в систему в шаге 1, когда метод `Membership.ValidateUser` вызывается и передает недопустимые учетные данные, он отслеживает неудачную попытку входа и блокирует пользователя, если он превышает определенное пороговое значение недопустимых попыток в течение заданного временного интервала.</span><span class="sxs-lookup"><span data-stu-id="4b992-310">As discussed in the How the Membership Framework Handles Invalid Login Attempts section in Step 1, when the `Membership.ValidateUser` method is called and passed invalid credentials, it keeps track of the invalid login attempt and locks out the user if they exceed a certain threshold of invalid attempts within a specified time window.</span></span> <span data-ttu-id="4b992-311">Так как наша пользовательская логика проверки подлинности вызывает метод `ValidateUser`, неверный пароль для допустимого имени пользователя увеличивает значение счетчика неудачных попыток входа, но этот счетчик не увеличивается в случае, когда имя пользователя и пароль действительны, но неверный адрес электронной почты.</span><span class="sxs-lookup"><span data-stu-id="4b992-311">Since our custom authentication logic calls the `ValidateUser` method, an incorrect password for a valid username will increment the invalid login attempt counter, but this counter is not incremented in the case where the username and password are valid, but the email address is incorrect.</span></span> <span data-ttu-id="4b992-312">Вероятно, это поведение подходит, так как маловероятно, чтобы злоумышленник знал имя пользователя и пароль, но для определения адреса электронной почты пользователя необходимо использовать методы принудительной силы.</span><span class="sxs-lookup"><span data-stu-id="4b992-312">Chances are, this behavior is suitable, since it's unlikely that a hacker will know the username and password, but have to use brute force techniques to determine the user's email address.</span></span>

## <a name="step-4-improving-the-login-controls-invalid-credentials-message"></a><span data-ttu-id="4b992-313">Шаг 4. Улучшение сообщения об недопустимых учетных данных элемента управления Login</span><span class="sxs-lookup"><span data-stu-id="4b992-313">Step 4: Improving the Login Control's Invalid Credentials Message</span></span>

<span data-ttu-id="4b992-314">Когда пользователь пытается войти в систему с недопустимыми учетными данными, элемент управления Login отображает сообщение о том, что попытка входа была неудачной.</span><span class="sxs-lookup"><span data-stu-id="4b992-314">When a user attempts to log on with invalid credentials, the Login control displays a message explaining that the login attempt was unsuccessful.</span></span> <span data-ttu-id="4b992-315">В частности, элемент управления отображает сообщение, указанное [свойством`FailureText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx), которое по умолчанию не прошло попытку входа.</span><span class="sxs-lookup"><span data-stu-id="4b992-315">In particular, the control displays the message specified by its [`FailureText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx), which has a default value of Your login attempt was not successful.</span></span> <span data-ttu-id="4b992-316">Повторите попытку.</span><span class="sxs-lookup"><span data-stu-id="4b992-316">Please try again.</span></span>

<span data-ttu-id="4b992-317">Помните, что существует множество причин, по которым учетные данные пользователя могут быть недопустимыми:</span><span class="sxs-lookup"><span data-stu-id="4b992-317">Recall that there are many reasons why a user's credentials may be invalid:</span></span>

- <span data-ttu-id="4b992-318">Возможно, имя пользователя не существует</span><span class="sxs-lookup"><span data-stu-id="4b992-318">The username may not exist</span></span>
- <span data-ttu-id="4b992-319">Имя пользователя существует, но пароль недействителен</span><span class="sxs-lookup"><span data-stu-id="4b992-319">The username exists, but the password is invalid</span></span>
- <span data-ttu-id="4b992-320">Имя пользователя и пароль действительны, но пользователь еще не утвержден</span><span class="sxs-lookup"><span data-stu-id="4b992-320">The username and password are valid, but the user is not yet approved</span></span>
- <span data-ttu-id="4b992-321">Имя пользователя и пароль действительны, но пользователь заблокирован (скорее всего, из-за превышения числа недопустимых попыток входа в течение заданного интервала времени).</span><span class="sxs-lookup"><span data-stu-id="4b992-321">The username and password are valid, but the user is locked out (most likely because they exceeded the number of invalid login attempts within the specified time frame)</span></span>

<span data-ttu-id="4b992-322">При использовании настраиваемой логики проверки подлинности могут возникнуть и другие причины.</span><span class="sxs-lookup"><span data-stu-id="4b992-322">And there may be other reasons when using custom authentication logic.</span></span> <span data-ttu-id="4b992-323">Например, в коде, написанном на шаге 3, имя пользователя и пароль могут быть допустимыми, но адрес электронной почты может быть неверным.</span><span class="sxs-lookup"><span data-stu-id="4b992-323">For example, with the code we wrote in Step 3, the username and password may be valid, but the email address may be incorrect.</span></span>

<span data-ttu-id="4b992-324">Независимо от того, почему учетные данные являются недопустимыми, элемент управления Login отображает одно и то же сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="4b992-324">Regardless of why the credentials are invalid, the Login control displays the same error message.</span></span> <span data-ttu-id="4b992-325">Такое отсутствие отзывов может быть запутанным для пользователя, учетная запись которого еще не утверждена или заблокирована. Но с небольшой скоростью работы, элемент управления Login может отобразить более подходящее сообщение.</span><span class="sxs-lookup"><span data-stu-id="4b992-325">This lack of feedback can be confusing for a user whose account has not yet been approved or who has been locked out. With a little bit of work, though, we can have the Login control display a more appropriate message.</span></span>

<span data-ttu-id="4b992-326">Каждый раз, когда пользователь пытается войти с недействительными учетными данными, элемент управления входа вызывает событие `LoginError`.</span><span class="sxs-lookup"><span data-stu-id="4b992-326">Whenever a user attempts to login with invalid credentials the Login control raises its `LoginError` event.</span></span> <span data-ttu-id="4b992-327">Создайте обработчик событий для этого события и добавьте следующий код:</span><span class="sxs-lookup"><span data-stu-id="4b992-327">Go ahead and create an event handler for this event, and add the following code:</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample5.vb)]

<span data-ttu-id="4b992-328">Приведенный выше код начинается с присвоения свойству `FailureText` элемента управления Login значения по умолчанию (попытка входа не удалась.</span><span class="sxs-lookup"><span data-stu-id="4b992-328">The above code starts by setting the Login control's `FailureText` property to the default value ( Your login attempt was not successful.</span></span> <span data-ttu-id="4b992-329">Повторите попытку).</span><span class="sxs-lookup"><span data-stu-id="4b992-329">Please try again ).</span></span> <span data-ttu-id="4b992-330">Затем он проверяет, сопоставлено ли имя пользователя с существующей учетной записью пользователя.</span><span class="sxs-lookup"><span data-stu-id="4b992-330">It then checks to see if the username supplied maps to an existing user account.</span></span> <span data-ttu-id="4b992-331">В этом случае он обращается к результирующим свойствам `IsLockedOut` и `IsApproved` объекта `MembershipUser`, чтобы определить, была ли учетная запись заблокирована или еще не утверждена.</span><span class="sxs-lookup"><span data-stu-id="4b992-331">If so, it consults the resulting `MembershipUser` object's `IsLockedOut` and `IsApproved` properties to determine if the account has been locked out or has not yet been approved.</span></span> <span data-ttu-id="4b992-332">В любом случае свойство `FailureText` обновляется до соответствующего значения.</span><span class="sxs-lookup"><span data-stu-id="4b992-332">In either case, the `FailureText` property is updated to a corresponding value.</span></span>

<span data-ttu-id="4b992-333">Чтобы протестировать этот код, намеренно попытку входа в систему от имени существующего пользователя, но используйте неверный пароль.</span><span class="sxs-lookup"><span data-stu-id="4b992-333">To test this code, purposefully attempt to log in as an existing user, but use an incorrect password.</span></span> <span data-ttu-id="4b992-334">Сделайте это пять раз в строке в течение 10-минутного интервала, и учетная запись будет заблокирована. Как показано на рис. 11, при последующих попытках входа всегда произойдет сбой (даже при наличии правильного пароля), но теперь будет отображено более подробное описание учетной записи из-за слишком большого числа неудачных попыток входа.</span><span class="sxs-lookup"><span data-stu-id="4b992-334">Do this five times in a row within a 10 minute time frame and the account will be locked out. As Figure 11 shows, subsequent login attempts will always fail (even with the correct password), but will now display the more descriptive Your account has been locked out because of too many invalid login attempts.</span></span> <span data-ttu-id="4b992-335">Обратитесь к администратору, чтобы ваша учетная запись разблокировала сообщение.</span><span class="sxs-lookup"><span data-stu-id="4b992-335">Please contact the administrator to have your account unlocked message.</span></span>

<span data-ttu-id="4b992-336">[![Тито выполнил слишком много недопустимых попыток входа и был заблокирован](validating-user-credentials-against-the-membership-user-store-vb/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="4b992-336">[![Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out](validating-user-credentials-against-the-membership-user-store-vb/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image31.png)</span></span>

<span data-ttu-id="4b992-337">**Рис. 11**. Тито выполнил слишком много недопустимых попыток входа в систему и был заблокирован ([щелкните, чтобы просмотреть изображение с полным размером](validating-user-credentials-against-the-membership-user-store-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="4b992-337">**Figure 11**: Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image33.png))</span></span>

## <a name="summary"></a><span data-ttu-id="4b992-338">Сводка</span><span class="sxs-lookup"><span data-stu-id="4b992-338">Summary</span></span>

<span data-ttu-id="4b992-339">В ходе работы с этим руководством страница входа проверила предоставленные учетные данные на жестко закодированный список пар имя пользователя/пароль.</span><span class="sxs-lookup"><span data-stu-id="4b992-339">Prior this tutorial, our login page validated the supplied credentials against a hard-coded list of username/password pairs.</span></span> <span data-ttu-id="4b992-340">В этом руководстве мы обновили страницу для проверки учетных данных в инфраструктуре членства.</span><span class="sxs-lookup"><span data-stu-id="4b992-340">In this tutorial, we updated the page to validate credentials against the Membership framework.</span></span> <span data-ttu-id="4b992-341">На этапе 1 мы рассматривали использование метода `Membership.ValidateUser` программным способом.</span><span class="sxs-lookup"><span data-stu-id="4b992-341">In Step 1 we looked at using the `Membership.ValidateUser` method programmatically.</span></span> <span data-ttu-id="4b992-342">На этапе 2 мы заменили пользовательский интерфейс и код, созданные вручную, на элемент управления Login.</span><span class="sxs-lookup"><span data-stu-id="4b992-342">In Step 2 we replaced our manually created user interface and code with the Login control.</span></span>

<span data-ttu-id="4b992-343">Элемент управления Login визуализирует стандартный пользовательский интерфейс входа и автоматически проверяет учетные данные пользователя в среде членства.</span><span class="sxs-lookup"><span data-stu-id="4b992-343">The Login control renders a standard login user interface and automatically validates the user's credentials against the Membership framework.</span></span> <span data-ttu-id="4b992-344">Более того, в случае допустимых учетных данных элемент управления Login подписывает пользователя с помощью проверки подлинности с использованием форм.</span><span class="sxs-lookup"><span data-stu-id="4b992-344">Moreover, in the event of valid credentials, the Login control signs the user in via forms authentication.</span></span> <span data-ttu-id="4b992-345">Коротко говоря, доступ к полнофункциональному пользователю можно получить, просто перетащив элемент управления Login на страницу, не требует дополнительной декларативной разметки или кода.</span><span class="sxs-lookup"><span data-stu-id="4b992-345">In short, a fully functional login user experience is available by simply dragging the Login control onto a page, no extra declarative markup or code necessary.</span></span> <span data-ttu-id="4b992-346">Более того, элемент управления Login очень настраиваемый, что позволяет точно контролировать как отображаемый пользовательский интерфейс, так и логику проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="4b992-346">What's more, the Login control is highly customizable, allowing for a fine degree of control over both the rendered user interface and authentication logic.</span></span>

<span data-ttu-id="4b992-347">На этом этапе Посетители веб-сайта могут создать новую учетную запись пользователя и войти на сайт, но мы еще не просматриваете доступ к страницам на основе пользователя, прошедшего проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="4b992-347">At this point visitors to our website can create a new user account and log into the site, but we have yet to look at restricting access to pages based on the authenticated user.</span></span> <span data-ttu-id="4b992-348">В настоящее время любой пользователь, аутентифицированный или анонимный, может просматривать любую страницу на нашем сайте.</span><span class="sxs-lookup"><span data-stu-id="4b992-348">Currently, any user, authenticated or anonymous, can view any page on our site.</span></span> <span data-ttu-id="4b992-349">Наряду с управлением доступом к страницам сайта на уровне пользователя, у нас могут быть определенные страницы, функциональность которых зависит от пользователя.</span><span class="sxs-lookup"><span data-stu-id="4b992-349">Along with controlling access to our site's pages on a user-by-user basis, we might have certain pages whose functionality depends on the user.</span></span> <span data-ttu-id="4b992-350">В следующем учебнике рассматривается ограничение доступа и функциональных возможностей на странице в зависимости от пользователя, вошедшего в систему.</span><span class="sxs-lookup"><span data-stu-id="4b992-350">The next tutorial looks at how to limit access and in-page functionality based on the logged in user.</span></span>

<span data-ttu-id="4b992-351">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="4b992-351">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="4b992-352">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="4b992-352">Further Reading</span></span>

<span data-ttu-id="4b992-353">Дополнительные сведения о разделах, обсуждаемых в этом руководстве, см. в следующих ресурсах:</span><span class="sxs-lookup"><span data-stu-id="4b992-353">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="4b992-354">Отображение пользовательских сообщений для заблокированных и неутвержденных пользователей</span><span class="sxs-lookup"><span data-stu-id="4b992-354">Displaying Custom Messages to Locked Out and Non-Approved Users</span></span>](http://aspnet.4guysfromrolla.com/articles/050306-1.aspx)
- [<span data-ttu-id="4b992-355">Изучение членства, ролей и профиля ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="4b992-355">Examining ASP.NET 2.0's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="4b992-356">Как создать страницу входа в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="4b992-356">How To: Create an ASP.NET Login Page</span></span>](https://msdn.microsoft.com/library/ms178331.aspx)
- [<span data-ttu-id="4b992-357">Техническая документация по элементу управления Login</span><span class="sxs-lookup"><span data-stu-id="4b992-357">Login Control Technical Documentation</span></span>](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx)
- [<span data-ttu-id="4b992-358">Использование элементов управления входа</span><span class="sxs-lookup"><span data-stu-id="4b992-358">Using the Login Controls</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/login.aspx)

### <a name="about-the-author"></a><span data-ttu-id="4b992-359">Об авторе</span><span class="sxs-lookup"><span data-stu-id="4b992-359">About the Author</span></span>

<span data-ttu-id="4b992-360">Скотт Митчелл, автор нескольких книг по ASP/ASP. NET и основатель 4GuysFromRolla.com, работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="4b992-360">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="4b992-361">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="4b992-361">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="4b992-362">Его последняя книга — *[Sams обучать себя ASP.NET 2,0 за 24 часа](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* .</span><span class="sxs-lookup"><span data-stu-id="4b992-362">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="4b992-363">Скотт можно получить по адресу [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) или через свой блог по адресу [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="4b992-363">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="4b992-364">Специальная благодарность</span><span class="sxs-lookup"><span data-stu-id="4b992-364">Special Thanks To</span></span>

<span data-ttu-id="4b992-365">Эта серия руководств была рассмотрена многими полезными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="4b992-365">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="4b992-366">Потенциальные рецензенты для этого учебника были Терезой Мерфи и Майкл Оливеро.</span><span class="sxs-lookup"><span data-stu-id="4b992-366">Lead reviewers for this tutorial were Teresa Murphy and Michael Olivero.</span></span> <span data-ttu-id="4b992-367">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="4b992-367">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="4b992-368">Если это так, расположите строку в [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span><span class="sxs-lookup"><span data-stu-id="4b992-368">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="4b992-369">[Назад](creating-user-accounts-vb.md)
> [Вперед](user-based-authorization-vb.md)</span><span class="sxs-lookup"><span data-stu-id="4b992-369">[Previous](creating-user-accounts-vb.md)
[Next](user-based-authorization-vb.md)</span></span>
