---
uid: web-forms/overview/older-versions-security/introduction/an-overview-of-forms-authentication-vb
title: Обзор проверки подлинности с помощью форм (VB) | Документация Майкрософт
author: rick-anderson
description: В этом учебнике мы будем переключаться от самого подведения к реализации. в частности, мы рассмотрим реализацию проверки подлинности с помощью форм. Веб-приложение w...
ms.author: riande
ms.date: 01/14/2008
ms.assetid: 83267f7d-64d9-41ee-82cf-da91b1bf534d
msc.legacyurl: /web-forms/overview/older-versions-security/introduction/an-overview-of-forms-authentication-vb
msc.type: authoredcontent
ms.openlocfilehash: d8ceb6b5290300992e52199caa9314c573de1942
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74626740"
---
# <a name="an-overview-of-forms-authentication-vb"></a><span data-ttu-id="27a71-104">Обзор проверки подлинности с помощью форм (VB)</span><span class="sxs-lookup"><span data-stu-id="27a71-104">An Overview of Forms Authentication (VB)</span></span>

<span data-ttu-id="27a71-105">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="27a71-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="27a71-106">[Скачать код](https://download.microsoft.com/download/2/F/7/2F705A34-F9DE-4112-BBDE-60098089645E/ASPNET_Security_Tutorial_02_VB.zip) или [скачать PDF](https://download.microsoft.com/download/2/F/7/2F705A34-F9DE-4112-BBDE-60098089645E/aspnet_tutorial02_FormsAuth_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="27a71-106">[Download Code](https://download.microsoft.com/download/2/F/7/2F705A34-F9DE-4112-BBDE-60098089645E/ASPNET_Security_Tutorial_02_VB.zip) or [Download PDF](https://download.microsoft.com/download/2/F/7/2F705A34-F9DE-4112-BBDE-60098089645E/aspnet_tutorial02_FormsAuth_vb.pdf)</span></span>

> <span data-ttu-id="27a71-107">В этом учебнике мы будем переключаться от самого подведения к реализации. в частности, мы рассмотрим реализацию проверки подлинности с помощью форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-107">In this tutorial we will turn from mere discussion to implementation; in particular, we will look at implementing forms authentication.</span></span> <span data-ttu-id="27a71-108">Веб-приложение, которое мы начнем в этом учебнике, будет продолжать создаваться в последующих руководствах, так как мы перейдем к членству и ролям с помощью простой проверки подлинности на основе форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-108">The web application we start constructing in this tutorial will continue to be built upon in subsequent tutorials, as we move from simple forms authentication to membership and roles.</span></span>
> 
> <span data-ttu-id="27a71-109">Дополнительные сведения по этой теме см. в этом видео: [использование проверки подлинности Basic Forms в ASP.NET](../../../videos/authentication/using-basic-forms-authentication-in-aspnet.md).</span><span class="sxs-lookup"><span data-stu-id="27a71-109">Please see this video for more information on this topic: [Using Basic Forms Authentication in ASP.NET](../../../videos/authentication/using-basic-forms-authentication-in-aspnet.md).</span></span>

## <a name="introduction"></a><span data-ttu-id="27a71-110">Введение</span><span class="sxs-lookup"><span data-stu-id="27a71-110">Introduction</span></span>

<span data-ttu-id="27a71-111">В [предыдущем учебнике](security-basics-and-asp-net-support-vb.md) мы обсуждали различные параметры проверки подлинности, авторизации и учетной записи пользователя, предоставляемые ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="27a71-111">In the [preceding tutorial](security-basics-and-asp-net-support-vb.md) we discussed the various authentication, authorization, and user account options provided by ASP.NET.</span></span> <span data-ttu-id="27a71-112">В этом учебнике мы будем переключаться от самого подведения к реализации. в частности, мы рассмотрим реализацию проверки подлинности с помощью форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-112">In this tutorial we will turn from mere discussion to implementation; in particular, we will look at implementing forms authentication.</span></span> <span data-ttu-id="27a71-113">Веб-приложение, которое мы начнем в этом учебнике, будет продолжать создаваться в последующих руководствах, так как мы перейдем к членству и ролям с помощью простой проверки подлинности на основе форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-113">The web application we start constructing in this tutorial will continue to be built upon in subsequent tutorials, as we move from simple forms authentication to membership and roles.</span></span>

<span data-ttu-id="27a71-114">Этот учебник начинается с подробного взгляда на рабочий процесс проверки подлинности на основе форм, на который мы затронули предыдущий учебник.</span><span class="sxs-lookup"><span data-stu-id="27a71-114">This tutorial begins with an in-depth look at the forms authentication workflow, a topic we touched upon in the previous tutorial.</span></span> <span data-ttu-id="27a71-115">После этого мы создадим веб-сайт ASP.NET, с помощью которого вы узнаете основные понятия проверки подлинности с помощью форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-115">Following that, we will create an ASP.NET website through which to demo the concepts of forms authentication.</span></span> <span data-ttu-id="27a71-116">Далее мы настроим сайт на использование проверки подлинности с помощью форм, создадим простую страницу входа и посмотрим, как определить, прошел ли пользователь проверку подлинности, и, если да, имя пользователя, выполнившего вход.</span><span class="sxs-lookup"><span data-stu-id="27a71-116">Next, we will configure the site to use forms authentication, create a simple login page, and see how to determine, in code, whether a user is authenticated and, if so, the username they logged in with.</span></span>

<span data-ttu-id="27a71-117">Понимание рабочего процесса проверки подлинности с помощью форм, включение его в веб-приложение и создание страниц входа и выхода из системы — это все важнейшие шаги в создании приложения ASP.NET, которое поддерживает учетные записи пользователей и выполняет проверку подлинности пользователей через веб-страницу.</span><span class="sxs-lookup"><span data-stu-id="27a71-117">Understanding the forms authentication workflow, enabling it in a web application, and creating the login and logoff pages are all vital steps in building an ASP.NET application that supports user accounts and authenticates users through a web page.</span></span> <span data-ttu-id="27a71-118">Из-за этого и потому, что эти учебники посвящены друг другу, я бы рекомендовал вам работать с этим учебником полностью, прежде чем переходить к следующему, даже если у вас уже есть опыт настройки проверки подлинности с помощью форм в прошлых проектах.</span><span class="sxs-lookup"><span data-stu-id="27a71-118">Because of this - and because these tutorials build upon one another - I would encourage you to work through this tutorial in full before moving on to the next one even if you already have had experience configuring forms authentication in past projects.</span></span>

## <a name="understanding-the-forms-authentication-workflow"></a><span data-ttu-id="27a71-119">Основные сведения о рабочем процессе проверки подлинности на формах</span><span class="sxs-lookup"><span data-stu-id="27a71-119">Understanding the Forms Authentication Workflow</span></span>

<span data-ttu-id="27a71-120">Когда среда выполнения ASP.NET обрабатывает запрос ресурса ASP.NET, например страницы ASP.NET или веб-службы ASP.NET, запрос вызывает ряд событий в течение жизненного цикла.</span><span class="sxs-lookup"><span data-stu-id="27a71-120">When the ASP.NET runtime processes a request for an ASP.NET resource, such as an ASP.NET page or ASP.NET Web service, the request raises a number of events during its lifecycle.</span></span> <span data-ttu-id="27a71-121">Существуют события, возникающие в самом начале и в конце запроса, которые вызываются при проверке подлинности и авторизации запроса, возникновении события в случае необработанного исключения и т. д.</span><span class="sxs-lookup"><span data-stu-id="27a71-121">There are events raised at the very beginning and very end of the request, ones raised when the request is being authenticated and authorized, an event raised in the case of an unhandled exception, and so forth.</span></span> <span data-ttu-id="27a71-122">Полный список событий см. в статье [события объекта HttpApplication](https://msdn.microsoft.com/library/system.web.httpapplication_events.aspx).</span><span class="sxs-lookup"><span data-stu-id="27a71-122">To see a complete listing of the events, refer to the [HttpApplication object's events](https://msdn.microsoft.com/library/system.web.httpapplication_events.aspx).</span></span>

<span data-ttu-id="27a71-123">*HTTP-модули* — это управляемые классы, код которых выполняется в ответ на определенное событие в жизненном цикле запроса.</span><span class="sxs-lookup"><span data-stu-id="27a71-123">*HTTP Modules* are managed classes whose code is executed in response to a particular event in the request lifecycle.</span></span> <span data-ttu-id="27a71-124">ASP.NET поставляется с несколькими HTTP-модулями, которые выполняют базовые задачи в фоновом режиме.</span><span class="sxs-lookup"><span data-stu-id="27a71-124">ASP.NET ships with a number of HTTP Modules that perform essential tasks behind the scenes.</span></span> <span data-ttu-id="27a71-125">Два встроенных HTTP-модуля, которые особенно важны для нашего обсуждения:</span><span class="sxs-lookup"><span data-stu-id="27a71-125">Two built-in HTTP Modules that are especially relevant to our discussion are:</span></span>

- <span data-ttu-id="27a71-126">**[FormsAuthenticationModule](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx)** — проверяет подлинность пользователя, проверяя билет проверки подлинности форм, который обычно включается в коллекцию файлов cookie пользователя.</span><span class="sxs-lookup"><span data-stu-id="27a71-126">**[FormsAuthenticationModule](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx)** - authenticates the user by inspecting the forms authentication ticket, which is typically included in the user's cookies collection.</span></span> <span data-ttu-id="27a71-127">Если билет проверки подлинности форм отсутствует, пользователь является анонимным.</span><span class="sxs-lookup"><span data-stu-id="27a71-127">If no forms authentication ticket is present, the user is anonymous.</span></span>
- <span data-ttu-id="27a71-128">**[Урлаусоризатионмодуле](https://msdn.microsoft.com/library/system.web.security.urlauthorizationmodule.aspx)** — определяет, имеет ли текущий пользователь разрешение на доступ к запрошенному URL-адресу.</span><span class="sxs-lookup"><span data-stu-id="27a71-128">**[UrlAuthorizationModule](https://msdn.microsoft.com/library/system.web.security.urlauthorizationmodule.aspx)** - determines whether or not the current user is authorized to access the requested URL.</span></span> <span data-ttu-id="27a71-129">Этот модуль определяет полномочия путем консультации правил авторизации, указанных в файлах конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="27a71-129">This module determines the authority by consulting the authorization rules specified in the application's configuration files.</span></span> <span data-ttu-id="27a71-130">ASP.NET также включает [филеаусоризатионмодуле](https://msdn.microsoft.com/library/system.web.security.fileauthorizationmodule.aspx) , который определяет полномочия путем консультации с запрошенными списками ACL файлов.</span><span class="sxs-lookup"><span data-stu-id="27a71-130">ASP.NET also includes the [FileAuthorizationModule](https://msdn.microsoft.com/library/system.web.security.fileauthorizationmodule.aspx) that determines authority by consulting the requested file(s) ACLs.</span></span>

<span data-ttu-id="27a71-131">FormsAuthenticationModule пытается проверить подлинность пользователя до выполнения Урлаусоризатионмодуле (и Филеаусоризатионмодуле).</span><span class="sxs-lookup"><span data-stu-id="27a71-131">The FormsAuthenticationModule attempts to authenticate the user prior to the UrlAuthorizationModule (and FileAuthorizationModule) executing.</span></span> <span data-ttu-id="27a71-132">Если пользователь, выполняющий запрос, не имеет прав доступа к запрошенному ресурсу, модуль авторизации завершает запрос и возвращает сообщение о [неавторизованном состоянии HTTP 401](http://www.checkupdown.com/status/E401.html) .</span><span class="sxs-lookup"><span data-stu-id="27a71-132">If the user making the request is not authorized to access the requested resource, the authorization module terminates the request and returns an [HTTP 401 Unauthorized](http://www.checkupdown.com/status/E401.html) status.</span></span> <span data-ttu-id="27a71-133">В сценариях проверки подлинности Windows в браузере возвращается состояние HTTP 401.</span><span class="sxs-lookup"><span data-stu-id="27a71-133">In Windows authentication scenarios, the HTTP 401 status is returned to the browser.</span></span> <span data-ttu-id="27a71-134">Этот код состояния заставляет браузер запрашивать учетные данные у пользователя через модальное диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="27a71-134">This status code causes the browser to prompt the user for their credentials via a modal dialog box.</span></span> <span data-ttu-id="27a71-135">Однако при проверке подлинности с помощью форм неавторизованное состояние HTTP 401 никогда не отправляется браузеру, так как FormsAuthenticationModule обнаруживает это состояние и изменяет его для перенаправления пользователя на страницу входа (через состояние [перенаправления HTTP 302](http://www.checkupdown.com/status/E302.html) ).</span><span class="sxs-lookup"><span data-stu-id="27a71-135">With forms authentication, however, the HTTP 401 Unauthorized status is never sent to the browser because the FormsAuthenticationModule detects this status and modifies it to redirect the user to the login page instead (via an [HTTP 302 Redirect](http://www.checkupdown.com/status/E302.html) status).</span></span>

<span data-ttu-id="27a71-136">Ответственность за страницу входа состоит в том, чтобы определить, действительны ли учетные данные пользователя, и, если да, создать билет проверки подлинности на формах и перенаправить пользователя на страницу, которую они пытались посетить.</span><span class="sxs-lookup"><span data-stu-id="27a71-136">The login page's responsibility is to determine if the user's credentials are valid and, if so, to create a forms authentication ticket and redirect the user back to the page they were attempting to visit.</span></span> <span data-ttu-id="27a71-137">Билет проверки подлинности включается в последующие запросы к страницам на веб-сайте, которые FormsAuthenticationModule использует для идентификации пользователя.</span><span class="sxs-lookup"><span data-stu-id="27a71-137">The authentication ticket is included in subsequent requests to the pages on the website, which the FormsAuthenticationModule uses to identify the user.</span></span>

<span data-ttu-id="27a71-138">[![рабочего процесса проверки подлинности с помощью форм](an-overview-of-forms-authentication-vb/_static/image2.png)](an-overview-of-forms-authentication-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-138">[![The Forms Authentication Workflow](an-overview-of-forms-authentication-vb/_static/image2.png)](an-overview-of-forms-authentication-vb/_static/image1.png)</span></span>

<span data-ttu-id="27a71-139">**Рис. 01**. Рабочий процесс проверки подлинности с помощью форм ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-139">**Figure 01**: The Forms Authentication Workflow([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image3.png))</span></span>

### <a name="remembering-the-authentication-ticket-across-page-visits"></a><span data-ttu-id="27a71-140">Запоминание билета проверки подлинности на каждом посещении страницы</span><span class="sxs-lookup"><span data-stu-id="27a71-140">Remembering the Authentication Ticket Across Page Visits</span></span>

<span data-ttu-id="27a71-141">После входа билет проверки подлинности форм должен быть отправлен обратно на веб-сервер при каждом запросе, чтобы пользователь оставался в системе при просмотре сайта.</span><span class="sxs-lookup"><span data-stu-id="27a71-141">After logging in, the forms authentication ticket must be sent back to the web server on each request so that the user remains logged in as they browse the site.</span></span> <span data-ttu-id="27a71-142">Обычно это достигается путем помещения билета проверки подлинности в коллекцию файлов cookie пользователя.</span><span class="sxs-lookup"><span data-stu-id="27a71-142">This is typically accomplished by placing the authentication ticket in the user's cookies collection.</span></span> <span data-ttu-id="27a71-143">[Файлы cookie](http://en.wikipedia.org/wiki/HTTP_cookie) — это небольшие текстовые файлы, которые находятся на компьютере пользователя и передаются в ЗАГОЛОВКАх HTTP для каждого запроса на веб-сайт, создавший файл cookie.</span><span class="sxs-lookup"><span data-stu-id="27a71-143">[Cookies](http://en.wikipedia.org/wiki/HTTP_cookie) are small text files that reside on the user's computer and are transmitted in the HTTP headers on each request to the website that created the cookie.</span></span> <span data-ttu-id="27a71-144">Таким образом, после создания билета проверки подлинности форм и сохранения его в файлах cookie браузера каждый последующий веб-узел отправляет билет проверки подлинности вместе с запросом, тем самым определяя пользователя.</span><span class="sxs-lookup"><span data-stu-id="27a71-144">Therefore, once the forms authentication ticket has been created and stored in the browser's cookies, each subsequent visit to that site sends the authentication ticket along with the request, thereby identifying the user.</span></span>

> [!NOTE]
> <span data-ttu-id="27a71-145">Демонстрационное веб-приложение, используемое в каждом учебнике, доступно для загрузки.</span><span class="sxs-lookup"><span data-stu-id="27a71-145">The demo web application used in each tutorial is available as a download.</span></span> <span data-ttu-id="27a71-146">Это загружаемое приложение было создано с помощью Visual Web Developer 2008, предназначенного для .NET Framework версии 3,5.</span><span class="sxs-lookup"><span data-stu-id="27a71-146">This downloadable application was created with Visual Web Developer 2008 targeted for the .NET Framework version 3.5.</span></span> <span data-ttu-id="27a71-147">Так как приложение предназначено для .NET 3,5, его файл Web. config содержит дополнительные элементы конфигурации, относящиеся к 3,5.</span><span class="sxs-lookup"><span data-stu-id="27a71-147">Since the application is targeted for .NET 3.5, its Web.config file includes additional, 3.5-specific configuration elements.</span></span> <span data-ttu-id="27a71-148">Короткая история. Если вы еще не установили .NET 3,5 на компьютере, загружаемое веб-приложение не будет работать без предварительного удаления разметки, относящейся к 3,5, из файла Web. config.</span><span class="sxs-lookup"><span data-stu-id="27a71-148">Long story short, if you have yet to install .NET 3.5 on your computer then the downloadable web application will not work without first removing the 3.5-specific markup from Web.config.</span></span>

<span data-ttu-id="27a71-149">Одним из аспектов файлов cookie является их срок действия, то есть дата и время, когда браузер отклоняет файл cookie.</span><span class="sxs-lookup"><span data-stu-id="27a71-149">One aspect of cookies is their expiration, which is the date and time at which the browser discards the cookie.</span></span> <span data-ttu-id="27a71-150">После истечения срока действия файла cookie проверки подлинности форм пользователь больше не сможет пройти проверку подлинности и, следовательно, станет анонимным.</span><span class="sxs-lookup"><span data-stu-id="27a71-150">When the forms authentication cookie expires, the user can no longer be authenticated and therefore become anonymous.</span></span> <span data-ttu-id="27a71-151">Когда пользователь посещается из общедоступного терминала, скорее всего, он должен истечь срок действия билета проверки подлинности, когда они закрывают свой браузер.</span><span class="sxs-lookup"><span data-stu-id="27a71-151">When a user is visiting from a public terminal, chances are they want their authentication ticket to expire when they close their browser.</span></span> <span data-ttu-id="27a71-152">Однако при посещении из дома тот же пользователь может потребовать, чтобы билет проверки подлинности запомнился при перезапуске браузера, чтобы избежать необходимости повторного входа в систему при каждом посещении сайта.</span><span class="sxs-lookup"><span data-stu-id="27a71-152">When visiting from home, however, that same user might want the authentication ticket to be remembered across browser restarts so that they do not have to re-log in each time they visit the site.</span></span> <span data-ttu-id="27a71-153">Это решение часто делается пользователем в виде флажка Запомнить мои данные на странице входа.</span><span class="sxs-lookup"><span data-stu-id="27a71-153">This decision is often made by the user in the form of a Remember me checkbox on the login page.</span></span> <span data-ttu-id="27a71-154">На шаге 3 мы рассмотрим, как реализовать флажок Запомнить мои данные на странице входа.</span><span class="sxs-lookup"><span data-stu-id="27a71-154">In Step 3 we will examine how to implement a Remember me checkbox in the login page.</span></span> <span data-ttu-id="27a71-155">В следующем учебнике подробно рассматриваются параметры времени ожидания билета проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="27a71-155">The following tutorial addresses the authentication ticket timeout settings in detail.</span></span>

> [!NOTE]
> <span data-ttu-id="27a71-156">Возможно, что агент пользователя, используемый для входа на веб-сайт, может не поддерживать файлы cookie.</span><span class="sxs-lookup"><span data-stu-id="27a71-156">It is possible that the user agent used to log on to the website may not support cookies.</span></span> <span data-ttu-id="27a71-157">В этом случае ASP.NET может использовать билеты проверки подлинности форм без файлов cookie.</span><span class="sxs-lookup"><span data-stu-id="27a71-157">In such a case, ASP.NET can use cookieless forms authentication tickets.</span></span> <span data-ttu-id="27a71-158">В этом режиме билет проверки подлинности кодируется в URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="27a71-158">In this mode, the authentication ticket is encoded into the URL.</span></span> <span data-ttu-id="27a71-159">Мы рассмотрим, когда используются билеты проверки подлинности без поддержки файлов cookie и как они создаются и управляются в следующем руководстве.</span><span class="sxs-lookup"><span data-stu-id="27a71-159">We will look at when cookieless authentication tickets are used and how they are created and managed in the next tutorial.</span></span>

### <a name="the-scope-of-forms-authentication"></a><span data-ttu-id="27a71-160">Область проверки подлинности с помощью форм</span><span class="sxs-lookup"><span data-stu-id="27a71-160">The Scope of Forms Authentication</span></span>

<span data-ttu-id="27a71-161">FormsAuthenticationModule — это управляемый код, который является частью среды выполнения ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="27a71-161">The FormsAuthenticationModule is managed code that is part of the ASP.NET runtime.</span></span> <span data-ttu-id="27a71-162">До версии 7 веб-сервера Microsoft [службы IIS (IIS)](https://www.iis.net/) существует отдельный барьер между КОНВЕЙЕРОМ HTTP IIS и конвейером среды выполнения ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="27a71-162">Prior to version 7 of Microsoft's [Internet Information Services (IIS)](https://www.iis.net/) web server, there was a distinct barrier between IIS's HTTP pipeline and the ASP.NET runtime's pipeline.</span></span> <span data-ttu-id="27a71-163">Вкратце, в IIS 6 и более ранних версиях FormsAuthenticationModule выполняется только при делегировании запроса из IIS в среду выполнения ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="27a71-163">In short, in IIS 6 and earlier, the FormsAuthenticationModule only executes when a request is delegated from IIS to the ASP.NET runtime.</span></span> <span data-ttu-id="27a71-164">По умолчанию IIS обрабатывает статическое содержимое сами по себе, например HTML-страницы, CSS и файлы изображений, и передает запросы в среду выполнения ASP.NET только при запросе страницы с расширением. aspx,. asmx или. ashx.</span><span class="sxs-lookup"><span data-stu-id="27a71-164">By default, IIS processes static content itself - like HTML pages and CSS and image files - and only hands off requests to the ASP.NET runtime when a page with an extension of .aspx, .asmx, or .ashx is requested.</span></span>

<span data-ttu-id="27a71-165">Однако IIS 7 позволяет выполнять интегрированные конвейеры IIS и ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="27a71-165">IIS 7, however, allows for integrated IIS and ASP.NET pipelines.</span></span> <span data-ttu-id="27a71-166">С помощью нескольких параметров конфигурации можно настроить IIS 7 для вызова FormsAuthenticationModule для *всех* запросов.</span><span class="sxs-lookup"><span data-stu-id="27a71-166">With a few configuration settings you can setup IIS 7 to invoke the FormsAuthenticationModule for *all* requests.</span></span> <span data-ttu-id="27a71-167">Более того, с помощью IIS 7 можно определить правила авторизации URL-адресов для файлов любого типа.</span><span class="sxs-lookup"><span data-stu-id="27a71-167">Furthermore, with IIS 7 you can define URL authorization rules for files of any type.</span></span> <span data-ttu-id="27a71-168">Дополнительные сведения см. в статьях [изменения между IIS6 и IIS7](https://www.iis.net/learn/get-started/whats-new-in-iis-7/changes-in-security-between-iis-60-and-iis-7-and-above), [безопасность веб-платформы](https://www.iis.net/learn/get-started/whats-new-in-iis-7/iis7-and-above-security-improvements)и [Общие сведения об авторизации URL-адресов IIS7](https://www.iis.net/articles/view.aspx/IIS7/Managing-IIS7/Configuring-Security/URL-Authorization/Understanding-IIS7-URL-Authorization).</span><span class="sxs-lookup"><span data-stu-id="27a71-168">For more information, see [Changes Between IIS6 and IIS7 Security](https://www.iis.net/learn/get-started/whats-new-in-iis-7/changes-in-security-between-iis-60-and-iis-7-and-above), [Your Web Platform Security](https://www.iis.net/learn/get-started/whats-new-in-iis-7/iis7-and-above-security-improvements), and [Understanding IIS7 URL Authorization](https://www.iis.net/articles/view.aspx/IIS7/Managing-IIS7/Configuring-Security/URL-Authorization/Understanding-IIS7-URL-Authorization).</span></span>

<span data-ttu-id="27a71-169">Короткая история, в версиях до IIS 7, для защиты ресурсов, обрабатываемых средой выполнения ASP.NET, можно использовать только проверку подлинности с помощью форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-169">Long story short, in versions prior to IIS 7, you can only use forms authentication to protect resources handled by the ASP.NET runtime.</span></span> <span data-ttu-id="27a71-170">Аналогичным образом правила авторизации URL-адресов применяются только к ресурсам, обрабатываемым средой выполнения ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="27a71-170">Likewise, URL authorization rules are only applied to resources handled by the ASP.NET runtime.</span></span> <span data-ttu-id="27a71-171">Но в IIS 7 можно интегрировать FormsAuthenticationModule и Урлаусоризатионмодуле в конвейер HTTP IIS, тем самым расширяя эту функциональность на все запросы.</span><span class="sxs-lookup"><span data-stu-id="27a71-171">But with IIS 7 it is possible to integrate the FormsAuthenticationModule and UrlAuthorizationModule into IIS's HTTP pipeline, thereby extending this functionality to all requests.</span></span>

## <a name="step-1-creating-an-aspnet-website-for-this-tutorial-series"></a><span data-ttu-id="27a71-172">Шаг 1. Создание веб-сайта ASP.NET для этой серии руководств</span><span class="sxs-lookup"><span data-stu-id="27a71-172">Step 1: Creating an ASP.NET Website for this Tutorial Series</span></span>

<span data-ttu-id="27a71-173">Чтобы достичь самой широкой аудитории, веб-сайт ASP.NET, который мы будем создавать в этой серии, будет создан с помощью бесплатной версии Visual Studio 2008, [Visual Web Developer 2008](https://www.microsoft.com/express/vwd/).</span><span class="sxs-lookup"><span data-stu-id="27a71-173">In order to reach the widest possible audience, the ASP.NET website we will be building throughout this series will be created with Microsoft's free version of Visual Studio 2008, [Visual Web Developer 2008](https://www.microsoft.com/express/vwd/).</span></span> <span data-ttu-id="27a71-174">В базе данных [Microsoft SQL Server 2005 Express Edition](https://msdn.microsoft.com/sql/Aa336346.aspx) будет реализовано хранилище пользователей SqlMembershipProvider.</span><span class="sxs-lookup"><span data-stu-id="27a71-174">We will implement the SqlMembershipProvider user store in a [Microsoft SQL Server 2005 Express Edition](https://msdn.microsoft.com/sql/Aa336346.aspx) database.</span></span> <span data-ttu-id="27a71-175">Если вы используете Visual Studio 2005 или другой выпуск Visual Studio 2008 или SQL Server, не беспокойтесь — шаги будут практически идентичны, и на них будут выдаваться нетривиальные различия.</span><span class="sxs-lookup"><span data-stu-id="27a71-175">If you are using Visual Studio 2005 or a different edition of Visual Studio 2008 or SQL Server, don't worry - the steps will be nearly identical and any non-trivial differences will be pointed out.</span></span>

<span data-ttu-id="27a71-176">Прежде чем можно будет настроить проверку подлинности с помощью форм, сначала требуется веб-сайт ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="27a71-176">Before we can configure forms authentication, we first need an ASP.NET website.</span></span> <span data-ttu-id="27a71-177">Начните с создания нового веб-сайта ASP.NET на основе файловой системы.</span><span class="sxs-lookup"><span data-stu-id="27a71-177">Start by creating a new file system-based ASP.NET website.</span></span> <span data-ttu-id="27a71-178">Для этого запустите Visual Web Developer, а затем перейдите в меню файл и выберите пункт Создать веб-сайт, в котором отображается диалоговое окно Новый веб-сайт.</span><span class="sxs-lookup"><span data-stu-id="27a71-178">To accomplish this, launch Visual Web Developer and then go to the File menu and choose New Web Site, displaying the New Web Site dialog box.</span></span> <span data-ttu-id="27a71-179">Выберите шаблон веб-узел ASP.NET, в раскрывающемся списке Расположение выберите Файловая система, укажите папку для размещения веб-сайта и задайте для параметра язык значение VB.</span><span class="sxs-lookup"><span data-stu-id="27a71-179">Choose the ASP.NET Web Site template, set the Location drop-down list to File System, choose a folder to place the web site, and set the language to VB.</span></span> <span data-ttu-id="27a71-180">При этом будет создан новый веб-сайт со страницей Default. aspx ASP.NET, папка данных приложения\_и файл Web. config.</span><span class="sxs-lookup"><span data-stu-id="27a71-180">This will create a new web site with a Default.aspx ASP.NET page, an App\_Data folder, and a Web.config file.</span></span>

> [!NOTE]
> <span data-ttu-id="27a71-181">Visual Studio поддерживает два режима управления проектами: проекты веб-сайтов и проекты веб-приложений.</span><span class="sxs-lookup"><span data-stu-id="27a71-181">Visual Studio supports two modes of project management: Web Site Projects and Web Application Projects.</span></span> <span data-ttu-id="27a71-182">В проектах веб-сайтов отсутствует файл проекта, а проекты веб-приложений имитируют архитектуру проекта в Visual Studio .NET 2002/2003 — они включают файл проекта и компилируются исходный код проекта в одну сборку, которая помещается в папку "переводится".</span><span class="sxs-lookup"><span data-stu-id="27a71-182">Web Site Projects lack a project file, whereas Web Application Projects mimic the project architecture in Visual Studio .NET 2002/2003 - they include a project file and compile the project's source code into a single assembly, which is placed in the /bin folder.</span></span> <span data-ttu-id="27a71-183">В Visual Studio 2005 изначально поддерживаются только проекты веб-сайтов, хотя модель проекта веб-приложения была повторно введена с пакетом обновления 1 (SP1). Visual Studio 2008 предлагает обе модели проекта.</span><span class="sxs-lookup"><span data-stu-id="27a71-183">Visual Studio 2005 initially only supported Web Site Projects, although the Web Application Project model was reintroduced with Service Pack 1; Visual Studio 2008 offers both project models.</span></span> <span data-ttu-id="27a71-184">Однако выпуски Visual Web Developer 2005 и 2008 поддерживают только проекты веб-сайтов.</span><span class="sxs-lookup"><span data-stu-id="27a71-184">The Visual Web Developer 2005 and 2008 editions, however, only support Web Site Projects.</span></span> <span data-ttu-id="27a71-185">Я буду использовать модель проекта веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="27a71-185">I will be using the Web Site Project model.</span></span> <span data-ttu-id="27a71-186">Если вы используете не Express Edition и хотите использовать [модель проекта веб-приложения](https://msdn.microsoft.com/library/aa730880(vs.80).aspx) , вы можете сделать это, но имейте в виду, что на экране могут возникнуть некоторые несоответствия, а также действия, которые необходимо выполнить, а также инструкции, приведенные в этих учебниках.</span><span class="sxs-lookup"><span data-stu-id="27a71-186">If you are using a non-Express edition and want to use the [Web Application Project model](https://msdn.microsoft.com/library/aa730880(vs.80).aspx) instead, feel free to do so but be aware that there may be some discrepancies between what you see on your screen and the steps you must take versus the screen shots shown and instructions provided in these tutorials.</span></span>

<span data-ttu-id="27a71-187">[![создать новый веб-сайт на основе файловой системы](an-overview-of-forms-authentication-vb/_static/image5.png)](an-overview-of-forms-authentication-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-187">[![Create a New File System-Based Web Site](an-overview-of-forms-authentication-vb/_static/image5.png)](an-overview-of-forms-authentication-vb/_static/image4.png)</span></span>

<span data-ttu-id="27a71-188">**Рис. 02**. Создание нового веб-сайта на основе файловой системы ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-188">**Figure 02**: Create a New File System-Based Web Site([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image6.png))</span></span>

### <a name="adding-a-master-page"></a><span data-ttu-id="27a71-189">Добавление главной страницы</span><span class="sxs-lookup"><span data-stu-id="27a71-189">Adding a Master Page</span></span>

<span data-ttu-id="27a71-190">Затем добавьте новую главную страницу к сайту в корневом каталоге с именем site. master.</span><span class="sxs-lookup"><span data-stu-id="27a71-190">Next, add a new Master Page to the site in the root directory named Site.master.</span></span> <span data-ttu-id="27a71-191">[Главные страницы](https://msdn.microsoft.com/library/wtxbf3hh.aspx) позволяют разработчику страницы определить шаблон на уровне сайта, который можно применить к страницам ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="27a71-191">[Master pages](https://msdn.microsoft.com/library/wtxbf3hh.aspx) enable a page developer to define a site-wide template that can be applied to ASP.NET pages.</span></span> <span data-ttu-id="27a71-192">Основным преимуществом главных страниц является то, что общий внешний вид узла можно определить в одном месте, что упрощает обновление или настройку макета сайта.</span><span class="sxs-lookup"><span data-stu-id="27a71-192">The main benefit of master pages is that the site's overall appearance can be defined in a single location, thereby making it easy to update or tweak the site's layout.</span></span>

<span data-ttu-id="27a71-193">[![добавить главную страницу с именем site. master на веб-сайт](an-overview-of-forms-authentication-vb/_static/image8.png)](an-overview-of-forms-authentication-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-193">[![Add a Master Page Named Site.master to the Website](an-overview-of-forms-authentication-vb/_static/image8.png)](an-overview-of-forms-authentication-vb/_static/image7.png)</span></span>

<span data-ttu-id="27a71-194">**Рис. 03**. Добавление главной страницы с именем site. master на веб-сайт ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-194">**Figure 03**: Add a Master Page Named Site.master to the Website([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image9.png))</span></span>

<span data-ttu-id="27a71-195">Определите макет страницы для всего сайта на главной странице.</span><span class="sxs-lookup"><span data-stu-id="27a71-195">Define the site-wide page layout here in the master page.</span></span> <span data-ttu-id="27a71-196">Вы можете использовать представление конструирования и добавлять необходимые макеты или веб-элементы управления, или вручную добавить разметку в представлении источника.</span><span class="sxs-lookup"><span data-stu-id="27a71-196">You can use the Design view and add whatever Layout or Web controls you need, or you can manually add the markup by hand in the Source view.</span></span> <span data-ttu-id="27a71-197">Макет главной страницы был структурирован так, чтобы имитировать макет, используемый при *[работе с данными в руководстве по ASP.NET 2,0](../../data-access/index.md)* (см. рис. 4).</span><span class="sxs-lookup"><span data-stu-id="27a71-197">I structured my master page's layout to mimic the layout used in my *[Working with Data in ASP.NET 2.0](../../data-access/index.md)* tutorial series (see Figure 4).</span></span> <span data-ttu-id="27a71-198">Главная страница использует [каскадные таблицы стилей](http://www.w3schools.com/css/default.asp) для позиционирования и стилей с параметрами CSS, определенными в файле style. CSS (который входит в состав этого руководства).</span><span class="sxs-lookup"><span data-stu-id="27a71-198">The master page uses [cascading style sheets](http://www.w3schools.com/css/default.asp) for positioning and styles with the CSS settings defined in the file Style.css (which is included in this tutorial's associated download).</span></span> <span data-ttu-id="27a71-199">Хотя вы не можете отличить приведенную ниже разметку, правила CSS определяются таким образом, что элемент навигации &lt;div&gt;содержимым абсолютно позиционирован, чтобы он отображался слева и имеет фиксированную ширину 200 пикселей.</span><span class="sxs-lookup"><span data-stu-id="27a71-199">While you cannot tell from the markup shown below, the CSS rules are defined such that the navigation &lt;div&gt;'s content is absolutely positioned so that it appears on the left and has a fixed width of 200 pixels.</span></span>

[!code-aspx[Main](an-overview-of-forms-authentication-vb/samples/sample1.aspx)]

<span data-ttu-id="27a71-200">Эталонная страница определяет как статический макет страницы, так и регионы, которые можно изменять с помощью страниц ASP.NET, использующих главную страницу.</span><span class="sxs-lookup"><span data-stu-id="27a71-200">A master page defines both the static page layout and the regions that can be edited by the ASP.NET pages that use the master page.</span></span> <span data-ttu-id="27a71-201">Эти изменяемые регионы обозначаются элементом управления ContentPlaceHolder, который можно увидеть в содержимом &lt;div&gt;.</span><span class="sxs-lookup"><span data-stu-id="27a71-201">These content editable regions are indicated by the ContentPlaceHolder control, which can be seen within the content &lt;div&gt;.</span></span> <span data-ttu-id="27a71-202">Наша главная страница имеет один элемент ContentPlaceHolder (MainContent), но у главной страницы может быть несколько элементов управления ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="27a71-202">Our master page has a single ContentPlaceHolder (MainContent), but master page's may have multiple ContentPlaceHolders.</span></span>

<span data-ttu-id="27a71-203">После того, как была указана разметка, переход на представление конструирования отображает макет главной страницы.</span><span class="sxs-lookup"><span data-stu-id="27a71-203">With the markup entered above, switching to the Design view shows the master page's layout.</span></span> <span data-ttu-id="27a71-204">Все страницы ASP.NET, использующие эту эталонную страницу, будут иметь такой единообразный макет с возможностью указать разметку для региона MainContent.</span><span class="sxs-lookup"><span data-stu-id="27a71-204">Any ASP.NET pages that use this master page will have this uniform layout, with the ability to specify the markup for the MainContent region.</span></span>

<span data-ttu-id="27a71-205">[![главную страницу при просмотре в режиме конструктора](an-overview-of-forms-authentication-vb/_static/image11.png)](an-overview-of-forms-authentication-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-205">[![The Master Page, When Viewed Through the Design View](an-overview-of-forms-authentication-vb/_static/image11.png)](an-overview-of-forms-authentication-vb/_static/image10.png)</span></span>

<span data-ttu-id="27a71-206">**Рис. 04**. Главная страница при просмотре в режиме конструктора ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-206">**Figure 04**:The Master Page, When Viewed Through the Design View([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image12.png))</span></span>

### <a name="creating-content-pages"></a><span data-ttu-id="27a71-207">Создание страниц содержимого</span><span class="sxs-lookup"><span data-stu-id="27a71-207">Creating Content Pages</span></span>

<span data-ttu-id="27a71-208">На этом этапе у нас есть страница Default. aspx на нашем веб-сайте, но она не использует только что созданную главную страницу.</span><span class="sxs-lookup"><span data-stu-id="27a71-208">At this point we have a Default.aspx page in our website, but it does not use the master page we just created.</span></span> <span data-ttu-id="27a71-209">Хотя можно управлять декларативной разметкой веб-страницы для использования главной страницы, если страница не содержит содержимого, проще просто удалить страницу и снова добавить ее в проект, указав главную страницу для использования.</span><span class="sxs-lookup"><span data-stu-id="27a71-209">While it is possible to manipulate the declarative markup of a web page to use a master page, if the page doesn't contain any content yet it is easier to just delete the page and re-add it to the project, specifying the master page to use.</span></span> <span data-ttu-id="27a71-210">Поэтому начните с удаления Default. aspx из проекта.</span><span class="sxs-lookup"><span data-stu-id="27a71-210">Therefore, start by deleting Default.aspx from the project.</span></span>

<span data-ttu-id="27a71-211">Затем щелкните правой кнопкой мыши имя проекта в обозреватель решений и выберите Добавить новую веб-форму с именем Default. aspx.</span><span class="sxs-lookup"><span data-stu-id="27a71-211">Next, right-click on the project name in the Solution Explorer and choose to add a new Web Form named Default.aspx.</span></span> <span data-ttu-id="27a71-212">На этот раз установите флажок Выбрать главную страницу и выберите главную страницу site. master из списка.</span><span class="sxs-lookup"><span data-stu-id="27a71-212">This time, check the Select master page checkbox and choose the Site.master master page from the list.</span></span>

<span data-ttu-id="27a71-213">[![добавить новую страницу Default. aspx, выбранную для выбора главной страницы](an-overview-of-forms-authentication-vb/_static/image14.png)](an-overview-of-forms-authentication-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-213">[![Add a New Default.aspx Page Choosing to Select a Master Page](an-overview-of-forms-authentication-vb/_static/image14.png)](an-overview-of-forms-authentication-vb/_static/image13.png)</span></span>

<span data-ttu-id="27a71-214">**Рис. 05**. Добавление новой страницы Default. aspx выбор главной страницы ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-214">**Figure 05**: Add a New Default.aspx Page Choosing to Select a Master Page([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image15.png))</span></span>

<span data-ttu-id="27a71-215">[![использовать главную страницу site. master](an-overview-of-forms-authentication-vb/_static/image17.png)](an-overview-of-forms-authentication-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-215">[![Use the Site.master Master Page](an-overview-of-forms-authentication-vb/_static/image17.png)](an-overview-of-forms-authentication-vb/_static/image16.png)</span></span>

<span data-ttu-id="27a71-216">**Рис. 6**. Использование главной страницы Site. master ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-216">**Figure 06**: Use the Site.master Master Page([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="27a71-217">При использовании модели проекта веб-приложения диалоговое окно Добавление нового элемента не включает флажок Выбрать главную страницу.</span><span class="sxs-lookup"><span data-stu-id="27a71-217">If you are using the Web Application Project Model the Add New Item dialog box does not include a Select master page checkbox.</span></span> <span data-ttu-id="27a71-218">Вместо этого необходимо добавить элемент типа форма веб-содержимого.</span><span class="sxs-lookup"><span data-stu-id="27a71-218">Instead, you need to add an item of type Web Content Form.</span></span> <span data-ttu-id="27a71-219">После выбора параметра форма веб-содержимого и нажатия кнопки Добавить Visual Studio отобразит то же диалоговое окно Выбор мастера, показанное на рис. 6.</span><span class="sxs-lookup"><span data-stu-id="27a71-219">After choosing the Web Content Form option and clicking Add, Visual Studio will display the same Select a Master dialog box shown in Figure 6.</span></span>

<span data-ttu-id="27a71-220">Новая декларативная разметка страницы Default. aspx включает только директиву @Page, указывающую путь к файлу главной страницы и элемент управления содержимым для MainContent ContentPlaceHolder главной страницы.</span><span class="sxs-lookup"><span data-stu-id="27a71-220">The new Default.aspx page's declarative markup includes just a @Page directive specifying the path to the master page file and a Content control for the master page's MainContent ContentPlaceHolder.</span></span>

[!code-aspx[Main](an-overview-of-forms-authentication-vb/samples/sample2.aspx)]

<span data-ttu-id="27a71-221">Пока оставьте пустым Default. aspx.</span><span class="sxs-lookup"><span data-stu-id="27a71-221">For now, leave Default.aspx empty.</span></span> <span data-ttu-id="27a71-222">Далее в этом руководстве мы вернемся к нему, чтобы добавить содержимое.</span><span class="sxs-lookup"><span data-stu-id="27a71-222">We will return to it later in this tutorial to add content.</span></span>

> [!NOTE]
> <span data-ttu-id="27a71-223">Главная страница содержит раздел для меню или другой интерфейс навигации.</span><span class="sxs-lookup"><span data-stu-id="27a71-223">Our master page includes a section for a menu or some other navigation interface.</span></span> <span data-ttu-id="27a71-224">В следующем учебном курсе мы создадим такой интерфейс.</span><span class="sxs-lookup"><span data-stu-id="27a71-224">We will create such an interface in a future tutorial.</span></span>

## <a name="step-2-enabling-forms-authentication"></a><span data-ttu-id="27a71-225">Шаг 2. Включение проверки подлинности с помощью форм</span><span class="sxs-lookup"><span data-stu-id="27a71-225">Step 2: Enabling Forms Authentication</span></span>

<span data-ttu-id="27a71-226">После создания веб-сайта ASP.NET необходимо включить проверку подлинности с помощью форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-226">With the ASP.NET website created, our next task is to enable forms authentication.</span></span> <span data-ttu-id="27a71-227">Конфигурация проверки подлинности приложения указывается с помощью [элемента&gt; проверки подлинности&lt;](https://msdn.microsoft.com/library/532aee0e.aspx) в файле Web. config. Элемент&gt; проверки подлинности &lt;содержит единственный атрибут с именем mode, указывающий модель проверки подлинности, используемую приложением.</span><span class="sxs-lookup"><span data-stu-id="27a71-227">The application's authentication configuration is specified through the [&lt;authentication&gt; element](https://msdn.microsoft.com/library/532aee0e.aspx) in Web.config. The &lt;authentication&gt; element contains a single attribute named mode that specifies the authentication model used by the application.</span></span> <span data-ttu-id="27a71-228">Этот атрибут может иметь одно из следующих четырех значений:</span><span class="sxs-lookup"><span data-stu-id="27a71-228">This attribute can have one of the following four values:</span></span>

- <span data-ttu-id="27a71-229">**Windows** , как обсуждалось в предыдущем учебнике, когда приложение использует проверку подлинности Windows, веб-сервер отвечает за проверку подлинности посетителя, и обычно выполняется с помощью обычной, дайджестовой или встроенной проверки подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="27a71-229">**Windows** - as discussed in the preceding tutorial, when an application uses Windows authentication it is the web server's responsibility to authenticate the visitor, and this is usually done through Basic, Digest, or Integrated Windows authentication.</span></span>
- <span data-ttu-id="27a71-230">**Формы**— пользователи проходят проверку подлинности через форму на веб-странице.</span><span class="sxs-lookup"><span data-stu-id="27a71-230">**Forms**- users are authenticated via a form on a web page.</span></span>
- <span data-ttu-id="27a71-231">**Passport**— пользователи проходят проверку подлинности с помощью сети Microsoft Passport Network.</span><span class="sxs-lookup"><span data-stu-id="27a71-231">**Passport**- users are authenticated using Microsoft's Passport Network.</span></span>
- <span data-ttu-id="27a71-232">**None**— модель проверки подлинности не используется; Все посетители являются анонимными.</span><span class="sxs-lookup"><span data-stu-id="27a71-232">**None**- no authentication model is used; all visitors are anonymous.</span></span>

<span data-ttu-id="27a71-233">По умолчанию приложения ASP.NET используют проверку подлинности Windows.</span><span class="sxs-lookup"><span data-stu-id="27a71-233">By default, ASP.NET applications use Windows authentication.</span></span> <span data-ttu-id="27a71-234">Чтобы изменить тип проверки подлинности на проверку подлинности с помощью форм, необходимо изменить атрибут mode &lt;проверки подлинности&gt; элемента на формы.</span><span class="sxs-lookup"><span data-stu-id="27a71-234">To change the authentication type to forms authentication, then, we need to modify the &lt;authentication&gt; element's mode attribute to Forms.</span></span>

<span data-ttu-id="27a71-235">Если проект еще не содержит файл Web. config, добавьте его сейчас, щелкнув правой кнопкой мыши имя проекта в обозреватель решений, выбрав пункт Добавить новый элемент, а затем добавив файл веб-конфигурации.</span><span class="sxs-lookup"><span data-stu-id="27a71-235">If your project does not yet contain a Web.config file, add one now by right-clicking on the project name in the Solution Explorer, choosing Add New Item, and then adding a Web Configuration file.</span></span>

<span data-ttu-id="27a71-236">[![, если проект еще не содержит файл Web. config, добавьте его сейчас](an-overview-of-forms-authentication-vb/_static/image20.png)](an-overview-of-forms-authentication-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-236">[![If Your Project Does Not Yet Include Web.config, Add It Now](an-overview-of-forms-authentication-vb/_static/image20.png)](an-overview-of-forms-authentication-vb/_static/image19.png)</span></span>

<span data-ttu-id="27a71-237">**Рис. 07**. Если в проекте еще не включен файл Web. config, добавьте его сейчас ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-237">**Figure 07**: If Your Project Does Not Yet Include Web.config, Add It Now([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image21.png))</span></span>

<span data-ttu-id="27a71-238">Затем выберите элемент&gt; проверки подлинности &lt;и обновите его, чтобы использовать проверку подлинности с помощью форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-238">Next, locate the &lt;authentication&gt; element and update it to use forms authentication.</span></span> <span data-ttu-id="27a71-239">После этого изменения разметка файла Web. config должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="27a71-239">After this change, your Web.config file's markup should look similar to the following:</span></span>

[!code-xml[Main](an-overview-of-forms-authentication-vb/samples/sample3.xml)]

> [!NOTE]
> <span data-ttu-id="27a71-240">Так как файл Web. config является XML-файлом, важен регистр.</span><span class="sxs-lookup"><span data-stu-id="27a71-240">Since Web.config is an XML file, casing is important.</span></span> <span data-ttu-id="27a71-241">Убедитесь, что для атрибута mode задано значение Forms с заглавной буквой F. Если используется другой регистр, например формы, при посещении сайта через браузер возникнет ошибка конфигурации.</span><span class="sxs-lookup"><span data-stu-id="27a71-241">Make sure that you set the mode attribute to Forms, with a capital F. If you use a different casing, such as forms, you'll receive a configuration error when visiting the site through a browser.</span></span>

<span data-ttu-id="27a71-242">Элемент&gt; проверки подлинности &lt;может содержать дочерний элемент &lt;Forms&gt;, содержащий параметры, относящиеся к проверке подлинности форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-242">The &lt;authentication&gt; element may optionally include a &lt;forms&gt; child element that contains forms authentication-specific settings.</span></span> <span data-ttu-id="27a71-243">Сейчас давайте просто используем параметры проверки подлинности форм по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="27a71-243">For now, let's just use the default forms authentication settings.</span></span> <span data-ttu-id="27a71-244">В следующем руководстве мы рассмотрим &lt;Forms&gt; дочерний элемент более подробно.</span><span class="sxs-lookup"><span data-stu-id="27a71-244">We will explore the &lt;forms&gt; child element in more detail in the next tutorial.</span></span>

## <a name="step-3-building-the-login-page"></a><span data-ttu-id="27a71-245">Шаг 3. Создание страницы входа</span><span class="sxs-lookup"><span data-stu-id="27a71-245">Step 3: Building the Login Page</span></span>

<span data-ttu-id="27a71-246">Для поддержки проверки подлинности с помощью форм веб-сайту требуется страница входа.</span><span class="sxs-lookup"><span data-stu-id="27a71-246">In order to support forms authentication our website needs a login page.</span></span> <span data-ttu-id="27a71-247">Как обсуждалось в разделе Общие сведения о рабочем процессе проверки подлинности с помощью форм, FormsAuthenticationModule автоматически перенаправит пользователя на страницу входа, если попытается получить доступ к странице, которая не разрешена для просмотра.</span><span class="sxs-lookup"><span data-stu-id="27a71-247">As discussed in the Understanding the Forms Authentication Workflow section, the FormsAuthenticationModule will automatically redirect the user to the login page if they attempt to access a page that they are not authorized to view.</span></span> <span data-ttu-id="27a71-248">Есть также ASP.NET веб-элементы управления, которые будут отображать ссылку на страницу входа для анонимных пользователей.</span><span class="sxs-lookup"><span data-stu-id="27a71-248">There are also ASP.NET Web controls that will display a link to the login page to anonymous users.</span></span> <span data-ttu-id="27a71-249">Это возникает вопрос: что такое URL-адрес страницы входа?</span><span class="sxs-lookup"><span data-stu-id="27a71-249">This begs the question, What is the URL of the login page?</span></span>

<span data-ttu-id="27a71-250">По умолчанию система проверки подлинности форм ждет, что страница входа имеет имя Login. aspx и размещается в корневом каталоге веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="27a71-250">By default, the forms authentication system expects the login page to be named Login.aspx and placed in the root directory of the web application.</span></span> <span data-ttu-id="27a71-251">Если вы хотите использовать другой URL-адрес страницы входа, это можно сделать, указав его в файле Web. config. В следующем руководстве мы посмотрим, как это сделать.</span><span class="sxs-lookup"><span data-stu-id="27a71-251">If you want to use a different login page URL, you can do so by specifying it in Web.config. We will see how to do this in the subsequent tutorial.</span></span>

<span data-ttu-id="27a71-252">Страница входа имеет три обязанности:</span><span class="sxs-lookup"><span data-stu-id="27a71-252">The login page has three responsibilities:</span></span>

1. <span data-ttu-id="27a71-253">Предоставьте интерфейс, позволяющий посетителю вводить свои учетные данные.</span><span class="sxs-lookup"><span data-stu-id="27a71-253">Provide an interface that allows the visitor to enter their credentials.</span></span>
2. <span data-ttu-id="27a71-254">Определите, являются ли отправленные учетные данные допустимыми.</span><span class="sxs-lookup"><span data-stu-id="27a71-254">Determine if the submitted credentials are valid.</span></span>
3. <span data-ttu-id="27a71-255">Войдите в систему пользователя, создав билет проверки подлинности с помощью форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-255">Log in the user by creating the forms authentication ticket.</span></span>

### <a name="creating-the-login-pages-user-interface"></a><span data-ttu-id="27a71-256">Создание пользовательского интерфейса страницы входа</span><span class="sxs-lookup"><span data-stu-id="27a71-256">Creating the Login Page's User Interface</span></span>

<span data-ttu-id="27a71-257">Давайте приступим к работе с первой задачей.</span><span class="sxs-lookup"><span data-stu-id="27a71-257">Let's get started with the first task.</span></span> <span data-ttu-id="27a71-258">Добавьте новую страницу ASP.NET в корневой каталог сайта с именем Login. aspx и свяжите ее с главной страницей site. master.</span><span class="sxs-lookup"><span data-stu-id="27a71-258">Add a new ASP.NET page to the site's root directory named Login.aspx and associate it with the Site.master master page.</span></span>

<span data-ttu-id="27a71-259">[![добавить новую страницу ASP.NET с именем Login. aspx](an-overview-of-forms-authentication-vb/_static/image23.png)](an-overview-of-forms-authentication-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-259">[![Add a New ASP.NET Page Named Login.aspx](an-overview-of-forms-authentication-vb/_static/image23.png)](an-overview-of-forms-authentication-vb/_static/image22.png)</span></span>

<span data-ttu-id="27a71-260">**Рис. 08**. Добавление новой страницы ASP.NET с именем Login. aspx ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-260">**Figure 08**: Add a New ASP.NET Page Named Login.aspx([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image24.png))</span></span>

<span data-ttu-id="27a71-261">Типичный интерфейс страницы входа состоит из двух текстовых полей: одно для имени пользователя, одно для пароля и кнопку для отправки формы.</span><span class="sxs-lookup"><span data-stu-id="27a71-261">The typical login page interface consists of two textboxes - one for the user's name, one for their password - and a button to submit the form.</span></span> <span data-ttu-id="27a71-262">Веб-сайты часто содержат флажок Запомнить мои учетные результаты, который, если отмечено, сохраняет полученный билет проверки подлинности для перезапуска браузера.</span><span class="sxs-lookup"><span data-stu-id="27a71-262">Websites oftentimes include a Remember me checkbox that, if checked, persists the resulting authentication ticket across browser restarts.</span></span>

<span data-ttu-id="27a71-263">Добавьте два текстовых поля в login. aspx и задайте для их свойств идентификатора имя пользователя и пароль соответственно.</span><span class="sxs-lookup"><span data-stu-id="27a71-263">Add two TextBoxes to Login.aspx and set their ID properties to UserName and Password, respectively.</span></span> <span data-ttu-id="27a71-264">Также задайте для свойства TextMode пароля значение Password.</span><span class="sxs-lookup"><span data-stu-id="27a71-264">Also set Password's TextMode property to Password.</span></span> <span data-ttu-id="27a71-265">Затем добавьте элемент управления CheckBox, задав для его свойства ID значение RememberMe и его свойство Text, чтобы запомнить меня.</span><span class="sxs-lookup"><span data-stu-id="27a71-265">Next, add a CheckBox control, setting its ID property to RememberMe and its Text property to Remember Me.</span></span> <span data-ttu-id="27a71-266">После этого добавьте кнопку с именем Логинбуттон, для которой свойство Text имеет значение login.</span><span class="sxs-lookup"><span data-stu-id="27a71-266">Following that, add a Button named LoginButton whose Text property is set to Login.</span></span> <span data-ttu-id="27a71-267">И, наконец, добавьте веб-элемент управления Label и задайте для его свойства ID значение Инвалидкредентиалсмессаже. его свойство Text имеет недопустимое имя пользователя или пароль.</span><span class="sxs-lookup"><span data-stu-id="27a71-267">And finally, add a Label Web control and set its ID property to InvalidCredentialsMessage, its Text property to Your username or password is invalid.</span></span> <span data-ttu-id="27a71-268">Повторите попытку. свойство ForeColor имеет значение Red, а для свойства Visible — значение false.</span><span class="sxs-lookup"><span data-stu-id="27a71-268">Please try again., its ForeColor property to Red, and its Visible property to False.</span></span>

<span data-ttu-id="27a71-269">На этом этапе экран должен выглядеть аналогично снимку экрана на рис. 9, а декларативный синтаксис страницы должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="27a71-269">At this point your screen should look similar to the screen shot in Figure 9, and your page's declarative syntax should like the following:</span></span>

[!code-aspx[Main](an-overview-of-forms-authentication-vb/samples/sample4.aspx)]

<span data-ttu-id="27a71-270">[![страница входа содержит два текстовых поля, флажок, кнопку и метку.](an-overview-of-forms-authentication-vb/_static/image26.png)](an-overview-of-forms-authentication-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-270">[![The Login Page Contains Two TextBoxes, a CheckBox, a Button, and a Label](an-overview-of-forms-authentication-vb/_static/image26.png)](an-overview-of-forms-authentication-vb/_static/image25.png)</span></span>

<span data-ttu-id="27a71-271">**Рис. 09**. страница входа содержит два текстовых поля, флажок, кнопку и метку ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image27.png)).</span><span class="sxs-lookup"><span data-stu-id="27a71-271">**Figure 09**: The Login Page Contains Two TextBoxes, a CheckBox, a Button, and a Label([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image27.png))</span></span>

<span data-ttu-id="27a71-272">Наконец, создайте обработчик событий для события Click Логинбуттон.</span><span class="sxs-lookup"><span data-stu-id="27a71-272">Finally, create an event handler for the LoginButton's Click event.</span></span> <span data-ttu-id="27a71-273">В конструкторе просто дважды щелкните элемент управления "Кнопка", чтобы создать этот обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="27a71-273">From the Designer, simply double-click the Button control to create this event handler.</span></span>

### <a name="determining-if-the-supplied-credentials-are-valid"></a><span data-ttu-id="27a71-274">Определение допустимости предоставленных учетных данных</span><span class="sxs-lookup"><span data-stu-id="27a71-274">Determining If the Supplied Credentials are Valid</span></span>

<span data-ttu-id="27a71-275">Теперь необходимо реализовать задачу 2 в обработчике событий нажатия кнопки, чтобы определить, являются ли предоставленные учетные данные допустимыми.</span><span class="sxs-lookup"><span data-stu-id="27a71-275">We now need to implement task 2 in the Button's Click event handler - determining whether the supplied credentials are valid.</span></span> <span data-ttu-id="27a71-276">Для этого необходимо, чтобы в хранилище пользователя содержались все учетные данные пользователей, чтобы можно было определить, совпадают ли предоставленные учетные данные с любыми известными учетными данными.</span><span class="sxs-lookup"><span data-stu-id="27a71-276">In order to do this there needs to be a user store that holds all of the users' credentials so that we can determine if the supplied credentials match up with any known credentials.</span></span>

<span data-ttu-id="27a71-277">До ASP.NET 2,0 разработчики отвечали за реализацию собственных хранилищ пользователей и написание кода для проверки предоставленных учетных данных в магазине.</span><span class="sxs-lookup"><span data-stu-id="27a71-277">Prior to ASP.NET 2.0, developers were responsible for implementing both their own user stores and writing the code to validate the supplied credentials against the store.</span></span> <span data-ttu-id="27a71-278">Большинство разработчиков реализуют хранилище пользователей в базе данных, создавая таблицу с именем Users с такими столбцами, как имя пользователя, пароль, электронная почта, LastLoginDate и т. д.</span><span class="sxs-lookup"><span data-stu-id="27a71-278">Most developers would implement the user store in a database, creating a table named Users with columns like UserName, Password, Email, LastLoginDate, and so forth.</span></span> <span data-ttu-id="27a71-279">Эта таблица, а затем, будет иметь одну запись для каждой учетной записи пользователя.</span><span class="sxs-lookup"><span data-stu-id="27a71-279">This table, then, would have one record per user account.</span></span> <span data-ttu-id="27a71-280">Проверка предоставленных учетных данных пользователя влечет за собой запрос соответствующего имени пользователя в базе данных, а затем гарантирует, что пароль в базе данных соответствует предоставленному паролю.</span><span class="sxs-lookup"><span data-stu-id="27a71-280">Verifying a user's supplied credentials would involve querying the database for a matching username and then ensuring that the password in the database corresponded to the supplied password.</span></span>

<span data-ttu-id="27a71-281">С помощью ASP.NET 2,0 разработчики должны использовать одного из поставщиков членства для управления хранилищем пользователей.</span><span class="sxs-lookup"><span data-stu-id="27a71-281">With ASP.NET 2.0, developers should use one of the Membership providers to manage the user store.</span></span> <span data-ttu-id="27a71-282">В этой серии руководств мы будем использовать SqlMembershipProvider, который использует базу данных SQL Server для хранилища пользователей.</span><span class="sxs-lookup"><span data-stu-id="27a71-282">In this tutorial series we will be using the SqlMembershipProvider, which uses a SQL Server database for the user store.</span></span> <span data-ttu-id="27a71-283">При использовании SqlMembershipProvider необходимо реализовать определенную схему базы данных, включающую таблицы, представления и хранимые процедуры, ожидаемые поставщиком.</span><span class="sxs-lookup"><span data-stu-id="27a71-283">When using the SqlMembershipProvider we need to implement a specific database schema that includes the tables, views, and stored procedures expected by the provider.</span></span> <span data-ttu-id="27a71-284">Мы рассмотрим, как реализовать эту схему в руководстве *[Создание схемы членства в SQL Server](../membership/creating-the-membership-schema-in-sql-server-vb.md)* .</span><span class="sxs-lookup"><span data-stu-id="27a71-284">We will examine how to implement this schema in the *[Creating the Membership Schema in SQL Server](../membership/creating-the-membership-schema-in-sql-server-vb.md)* tutorial.</span></span> <span data-ttu-id="27a71-285">При наличии поставщика членства проверка учетных данных пользователя выполняется так же просто, как вызов метода ValidateUser [класса членства](https://msdn.microsoft.com/library/system.web.security.membership.aspx) [(*имя пользователя*, *пароль*)](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx), который возвращает логическое значение, указывающее, действительно ли введено сочетание *имени пользователя* и *пароля* .</span><span class="sxs-lookup"><span data-stu-id="27a71-285">With the Membership provider in place, validating the user's credentials is as simple as calling the [Membership class](https://msdn.microsoft.com/library/system.web.security.membership.aspx)'s [ValidateUser(*username*, *password*) method](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx), which returns a Boolean value indicating whether the validity of the *username* and *password* combination.</span></span> <span data-ttu-id="27a71-286">Пока мы еще не реализовали хранилище пользователей SqlMembershipProvider, в настоящее время невозможно использовать метод ValidateUser класса Membership.</span><span class="sxs-lookup"><span data-stu-id="27a71-286">Seeing as we have not yet implemented the SqlMembershipProvider's user store, we cannot use the Membership class's ValidateUser method at this time.</span></span>

<span data-ttu-id="27a71-287">Вместо того, чтобы создавать собственную таблицу пользовательской базы данных Users (которая будет устаревшей после реализации SqlMembershipProvider), давайте жестко зададим действительные учетные данные на странице входа в систему.</span><span class="sxs-lookup"><span data-stu-id="27a71-287">Rather than take the time to build our own custom Users database table (which would be obsolete once we implemented the SqlMembershipProvider), let's instead hard-code the valid credentials within the login page itself.</span></span> <span data-ttu-id="27a71-288">В обработчике событий Click для Логинбуттон добавьте следующий код:</span><span class="sxs-lookup"><span data-stu-id="27a71-288">In the LoginButton's Click event handler, add the following code:</span></span>

[!code-vb[Main](an-overview-of-forms-authentication-vb/samples/sample5.vb)]

<span data-ttu-id="27a71-289">Как видите, есть три допустимых учетных записи пользователя — Скотт, Цзисунь и SAM — и все три имеют одинаковый пароль (пароль).</span><span class="sxs-lookup"><span data-stu-id="27a71-289">As you can see, there are three valid user accounts - Scott, Jisun, and Sam - and all three have the same password ( password ).</span></span> <span data-ttu-id="27a71-290">Код просматривает массивы пользователей и паролей для поиска допустимого имени пользователя и пароля.</span><span class="sxs-lookup"><span data-stu-id="27a71-290">The code loops through the users and passwords arrays looking for a valid username and password match.</span></span> <span data-ttu-id="27a71-291">Если имя пользователя и пароль действительны, необходимо выполнить вход пользователя и перенаправить их на соответствующую страницу.</span><span class="sxs-lookup"><span data-stu-id="27a71-291">If both the username and password are valid, we need to login the user and then redirect them to the appropriate page.</span></span> <span data-ttu-id="27a71-292">Если учетные данные недопустимы, отобразится метка Инвалидкредентиалсмессаже.</span><span class="sxs-lookup"><span data-stu-id="27a71-292">If the credentials are invalid, then we display the InvalidCredentialsMessage Label.</span></span>

<span data-ttu-id="27a71-293">Когда пользователь вводит действительные учетные данные, я упомянул, что они перенаправляются на соответствующую страницу.</span><span class="sxs-lookup"><span data-stu-id="27a71-293">When a user enters valid credentials, I mentioned that they are then redirected to the appropriate page.</span></span> <span data-ttu-id="27a71-294">Что же такое страница?</span><span class="sxs-lookup"><span data-stu-id="27a71-294">What is the appropriate page, though?</span></span> <span data-ttu-id="27a71-295">Помните, что когда пользователь посещает страницу, которой не разрешено просматривать, FormsAuthenticationModule автоматически перенаправляет их на страницу входа.</span><span class="sxs-lookup"><span data-stu-id="27a71-295">Recall that when a user visits a page they are not authorized to view, the FormsAuthenticationModule automatically redirects them to the login page.</span></span> <span data-ttu-id="27a71-296">При этом он включает запрошенный URL-адрес в строку запроса через параметр ReturnUrl.</span><span class="sxs-lookup"><span data-stu-id="27a71-296">In doing so, it includes the requested URL in the querystring via the ReturnUrl parameter.</span></span> <span data-ttu-id="27a71-297">Это значит, что если пользователь пытался посетить Протектедпаже. aspx и ему не было предоставлено разрешение, FormsAuthenticationModule перенаправит их в:</span><span class="sxs-lookup"><span data-stu-id="27a71-297">That is, if a user attempted to visit ProtectedPage.aspx, and they were not authorized to do so, the FormsAuthenticationModule would redirect them to:</span></span>

<span data-ttu-id="27a71-298">Login. aspx? ReturnUrl = Протектедпаже. aspx</span><span class="sxs-lookup"><span data-stu-id="27a71-298">Login.aspx?ReturnUrl=ProtectedPage.aspx</span></span>

<span data-ttu-id="27a71-299">После успешного входа пользователь должен быть перенаправлен обратно в Протектедпаже. aspx.</span><span class="sxs-lookup"><span data-stu-id="27a71-299">Upon successfully logging in, the user should be redirected back to ProtectedPage.aspx.</span></span> <span data-ttu-id="27a71-300">Кроме того, пользователи могут посетить страницу входа на свой собственный желанию.</span><span class="sxs-lookup"><span data-stu-id="27a71-300">Alternatively, users may visit the login page on their own volition.</span></span> <span data-ttu-id="27a71-301">В этом случае после входа в систему пользователь должен отправить на страницу Default. aspx корневой папки.</span><span class="sxs-lookup"><span data-stu-id="27a71-301">In that case, after logging in the user they should be sent to the root folder's Default.aspx page.</span></span>

### <a name="logging-in-the-user"></a><span data-ttu-id="27a71-302">Вход пользователя в систему</span><span class="sxs-lookup"><span data-stu-id="27a71-302">Logging In the User</span></span>

<span data-ttu-id="27a71-303">Предполагая, что предоставленные учетные данные действительны, необходимо создать билет проверки подлинности на формах, что ведет к входу пользователя на сайт.</span><span class="sxs-lookup"><span data-stu-id="27a71-303">Assuming that the supplied credentials are valid, we need to create a forms authentication ticket, thereby logging in the user to the site.</span></span> <span data-ttu-id="27a71-304">[Класс FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthentication.aspx) в [пространстве имен System. Web. Security](https://msdn.microsoft.com/library/system.web.security.aspx) предоставляет различные методы для входа и входа пользователей с помощью системы проверки подлинности форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-304">The [FormsAuthentication class](https://msdn.microsoft.com/library/system.web.security.formsauthentication.aspx) in the [System.Web.Security namespace](https://msdn.microsoft.com/library/system.web.security.aspx) provides assorted methods for logging in and logging out users via the forms authentication system.</span></span> <span data-ttu-id="27a71-305">Хотя в классе FormsAuthentication существует несколько методов, три нас заинтересованы в этом присоединении к:</span><span class="sxs-lookup"><span data-stu-id="27a71-305">While there are several methods in the FormsAuthentication class, the three we are interested in at this juncture are:</span></span>

- <span data-ttu-id="27a71-306">[Жетаускукие (*username*, *персисткукие*)](https://msdn.microsoft.com/library/system.web.security.formsauthentication.getauthcookie.aspx) — создает билет проверки подлинности на основе форм для заданного имени *пользователя*.</span><span class="sxs-lookup"><span data-stu-id="27a71-306">[GetAuthCookie(*username*, *persistCookie*)](https://msdn.microsoft.com/library/system.web.security.formsauthentication.getauthcookie.aspx) - creates a forms authentication ticket for the supplied name *username*.</span></span> <span data-ttu-id="27a71-307">Затем этот метод создает и возвращает объект HttpCookie, содержащий содержимое билета проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="27a71-307">Next, this method creates and returns an HttpCookie object that holds the contents of the authentication ticket.</span></span> <span data-ttu-id="27a71-308">Если *персисткукие* имеет значение true, создается постоянный файл cookie.</span><span class="sxs-lookup"><span data-stu-id="27a71-308">If *persistCookie* is True, a persistent cookie is created.</span></span>
- <span data-ttu-id="27a71-309">[Сетаускукие (*username*, *персисткукие*)](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) — вызывает метод жетаускукие (*username*, *персисткукие*) для создания файла cookie проверки подлинности на основе форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-309">[SetAuthCookie(*username*, *persistCookie*)](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) - calls the GetAuthCookie(*username*, *persistCookie*) method to generate the forms authentication cookie.</span></span> <span data-ttu-id="27a71-310">Затем этот метод добавляет файл cookie, возвращенный Жетаускукие, в коллекцию Cookies (предполагается, что используется проверка подлинности с помощью форм на основе файлов cookie). в противном случае этот метод вызывает внутренний класс, обрабатывающий логику билета без файлов cookie.</span><span class="sxs-lookup"><span data-stu-id="27a71-310">This method then adds the cookie returned by GetAuthCookie to the Cookies collection (assuming cookies-based forms authentication is being used; otherwise, this method calls an internal class that handles the cookieless ticket logic).</span></span>
- <span data-ttu-id="27a71-311">[RedirectFromLoginPage (*username*, *персисткукие*)](https://msdn.microsoft.com/library/system.web.security.formsauthentication.redirectfromloginpage.aspx) — этот метод вызывает сетаускукие (*username*, *персисткукие*), а затем перенаправляет пользователя на соответствующую страницу.</span><span class="sxs-lookup"><span data-stu-id="27a71-311">[RedirectFromLoginPage(*username*, *persistCookie*)](https://msdn.microsoft.com/library/system.web.security.formsauthentication.redirectfromloginpage.aspx) - this method calls SetAuthCookie(*username*, *persistCookie*), and then redirects the user to the appropriate page.</span></span>

<span data-ttu-id="27a71-312">Жетаускукие удобен, когда необходимо изменить билет проверки подлинности перед записью файлов cookie в коллекцию Cookies.</span><span class="sxs-lookup"><span data-stu-id="27a71-312">GetAuthCookie is handy when you need to modify the authentication ticket before writing the cookie out to the Cookies collection.</span></span> <span data-ttu-id="27a71-313">Сетаускукие полезен, если вы хотите создать билет проверки подлинности с помощью форм и добавить его в коллекцию Cookies, но не хотите перенаправлять пользователя на соответствующую страницу.</span><span class="sxs-lookup"><span data-stu-id="27a71-313">SetAuthCookie is useful if you want to create the forms authentication ticket and add it to the Cookies collection, but do not want to redirect the user to the appropriate page.</span></span> <span data-ttu-id="27a71-314">Возможно, вы хотите, чтобы они оставались на странице входа или отправлялись на другую страницу.</span><span class="sxs-lookup"><span data-stu-id="27a71-314">Perhaps you want to keep them on the login page or send them to some alternate page.</span></span>

<span data-ttu-id="27a71-315">Так как мы хотим войти в систему пользователя и перенаправлены на соответствующую страницу, давайте будем использовать RedirectFromLoginPage.</span><span class="sxs-lookup"><span data-stu-id="27a71-315">Since we want to log in the user and redirect them to the appropriate page, let's use RedirectFromLoginPage.</span></span> <span data-ttu-id="27a71-316">Обновите обработчик событий Click для Логинбуттон, заменив две строки TODO с комментариями следующей строкой кода:</span><span class="sxs-lookup"><span data-stu-id="27a71-316">Update the LoginButton's Click event handler, replacing the two commented TODO lines with the following line of code:</span></span>

<span data-ttu-id="27a71-317">FormsAuthentication. RedirectFromLoginPage (имя_пользователя. Text, RememberMe. Checked)</span><span class="sxs-lookup"><span data-stu-id="27a71-317">FormsAuthentication.RedirectFromLoginPage(UserName.Text, RememberMe.Checked)</span></span>

<span data-ttu-id="27a71-318">При создании билета проверки подлинности с помощью форм мы используем свойство Text текстового поля UserName для параметра *имени пользователя* билета проверки подлинности Forms и состояние Checked флажка rememberMe для параметра *персисткукие* .</span><span class="sxs-lookup"><span data-stu-id="27a71-318">When creating the forms authentication ticket we use the UserName TextBox's Text property for the forms authentication ticket *username* parameter, and the checked state of the RememberMe CheckBox for the *persistCookie* parameter.</span></span>

<span data-ttu-id="27a71-319">Чтобы протестировать страницу входа, откройте ее в браузере.</span><span class="sxs-lookup"><span data-stu-id="27a71-319">To test the login page, visit it in a browser.</span></span> <span data-ttu-id="27a71-320">Начните с ввода недопустимых учетных данных, таких как имя пользователя нет, и пароль неправильного пароля.</span><span class="sxs-lookup"><span data-stu-id="27a71-320">Start by entering invalid credentials, such as a username of Nope and a password of wrong.</span></span> <span data-ttu-id="27a71-321">При нажатии кнопки входа произойдет обратная передача, и будет отображена метка Инвалидкредентиалсмессаже.</span><span class="sxs-lookup"><span data-stu-id="27a71-321">Upon clicking the Login button a postback will occur and the InvalidCredentialsMessage Label will be displayed.</span></span>

<span data-ttu-id="27a71-322">[![при вводе недопустимых учетных данных отображается метка Инвалидкредентиалсмессаже](an-overview-of-forms-authentication-vb/_static/image29.png)](an-overview-of-forms-authentication-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-322">[![The InvalidCredentialsMessage Label is Displayed When Entering Invalid Credentials](an-overview-of-forms-authentication-vb/_static/image29.png)](an-overview-of-forms-authentication-vb/_static/image28.png)</span></span>

<span data-ttu-id="27a71-323">**Рис. 10**. метка Инвалидкредентиалсмессаже отображается при вводе недопустимых учетных данных ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-323">**Figure 10**: The InvalidCredentialsMessage Label is Displayed When Entering Invalid Credentials([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image30.png))</span></span>

<span data-ttu-id="27a71-324">Затем введите допустимые учетные данные и нажмите кнопку Login (вход).</span><span class="sxs-lookup"><span data-stu-id="27a71-324">Next, enter valid credentials and click the Login button.</span></span> <span data-ttu-id="27a71-325">На этот раз, когда происходит обратная передача, создается билет проверки подлинности форм, и вы автоматически перенаправляете обратно в Default. aspx.</span><span class="sxs-lookup"><span data-stu-id="27a71-325">This time when the postback occurs a forms authentication ticket is created and you are automatically redirected back to Default.aspx.</span></span> <span data-ttu-id="27a71-326">На этом этапе вы выполнили вход на веб-сайт, хотя нет визуальных подсказок, указывающих на то, что вы выполнили вход в систему.</span><span class="sxs-lookup"><span data-stu-id="27a71-326">At this point you have logged in to the website, although there are no visual cues to indicate that you are currently logged in.</span></span> <span data-ttu-id="27a71-327">На шаге 4 мы посмотрим, как программным образом определить, вошел ли пользователь в систему или нет, а также как определить пользователя, который посещает страницу.</span><span class="sxs-lookup"><span data-stu-id="27a71-327">In Step 4 we will see how to programmatically determine whether a user is logged in or not as well as how to identify the user visiting the page.</span></span>

<span data-ttu-id="27a71-328">На шаге 5 рассматриваются методы входа пользователя из веб-сайта в журнал.</span><span class="sxs-lookup"><span data-stu-id="27a71-328">Step 5 examines techniques for logging a user out of the website.</span></span>

### <a name="securing-the-login-page"></a><span data-ttu-id="27a71-329">Защита страницы входа</span><span class="sxs-lookup"><span data-stu-id="27a71-329">Securing the Login Page</span></span>

<span data-ttu-id="27a71-330">Когда пользователь вводит свои учетные данные и отправляет форму страницы входа, учетные данные, включая пароль, передаются через Интернет на веб-сервер в *виде обычного текста*.</span><span class="sxs-lookup"><span data-stu-id="27a71-330">When the user enters her credentials and submits the login page form, the credentials - including her password - are transmitted over the Internet to the web server in *plain text*.</span></span> <span data-ttu-id="27a71-331">Это означает, что любой злоумышленник, прослушивать сетевой трафик, может видеть имя пользователя и пароль.</span><span class="sxs-lookup"><span data-stu-id="27a71-331">That means any hacker sniffing the network traffic can see the username and password.</span></span> <span data-ttu-id="27a71-332">Чтобы избежать этого, важно зашифровать сетевой трафик с помощью [SSL](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span><span class="sxs-lookup"><span data-stu-id="27a71-332">To prevent this, it is essential to encrypt the network traffic by using [Secure Socket Layers (SSL)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span></span> <span data-ttu-id="27a71-333">Это гарантирует, что учетные данные (а также все HTML-разметка страницы) будут зашифрованы с момента выхода из браузера, пока они не будут получены веб-сервером.</span><span class="sxs-lookup"><span data-stu-id="27a71-333">This will ensure that the credentials (as well as the entire page's HTML markup) are encrypted from the moment they leave the browser until they are received by the web server.</span></span>

<span data-ttu-id="27a71-334">Если веб-сайт не содержит конфиденциальные сведения, необходимо использовать протокол SSL только на странице входа и на других страницах, где пароль пользователя в противном случае будет отправлен по сети в виде обычного текста.</span><span class="sxs-lookup"><span data-stu-id="27a71-334">Unless your website contains sensitive information, you will only need to use SSL on the login page and on other pages where the user's password would otherwise be sent over the wire in plain text.</span></span> <span data-ttu-id="27a71-335">Не нужно беспокоиться о защите билета проверки подлинности с помощью форм, так как по умолчанию он шифруется и подписывается с цифровой подписью (для предотвращения незаконного изменения).</span><span class="sxs-lookup"><span data-stu-id="27a71-335">You do not need to worry about securing the forms authentication ticket since, by default, it is both encrypted and digitally signed (to prevent tampering).</span></span> <span data-ttu-id="27a71-336">В следующем учебнике представлено более подробное обсуждение безопасности билета проверки подлинности с помощью форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-336">A more thorough discussion on forms authentication ticket security is presented in the following tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="27a71-337">Многие финансовые и медицинские веб-сайты настроены на использование SSL на *всех* страницах, доступных для пользователей, прошедших проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="27a71-337">Many financial and medical websites are configured to use SSL on *all* pages accessible to authenticated users.</span></span> <span data-ttu-id="27a71-338">При создании такого веб-сайта можно настроить систему проверки подлинности форм таким образом, чтобы билет проверки подлинности форм передавался только через безопасное соединение.</span><span class="sxs-lookup"><span data-stu-id="27a71-338">If you are building such a website you can configure the forms authentication system so that the forms authentication ticket is only transmitted over a secure connection.</span></span> <span data-ttu-id="27a71-339">В следующем руководстве рассматриваются различные варианты настройки проверки подлинности форм, *[Конфигурация проверки подлинности с помощью форм и дополнительные разделы](../membership/creating-the-membership-schema-in-sql-server-vb.md)* .</span><span class="sxs-lookup"><span data-stu-id="27a71-339">We will look at the various forms authentication configuration options in the next tutorial, *[Forms Authentication Configuration and Advanced Topics](../membership/creating-the-membership-schema-in-sql-server-vb.md)*.</span></span>

## <a name="step-4-detecting-authenticated-visitors-and-determining-their-identity"></a><span data-ttu-id="27a71-340">Шаг 4. Обнаружение прошедших проверку подлинности посетителей и определение их удостоверения</span><span class="sxs-lookup"><span data-stu-id="27a71-340">Step 4: Detecting Authenticated Visitors and Determining Their Identity</span></span>

<span data-ttu-id="27a71-341">На этом этапе мы включили проверку подлинности с помощью форм и создали элементарную страницу входа, но нам еще не нужно изучать, как можно определить, прошел ли пользователь проверку подлинности или анонимность.</span><span class="sxs-lookup"><span data-stu-id="27a71-341">At this point we have enabled forms authentication and created a rudimentary login page, but we have yet to examine how we can determine whether a user is authenticated or anonymous.</span></span> <span data-ttu-id="27a71-342">В некоторых сценариях может потребоваться отображение различных данных или сведений в зависимости от того, посещается ли на странице Проверка подлинности или анонимный пользователь.</span><span class="sxs-lookup"><span data-stu-id="27a71-342">In certain scenarios we may wish to display different data or information depending on whether an authenticated or anonymous user is visiting the page.</span></span> <span data-ttu-id="27a71-343">Более того, мы часто должны знать удостоверение пользователя, прошедшего проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="27a71-343">Moreover, we oftentimes need to know the identity of the authenticated user.</span></span>

<span data-ttu-id="27a71-344">Добавим существующую страницу Default. aspx, чтобы продемонстрировать эти приемы.</span><span class="sxs-lookup"><span data-stu-id="27a71-344">Let's augment the existing Default.aspx page to illustrate these techniques.</span></span> <span data-ttu-id="27a71-345">В Default. aspx добавьте два элемента управления Panel: один с именем Аусентикатедмессажепанел и другой с именем Анонимаусмессажепанел.</span><span class="sxs-lookup"><span data-stu-id="27a71-345">In Default.aspx add two Panel controls, one named AuthenticatedMessagePanel and another named AnonymousMessagePanel.</span></span> <span data-ttu-id="27a71-346">Добавьте элемент управления Label с именем Велкомебаккмессаже на первой панели.</span><span class="sxs-lookup"><span data-stu-id="27a71-346">Add a Label control named WelcomeBackMessage in the first Panel.</span></span> <span data-ttu-id="27a71-347">На второй панели добавьте элемент управления HyperLink, задайте для его свойства Text значение вход, а для свойства NavigateUrl — значение ~/логин.аспкс.</span><span class="sxs-lookup"><span data-stu-id="27a71-347">In the second Panel add a HyperLink control, set its Text property to Log In and its NavigateUrl property to ~/Login.aspx.</span></span> <span data-ttu-id="27a71-348">На этом этапе декларативная разметка для Default. aspx должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="27a71-348">At this point the declarative markup for Default.aspx should look similar to the following:</span></span>

[!code-aspx[Main](an-overview-of-forms-authentication-vb/samples/sample6.aspx)]

<span data-ttu-id="27a71-349">Как вы, вероятно, выдумали сейчас, идея заключается в том, чтобы отобразить только Аусентикатедмессажепанел для посетителей, прошедших проверку подлинности, и только Анонимаусмессажепанел анонимных посетителей.</span><span class="sxs-lookup"><span data-stu-id="27a71-349">As you have probably guessed by now, the idea here is to display just the AuthenticatedMessagePanel to authenticated visitors and just the AnonymousMessagePanel to anonymous visitors.</span></span> <span data-ttu-id="27a71-350">Для этого необходимо установить видимые свойства этих панелей в зависимости от того, вошел ли пользователь в систему или нет.</span><span class="sxs-lookup"><span data-stu-id="27a71-350">To accomplish this we need to set these Panels' Visible properties depending on whether the user is logged in or not.</span></span>

<span data-ttu-id="27a71-351">[Свойство request. Authenticator](https://msdn.microsoft.com/library/system.web.httprequest.isauthenticated.aspx) возвращает логическое значение, указывающее, прошел ли запрос проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="27a71-351">The [Request.IsAuthenticated property](https://msdn.microsoft.com/library/system.web.httprequest.isauthenticated.aspx) returns a Boolean value indicating whether the request has been authenticated.</span></span> <span data-ttu-id="27a71-352">Введите следующий код в страницу\_загрузить код обработчика событий:</span><span class="sxs-lookup"><span data-stu-id="27a71-352">Enter the following code into the Page\_Load event handler code:</span></span>

[!code-vb[Main](an-overview-of-forms-authentication-vb/samples/sample7.vb)]

<span data-ttu-id="27a71-353">Используя этот код, откройте страницу Default. aspx через браузер.</span><span class="sxs-lookup"><span data-stu-id="27a71-353">With this code in place, visit Default.aspx through a browser.</span></span> <span data-ttu-id="27a71-354">Если вы еще не выполнили вход, вы увидите ссылку на страницу входа (см. рис. 11).</span><span class="sxs-lookup"><span data-stu-id="27a71-354">Assuming that you have yet to log in, you will see a link to the login page (see Figure 11).</span></span> <span data-ttu-id="27a71-355">Щелкните эту ссылку и войдите на сайт.</span><span class="sxs-lookup"><span data-stu-id="27a71-355">Click this link and log in to the site.</span></span> <span data-ttu-id="27a71-356">Как было показано на шаге 3, после ввода учетных данных вы вернетесь к Default. aspx, но на этот раз на странице отобразится ответ.</span><span class="sxs-lookup"><span data-stu-id="27a71-356">As we saw in Step 3, after entering your credentials you will be returned to Default.aspx, but this time the page shows the Welcome back!</span></span> <span data-ttu-id="27a71-357">сообщение (см. рис. 12).</span><span class="sxs-lookup"><span data-stu-id="27a71-357">message (see Figure 12).</span></span>

<span data-ttu-id="27a71-358">[![при анонимном посещении отображается ссылка для входа](an-overview-of-forms-authentication-vb/_static/image32.png)](an-overview-of-forms-authentication-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-358">[![When Visiting Anonymously, a Log In Link is Displayed](an-overview-of-forms-authentication-vb/_static/image32.png)](an-overview-of-forms-authentication-vb/_static/image31.png)</span></span>

<span data-ttu-id="27a71-359">**Рис. 11**. при анонимном посещении отображается ссылка для входа ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-359">**Figure 11**: When Visiting Anonymously, a Log In Link is Displayed([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image33.png))</span></span>

<span data-ttu-id="27a71-360">[![пользователей, прошедших проверку подлинности, отображаются с вас! Сообщение](an-overview-of-forms-authentication-vb/_static/image35.png)](an-overview-of-forms-authentication-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-360">[![Authenticated Users are Shown the Welcome back! Message](an-overview-of-forms-authentication-vb/_static/image35.png)](an-overview-of-forms-authentication-vb/_static/image34.png)</span></span>

<span data-ttu-id="27a71-361">**Рис. 12**. Проверка подлинности пользователей показана на экране.</span><span class="sxs-lookup"><span data-stu-id="27a71-361">**Figure 12**: Authenticated Users are Shown the Welcome back!</span></span> <span data-ttu-id="27a71-362">Сообщение ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-362">Message([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image36.png))</span></span>

<span data-ttu-id="27a71-363">Мы можем определить удостоверение текущего пользователя, вошедшего в систему, с помощью [Свойства пользователя](https://msdn.microsoft.com/library/system.web.httpcontext.user.aspx) [объекта HttpContext](https://msdn.microsoft.com/library/system.web.httpcontext.aspx).</span><span class="sxs-lookup"><span data-stu-id="27a71-363">We can determine the currently logged on user's identity via the [HttpContext object](https://msdn.microsoft.com/library/system.web.httpcontext.aspx)'s [User property](https://msdn.microsoft.com/library/system.web.httpcontext.user.aspx).</span></span> <span data-ttu-id="27a71-364">Объект HttpContext представляет сведения о текущем запросе, а также является доменом для таких распространенных объектов ASP.NET, как ответ, запрос и сеанс, и т. д.</span><span class="sxs-lookup"><span data-stu-id="27a71-364">The HttpContext object represents information about the current request, and is the home for such common ASP.NET objects as Response, Request, and Session, among others.</span></span> <span data-ttu-id="27a71-365">Свойство User представляет контекст безопасности текущего HTTP-запроса и реализует [интерфейс IPrincipal](https://msdn.microsoft.com/library/system.security.principal.iprincipal.aspx).</span><span class="sxs-lookup"><span data-stu-id="27a71-365">The User property represents the security context of the current HTTP request and implements the [IPrincipal interface](https://msdn.microsoft.com/library/system.security.principal.iprincipal.aspx).</span></span>

<span data-ttu-id="27a71-366">Свойство User задается параметром FormsAuthenticationModule.</span><span class="sxs-lookup"><span data-stu-id="27a71-366">The User property is set by the FormsAuthenticationModule.</span></span> <span data-ttu-id="27a71-367">В частности, когда FormsAuthenticationModule находит билет проверки подлинности форм во входящем запросе, он создает новый объект GenericPrincipal и назначает его свойству User.</span><span class="sxs-lookup"><span data-stu-id="27a71-367">Specifically, when the FormsAuthenticationModule finds a forms authentication ticket in the incoming request, it creates a new GenericPrincipal object and assigns it to the User property.</span></span>

<span data-ttu-id="27a71-368">Объекты Principal (например, GenericPrincipal) предоставляют сведения об удостоверении пользователя и ролях, к которым они принадлежат.</span><span class="sxs-lookup"><span data-stu-id="27a71-368">Principal objects (like GenericPrincipal) provide information on the user's identity and the roles to which they belong.</span></span> <span data-ttu-id="27a71-369">Интерфейс IPrincipal определяет два члена:</span><span class="sxs-lookup"><span data-stu-id="27a71-369">The IPrincipal interface defines two members:</span></span>

- <span data-ttu-id="27a71-370">[IsInRole (*roleName*)](https://msdn.microsoft.com/library/system.security.principal.iprincipal.isinrole.aspx) — метод, возвращающий логическое значение, указывающее, принадлежит ли участник к указанной роли.</span><span class="sxs-lookup"><span data-stu-id="27a71-370">[IsInRole(*roleName*)](https://msdn.microsoft.com/library/system.security.principal.iprincipal.isinrole.aspx) - a method that returns a Boolean value indicating if the principal belongs to the specified role.</span></span>
- <span data-ttu-id="27a71-371">[Identity](https://msdn.microsoft.com/library/system.security.principal.iprincipal.identity.aspx) — свойство, которое возвращает объект, реализующий [интерфейс IIdentity](https://msdn.microsoft.com/library/system.security.principal.iidentity.aspx).</span><span class="sxs-lookup"><span data-stu-id="27a71-371">[Identity](https://msdn.microsoft.com/library/system.security.principal.iprincipal.identity.aspx) - a property that returns an object that implements the [IIdentity interface](https://msdn.microsoft.com/library/system.security.principal.iidentity.aspx).</span></span> <span data-ttu-id="27a71-372">Интерфейс IIdentity определяет три свойства: [AuthenticationType](https://msdn.microsoft.com/library/system.security.principal.iidentity.authenticationtype.aspx), [Проверка подлинности](https://msdn.microsoft.com/library/system.security.principal.iidentity.isauthenticated.aspx)и [имя](https://msdn.microsoft.com/library/system.security.principal.iidentity.name.aspx).</span><span class="sxs-lookup"><span data-stu-id="27a71-372">The IIdentity interface defines three properties: [AuthenticationType](https://msdn.microsoft.com/library/system.security.principal.iidentity.authenticationtype.aspx), [IsAuthenticated](https://msdn.microsoft.com/library/system.security.principal.iidentity.isauthenticated.aspx), and [Name](https://msdn.microsoft.com/library/system.security.principal.iidentity.name.aspx).</span></span>

<span data-ttu-id="27a71-373">Имя текущего посетителя можно определить с помощью следующего кода:</span><span class="sxs-lookup"><span data-stu-id="27a71-373">We can determine the name of the current visitor using the following code:</span></span>

<span data-ttu-id="27a71-374">Dim Куррентусерснаме As String = User.Identity.Name</span><span class="sxs-lookup"><span data-stu-id="27a71-374">Dim currentUsersName As String = User.Identity.Name</span></span>

<span data-ttu-id="27a71-375">При использовании проверки подлинности с помощью форм для свойства Identity GenericPrincipal создается [объект FormsIdentity](https://msdn.microsoft.com/library/system.web.security.formsidentity.aspx) .</span><span class="sxs-lookup"><span data-stu-id="27a71-375">When using forms authentication, a [FormsIdentity object](https://msdn.microsoft.com/library/system.web.security.formsidentity.aspx) is created for the GenericPrincipal's Identity property.</span></span> <span data-ttu-id="27a71-376">Класс FormsIdentity всегда возвращает формы строк для своего свойства AuthenticationType и значение true для свойства с проверкой подлинности.</span><span class="sxs-lookup"><span data-stu-id="27a71-376">The FormsIdentity class always returns the string Forms for its AuthenticationType property and True for its IsAuthenticated property.</span></span> <span data-ttu-id="27a71-377">Свойство Name возвращает имя пользователя, указанное при создании билета проверки подлинности с помощью форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-377">The Name property returns the username specified when creating the forms authentication ticket.</span></span> <span data-ttu-id="27a71-378">Помимо этих трех свойств, FormsIdentity включает доступ к базовому билету проверки подлинности через [свойство Ticket](https://msdn.microsoft.com/library/system.web.security.formsidentity.ticket.aspx).</span><span class="sxs-lookup"><span data-stu-id="27a71-378">In addition to these three properties, FormsIdentity includes access to the underlying authentication ticket via its [Ticket property](https://msdn.microsoft.com/library/system.web.security.formsidentity.ticket.aspx).</span></span> <span data-ttu-id="27a71-379">Свойство Ticket возвращает объект типа [формсаусентикатионтиккет](https://msdn.microsoft.com/library/system.web.security.formsauthenticationticket.aspx), который имеет такие свойства, как Expires, Иссуедате, Name и т. д.</span><span class="sxs-lookup"><span data-stu-id="27a71-379">The Ticket property returns an object of type [FormsAuthenticationTicket](https://msdn.microsoft.com/library/system.web.security.formsauthenticationticket.aspx), which has properties like Expiration, IsPersistent, IssueDate, Name, and so on.</span></span>

<span data-ttu-id="27a71-380">Важно отметить, что параметр *username* , указанный в методах FormsAuthentication. жетаускукие (*имя_пользователя*, *Персисткукие*), FormsAuthentication.*Сетаускукие (username,* *персисткукие*) и FormsAuthentication. RedirectFromLoginPage (*username*, *персисткукие*), совпадает со значением, возвращенным User.Identity.Name.</span><span class="sxs-lookup"><span data-stu-id="27a71-380">The important point to take away here is that the *username* parameter specified in the FormsAuthentication.GetAuthCookie(*username*, *persistCookie*), FormsAuthentication.SetAuthCookie(*username*, *persistCookie*), and FormsAuthentication.RedirectFromLoginPage(*username*, *persistCookie*) methods is the same value returned by User.Identity.Name.</span></span> <span data-ttu-id="27a71-381">Более того, билет проверки подлинности, созданный этими методами, доступен путем приведения пользователя. Identity к объекту FormsIdentity и получения доступа к свойству Ticket:</span><span class="sxs-lookup"><span data-stu-id="27a71-381">Moreover, the authentication ticket created by these methods is available by casting User.Identity to a FormsIdentity object and then accessing the Ticket property:</span></span>

<span data-ttu-id="27a71-382">Dim Ident AS FormsIdentity = CType (пользователь. Identity, FormsIdentity)</span><span class="sxs-lookup"><span data-stu-id="27a71-382">Dim ident As FormsIdentity = CType(User.Identity, FormsIdentity)</span></span>

<span data-ttu-id="27a71-383">Dim Аустиккет AS Формсаусентикатионтиккет = Ident. Службу</span><span class="sxs-lookup"><span data-stu-id="27a71-383">Dim authTicket As FormsAuthenticationTicket = ident.Ticket</span></span>

<span data-ttu-id="27a71-384">Давайте предоставляющим более персонализированное сообщение в Default. aspx.</span><span class="sxs-lookup"><span data-stu-id="27a71-384">Let's provide a more personalized message in Default.aspx.</span></span> <span data-ttu-id="27a71-385">Обновите обработчик событий страницы\_загрузки, чтобы свойству Text метки Велкомебаккмессаже было присвоено строковое значение, *имя пользователя*!</span><span class="sxs-lookup"><span data-stu-id="27a71-385">Update the Page\_Load event handler so that the WelcomeBackMessage Label's Text property is assigned the string Welcome back, *username*!</span></span>

<span data-ttu-id="27a71-386">Велкомебаккмессаже. Text = "Добро пожаловать," &amp; User.Identity.Name &amp; "!"</span><span class="sxs-lookup"><span data-stu-id="27a71-386">WelcomeBackMessage.Text = "Welcome back, " &amp; User.Identity.Name &amp; "!"</span></span>

<span data-ttu-id="27a71-387">На рис. 13 показан результат этого изменения (при входе в систему от имени пользователя Скотта).</span><span class="sxs-lookup"><span data-stu-id="27a71-387">Figure 13 shows the effect of this modification (when logging in as user Scott).</span></span>

<span data-ttu-id="27a71-388">[![приветственное сообщение содержит имя текущего пользователя](an-overview-of-forms-authentication-vb/_static/image38.png)](an-overview-of-forms-authentication-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-388">[![The Welcome Message Includes the Currently Logged In User's Name](an-overview-of-forms-authentication-vb/_static/image38.png)](an-overview-of-forms-authentication-vb/_static/image37.png)</span></span>

<span data-ttu-id="27a71-389">**Рис. 13**. Приветственное сообщение содержит имя пользователя, выполнившего вход в систему ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-389">**Figure 13**: The Welcome Message Includes the Currently Logged In User's Name([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image39.png))</span></span>

### <a name="using-the-loginview-and-loginname-controls"></a><span data-ttu-id="27a71-390">Использование элементов управления LoginView и LoginName</span><span class="sxs-lookup"><span data-stu-id="27a71-390">Using the LoginView and LoginName Controls</span></span>

<span data-ttu-id="27a71-391">При отображении другого содержимого для проверки подлинности и анонимных пользователей используется общее требование. Таким образом отображается имя пользователя, выполнившего вход в систему.</span><span class="sxs-lookup"><span data-stu-id="27a71-391">Displaying different content to authenticated and anonymous users is a common requirement; so is displaying the name of the currently logged on user.</span></span> <span data-ttu-id="27a71-392">По этой причине ASP.NET включает два веб-элемента управления, которые предоставляют те же функциональные возможности, что показаны на рис. 13, но без необходимости написания одной строки кода.</span><span class="sxs-lookup"><span data-stu-id="27a71-392">For that reason, ASP.NET includes two Web controls that provide the same functionality shown in Figure 13, but without the need to write a single line of code.</span></span>

<span data-ttu-id="27a71-393">[Элемент управления LoginView](https://msdn.microsoft.com/library/system.web.ui.webcontrols.loginview.aspx) — это веб-элемент управления, основанный на шаблоне, который упрощает отображение различных данных для проверки подлинности и анонимных пользователей.</span><span class="sxs-lookup"><span data-stu-id="27a71-393">The [LoginView control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.loginview.aspx) is a template-based Web control that makes it easy to display different data to authenticated and anonymous users.</span></span> <span data-ttu-id="27a71-394">В LoginView есть два предопределенных шаблона:</span><span class="sxs-lookup"><span data-stu-id="27a71-394">The LoginView includes two predefined templates:</span></span>

- <span data-ttu-id="27a71-395">Анонимаустемплате — любая разметка, добавленная в этот шаблон, отображается только для анонимных посетителей.</span><span class="sxs-lookup"><span data-stu-id="27a71-395">AnonymousTemplate - any markup added to this template is only displayed to anonymous visitors.</span></span>
- <span data-ttu-id="27a71-396">Логжединтемплате — разметка этого шаблона отображается только для пользователей, прошедших проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="27a71-396">LoggedInTemplate - this template's markup is shown only to authenticated users.</span></span>

<span data-ttu-id="27a71-397">Добавим элемент управления LoginView на главную страницу сайта site. master.</span><span class="sxs-lookup"><span data-stu-id="27a71-397">Let's add the LoginView control to our site's master page, Site.master.</span></span> <span data-ttu-id="27a71-398">Однако вместо добавления только элемента управления LoginView добавим новый элемент управления ContentPlaceHolder, а затем поместим элемент управления LoginView в новом элементе ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="27a71-398">Rather than adding just the LoginView control, though, let's add both a new ContentPlaceHolder control and then put the LoginView control within that new ContentPlaceHolder.</span></span> <span data-ttu-id="27a71-399">Это решение станет очевидным в ближайшее время.</span><span class="sxs-lookup"><span data-stu-id="27a71-399">The rationale for this decision will become apparent shortly.</span></span>

> [!NOTE]
> <span data-ttu-id="27a71-400">Помимо Анонимаустемплате и Логжединтемплате, элемент управления LoginView может включать в себя шаблоны для конкретных ролей.</span><span class="sxs-lookup"><span data-stu-id="27a71-400">In addition to the AnonymousTemplate and LoggedInTemplate, the LoginView control can include role-specific templates.</span></span> <span data-ttu-id="27a71-401">Зависящие от роли шаблоны отображают разметку только тем пользователям, которые принадлежат к указанной роли.</span><span class="sxs-lookup"><span data-stu-id="27a71-401">Role-specific templates show markup only to those users that belong to a specified role.</span></span> <span data-ttu-id="27a71-402">В следующем учебном курсе мы рассмотрим возможности элемента управления LoginView на основе ролей.</span><span class="sxs-lookup"><span data-stu-id="27a71-402">We will examine the role-based features of the LoginView control in a future tutorial.</span></span>

<span data-ttu-id="27a71-403">Начните с добавления элемента ContentPlaceHolder с именем Логинконтент в главную страницу в элементе навигации &lt;div&gt;.</span><span class="sxs-lookup"><span data-stu-id="27a71-403">Start by adding a ContentPlaceHolder named LoginContent into the master page within the navigation &lt;div&gt; element.</span></span> <span data-ttu-id="27a71-404">Можно просто перетащить элемент управления ContentPlaceHolder из панели элементов в представление исходного кода, поместив получившийся разметку прямо над меню TODO: текст.</span><span class="sxs-lookup"><span data-stu-id="27a71-404">You can simply drag a ContentPlaceHolder control from the Toolbox onto the Source view, placing the resulting markup right above the TODO: Menu will go here text.</span></span>

[!code-aspx[Main](an-overview-of-forms-authentication-vb/samples/sample8.aspx)]

<span data-ttu-id="27a71-405">Затем добавьте элемент управления LoginView в Логинконтент ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="27a71-405">Next, add a LoginView control within the LoginContent ContentPlaceHolder.</span></span> <span data-ttu-id="27a71-406">Содержимое, помещенное в элементы управления ContentPlaceHolder главной страницы, считается *содержимым по умолчанию* для ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="27a71-406">Content placed into the master page's ContentPlaceHolder controls are considered *default content* for the ContentPlaceHolder.</span></span> <span data-ttu-id="27a71-407">То есть страницы ASP.NET, использующие эту эталонную страницу, могут указывать собственное содержимое для каждого ContentPlaceHolder или использовать содержимое по умолчанию главной страницы.</span><span class="sxs-lookup"><span data-stu-id="27a71-407">That is, ASP.NET pages that use this master page can specify their own content for each ContentPlaceHolder or use the master page's default content.</span></span>

<span data-ttu-id="27a71-408">Средства LoginView и другие элементы управления, связанные с именем входа, находятся на вкладке Имя входа на панели элементов.</span><span class="sxs-lookup"><span data-stu-id="27a71-408">The LoginView and other login-related controls are located in the Toolbox's Login tab.</span></span>

<span data-ttu-id="27a71-409">[![элемента управления LoginView на панели элементов](an-overview-of-forms-authentication-vb/_static/image41.png)](an-overview-of-forms-authentication-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-409">[![The LoginView Control in the Toolbox](an-overview-of-forms-authentication-vb/_static/image41.png)](an-overview-of-forms-authentication-vb/_static/image40.png)</span></span>

<span data-ttu-id="27a71-410">**Рис. 14**. элемент управления LoginView на панели элементов ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-410">**Figure 14**: The LoginView Control in the Toolbox([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image42.png))</span></span>

<span data-ttu-id="27a71-411">Затем добавьте два элемента &lt;BR/&gt; сразу после элемента управления LoginView, но по-прежнему в ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="27a71-411">Next, add two &lt;br /&gt; elements immediately after the LoginView control, but still within the ContentPlaceHolder.</span></span> <span data-ttu-id="27a71-412">На этом этапе разметка навигации &lt;div&gt; элемента должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="27a71-412">At this point, the navigation &lt;div&gt; element's markup should look like the following:</span></span>

[!code-aspx[Main](an-overview-of-forms-authentication-vb/samples/sample9.aspx)]

<span data-ttu-id="27a71-413">Шаблоны LoginView можно определить из конструктора или декларативной разметки.</span><span class="sxs-lookup"><span data-stu-id="27a71-413">The LoginView's templates can be defined from the Designer or the declarative markup.</span></span> <span data-ttu-id="27a71-414">В конструкторе Visual Studio разверните смарт-тег LoginView, в котором перечислены настроенные шаблоны в раскрывающемся списке.</span><span class="sxs-lookup"><span data-stu-id="27a71-414">From Visual Studio's Designer, expand the LoginView's smart tag, which lists the configured templates in a drop-down list.</span></span> <span data-ttu-id="27a71-415">Введите текст Hello, Стрэнджер в Анонимаустемплате; Затем добавьте элемент управления HyperLink и задайте его свойства Text и NavigateUrl для входа и ~/логин.аспкс соответственно.</span><span class="sxs-lookup"><span data-stu-id="27a71-415">Type in the text Hello, stranger into the AnonymousTemplate; next, add a HyperLink control and set its Text and NavigateUrl properties to Log In and ~/Login.aspx, respectively.</span></span>

<span data-ttu-id="27a71-416">После настройки Анонимаустемплате переключитесь на Логжединтемплате и введите текст «Добро пожаловать».</span><span class="sxs-lookup"><span data-stu-id="27a71-416">After configuring the AnonymousTemplate, switch to the LoggedInTemplate and enter the text, "Welcome back, ".</span></span> <span data-ttu-id="27a71-417">Затем перетащите элемент управления LoginName с панели инструментов в Логжединтемплате, поместив его сразу после текста «Добро пожаловать».</span><span class="sxs-lookup"><span data-stu-id="27a71-417">Then drag a LoginName control from the Toolbox into the LoggedInTemplate, placing it immediately after the "Welcome back, " text.</span></span> <span data-ttu-id="27a71-418">[Элемент управления LoginName](https://msdn.microsoft.com/library/system.web.ui.webcontrols.loginname.aspx), как и предполагает его имя, отображает имя пользователя, выполнившего вход в систему.</span><span class="sxs-lookup"><span data-stu-id="27a71-418">The [LoginName control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.loginname.aspx), as its name implies, displays the name of the currently logged in user.</span></span> <span data-ttu-id="27a71-419">На внутреннем уровне элемент управления LoginName просто выводит свойство User.Identity.Name</span><span class="sxs-lookup"><span data-stu-id="27a71-419">Internally, the LoginName control simply outputs the User.Identity.Name property</span></span>

<span data-ttu-id="27a71-420">После внесения этих дополнений в шаблоны LoginView разметка должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="27a71-420">After making these additions to the LoginView's templates, the markup should look similar to the following:</span></span>

[!code-aspx[Main](an-overview-of-forms-authentication-vb/samples/sample10.aspx)]

<span data-ttu-id="27a71-421">С этим добавлением к главной странице Site. master на каждой странице веб-сайта будет отображаться другое сообщение в зависимости от того, прошел ли пользователь проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="27a71-421">With this addition to the Site.master master page, each page in our website will display a different message depending on whether the user is authenticated.</span></span> <span data-ttu-id="27a71-422">На рис. 15 показана страница Default. aspx при посещении через браузер пользователем Цзисунь.</span><span class="sxs-lookup"><span data-stu-id="27a71-422">Figure 15 shows the Default.aspx page when visited through a browser by user Jisun.</span></span> <span data-ttu-id="27a71-423">Ответ Добро пожаловать, Цзисунь сообщение повторяется дважды: один раз в разделе навигации главной страницы слева (через элемент управления LoginView, который мы только что добавили) и один раз в области содержимого Default. aspx (с помощью элементов управления Panel и программной логики).</span><span class="sxs-lookup"><span data-stu-id="27a71-423">The Welcome back, Jisun message is repeated twice: once in the master page's navigation section on the left (via the LoginView control we just added) and once in the Default.aspx's content area (via Panel controls and programmatic logic).</span></span>

<span data-ttu-id="27a71-424">[![элемент управления LoginView отображает Welcome, Цзисунь.](an-overview-of-forms-authentication-vb/_static/image44.png)](an-overview-of-forms-authentication-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-424">[![The LoginView Control Displays Welcome back, Jisun.](an-overview-of-forms-authentication-vb/_static/image44.png)](an-overview-of-forms-authentication-vb/_static/image43.png)</span></span>

<span data-ttu-id="27a71-425">**Рис. 15**. элемент управления LoginView отображает Добро пожаловать назад, цзисунь.</span><span class="sxs-lookup"><span data-stu-id="27a71-425">**Figure 15**: The LoginView Control Displays Welcome back, Jisun.</span></span> <span data-ttu-id="27a71-426">([Щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-426">([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image45.png))</span></span>

<span data-ttu-id="27a71-427">Так как мы добавили объект LoginView на главную страницу, он может отображаться на каждой странице сайта.</span><span class="sxs-lookup"><span data-stu-id="27a71-427">Because we added the LoginView to the master page, it can appear in every page on our site.</span></span> <span data-ttu-id="27a71-428">Однако могут существовать веб-страницы, на которых не нужно выводить это сообщение.</span><span class="sxs-lookup"><span data-stu-id="27a71-428">However, there may be web pages where we don't want to show this message.</span></span> <span data-ttu-id="27a71-429">Одной из таких страниц является страница входа в систему, так как ссылка на страницу входа кажется на месте.</span><span class="sxs-lookup"><span data-stu-id="27a71-429">One such page is the login page, since a link to the login page seems out of place there.</span></span> <span data-ttu-id="27a71-430">Так как мы поместили элемент управления LoginView в ContentPlaceHolder на главной странице, мы можем переопределить эту разметку по умолчанию на странице содержимого.</span><span class="sxs-lookup"><span data-stu-id="27a71-430">Since we placed the LoginView control in a ContentPlaceHolder in the master page, we can override this default markup in our content page.</span></span> <span data-ttu-id="27a71-431">Откройте Login. aspx и перейдите в конструктор.</span><span class="sxs-lookup"><span data-stu-id="27a71-431">Open Login.aspx and go to the Designer.</span></span> <span data-ttu-id="27a71-432">Так как мы не создали явно элемент управления содержимым в файле Login. aspx для Логинконтент ContentPlaceHolder на главной странице, на странице входа будет показана разметка по умолчанию для этой страницы ContentPlaceHolder на главной странице.</span><span class="sxs-lookup"><span data-stu-id="27a71-432">Since we have not explicitly defined a Content control in Login.aspx for the LoginContent ContentPlaceHolder in the master page, the login page will show the master page's default markup for this ContentPlaceHolder.</span></span> <span data-ttu-id="27a71-433">Это можно увидеть в конструкторе. Логинконтент ContentPlaceHolder показывает разметку по умолчанию (элемент управления LoginView).</span><span class="sxs-lookup"><span data-stu-id="27a71-433">You can see this through the Designer - the LoginContent ContentPlaceHolder shows the default markup (the LoginView control).</span></span>

<span data-ttu-id="27a71-434">[![странице входа отображается содержимое по умолчанию для Логинконтент ContentPlaceHolder главной страницы.](an-overview-of-forms-authentication-vb/_static/image47.png)](an-overview-of-forms-authentication-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-434">[![The Login Page Shows the Default Content for the Master Page's LoginContent ContentPlaceHolder](an-overview-of-forms-authentication-vb/_static/image47.png)](an-overview-of-forms-authentication-vb/_static/image46.png)</span></span>

<span data-ttu-id="27a71-435">**Рис. 16**. на странице входа отображается содержимое по умолчанию для Логинконтент ContentPlaceHolder главной страницы ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-435">**Figure 16**: The Login Page Shows the Default Content for the Master Page's LoginContent ContentPlaceHolder([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image48.png))</span></span>

<span data-ttu-id="27a71-436">Чтобы переопределить разметку по умолчанию для элемента ContentPlaceHolder Логинконтент, просто щелкните правой кнопкой мыши область в конструкторе и выберите в контекстном меню пункт Создать настраиваемое содержимое.</span><span class="sxs-lookup"><span data-stu-id="27a71-436">To override the default markup for the LoginContent ContentPlaceHolder, simply right-click on the region in the Designer and choose the Create Custom Content option from the context menu.</span></span> <span data-ttu-id="27a71-437">(При использовании Visual Studio 2008 ContentPlaceHolder включает смарт-тег, который при выборе имеет тот же параметр.) Это добавляет новый элемент управления содержимым к разметке страницы и тем самым позволяет нам определить пользовательское содержимое для этой страницы.</span><span class="sxs-lookup"><span data-stu-id="27a71-437">(When using Visual Studio 2008 the ContentPlaceHolder includes a smart tag that, when selected, offers the same option.) This adds a new Content control to the page's markup and thereby allows us to define custom content for this page.</span></span> <span data-ttu-id="27a71-438">Можно добавить пользовательское сообщение, например, войти, но просто оставьте это поле пустым.</span><span class="sxs-lookup"><span data-stu-id="27a71-438">You could add a custom message here, such as Please log in, but let's just leave this blank.</span></span>

> [!NOTE]
> <span data-ttu-id="27a71-439">При создании пользовательского содержимого в Visual Studio 2005 на странице ASP.NET создается пустой элемент управления содержимым.</span><span class="sxs-lookup"><span data-stu-id="27a71-439">In Visual Studio 2005, creating custom content creates an empty Content control in the ASP.NET page.</span></span> <span data-ttu-id="27a71-440">Однако в Visual Studio 2008 Создание пользовательского содержимого копирует содержимое по умолчанию главной страницы в только что созданный элемент управления содержимым.</span><span class="sxs-lookup"><span data-stu-id="27a71-440">In Visual Studio 2008, however, creating custom content copies the master page's default content into the newly created Content control.</span></span> <span data-ttu-id="27a71-441">Если вы используете Visual Studio 2008, то после создания нового элемента управления содержимым убедитесь, что содержимое, скопированное с главной страницы, было очищено.</span><span class="sxs-lookup"><span data-stu-id="27a71-441">If you are using Visual Studio 2008, then, after creating the new Content control make sure to clear out the content copied over from the master page.</span></span>

<span data-ttu-id="27a71-442">На рис. 17 показана страница Login. aspx при посещении из браузера после внесения этого изменения.</span><span class="sxs-lookup"><span data-stu-id="27a71-442">Figure 17 shows the Login.aspx page when visited from a browser after making this change.</span></span> <span data-ttu-id="27a71-443">Обратите внимание, что отсутствует Привет, Стрэнджер или Добро пожаловать, сообщение *username* в левой области навигации &lt;div&gt;, как при посещении Default. aspx.</span><span class="sxs-lookup"><span data-stu-id="27a71-443">Note that there is no Hello, stranger or Welcome back, *username* message in the left navigation &lt;div&gt; as there is when visiting Default.aspx.</span></span>

<span data-ttu-id="27a71-444">[![страница входа скрывает разметку ContentPlaceHolder Логинконтент по умолчанию](an-overview-of-forms-authentication-vb/_static/image50.png)](an-overview-of-forms-authentication-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-444">[![The Login Page Hides the Default LoginContent ContentPlaceHolder's Markup](an-overview-of-forms-authentication-vb/_static/image50.png)](an-overview-of-forms-authentication-vb/_static/image49.png)</span></span>

<span data-ttu-id="27a71-445">**Рис. 17**. страница входа скрывает разметку Логинконтент ContentPlaceHolder по умолчанию ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-445">**Figure 17**: The Login Page Hides the Default LoginContent ContentPlaceHolder's Markup([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image51.png))</span></span>

## <a name="step-5-logging-out"></a><span data-ttu-id="27a71-446">Шаг 5. выход из сеанса</span><span class="sxs-lookup"><span data-stu-id="27a71-446">Step 5: Logging Out</span></span>

<span data-ttu-id="27a71-447">На этапе 3 мы рассматривали создание страницы входа для входа пользователя на сайт, но мы еще не видели, как выполнить вход пользователя в систему. В дополнение к методам входа пользователя в класс FormsAuthentication также предоставляет [метод выхода](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx).</span><span class="sxs-lookup"><span data-stu-id="27a71-447">In Step 3 we looked at building a login page to log a user in to the site, but we have yet to see how to log a user out. In addition to methods for logging a user in, the FormsAuthentication class also provides a [SignOut method](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx).</span></span> <span data-ttu-id="27a71-448">Метод выхода просто уничтожает билет проверки подлинности форм, тем самым выписывая пользователя из сайта.</span><span class="sxs-lookup"><span data-stu-id="27a71-448">The SignOut method simply destroys the forms authentication ticket, thereby logging the user out of the site.</span></span>

<span data-ttu-id="27a71-449">Предложение выхода из системы — это общая функция, которая ASP.NET включает элемент управления, специально предназначенный для входа пользователя в систему. [Элемент управления LoginStatus](https://msdn.microsoft.com/library/system.web.ui.webcontrols.loginstatus.aspx) отображает либо имя входа LinkButton, либо запись LinkButton в зависимости от состояния проверки подлинности пользователя.</span><span class="sxs-lookup"><span data-stu-id="27a71-449">Offering a log out link is such a common feature that ASP.NET includes a control specifically designed to log a user out. The [LoginStatus control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.loginstatus.aspx) displays either a Login LinkButton or a Logout LinkButton, depending on the user's authentication status.</span></span> <span data-ttu-id="27a71-450">Для анонимных пользователей отображается имя входа LinkButton, а для пользователей, прошедших проверку подлинности, указанная LinkButton.</span><span class="sxs-lookup"><span data-stu-id="27a71-450">A Login LinkButton is rendered for anonymous users, whereas a Logout LinkButton is displayed to authenticated users.</span></span> <span data-ttu-id="27a71-451">Текст для имени входа и записи LinkButton можно настроить с помощью свойств Логинтекст и Логауттекст LoginStatus.</span><span class="sxs-lookup"><span data-stu-id="27a71-451">The text for the Login and Logout LinkButtons can be configured via the LoginStatus's LoginText and LogoutText properties.</span></span>

<span data-ttu-id="27a71-452">При щелчке имени входа LinkButton вызывается обратная передача, из которой перенаправление выполняется на страницу входа.</span><span class="sxs-lookup"><span data-stu-id="27a71-452">Clicking the Login LinkButton causes a postback, from which a redirect is issued to the login page.</span></span> <span data-ttu-id="27a71-453">При нажатии кнопки "выход" элемент управления LinkButton вызывает метод FormsAuthentication. LoginStatus, а затем перенаправляет пользователя на страницу.</span><span class="sxs-lookup"><span data-stu-id="27a71-453">Clicking the Logout LinkButton causes the LoginStatus control to invoke the FormsAuthentication.SignOff method and then redirects the user to a page.</span></span> <span data-ttu-id="27a71-454">Страница, с которой выполнен выход из системы, зависит от свойства Логаутактион, которое может быть назначено одному из следующих трех значений:</span><span class="sxs-lookup"><span data-stu-id="27a71-454">The page the logged off user is redirected to depends on the LogoutAction property, which can be assigned to one of the three following values:</span></span>

- <span data-ttu-id="27a71-455">Обновить — по умолчанию; перенаправляет пользователя на страницу, которая была только что посещена.</span><span class="sxs-lookup"><span data-stu-id="27a71-455">Refresh - the default; redirects the user to the page they were just visiting.</span></span> <span data-ttu-id="27a71-456">Если страница, которая была только что посещена, не допускает анонимных пользователей, FormsAuthenticationModule автоматически перенаправит пользователя на страницу входа.</span><span class="sxs-lookup"><span data-stu-id="27a71-456">If the page they were just visiting does not allow anonymous users, then the FormsAuthenticationModule will automatically redirect the user to the login page.</span></span>

<span data-ttu-id="27a71-457">Возможно, вам интересно, почему выполняется перенаправление.</span><span class="sxs-lookup"><span data-stu-id="27a71-457">You may be curious as to why a redirect is performed here.</span></span> <span data-ttu-id="27a71-458">Если пользователь хочет остаться на той же странице, зачем нужно явно перенаправление?</span><span class="sxs-lookup"><span data-stu-id="27a71-458">If the user wants to remain on the same page, why the need for the explicit redirect?</span></span> <span data-ttu-id="27a71-459">Причина заключается в том, что при нажатии кнопки входа LinkButton пользователь по-прежнему имеет билет проверки подлинности форм в своей коллекции файлов cookie.</span><span class="sxs-lookup"><span data-stu-id="27a71-459">The reason is because when the Logoff LinkButton is clicked, the user still has the forms authentication ticket in their cookies collection.</span></span> <span data-ttu-id="27a71-460">Следовательно, запрос на обратную передачу является запросом, прошедшим проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="27a71-460">Consequently, the postback request is an authenticated request.</span></span> <span data-ttu-id="27a71-461">Элемент управления LoginStatus вызывает метод Sign, но это происходит после того, как FormsAuthenticationModule проходил проверку подлинности пользователя.</span><span class="sxs-lookup"><span data-stu-id="27a71-461">The LoginStatus control calls the SignOut method, but that happens after the FormsAuthenticationModule has authenticated the user.</span></span> <span data-ttu-id="27a71-462">Таким образом, явное перенаправление заставляет браузер повторно запрашивать страницу.</span><span class="sxs-lookup"><span data-stu-id="27a71-462">Therefore, an explicit redirect causes the browser to re-request the page.</span></span> <span data-ttu-id="27a71-463">К моменту, когда браузер повторно запрашивает страницу, билет проверки подлинности на основе форм был удален, поэтому входящий запрос анонимен.</span><span class="sxs-lookup"><span data-stu-id="27a71-463">By the time the browser re-requests the page, the forms authentication ticket has been removed and therefore the incoming request is anonymous.</span></span>

- <span data-ttu-id="27a71-464">Перенаправление — пользователь перенаправляется по URL-адресу, указанному в свойстве Логаутпажеурл LoginStatus.</span><span class="sxs-lookup"><span data-stu-id="27a71-464">Redirect - the user is redirected to the URL specified by the LoginStatus's LogoutPageUrl property.</span></span>
- <span data-ttu-id="27a71-465">Редиректтологинпаже — пользователь перенаправляется на страницу входа.</span><span class="sxs-lookup"><span data-stu-id="27a71-465">RedirectToLoginPage - the user is redirected to the login page.</span></span>

<span data-ttu-id="27a71-466">Давайте добавим элемент управления LoginStatus на главную страницу и настроим его на использование параметра перенаправления, чтобы отправить пользователю на страницу, на которой отображается сообщение о том, что оно выйдет из системы. Начните с создания страницы в корневом каталоге с именем Logout. aspx.</span><span class="sxs-lookup"><span data-stu-id="27a71-466">Let's add a LoginStatus control to the master page and configure it to use the Redirect option to send the user to a page that displays a message confirming that they have been signed out. Start by creating a page in the root directory named Logout.aspx.</span></span> <span data-ttu-id="27a71-467">Не забудьте связать эту страницу с главной страницей site. master.</span><span class="sxs-lookup"><span data-stu-id="27a71-467">Don't forget to associate this page with the Site.master master page.</span></span> <span data-ttu-id="27a71-468">Затем введите сообщение в разметке страницы, объясняющее пользователя, что он вышел из нее.</span><span class="sxs-lookup"><span data-stu-id="27a71-468">Next, enter a message in the page's markup explaining to the user that they have been logged out.</span></span>

<span data-ttu-id="27a71-469">Затем вернитесь на главную страницу site. master и добавьте элемент управления LoginStatus под узлом LoginView в Логинконтент ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="27a71-469">Next, return to the Site.master master page and add a LoginStatus control beneath the LoginView in the LoginContent ContentPlaceHolder.</span></span> <span data-ttu-id="27a71-470">Задайте для свойства Логаутактион элемента управления LoginStatus значение перенаправление, а для свойства Логаутпажеурл значение ~/логаут.аспкс.</span><span class="sxs-lookup"><span data-stu-id="27a71-470">Set the LoginStatus control's LogoutAction property to Redirect and its LogoutPageUrl property to ~/Logout.aspx .</span></span>

[!code-aspx[Main](an-overview-of-forms-authentication-vb/samples/sample11.aspx)]

<span data-ttu-id="27a71-471">Так как LoginStatus находится за пределами элемента управления LoginView, он будет отображаться как для анонимных, так и для пользователей, прошедших проверку подлинности, но это нормально, поскольку LoginStatus будет правильно отображать имя входа или выход из системы LinkButton.</span><span class="sxs-lookup"><span data-stu-id="27a71-471">Since the LoginStatus is outside of the LoginView control, it will appear for both anonymous and authenticated users, but that's OK because the LoginStatus will correctly display a Login or Logout LinkButton.</span></span> <span data-ttu-id="27a71-472">При добавлении элемента управления LoginStatus гиперссылка на журнал в Анонимаустемплате является избыточной, поэтому удалите ее.</span><span class="sxs-lookup"><span data-stu-id="27a71-472">With the addition of the LoginStatus control, the Log In HyperLink in the AnonymousTemplate is superfluous, so remove it.</span></span>

<span data-ttu-id="27a71-473">На рис. 18 показан Default. aspx при посещении Цзисунь.</span><span class="sxs-lookup"><span data-stu-id="27a71-473">Figure 18 shows Default.aspx when Jisun visits.</span></span> <span data-ttu-id="27a71-474">Обратите внимание, что в левом столбце отображается сообщение, Добро пожаловать, Цзисунь и ссылка для выхода. Если щелкнуть элемент LinkButton, выполнит обратную передачу, подписывает Цзисунь из системы, а затем перенаправит его в Logout. aspx.</span><span class="sxs-lookup"><span data-stu-id="27a71-474">Note that the left column displays the message, Welcome back, Jisun along with a link to log out. Clicking the log out LinkButton causes a postback, signs Jisun out of the system, and then redirects her to Logout.aspx.</span></span> <span data-ttu-id="27a71-475">Как показано на рис. 19, время, когда Цзисунь доходит до выхода. aspx, он уже выполнил выход и поэтому является анонимным.</span><span class="sxs-lookup"><span data-stu-id="27a71-475">As Figure 19 shows, by the time Jisun reaches Logout.aspx she has already been signed out and is therefore anonymous.</span></span> <span data-ttu-id="27a71-476">Следовательно, в левом столбце отображается текст Добро пожаловать, Стрэнджер и ссылка на страницу входа.</span><span class="sxs-lookup"><span data-stu-id="27a71-476">Consequently, the left column shows the text Welcome, stranger and a link to the login page.</span></span>

<span data-ttu-id="27a71-477">[![Default. aspx показывает Добро пожаловать, Цзисунь и элемент LinkButton для выхода.](an-overview-of-forms-authentication-vb/_static/image53.png)](an-overview-of-forms-authentication-vb/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-477">[![Default.aspx Shows Welcome Back, Jisun Along with a Logout LinkButton](an-overview-of-forms-authentication-vb/_static/image53.png)](an-overview-of-forms-authentication-vb/_static/image52.png)</span></span>

<span data-ttu-id="27a71-478">**Рис. 18**. Default. aspx показывает Добро пожаловать, цзисунь вместе с LinkButton для выхода ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-478">**Figure 18**: Default.aspx Shows Welcome Back, Jisun Along with a Logout LinkButton([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image54.png))</span></span>

<span data-ttu-id="27a71-479">[![Logout. aspx отображает Welcome, Стрэнджер вместе с именем входа LinkButton](an-overview-of-forms-authentication-vb/_static/image56.png)](an-overview-of-forms-authentication-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="27a71-479">[![Logout.aspx Shows Welcome, stranger Along with a Login LinkButton](an-overview-of-forms-authentication-vb/_static/image56.png)](an-overview-of-forms-authentication-vb/_static/image55.png)</span></span>

<span data-ttu-id="27a71-480">**Рис. 19**. logout. aspx показывает Welcome, Стрэнджер вместе с именем входа LinkButton ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-forms-authentication-vb/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="27a71-480">**Figure 19**: Logout.aspx Shows Welcome, stranger Along with a Login LinkButton([Click to view full-size image](an-overview-of-forms-authentication-vb/_static/image57.png))</span></span>

> [!NOTE]
> <span data-ttu-id="27a71-481">Я рекомендую настроить страницу Logout. aspx, чтобы скрыть Логинконтент ContentPlaceHolder главной страницы (как мы делали это для Login. aspx на шаге 4).</span><span class="sxs-lookup"><span data-stu-id="27a71-481">I encourage you to customize the Logout.aspx page to hide the master page's LoginContent ContentPlaceHolder (like we did for Login.aspx in Step 4).</span></span> <span data-ttu-id="27a71-482">Причина заключается в том, что элемент управления LinkButton, отображаемый элементом LoginStatus (который находится под именем Hello, Стрэнджер), отправляет пользователю на страницу входа, передавая текущий URL-адрес в параметре строки запроса ReturnUrl.</span><span class="sxs-lookup"><span data-stu-id="27a71-482">The reason is because the Login LinkButton rendered by the LoginStatus control (the one beneath Hello, stranger ) sends the user to the login page passing the current URL in the ReturnUrl querystring parameter.</span></span> <span data-ttu-id="27a71-483">Вкратце, если пользователь, который вышел из системы, щелкнет элемент LoginStatus LinkButton, а затем войдет в систему, он будет перенаправлен обратно в Logout. aspx, что может легко запутать пользователя.</span><span class="sxs-lookup"><span data-stu-id="27a71-483">In short, if a user who has logged out clicks this LoginStatus's Login LinkButton, and then logs in, they will be redirected back to Logout.aspx, which could easily confuse the user.</span></span>

## <a name="summary"></a><span data-ttu-id="27a71-484">Сводка</span><span class="sxs-lookup"><span data-stu-id="27a71-484">Summary</span></span>

<span data-ttu-id="27a71-485">В этом учебнике мы начали изучение рабочего процесса проверки подлинности с помощью форм, а затем включили проверку подлинности с помощью форм в приложении ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="27a71-485">In this tutorial we started with an examination of the forms authentication workflow and then turned to implementing forms authentication in an ASP.NET application.</span></span> <span data-ttu-id="27a71-486">Проверка подлинности с помощью форм основана на FormsAuthenticationModule, которая имеет две обязанности: Определение пользователей на основе билета проверки подлинности форм и перенаправление неавторизованных пользователей на страницу входа.</span><span class="sxs-lookup"><span data-stu-id="27a71-486">Forms authentication is powered by the FormsAuthenticationModule, which has two responsibilities: identifying users based on their forms authentication ticket, and redirecting unauthorized users to the login page.</span></span>

<span data-ttu-id="27a71-487">Класс FormsAuthentication .NET Framework содержит методы для создания, проверки и удаления билетов проверки подлинности с помощью форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-487">The .NET Framework's FormsAuthentication class includes methods for creating, inspecting, and removing forms authentication tickets.</span></span> <span data-ttu-id="27a71-488">Свойство Request. Authenticator и объект User предоставляют дополнительную программную поддержку для определения того, прошел ли запрос проверку подлинности и сведения об удостоверении пользователя.</span><span class="sxs-lookup"><span data-stu-id="27a71-488">The Request.IsAuthenticated property and User object provide additional programmatic support for determining whether a request is authenticated and information about the user's identity.</span></span> <span data-ttu-id="27a71-489">Существуют также веб-элементы управления LoginView, LoginStatus и LoginName, которые позволяют разработчикам быстро и без кода выполнять многие общие задачи, связанные с входом в систему.</span><span class="sxs-lookup"><span data-stu-id="27a71-489">There are also the LoginView, LoginStatus, and LoginName Web controls, which give developers a quick, code-free way for performing many common login-related tasks.</span></span> <span data-ttu-id="27a71-490">Эти и другие веб-элементы управления, связанные с входом в систему, подробно рассматриваются в следующих руководствах.</span><span class="sxs-lookup"><span data-stu-id="27a71-490">We will examine these and other login-related Web controls in greater detail in future tutorials.</span></span>

<span data-ttu-id="27a71-491">В этом руководстве предоставлены общие сведения о проверке подлинности с помощью форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-491">This tutorial provided a cursory overview of forms authentication.</span></span> <span data-ttu-id="27a71-492">Мы не проверили параметры конфигурации ассортимента, посмотрим, как работают билеты проверки подлинности с помощью форм без файлов cookie, или Познакомьтесь с тем, как ASP.NET защищает содержимое билета проверки подлинности с помощью форм.</span><span class="sxs-lookup"><span data-stu-id="27a71-492">We did not examine the assorted configuration options, look at how cookieless forms authentication tickets work, or explore how ASP.NET protects the contents of the forms authentication ticket.</span></span> <span data-ttu-id="27a71-493">В [следующем учебнике](forms-authentication-configuration-and-advanced-topics-vb.md)мы рассмотрим эти и другие темы.</span><span class="sxs-lookup"><span data-stu-id="27a71-493">We will discuss these topics and more in the [next tutorial](forms-authentication-configuration-and-advanced-topics-vb.md).</span></span>

<span data-ttu-id="27a71-494">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="27a71-494">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="27a71-495">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="27a71-495">Further Reading</span></span>

<span data-ttu-id="27a71-496">Дополнительные сведения о разделах, обсуждаемых в этом руководстве, см. в следующих ресурсах:</span><span class="sxs-lookup"><span data-stu-id="27a71-496">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="27a71-497">Изменения между безопасностью IIS6 и IIS7</span><span class="sxs-lookup"><span data-stu-id="27a71-497">Changes Between IIS6 and IIS7 Security</span></span>](https://www.iis.net/articles/view.aspx/IIS7/Managing-IIS7/Configuring-Security/Changes-between-IIS6-and-IIS7-Security)
- [<span data-ttu-id="27a71-498">Элементы управления ASP.NET входа</span><span class="sxs-lookup"><span data-stu-id="27a71-498">Login ASP.NET Controls</span></span>](https://msdn.microsoft.com/library/d51ttbhx.aspx)
- <span data-ttu-id="27a71-499">[Профессиональная ASP.NET 2,0 безопасность, членство и управление ролями](http://www.wrox.com/WileyCDA/WroxTitle/productCd-0764596985.html) (ISBN: 978-0-7645-9698-8)</span><span class="sxs-lookup"><span data-stu-id="27a71-499">[Professional ASP.NET 2.0 Security, Membership, and Role Management](http://www.wrox.com/WileyCDA/WroxTitle/productCd-0764596985.html) (ISBN: 978-0-7645-9698-8)</span></span>
- [<span data-ttu-id="27a71-500">Элемент&gt; проверки подлинности &lt;</span><span class="sxs-lookup"><span data-stu-id="27a71-500">The &lt;authentication&gt; Element</span></span>](https://msdn.microsoft.com/library/532aee0e.aspx)
- [<span data-ttu-id="27a71-501">Элемент&gt; &lt;Forms для проверки подлинности &lt;&gt;</span><span class="sxs-lookup"><span data-stu-id="27a71-501">The &lt;forms&gt; Element for &lt;authentication&gt;</span></span>](https://msdn.microsoft.com/library/1d3t3c61.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="27a71-502">Видеообучение по темам, содержащимся в этом руководстве</span><span class="sxs-lookup"><span data-stu-id="27a71-502">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="27a71-503">Использование базовой проверки подлинности на основе форм в ASP.NET</span><span class="sxs-lookup"><span data-stu-id="27a71-503">Using Basic Forms Authentication in ASP.NET</span></span>](../../../videos/authentication/using-basic-forms-authentication-in-aspnet.md)

### <a name="about-the-author"></a><span data-ttu-id="27a71-504">Об авторе</span><span class="sxs-lookup"><span data-stu-id="27a71-504">About the Author</span></span>

<span data-ttu-id="27a71-505">Скотт Митчелл, автор нескольких книг по ASP/ASP. NET и основатель 4GuysFromRolla.com, работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="27a71-505">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="27a71-506">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="27a71-506">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="27a71-507">Его последняя книга — *[Sams обучать себя ASP.NET 2,0 за 24 часа](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* .</span><span class="sxs-lookup"><span data-stu-id="27a71-507">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="27a71-508">Скотт можно получить по адресу [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) или через свой блог по адресу [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="27a71-508">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="27a71-509">Специальная благодарность</span><span class="sxs-lookup"><span data-stu-id="27a71-509">Special Thanks To</span></span>

<span data-ttu-id="27a71-510">Эта серия руководств была рассмотрена многими полезными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="27a71-510">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="27a71-511">Потенциальные рецензенты для этого руководства включают в себя Аликжа Мазиарз, Джон суру и Терезой Мерфи.</span><span class="sxs-lookup"><span data-stu-id="27a71-511">Lead reviewers for this tutorial include Alicja Maziarz, John Suru, and Teresa Murphy.</span></span> <span data-ttu-id="27a71-512">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="27a71-512">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="27a71-513">Если это так, расположите строку в [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com).</span><span class="sxs-lookup"><span data-stu-id="27a71-513">If so, drop me a line at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="27a71-514">[Назад](security-basics-and-asp-net-support-vb.md)
> [Вперед](forms-authentication-configuration-and-advanced-topics-vb.md)</span><span class="sxs-lookup"><span data-stu-id="27a71-514">[Previous](security-basics-and-asp-net-support-vb.md)
[Next](forms-authentication-configuration-and-advanced-topics-vb.md)</span></span>
