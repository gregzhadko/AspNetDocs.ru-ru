---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/display_data_items_and_details
title: Отображение элементов данных и сведений | Документация Майкрософт
author: Erikre
description: В этой серии руководств будут показаны основы создания приложения ASP.NET Web Forms с ASP.NET 4,7 и Microsoft Visual Studio 2017
ms.author: riande
ms.date: 1/04/2019
ms.assetid: 64a491a8-0ed6-4c2f-9c1c-412962eb6006
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/display_data_items_and_details
msc.type: authoredcontent
ms.openlocfilehash: 130c9ffd29df612dac5bb954830a2eb9b738aaf0
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78520812"
---
# <a name="display-data-items-and-details"></a>Отображение элементов данных и сведений

по [Эрик Реитан](https://github.com/Erikre)

> В этой серии руководств вы узнаете об основах создания приложения ASP.NET Web Forms с ASP.NET 4,7 и Microsoft Visual Studio 2017.

В этом руководстве вы узнаете, как отображать элементы данных и сведения об элементах данных с помощью веб-форм ASP.NET и Entity Framework Code First. Это руководство построено на предыдущем учебнике "Пользовательский интерфейс и Навигация" в рамках серии руководств по магазину Wingtip Toy. По завершении работы с этим руководством вы увидите продукты на странице *продуктслист. aspx* и сведения о продукте на странице *продуктдетаилс. aspx* .

## <a name="youll-learn-how-to"></a>Вы узнаете, как:

- Добавление элемента управления данными для показа продуктов из базы данных
- Подключение элемента управления данными к выбранным данным
- Добавление элемента управления данными для вывода сведений о продукте из базы данных
- Получение значения из строки запроса и использование этого значения для ограничения данных, получаемых из базы данных

### <a name="features-introduced-in-this-tutorial"></a>Функции, представленные в этом руководстве:

- Привязка модели
- Поставщики значений

## <a name="add-a-data-control"></a>Добавление элемента управления данными

Для привязки данных к серверному элементу управления можно использовать несколько различных параметров. Наиболее распространенными являются:

* Добавление элемента управления источником данных
* Добавление кода вручную
* Использование привязки модели

### <a name="use-a-data-source-control-to-bind-data"></a>Использование элемента управления источниками данных для привязки данных

Добавление элемента управления источниками данных позволяет связать элемент управления источником данных с элементом управления, который отображает данные. При таком подходе можно декларативно, а не программно подключать серверные элементы управления к источникам данных.

### <a name="code-by-hand-to-bind-data"></a>Код вручную для привязки данных

Написание кода вручную включает в себя:

1. Считывание значения
2. Проверка наличия значения NULL
3. Преобразование в соответствующий тип
4. Проверка успешности преобразования
5. Использование значения в запросе 

Такой подход позволяет получить полный контроль над логикой доступа к данным.

### <a name="use-model-binding-to-bind-data"></a>Использование привязки модели для привязки данных

Привязка модели позволяет привязывать результаты с гораздо меньшим объемом кода и дает возможность повторно использовать функции во всем приложении. Он упрощает работу с логикой доступа к данным, ориентированной на код, и по-прежнему предоставляет обширную платформу привязки данных.

## <a name="display-products"></a>Отображение продуктов

В этом руководстве вы будете использовать привязку модели для привязки данных. Чтобы настроить элемент управления данными для использования привязки модели для выбора данных, задайте для свойства `SelectMethod` элемента управления имя метода в коде страницы. Элемент управления данными вызывает метод в соответствующее время в жизненном цикле страницы и автоматически привязывает возвращенные данные. Нет необходимости в явном вызове метода `DataBind`.

1. В **Обозреватель решений**откройте *ProductList. aspx*.
2. Замените существующую разметку этой разметкой:   

    [!code-aspx-csharp[Main](display_data_items_and_details/samples/sample1.aspx)]

Этот код использует элемент управления **ListView** с именем `productList` для вывода продуктов.

[!code-aspx-csharp[Main](display_data_items_and_details/samples/sample2.aspx)]

С помощью шаблонов и стилей вы определяете, как элемент управления **ListView** отображает данные. Это полезно для данных в любой повторяющейся структуре. Несмотря на то, что этот пример **ListView** просто отображает данные базы данных, можно также без кода, позволяя пользователям изменять, вставлять и удалять данные, а также сортировать и отображать данные на странице.

Если задать свойство `ItemType` в элементе управления **ListView** , то выражение привязки данных `Item` доступно, а элемент управления становится строго типизированным. Как упоминалось в предыдущем учебнике, можно выбрать сведения об объекте Item с помощью IntelliSense, например, указав `ProductName`:

![Отображение элементов данных и сведений — IntelliSense](display_data_items_and_details/_static/image1.png)

Вы также используете привязку модели для указания значения `SelectMethod`. Это значение (`GetProducts`) соответствует методу, который добавляется в код программной части для показа продуктов на следующем шаге.

### <a name="add-code-to-display-products"></a>Добавление кода для показа продуктов

На этом шаге вы добавите код для заполнения элемента управления **ListView** данными продукта из базы данных. Код поддерживает отображение всех продуктов и отдельных категорий продуктов.

1. В **Обозреватель решений**щелкните правой кнопкой мыши *ProductList. aspx* и выберите **Просмотреть код**.
2. Замените существующий код в файле *ProductList.aspx.CS* следующим кодом:   

    [!code-csharp[Main](display_data_items_and_details/samples/sample3.cs)]

В этом коде показан метод `GetProducts`, который `ItemType` свойство элемента управления **ListView** ссылается на страницу *ProductList. aspx* . Чтобы ограничить результаты определенной категорией базы данных, код задает `categoryId` значение из строки запроса, передаваемого на страницу *ProductList. aspx* при переходе на страницу *ProductList. aspx* . Класс `QueryStringAttribute` в пространстве имен `System.Web.ModelBinding` используется для получения значения переменной строки запроса `id`. Это инструктирует привязку модели, чтобы попытаться привязать значение из строки запроса к параметру `categoryId` во время выполнения.

Если допустимая Категория передается в виде строки запроса на страницу, результаты запроса ограничиваются теми продуктами в базе данных, которые соответствуют значению `categoryId`. Например, если страница *продуктслист. aspx* имеет следующий URL-адрес:

[!code-console[Main](display_data_items_and_details/samples/sample4.cmd)]

На странице отображаются только те продукты, в которых `categoryId` равно `1`.

Все продукты отображаются, если при вызове страницы *ProductList. aspx* не включена строка запроса.

Источники значений для этих методов называются *поставщиками значений* (например, *QueryString*), а атрибуты параметров, указывающие, какой поставщик значений следует использовать, называются *атрибутами поставщика значений* (например, `id`). ASP.NET включает поставщики значений и соответствующие атрибуты для всех типовых источников вводимых пользователем данных в приложении веб-форм, таких как строка запроса, файлы cookie, значения форм, элементы управления, состояние представления, состояние сеанса и свойства профиля. Кроме того, можно создавать пользовательские поставщики значений.

### <a name="run-the-application"></a>Выполнение приложения

Запустите приложение, чтобы просмотреть все продукты или продукты категории.

1. Нажмите клавишу **F5** в Visual Studio, чтобы запустить приложение.  
   Откроется браузер и отобразится страница *Default. aspx* .

2. Выберите **автомобили** в меню навигации категории продуктов.  
   На странице *ProductList. aspx* отображаются только продукты категории **автомобилей** . Далее в этом учебнике будут показаны сведения о продукте.  

    ![Отображение элементов данных и сведений — автомобили](display_data_items_and_details/_static/image2.png)

3. В меню навигации вверху выберите **продукты** .  
   Опять же, отобразится страница *ProductList. aspx* , но на этот раз отображается весь список продуктов.   

    ![Отображение элементов данных и сведений — продукты](display_data_items_and_details/_static/image3.png)

4. Закройте браузер и вернитесь в Visual Studio.

### <a name="add-a-data-control-to-display-product-details"></a>Добавление элемента управления данными для вывода сведений о продукте

Далее предстоит изменить разметку на странице *продуктдетаилс. aspx* , добавленную в предыдущем руководстве, для просмотра конкретных сведений о продукте.

1. В **Обозреватель решений**откройте *продуктдетаилс. aspx*.

2. Замените существующую разметку этой разметкой:

    [!code-aspx-csharp[Main](display_data_items_and_details/samples/sample5.aspx)] 

    Этот код использует элемент управления **FormView** для вывода сведений о конкретном продукте. В этой разметке используются такие методы, как методы, используемые для вывода данных на странице *ProductList. aspx* . Элемент управления **FormView** используется для вывода одной записи за раз из источника данных. При использовании элемента управления **FormView** создаются шаблоны для просмотра и редактирования значений, привязанных к данным. Эти шаблоны содержат элементы управления, выражения привязки и форматирование, определяющие внешний вид и функциональность формы.

Для подключения предыдущей разметки к базе данных требуется дополнительный код.

1. В **Обозреватель решений**щелкните правой кнопкой мыши *продуктдетаилс. aspx* и выберите пункт **Просмотреть код**.  
   Отобразится файл *ProductDetails.aspx.CS* .

2. Замените существующий код следующим кодом:   

    [!code-csharp[Main](display_data_items_and_details/samples/sample6.cs)]

Этот код проверяет значение строки запроса "`productID`". Если найдено допустимое значение строки запроса, отображается соответствующий продукт. Если строка запроса не найдена или ее значение недопустимо, продукт не отображается.

### <a name="run-the-application"></a>Выполнение приложения

Теперь можно запустить приложение, чтобы увидеть отдельный продукт, отображаемый на основе идентификатора продукта.

1. Нажмите клавишу **F5** в Visual Studio, чтобы запустить приложение.  
   Откроется браузер и отобразится страница *Default. aspx* .

2. Выберите **Боатс** в меню навигации по категории.  
   Отобразится страница *ProductList. aspx* .

3. Выберите **бумагу** в списке продуктов.
   Отобразится страница *продуктдетаилс. aspx* .

    ![Отображение элементов данных и сведений — продукты](display_data_items_and_details/_static/image4.png)
    
4. Закройте браузер.

## <a name="additional-resources"></a>Дополнительные ресурсы

[Извлечение и отображение данных с помощью привязки модели и веб-форм](../../presenting-and-managing-data/model-binding/retrieving-data.md)

## <a name="next-steps"></a>Дальнейшие действия

В этом руководстве вы добавили разметку и код для просмотра продуктов и сведений о продукте. Вы узнали о строго типизированных элементах управления данными, привязке модели и поставщиках значений. В следующем руководстве вы добавите корзину для покупок в пример приложения Wingtip Toys. 

> [!div class="step-by-step"]
> [Назад](ui_and_navigation.md)
> [Вперед](shopping-cart.md)
