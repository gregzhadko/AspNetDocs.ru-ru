---
uid: web-forms/overview/getting-started/code-editing-in-web-forms-pages
title: Редактирование кода ASP.NET Web Forms в Visual Studio 2013 | Документация Майкрософт
author: Erikre
description: ''
ms.author: riande
ms.date: 03/03/2014
ms.assetid: 5344b74e-b888-479a-92bc-601a33bd61a2
msc.legacyurl: /web-forms/overview/getting-started/code-editing-in-web-forms-pages
msc.type: authoredcontent
ms.openlocfilehash: 3473ad476fbbebc58e12586334b4600f57cf17ed
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78513642"
---
# <a name="code-editing-aspnet-web-forms-in-visual-studio-2013"></a>Редактирование кода в веб-формах ASP.NET в Visual Studio 2013

по [Эрик Реитан](https://github.com/Erikre)

На многих страницах веб-форм ASP.NET код написан на Visual Basic, C#или на другом языке. Редактор кода в Visual Studio поможет быстро написать код, помогая избежать ошибок. Кроме того, редактор предоставляет способы создания повторно используемого кода для сокращения объема работы, которую необходимо выполнить.

В этом пошаговом руководстве демонстрируются различные возможности редактора кода Visual Studio.

В этом пошаговом руководстве описаны следующие процедуры.

- Исправьте встроенные ошибки кода.
- Рефакторинг и переименование кода.
- Переименуйте переменные и объекты.
- Вставка фрагментов кода.

## <a name="prerequisites"></a>предварительные требования

Для выполнения задач этого руководства необходимы:

- [Microsoft Visual Studio 2013](https://www.microsoft.com/visualstudio/11/downloads#vs) или [Microsoft Visual Studio Express 2013 для Web](https://www.microsoft.com/visualstudio/11/downloads#express-web). .NET Framework устанавливается автоматически. 

    > [!NOTE] 
    > 
    > Microsoft Visual Studio 2013 и Microsoft Visual Studio Express 2013 для Web, в этой серии руководств часто называют Visual Studio.  
    >   
    > Если вы используете Visual Studio, в этом пошаговом руководстве предполагается, что вы выбрали коллекцию параметров **веб-разработки** при первом запуске Visual Studio. Дополнительные сведения см. [в разделе как выбрать параметры среды веб-разработки](https://msdn.microsoft.com/library/ff521558.aspx).

## <a name="creating-a-web-application-project-and-a-page"></a>Создание проекта веб-приложения и страницы

<a id="sectionToggle0"></a>

В этой части пошагового руководства вы создадите проект веб-приложения и добавите в него новую страницу.

### <a name="to-create-a-web-application-project"></a>Создание проекта веб-приложения

1. Откройте среду Microsoft Visual Studio.
2. В меню **Файл** выберите пункт **Создать проект**.  
    ![меню "файл"](code-editing-in-web-forms-pages/_static/image1.png)

    Откроется диалоговое окно **Создание проекта** .
3. В левой части выберите **шаблоны** -&gt;  **C# Visual** -&gt; группы **веб-** шаблонов.
4. Выберите шаблон **Веб-приложения ASP.NET** в центральном столбце.
5. Присвойте проекту имя ***басиквебапп*** и нажмите кнопку **ОК** .   
![Диалоговое окно "Новый проект"](code-editing-in-web-forms-pages/_static/image2.png)
6. Затем выберите шаблон **веб-формы** и нажмите кнопку **ОК** , чтобы создать проект.  
![Диалоговое окно "Новый проект ASP.NET"](code-editing-in-web-forms-pages/_static/image3.png)  

    Visual Studio создает новый проект, содержащий предварительно созданные функции на основе шаблона веб-форм.

## <a name="creating-a-new-aspnet-web-forms-page"></a>Создание новой страницы веб-форм ASP.NET

При создании нового приложения Web Forms с помощью шаблона проекта **веб-приложения ASP.NET** в Visual Studio добавляется страница ASP.NET (страница веб-форм) с именем *Default. aspx*, а также несколько других файлов и папок. Страницу *Default. aspx* можно использовать в качестве домашней страницы веб-приложения. Однако в этом пошаговом руководстве вы создадите новую страницу и будете работать с ней.

### <a name="to-add-a-page-to-the-web-application"></a>Добавление страницы в веб-приложение

1. В **Обозреватель решений**щелкните правой кнопкой мыши имя веб-приложения (в этом руководстве имя приложения — **басиквебсите**), а затем щелкните **добавить** -&gt; **новый элемент**.   
Откроется диалоговое окно **Добавление нового элемента** .
2. Выберите в левой части группы **веб-** шаблоны **Visual C#**  -&gt;. Затем выберите **веб-форму** из среднего списка и назовите ее *фирствебпаже. aspx*.   
    ![Диалоговое окно "Добавление нового элемента"](code-editing-in-web-forms-pages/_static/image4.png)
3. Нажмите кнопку **Добавить** , чтобы добавить страницу веб-форм в проект.  
 Visual Studio создаст новую страницу и откроет ее.
4. Затем установите эту новую страницу в качестве начальной страницы по умолчанию. В **Обозреватель решений**щелкните правой кнопкой мыши новую страницу с именем *фирствебпаже. aspx* и выберите **задать в качестве начальной страницы**. В следующий раз, когда вы запустите это приложение для проверки хода выполнения, вы автоматически увидите эту новую страницу в браузере.

## <a name="correcting-inline-coding-errors"></a>Исправление ошибок встроенного кода

Редактор кода в Visual Studio позволяет избежать ошибок при написании кода, а если произошла ошибка, редактор кода поможет исправить ошибку. В этой части пошагового руководства будет написана строка кода, иллюстрирующий функции исправления ошибок в редакторе.

### <a name="to-correct-simple-coding-errors-in-visual-studio"></a>Исправление простых ошибок кода в Visual Studio

1. В режиме **конструктора** дважды щелкните пустую страницу, чтобы создать обработчик для события **Load** для страницы.   
   Обработчик событий используется только в качестве места для написания кода.
2. Внутри обработчика введите следующую строку, которая содержит ошибку, и нажмите клавишу **Ввод**:

    [!code-csharp[Main](code-editing-in-web-forms-pages/samples/sample1.cs)]

   При нажатии клавиши **Ввод**редактор кода подчеркивает зеленую и красную кривые (обычно вызывающие &quot;волнистой линией&quot; линий) в областях кода, где возникают проблемы. Зеленый подчеркнутый означает предупреждение. Красная подчеркивание указывает на ошибку, которую необходимо исправить. 

    Наведите указатель мыши на `myStr`, чтобы увидеть всплывающую подсказку, сообщающую о предупреждении. Кроме того, наведите указатель мыши на красную подчеркивание, чтобы увидеть сообщение об ошибке.

    На следующем рисунке показан код с подчеркиванием.

    ![Текст приветствия в представление конструирования](code-editing-in-web-forms-pages/_static/image5.png "Приветственный текст в конструкторе")  
   Ошибку необходимо исправить, добавив точку с запятой `;` в конец строки. Предупреждение просто уведомляет вас, что вы еще не использовали переменную `myStr`.  

    > [!NOTE] 
    > 
    > Чтобы просмотреть текущие параметры форматирования кода в Visual Studio, выберите **сервис** -&gt; **Параметры** -&gt; **шрифты и цвета**.

## <a name="refactoring-and-renaming"></a>Рефакторинг и переименование

Рефакторинг — это программная методология, включающая реструктуризацию кода для упрощения понимания и обслуживания, сохраняя его функциональность. Простым примером может быть написание кода в обработчике событий для получения данных из базы данных. При разработке страницы вы обнаружите, что вам нужно получить доступ к данным из нескольких разных обработчиков. Поэтому рефакторинг кода страницы создается путем создания метода доступа к данным на странице и вставки вызовов метода в обработчики.

Редактор кода включает средства, помогающие выполнять различные задачи рефакторинга. В этом пошаговом руководстве вы будете работать с двумя методами рефакторинга: переименование переменных и извлечение методов. Другие параметры рефакторинга включают инкапсуляцию полей, преобразование локальных переменных в параметры методов и управление параметрами методов. Доступность этих параметров рефакторинга зависит от расположения в коде.

### <a name="refactoring-code"></a>Рефакторинг кода

Распространенным сценарием рефакторинга является создание (извлечение) метода из кода, который находится внутри другого элемента, например метода. Это уменьшает размер исходного элемента и делает извлеченный код пригодным для повторного использования.

В этой части пошагового руководства будет написан простой код, а затем извлечен метод из него. Рефакторинг поддерживается для C#, поэтому вы создадите страницу, которая использует C# в качестве языка программирования.

### <a name="to-extract-a-method-in-a-c-page"></a>Извлечение метода на C# странице

1. Переключитесь в режим **конструктора** .
2. На **панели элементов**на вкладке **Стандартная** перетащите элемент управления [Button](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.aspx) на страницу.
3. Дважды щелкните элемент управления **"Кнопка"** , чтобы создать обработчик для события [щелчка](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.click.aspx) , а затем добавьте следующий выделенный код:

    [!code-csharp[Main](code-editing-in-web-forms-pages/samples/sample2.cs?highlight=3-16)]

   Код создает объект **ArrayList** , использует цикл для его загрузки со значениями, а затем использует другой цикл для вывода содержимого объекта **ArrayList** .
4. Нажмите клавиши **CTRL + F5** , чтобы запустить страницу, а затем нажмите **кнопку, чтобы убедиться** , что отображаются следующие выходные данные:   

    [!code-html[Main](code-editing-in-web-forms-pages/samples/sample3.html)]
5. Вернитесь в редактор кода и выберите следующие строки в обработчике событий.   

    [!code-html[Main](code-editing-in-web-forms-pages/samples/sample4.html)]
6. Щелкните выделенный фрагмент правой кнопкой мыши, выберите пункт **Рефакторинг**, а затем выберите пункт **извлечь метод**. 

    Откроется диалоговое окно **Извлечение метода** .
7. В поле **новое имя метода** введите **дисплайаррай**и нажмите кнопку **ОК**. 

    Редактор кода создает новый метод с именем `DisplayArray`и помещает вызов в новый метод в обработчике **щелчка** , где изначально был цикл.

    [!code-csharp[Main](code-editing-in-web-forms-pages/samples/sample5.cs?highlight=12)]
8. Нажмите клавиши **CTRL + F5** , чтобы снова запустить страницу, и нажмите **кнопку.**

    Страница функционирует так же, как и раньше. Теперь метод `DisplayArray` можно вызывать из любого места в классе Page.

## <a name="renaming-variables"></a>Переименование переменных

При работе с переменными, а также с объектами может потребоваться переименовать их после того, как в коде уже есть ссылка. Однако переименование переменных и объектов может привести к прерыванию кода, если вы не переименование одной из ссылок. Таким образом, для выполнения переименования можно использовать рефакторинг.

### <a name="to-use-refactoring-to-rename-a-variable"></a>Использование рефакторинга для переименования переменной

1. В обработчике событий **Click** перейдите к следующей строке:

    [!code-csharp[Main](code-editing-in-web-forms-pages/samples/sample6.cs)]
2. Щелкните правой кнопкой мыши имя переменной `alist`, выберите **Рефакторинг**, а затем щелкните **Переименовать**.

    Откроется диалоговое окно **Переименование** .
3. В поле **New Name (новое имя** ) введите **ArrayList1** и убедитесь, что установлен флажок **Предварительный просмотр изменений ссылок** . Нажмите кнопку **ОК**.

    Откроется диалоговое окно **Просмотр изменений** и отобразится дерево, содержащее все ссылки на переменную, для которой выполняется переименование.
4. Нажмите кнопку **Применить** , чтобы закрыть диалоговое окно **Просмотр изменений** .

    Переменные, относящиеся к выбранному экземпляру, будут переименованы. Однако обратите внимание, что переменная, `alist` в следующей строке, не переименовывается.

    [!code-csharp[Main](code-editing-in-web-forms-pages/samples/sample7.cs)]

    Переменная, `alist` в этой строке, не переименовывается, так как она не представляет то же значение, что и переменная `alist`, которую вы переименовали. Переменная, `alist` в объявлении `DisplayArray`, является локальной переменной для этого метода. Это показывает, что использование рефакторинга для переименования переменных отличается от простого выполнения операции поиска и замены в редакторе. Рефакторинг переименовывает переменные с учетом семантики переменной, с которой он работает.

## <a name="inserting-snippets"></a>Вставка фрагментов

Поскольку существует много задач программирования, которые часто требуется выполнять разработчикам веб-форм, редактор кода предоставляет библиотеку фрагментов, а также блоки с написанным кодом. Эти фрагменты кода можно вставить на страницу.

Каждый язык, используемый в Visual Studio, имеет небольшие отличия в способе вставки фрагментов кода. Дополнительные сведения о вставке фрагментов см. в разделе [Visual Basic IntelliSense Code фрагменты](https://msdn.microsoft.com/library/18yz4be4.aspx). Сведения о вставке фрагментов в визуальный C#элемент см. в разделе [фрагменты визуального C# кода](https://msdn.microsoft.com/library/z41h7fat.aspx).

## <a name="next-steps"></a>Next Steps

В этом пошаговом руководстве показаны основные возможности редактора кода Visual Studio 2010 для исправления ошибок в коде, рефакторинга кода, переименования переменных и вставки фрагментов кода в код. Дополнительные функции редактора могут упростить и ускорить разработку приложений. Например, может понадобиться:

- Дополнительные сведения о возможностях IntelliSense, таких как изменение параметров IntelliSense, управление фрагментами кода и Поиск фрагментов кода в Интернете. Дополнительные сведения см. в статье [Using IntelliSense](https://msdn.microsoft.com/library/hcw1s69b.aspx) (Использование IntelliSense).
- Узнайте, как создавать собственные фрагменты кода. Дополнительные сведения см. в разделе [Создание и использование фрагментов кода IntelliSense](https://msdn.microsoft.com/library/ms165392.aspx) .
- Дополнительные сведения о характерных для Visual Basic функциях фрагментов кода IntelliSense, таких как Настройка фрагментов и устранение неполадок. Дополнительные сведения см. в разделе [Visual Basic IntelliSense: фрагменты кода](https://msdn.microsoft.com/library/18yz4be4.aspx)
- Дополнительные сведения о C#функциях IntelliSense, таких как рефакторинг и фрагменты кода. Дополнительные сведения см. в [разделе C# Visual IntelliSense](https://msdn.microsoft.com/library/43f44291.aspx).
