---
uid: web-forms/overview/getting-started/code-editing-in-web-forms-pages
title: Редактирование кода веб-форм ASP.NET в Visual Studio 2013 | Документация Майкрософт
author: Erikre
description: ''
ms.author: riande
ms.date: 03/03/2014
ms.assetid: 5344b74e-b888-479a-92bc-601a33bd61a2
msc.legacyurl: /web-forms/overview/getting-started/code-editing-in-web-forms-pages
msc.type: authoredcontent
ms.openlocfilehash: 3473ad476fbbebc58e12586334b4600f57cf17ed
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65134242"
---
# <a name="code-editing-aspnet-web-forms-in-visual-studio-2013"></a>Редактирование кода в веб-формах ASP.NET в Visual Studio 2013

по [Erik Reitan](https://github.com/Erikre)

На многих страницах веб-форма ASP.NET вы напишете код на Visual Basic, C# или другом языке. Редактор кода в Visual Studio может помочь быстро написать код и избежать ошибок. Кроме того редактор предоставляет способ для создания повторно используемого кода с целью сокращения объема работы, которые необходимо выполнить.

В этом пошаговом руководстве показаны различные возможности в редакторе кода Visual Studio.

В этом пошаговом руководстве описаны следующие процедуры.

- Исправьте встроенные ошибки в написании кода.
- Рефакторинг и переименуйте кода.
- Переименуйте переменные и объекты.
- Вставка фрагментов кода.

## <a name="prerequisites"></a>Предварительные требования

Для выполнения данного пошагового руководства требуется:

- [Microsoft Visual Studio 2013](https://www.microsoft.com/visualstudio/11/downloads#vs) или [Microsoft Visual Studio Express 2013 для Web](https://www.microsoft.com/visualstudio/11/downloads#express-web). Платформа .NET Framework устанавливается автоматически. 

    > [!NOTE] 
    > 
    > Microsoft Visual Studio 2013 и Microsoft Visual Studio Express 2013 для Web будет часто обращаться как к Visual Studio данной серии учебных курсов.  
    >   
    > При использовании Visual Studio, в этом пошаговом руководстве предполагается, что выбрана **веб-разработки** набор параметров при первом запуске Visual Studio. Дополнительные сведения см. в разделе [Как Выберите параметры среды веб-разработки](https://msdn.microsoft.com/library/ff521558.aspx).

## <a name="creating-a-web-application-project-and-a-page"></a>Создание проекта веб-приложения и страницы

<a id="sectionToggle0"></a>

В этой части пошагового руководства будет создать проект веб-приложения и добавьте новую страницу к нему.

### <a name="to-create-a-web-application-project"></a>Чтобы создать проект веб-приложения

1. Open Microsoft Visual Studio.
2. В меню **Файл** выберите **Создать проект**.  
    ![Меню "файл"](code-editing-in-web-forms-pages/_static/image1.png)

    Откроется диалоговое окно **Новый проект** .
3. Выберите **шаблоны**  - &gt; **Visual C#**  - &gt; **Web** группы шаблонов в левой части.
4. Выберите **веб-приложение ASP.NET** шаблона в центральном столбце.
5. Присвойте проекту имя ***BasicWebApp*** и нажмите кнопку **ОК** кнопки.   
![Диалоговое окно "новый проект"](code-editing-in-web-forms-pages/_static/image2.png)
6. Затем выберите **веб-форм** шаблона и нажмите кнопку **ОК** кнопку, чтобы создать проект.  
![Диалоговое окно "новый проект ASP.NET"](code-editing-in-web-forms-pages/_static/image3.png)  

    Visual Studio создает новый проект, включающий стандартные функциональные возможности, на основе шаблона веб-форм.

## <a name="creating-a-new-aspnet-web-forms-page"></a>Создание новой страницы ASP.NET Web Forms

Когда вы создаете новое приложение веб-форм с помощью **веб-приложение ASP.NET** шаблон проекта Visual Studio добавляет страницы ASP.NET (страницы веб-форм) с именем *Default.aspx*, а также как несколько файлов и папки. Можно использовать *Default.aspx* страницу как на домашнюю страницу веб-приложения. Тем не менее в этом пошаговом руководстве будет создавать и работать с новой страницы.

### <a name="to-add-a-page-to-the-web-application"></a>Добавление страницы в веб-приложение

1. В **обозревателе решений**, щелкните правой кнопкой мыши имя веб-приложения (в этом руководстве, имя приложения — **BasicWebSite**), а затем нажмите кнопку **добавить**  - &gt; **Новый элемент**.   
Откроется диалоговое окно **Добавление нового элемента**.
2. Выберите **Visual C#**  - &gt; **Web** группы шаблонов в левой части. Выберите **веб-формы** из середины списка и назовите его *FirstWebPage.aspx*.   
    ![Добавить новый элемент-диалоговое окно](code-editing-in-web-forms-pages/_static/image4.png)
3. Нажмите кнопку **добавить** добавить страницу веб-формы в проект.  
 Visual Studio создаст новую страницу и открывает его.
4. Затем установите эта новая страница в качестве стартовой страницы по умолчанию. В **обозревателе решений**, щелкните правой кнопкой мыши новую страницу с именем *FirstWebPage.aspx* и выберите **задать в качестве начальной страницы**. При запуске этого приложения, чтобы проверить ход работы, автоматически появится эта новая страница в браузере.

## <a name="correcting-inline-coding-errors"></a>Исправление встроенного ошибок кода

Редактор кода в Visual Studio помогает избежать ошибок, как написать код, а также при внесении ошибки, редактор кода позволяет, чтобы исправить эту ошибку. В этой части пошагового руководства будет написать строку кода, иллюстрирующие возможности исправления ошибок в редакторе.

### <a name="to-correct-simple-coding-errors-in-visual-studio"></a>Для исправления простых ошибок программирования в Visual Studio

1. В **разработки** дважды щелкните пустую страницу, чтобы создать обработчик для **нагрузки** событий для страницы.   
   Обработчик событий при использовании только как место для написания кода.
2. Внутри обработчика, введите следующую строку, которая содержит ошибку и нажмите клавишу **ввод**:

    [!code-csharp[Main](code-editing-in-web-forms-pages/samples/sample1.cs)]

   При нажатии клавиши **ввод**, редактор кода помещает зеленого и красного подчеркивание (часто вызывают &quot;волнистой&quot; строк) в областях кода, которые возникают проблемы. Зеленой линией указывает на предупреждение. Красной линией указывает на ошибку, необходимо исправить. 

    Наведите указатель мыши на `myStr` чтобы увидеть подсказку, которая сообщает о предупреждении. Кроме того наведите указатель мыши на красную линию, чтобы просмотреть сообщение об ошибке.

    Ниже приведен код с подчеркивание.

    ![Текст приветствия в режиме конструктора](code-editing-in-web-forms-pages/_static/image5.png "текст приветствия в режиме конструктора")  
   Ошибки необходимо устранить, добавив точку с запятой `;` до конца строки. Предупреждение просто сообщит, что вы не использовали `myStr` еще переменной.  

    > [!NOTE] 
    > 
    > Просмотреть текущий код форматирования параметров в Visual Studio, выбрав **средства**  - &gt; **параметры**  - &gt; **шрифты и Цвета**.

## <a name="refactoring-and-renaming"></a>Оптимизация кода и переименование

Рефакторинг — это программным методом, включающим реструктуризацию кода, чтобы упростить для понимания и поддерживать, сохранением его функциональных возможностей. Простой пример может быть писать код в обработчик событий для получения данных из базы данных. При разработке страницы, вы обнаруживаете, что необходимо обращаться к данным из нескольких разных обработчиков. Таким образом путем создания метода доступа к данным на странице и вставка вызовы метода в обработчиках при рефакторинге кода страницы.

Редактор кода содержит средства, помогающие выполнять различные задачи оптимизации кода. В этом пошаговом руководстве вы будете использовать два метода оптимизации кода: переименование переменных и методы извлечения. Другие параметры оптимизации кода включают инкапсуляцию полей, преобразование локальных переменных в параметры метода и управление параметрами метода. Доступность этих параметров оптимизации зависит от расположения в коде.

### <a name="refactoring-code"></a>Рефакторинг кода

Обычным сценарием оптимизации кода является создание (извлечение) метода из кода, который находится внутри другого элемента, например метод. Это уменьшает размер исходного элемента и делает извлеченные код для повторного использования.

В этой части пошагового руководства будет написать простой код и затем извлечение метода из него. Рефакторинг поддерживается для C#, поэтому вы создадите страницы, который использует в качестве языка программирования C#.

### <a name="to-extract-a-method-in-a-c-page"></a>Извлечение метода на странице C#

1. Переключиться в режим **разработки** представления.
2. В **элементов**, из **стандартный** вкладке, перетащите [кнопку](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.aspx) на страницу.
3. Дважды щелкните **кнопку** управления, чтобы создать обработчик для его [щелкните](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.click.aspx) событий, а затем добавьте следующий выделенный код:

    [!code-csharp[Main](code-editing-in-web-forms-pages/samples/sample2.cs?highlight=3-16)]

   Код создает **ArrayList** использует цикл для загрузки в него значения объекта и затем использует другой цикл для отображения содержимого **ArrayList** объекта.
4. Нажмите клавишу **CTRL + F5** для запуска страницы и нажмите кнопку **кнопку** чтобы убедиться в том, что вы видите следующее:   

    [!code-html[Main](code-editing-in-web-forms-pages/samples/sample3.html)]
5. Вернитесь в редактор кода, а затем выберите следующие строки в обработчике событий.   

    [!code-html[Main](code-editing-in-web-forms-pages/samples/sample4.html)]
6. Правой кнопкой мыши, нажмите кнопку **рефакторинг**, а затем выберите **извлечение метода**. 

    **Извлечение метода** откроется диалоговое окно.
7. В **новому методу имя** введите **DisplayArray**, а затем нажмите кнопку **ОК**. 

    Редактор кода создаст новый метод с именем `DisplayArray`и поместит вызов нового метода в **щелкните** обработчик, где изначально находился цикл.

    [!code-csharp[Main](code-editing-in-web-forms-pages/samples/sample5.cs?highlight=12)]
8. Нажмите клавишу **CTRL + F5** снова запустить страницу, а затем нажмите кнопку **кнопку**.

    Страницы работает так же, как и раньше. `DisplayArray` Метод теперь может быть вызов из любого места в классе страницы.

## <a name="renaming-variables"></a>Переименование переменных

При работе с переменными, а также объекты, можно переименовать их после уже заданы в коде. Тем не менее переименование, переменные и объекты, может вызвать код, чтобы сделать недействительными будет пропущено переименование одну из ссылок. Таким образом рефакторинг можно использовать для выполнения переименования.

### <a name="to-use-refactoring-to-rename-a-variable"></a>Использование рефакторинга для переименования переменной

1. В **щелкните** обработчик событий, найдите следующую строку:

    [!code-csharp[Main](code-editing-in-web-forms-pages/samples/sample6.cs)]
2. Щелкните правой кнопкой мыши имя переменной `alist`, выберите **рефакторинг**, а затем выберите **Переименовать**.

    **Переименовать** откроется диалоговое окно.
3. В **новое имя** введите **ArrayList1** и убедитесь, что **Предварительный просмотр изменений ссылок** флажка. Затем нажмите кнопку **ОК**.

    **Просмотр изменений** диалоговое окно отображается, а также отображается дерево, содержащее все ссылки на переменную, которая при переименовании.
4. Нажмите кнопку **применить** закрыть **Просмотр изменений** диалоговое окно.

    Переменные, относящиеся именно к экземпляр, который вы выбрали переименовываются. Обратите внимание, что переменная `alist` в следующей строке не переименовывается.

    [!code-csharp[Main](code-editing-in-web-forms-pages/samples/sample7.cs)]

    Переменная `alist` в этой строке не переименован, поскольку он не представляет то же значение, что переменная `alist` переименованный. Переменная `alist` в `DisplayArray` объявление является локальной переменной для этого метода. Это иллюстрирует, что с помощью рефакторинга для переименования переменные отличается от простого действия поиска и замены в редакторе. Рефакторинг переименования переменные с знания семантики переменной, с которым идет работа.

## <a name="inserting-snippets"></a>Вставка фрагментов

Так как существует много задач кодирования, которые часто необходимо выполнять разработчикам веб-форм, редактор кода предоставляет библиотеку фрагментов, или блоков предварительно написанного кода. Эти фрагменты кода можно вставить в страницу.

Каждый язык, который используется в Visual Studio имеет небольшие различия в способ вставки фрагментов кода. Сведения о вставке фрагментов см. в разделе [фрагменты кода IntelliSense в Visual Basic](https://msdn.microsoft.com/library/18yz4be4.aspx). Сведения о вставке фрагментов кода в Visual C#, см. в разделе [фрагменты кода Visual C#](https://msdn.microsoft.com/library/z41h7fat.aspx).

## <a name="next-steps"></a>Следующие шаги

В этом пошаговом руководстве показаны базовые возможности редактора кода Visual Studio 2010 для исправления ошибок в коде, рефакторинга кода, переименование переменных и вставки фрагментов кода в код. Дополнительные функции в редакторе делают разработку приложения и быстро. Например, можно сделать следующее:

- Дополнительные сведения о функциях, IntelliSense, такие как изменение параметров IntelliSense, управление фрагментами кода и поиск фрагментов кода в Интернете. Дополнительные сведения см. в статье [Using IntelliSense](https://msdn.microsoft.com/library/hcw1s69b.aspx) (Использование IntelliSense).
- Вы научитесь создавать собственные фрагменты кода. Дополнительные сведения см. в разделе [Создание и использование фрагментов кода](https://msdn.microsoft.com/library/ms165392.aspx)
- Дополнительные сведения о функциях языка Visual Basic, фрагменты кода IntelliSense, такие как настройка фрагментов и устранение неполадок. Дополнительные сведения см. в разделе [фрагменты кода IntelliSense в Visual Basic](https://msdn.microsoft.com/library/18yz4be4.aspx)
- Дополнительные сведения о C#-отдельных функций IntelliSense, такие как рефакторинг и фрагменты кода. Дополнительные сведения см. в разделе [IntelliSense для Visual C#](https://msdn.microsoft.com/library/43f44291.aspx).
