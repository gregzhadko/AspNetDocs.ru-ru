---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/customizing-the-datalist-s-editing-interface-vb
title: Настройка интерфейса правки элемента управления DataList (VB) | Документация Майкрософт
author: rick-anderson
description: В этом учебнике мы создадим расширенный интерфейс редактирования для DataList, включающий элементов управления DropDownList и CheckBox.
ms.author: riande
ms.date: 10/30/2006
ms.assetid: 718628e2-224c-455f-b33a-a41efd48d5a0
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/customizing-the-datalist-s-editing-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: adee419764cff2f39ee16962080c24b52553aa14
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74637596"
---
# <a name="customizing-the-datalists-editing-interface-vb"></a><span data-ttu-id="3cc45-103">Настройка интерфейса правки элемента управления DataList (VB)</span><span class="sxs-lookup"><span data-stu-id="3cc45-103">Customizing the DataList's Editing Interface (VB)</span></span>

<span data-ttu-id="3cc45-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="3cc45-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="3cc45-105">[Скачивание примера приложения](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_40_VB.exe) или [Загрузка PDF-файла](customizing-the-datalist-s-editing-interface-vb/_static/datatutorial40vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="3cc45-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_40_VB.exe) or [Download PDF](customizing-the-datalist-s-editing-interface-vb/_static/datatutorial40vb1.pdf)</span></span>

> <span data-ttu-id="3cc45-106">В этом учебнике мы создадим расширенный интерфейс редактирования для DataList, включающий элементов управления DropDownList и CheckBox.</span><span class="sxs-lookup"><span data-stu-id="3cc45-106">In this tutorial we will create a richer editing interface for the DataList, one that includes DropDownLists and a CheckBox.</span></span>

## <a name="introduction"></a><span data-ttu-id="3cc45-107">Введение</span><span class="sxs-lookup"><span data-stu-id="3cc45-107">Introduction</span></span>

<span data-ttu-id="3cc45-108">Разметка и веб-элементы управления в DataList `EditItemTemplate` определяют его изменяемый интерфейс.</span><span class="sxs-lookup"><span data-stu-id="3cc45-108">The markup and Web controls in the DataList s `EditItemTemplate` define its editable interface.</span></span> <span data-ttu-id="3cc45-109">Во всех изменяемых примерах DataList, которые мы уже рассматривали ранее, редактируемый интерфейс состоит из веб-элементов управления TextBox.</span><span class="sxs-lookup"><span data-stu-id="3cc45-109">In all of the editable DataList examples we ve examined thus far, the editable interface has been composed of TextBox Web controls.</span></span> <span data-ttu-id="3cc45-110">В [предыдущем учебном курсе](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md) мы улучшили взаимодействие с пользователем во время редактирования, добавив элементы управления проверки.</span><span class="sxs-lookup"><span data-stu-id="3cc45-110">In the [preceding tutorial](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md) we improved the edit-time user experience by adding validation controls.</span></span>

<span data-ttu-id="3cc45-111">`EditItemTemplate` можно дополнительно расширить для включения веб-элементов управления, отличных от текстового поля, например элементов управления DropDownList, RadioButtonList, Calendars и т. д.</span><span class="sxs-lookup"><span data-stu-id="3cc45-111">The `EditItemTemplate` can be further expanded to include Web controls other than the TextBox, such as DropDownLists, RadioButtonLists, Calendars, and so on.</span></span> <span data-ttu-id="3cc45-112">Как и в случае с текстовыми полями, при настройке интерфейса редактирования для включения других веб-элементов управления выполните следующие действия.</span><span class="sxs-lookup"><span data-stu-id="3cc45-112">As with TextBoxes, when customizing the editing interface to include other Web controls, employ the following steps:</span></span>

1. <span data-ttu-id="3cc45-113">Добавьте веб-элемент управления в `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-113">Add the Web control to the `EditItemTemplate`.</span></span>
2. <span data-ttu-id="3cc45-114">Используйте синтаксис DataBinding, чтобы присвоить соответствующее значение полю данных соответствующему свойству.</span><span class="sxs-lookup"><span data-stu-id="3cc45-114">Use databinding syntax to assign the corresponding data field value to the appropriate property.</span></span>
3. <span data-ttu-id="3cc45-115">В обработчике `UpdateCommand` событий получите программный доступ к значению веб-элемента управления и передайте его в соответствующий метод BLL.</span><span class="sxs-lookup"><span data-stu-id="3cc45-115">In the `UpdateCommand` event handler, programmatically access the Web control value and pass it into the appropriate BLL method.</span></span>

<span data-ttu-id="3cc45-116">В этом учебнике мы создадим расширенный интерфейс редактирования для DataList, включающий элементов управления DropDownList и CheckBox.</span><span class="sxs-lookup"><span data-stu-id="3cc45-116">In this tutorial we will create a richer editing interface for the DataList, one that includes DropDownLists and a CheckBox.</span></span> <span data-ttu-id="3cc45-117">В частности, мы создадим элемент управления DataList, содержащий сведения о продукте, и допускает обновление названия продукта, поставщика, категории и состояния "снято с производства" (см. рис. 1).</span><span class="sxs-lookup"><span data-stu-id="3cc45-117">In particular, we'll create a DataList that lists product information and permits the product s name, supplier, category, and discontinued status to be updated (see Figure 1).</span></span>

<span data-ttu-id="3cc45-118">[![интерфейс редактирования включает текстовое поле, два элементов управления DropDownList и флажок.](customizing-the-datalist-s-editing-interface-vb/_static/image2.png)](customizing-the-datalist-s-editing-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="3cc45-118">[![The Editing Interface Includes a TextBox, Two DropDownLists, and a CheckBox](customizing-the-datalist-s-editing-interface-vb/_static/image2.png)](customizing-the-datalist-s-editing-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="3cc45-119">**Рис. 1**. интерфейс редактирования включает текстовое поле, два элементов управления DropDownList и флажок ([щелкните, чтобы просмотреть изображение с полным размером](customizing-the-datalist-s-editing-interface-vb/_static/image3.png)).</span><span class="sxs-lookup"><span data-stu-id="3cc45-119">**Figure 1**: The Editing Interface Includes a TextBox, Two DropDownLists, and a CheckBox ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image3.png))</span></span>

## <a name="step-1-displaying-product-information"></a><span data-ttu-id="3cc45-120">Шаг 1. Отображение сведений о продукте</span><span class="sxs-lookup"><span data-stu-id="3cc45-120">Step 1: Displaying Product Information</span></span>

<span data-ttu-id="3cc45-121">Прежде чем можно будет создать интерфейс для редактирования DataList s, сначала необходимо создать интерфейс только для чтения.</span><span class="sxs-lookup"><span data-stu-id="3cc45-121">Before we can create the DataList s editable interface, we first need to build the read-only interface.</span></span> <span data-ttu-id="3cc45-122">Для начала откройте страницу `CustomizedUI.aspx` из папки `EditDeleteDataList` и в конструкторе добавьте на страницу элемент управления DataList, установив для свойства `ID` значение `Products`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-122">Start by opening the `CustomizedUI.aspx` page from the `EditDeleteDataList` folder and, from the Designer, add a DataList to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="3cc45-123">Из смарт-тега DataList создайте новый элемент управления ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="3cc45-123">From the DataList s smart tag, create a new ObjectDataSource.</span></span> <span data-ttu-id="3cc45-124">Назовите этот новый элемент ObjectDataSource `ProductsDataSource` и настройте его для получения данных из метода `ProductsBLL` класса s `GetProducts`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-124">Name this new ObjectDataSource `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="3cc45-125">Как и в предыдущих руководствах по DataList, мы будем обновлять измененные сведения о продуктах, переполняя их непосредственно на уровень бизнес-логики.</span><span class="sxs-lookup"><span data-stu-id="3cc45-125">As with the previous editable DataList tutorials, we'll update the edited product s information by going directly to the Business Logic Layer.</span></span> <span data-ttu-id="3cc45-126">Соответственно, установите в раскрывающихся списках на вкладках обновления, вставки и удаления значение (нет).</span><span class="sxs-lookup"><span data-stu-id="3cc45-126">Accordingly, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None).</span></span>

<span data-ttu-id="3cc45-127">[![установить в раскрывающихся списках "обновление", "вставить" и "Удалить" значение (нет)](customizing-the-datalist-s-editing-interface-vb/_static/image5.png)](customizing-the-datalist-s-editing-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="3cc45-127">[![Set the UPDATE, INSERT, and DELETE Tabs Drop-Down Lists to (None)](customizing-the-datalist-s-editing-interface-vb/_static/image5.png)](customizing-the-datalist-s-editing-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="3cc45-128">**Рис. 2**. Установка в раскрывающихся СПИСКАХ «обновление», «вставка» и «удаление» (нет) ([щелкните, чтобы просмотреть изображение с полным размером](customizing-the-datalist-s-editing-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="3cc45-128">**Figure 2**: Set the UPDATE, INSERT, and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image6.png))</span></span>

<span data-ttu-id="3cc45-129">После настройки ObjectDataSource Visual Studio создаст `ItemTemplate` по умолчанию для элемента управления DataList, в котором будет указано имя и значение для каждого возвращаемого поля данных.</span><span class="sxs-lookup"><span data-stu-id="3cc45-129">After configuring the ObjectDataSource, Visual Studio will create a default `ItemTemplate` for the DataList that lists the name and value for each of the data fields returned.</span></span> <span data-ttu-id="3cc45-130">Измените `ItemTemplate` таким образом, чтобы шаблон выводит название продукта в элементе `<h4>`, а также имя категории, имя поставщика, Цена и состояние неподдерживаемого состояния.</span><span class="sxs-lookup"><span data-stu-id="3cc45-130">Modify the `ItemTemplate` so that the template lists the product name in an `<h4>` element along with the category name, supplier name, price, and discontinued status.</span></span> <span data-ttu-id="3cc45-131">Более того, добавьте кнопку Edit (изменить), убедившись, что ее свойство `CommandName` имеет значение Edit.</span><span class="sxs-lookup"><span data-stu-id="3cc45-131">Moreover, add an Edit button, making sure that its `CommandName` property is set to Edit.</span></span> <span data-ttu-id="3cc45-132">Декларативная разметка для My `ItemTemplate` выглядит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="3cc45-132">The declarative markup for my `ItemTemplate` follows:</span></span>

[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="3cc45-133">Приведенная выше разметка размещает сведения о продукте, используя заголовок &lt;H4&gt; для названия продукта и `<table>` четыре столбца для остальных полей.</span><span class="sxs-lookup"><span data-stu-id="3cc45-133">The above markup lays out the product information using an &lt;h4&gt; heading for the product s name and a four-column `<table>` for the remaining fields.</span></span> <span data-ttu-id="3cc45-134">Классы `ProductPropertyLabel` и `ProductPropertyValue` CSS, определенные в `Styles.css`, были рассмотрены в предыдущих руководствах.</span><span class="sxs-lookup"><span data-stu-id="3cc45-134">The `ProductPropertyLabel` and `ProductPropertyValue` CSS classes, defined in `Styles.css`, have been discussed in previous tutorials.</span></span> <span data-ttu-id="3cc45-135">На рис. 3 показан ход выполнения при просмотре в браузере.</span><span class="sxs-lookup"><span data-stu-id="3cc45-135">Figure 3 shows our progress when viewed through a browser.</span></span>

<span data-ttu-id="3cc45-136">[![имя, поставщик, категория, неподдерживаемое состояние и цена каждого продукта.](customizing-the-datalist-s-editing-interface-vb/_static/image8.png)](customizing-the-datalist-s-editing-interface-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="3cc45-136">[![The Name, Supplier, Category, Discontinued Status, and Price of Each Product is Displayed](customizing-the-datalist-s-editing-interface-vb/_static/image8.png)](customizing-the-datalist-s-editing-interface-vb/_static/image7.png)</span></span>

<span data-ttu-id="3cc45-137">**Рис. 3**. Отображение имени, поставщика, категории, неподдерживаемого состояния и цены каждого продукта ([щелкните, чтобы просмотреть изображение с полным размером](customizing-the-datalist-s-editing-interface-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="3cc45-137">**Figure 3**: The Name, Supplier, Category, Discontinued Status, and Price of Each Product is Displayed ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image9.png))</span></span>

## <a name="step-2-adding-the-web-controls-to-the-editing-interface"></a><span data-ttu-id="3cc45-138">Шаг 2. Добавление веб-элементов управления в интерфейс правки</span><span class="sxs-lookup"><span data-stu-id="3cc45-138">Step 2: Adding the Web Controls to the Editing Interface</span></span>

<span data-ttu-id="3cc45-139">Первым шагом в создании настраиваемого интерфейса редактирования DataList является добавление необходимых веб-элементов управления в `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-139">The first step in building the customized DataList editing interface is to add the needed Web controls to the `EditItemTemplate`.</span></span> <span data-ttu-id="3cc45-140">В частности, нам нужен элемент DropDownList для категории, другой для поставщика, а флажок для состояния "снят с учета".</span><span class="sxs-lookup"><span data-stu-id="3cc45-140">In particular, we need a DropDownList for the category, another for the supplier, and a CheckBox for the discontinued state.</span></span> <span data-ttu-id="3cc45-141">Так как в этом примере цена продукта недоступна для редактирования, можно продолжить ее отображение с помощью веб-элемента управления Label.</span><span class="sxs-lookup"><span data-stu-id="3cc45-141">Since the product s price is not editable in this example, we can continue displaying it using a Label Web control.</span></span>

<span data-ttu-id="3cc45-142">Чтобы настроить интерфейс редактирования, щелкните ссылку Edit Templates (изменить шаблоны) в смарт-теге DataList и выберите параметр `EditItemTemplate` из раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="3cc45-142">To customize the editing interface, click on the Edit Templates link from the DataList s smart tag and choose the `EditItemTemplate` option from the drop-down list.</span></span> <span data-ttu-id="3cc45-143">Добавьте элемент DropDownList в `EditItemTemplate` и задайте для его `ID` значение `Categories`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-143">Add a DropDownList to the `EditItemTemplate` and set its `ID` to `Categories`.</span></span>

<span data-ttu-id="3cc45-144">[![добавить DropDownList для категорий](customizing-the-datalist-s-editing-interface-vb/_static/image11.png)](customizing-the-datalist-s-editing-interface-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="3cc45-144">[![Add a DropDownList for the Categories](customizing-the-datalist-s-editing-interface-vb/_static/image11.png)](customizing-the-datalist-s-editing-interface-vb/_static/image10.png)</span></span>

<span data-ttu-id="3cc45-145">**Рис. 4**. Добавление DropDownList для категорий ([щелкните, чтобы просмотреть изображение с полным размером](customizing-the-datalist-s-editing-interface-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="3cc45-145">**Figure 4**: Add a DropDownList for the Categories ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image12.png))</span></span>

<span data-ttu-id="3cc45-146">Затем в смарт-теге DropDownList выберите вариант Выбор источника данных и создайте новый элемент ObjectDataSource с именем `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-146">Next, from the DropDownList s smart tag, select the Choose Data Source option and create a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="3cc45-147">Настройте этот элемент ObjectDataSource для использования метода `GetCategories()` `CategoriesBLL` классов (см. рис. 5).</span><span class="sxs-lookup"><span data-stu-id="3cc45-147">Configure this ObjectDataSource to use the `CategoriesBLL` class s `GetCategories()` method (see Figure 5).</span></span> <span data-ttu-id="3cc45-148">Затем мастер настройки источника данных DropDownList s запрашивает поля данных для каждого `ListItem` s `Text` и `Value` свойств.</span><span class="sxs-lookup"><span data-stu-id="3cc45-148">Next, the DropDownList s Data Source Configuration Wizard prompts for the data fields to use for each `ListItem` s `Text` and `Value` properties.</span></span> <span data-ttu-id="3cc45-149">В DropDownList отобразится поле данных `CategoryName` и используйте `CategoryID` в качестве значения, как показано на рис. 6.</span><span class="sxs-lookup"><span data-stu-id="3cc45-149">Have the DropDownList display the `CategoryName` data field and use the `CategoryID` as the value, as shown in Figure 6.</span></span>

<span data-ttu-id="3cc45-150">[![создать новый элемент управления ObjectDataSource с именем CategoriesDataSource](customizing-the-datalist-s-editing-interface-vb/_static/image14.png)](customizing-the-datalist-s-editing-interface-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="3cc45-150">[![Create a New ObjectDataSource Named CategoriesDataSource](customizing-the-datalist-s-editing-interface-vb/_static/image14.png)](customizing-the-datalist-s-editing-interface-vb/_static/image13.png)</span></span>

<span data-ttu-id="3cc45-151">**Рис. 5**. Создание нового элемента управления ObjectDataSource с именем `CategoriesDataSource` ([щелкните, чтобы просмотреть изображение с полным размером](customizing-the-datalist-s-editing-interface-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="3cc45-151">**Figure 5**: Create a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image15.png))</span></span>

<span data-ttu-id="3cc45-152">[![настройке полей вывода и значений DropDownList](customizing-the-datalist-s-editing-interface-vb/_static/image17.png)](customizing-the-datalist-s-editing-interface-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="3cc45-152">[![Configure the DropDownList s Display and Value Fields](customizing-the-datalist-s-editing-interface-vb/_static/image17.png)](customizing-the-datalist-s-editing-interface-vb/_static/image16.png)</span></span>

<span data-ttu-id="3cc45-153">**Рис. 6**. Настройка полей отображения и значений DropDownList ([щелкните, чтобы просмотреть изображение с полным размером](customizing-the-datalist-s-editing-interface-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="3cc45-153">**Figure 6**: Configure the DropDownList s Display and Value Fields ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image18.png))</span></span>

<span data-ttu-id="3cc45-154">Повторите эту последовательность действий, чтобы создать DropDownList для поставщиков.</span><span class="sxs-lookup"><span data-stu-id="3cc45-154">Repeat this series of steps to create a DropDownList for the suppliers.</span></span> <span data-ttu-id="3cc45-155">Задайте `ID` для этого DropDownList, чтобы `Suppliers` и присвоить имя `SuppliersDataSource`ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="3cc45-155">Set the `ID` for this DropDownList to `Suppliers` and name its ObjectDataSource `SuppliersDataSource`.</span></span>

<span data-ttu-id="3cc45-156">После добавления двух элементов управления DropDownList добавьте флажок для неподдерживаемого состояния и текстовое поле для имени продукта.</span><span class="sxs-lookup"><span data-stu-id="3cc45-156">After adding the two DropDownLists, add a CheckBox for the discontinued state and a TextBox for the product s name.</span></span> <span data-ttu-id="3cc45-157">Задайте `ID` s для CheckBox и текстового поля, чтобы `Discontinued` и `ProductName`соответственно.</span><span class="sxs-lookup"><span data-stu-id="3cc45-157">Set the `ID` s for the CheckBox and TextBox to `Discontinued` and `ProductName`, respectively.</span></span> <span data-ttu-id="3cc45-158">Добавьте RequiredFieldValidator, чтобы гарантировать, что пользователь предоставит значение для имени продукта.</span><span class="sxs-lookup"><span data-stu-id="3cc45-158">Add a RequiredFieldValidator to ensure that the user provides a value for the product s name.</span></span>

<span data-ttu-id="3cc45-159">Наконец, добавьте кнопки обновления и отмены.</span><span class="sxs-lookup"><span data-stu-id="3cc45-159">Lastly, add the Update and Cancel buttons.</span></span> <span data-ttu-id="3cc45-160">Помните, что для этих двух кнопок необходимо, чтобы свойства `CommandName` были настроены на обновление и отмену соответственно.</span><span class="sxs-lookup"><span data-stu-id="3cc45-160">Remember that for these two buttons it is imperative that their `CommandName` properties are set to Update and Cancel, respectively.</span></span>

<span data-ttu-id="3cc45-161">Вы можете создать макет интерфейса редактирования, но вам нравится.</span><span class="sxs-lookup"><span data-stu-id="3cc45-161">Feel free to lay out the editing interface however you like.</span></span> <span data-ttu-id="3cc45-162">Я решил использовать тот же макет `<table>` четырех столбцов из интерфейса только для чтения, так как следующий декларативный синтаксис и снимок экрана иллюстрирует:</span><span class="sxs-lookup"><span data-stu-id="3cc45-162">I ve opted to use the same four-column `<table>` layout from the read-only interface, as the following declarative syntax and screen shot illustrates:</span></span>

[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample2.aspx)]

<span data-ttu-id="3cc45-163">[![интерфейс редактирования располагается как интерфейс только для чтения.](customizing-the-datalist-s-editing-interface-vb/_static/image20.png)](customizing-the-datalist-s-editing-interface-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="3cc45-163">[![The Editing Interface is Laid Out like the Read-Only Interface](customizing-the-datalist-s-editing-interface-vb/_static/image20.png)](customizing-the-datalist-s-editing-interface-vb/_static/image19.png)</span></span>

<span data-ttu-id="3cc45-164">**Рис. 7**. интерфейс редактирования располагается как интерфейс только для чтения ([щелкните, чтобы просмотреть изображение с полным размером](customizing-the-datalist-s-editing-interface-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="3cc45-164">**Figure 7**: The Editing Interface is Laid Out like the Read-Only Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image21.png))</span></span>

## <a name="step-3-creating-the-editcommand-and-cancelcommand-event-handlers"></a><span data-ttu-id="3cc45-165">Шаг 3. Создание обработчиков событий Едиткомманд и CancelCommand</span><span class="sxs-lookup"><span data-stu-id="3cc45-165">Step 3: Creating the EditCommand and CancelCommand Event Handlers</span></span>

<span data-ttu-id="3cc45-166">В настоящее время в `EditItemTemplate` нет синтаксиса привязки данных (за исключением `UnitPriceLabel`, который был скопирован с `ItemTemplate`).</span><span class="sxs-lookup"><span data-stu-id="3cc45-166">Currently, there is no databinding syntax in the `EditItemTemplate` (except for the `UnitPriceLabel`, which was copied over verbatim from the `ItemTemplate`).</span></span> <span data-ttu-id="3cc45-167">Мы добавим синтаксис DataBinding мгновенно, но сначала создадим обработчики событий для `EditCommand` и `CancelCommand` событий DataList.</span><span class="sxs-lookup"><span data-stu-id="3cc45-167">We'll add the databinding syntax momentarily, but first let s create the event handlers for the DataList s `EditCommand` and `CancelCommand` events.</span></span> <span data-ttu-id="3cc45-168">Помните, что ответственность за `EditCommand` обработчика событий заключается в отображении интерфейса правки для элемента DataList, для которого была нажата кнопка Edit, в то время как задание `CancelCommand` s — возврат элемента управления DataList к состоянию до его предварительного редактирования.</span><span class="sxs-lookup"><span data-stu-id="3cc45-168">Recall that the responsibility of the `EditCommand` event handler is to render the editing interface for the DataList item whose Edit button was clicked, whereas the `CancelCommand` s job is to return the DataList to its pre-editing state.</span></span>

<span data-ttu-id="3cc45-169">Создайте эти два обработчика событий и используйте следующий код:</span><span class="sxs-lookup"><span data-stu-id="3cc45-169">Create these two event handlers and have them use the following code:</span></span>

[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample3.vb)]

<span data-ttu-id="3cc45-170">При наличии этих двух обработчиков событий при нажатии кнопки «изменить» отображается интерфейс редактирования, а при нажатии кнопки «Отмена» отредактированный элемент возвращается в режим «только для чтения».</span><span class="sxs-lookup"><span data-stu-id="3cc45-170">With these two event handlers in place, clicking the Edit button displays the editing interface and clicking the Cancel button returns the edited item to its read-only mode.</span></span> <span data-ttu-id="3cc45-171">На рис. 8 показан элемент управления DataList после нажатия кнопки Edit (изменить) Gumbo Chef Anton's s.</span><span class="sxs-lookup"><span data-stu-id="3cc45-171">Figure 8 shows the DataList after the Edit button has been clicked for Chef Anton s Gumbo Mix.</span></span> <span data-ttu-id="3cc45-172">Так как мы еще не добавили синтаксис привязки данных к интерфейсу правки, текстовое поле `ProductName` пусто, флажок `Discontinued` не установлен и первые элементы, выбранные из `Categories` и `Suppliers` элементов управления DropDownList.</span><span class="sxs-lookup"><span data-stu-id="3cc45-172">Since we ve yet to add any databinding syntax to the editing interface, the `ProductName` TextBox is blank, the `Discontinued` CheckBox unchecked, and the first items selected from the `Categories` and `Suppliers` DropDownLists.</span></span>

<span data-ttu-id="3cc45-173">[![нажатии кнопки "Изменить" отображается интерфейс редактирования](customizing-the-datalist-s-editing-interface-vb/_static/image23.png)](customizing-the-datalist-s-editing-interface-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="3cc45-173">[![Clicking the Edit Button Displays the Editing Interface](customizing-the-datalist-s-editing-interface-vb/_static/image23.png)](customizing-the-datalist-s-editing-interface-vb/_static/image22.png)</span></span>

<span data-ttu-id="3cc45-174">**Рис. 8**. при нажатии кнопки "Изменить" отображается интерфейс редактирования ([щелкните, чтобы просмотреть изображение с полным размером](customizing-the-datalist-s-editing-interface-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="3cc45-174">**Figure 8**: Clicking the Edit Button Displays the Editing Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image24.png))</span></span>

## <a name="step-4-adding-the-databinding-syntax-to-the-editing-interface"></a><span data-ttu-id="3cc45-175">Шаг 4. Добавление синтаксиса привязки данных в интерфейс правки</span><span class="sxs-lookup"><span data-stu-id="3cc45-175">Step 4: Adding the DataBinding Syntax to the Editing Interface</span></span>

<span data-ttu-id="3cc45-176">Чтобы интерфейс правки отображал значения текущих продуктов, необходимо использовать синтаксис DataBinding, чтобы присвоить значения полей данных соответствующим значениям веб-элемента управления.</span><span class="sxs-lookup"><span data-stu-id="3cc45-176">To have the editing interface display the current product s values, we need to use databinding syntax to assign the data field values to the appropriate Web control values.</span></span> <span data-ttu-id="3cc45-177">Синтаксис DataBinding можно применить в конструкторе, перейдя к экрану изменение шаблонов и выбрав ссылку изменить привязки данных в смарт-тегах элемента управления Web Controls.</span><span class="sxs-lookup"><span data-stu-id="3cc45-177">The databinding syntax can be applied through the Designer by going to the Edit Templates screen and selecting the Edit DataBindings link from the Web controls smart tags.</span></span> <span data-ttu-id="3cc45-178">Кроме того, синтаксис DataBinding можно добавить непосредственно в декларативную разметку.</span><span class="sxs-lookup"><span data-stu-id="3cc45-178">Alternatively, the databinding syntax can be added directly to the declarative markup.</span></span>

<span data-ttu-id="3cc45-179">Присвойте значение поля `ProductName` данных `Text` свойству `ProductName` текстовое поле s, `CategoryID` и `SupplierID` значения полей данных `Categories` и `Suppliers` элементов управления DropDownList `SelectedValue` свойства, а значение поля данных `Discontinued` `Discontinued` свойству `Checked`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-179">Assign the `ProductName` data field value to the `ProductName` TextBox s `Text` property, the `CategoryID` and `SupplierID` data field values to the `Categories` and `Suppliers` DropDownLists `SelectedValue` properties, and the `Discontinued` data field value to the `Discontinued` CheckBox s `Checked` property.</span></span> <span data-ttu-id="3cc45-180">После внесения этих изменений либо с помощью конструктора, либо непосредственно через декларативную разметку снова откройте страницу в браузере и нажмите кнопку изменить для Chef Anton's s Gumbo Mix.</span><span class="sxs-lookup"><span data-stu-id="3cc45-180">After making these changes, either through the Designer or directly through the declarative markup, revisit the page through a browser and click the Edit button for Chef Anton s Gumbo Mix.</span></span> <span data-ttu-id="3cc45-181">Как показано на рис. 9, синтаксис DataBinding добавил текущие значения в TextBox, элементов управления DropDownList и CheckBox.</span><span class="sxs-lookup"><span data-stu-id="3cc45-181">As Figure 9 shows, the databinding syntax has added the current values into the TextBox, DropDownLists, and CheckBox.</span></span>

<span data-ttu-id="3cc45-182">[![нажатии кнопки "Изменить" отображается интерфейс редактирования](customizing-the-datalist-s-editing-interface-vb/_static/image26.png)](customizing-the-datalist-s-editing-interface-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="3cc45-182">[![Clicking the Edit Button Displays the Editing Interface](customizing-the-datalist-s-editing-interface-vb/_static/image26.png)](customizing-the-datalist-s-editing-interface-vb/_static/image25.png)</span></span>

<span data-ttu-id="3cc45-183">**Рис. 9**. при нажатии кнопки "Изменить" отображается интерфейс редактирования ([щелкните, чтобы просмотреть изображение с полным размером](customizing-the-datalist-s-editing-interface-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="3cc45-183">**Figure 9**: Clicking the Edit Button Displays the Editing Interface ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image27.png))</span></span>

## <a name="step-5-saving-the-user-s-changes-in-the-updatecommand-event-handler"></a><span data-ttu-id="3cc45-184">Шаг 5. Сохранение изменений пользователя в обработчике событий UpdateCommand</span><span class="sxs-lookup"><span data-stu-id="3cc45-184">Step 5: Saving the User s Changes in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="3cc45-185">Когда пользователь редактирует продукт и нажимает кнопку "Обновить", происходит обратная передача и вызывается событие DataList `UpdateCommand`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-185">When the user edits a product and clicks the Update button, a postback occurs and the DataList s `UpdateCommand` event fires.</span></span> <span data-ttu-id="3cc45-186">В обработчике событий необходимо считывать значения из веб-элементов управления в `EditItemTemplate` и взаимодействовать с BLL для обновления продукта в базе данных.</span><span class="sxs-lookup"><span data-stu-id="3cc45-186">In the event handler, we need to read the values from the Web controls in the `EditItemTemplate` and interface with the BLL to update the product in the database.</span></span> <span data-ttu-id="3cc45-187">Как мы видели в предыдущих учебных курсах, `ProductID` обновленного продукта можно получить с помощью коллекции `DataKeys`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-187">As we ve seen in previous tutorials, the `ProductID` of the updated product is accessible through the `DataKeys` collection.</span></span> <span data-ttu-id="3cc45-188">Доступ к пользовательским полям осуществляется путем программной ссылки на веб-элементы управления с помощью `FindControl("controlID")`, как показано в следующем коде:</span><span class="sxs-lookup"><span data-stu-id="3cc45-188">The user-entered fields are accessed by programmatically referencing the Web controls using `FindControl("controlID")`, as the following code shows:</span></span>

[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample4.vb)]

<span data-ttu-id="3cc45-189">Код начинает с помощью свойства `Page.IsValid`, чтобы убедиться, что все элементы управления проверки на странице являются допустимыми.</span><span class="sxs-lookup"><span data-stu-id="3cc45-189">The code starts out by consulting the `Page.IsValid` property to ensure that all the validation controls on the page are valid.</span></span> <span data-ttu-id="3cc45-190">Если `Page.IsValid` `True`, то измененное значение `ProductID`ного продукта считывается из коллекции `DataKeys` и веб-элементы управления вводом данных в `EditItemTemplate` программными ссылками.</span><span class="sxs-lookup"><span data-stu-id="3cc45-190">If `Page.IsValid` is `True`, the edited product s `ProductID` value is read from the `DataKeys` collection and the data entry Web controls in the `EditItemTemplate` are programmatically referenced.</span></span> <span data-ttu-id="3cc45-191">Затем значения из этих веб-элементов управления считываются в переменные, которые затем передаются в соответствующую перегрузку `UpdateProduct`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-191">Next, the values from these Web controls are read into variables that are then passed into the appropriate `UpdateProduct` overload.</span></span> <span data-ttu-id="3cc45-192">После обновления данных элемент управления DataList возвращается в состояние предварительного редактирования.</span><span class="sxs-lookup"><span data-stu-id="3cc45-192">After updating the data, the DataList is returned to its pre-editing state.</span></span>

> [!NOTE]
> <span data-ttu-id="3cc45-193">Я не пропустил логику обработки исключений, добавленную в учебнике [обработка исключений BLL и DAL](handling-bll-and-dal-level-exceptions-vb.md) , чтобы сохранить код и этот пример.</span><span class="sxs-lookup"><span data-stu-id="3cc45-193">I ve omitted the exception handling logic added in the [Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md) tutorial in order to keep the code and this example focused.</span></span> <span data-ttu-id="3cc45-194">В качестве упражнения добавьте эту функцию после завершения работы с этим руководством.</span><span class="sxs-lookup"><span data-stu-id="3cc45-194">As an exercise, add this functionality after completing this tutorial.</span></span>

## <a name="step-6-handling-null-categoryid-and-supplierid-values"></a><span data-ttu-id="3cc45-195">Шаг 6. Обработка значений ненулевого CategoryID и КодПоставщика</span><span class="sxs-lookup"><span data-stu-id="3cc45-195">Step 6: Handling NULL CategoryID and SupplierID Values</span></span>

<span data-ttu-id="3cc45-196">База данных Northwind позволяет `NULL` значения для `Products` таблицы s `CategoryID` и `SupplierID` столбцы.</span><span class="sxs-lookup"><span data-stu-id="3cc45-196">The Northwind database allows for `NULL` values for the `Products` table s `CategoryID` and `SupplierID` columns.</span></span> <span data-ttu-id="3cc45-197">Однако наш интерфейс правки в настоящее время не поддерживает `NULL` значений.</span><span class="sxs-lookup"><span data-stu-id="3cc45-197">However, our editing interface doesn t currently accommodate `NULL` values.</span></span> <span data-ttu-id="3cc45-198">При попытке изменить продукт, имеющий `NULL` значение для столбцов `CategoryID` или `SupplierID`, мы получаем `ArgumentOutOfRangeException` с сообщением об ошибке следующего вида: *"Categories" имеет SelectedValue, который является недопустимым, так как он не существует в списке элементов.*</span><span class="sxs-lookup"><span data-stu-id="3cc45-198">If we attempt to edit a product that has a `NULL` value for either its `CategoryID` or `SupplierID` columns, we'll get an `ArgumentOutOfRangeException` with an error message similar to: *'Categories' has a SelectedValue which is invalid because it does not exist in the list of items.*</span></span> <span data-ttu-id="3cc45-199">Кроме того, в настоящее время нет возможности изменить категорию продукта или значение поставщика с не`NULL`ного значения на `NULL` одно.</span><span class="sxs-lookup"><span data-stu-id="3cc45-199">Also, there s currently no way to change a product s category or supplier value from a non-`NULL` value to a `NULL` one.</span></span>

<span data-ttu-id="3cc45-200">Для поддержки `NULL` значений категории и поставщика элементов управления DropDownList необходимо добавить дополнительный `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-200">To support `NULL` values for the category and supplier DropDownLists, we need to add an additional `ListItem`.</span></span> <span data-ttu-id="3cc45-201">Я решил использовать (None) в качестве значения `Text` для этого `ListItem`, но вы можете изменить его на другое (например, пустую строку), если вы d.</span><span class="sxs-lookup"><span data-stu-id="3cc45-201">I ve chosen to use (None) as the `Text` value for this `ListItem`, but you can change it to something else (such as an empty string) if you d like.</span></span> <span data-ttu-id="3cc45-202">Наконец, не забудьте установить `AppendDataBoundItems` элементов управления DropDownList в `True`; Если вы забыли это сделать, категории и поставщики, привязанные к DropDownList, будут перезаписывать статически добавленные `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-202">Finally, remember to set the DropDownLists `AppendDataBoundItems` to `True`; if you forget to do so, the categories and suppliers bound to the DropDownList will overwrite the statically-added `ListItem`.</span></span>

<span data-ttu-id="3cc45-203">После внесения этих изменений разметка элементов управления DropDownList в DataList s `EditItemTemplate` должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="3cc45-203">After making these changes, the DropDownLists markup in the DataList s `EditItemTemplate` should look similar to the following:</span></span>

[!code-aspx[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample5.aspx)]

> [!NOTE]
> <span data-ttu-id="3cc45-204">Статические `ListItem` s можно добавить в элемент DropDownList через конструктор или напрямую с помощью декларативного синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="3cc45-204">Static `ListItem` s can be added to a DropDownList through the Designer or directly through the declarative syntax.</span></span> <span data-ttu-id="3cc45-205">При добавлении элемента DropDownList для представления `NULL` значения базы данных не забудьте добавить `ListItem` с помощью декларативного синтаксиса.</span><span class="sxs-lookup"><span data-stu-id="3cc45-205">When adding a DropDownList item to represent a database `NULL` value, be sure to add the `ListItem` through the declarative syntax.</span></span> <span data-ttu-id="3cc45-206">При использовании редактора коллекции `ListItem` в конструкторе созданный декларативный синтаксис будет полностью опускать параметр `Value` при присвоении пустой строки, создавая декларативную разметку, например: `<asp:ListItem>(None)</asp:ListItem>`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-206">If you use the `ListItem` Collection Editor in the Designer, the generated declarative syntax will omit the `Value` setting altogether when assigned a blank string, creating declarative markup like: `<asp:ListItem>(None)</asp:ListItem>`.</span></span> <span data-ttu-id="3cc45-207">Хотя это может показаться безобидным, отсутствующий `Value` заставляет DropDownList использовать значение свойства `Text`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-207">While this may look harmless, the missing `Value` causes the DropDownList to use the `Text` property value in its place.</span></span> <span data-ttu-id="3cc45-208">Это означает, что если выбран этот `NULL` `ListItem`, то будет предпринята попытка назначения значения (None) полю данных продукта (`CategoryID` или `SupplierID`в этом руководстве), что приведет к возникновению исключения.</span><span class="sxs-lookup"><span data-stu-id="3cc45-208">That means that if this `NULL` `ListItem` is selected, the value (None) will be attempted to be assigned to the product data field (`CategoryID` or `SupplierID`, in this tutorial), which will result in an exception.</span></span> <span data-ttu-id="3cc45-209">При явном задании `Value=""`для поля данных продукта будет присвоено значение `NULL` при выборе `NULL` `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-209">By explicitly setting `Value=""`, a `NULL` value will be assigned to the product data field when the `NULL` `ListItem` is selected.</span></span>

<span data-ttu-id="3cc45-210">Уделите время для просмотра хода выполнения в браузере.</span><span class="sxs-lookup"><span data-stu-id="3cc45-210">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="3cc45-211">При редактировании продукта Обратите внимание, что `Categories` и `Suppliers` элементов управления DropDownList имеют параметр (нет) в начале DropDownList.</span><span class="sxs-lookup"><span data-stu-id="3cc45-211">When editing a product, note that the `Categories` and `Suppliers` DropDownLists both have a (None) option at the start of the DropDownList.</span></span>

<span data-ttu-id="3cc45-212">[![категории и поставщики элементов управления DropDownList включить параметр (None)](customizing-the-datalist-s-editing-interface-vb/_static/image29.png)](customizing-the-datalist-s-editing-interface-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="3cc45-212">[![The Categories and Suppliers DropDownLists include a (None) Option](customizing-the-datalist-s-editing-interface-vb/_static/image29.png)](customizing-the-datalist-s-editing-interface-vb/_static/image28.png)</span></span>

<span data-ttu-id="3cc45-213">**Рис. 10**. `Categories` и `Suppliers` элементов управления DropDownList включают параметр (None) ([щелкните, чтобы просмотреть изображение с полным размером](customizing-the-datalist-s-editing-interface-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="3cc45-213">**Figure 10**: The `Categories` and `Suppliers` DropDownLists include a (None) Option ([Click to view full-size image](customizing-the-datalist-s-editing-interface-vb/_static/image30.png))</span></span>

<span data-ttu-id="3cc45-214">Чтобы сохранить параметр (None) в качестве значения `NULL` базы данных, необходимо вернуться к обработчику событий `UpdateCommand`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-214">To save the (None) option as a database `NULL` value, we need to return to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="3cc45-215">Измените `categoryIDValue` и `supplierIDValue` переменные так, чтобы они допускали значение NULL целыми числами, и назначьте им значения, отличные от `Nothing` только в том случае, если `SelectedValue` DropDownList не является пустой строкой:</span><span class="sxs-lookup"><span data-stu-id="3cc45-215">Change the `categoryIDValue` and `supplierIDValue` variables to be nullable integers and assign them a value other than `Nothing` only if the DropDownList s `SelectedValue` is not an empty string:</span></span>

[!code-vb[Main](customizing-the-datalist-s-editing-interface-vb/samples/sample6.vb)]

<span data-ttu-id="3cc45-216">После этого изменения значение `Nothing` будет передано в метод `UpdateProduct` BLL, если пользователь выбрал параметр (нет) в любом из раскрывающихся списков, который соответствует значению `NULL` базы данных.</span><span class="sxs-lookup"><span data-stu-id="3cc45-216">With this change, a value of `Nothing` will be passed into the `UpdateProduct` BLL method if the user selected the (None) option from either of the drop-down lists, which corresponds to a `NULL` database value.</span></span>

## <a name="summary"></a><span data-ttu-id="3cc45-217">Сводка</span><span class="sxs-lookup"><span data-stu-id="3cc45-217">Summary</span></span>

<span data-ttu-id="3cc45-218">В этом учебнике мы увидели, как создать более сложный интерфейс редактирования DataList, включающий в себя три различных входных веб-элемента управления TextBox, два элементов управления DropDownList и флажок вместе с элементами управления проверки.</span><span class="sxs-lookup"><span data-stu-id="3cc45-218">In this tutorial we saw how to create a more complex DataList editing interface that included three different input Web controls a TextBox, two DropDownLists, and a CheckBox along with validation controls.</span></span> <span data-ttu-id="3cc45-219">При создании интерфейса редактирования шаги одинаковы, независимо от используемых веб-элементов управления: Начните с добавления веб-элементов управления в DataList s `EditItemTemplate`; Используйте синтаксис DataBinding, чтобы присвоить соответствующие значения полей данных соответствующим свойствам веб-элемента управления. и в обработчике событий `UpdateCommand` программным способом получить доступ к веб-элементам управления и их соответствующим свойствам, передав их значения в BLL.</span><span class="sxs-lookup"><span data-stu-id="3cc45-219">When building the editing interface, the steps are the same regardless of the Web controls being used: start by adding the Web controls to the DataList s `EditItemTemplate`; use databinding syntax to assign the corresponding data field values with the appropriate Web control properties; and, in the `UpdateCommand` event handler, programmatically access the Web controls and their appropriate properties, passing their values into the BLL.</span></span>

<span data-ttu-id="3cc45-220">При создании интерфейса редактирования, состоящего из текстовых полей или коллекции различных веб-элементов управления, обязательно правильно обрабатывать значения `NULL` базы данных.</span><span class="sxs-lookup"><span data-stu-id="3cc45-220">When creating an editing interface, whether it s composed of just TextBoxes or a collection of different Web controls, be sure to correctly handle database `NULL` values.</span></span> <span data-ttu-id="3cc45-221">При использовании учета для `NULL` необходимо не только правильно отобразить существующее значение `NULL` в интерфейсе редактирования, но и предоставить возможность пометить значение как `NULL`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-221">When accounting for `NULL` s, it is imperative that you not only correctly display an existing `NULL` value in the editing interface, but also that you offer a means for marking a value as `NULL`.</span></span> <span data-ttu-id="3cc45-222">Для элементов управления DropDownList в списках данных это обычно означает Добавление статического `ListItem`, для свойства `Value` которого явно задана пустая строка (`Value=""`), и Добавление фрагмента кода в обработчик событий `UpdateCommand`, чтобы определить, выбран ли `NULL``ListItem`.</span><span class="sxs-lookup"><span data-stu-id="3cc45-222">For DropDownLists in DataLists, that typically means adding a static `ListItem` whose `Value` property is explicitly set to an empty string (`Value=""`), and adding a bit of code to the `UpdateCommand` event handler to determine whether or not the `NULL``ListItem` was selected.</span></span>

<span data-ttu-id="3cc45-223">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="3cc45-223">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="3cc45-224">Об авторе</span><span class="sxs-lookup"><span data-stu-id="3cc45-224">About the Author</span></span>

<span data-ttu-id="3cc45-225">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="3cc45-225">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="3cc45-226">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="3cc45-226">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="3cc45-227">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="3cc45-227">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="3cc45-228">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3cc45-228">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="3cc45-229">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="3cc45-229">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="3cc45-230">Специальная благодарность</span><span class="sxs-lookup"><span data-stu-id="3cc45-230">Special Thanks To</span></span>

<span data-ttu-id="3cc45-231">Эта серия руководств была рассмотрена многими полезными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="3cc45-231">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="3cc45-232">Потенциальные рецензенты для этого учебника были Деннис Patterson, Дэвид суру и Рэнди Шмидт.</span><span class="sxs-lookup"><span data-stu-id="3cc45-232">Lead reviewers for this tutorial were Dennis Patterson, David Suru, and Randy Schmidt.</span></span> <span data-ttu-id="3cc45-233">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="3cc45-233">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="3cc45-234">Если это так, расположите строку в [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3cc45-234">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="3cc45-235">Назад</span><span class="sxs-lookup"><span data-stu-id="3cc45-235">Previous</span></span>](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)
