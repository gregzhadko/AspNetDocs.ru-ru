---
uid: web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
title: Кэширование данных с помощью ObjectDataSource (VB) | Документация Майкрософт
author: rick-anderson
description: Кэширование может означать разницу между медленное и быстрый веб-приложения. Это руководство представляет собой первое из четырех подробных взгляните на кэширование в ASP.NET...
ms.author: riande
ms.date: 05/30/2007
ms.assetid: 2e56a733-5512-48a6-9276-70a65bbe4d5d
msc.legacyurl: /web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 6bde070dae3b295c8d7a04098b874d41fab54830
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59380214"
---
# <a name="caching-data-with-the-objectdatasource-vb"></a><span data-ttu-id="41a1b-104">Кэширование данных с помощью ObjectDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="41a1b-104">Caching Data with the ObjectDataSource (VB)</span></span>

<span data-ttu-id="41a1b-105">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="41a1b-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="41a1b-106">[Скачайте пример приложения](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe) или [скачать PDF](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="41a1b-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe) or [Download PDF](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span></span>

> <span data-ttu-id="41a1b-107">Кэширование может означать разницу между медленное и быстрый веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="41a1b-107">Caching can mean the difference between a slow and a fast Web application.</span></span> <span data-ttu-id="41a1b-108">Это руководство представляет собой первый из четырех, рассмотрим подробные кэширования в ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="41a1b-108">This tutorial is the first of four that take a detailed look at caching in ASP.NET.</span></span> <span data-ttu-id="41a1b-109">Узнайте основные понятия кэширования и кэшировать на уровень представления данных через элемент управления ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="41a1b-109">Learn the key concepts of caching and how to apply caching to the Presentation Layer through the ObjectDataSource control.</span></span>


## <a name="introduction"></a><span data-ttu-id="41a1b-110">Вступление</span><span class="sxs-lookup"><span data-stu-id="41a1b-110">Introduction</span></span>

<span data-ttu-id="41a1b-111">В теории *кэширование* — это процесс получения данными или сведениями затратна для получения и хранения его копию в расположении, которое выполняется быстрее, чтобы получить доступ к.</span><span class="sxs-lookup"><span data-stu-id="41a1b-111">In computer science, *caching* is the process of taking data or information that is expensive to obtain and storing a copy of it in a location that is quicker to access.</span></span> <span data-ttu-id="41a1b-112">Для приложений, управляемых данными больших и сложных запросов часто потребляют большую часть времени выполнения приложения s.</span><span class="sxs-lookup"><span data-stu-id="41a1b-112">For data-driven applications, large and complex queries commonly consume the majority of the application s execution time.</span></span> <span data-ttu-id="41a1b-113">Такие s производительности приложения, затем, часто можно улучшить путем сохранения результатов запросов ресурсоемкие базы данных в память s приложения.</span><span class="sxs-lookup"><span data-stu-id="41a1b-113">Such an application s performance, then, can often be improved by storing the results of expensive database queries in the application s memory.</span></span>

<span data-ttu-id="41a1b-114">ASP.NET 2.0 предлагает широкий набор параметров кэширования.</span><span class="sxs-lookup"><span data-stu-id="41a1b-114">ASP.NET 2.0 offers a variety of caching options.</span></span> <span data-ttu-id="41a1b-115">Всего веб-страницу или пользовательский элемент управления отображался разметки могут кэшироваться через *кэширование вывода*.</span><span class="sxs-lookup"><span data-stu-id="41a1b-115">An entire web page or User Control s rendered markup can be cached through *output caching*.</span></span> <span data-ttu-id="41a1b-116">Эти элементы управления ObjectDataSource и SqlDataSource обеспечивают возможности кэширования также, тем самым позволяя данных должен быть помещен в кэш на уровне управления.</span><span class="sxs-lookup"><span data-stu-id="41a1b-116">The ObjectDataSource and SqlDataSource controls provide caching capabilities as well, thereby allowing data to be cached at the control level.</span></span> <span data-ttu-id="41a1b-117">И ASP.NET s *кэш данных* предоставляет богатый API кэширования, который позволяет разработчикам программным образом объектов кэша.</span><span class="sxs-lookup"><span data-stu-id="41a1b-117">And ASP.NET s *data cache* provides a rich caching API that enables page developers to programmatically cache objects.</span></span> <span data-ttu-id="41a1b-118">В этом руководстве и следующие три, который будет рассматриваться использование ObjectDataSource s кэширование функций, а также кэш данных.</span><span class="sxs-lookup"><span data-stu-id="41a1b-118">In this tutorial and the next three we'll examine using the ObjectDataSource s caching features as well as the data cache.</span></span> <span data-ttu-id="41a1b-119">Также будут рассмотрены способы кэшировать данные уровня приложения во время запуска и постоянно кэшированные данные при помощи зависимости кэша SQL.</span><span class="sxs-lookup"><span data-stu-id="41a1b-119">We'll also explore how to cache application-wide data at startup and how to keep cached data fresh through the use of SQL cache dependencies.</span></span> <span data-ttu-id="41a1b-120">В этих руководствах, не рассматриваются кэширования выходных данных.</span><span class="sxs-lookup"><span data-stu-id="41a1b-120">These tutorials do not explore output caching.</span></span> <span data-ttu-id="41a1b-121">Подробный обзор кэширования выходных данных, см. в разделе [кэширования выводимых данных в ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="41a1b-121">For a detailed look at output caching, see [Output Caching in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span></span>

<span data-ttu-id="41a1b-122">Кэширование могут применяться в любом месте в архитектуре, от уровня доступа к данным вверх через уровень представления данных.</span><span class="sxs-lookup"><span data-stu-id="41a1b-122">Caching can be applied at any place in the architecture, from the Data Access Layer up through the Presentation Layer.</span></span> <span data-ttu-id="41a1b-123">В этом руководстве мы рассмотрим применение кэширования на уровень представления данных через элемент управления ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="41a1b-123">In this tutorial we'll look at applying caching to the Presentation Layer through the ObjectDataSource control.</span></span> <span data-ttu-id="41a1b-124">В следующем учебном курсе, который будет рассмотрен кэширования данных на уровне бизнес-логики.</span><span class="sxs-lookup"><span data-stu-id="41a1b-124">In the next tutorial we'll examine caching data at the Business Logic Layer.</span></span>

## <a name="key-caching-concepts"></a><span data-ttu-id="41a1b-125">Ключ, кэшировании</span><span class="sxs-lookup"><span data-stu-id="41a1b-125">Key Caching Concepts</span></span>

<span data-ttu-id="41a1b-126">Может значительно повысить производительность приложения s общую производительность и масштабируемость данных затратна для создания и хранения его копию в расположении, которое может осуществляться более эффективно.</span><span class="sxs-lookup"><span data-stu-id="41a1b-126">Caching can greatly improve an application s overall performance and scalability by taking data that is expensive to generate and storing a copy of it in a location that can be more efficiently accessed.</span></span> <span data-ttu-id="41a1b-127">Так как кэш содержит только копию фактического, базовые данные, он может стать устаревшей, или *устаревших*, при изменении базовых данных.</span><span class="sxs-lookup"><span data-stu-id="41a1b-127">Since the cache holds just a copy of the actual, underlying data, it can become outdated, or *stale*, if the underlying data changes.</span></span> <span data-ttu-id="41a1b-128">Для решения этой проблемы, разработчик страницы можно указать критерии, по которым элемент кэша будет *вытеснения* из кэша, используя:</span><span class="sxs-lookup"><span data-stu-id="41a1b-128">To combat this, a page developer can indicate criteria by which the cache item will be *evicted* from the cache, using either:</span></span>

- <span data-ttu-id="41a1b-129">**Критериев на основе времени** элемента могут добавляться в кэш для абсолютный или скользящий длительность.</span><span class="sxs-lookup"><span data-stu-id="41a1b-129">**Time-based criteria** an item may be added to the cache for an absolute or sliding duration.</span></span> <span data-ttu-id="41a1b-130">Например разработчик может указывать длительность, скажем, 60 секунд.</span><span class="sxs-lookup"><span data-stu-id="41a1b-130">For example, a page developer may indicate a duration of, say, 60 seconds.</span></span> <span data-ttu-id="41a1b-131">С абсолютным длительности кэшируемый элемент удаляется 60 секунд, после добавления к кэшу, независимо от частоты обращения к нему.</span><span class="sxs-lookup"><span data-stu-id="41a1b-131">With an absolute duration, the cached item is evicted 60 seconds after it was added to cache, regardless of how frequently it was accessed.</span></span> <span data-ttu-id="41a1b-132">Скользящее длительностью кэшированный элемент удаляется 60 секунд после последнего доступа.</span><span class="sxs-lookup"><span data-stu-id="41a1b-132">With a sliding duration, the cached item is evicted 60 seconds after the last access.</span></span>
- <span data-ttu-id="41a1b-133">**Критериев на основе зависимостей** зависимость может быть связан с элементом при добавлении в кэш.</span><span class="sxs-lookup"><span data-stu-id="41a1b-133">**Dependency-based criteria** a dependency can be associated with an item when added to the cache.</span></span> <span data-ttu-id="41a1b-134">При изменении зависимость элемент s он удаляется из кэша.</span><span class="sxs-lookup"><span data-stu-id="41a1b-134">When the item s dependency changes it is evicted from the cache.</span></span> <span data-ttu-id="41a1b-135">Зависимость может быть файл, другого элемента кэша или сочетание двух.</span><span class="sxs-lookup"><span data-stu-id="41a1b-135">The dependency may be a file, another cache item, or a combination of the two.</span></span> <span data-ttu-id="41a1b-136">ASP.NET 2.0 также поддерживает зависимости кэша SQL, которые разработчики могут добавить элемент в кэш, который будет удален при изменении основной базы данных.</span><span class="sxs-lookup"><span data-stu-id="41a1b-136">ASP.NET 2.0 also allows SQL cache dependencies, which enable developers to add an item to the cache and have it evicted when the underlying database data changes.</span></span> <span data-ttu-id="41a1b-137">Мы рассмотрим зависимостей кэша SQL готовится к выпуску [использование зависимостей кэша SQL](using-sql-cache-dependencies-vb.md) руководства.</span><span class="sxs-lookup"><span data-stu-id="41a1b-137">We will examine SQL cache dependencies in the upcoming [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="41a1b-138">Независимо от того, вытеснения критерию, возможно, элемент в кэше *очистки для* перед выполнены условия по времени или на основе зависимостей.</span><span class="sxs-lookup"><span data-stu-id="41a1b-138">Regardless of the eviction criteria specified, an item in the cache may be *scavenged* before the time-based or dependency-based criteria has been met.</span></span> <span data-ttu-id="41a1b-139">Если кэш достиг емкости, существующие элементы необходимо удалить перед добавлением новых.</span><span class="sxs-lookup"><span data-stu-id="41a1b-139">If the cache has reached its capacity, existing items must be removed before new ones can be added.</span></span> <span data-ttu-id="41a1b-140">Следовательно при программным способом с помощью кэшированных данных s жизненно важных, что вы всегда предполагается, что кэшированные данные могут отсутствовать.</span><span class="sxs-lookup"><span data-stu-id="41a1b-140">Consequently, when programmatically working with cached data it s vital that you always assume that the cached data may not be present.</span></span> <span data-ttu-id="41a1b-141">Мы рассмотрим шаблон, используемый при доступе к данным из кэша программным способом в нашем следующем учебном курсе *кэширование данных в архитектуре*.</span><span class="sxs-lookup"><span data-stu-id="41a1b-141">We'll look at the pattern to use when accessing data from the cache programmatically in our next tutorial, *Caching Data in the Architecture*.</span></span>

<span data-ttu-id="41a1b-142">Кэширование предоставляет экономичные средства для сжатие большей производительности из приложения.</span><span class="sxs-lookup"><span data-stu-id="41a1b-142">Caching provides an economical means for squeezing more performance from an application.</span></span> <span data-ttu-id="41a1b-143">Как [Смит Стивен](http://aspadvice.com/blogs/ssmith/) четкие в своей статье [кэширования ASP.NET: Техник и передовых методик](https://msdn.microsoft.com/library/aa478965.aspx):</span><span class="sxs-lookup"><span data-stu-id="41a1b-143">As [Steven Smith](http://aspadvice.com/blogs/ssmith/) articulates in his article [ASP.NET Caching: Techniques and Best Practices](https://msdn.microsoft.com/library/aa478965.aspx):</span></span>

<span data-ttu-id="41a1b-144">Кэширование может быть хорошим способом для получения хорошей достаточную производительность без большой объем времени и анализа.</span><span class="sxs-lookup"><span data-stu-id="41a1b-144">Caching can be a good way to get good enough performance without requiring a lot of time and analysis.</span></span> <span data-ttu-id="41a1b-145">Не требует больших затрат памяти, так что если вы можете получить производительности, путем кэширования выходных данных для 30 секунд, вместо того чтобы тратить в день или неделю, оптимизации кода или базы данных, постарайтесь решения кэширования (при условии, что 30 - старых секунду данных — ОК) и перейти.</span><span class="sxs-lookup"><span data-stu-id="41a1b-145">Memory is cheap, so if you can get the performance you need by caching the output for 30 seconds instead of spending a day or a week trying to optimize your code or database, do the caching solution (assuming 30-second old data is ok) and move on.</span></span> <span data-ttu-id="41a1b-146">В конечном счете, плохое проектирование будет, вероятно, догонит, поэтому курса следует правильно проектировать свои приложения.</span><span class="sxs-lookup"><span data-stu-id="41a1b-146">Eventually, poor design will probably catch up to you, so of course you should try to design your applications correctly.</span></span> <span data-ttu-id="41a1b-147">Но если необходимо получить хороший достаточную производительность сегодня, кэширование может быть отличным [подход] приобретение время рефакторинг приложения на более позднюю дату, когда у вас есть время, чтобы сделать это.</span><span class="sxs-lookup"><span data-stu-id="41a1b-147">But if you just need to get good enough performance today, caching can be an excellent [approach], buying you time to refactor your application at a later date when you have the time to do so.</span></span>

<span data-ttu-id="41a1b-148">Хотя кэширования могут обеспечить достаточное усовершенствований, он не применим во всех ситуациях, например с приложениями, которые используют данные в режиме реального времени, часто обновляет или которых недопустима даже вскоре жили устаревшие данные.</span><span class="sxs-lookup"><span data-stu-id="41a1b-148">While caching can provide appreciable performance enhancements, it is not applicable in all situations, such as with applications that use real-time, frequently-updating data, or where even shortly-lived stale data is unacceptable.</span></span> <span data-ttu-id="41a1b-149">Но для большинства приложений, следует использовать кэширование.</span><span class="sxs-lookup"><span data-stu-id="41a1b-149">But for the majority of applications, caching should be used.</span></span> <span data-ttu-id="41a1b-150">Дополнительные сведения о кэшировании в ASP.NET 2.0, см. в разделе [кэширования для повышения производительности](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) раздел [ASP.NET 2.0 краткие руководства](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span><span class="sxs-lookup"><span data-stu-id="41a1b-150">For more background on caching in ASP.NET 2.0, refer to the [Caching for Performance](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) section of the [ASP.NET 2.0 QuickStart Tutorials](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span></span>

## <a name="step-1-creating-the-caching-web-pages"></a><span data-ttu-id="41a1b-151">Шаг 1. Создание кэширования веб-страниц</span><span class="sxs-lookup"><span data-stu-id="41a1b-151">Step 1: Creating the Caching Web Pages</span></span>

<span data-ttu-id="41a1b-152">Прежде чем приступать к исследование функций кэширования s ObjectDataSource, позвольте s уделим несколько минут созданию страниц ASP.NET в нашем проекте веб-сайта, что нам понадобится для изучения этого учебника и следующие три.</span><span class="sxs-lookup"><span data-stu-id="41a1b-152">Before we start our exploration of the ObjectDataSource s caching features, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="41a1b-153">Начните с добавления новой папки с именем `Caching`.</span><span class="sxs-lookup"><span data-stu-id="41a1b-153">Start by adding a new folder named `Caching`.</span></span> <span data-ttu-id="41a1b-154">Добавьте следующие страницы ASP.NET в этой папке, не забывая связывать каждую с `Site.master` главной страницы:</span><span class="sxs-lookup"><span data-stu-id="41a1b-154">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `ObjectDataSource.aspx`
- `FromTheArchitecture.aspx`
- `AtApplicationStartup.aspx`
- `SqlCacheDependencies.aspx`


![Добавление страниц ASP.NET для кэширования руководств](caching-data-with-the-objectdatasource-vb/_static/image1.png)

<span data-ttu-id="41a1b-156">**Рис. 1**: Добавление страниц ASP.NET для кэширования руководств</span><span class="sxs-lookup"><span data-stu-id="41a1b-156">**Figure 1**: Add the ASP.NET Pages for the Caching-Related Tutorials</span></span>


<span data-ttu-id="41a1b-157">Как и в других папках, `Default.aspx` в `Caching` папку перечислит учебные курсы в своем разделе.</span><span class="sxs-lookup"><span data-stu-id="41a1b-157">Like in the other folders, `Default.aspx` in the `Caching` folder will list the tutorials in its section.</span></span> <span data-ttu-id="41a1b-158">Помните, что `SectionLevelTutorialListing.ascx` пользовательский элемент управления предоставляет следующие функциональные возможности.</span><span class="sxs-lookup"><span data-stu-id="41a1b-158">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="41a1b-159">Поэтому добавьте данный пользовательский элемент управления для `Default.aspx` , перетащив его из обозревателя решений на странице s режиме конструктора.</span><span class="sxs-lookup"><span data-stu-id="41a1b-159">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="41a1b-160">[![Рис. 2. Добавление элемента управления Sectionleveltutoriallisting.ascx к странице Default.aspx](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="41a1b-160">[![Figure 2: Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span></span>

<span data-ttu-id="41a1b-161">**Рис. 2**: Рис. 2. Добавить `SectionLevelTutorialListing.ascx` для пользовательского элемента управления `Default.aspx` ([Просмотр полноразмерного изображения](caching-data-with-the-objectdatasource-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="41a1b-161">**Figure 2**: Figure 2: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image4.png))</span></span>


<span data-ttu-id="41a1b-162">Наконец, добавьте эти страницы как записи для `Web.sitemap` файла.</span><span class="sxs-lookup"><span data-stu-id="41a1b-162">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="41a1b-163">В частности, добавьте следующую разметку после работы с двоичными данными `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="41a1b-163">Specifically, add the following markup after the Working with Binary Data `<siteMapNode>`:</span></span>


[!code-xml[Main](caching-data-with-the-objectdatasource-vb/samples/sample1.xml)]

<span data-ttu-id="41a1b-164">После обновления `Web.sitemap`, Отвлекитесь и просмотрите учебный веб-узел в обозревателе.</span><span class="sxs-lookup"><span data-stu-id="41a1b-164">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="41a1b-165">В меню слева теперь есть элементы для кэширования учебники.</span><span class="sxs-lookup"><span data-stu-id="41a1b-165">The menu on the left now includes items for the caching tutorials.</span></span>


![Карта узла теперь включают записи для кэширования учебники](caching-data-with-the-objectdatasource-vb/_static/image5.png)

<span data-ttu-id="41a1b-167">**Рис. 3**: Карта узла теперь включают записи для кэширования учебники</span><span class="sxs-lookup"><span data-stu-id="41a1b-167">**Figure 3**: The Site Map Now Includes Entries for the Caching Tutorials</span></span>


## <a name="step-2-displaying-a-list-of-products-in-a-web-page"></a><span data-ttu-id="41a1b-168">Шаг 2. Отображение списка продуктов на веб-странице</span><span class="sxs-lookup"><span data-stu-id="41a1b-168">Step 2: Displaying a List of Products in a Web Page</span></span>

<span data-ttu-id="41a1b-169">В этом руководстве рассматриваются способы использования ObjectDataSource управления s встроенных функций кэширования.</span><span class="sxs-lookup"><span data-stu-id="41a1b-169">This tutorial explores how to use the ObjectDataSource control s built-in caching features.</span></span> <span data-ttu-id="41a1b-170">Перед рассмотрением эти функции, необходимо сначала страницы для работы с.</span><span class="sxs-lookup"><span data-stu-id="41a1b-170">Before we can look at these features, though, we first need a page to work from.</span></span> <span data-ttu-id="41a1b-171">S позволяют создавать веб-страницы, который использует элемент управления GridView для сведений о продукте получить при помощи элемента ObjectDataSource из `ProductsBLL` класса.</span><span class="sxs-lookup"><span data-stu-id="41a1b-171">Let s create a web page that uses a GridView to list product information retrieved by an ObjectDataSource from the `ProductsBLL` class.</span></span>

<span data-ttu-id="41a1b-172">Сначала откройте `ObjectDataSource.aspx` странице в `Caching` папку.</span><span class="sxs-lookup"><span data-stu-id="41a1b-172">Start by opening the `ObjectDataSource.aspx` page in the `Caching` folder.</span></span> <span data-ttu-id="41a1b-173">Перетащите элемент управления GridView с панели инструментов в конструктор, задайте его `ID` свойства `Products`и в его смарт-тега выберите, чтобы привязать его к новый элемент управления ObjectDataSource с именем `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="41a1b-173">Drag a GridView from the Toolbox onto the Designer, set its `ID` property to `Products`, and, from its smart tag, choose to bind it to a new ObjectDataSource control named `ProductsDataSource`.</span></span> <span data-ttu-id="41a1b-174">Настройте элемент ObjectDataSource для работы с `ProductsBLL` класса.</span><span class="sxs-lookup"><span data-stu-id="41a1b-174">Configure the ObjectDataSource to work with the `ProductsBLL` class.</span></span>


<span data-ttu-id="41a1b-175">[![Настройка ObjectDataSource на использование класса ProductsBLL](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="41a1b-175">[![Configure the ObjectDataSource to Use the ProductsBLL Class](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span></span>

<span data-ttu-id="41a1b-176">**Рис. 4**: Настройка ObjectDataSource для использования `ProductsBLL` класс ([Просмотр полноразмерного изображения](caching-data-with-the-objectdatasource-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="41a1b-176">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image8.png))</span></span>


<span data-ttu-id="41a1b-177">Для этой страницы позволяют создать изменяемого элемента управления GridView, чтобы мы рассмотрим, что происходит при изменении данных, кэшированных в коллекции через интерфейс s GridView s.</span><span class="sxs-lookup"><span data-stu-id="41a1b-177">For this page, let s create an editable GridView so that we can examine what happens when data cached in the ObjectDataSource is modified through the GridView s interface.</span></span> <span data-ttu-id="41a1b-178">Оставьте стрелку раскрывающегося списка на вкладке ВЫБЕРИТЕ значение по умолчанию `GetProducts()`, но изменения выбранного элемента на вкладке "обновления" для `UpdateProduct` перегрузку, которая принимает `productName`, `unitPrice`, и `productID` как его входные параметры.</span><span class="sxs-lookup"><span data-stu-id="41a1b-178">Leave the drop-down list in the SELECT tab set to its default, `GetProducts()`, but change the selected item in the UPDATE tab to the `UpdateProduct` overload that accepts `productName`, `unitPrice`, and `productID` as its input parameters.</span></span>


<span data-ttu-id="41a1b-179">[![Установить обновления вкладку s раскрывающегося списка список по перегрузке UpdateProduct соответствующие](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="41a1b-179">[![Set the UPDATE Tab s Drop-Down List to the Appropriate UpdateProduct Overload](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span></span>

<span data-ttu-id="41a1b-180">**Рис. 5**: Значение s вкладку обновление с раскрывающимся списком приемлемым `UpdateProduct` перегрузки ([Просмотр полноразмерного изображения](caching-data-with-the-objectdatasource-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="41a1b-180">**Figure 5**: Set the UPDATE Tab s Drop-Down List to the Appropriate `UpdateProduct` Overload ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image11.png))</span></span>


<span data-ttu-id="41a1b-181">Наконец раскрывающиеся списки на вкладках INSERT и DELETE (нет) и нажмите кнопку Готово.</span><span class="sxs-lookup"><span data-stu-id="41a1b-181">Finally, set the drop-down lists in the INSERT and DELETE tabs to (None) and click Finish.</span></span> <span data-ttu-id="41a1b-182">После завершения работы мастера настройки источника данных, Visual Studio задает ObjectDataSource s `OldValuesParameterFormatString` свойства `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="41a1b-182">Upon completing the Configure Data Source wizard, Visual Studio sets the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="41a1b-183">Как уже говорилось в [Обзор Вставка, обновление и удаление данных](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) руководстве, это свойство должно быть удалены из декларативного синтаксиса или установить обратно к значению по умолчанию `{0}`, в порядке для рабочего процесса обновления для Продолжить без ошибок.</span><span class="sxs-lookup"><span data-stu-id="41a1b-183">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, this property needs to be removed from the declarative syntax or set back to its default value, `{0}`, in order for our update workflow to proceed without error.</span></span>

<span data-ttu-id="41a1b-184">Кроме того по завершении работы мастера Visual Studio добавляет поле к GridView для каждого из полей данных продукта.</span><span class="sxs-lookup"><span data-stu-id="41a1b-184">Furthermore, at the completion of the wizard Visual Studio adds a field to the GridView for each of the product data fields.</span></span> <span data-ttu-id="41a1b-185">Удалите все, кроме `ProductName`, `CategoryName`, и `UnitPrice` полей BoundField.</span><span class="sxs-lookup"><span data-stu-id="41a1b-185">Remove all but the `ProductName`, `CategoryName`, and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="41a1b-186">Затем обновите `HeaderText` свойства каждой из этих полей BoundField продукта, категория и цена, соответственно.</span><span class="sxs-lookup"><span data-stu-id="41a1b-186">Next, update the `HeaderText` properties of each of these BoundFields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="41a1b-187">Так как `ProductName` поле является обязательным, преобразовать поле типа BoundField в поле TemplateField и добавьте RequiredFieldValidator к `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="41a1b-187">Since the `ProductName` field is required, convert the BoundField into a TemplateField and add a RequiredFieldValidator to the `EditItemTemplate`.</span></span> <span data-ttu-id="41a1b-188">Аналогичным образом, преобразовать `UnitPrice` BoundField в поле TemplateField и добавьте элемент управления CompareValidator чтобы убедиться, что введенное пользователем значение является допустимым валюты значение s больше или равно нулю.</span><span class="sxs-lookup"><span data-stu-id="41a1b-188">Similarly, convert the `UnitPrice` BoundField into a TemplateField and add a CompareValidator to ensure that the value entered by the user is a valid currency value that s greater than or equal to zero.</span></span> <span data-ttu-id="41a1b-189">Помимо этих изменений, вы можете выполнять любые изменения внешнего вида, например с правым `UnitPrice` значение, или указать форматирование для `UnitPrice` текста в его интерфейсы только для чтения и редактирования.</span><span class="sxs-lookup"><span data-stu-id="41a1b-189">In addition to these modifications, feel free to perform any aesthetic changes, such as right-aligning the `UnitPrice` value, or specifying the formatting for the `UnitPrice` text in its read-only and editing interfaces.</span></span>

<span data-ttu-id="41a1b-190">Разрешить изменение GridView, установив флажок Enable Editing в смарт-теге GridView s.</span><span class="sxs-lookup"><span data-stu-id="41a1b-190">Make the GridView editable by checking the Enable Editing checkbox in the GridView s smart tag.</span></span> <span data-ttu-id="41a1b-191">Также установите флажки включить разбиение по страницам и включить сортировку.</span><span class="sxs-lookup"><span data-stu-id="41a1b-191">Also check the Enable Paging and Enable Sorting checkboxes.</span></span>

> [!NOTE]
> <span data-ttu-id="41a1b-192">Требуется проверка того, как настройка интерфейса правки s GridView?</span><span class="sxs-lookup"><span data-stu-id="41a1b-192">Need a review of how to customize the GridView s editing interface?</span></span> <span data-ttu-id="41a1b-193">Если Да, обращаться к [Настройка интерфейса изменения данных](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) руководства.</span><span class="sxs-lookup"><span data-stu-id="41a1b-193">If so, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span>


<span data-ttu-id="41a1b-194">[![Включите поддержку GridView для редактирования, сортировку и разбиение по страницам](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="41a1b-194">[![Enable GridView Support for Editing, Sorting, and Paging](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span></span>

<span data-ttu-id="41a1b-195">**Рис. 6**: Включить поддержку GridView для редактирования, сортировку и разбиение по страницам ([Просмотр полноразмерного изображения](caching-data-with-the-objectdatasource-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="41a1b-195">**Figure 6**: Enable GridView Support for Editing, Sorting, and Paging ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image14.png))</span></span>


<span data-ttu-id="41a1b-196">После внесения этих изменений GridView, GridView и ObjectDataSource s декларативная разметка должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="41a1b-196">After making these GridView modifications, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](caching-data-with-the-objectdatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="41a1b-197">Как показано на рис. 7, изменяемого элемента управления GridView содержит имя, категорию и цену каждого из продуктов в базе данных.</span><span class="sxs-lookup"><span data-stu-id="41a1b-197">As Figure 7 shows, the editable GridView lists the name, category, and price of each of the products in the database.</span></span> <span data-ttu-id="41a1b-198">Отвлекитесь и протестировать функции сортировки страницы s результаты, страницы по ним и изменить запись.</span><span class="sxs-lookup"><span data-stu-id="41a1b-198">Take a moment to test out the page s functionality sort the results, page through them, and edit a record.</span></span>


<span data-ttu-id="41a1b-199">[![Каждого продукта — имя, категория и цена указана в сортируемый, Pageable, изменяемого элемента управления GridView](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="41a1b-199">[![Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span></span>

<span data-ttu-id="41a1b-200">**Рис. 7**: Каждого продукта — имя, категория и цена указана в сортируемый, Pageable, изменяемого элемента управления GridView ([Просмотр полноразмерного изображения](caching-data-with-the-objectdatasource-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="41a1b-200">**Figure 7**: Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image17.png))</span></span>


## <a name="step-3-examining-when-the-objectdatasource-is-requesting-data"></a><span data-ttu-id="41a1b-201">Шаг 3. Проверка при ObjectDataSource является запрос данных</span><span class="sxs-lookup"><span data-stu-id="41a1b-201">Step 3: Examining When the ObjectDataSource is Requesting Data</span></span>

<span data-ttu-id="41a1b-202">`Products` GridView извлекает свои данные для отображения, вызвав `Select` метод `ProductsDataSource` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="41a1b-202">The `Products` GridView retrieves its data to display by invoking the `Select` method of the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="41a1b-203">Данный элемент управления ObjectDataSource создает экземпляр класса s уровня бизнес-логики `ProductsBLL` класс и вызывает его `GetProducts()` метод, который в свою очередь вызывает s уровня доступа к данным `ProductsTableAdapter` s `GetProducts()` метод.</span><span class="sxs-lookup"><span data-stu-id="41a1b-203">This ObjectDataSource creates an instance of the Business Logic Layer s `ProductsBLL` class and calls its `GetProducts()` method, which in turn calls the Data Access Layer s `ProductsTableAdapter` s `GetProducts()` method.</span></span> <span data-ttu-id="41a1b-204">Метод DAL подключается к базе данных Northwind и выдает настроенного `SELECT` запроса.</span><span class="sxs-lookup"><span data-stu-id="41a1b-204">The DAL method connects to the Northwind database and issues the configured `SELECT` query.</span></span> <span data-ttu-id="41a1b-205">Эти данные затем возвращается в слой DAL, который упаковывает их в `NorthwindDataTable`.</span><span class="sxs-lookup"><span data-stu-id="41a1b-205">This data is then returned to the DAL, which packages it up in a `NorthwindDataTable`.</span></span> <span data-ttu-id="41a1b-206">Объект DataTable возвращается BLL, который возвращает его к элементу ObjectDataSource, который возвращает его к GridView.</span><span class="sxs-lookup"><span data-stu-id="41a1b-206">The DataTable object is returned to the BLL, which returns it to the ObjectDataSource, which returns it to the GridView.</span></span> <span data-ttu-id="41a1b-207">Затем создает GridView `GridViewRow` для каждой `DataRow` таблицы данных, а для каждого `GridViewRow` в конечном итоге превращается в HTML-код, который возвращается клиенту и отображается в браузере посетителя s.</span><span class="sxs-lookup"><span data-stu-id="41a1b-207">The GridView then creates a `GridViewRow` object for each `DataRow` in the DataTable, and each `GridViewRow` is eventually rendered into the HTML that is returned to the client and displayed on the visitor s browser.</span></span>

<span data-ttu-id="41a1b-208">Эта последовательность событий происходит каждый раз, когда GridView требуется выполнить привязку для базовых данных.</span><span class="sxs-lookup"><span data-stu-id="41a1b-208">This sequence of events happens each and every time the GridView needs to bind to its underlying data.</span></span> <span data-ttu-id="41a1b-209">Это происходит при первом посещении страницы, при переходе от одной страницы данных в другую, при сортировке GridView, или при изменении данных s GridView по его встроенному, изменение или удаление интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="41a1b-209">That happens when the page is first visited, when moving from one page of data to another, when sorting the GridView, or when modifying the GridView s data through its built-in editing or deleting interfaces.</span></span> <span data-ttu-id="41a1b-210">Если состояние представления GridView s отключена, при каждой обратной передаче также будет привязывается GridView.</span><span class="sxs-lookup"><span data-stu-id="41a1b-210">If the GridView s view state is disabled, the GridView will be rebound on each and every postback as well.</span></span> <span data-ttu-id="41a1b-211">GridView может также явно привязывается к данным путем вызова его `DataBind()` метод.</span><span class="sxs-lookup"><span data-stu-id="41a1b-211">The GridView can also be explicitly rebound to its data by calling its `DataBind()` method.</span></span>

<span data-ttu-id="41a1b-212">Чтобы полностью оценить частоту, с помощью которого данные извлекаются из базы данных, позволяют отображать сообщение о том, когда данные повторно получаются s.</span><span class="sxs-lookup"><span data-stu-id="41a1b-212">To fully appreciate the frequency with which the data is retrieved from the database, let s display a message indicating when the data is being re-retrieved.</span></span> <span data-ttu-id="41a1b-213">Добавление элемента управления Label Web над элементом управления GridView с именем `ODSEvents`.</span><span class="sxs-lookup"><span data-stu-id="41a1b-213">Add a Label Web control above the GridView named `ODSEvents`.</span></span> <span data-ttu-id="41a1b-214">Очистите его `Text` и установите его `EnableViewState` свойства `False`.</span><span class="sxs-lookup"><span data-stu-id="41a1b-214">Clear out its `Text` property and set its `EnableViewState` property to `False`.</span></span> <span data-ttu-id="41a1b-215">Под метку, добавьте кнопку веб-элемент управления и задайте его `Text` значение обратной передачи.</span><span class="sxs-lookup"><span data-stu-id="41a1b-215">Underneath the Label, add a Button Web control and set its `Text` property to Postback .</span></span>


<span data-ttu-id="41a1b-216">[![Добавление метки и кнопку на страницу над элементом управления GridView](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="41a1b-216">[![Add a Label and Button to the Page Above the GridView](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span></span>

<span data-ttu-id="41a1b-217">**Рис. 8**: Добавление метки и кнопки к странице выше GridView ([Просмотр полноразмерного изображения](caching-data-with-the-objectdatasource-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="41a1b-217">**Figure 8**: Add a Label and Button to the Page Above the GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image20.png))</span></span>


<span data-ttu-id="41a1b-218">При выполнении рабочего процесса доступа данных, ObjectDataSource s `Selecting` вызывает событие, прежде чем создается базовый объект и его настроенный метод вызывается.</span><span class="sxs-lookup"><span data-stu-id="41a1b-218">During the data access workflow, the ObjectDataSource s `Selecting` event fires before the underlying object is created and its configured method invoked.</span></span> <span data-ttu-id="41a1b-219">Создайте обработчик событий для этого события и добавьте следующий код:</span><span class="sxs-lookup"><span data-stu-id="41a1b-219">Create an event handler for this event and add the following code:</span></span>


[!code-vb[Main](caching-data-with-the-objectdatasource-vb/samples/sample3.vb)]

<span data-ttu-id="41a1b-220">Каждый раз при ObjectDataSource выполняет запрос к архитектуры для данных, метка будет отображать инициируется событие выделение текста.</span><span class="sxs-lookup"><span data-stu-id="41a1b-220">Each time the ObjectDataSource makes a request to the architecture for data, the Label will display the text Selecting event fired .</span></span>

<span data-ttu-id="41a1b-221">Посетите эту страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="41a1b-221">Visit this page in a browser.</span></span> <span data-ttu-id="41a1b-222">При первом посещении страницы отображается инициируется событие выделение текста.</span><span class="sxs-lookup"><span data-stu-id="41a1b-222">When the page is first visited, the text Selecting event fired is shown.</span></span> <span data-ttu-id="41a1b-223">Нажмите кнопку обратной передачи и обратите внимание на то, что текст не отображается (предполагая, что GridView s `EnableViewState` свойству `True`, значение по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="41a1b-223">Click the Postback button and note that the text disappears (assuming that the GridView s `EnableViewState` property is set to `True`, the default).</span></span> <span data-ttu-id="41a1b-224">Это обусловлено тем, при обратной передаче GridView воссоздается из состояния представления, и поэтому t включить в элемент управления ObjectDataSource для своих данных.</span><span class="sxs-lookup"><span data-stu-id="41a1b-224">This is because, on postback, the GridView is reconstructed from its view state and therefore doesn t turn to the ObjectDataSource for its data.</span></span> <span data-ttu-id="41a1b-225">Сортировка, разбиение по страницам и изменение данных, тем не менее, приводит к GridView выполнять повторную привязку к источнику данных и поэтому выбор событие отобразится текст.</span><span class="sxs-lookup"><span data-stu-id="41a1b-225">Sorting, paging, or editing the data, however, causes the GridView to rebind to its data source, and therefore the Selecting event fired text reappears.</span></span>


<span data-ttu-id="41a1b-226">[![Всякий раз, когда GridView повторно привязываются к источнику данных, отображается событие Selecting](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="41a1b-226">[![Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span></span>

<span data-ttu-id="41a1b-227">**Рис. 9**: Всякий раз, когда GridView повторно привязываются к источнику данных, инициируется событие Selecting отображается ([Просмотр полноразмерного изображения](caching-data-with-the-objectdatasource-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="41a1b-227">**Figure 9**: Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image23.png))</span></span>


<span data-ttu-id="41a1b-228">[![Щелкнув кнопку обратной передачи приводит к GridView, перестраиваются заново из состояния представления](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="41a1b-228">[![Clicking the Postback Button Causes the GridView to be Reconstructed from its View State](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span></span>

<span data-ttu-id="41a1b-229">**Рис. 10**: Нажатие кнопки обратной передачи GridView, перестраиваются заново из состояния представления ([Просмотр полноразмерного изображения](caching-data-with-the-objectdatasource-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="41a1b-229">**Figure 10**: Clicking the Postback Button Causes the GridView to be Reconstructed from its View State ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image26.png))</span></span>


<span data-ttu-id="41a1b-230">Может показаться излишним, для получения данных базы данных каждый раз, разбиваемых по страницам или сортировки данных.</span><span class="sxs-lookup"><span data-stu-id="41a1b-230">It may seem wasteful to retrieve the database data each time the data is paged through or sorted.</span></span> <span data-ttu-id="41a1b-231">В конце концов так как мы повторно с разбиением на страницы по умолчанию, элемент управления ObjectDataSource получил все записи при отображении на первой странице.</span><span class="sxs-lookup"><span data-stu-id="41a1b-231">After all, since we re using default paging, the ObjectDataSource has retrieved all of the records when displaying the first page.</span></span> <span data-ttu-id="41a1b-232">Даже если GridView не поддерживает сортировку и разбиение по страницам поддержки, необходимо получить данные из базы данных каждый раз при первом посещении страницы любым пользователем (и при каждой обратной передаче, если состояние просмотра отключено).</span><span class="sxs-lookup"><span data-stu-id="41a1b-232">Even if the GridView does not provide sorting and paging support, the data must be retrieved from the database each time the page is first visited by any user (and on every postback, if view state is disabled).</span></span> <span data-ttu-id="41a1b-233">Однако если GridView отображаются те же данные для всех пользователей, эти запросы дополнительной базы данных излишним.</span><span class="sxs-lookup"><span data-stu-id="41a1b-233">But if the GridView is showing the same data to all users, these extra database requests are superfluous.</span></span> <span data-ttu-id="41a1b-234">Почему бы не кэшировать результаты, возвращаемые `GetProducts()` метод и привязки GridView теми кэшированные результаты?</span><span class="sxs-lookup"><span data-stu-id="41a1b-234">Why not cache the results returned from the `GetProducts()` method and bind the GridView to those cached results?</span></span>

## <a name="step-4-caching-the-data-using-the-objectdatasource"></a><span data-ttu-id="41a1b-235">Шаг 4. Кэширование данных с помощью элемента управления ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="41a1b-235">Step 4: Caching the Data Using the ObjectDataSource</span></span>

<span data-ttu-id="41a1b-236">Просто задав несколько свойств, можно настроить элемент управления ObjectDataSource автоматически кэшировать его полученных данных в кэше данных ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="41a1b-236">By simply setting a few properties, the ObjectDataSource can be configured to automatically cache its retrieved data in the ASP.NET data cache.</span></span> <span data-ttu-id="41a1b-237">Ниже перечислены связанные с кэшем свойств элемента управления ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="41a1b-237">The following list summarizes the cache-related properties of the ObjectDataSource:</span></span>

- <span data-ttu-id="41a1b-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) должно быть присвоено `True` для включения кэширования.</span><span class="sxs-lookup"><span data-stu-id="41a1b-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) must be set to `True` to enable caching.</span></span> <span data-ttu-id="41a1b-239">Значение по умолчанию — `False`.</span><span class="sxs-lookup"><span data-stu-id="41a1b-239">The default is `False`.</span></span>
- <span data-ttu-id="41a1b-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) количество времени в секундах, которое данные кэшируются.</span><span class="sxs-lookup"><span data-stu-id="41a1b-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) the amount of time, in seconds, that the data is cached.</span></span> <span data-ttu-id="41a1b-241">Значение по умолчанию — 0.</span><span class="sxs-lookup"><span data-stu-id="41a1b-241">The default is 0.</span></span> <span data-ttu-id="41a1b-242">Элемент управления ObjectDataSource будет кэшировать данные, только если `EnableCaching` — `True` и `CacheDuration` присваивается значение больше нуля.</span><span class="sxs-lookup"><span data-stu-id="41a1b-242">The ObjectDataSource will only cache data if `EnableCaching` is `True` and `CacheDuration` is set to a value greater than zero.</span></span>
- <span data-ttu-id="41a1b-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) можно присвоить `Absolute` или `Sliding`.</span><span class="sxs-lookup"><span data-stu-id="41a1b-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) can be set to `Absolute` or `Sliding`.</span></span> <span data-ttu-id="41a1b-244">Если `Absolute`, элемент управления ObjectDataSource кэширует его извлеченных данных для `CacheDuration` секунды; Если `Sliding`, только после его не было обращений для истечения срока действия данных `CacheDuration` секунд.</span><span class="sxs-lookup"><span data-stu-id="41a1b-244">If `Absolute`, the ObjectDataSource caches its retrieved data for `CacheDuration` seconds; if `Sliding`, the data expires only after it has not been accessed for `CacheDuration` seconds.</span></span> <span data-ttu-id="41a1b-245">Значение по умолчанию — `Absolute`.</span><span class="sxs-lookup"><span data-stu-id="41a1b-245">The default is `Absolute`.</span></span>
- <span data-ttu-id="41a1b-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) это свойство используется для связывания записей кэша s ObjectDataSource с существующей зависимости кэша.</span><span class="sxs-lookup"><span data-stu-id="41a1b-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) use this property to associate the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="41a1b-247">Записи данных s ObjectDataSource может быть преждевременно удалена из кэша с истекающим сроком действия, связанный с ним `CacheKeyDependency`.</span><span class="sxs-lookup"><span data-stu-id="41a1b-247">The ObjectDataSource s data entries can be prematurely evicted from the cache by expiring its associated `CacheKeyDependency`.</span></span> <span data-ttu-id="41a1b-248">Это свойство чаще всего используется для связи с кэшем s ObjectDataSource зависимость кэша SQL, раздел будет рассмотрен в будущем [использование зависимостей кэша SQL](using-sql-cache-dependencies-vb.md) руководства.</span><span class="sxs-lookup"><span data-stu-id="41a1b-248">This property is most commonly used to associate a SQL cache dependency with the ObjectDataSource s cache, a topic we'll explore in the future [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="41a1b-249">Позвольте настроить s `ProductsDataSource` ObjectDataSource для кэширования данных на 30 секунд на абсолютной шкале.</span><span class="sxs-lookup"><span data-stu-id="41a1b-249">Let s configure the `ProductsDataSource` ObjectDataSource to cache its data for 30 seconds on an absolute scale.</span></span> <span data-ttu-id="41a1b-250">Набор ObjectDataSource s `EnableCaching` свойства `True` и его `CacheDuration` значение 30.</span><span class="sxs-lookup"><span data-stu-id="41a1b-250">Set the ObjectDataSource s `EnableCaching` property to `True` and its `CacheDuration` property to 30.</span></span> <span data-ttu-id="41a1b-251">Оставьте `CacheExpirationPolicy` свойство, значение по умолчанию `Absolute`.</span><span class="sxs-lookup"><span data-stu-id="41a1b-251">Leave the `CacheExpirationPolicy` property set to its default, `Absolute`.</span></span>


<span data-ttu-id="41a1b-252">[![Настройте элемент ObjectDataSource для кэширования данных на 30 секунд](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="41a1b-252">[![Configure the ObjectDataSource to Cache its Data for 30 Seconds](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span></span>

<span data-ttu-id="41a1b-253">**Рис. 11**: Настройте элемент ObjectDataSource для кэширования данных на 30 секунд ([Просмотр полноразмерного изображения](caching-data-with-the-objectdatasource-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="41a1b-253">**Figure 11**: Configure the ObjectDataSource to Cache its Data for 30 Seconds ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image29.png))</span></span>


<span data-ttu-id="41a1b-254">Сохраните изменения и вернитесь на эту страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="41a1b-254">Save your changes and revisit this page in a browser.</span></span> <span data-ttu-id="41a1b-255">Текст событие, запускаемое выбор будет отображаться при первом посещении страницы, так как изначально данные не в кэше.</span><span class="sxs-lookup"><span data-stu-id="41a1b-255">The Selecting event fired text will appear when you first visit the page, as initially the data is not in the cache.</span></span> <span data-ttu-id="41a1b-256">В отличие от последующих обратных передачах активации, нажав кнопку обратной передачи, сортировка, разбиение по страницам или кнопки Edit или Отмена *не* повторного отображения события Selecting инициируется текста.</span><span class="sxs-lookup"><span data-stu-id="41a1b-256">But subsequent postbacks triggered by clicking the Postback button, sorting, paging, or clicking the Edit or Cancel buttons does *not* redisplay the Selecting event fired text.</span></span> <span data-ttu-id="41a1b-257">Это обусловлено `Selecting` событие срабатывает, только если элемент управления ObjectDataSource получает данные из базового объекта; `Selecting` событий не выполняется, если данные извлекаются из кэша данных.</span><span class="sxs-lookup"><span data-stu-id="41a1b-257">This is because the `Selecting` event only fires when the ObjectDataSource gets its data from its underlying object; the `Selecting` event does not fire if the data is pulled from the data cache.</span></span>

<span data-ttu-id="41a1b-258">Через 30 секунд данные будут вытесняться из кэша.</span><span class="sxs-lookup"><span data-stu-id="41a1b-258">After 30 seconds, the data will be evicted from the cache.</span></span> <span data-ttu-id="41a1b-259">Данные также будут удаляться из кэша, если элемент управления ObjectDataSource s `Insert`, `Update`, или `Delete` методы вызываются.</span><span class="sxs-lookup"><span data-stu-id="41a1b-259">The data will also be evicted from the cache if the ObjectDataSource s `Insert`, `Update`, or `Delete` methods are invoked.</span></span> <span data-ttu-id="41a1b-260">Следовательно, после 30 секунд или кнопкой "Обновить" выбрана, сортировка, разбиение по страницам, или в кнопки Edit или "Отмена" для получения данных из базового объекта ObjectDataSource, отображение события Selecting инициируется текст при `Selecting` вызывает событие.</span><span class="sxs-lookup"><span data-stu-id="41a1b-260">Consequently, after 30 seconds have passed or the Update button has been clicked, sorting, paging, or clicking the Edit or Cancel buttons will cause the ObjectDataSource to get its data from its underlying object, displaying the Selecting event fired text when the `Selecting` event fires.</span></span> <span data-ttu-id="41a1b-261">Эти возвращаемые результаты помещаются обратно в кэш данных.</span><span class="sxs-lookup"><span data-stu-id="41a1b-261">These returned results are placed back into the data cache.</span></span>

> [!NOTE]
> <span data-ttu-id="41a1b-262">Если вы видите текст событие Selecting часто, даже в том случае, если предполагается, что элемент управления ObjectDataSource для работы с кэшированными данными, возможно из-за нехватки памяти.</span><span class="sxs-lookup"><span data-stu-id="41a1b-262">If you see the Selecting event fired text frequently, even when you expect the ObjectDataSource to be working with cached data, it may be due to memory constraints.</span></span> <span data-ttu-id="41a1b-263">Если не хватает памяти, данные, добавленные в кэш элементом ObjectDataSource может были очистки для.</span><span class="sxs-lookup"><span data-stu-id="41a1b-263">If there is not enough free memory, the data added to the cache by the ObjectDataSource may have been scavenged.</span></span> <span data-ttu-id="41a1b-264">Если t ObjectDataSource правильно кэшировать данные или только кэши данных нерегулярно, закройте некоторые приложения, чтобы освободить память и повторите попытку.</span><span class="sxs-lookup"><span data-stu-id="41a1b-264">If the ObjectDataSource doesn t appear to be correctly caching the data or only caches the data sporadically, close some applications to free memory and try again.</span></span>


<span data-ttu-id="41a1b-265">Рис. 12 показано s ObjectDataSource, кэширование рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="41a1b-265">Figure 12 illustrates the ObjectDataSource s caching workflow.</span></span> <span data-ttu-id="41a1b-266">При возникновении события Selecting текст отображается на экране, поскольку данные не найден в кэше и должны были быть получены из базового объекта.</span><span class="sxs-lookup"><span data-stu-id="41a1b-266">When the Selecting event fired text appears on your screen, it is because the data was not in the cache and had to be retrieved from the underlying object.</span></span> <span data-ttu-id="41a1b-267">При этом текст отсутствует, однако его s, так как данные были доступны из кэша.</span><span class="sxs-lookup"><span data-stu-id="41a1b-267">When this text is missing, however, it s because the data was available from the cache.</span></span> <span data-ttu-id="41a1b-268">Когда данные возвращаются из кэша существует s не вызов к базовому объекту и, следовательно, запрос базы данных не выполнен.</span><span class="sxs-lookup"><span data-stu-id="41a1b-268">When the data is returned from the cache there s no call to the underlying object and, therefore, no database query executed.</span></span>


![Элемент управления ObjectDataSource сохраняет и извлекает данные из кэша данных](caching-data-with-the-objectdatasource-vb/_static/image30.png)

<span data-ttu-id="41a1b-270">**Рис. 12**: Элемент управления ObjectDataSource сохраняет и извлекает данные из кэша данных</span><span class="sxs-lookup"><span data-stu-id="41a1b-270">**Figure 12**: The ObjectDataSource Stores and Retrieves its Data from the Data Cache</span></span>


<span data-ttu-id="41a1b-271">Каждое приложение ASP.NET имеет свой собственный кэш данных экземпляра, s, общими для всех страниц и посетителей.</span><span class="sxs-lookup"><span data-stu-id="41a1b-271">Each ASP.NET application has its own data cache instance that s shared across all pages and visitors.</span></span> <span data-ttu-id="41a1b-272">Что означает, что данные, хранящиеся в кэше данных элемент управления ObjectDataSource аналогично совместно для всех пользователей, посещающих страницу.</span><span class="sxs-lookup"><span data-stu-id="41a1b-272">That means that the data stored in the data cache by the ObjectDataSource is likewise shared across all users who visit the page.</span></span> <span data-ttu-id="41a1b-273">Чтобы проверить это, откройте `ObjectDataSource.aspx` страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="41a1b-273">To verify this, open the `ObjectDataSource.aspx` page in a browser.</span></span> <span data-ttu-id="41a1b-274">При первом просмотре странице будет отображаться текст событие Selecting (предполагается, что данные, добавленные в кэш с предыдущих тестов к этому моменту, исключен).</span><span class="sxs-lookup"><span data-stu-id="41a1b-274">When first visiting the page, the Selecting event fired text will appear (assuming that the data added to the cache by previous tests has, by now, been evicted).</span></span> <span data-ttu-id="41a1b-275">Откройте второй экземпляр браузера и скопируйте и вставьте URL-адрес в первом экземпляре обозревателя до секунды.</span><span class="sxs-lookup"><span data-stu-id="41a1b-275">Open a second browser instance and copy and paste the URL from the first browser instance to the second.</span></span> <span data-ttu-id="41a1b-276">Во втором экземпляре обозревателя, текст события выбор не отображается, так как он s, используя те же кэшированные данные, что и первый.</span><span class="sxs-lookup"><span data-stu-id="41a1b-276">In the second browser instance, the Selecting event fired text is not shown because it s using the same cached data as the first.</span></span>

<span data-ttu-id="41a1b-277">При вставке его полученных данных в кэше, элемент управления ObjectDataSource использует значение ключа кэша, который включает в себя: `CacheDuration` и `CacheExpirationPolicy` значения свойств; тип базового объекта бизнеса используется элемент управления ObjectDataSource, который указывается с помощью [ `TypeName` свойство](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`, в этом примере); значение `SelectMethod` свойства, а также имени и значения параметров в `SelectParameters` коллекции; а также значения его `StartRowIndex`и `MaximumRows` свойства, которые используются при реализации [пользовательское разбиение по страницам](../paging-and-sorting/paging-and-sorting-report-data-vb.md).</span><span class="sxs-lookup"><span data-stu-id="41a1b-277">When inserting its retrieved data into the cache, the ObjectDataSource uses a cache key value that includes: the `CacheDuration` and `CacheExpirationPolicy` property values; the type of the underlying business object being used by the ObjectDataSource, which is specified via the [`TypeName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`, in this example); the value of the `SelectMethod` property and the name and values of the parameters in the `SelectParameters` collection; and the values of its `StartRowIndex` and `MaximumRows` properties, which are used when implementing [custom paging](../paging-and-sorting/paging-and-sorting-report-data-vb.md).</span></span>

<span data-ttu-id="41a1b-278">Берет на себя создание значение ключа кэша как сочетание этих свойств гарантирует уникальных записей кэша, как изменить эти значения.</span><span class="sxs-lookup"><span data-stu-id="41a1b-278">Crafting the cache key value as a combination of these properties ensures a unique cache entry as these values change.</span></span> <span data-ttu-id="41a1b-279">Например, в предыдущих учебных курсах мы рассмотрели применение ve `ProductsBLL` класс s `GetProductsByCategoryID(categoryID)`, который возвращает все продукты для указанной категории.</span><span class="sxs-lookup"><span data-stu-id="41a1b-279">For example, in past tutorials we ve looked at using the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)`, which returns all products for a specified category.</span></span> <span data-ttu-id="41a1b-280">Один пользователь можете прийти к странице и представление «Напитки», которая имеет `CategoryID` 1.</span><span class="sxs-lookup"><span data-stu-id="41a1b-280">One user might come to the page and view beverages, which has a `CategoryID` of 1.</span></span> <span data-ttu-id="41a1b-281">Если элемент управления ObjectDataSource кэшировать его результаты, без учета `SelectParameters` значений, когда другого пользователя на страницу для просмотра Специи при Напитки продукты были в кэше, они d см. в разделе продуктов кэшированных Напитки, а не Специи.</span><span class="sxs-lookup"><span data-stu-id="41a1b-281">If the ObjectDataSource cached its results without regard for the `SelectParameters` values, when another user came to the page to view condiments while the beverages products were in the cache, they d see the cached beverage products rather than condiments.</span></span> <span data-ttu-id="41a1b-282">Изменив ключ кэша по этим свойствам, которые включают значения `SelectParameters`, элемент управления ObjectDataSource поддерживает отдельную запись кэша для напитков и Специи.</span><span class="sxs-lookup"><span data-stu-id="41a1b-282">By varying the cache key by these properties, which include the values of the `SelectParameters`, the ObjectDataSource maintains a separate cache entry for beverages and condiments.</span></span>

## <a name="stale-data-concerns"></a><span data-ttu-id="41a1b-283">Устаревшие данные проблемы</span><span class="sxs-lookup"><span data-stu-id="41a1b-283">Stale Data Concerns</span></span>

<span data-ttu-id="41a1b-284">Элемент управления ObjectDataSource автоматически исключает его элементы из кэша, если какой-либо из его `Insert`, `Update`, или `Delete` вызова методов.</span><span class="sxs-lookup"><span data-stu-id="41a1b-284">The ObjectDataSource automatically evicts its items from the cache when any one of its `Insert`, `Update`, or `Delete` methods is invoked.</span></span> <span data-ttu-id="41a1b-285">Это помогает защититься от устаревшие данные при очистке записей кэша при изменении данных на странице.</span><span class="sxs-lookup"><span data-stu-id="41a1b-285">This helps protect against stale data by clearing out the cache entries when the data is modified through the page.</span></span> <span data-ttu-id="41a1b-286">Тем не менее существует возможность по-прежнему отображаться устаревшие данные с помощью кэширования нового ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="41a1b-286">However, it is possible for an ObjectDataSource using caching to still display stale data.</span></span> <span data-ttu-id="41a1b-287">В самом простом случае может быть из-за данные, изменять непосредственно в базе данных.</span><span class="sxs-lookup"><span data-stu-id="41a1b-287">In the simplest case, it can be due to the data changing directly within the database.</span></span> <span data-ttu-id="41a1b-288">Может быть администратором базы данных только что выполнили сценарий, который изменяет некоторые записи в базе данных.</span><span class="sxs-lookup"><span data-stu-id="41a1b-288">Perhaps a database administrator just ran a script that modifies some of the records in the database.</span></span>

<span data-ttu-id="41a1b-289">Этот сценарий также может раскрыть заметная способом.</span><span class="sxs-lookup"><span data-stu-id="41a1b-289">This scenario could also unfold in a more subtle way.</span></span> <span data-ttu-id="41a1b-290">Хотя элемент управления ObjectDataSource исключает его элементы из кэша, при вызове одного из его методов изменения данных, кэшированные элементы предназначены для ObjectDataSource s определенного сочетания значений свойств (`CacheDuration`, `TypeName`, `SelectMethod`, и так далее).</span><span class="sxs-lookup"><span data-stu-id="41a1b-290">While the ObjectDataSource evicts its items from the cache when one of its data modification methods is called, the cached items removed are for the ObjectDataSource s particular combination of property values (`CacheDuration`, `TypeName`, `SelectMethod`, and so on).</span></span> <span data-ttu-id="41a1b-291">При наличии двух элементов управления ObjectDataSource, которые используют разные `SelectMethods` или `SelectParameters`, но по-прежнему можете обновить те же данные, а затем один элемент управления ObjectDataSource может обновить строку и отменить свой собственный записей кэша, но соответствующая строка для второй элемент управления ObjectDataSource по-прежнему будут обрабатываться из кэша.</span><span class="sxs-lookup"><span data-stu-id="41a1b-291">If you have two ObjectDataSources that use different `SelectMethods` or `SelectParameters`, but still can update the same data, then one ObjectDataSource may update a row and invalidate its own cache entries, but the corresponding row for the second ObjectDataSource will still be served from the cached.</span></span> <span data-ttu-id="41a1b-292">Я советую вам для создания страниц, на которых эта функция.</span><span class="sxs-lookup"><span data-stu-id="41a1b-292">I encourage you to create pages to exhibit this functionality.</span></span> <span data-ttu-id="41a1b-293">Создать страницу, отображающую изменяемого элемента управления GridView, который извлекает данные из ObjectDataSource, который использует кэширование и настроен для получения данных из `ProductsBLL` класс s `GetProducts()` метод.</span><span class="sxs-lookup"><span data-stu-id="41a1b-293">Create a page that displays an editable GridView that pulls its data from an ObjectDataSource that uses caching and is configured to get data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="41a1b-294">Добавьте еще один изменяемые GridView и ObjectDataSource на этой странице (или другой), но для этой второй элемент управления ObjectDataSource будет использовать `GetProductsByCategoryID(categoryID)` метод.</span><span class="sxs-lookup"><span data-stu-id="41a1b-294">Add another editable GridView and ObjectDataSource to this page (or another one), but for this second ObjectDataSource have it use the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="41a1b-295">С момента двух элементов управления ObjectDataSource `SelectMethod` свойства отличаются, они ll каждый имеет свои собственные кэшированных значений.</span><span class="sxs-lookup"><span data-stu-id="41a1b-295">Since the two ObjectDataSources `SelectMethod` properties differ, they ll each have their own cached values.</span></span> <span data-ttu-id="41a1b-296">При изменении продукта в одной таблице, следующий раз, можно выполнить привязку данных к другой таблице (, разбиение по страницам, сортировку и т. д), он по-прежнему использовать старый, кэшированные данные и не отражают изменения, которые были выполнены из других сетки.</span><span class="sxs-lookup"><span data-stu-id="41a1b-296">If you edit a product in one grid, the next time you bind the data back to the other grid (by paging, sorting, and so forth), it will still serve the old, cached data and not reflect the change that was made from the other grid.</span></span>

<span data-ttu-id="41a1b-297">Короче говоря только используйте кэше на основе времени, если вы готовы пойти на потенциально устаревшие данные и использовать более короткие кэше для сценариев, в которых важно актуальность данных.</span><span class="sxs-lookup"><span data-stu-id="41a1b-297">In short, only use time-based expiries if you are willing to have the potential of stale data, and use shorter expiries for scenarios where the freshness of data is important.</span></span> <span data-ttu-id="41a1b-298">Если устаревшие данные неприемлем, либо отказаться от кэширования, либо использовать зависимости кэша SQL (при условии, что это данные базы данных во время кэширования).</span><span class="sxs-lookup"><span data-stu-id="41a1b-298">If stale data is not acceptable, either forgo caching or use SQL cache dependencies (assuming it is database data you re caching).</span></span> <span data-ttu-id="41a1b-299">В следующем учебном курсе мы изучим зависимостей кэша SQL.</span><span class="sxs-lookup"><span data-stu-id="41a1b-299">We'll explore SQL cache dependencies in a future tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="41a1b-300">Сводка</span><span class="sxs-lookup"><span data-stu-id="41a1b-300">Summary</span></span>

<span data-ttu-id="41a1b-301">В этом учебнике мы рассмотрели ObjectDataSource s встроенные возможности кэширования.</span><span class="sxs-lookup"><span data-stu-id="41a1b-301">In this tutorial we examined the ObjectDataSource s built-in caching capabilities.</span></span> <span data-ttu-id="41a1b-302">Просто задав несколько свойств, можно указать элемент управления ObjectDataSource для кэширования результатов, возвращаемых из указанного `SelectMethod` в кэш данных ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="41a1b-302">By simply setting a few properties, we can instruct the ObjectDataSource to cache the results returned from the specified `SelectMethod` into the ASP.NET data cache.</span></span> <span data-ttu-id="41a1b-303">`CacheDuration` И `CacheExpirationPolicy` свойства указывают длительность кэширования элемента и является ли он абсолютный или скользящий срок действия.</span><span class="sxs-lookup"><span data-stu-id="41a1b-303">The `CacheDuration` and `CacheExpirationPolicy` properties indicate the duration the item is cached and whether it is an absolute or sliding expiration.</span></span> <span data-ttu-id="41a1b-304">`CacheKeyDependency` Свойство связывает все записи кэша s ObjectDataSource с существующей зависимости кэша.</span><span class="sxs-lookup"><span data-stu-id="41a1b-304">The `CacheKeyDependency` property associates all of the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="41a1b-305">Это можно использовать для вытеснения из кэша записей s ObjectDataSource, до того, как действия по времени достижения обычно используется с зависимостей кэша SQL.</span><span class="sxs-lookup"><span data-stu-id="41a1b-305">This can be used to evict the ObjectDataSource s entries from the cache before the time-based expiration is reached, and is typically used with SQL cache dependencies.</span></span>

<span data-ttu-id="41a1b-306">Поскольку элемент управления ObjectDataSource просто кэширует его значения в кэш данных, мы удалось реплицировать встроенные функции s ObjectDataSource программным способом.</span><span class="sxs-lookup"><span data-stu-id="41a1b-306">Since the ObjectDataSource simply caches its values to the data cache, we could replicate the ObjectDataSource s built-in functionality programmatically.</span></span> <span data-ttu-id="41a1b-307">Он t имеет смысла для этого на уровне представления, так как элемент управления ObjectDataSource обеспечивает эти функциональные возможности без дополнительной настройки, но мы можем реализовать возможности кэширования в отдельном слое архитектуры.</span><span class="sxs-lookup"><span data-stu-id="41a1b-307">It doesn t make sense to do this at the Presentation Layer, since the ObjectDataSource offers this functionality out of the box, but we can implement caching capabilities in a separate layer of the architecture.</span></span> <span data-ttu-id="41a1b-308">Для этого нам потребуется повторите ту же логику, используется элемент управления ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="41a1b-308">To do so, we'll need to repeat the same logic used by the ObjectDataSource.</span></span> <span data-ttu-id="41a1b-309">Мы рассмотрим, как программно работать с кэшем данных из в архитектуре в нашем следующем учебном курсе.</span><span class="sxs-lookup"><span data-stu-id="41a1b-309">We'll explore how to programmatically work with the data cache from within the architecture in our next tutorial.</span></span>

<span data-ttu-id="41a1b-310">Счастливого вам программирования!</span><span class="sxs-lookup"><span data-stu-id="41a1b-310">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="41a1b-311">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="41a1b-311">Further Reading</span></span>

<span data-ttu-id="41a1b-312">Дополнительные сведения по темам, обсуждавшимся в этом руководстве см. в следующих ресурсах:</span><span class="sxs-lookup"><span data-stu-id="41a1b-312">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="41a1b-313">Кэширование ASP.NET: Методик и рекомендаций</span><span class="sxs-lookup"><span data-stu-id="41a1b-313">ASP.NET Caching: Techniques and Best Practices</span></span>](https://msdn.microsoft.com/library/aa478965.aspx)
- [<span data-ttu-id="41a1b-314">Кэширования руководство по архитектуре для приложений .NET Framework</span><span class="sxs-lookup"><span data-stu-id="41a1b-314">Caching Architecture Guide for .NET Framework Applications</span></span>](https://msdn.microsoft.com/library/ee817645.aspx)
- [<span data-ttu-id="41a1b-315">Кэширование вывода в ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="41a1b-315">Output Caching in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)

## <a name="about-the-author"></a><span data-ttu-id="41a1b-316">Об авторе</span><span class="sxs-lookup"><span data-stu-id="41a1b-316">About the Author</span></span>

<span data-ttu-id="41a1b-317">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP.NET и основатель веб- [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Microsoft с 1998 года.</span><span class="sxs-lookup"><span data-stu-id="41a1b-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="41a1b-318">Скотт — независимый консультант, преподаватель и автор.</span><span class="sxs-lookup"><span data-stu-id="41a1b-318">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="41a1b-319">Его последняя книга — [ *Sams Teach ASP.NET 2.0 in 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="41a1b-319">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="41a1b-320">Ним можно связаться по адресу [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="41a1b-320">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="41a1b-321">или через его блог, который можно найти в [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="41a1b-321">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="41a1b-322">Особая благодарность</span><span class="sxs-lookup"><span data-stu-id="41a1b-322">Special Thanks To</span></span>

<span data-ttu-id="41a1b-323">В этой серии руководств пособий рецензировалась многими компетентными редакторами.</span><span class="sxs-lookup"><span data-stu-id="41a1b-323">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="41a1b-324">Основной рецензент этого учебного был Мерфи Терезой.</span><span class="sxs-lookup"><span data-stu-id="41a1b-324">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="41a1b-325">Хотите поработать с моих последующих статей для MSDN?</span><span class="sxs-lookup"><span data-stu-id="41a1b-325">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="41a1b-326">Если Да, напишите мне [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="41a1b-326">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="41a1b-327">[Назад](using-sql-cache-dependencies-cs.md)
> [Вперед](caching-data-in-the-architecture-vb.md)</span><span class="sxs-lookup"><span data-stu-id="41a1b-327">[Previous](using-sql-cache-dependencies-cs.md)
[Next](caching-data-in-the-architecture-vb.md)</span></span>
