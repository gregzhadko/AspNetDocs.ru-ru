---
uid: web-forms/overview/data-access/enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb
title: Добавление столбца GridView для флажков (VB) | Документация Майкрософт
author: rick-anderson
description: В этом учебнике рассматривается добавление столбца флажков к элементу управления GridView для предоставления пользователю интуитивно понятного способа выбора нескольких строк в G...
ms.author: riande
ms.date: 03/06/2007
ms.assetid: 39253d05-75c0-41c7-b9d4-a6c58ecf69ce
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb
msc.type: authoredcontent
ms.openlocfilehash: c620b2eac5844d4030c1309b45e7d6a72d1f386a
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78491886"
---
# <a name="adding-a-gridview-column-of-checkboxes-vb"></a><span data-ttu-id="7a4e5-103">Добавление столбца GridView флажков (VB)</span><span class="sxs-lookup"><span data-stu-id="7a4e5-103">Adding a GridView Column of Checkboxes (VB)</span></span>

<span data-ttu-id="7a4e5-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="7a4e5-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="7a4e5-105">[Скачивание примера приложения](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_52_VB.exe) или [Загрузка PDF-файла](adding-a-gridview-column-of-checkboxes-vb/_static/datatutorial52vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="7a4e5-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_52_VB.exe) or [Download PDF](adding-a-gridview-column-of-checkboxes-vb/_static/datatutorial52vb1.pdf)</span></span>

> <span data-ttu-id="7a4e5-106">В этом учебнике рассматривается добавление столбца флажков к элементу управления GridView для предоставления пользователю интуитивно понятного способа выбора нескольких строк GridView.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-106">This tutorial looks at how to add a column of check boxes to a GridView control to provide the user with an intuitive way of selecting multiple rows of the GridView.</span></span>

## <a name="introduction"></a><span data-ttu-id="7a4e5-107">Введение</span><span class="sxs-lookup"><span data-stu-id="7a4e5-107">Introduction</span></span>

<span data-ttu-id="7a4e5-108">В предыдущем учебном курсе мы рассмотрели добавление столбца переключателей в GridView для выбора конкретной записи.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-108">In the preceding tutorial we examined how to add a column of radio buttons to the GridView for the purpose of selecting a particular record.</span></span> <span data-ttu-id="7a4e5-109">Столбец переключателей является подходящим пользовательским интерфейсом, когда пользователь ограничивает выбор только одного элемента из сетки.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-109">A column of radio buttons is a suitable user interface when the user is limited to choosing at most one item from the grid.</span></span> <span data-ttu-id="7a4e5-110">Однако иногда может потребоваться разрешить пользователю выбирать произвольное количество элементов из сетки.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-110">At times, however, we may want to allow the user to pick an arbitrary number of items from the grid.</span></span> <span data-ttu-id="7a4e5-111">Веб-клиенты электронной почты, например, обычно отображают список сообщений со столбцом флажков.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-111">Web-based email clients, for example, typically display the list of messages with a column of checkboxes.</span></span> <span data-ttu-id="7a4e5-112">Пользователь может выбрать произвольное число сообщений и выполнить некоторые действия, например переместить сообщения электронной почты в другую папку или удалить их.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-112">The user can select an arbitrary number of messages and then perform some action, such as moving the emails to another folder or deleting them.</span></span>

<span data-ttu-id="7a4e5-113">В этом учебнике будет показано, как добавить столбец флажков и определить, какие флажки были проверены при обратной передаче.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-113">In this tutorial we will see how to add a column of checkboxes and how to determine what checkboxes were checked on postback.</span></span> <span data-ttu-id="7a4e5-114">В частности, мы создадим пример, который точно имитирует пользовательский веб-интерфейс почтового клиента.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-114">In particular, we'll build an example that closely mimics the web-based email client user interface.</span></span> <span data-ttu-id="7a4e5-115">В нашем примере будет содержаться страница GridView со списком продуктов в таблице базы данных `Products` с флажком в каждой строке (см. рис. 1).</span><span class="sxs-lookup"><span data-stu-id="7a4e5-115">Our example will include a paged GridView listing the products in the `Products` database table with a checkbox in each row (see Figure 1).</span></span> <span data-ttu-id="7a4e5-116">При нажатии кнопки Удалить выбранные продукты будут удалены выбранные продукты.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-116">A Delete Selected Products button, when clicked, will delete those products selected.</span></span>

<span data-ttu-id="7a4e5-117">[![каждая строка продукта содержит флажок](adding-a-gridview-column-of-checkboxes-vb/_static/image1.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="7a4e5-117">[![Each Product Row Includes a Checkbox](adding-a-gridview-column-of-checkboxes-vb/_static/image1.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image1.png)</span></span>

<span data-ttu-id="7a4e5-118">**Рис. 1**. Каждая строка продукта содержит флажок ([щелкните, чтобы просмотреть изображение с полным размером](adding-a-gridview-column-of-checkboxes-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="7a4e5-118">**Figure 1**: Each Product Row Includes a Checkbox ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image2.png))</span></span>

## <a name="step-1-adding-a-paged-gridview-that-lists-product-information"></a><span data-ttu-id="7a4e5-119">Шаг 1. Добавление страничного GridView со списком сведений о продукте</span><span class="sxs-lookup"><span data-stu-id="7a4e5-119">Step 1: Adding a Paged GridView that Lists Product Information</span></span>

<span data-ttu-id="7a4e5-120">Прежде чем беспокоиться о добавлении столбца флажков, давайте рассмотрим список продуктов в элементе управления GridView, который поддерживает разбиение на страницы.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-120">Before we worry about adding a column of checkboxes, let s first focus on listing the products in a GridView that supports paging.</span></span> <span data-ttu-id="7a4e5-121">Для начала откройте страницу `CheckBoxField.aspx` в папке `EnhancedGridView` и перетащите элемент GridView с панели элементов в конструктор, установив для его `ID` значение `Products`.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-121">Start by opening the `CheckBoxField.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` to `Products`.</span></span> <span data-ttu-id="7a4e5-122">Затем выберите привязку GridView к новому элементу ObjectDataSource с именем `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-122">Next, choose to bind the GridView to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="7a4e5-123">Настройте ObjectDataSource для использования класса `ProductsBLL`, вызвав метод `GetProducts()` для возврата данных.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-123">Configure the ObjectDataSource to use the `ProductsBLL` class, calling the `GetProducts()` method to return the data.</span></span> <span data-ttu-id="7a4e5-124">Поскольку этот элемент GridView будет доступен только для чтения, установите в раскрывающихся списках на вкладках обновление, вставка и удаление значение (нет).</span><span class="sxs-lookup"><span data-stu-id="7a4e5-124">Since this GridView will be read-only, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>

<span data-ttu-id="7a4e5-125">[![создать новый элемент управления ObjectDataSource с именем Продуктсдатасаурце](adding-a-gridview-column-of-checkboxes-vb/_static/image2.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="7a4e5-125">[![Create a New ObjectDataSource Named ProductsDataSource](adding-a-gridview-column-of-checkboxes-vb/_static/image2.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image3.png)</span></span>

<span data-ttu-id="7a4e5-126">**Рис. 2**. Создание нового элемента управления ObjectDataSource с именем `ProductsDataSource` ([щелкните, чтобы просмотреть изображение с полным размером](adding-a-gridview-column-of-checkboxes-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="7a4e5-126">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image4.png))</span></span>

<span data-ttu-id="7a4e5-127">[![настроить ObjectDataSource для получения данных с помощью метода Products ()](adding-a-gridview-column-of-checkboxes-vb/_static/image3.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="7a4e5-127">[![Configure the ObjectDataSource to Retrieve Data Using the GetProducts() Method](adding-a-gridview-column-of-checkboxes-vb/_static/image3.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image5.png)</span></span>

<span data-ttu-id="7a4e5-128">**Рис. 3**. Настройка ObjectDataSource для получения данных с помощью метода `GetProducts()` ([щелкните, чтобы просмотреть изображение с полным размером](adding-a-gridview-column-of-checkboxes-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="7a4e5-128">**Figure 3**: Configure the ObjectDataSource to Retrieve Data Using the `GetProducts()` Method ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image6.png))</span></span>

<span data-ttu-id="7a4e5-129">[![установить в раскрывающихся списках на вкладках обновления, вставки и удаления значение (нет)](adding-a-gridview-column-of-checkboxes-vb/_static/image4.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="7a4e5-129">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](adding-a-gridview-column-of-checkboxes-vb/_static/image4.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image7.png)</span></span>

<span data-ttu-id="7a4e5-130">**Рис. 4**. Установка раскрывающихся списков на вкладках обновления, вставки и удаления в (нет) ([щелкните, чтобы просмотреть изображение с полным размером](adding-a-gridview-column-of-checkboxes-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="7a4e5-130">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image8.png))</span></span>

<span data-ttu-id="7a4e5-131">После завершения работы мастера настройки источника данных Visual Studio автоматически создаст Баундколумнс и Чеккбоксколумн для полей данных, связанных с продуктом.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-131">After completing the Configure Data Source wizard, Visual Studio will automatically create BoundColumns and a CheckBoxColumn for the product-related data fields.</span></span> <span data-ttu-id="7a4e5-132">Как и в предыдущем руководстве, удалите все, кроме `ProductName`, `CategoryName`и `UnitPrice` BoundFields, а также измените свойства `HeaderText` на "продукт", "Категория" и "цена".</span><span class="sxs-lookup"><span data-stu-id="7a4e5-132">Like we did in the previous tutorial, remove all but the `ProductName`, `CategoryName`, and `UnitPrice` BoundFields, and change the `HeaderText` properties to Product, Category, and Price.</span></span> <span data-ttu-id="7a4e5-133">Настройте `UnitPrice` BoundField, чтобы его значение было отформатировано как денежная единица.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-133">Configure the `UnitPrice` BoundField so that its value is formatted as a currency.</span></span> <span data-ttu-id="7a4e5-134">Также настройте GridView для поддержки разбиения на страницы, установив флажок Включить разбиение по страницам в смарт-теге.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-134">Also configure the GridView to support paging by checking the Enable Paging checkbox from the smart tag.</span></span>

<span data-ttu-id="7a4e5-135">Также добавим пользовательский интерфейс для удаления выбранных продуктов.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-135">Let s also add the user interface for deleting the selected products.</span></span> <span data-ttu-id="7a4e5-136">Добавьте элемент управления "Кнопка" под элементом GridView, установив для его `ID` значение `DeleteSelectedProducts` и его свойство `Text`, чтобы удалить выбранные продукты.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-136">Add a Button Web control beneath the GridView, setting its `ID` to `DeleteSelectedProducts` and its `Text` property to Delete Selected Products.</span></span> <span data-ttu-id="7a4e5-137">Вместо фактического удаления продуктов из базы данных в этом примере будет просто отображено сообщение с информацией о продуктах, которые были бы удалены.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-137">Rather than actually deleting products from the database, for this example we'll just display a message stating the products that would have been deleted.</span></span> <span data-ttu-id="7a4e5-138">Для этого добавьте элемент управления Label под кнопкой.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-138">To accommodate this, add a Label Web control beneath the Button.</span></span> <span data-ttu-id="7a4e5-139">Задайте для его идентификатора значение `DeleteResults`, очистите свойство `Text` и задайте для его свойства `Visible` и `EnableViewState` значение `False`.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-139">Set its ID to `DeleteResults`, clear out its `Text` property, and set its `Visible` and `EnableViewState` properties to `False`.</span></span>

<span data-ttu-id="7a4e5-140">После внесения этих изменений декларативная разметка GridView, ObjectDataSource, Button и Label должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="7a4e5-140">After making these changes, the GridView, ObjectDataSource, Button, and Label s declarative markup should similar to the following:</span></span>

[!code-aspx[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample1.aspx)]

<span data-ttu-id="7a4e5-141">Уделите время просмотру страницы в браузере (см. рис. 5).</span><span class="sxs-lookup"><span data-stu-id="7a4e5-141">Take a moment to view the page in a browser (see Figure 5).</span></span> <span data-ttu-id="7a4e5-142">На этом этапе вы увидите имя, категорию и цену первых десяти продуктов.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-142">At this point you should see the name, category, and price of the first ten products.</span></span>

<span data-ttu-id="7a4e5-143">[![указаны имя, Категория и цена первых десяти продуктов](adding-a-gridview-column-of-checkboxes-vb/_static/image5.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="7a4e5-143">[![The Name, Category, and Price of the First Ten Products are Listed](adding-a-gridview-column-of-checkboxes-vb/_static/image5.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image9.png)</span></span>

<span data-ttu-id="7a4e5-144">**Рис. 5**. список названий, категорий и цен первых десяти продуктов ([щелкните, чтобы просмотреть изображение с полным размером](adding-a-gridview-column-of-checkboxes-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="7a4e5-144">**Figure 5**: The Name, Category, and Price of the First Ten Products are Listed ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image10.png))</span></span>

## <a name="step-2-adding-a-column-of-checkboxes"></a><span data-ttu-id="7a4e5-145">Шаг 2. Добавление столбца флажков</span><span class="sxs-lookup"><span data-stu-id="7a4e5-145">Step 2: Adding a Column of Checkboxes</span></span>

<span data-ttu-id="7a4e5-146">Поскольку ASP.NET 2,0 включает CheckBoxField, можно предположить, что он может использоваться для добавления столбца флажков в GridView.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-146">Since ASP.NET 2.0 includes a CheckBoxField, one might think that it could be used to add a column of checkboxes to a GridView.</span></span> <span data-ttu-id="7a4e5-147">К сожалению, это не так, так как CheckBoxField предназначен для работы с логическими полями данных.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-147">Unfortunately, that is not the case, as the CheckBoxField is designed to work with a Boolean data field.</span></span> <span data-ttu-id="7a4e5-148">То есть, чтобы использовать CheckBoxField, необходимо указать базовое поле данных, к значению которого обращается, чтобы определить, установлен ли флажок для визуализации.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-148">That is, in order to use the CheckBoxField we must specify the underlying data field whose value is consulted to determine whether the rendered checkbox is checked.</span></span> <span data-ttu-id="7a4e5-149">Мы не можем использовать CheckBoxField, чтобы просто включить столбец непроверенных флажков.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-149">We cannot use the CheckBoxField to just include a column of unchecked checkboxes.</span></span>

<span data-ttu-id="7a4e5-150">Вместо этого необходимо добавить TemplateField и добавить в его `ItemTemplate`веб-элемент управления CheckBox.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-150">Instead, we must add a TemplateField and add a CheckBox Web control to its `ItemTemplate`.</span></span> <span data-ttu-id="7a4e5-151">Добавьте TemplateField в `Products` GridView и сделайте его первым (крайним левым) полем.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-151">Go ahead and add a TemplateField to the `Products` GridView and make it the first (far-left) field.</span></span> <span data-ttu-id="7a4e5-152">Из смарт-тега GridView s щелкните ссылку Edit Templates (изменить шаблоны), а затем перетащите элемент управления CheckBox из панели элементов в `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-152">From the GridView s smart tag, click on the Edit Templates link and then drag a CheckBox Web control from the Toolbox into the `ItemTemplate`.</span></span> <span data-ttu-id="7a4e5-153">Установите этот флажок s `ID` для свойства `ProductSelector`.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-153">Set this CheckBox s `ID` property to `ProductSelector`.</span></span>

<span data-ttu-id="7a4e5-154">[![добавить веб-элемент управления CheckBox с именем Продуктселектор в TemplateField s ItemTemplate](adding-a-gridview-column-of-checkboxes-vb/_static/image6.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="7a4e5-154">[![Add a CheckBox Web Control Named ProductSelector to the TemplateField s ItemTemplate](adding-a-gridview-column-of-checkboxes-vb/_static/image6.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image11.png)</span></span>

<span data-ttu-id="7a4e5-155">**Рис. 6**. Добавление веб-элемента управления CheckBox с именем `ProductSelector` в `ItemTemplate` TemplateField s ([щелкните, чтобы просмотреть изображение с полным размером](adding-a-gridview-column-of-checkboxes-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="7a4e5-155">**Figure 6**: Add a CheckBox Web Control Named `ProductSelector` to the TemplateField s `ItemTemplate` ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image12.png))</span></span>

<span data-ttu-id="7a4e5-156">После добавления TemplateField и веб-элемента управления CheckBox каждая строка включает флажок.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-156">With the TemplateField and CheckBox Web control added, each row now includes a checkbox.</span></span> <span data-ttu-id="7a4e5-157">На рис. 7 показана эта страница при просмотре в браузере после добавления TemplateField и CheckBox.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-157">Figure 7 shows this page, when viewed through a browser, after the TemplateField and CheckBox have been added.</span></span>

<span data-ttu-id="7a4e5-158">[![каждая строка продуктов теперь содержит флажок](adding-a-gridview-column-of-checkboxes-vb/_static/image7.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="7a4e5-158">[![Each Product Row Now Includes a Checkbox](adding-a-gridview-column-of-checkboxes-vb/_static/image7.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image13.png)</span></span>

<span data-ttu-id="7a4e5-159">**Рис. 7**. Теперь каждая строка продукта содержит флажок ([щелкните, чтобы просмотреть изображение с полным размером](adding-a-gridview-column-of-checkboxes-vb/_static/image14.png)).</span><span class="sxs-lookup"><span data-stu-id="7a4e5-159">**Figure 7**: Each Product Row Now Includes a Checkbox ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image14.png))</span></span>

## <a name="step-3-determining-what-checkboxes-were-checked-on-postback"></a><span data-ttu-id="7a4e5-160">Шаг 3. Определение флажков, которые были проверены при обратной передаче</span><span class="sxs-lookup"><span data-stu-id="7a4e5-160">Step 3: Determining What Checkboxes Were Checked On Postback</span></span>

<span data-ttu-id="7a4e5-161">На этом этапе у нас есть столбец флажков, но нет способа определить, какие флажки были проверены при обратной передаче.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-161">At this point we have a column of checkboxes but no way to determine what checkboxes were checked on postback.</span></span> <span data-ttu-id="7a4e5-162">Однако при нажатии кнопки Удалить выбранные продукты необходимо знать, какие флажки были проверены, чтобы удалить эти продукты.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-162">When the Delete Selected Products button is clicked, though, we need to know what checkboxes were checked in order to delete those products.</span></span>

<span data-ttu-id="7a4e5-163">[Свойство`Rows`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows.aspx) GridView s предоставляет доступ к строкам данных в GridView.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-163">The GridView s [`Rows` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows.aspx) provides access to the data rows in the GridView.</span></span> <span data-ttu-id="7a4e5-164">Можно выполнить итерацию по этим строкам, программно получить доступ к элементу управления CheckBox, а затем обратиться к свойству `Checked`, чтобы определить, выбран ли флажок.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-164">We can iterate through these rows, programmatically access the CheckBox control, and then consult its `Checked` property to determine whether the CheckBox has been selected.</span></span>

<span data-ttu-id="7a4e5-165">Создайте обработчик событий для `Click` события `DeleteSelectedProducts` Web Control Button и добавьте следующий код:</span><span class="sxs-lookup"><span data-stu-id="7a4e5-165">Create an event handler for the `DeleteSelectedProducts` Button Web control s `Click` event and add the following code:</span></span>

[!code-vb[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample2.vb)]

<span data-ttu-id="7a4e5-166">Свойство `Rows` Возвращает коллекцию экземпляров `GridViewRow`, описывающего строки данных GridView s.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-166">The `Rows` property returns a collection of `GridViewRow` instances that makeup the GridView s data rows.</span></span> <span data-ttu-id="7a4e5-167">В этом цикле `For Each` перечисление этой коллекции.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-167">The `For Each` loop here enumerates this collection.</span></span> <span data-ttu-id="7a4e5-168">Для каждого `GridViewRow` объекта флажок Row s программным способом обращается с помощью `row.FindControl("controlID")`.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-168">For each `GridViewRow` object, the row s CheckBox is programmatically accessed using `row.FindControl("controlID")`.</span></span> <span data-ttu-id="7a4e5-169">Если флажок установлен, то строка s, соответствующая `ProductID` значение, извлекается из коллекции `DataKeys`.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-169">If the CheckBox is checked, the row s corresponding `ProductID` value is retrieved from the `DataKeys` collection.</span></span> <span data-ttu-id="7a4e5-170">В этом упражнении мы просто отображаем информативное сообщение в метке `DeleteResults`, хотя в работающем приложении вместо этого выполняется вызов метода `ProductsBLL` класса s `DeleteProduct(productID)`.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-170">In this exercise, we simply display an informative message in the `DeleteResults` Label, although in a working application we d instead make a call to the `ProductsBLL` class s `DeleteProduct(productID)` method.</span></span>

<span data-ttu-id="7a4e5-171">После добавления этого обработчика событий после нажатия кнопки Удалить выбранные продукты отображается `ProductID` s выбранных продуктов.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-171">With the addition of this event handler, clicking the Delete Selected Products button now displays the `ProductID` s of the selected products.</span></span>

<span data-ttu-id="7a4e5-172">[![при нажатии кнопки Удалить выбранные продукты отображаются продукты ProductID.](adding-a-gridview-column-of-checkboxes-vb/_static/image8.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="7a4e5-172">[![When the Delete Selected Products Button is Clicked the Selected Products ProductIDs are Listed](adding-a-gridview-column-of-checkboxes-vb/_static/image8.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image15.png)</span></span>

<span data-ttu-id="7a4e5-173">**Рис. 8**. при нажатии кнопки Удалить выбранные продукты отображаются выбранные продукты `ProductID` s ([щелкните, чтобы просмотреть изображение с полным размером](adding-a-gridview-column-of-checkboxes-vb/_static/image16.png)).</span><span class="sxs-lookup"><span data-stu-id="7a4e5-173">**Figure 8**: When the Delete Selected Products Button is Clicked the Selected Products `ProductID` s are Listed ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image16.png))</span></span>

## <a name="step-4-adding-check-all-and-uncheck-all-buttons"></a><span data-ttu-id="7a4e5-174">Шаг 4. Добавление кнопок "проверить все" и "снять все"</span><span class="sxs-lookup"><span data-stu-id="7a4e5-174">Step 4: Adding Check All and Uncheck All Buttons</span></span>

<span data-ttu-id="7a4e5-175">Если пользователь хочет удалить все продукты на текущей странице, он должен проверить каждый из десяти флажков.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-175">If a user wants to delete all products on the current page, they must check each of the ten checkboxes.</span></span> <span data-ttu-id="7a4e5-176">Мы можем помочь ускорить этот процесс, добавив кнопку Проверить все, которая при нажатии устанавливает все флажки в сетке.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-176">We can help expedite this process by adding a Check All button that, when clicked, selects all of the checkboxes in the grid.</span></span> <span data-ttu-id="7a4e5-177">Кнопка снять все будет так же полезной.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-177">An Uncheck All button would be equally helpful.</span></span>

<span data-ttu-id="7a4e5-178">Добавьте на страницу два веб-элемента управления Button, поместив их над GridView.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-178">Add two Button Web controls to the page, placing them above the GridView.</span></span> <span data-ttu-id="7a4e5-179">Установите первый `ID` s в `CheckAll` и его свойство `Text`, чтобы проверить все. Задайте для второго `ID` s значение `UncheckAll` и его свойство `Text`, чтобы снять все флажки.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-179">Set the first one s `ID` to `CheckAll` and its `Text` property to Check All ; set the second one s `ID` to `UncheckAll` and its `Text` property to Uncheck All .</span></span>

[!code-aspx[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample3.aspx)]

<span data-ttu-id="7a4e5-180">Затем создайте метод в классе кода программной части с именем `ToggleCheckState(checkState)`, который при вызове перечисляет коллекцию `Products` GridView s `Rows` коллекции и устанавливает для каждого свойства CheckBox `Checked` значение переданного параметра *свойство CheckState* .</span><span class="sxs-lookup"><span data-stu-id="7a4e5-180">Next, create a method in the code-behind class named `ToggleCheckState(checkState)` that, when invoked, enumerates the `Products` GridView s `Rows` collection and sets each CheckBox s `Checked` property to the value of the passed in *checkState* parameter.</span></span>

[!code-vb[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample4.vb)]

<span data-ttu-id="7a4e5-181">Затем создайте `Click` обработчики событий для кнопок `CheckAll` и `UncheckAll`.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-181">Next, create `Click` event handlers for the `CheckAll` and `UncheckAll` buttons.</span></span> <span data-ttu-id="7a4e5-182">В обработчике событий `CheckAll` s просто вызовите `ToggleCheckState(True)`. в `UncheckAll`вызовите `ToggleCheckState(False)`.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-182">In `CheckAll` s event handler, simply call `ToggleCheckState(True)`; in `UncheckAll`, call `ToggleCheckState(False)`.</span></span>

[!code-vb[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample5.vb)]

<span data-ttu-id="7a4e5-183">С помощью этого кода нажатие кнопки Проверить все вызывает обратную передачу и проверяет все флажки в GridView.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-183">With this code, clicking the Check All button causes a postback and checks all of the checkboxes in the GridView.</span></span> <span data-ttu-id="7a4e5-184">Аналогичным образом, установив флажок снять все флажки отменить все.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-184">Likewise, clicking Uncheck All unselects all checkboxes.</span></span> <span data-ttu-id="7a4e5-185">На рис. 9 показан экран после проверки кнопки Проверить все.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-185">Figure 9 shows the screen after the Check All button has been checked.</span></span>

<span data-ttu-id="7a4e5-186">[![нажатии кнопки "проверить все", выбирают все флажки](adding-a-gridview-column-of-checkboxes-vb/_static/image9.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="7a4e5-186">[![Clicking the Check All Button Selects All Checkboxes](adding-a-gridview-column-of-checkboxes-vb/_static/image9.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image17.png)</span></span>

<span data-ttu-id="7a4e5-187">**Рис. 9**. нажатие кнопки "проверить все" устанавливает все флажки ([щелкните, чтобы просмотреть изображение с полным размером](adding-a-gridview-column-of-checkboxes-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="7a4e5-187">**Figure 9**: Clicking the Check All Button Selects All Checkboxes ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="7a4e5-188">При отображении столбца флажков одним из подходов к выбору или снятию флажков является наличие флажка в строке заголовка.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-188">When displaying a column of checkboxes, one approach for selecting or unselecting all of the checkboxes is through a checkbox in the header row.</span></span> <span data-ttu-id="7a4e5-189">Более того, для текущей реализации проверки все или снять все требуется обратная передача.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-189">Moreover, the current Check All / Uncheck All implementation requires a postback.</span></span> <span data-ttu-id="7a4e5-190">Все флажки можно установить или снять, но полностью с помощью клиентского сценария, тем самым обеспечивая шустрее взаимодействие с пользователем.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-190">The checkboxes can be checked or unchecked, however, entirely through client-side script, thereby providing a snappier user experience.</span></span> <span data-ttu-id="7a4e5-191">Чтобы узнать больше об использовании флажка строки заголовка для получения подробных сведений о всех возможностях и подробном рассмотрении использования методов на стороне клиента, изучите флажок Проверять [все флажки в GridView с помощью клиентского скрипта и флажка проверить все](http://aspnet.4guysfromrolla.com/articles/053106-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="7a4e5-191">To explore using a header row checkbox for Check All and Uncheck All in detail, along with a discussion on using client-side techniques, check out [Checking All CheckBoxes in a GridView Using Client-Side Script and a Check All CheckBox](http://aspnet.4guysfromrolla.com/articles/053106-1.aspx).</span></span>

## <a name="summary"></a><span data-ttu-id="7a4e5-192">Сводка</span><span class="sxs-lookup"><span data-stu-id="7a4e5-192">Summary</span></span>

<span data-ttu-id="7a4e5-193">В случаях, когда необходимо разрешить пользователям выбирать произвольное число строк из элемента управления GridView перед продолжением, Добавление столбца флажков является одним из вариантов.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-193">In cases where you need to let users choose an arbitrary number of rows from a GridView before proceeding, adding a column of checkboxes is one option.</span></span> <span data-ttu-id="7a4e5-194">Как мы видели в этом учебнике, включая столбец флажков в GridView, добавляет TemplateField с веб-элементом управления CheckBox.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-194">As we saw in this tutorial, including a column of checkboxes in the GridView entails adding a TemplateField with a CheckBox Web control.</span></span> <span data-ttu-id="7a4e5-195">С помощью веб-элемента управления (по сравнению с внедрением разметки непосредственно в шаблон, как мы делали в предыдущем учебном курсе) ASP.NET автоматически запоминает, какие флажки были и не проверялись в обратной передаче.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-195">By using a Web control (versus injecting markup directly into the template, as we did in the previous tutorial) ASP.NET automatically remembers what CheckBoxes were and were not checked across postback.</span></span> <span data-ttu-id="7a4e5-196">Можно также программно получить доступ к флажкам в коде, чтобы определить, установлен ли данный флажок, или изменить состояние проверки.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-196">We can also programmatically access the CheckBoxes in code to determine whether a given CheckBox is checked, or to change the checked state.</span></span>

<span data-ttu-id="7a4e5-197">Это руководство и Последнее из них рассмотрели добавление столбца селектора строк в GridView.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-197">This tutorial and the last one looked at adding a row selector column to the GridView.</span></span> <span data-ttu-id="7a4e5-198">В следующем учебном курсе мы рассмотрим, как с небольшой работой мы можем добавить возможности вставки в GridView.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-198">In our next tutorial we'll examine how, with a bit of work, we can add inserting capabilities to the GridView.</span></span>

<span data-ttu-id="7a4e5-199">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="7a4e5-199">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="7a4e5-200">Об авторе</span><span class="sxs-lookup"><span data-stu-id="7a4e5-200">About the Author</span></span>

<span data-ttu-id="7a4e5-201">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-201">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="7a4e5-202">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="7a4e5-202">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="7a4e5-203">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="7a4e5-203">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="7a4e5-204">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7a4e5-204">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="7a4e5-205">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="7a4e5-205">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="7a4e5-206">[Назад](adding-a-gridview-column-of-radio-buttons-vb.md)
> [Вперед](inserting-a-new-record-from-the-gridview-s-footer-vb.md)</span><span class="sxs-lookup"><span data-stu-id="7a4e5-206">[Previous](adding-a-gridview-column-of-radio-buttons-vb.md)
[Next](inserting-a-new-record-from-the-gridview-s-footer-vb.md)</span></span>
