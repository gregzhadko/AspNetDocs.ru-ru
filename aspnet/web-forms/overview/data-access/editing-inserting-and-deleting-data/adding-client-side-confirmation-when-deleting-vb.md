---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
title: Добавление подтверждения на стороне клиента при удалении (VB) | Документация Майкрософт
author: rick-anderson
description: В созданных ранее интерфейсах пользователь может случайно удалить данные, нажав кнопку Удалить, когда они намерены нажать кнопку Изменить. В этом t...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 6331e02e-c465-4cdf-bd3f-f07680c289d6
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: addb5a1fdc5793309388c5f06b44fb3b145bc102
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74589352"
---
# <a name="adding-client-side-confirmation-when-deleting-vb"></a><span data-ttu-id="6f7cc-104">Добавление клиентского подтверждения при удалении (VB)</span><span class="sxs-lookup"><span data-stu-id="6f7cc-104">Adding Client-Side Confirmation When Deleting (VB)</span></span>

<span data-ttu-id="6f7cc-105">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="6f7cc-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="6f7cc-106">[Скачивание примера приложения](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) или [Загрузка PDF-файла](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="6f7cc-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) or [Download PDF](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span></span>

> <span data-ttu-id="6f7cc-107">В созданных ранее интерфейсах пользователь может случайно удалить данные, нажав кнопку Удалить, когда они намерены нажать кнопку Изменить.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-107">In the interfaces we've created so far, a user can accidentally delete data by clicking the Delete button when they meant to click the Edit button.</span></span> <span data-ttu-id="6f7cc-108">В этом учебнике мы добавим диалоговое окно подтверждения на стороне клиента, которое появляется при нажатии кнопки Удалить.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-108">In this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>

## <a name="introduction"></a><span data-ttu-id="6f7cc-109">Введение</span><span class="sxs-lookup"><span data-stu-id="6f7cc-109">Introduction</span></span>

<span data-ttu-id="6f7cc-110">В нескольких прошлых учебных курсах мы видели, как использовать нашу архитектуру приложения, ObjectDataSource и веб-элементы управления данными, чтобы обеспечить возможности вставки, редактирования и удаления.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-110">Over the past several tutorials we ve seen how to use our application architecture, ObjectDataSource, and the data Web controls in concert to provide inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="6f7cc-111">Интерфейсы удаления, которые мы Просмотрели ранее, состояли из кнопки Delete, которая при нажатии вызывает обратную передачу и вызывает метод ObjectDataSource `Delete()`.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-111">The deleting interfaces we ve examined thus far have been composed of a Delete button that, when clicked, causes a postback and invokes the ObjectDataSource s `Delete()` method.</span></span> <span data-ttu-id="6f7cc-112">Затем метод `Delete()` вызывает настроенный метод из уровня бизнес-логики, который распространяет вызов на уровень доступа к данным, выдавая фактическую инструкцию `DELETE` в базу данных.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-112">The `Delete()` method then invokes the configured method from the Business Logic Layer, which propagates the call down to the Data Access Layer, issuing the actual `DELETE` statement to the database.</span></span>

<span data-ttu-id="6f7cc-113">Хотя этот пользовательский интерфейс позволяет посетителям удалять записи с помощью элементов управления GridView, DetailsView или FormView, он не имеет какого-либо подтверждения, когда пользователь нажимает кнопку "Удалить".</span><span class="sxs-lookup"><span data-stu-id="6f7cc-113">While this user interface enables visitors to delete records through the GridView, DetailsView, or FormView controls, it lacks any sort of confirmation when the user clicks the Delete button.</span></span> <span data-ttu-id="6f7cc-114">Если пользователь нажал кнопку "Удалить", когда он нажимает кнопку "Изменить", то запись, которую они хотели обновить, будет удалена.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-114">If a user accidentally clicks the Delete button when they meant to click Edit, the record they meant to update will instead be deleted.</span></span> <span data-ttu-id="6f7cc-115">Чтобы помочь предотвратить это, в этом учебнике мы добавим диалоговое окно подтверждения на стороне клиента, которое появляется при нажатии кнопки Удалить.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-115">To help prevent this, in this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>

<span data-ttu-id="6f7cc-116">Функция JavaScript `confirm(string)` выводит свой Строковый входной параметр как текст внутри модального диалогового окна, который оснащен двумя кнопками — ОК и Отмена (см. рис. 1).</span><span class="sxs-lookup"><span data-stu-id="6f7cc-116">The JavaScript `confirm(string)` function displays its string input parameter as the text inside a modal dialog box that comes equipped with two buttons - OK and Cancel (see Figure 1).</span></span> <span data-ttu-id="6f7cc-117">Функция `confirm(string)` возвращает логическое значение в зависимости от того, какая кнопка нажата (`true`, если пользователь нажимает кнопку ОК, и `false` при нажатии кнопки Отмена).</span><span class="sxs-lookup"><span data-stu-id="6f7cc-117">The `confirm(string)` function returns a Boolean value depending on what button is clicked (`true`, if the user clicks OK, and `false` if they click Cancel).</span></span>

![Метод Confirm (строка) JavaScript отображает модальное окно MessageBox на стороне клиента.](adding-client-side-confirmation-when-deleting-vb/_static/image1.png)

<span data-ttu-id="6f7cc-119">**Рис. 1**. метод JavaScript `confirm(string)` отображает модальное окно MessageBox на стороне клиента</span><span class="sxs-lookup"><span data-stu-id="6f7cc-119">**Figure 1**: The JavaScript `confirm(string)` Method Displays a Modal, Client-Side Messagebox</span></span>

<span data-ttu-id="6f7cc-120">Если при отправке формы значение `false` возвращается из обработчика событий на стороне клиента, отправка формы отменяется.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-120">During a form submission, if a value of `false` is returned from a client-side event handler then the form submission is cancelled.</span></span> <span data-ttu-id="6f7cc-121">С помощью этой функции можно использовать обработчик событий `onclick` на стороне клиента, чтобы получить значение вызова `confirm("Are you sure you want to delete this product?")`.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-121">Using this feature, we can have the Delete button s client-side `onclick` event handler return the value of a call to `confirm("Are you sure you want to delete this product?")`.</span></span> <span data-ttu-id="6f7cc-122">Если пользователь нажмет кнопку "Отмена", `confirm(string)` возвратит значение false, что приведет к отмене отправки формы.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-122">If the user clicks Cancel, `confirm(string)` will return false, thereby causing the form submission to cancel.</span></span> <span data-ttu-id="6f7cc-123">Если не выполнить обратную передачу, то продукт, кнопка удаления которого была нажата, не будет удален.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-123">With no postback, the product whose Delete button was clicked won't be deleted.</span></span> <span data-ttu-id="6f7cc-124">Однако если пользователь нажмет кнопку ОК в диалоговом окне подтверждения, обратная передача будет продолжена продолжится и продукт будет удален.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-124">If, however, the user clicks OK in the confirmation dialog box, the postback will continue unabated and the product will be deleted.</span></span> <span data-ttu-id="6f7cc-125">Дополнительные сведения об этом методе см. в статье [использование метода JavaScript `confirm()` для управления отправкой формы](http://www.webreference.com/programming/javascript/confirm/) .</span><span class="sxs-lookup"><span data-stu-id="6f7cc-125">Consult [Using JavaScript s `confirm()` Method to Control Form Submission](http://www.webreference.com/programming/javascript/confirm/) for more information on this technique.</span></span>

<span data-ttu-id="6f7cc-126">Добавление необходимого клиентского скрипта незначительно различается при использовании шаблонов, чем при использовании CommandField.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-126">Adding the necessary client-side script differs slightly if using templates than when using a CommandField.</span></span> <span data-ttu-id="6f7cc-127">Поэтому в этом учебнике мы рассмотрим пример FormView и GridView.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-127">Therefore, in this tutorial we will look at both a FormView and GridView example.</span></span>

> [!NOTE]
> <span data-ttu-id="6f7cc-128">Используя приемы подтверждения на стороне клиента, как описано в этом руководстве, предполагается, что пользователи посещались в браузерах, поддерживающих JavaScript, и что в них включен JavaScript.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-128">Using client-side confirmation techniques, like the ones discussed in this tutorial, assumes that your users are visiting with browsers that support JavaScript and that they have JavaScript enabled.</span></span> <span data-ttu-id="6f7cc-129">Если какое-либо из этих предположений не является верным для конкретного пользователя, нажатие кнопки удалить немедленно вызовет обратную передачу (не отображая окно подтверждения MessageBox).</span><span class="sxs-lookup"><span data-stu-id="6f7cc-129">If either of these assumptions are not true for a particular user, clicking the Delete button will immediately cause a postback (not displaying a confirm messagebox).</span></span>

## <a name="step-1-creating-a-formview-that-supports-deletion"></a><span data-ttu-id="6f7cc-130">Шаг 1. Создание элемента FormView, поддерживающего удаление</span><span class="sxs-lookup"><span data-stu-id="6f7cc-130">Step 1: Creating a FormView That Supports Deletion</span></span>

<span data-ttu-id="6f7cc-131">Начните с добавления FormView на страницу `ConfirmationOnDelete.aspx` в папке `EditInsertDelete`, привязывая ее к новому элементу ObjectDataSource, который извлекает сведения о продукте через метод `ProductsBLL` класса s `GetProducts()`.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-131">Start by adding a FormView to the `ConfirmationOnDelete.aspx` page in the `EditInsertDelete` folder, binding it to a new ObjectDataSource that pulls back the product information via the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="6f7cc-132">Также настройте ObjectDataSource таким образом, чтобы метод `ProductsBLL` классов `DeleteProduct(productID)` был сопоставлен с методом `Delete()` ObjectDataSource. Убедитесь, что в раскрывающихся списках INSERT и UPDATE задано значение (нет).</span><span class="sxs-lookup"><span data-stu-id="6f7cc-132">Also configure the ObjectDataSource so that the `ProductsBLL` class s `DeleteProduct(productID)` method is mapped to the ObjectDataSource s `Delete()` method; ensure that the INSERT and UPDATE tabs drop-down lists are set to (None).</span></span> <span data-ttu-id="6f7cc-133">Наконец, установите флажок Включить разбиение по страницам в смарт-теге FormView.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-133">Finally, check the Enable Paging checkbox in the FormView s smart tag.</span></span>

<span data-ttu-id="6f7cc-134">После выполнения этих действий Новая декларативная разметка ObjectDataSource s будет выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="6f7cc-134">After these steps, the new ObjectDataSource s declarative markup will look like the following:</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample1.aspx)]

<span data-ttu-id="6f7cc-135">Как и в наших прошлых примерах, не использующих оптимистичный параллелизм, необходимо очистить свойство `OldValuesParameterFormatString` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-135">As in our past examples that did not use optimistic concurrency, take a moment to clear out the ObjectDataSource s `OldValuesParameterFormatString` property.</span></span>

<span data-ttu-id="6f7cc-136">Поскольку она привязана к элементу управления ObjectDataSource, который поддерживает только удаление, `ItemTemplate` FormView содержит только кнопку Удалить, в которой отсутствуют кнопки New и Update.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-136">Since it has been bound to an ObjectDataSource control that only supports deleting, the FormView s `ItemTemplate` offers only the Delete button, lacking the New and Update buttons.</span></span> <span data-ttu-id="6f7cc-137">Однако декларативная разметка FormView содержит лишние `EditItemTemplate` и `InsertItemTemplate`, которые можно удалить.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-137">The FormView s declarative markup, however, includes a superfluous `EditItemTemplate` and `InsertItemTemplate`, which can be removed.</span></span> <span data-ttu-id="6f7cc-138">Настройте `ItemTemplate` таким образом, чтобы в нем было видно только подмножество полей данных продукта.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-138">Take a moment to customize the `ItemTemplate` so that is shows only a subset of the product data fields.</span></span> <span data-ttu-id="6f7cc-139">Я настроил, чтобы отображать название продукта в заголовке `<h3>` над именами поставщиков и категорий (вместе с кнопкой Удалить).</span><span class="sxs-lookup"><span data-stu-id="6f7cc-139">I ve configured mine to show the product s name in an `<h3>` heading above its supplier and category names (along with the Delete button).</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample2.aspx)]

<span data-ttu-id="6f7cc-140">С учетом этих изменений у нас есть полнофункциональная веб-страница, позволяющая пользователю последовательно переключаться по продуктам с возможностью удалить продукт, просто нажав кнопку Удалить.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-140">With these changes, we have a fully functional web page that allows a user to toggle through the products one at a time, with the ability to delete a product by simply clicking the Delete button.</span></span> <span data-ttu-id="6f7cc-141">На рис. 2 показан снимок экрана с ходом выполнения, который был на данный момент просмотрен в браузере.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-141">Figure 2 shows a screen shot of our progress thus far when viewed through a browser.</span></span>

<span data-ttu-id="6f7cc-142">[![FormView отображает сведения об одном продукте](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="6f7cc-142">[![The FormView Shows Information About a Single Product](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span></span>

<span data-ttu-id="6f7cc-143">**Рис. 2**. элемент FormView отображает сведения об одном продукте ([щелкните, чтобы просмотреть изображение с полным размером](adding-client-side-confirmation-when-deleting-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="6f7cc-143">**Figure 2**: The FormView Shows Information About a Single Product ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image4.png))</span></span>

## <a name="step-2-calling-the-confirmstring-function-from-the-delete-buttons-client-side-onclick-event"></a><span data-ttu-id="6f7cc-144">Шаг 2. вызов функции Confirm (String) из события нажатия кнопки Delete на стороне клиента</span><span class="sxs-lookup"><span data-stu-id="6f7cc-144">Step 2: Calling the confirm(string) Function from the Delete Buttons Client-Side onclick Event</span></span>

<span data-ttu-id="6f7cc-145">После создания FormView необходимо настроить кнопку Delete таким, что при щелчке посетителем вызывается функция JavaScript `confirm(string)`.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-145">With the FormView created, the final step is to configure the Delete button such that when it s clicked by the visitor, the JavaScript `confirm(string)` function is invoked.</span></span> <span data-ttu-id="6f7cc-146">Добавление клиентского скрипта к кнопке, `onclick` LinkButton или ImageButton на стороне клиента можно выполнить с помощью `OnClientClick property`, который является новым для ASP.NET 2,0.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-146">Adding client-side script to a Button, LinkButton, or ImageButton s client-side `onclick` event can be accomplished through the use of the `OnClientClick property`, which is new to ASP.NET 2.0.</span></span> <span data-ttu-id="6f7cc-147">Так как нам нужно возвращать значение функции `confirm(string)`, просто установите это свойство равным: `return confirm('Are you certain that you want to delete this product?');`</span><span class="sxs-lookup"><span data-stu-id="6f7cc-147">Since we want to have the value of the `confirm(string)` function returned, simply set this property to: `return confirm('Are you certain that you want to delete this product?');`</span></span>

<span data-ttu-id="6f7cc-148">После этого изменения декларативный синтаксис инструкции DELETE LinkButton должен выглядеть примерно так:</span><span class="sxs-lookup"><span data-stu-id="6f7cc-148">After this change the Delete LinkButton s declarative syntax should look something like:</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample3.aspx)]

<span data-ttu-id="6f7cc-149">Вот и все!</span><span class="sxs-lookup"><span data-stu-id="6f7cc-149">That s all there is to it!</span></span> <span data-ttu-id="6f7cc-150">На рис. 3 показан снимок экрана этого подтверждения в действии.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-150">Figure 3 shows a screen shot of this confirmation in action.</span></span> <span data-ttu-id="6f7cc-151">При нажатии кнопки "Удалить" открывается диалоговое окно подтверждения.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-151">Clicking the Delete button brings up the confirm dialog box.</span></span> <span data-ttu-id="6f7cc-152">Если пользователь нажмет кнопку Отмена, обратная передача отменяется и продукт не удаляется.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-152">If the user clicks Cancel, the postback is cancelled and the product is not deleted.</span></span> <span data-ttu-id="6f7cc-153">Однако если пользователь нажмет кнопку ОК, обратная передача продолжится и вызывается метод ObjectDataSource `Delete()`, улучшалась в удаляемой записи базы данных.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-153">If, however, the user clicks OK, the postback continues and the ObjectDataSource s `Delete()` method is invoked, culminating in the database record being deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="6f7cc-154">Строка, передаваемая в `confirm(string)` функцию JavaScript, отделяется апострофами (а не кавычками).</span><span class="sxs-lookup"><span data-stu-id="6f7cc-154">The string passed into the `confirm(string)` JavaScript function is delimited with apostrophes (rather than quotation marks).</span></span> <span data-ttu-id="6f7cc-155">В JavaScript строки можно разделять с помощью любого символа.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-155">In JavaScript, strings can be delimited using either character.</span></span> <span data-ttu-id="6f7cc-156">Здесь мы будем использовать апострофы, чтобы разделители для строки, передаваемой в `confirm(string)`, не выдавали неоднозначность с разделителями, используемыми для значения свойства `OnClientClick`.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-156">We use apostrophes here so that the delimiters for the string passed into `confirm(string)` do not introduce an ambiguity with the delimiters used for the `OnClientClick` property value.</span></span>

<span data-ttu-id="6f7cc-157">[![появится подтверждение при нажатии кнопки "Удалить"](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="6f7cc-157">[![A Confirmation is Now Displayed When Clicking the Delete Button](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span></span>

<span data-ttu-id="6f7cc-158">**Рис. 3**. Теперь при нажатии кнопки "Удалить" отображается подтверждение ([щелкните, чтобы просмотреть изображение с полным размером](adding-client-side-confirmation-when-deleting-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="6f7cc-158">**Figure 3**: A Confirmation is Now Displayed When Clicking the Delete Button ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image7.png))</span></span>

## <a name="step-3-configuring-the-onclientclick-property-for-the-delete-button-in-a-commandfield"></a><span data-ttu-id="6f7cc-159">Шаг 3. Настройка свойства OnClientClick для кнопки "Удалить" в CommandField</span><span class="sxs-lookup"><span data-stu-id="6f7cc-159">Step 3: Configuring the OnClientClick Property for the Delete Button in a CommandField</span></span>

<span data-ttu-id="6f7cc-160">При работе с кнопкой, LinkButton или ImageButton непосредственно в шаблоне можно связать с ним диалоговое окно подтверждения, просто настроив его свойство `OnClientClick` для возврата результатов функции `confirm(string)` JavaScript.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-160">When working with a Button, LinkButton, or ImageButton directly in a template, a confirmation dialog box can be associated with it by simply configuring its `OnClientClick` property to return the results of the JavaScript `confirm(string)` function.</span></span> <span data-ttu-id="6f7cc-161">Однако CommandField, который добавляет поле кнопок удаления в GridView или DetailsView, не имеет свойства `OnClientClick`, которое может быть задано декларативно.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-161">However, the CommandField - which adds a field of Delete buttons to a GridView or DetailsView - does not have an `OnClientClick` property that can be set declaratively.</span></span> <span data-ttu-id="6f7cc-162">Вместо этого необходимо программно ссылаться на кнопку Delete в соответствующем `DataBound` обработчике событий GridView или DetailsView, а затем установить его свойство `OnClientClick`.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-162">Instead, we must programmatically reference the Delete button in the GridView or DetailsView s appropriate `DataBound` event handler, and then set its `OnClientClick` property there.</span></span>

> [!NOTE]
> <span data-ttu-id="6f7cc-163">При установке свойства `OnClientClick` кнопки "Удалить" в соответствующем `DataBound` обработчике событий у нас есть доступ к данным, привязанным к текущей записи.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-163">When setting the Delete button s `OnClientClick` property in the appropriate `DataBound` event handler, we have access to the data was bound to the current record.</span></span> <span data-ttu-id="6f7cc-164">Это означает, что мы можем расширить сообщение с подтверждением, включив в него подробные сведения о конкретной записи, например: "вы действительно хотите удалить продукт Chai?"</span><span class="sxs-lookup"><span data-stu-id="6f7cc-164">This means we can extend the confirmation message to include details about the particular record, such as, "Are you sure you want to delete the Chai product?"</span></span> <span data-ttu-id="6f7cc-165">Такая настройка также возможна в шаблонах, использующих синтаксис привязки данных.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-165">Such customization is also possible in templates using databinding syntax.</span></span>

<span data-ttu-id="6f7cc-166">Чтобы попрактиковаться в установке свойства `OnClientClick` для кнопок удаления в CommandField, добавим GridView к странице.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-166">To practice setting the `OnClientClick` property for the Delete button(s) in a CommandField, let s add a GridView to the page.</span></span> <span data-ttu-id="6f7cc-167">Настройте этот элемент GridView для использования того же элемента управления ObjectDataSource, который используется FormView.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-167">Configure this GridView to use the same ObjectDataSource control that the FormView uses.</span></span> <span data-ttu-id="6f7cc-168">Также Ограничьте BoundFields GridView s, включив только название продукта, категорию и поставщика.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-168">Also limit the GridView s BoundFields to only include the product s name, category, and supplier.</span></span> <span data-ttu-id="6f7cc-169">Наконец, установите флажок Включить удаление из смарт-тега GridView s.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-169">Lastly, check the Enable Deleting checkbox from the GridView s smart tag.</span></span> <span data-ttu-id="6f7cc-170">Это приведет к добавлению CommandField в коллекцию GridView s `Columns` со свойством `ShowDeleteButton`, для которого задано значение `true`.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-170">This will add a CommandField to the GridView s `Columns` collection with its `ShowDeleteButton` property set to `true`.</span></span>

<span data-ttu-id="6f7cc-171">После внесения этих изменений декларативная разметка GridView s должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="6f7cc-171">After making these changes, your GridView s declarative markup should look like the following:</span></span>

[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample4.aspx)]

<span data-ttu-id="6f7cc-172">CommandField содержит единственный экземпляр delete LinkButton, доступ к которому можно получить программно из обработчика событий GridView `RowDataBound`.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-172">The CommandField contains a single Delete LinkButton instance that can be accessed programmatically from the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="6f7cc-173">После указания ссылки можно задать соответствующее свойство `OnClientClick`.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-173">Once referenced, we can set its `OnClientClick` property accordingly.</span></span> <span data-ttu-id="6f7cc-174">Создайте обработчик событий для `RowDataBound` события, используя следующий код:</span><span class="sxs-lookup"><span data-stu-id="6f7cc-174">Create an event handler for the `RowDataBound` event using the following code:</span></span>

[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample5.vb)]

<span data-ttu-id="6f7cc-175">Этот обработчик событий работает со строками данных (которые будут иметь кнопку «Удалить») и начинается с программной ссылки на кнопку «Удалить».</span><span class="sxs-lookup"><span data-stu-id="6f7cc-175">This event handler works with data rows (those that will have the Delete button) and begins by programmatically referencing the Delete button.</span></span> <span data-ttu-id="6f7cc-176">В общем случае используйте следующий шаблон:</span><span class="sxs-lookup"><span data-stu-id="6f7cc-176">In general use the following pattern:</span></span>

[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample6.vb)]

<span data-ttu-id="6f7cc-177">*ButtonType* — это тип кнопки, используемой CommandField-Button, LinkButton или ImageButton.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-177">*ButtonType* is the type of button being used by the CommandField - Button, LinkButton, or ImageButton.</span></span> <span data-ttu-id="6f7cc-178">По умолчанию CommandField использует элементы LinkButton, но это можно настроить с помощью CommandField `ButtonType property`.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-178">By default, the CommandField uses LinkButtons, but this can be customized via the CommandField s `ButtonType property`.</span></span> <span data-ttu-id="6f7cc-179">*Коммандфиелдиндекс* — это порядковый индекс CommandField в коллекции GridView `Columns`, а *контролиндекс* — индекс кнопки Delete в `Controls` коллекции CommandField.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-179">The *commandFieldIndex* is the ordinal index of the CommandField within the GridView s `Columns` collection, whereas the *controlIndex* is the index of the Delete button within the CommandField s `Controls` collection.</span></span> <span data-ttu-id="6f7cc-180">Значение *контролиндекс* зависит от положения кнопок относительно других кнопок в CommandField.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-180">The *controlIndex* value depends on the button s position relative to other buttons in the CommandField.</span></span> <span data-ttu-id="6f7cc-181">Например, если единственной кнопкой, отображаемой в CommandField, является кнопка Удалить, используйте индекс 0.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-181">For example, if the only button displayed in the CommandField is the Delete button, use an index of 0.</span></span> <span data-ttu-id="6f7cc-182">Однако если есть кнопка Изменить, предшествующая кнопке Удалить, используйте индекс 2.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-182">If, however, there s an Edit button that precedes the Delete button, use an index of 2.</span></span> <span data-ttu-id="6f7cc-183">Причина использования индекса 2 заключается в том, что CommandField добавляет два элемента управления перед кнопкой "Удалить": кнопка "Изменить" и Литералконтрол, которые использовались для добавления пробела между кнопками "Изменить" и "Удалить".</span><span class="sxs-lookup"><span data-stu-id="6f7cc-183">The reason an index of 2 is used is because two controls are added by the CommandField before the Delete button: the Edit button and a LiteralControl that s used to add some space between the Edit and Delete buttons.</span></span>

<span data-ttu-id="6f7cc-184">В нашем конкретном примере CommandField использует LinkButton и, является самым левым полем, имеет *коммандфиелдиндекс* 0.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-184">For our particular example, the CommandField uses LinkButtons and, being the left-most field, has a *commandFieldIndex* of 0.</span></span> <span data-ttu-id="6f7cc-185">Поскольку нет других кнопок, но в CommandField используется кнопка Удалить, мы используем *контролиндекс* 0.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-185">Since there are no other buttons but the Delete button in the CommandField, we use a *controlIndex* of 0.</span></span>

<span data-ttu-id="6f7cc-186">После того как вы ссылаетесь на кнопку Delete (удалить) в CommandField, мы следующим заносим сведения о продукте, привязанном к текущей строке GridView.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-186">After referencing the Delete button in the CommandField, we next grab information about the product bound to the current GridView row.</span></span> <span data-ttu-id="6f7cc-187">Наконец, мы присвоим свойству `OnClientClick` "Удалить" соответствующий код JavaScript, который включает название продукта.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-187">Finally, we set the Delete button s `OnClientClick` property to the appropriate JavaScript, which includes the product s name.</span></span> <span data-ttu-id="6f7cc-188">Так как строка JavaScript, передаваемая в функцию `confirm(string)`, отделяется с помощью апострофов, необходимо экранировать все апострофы, которые появляются в названии продукта.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-188">Since the JavaScript string passed into the `confirm(string)` function is delimited using apostrophes we must escape any apostrophes that appear within the product s name.</span></span> <span data-ttu-id="6f7cc-189">В частности, любые апострофы в названии продукта преобразуются в escape-символы с помощью "`\'`".</span><span class="sxs-lookup"><span data-stu-id="6f7cc-189">In particular, any apostrophes in the product s name are escaped with "`\'`".</span></span>

<span data-ttu-id="6f7cc-190">После завершения этих изменений при нажатии кнопки Удалить в элементе GridView отображается настроенное диалоговое окно подтверждения (см. рис. 4).</span><span class="sxs-lookup"><span data-stu-id="6f7cc-190">With these changes complete, clicking on a Delete button in the GridView displays a customized confirmation dialog box (see Figure 4).</span></span> <span data-ttu-id="6f7cc-191">Как и в случае с подтверждением MessageBox из FormView, если пользователь нажимает кнопку Отменить, то отмена обратной передачи отменяется, тем самым предотвращая ее удаление.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-191">As with the confirmation messagebox from the FormView, if the user clicks Cancel the postback is cancelled, thereby preventing the deletion from occurring.</span></span>

> [!NOTE]
> <span data-ttu-id="6f7cc-192">Этот метод также можно использовать для программного доступа к кнопке Delete в CommandField в элементе DetailsView.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-192">This technique can also be used to programmatically access the Delete button in the CommandField in a DetailsView.</span></span> <span data-ttu-id="6f7cc-193">Однако для элемента DetailsView вы создаете обработчик события `DataBound`, так как элемент DetailsView не имеет события `RowDataBound`.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-193">For the DetailsView, however, you d create an event handler for the `DataBound` event, since the DetailsView does not have a `RowDataBound` event.</span></span>

<span data-ttu-id="6f7cc-194">[![нажатии кнопки GridView s удалить отображается настроенное диалоговое окно подтверждения](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="6f7cc-194">[![Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span></span>

<span data-ttu-id="6f7cc-195">**Рис. 4**. при нажатии кнопки GridView s Delete отображается настроенное диалоговое окно подтверждения ([щелкните, чтобы просмотреть изображение с полным размером](adding-client-side-confirmation-when-deleting-vb/_static/image10.png)).</span><span class="sxs-lookup"><span data-stu-id="6f7cc-195">**Figure 4**: Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image10.png))</span></span>

## <a name="using-templatefields"></a><span data-ttu-id="6f7cc-196">Использование полей TemplateField</span><span class="sxs-lookup"><span data-stu-id="6f7cc-196">Using TemplateFields</span></span>

<span data-ttu-id="6f7cc-197">Одним из недостатков CommandField является то, что его кнопки должны быть доступны через индексирование и что полученный объект должен быть приведен к соответствующему типу кнопки (Button, LinkButton или ImageButton).</span><span class="sxs-lookup"><span data-stu-id="6f7cc-197">One of the disadvantages of the CommandField is that its buttons must be accessed through indexing and that the resulting object must be cast to the appropriate button type (Button, LinkButton, or ImageButton).</span></span> <span data-ttu-id="6f7cc-198">Использование "магическых номеров" и жестко запрограммированных типов приглашает к проблемам, которые не удается обнаружить до выполнения.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-198">Using "magic numbers" and hard-coded types invites problems that cannot be discovered until runtime.</span></span> <span data-ttu-id="6f7cc-199">Например, если вы или другой разработчик добавляете новые кнопки к CommandField в какой-либо момент в будущем (например, кнопку "Изменить") или изменяете свойство `ButtonType`, существующий код по-прежнему будет компилироваться без ошибок, но посещение страницы может вызвать исключение или непредвиденное поведение в зависимости от того, как был написан код и какие изменения были внесены.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-199">For example, if you, or another developer, adds new buttons to the CommandField at some point in the future (such as an Edit button) or changes the `ButtonType` property, the existing code will still compile without error, but visiting the page may cause an exception or unexpected behavior, depending on how your code was written and what changes were made.</span></span>

<span data-ttu-id="6f7cc-200">Альтернативный подход заключается в преобразовании GridView и DetailsView s Коммандфиелдс в полей TemplateField.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-200">An alternative approach is to convert the GridView and DetailsView s CommandFields into TemplateFields.</span></span> <span data-ttu-id="6f7cc-201">Это приведет к формированию TemplateField с `ItemTemplate` с LinkButton (или кнопкой или ImageButton) для каждой кнопки в CommandField.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-201">This will generate a TemplateField with an `ItemTemplate` that has a LinkButton (or Button or ImageButton) for each button in the CommandField.</span></span> <span data-ttu-id="6f7cc-202">Эти кнопки `OnClientClick` свойства могут быть назначены декларативно, как мы видели в FormView, или могут быть программно доступны в соответствующем `DataBound` обработчике событий, используя следующий шаблон:</span><span class="sxs-lookup"><span data-stu-id="6f7cc-202">These buttons `OnClientClick` properties can be assigned declaratively, as we saw with the FormView, or can be programmatically accessed in the appropriate `DataBound` event handler using the following pattern:</span></span>

[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample7.vb)]

<span data-ttu-id="6f7cc-203">Где *ControlID* — это значение свойства `ID` Button.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-203">Where *controlID* is the value of the button s `ID` property.</span></span> <span data-ttu-id="6f7cc-204">Хотя этому шаблону по-прежнему требуется жестко заданный тип для приведения, он устраняет необходимость в индексировании, позволяя изменять макет, не выполняя ошибку во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-204">While this pattern still requires a hard-coded type for the cast, it removes the need for indexing, allowing for the layout to change without resulting in a runtime error.</span></span>

## <a name="summary"></a><span data-ttu-id="6f7cc-205">Сводка</span><span class="sxs-lookup"><span data-stu-id="6f7cc-205">Summary</span></span>

<span data-ttu-id="6f7cc-206">Функция JavaScript `confirm(string)` — широко распространенный способ управления рабочим процессом отправки формы.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-206">The JavaScript `confirm(string)` function is a commonly used technique for controlling form submission workflow.</span></span> <span data-ttu-id="6f7cc-207">При выполнении функции отображается модальное диалоговое окно на стороне клиента, содержащее две кнопки: ОК и Отмена.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-207">When executed, the function displays a modal, client-side dialog box that includes two buttons, OK and Cancel.</span></span> <span data-ttu-id="6f7cc-208">Если пользователь нажмет кнопку ОК, функция `confirm(string)` возвращает `true`; При нажатии кнопки Отмена возвращаются `false`.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-208">If the user clicks OK, the `confirm(string)` function returns `true`; clicking Cancel returns `false`.</span></span> <span data-ttu-id="6f7cc-209">Эта функция в сочетании с поведением браузера для отмены отправки формы, если обработчик событий во время отправки возвращает `false`, может использоваться для вывода сообщения о подтверждении при удалении записи.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-209">This functionality, coupled with a browser s behavior to cancel a form submission if an event handler during the submission process returns `false`, can be used to display a confirmation messagebox when deleting a record.</span></span>

<span data-ttu-id="6f7cc-210">Функция `confirm(string)` может быть связана с обработчиком событий веб-элемента управления "Кнопка" на стороне клиента `onclick` с помощью свойства `OnClientClick` управления.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-210">The `confirm(string)` function can be associated with a Button Web control s client-side `onclick` event handler through the control s `OnClientClick` property.</span></span> <span data-ttu-id="6f7cc-211">При работе с кнопкой Удалить в шаблоне — либо в одном из шаблонов FormView, либо в TemplateField в элементе управления DetailsView или GridView. это свойство можно установить либо декларативно, либо программно, как было показано в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-211">When working with a Delete button in a template - either in one of the FormView s templates or in a TemplateField in the DetailsView or GridView - this property can be set either declaratively or programmatically, as we saw in this tutorial.</span></span>

<span data-ttu-id="6f7cc-212">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="6f7cc-212">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="6f7cc-213">Об авторе</span><span class="sxs-lookup"><span data-stu-id="6f7cc-213">About the Author</span></span>

<span data-ttu-id="6f7cc-214">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-214">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="6f7cc-215">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="6f7cc-215">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="6f7cc-216">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="6f7cc-216">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="6f7cc-217">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6f7cc-217">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="6f7cc-218">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="6f7cc-218">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="6f7cc-219">[Назад](implementing-optimistic-concurrency-vb.md)
> [Вперед](limiting-data-modification-functionality-based-on-the-user-vb.md)</span><span class="sxs-lookup"><span data-stu-id="6f7cc-219">[Previous](implementing-optimistic-concurrency-vb.md)
[Next](limiting-data-modification-functionality-based-on-the-user-vb.md)</span></span>
