---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb
title: Общие сведения о вставке, обновлении и удалении данных (VB) | Документация Майкрософт
author: rick-anderson
description: В этом учебнике мы рассмотрим, как сопоставлять методы вставки (), Update () и Delete () ObjectDataSource с методами классов BLL, а также как конфигу...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 35b40b8f-2ca8-4ab3-9c19-f361a91a3647
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb
msc.type: authoredcontent
ms.openlocfilehash: 79491118ba1cbbc8c1b67ca9646a817d941f17ba
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78493842"
---
# <a name="an-overview-of-inserting-updating-and-deleting-data-vb"></a><span data-ttu-id="00e53-103">Общие сведения о вставке, обновлении и удалении данных (VB)</span><span class="sxs-lookup"><span data-stu-id="00e53-103">An Overview of Inserting, Updating, and Deleting Data (VB)</span></span>

<span data-ttu-id="00e53-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="00e53-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="00e53-105">[Скачивание примера приложения](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_16_VB.exe) или [Загрузка PDF-файла](an-overview-of-inserting-updating-and-deleting-data-vb/_static/datatutorial16vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="00e53-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_16_VB.exe) or [Download PDF](an-overview-of-inserting-updating-and-deleting-data-vb/_static/datatutorial16vb1.pdf)</span></span>

> <span data-ttu-id="00e53-106">В этом учебнике мы рассмотрим, как сопоставлять методы вставки (), Update () и Delete () ObjectDataSource с методами классов BLL, а также как настроить элементы управления GridView, DetailsView и FormView для предоставления возможностей изменения данных.</span><span class="sxs-lookup"><span data-stu-id="00e53-106">In this tutorial we'll see how to map an ObjectDataSource's Insert(), Update(), and Delete() methods to the methods of BLL classes, as well as how to configure the GridView, DetailsView, and FormView controls to provide data modification capabilities.</span></span>

## <a name="introduction"></a><span data-ttu-id="00e53-107">Введение</span><span class="sxs-lookup"><span data-stu-id="00e53-107">Introduction</span></span>

<span data-ttu-id="00e53-108">В нескольких прошлых учебных курсах мы рассмотрели, как отображать данные на странице ASP.NET с помощью элементов управления GridView, DetailsView и FormView.</span><span class="sxs-lookup"><span data-stu-id="00e53-108">Over the past several tutorials we've examined how to display data in an ASP.NET page using the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="00e53-109">Эти элементы управления просто работают с предоставляемыми им данными.</span><span class="sxs-lookup"><span data-stu-id="00e53-109">These controls simply work with data supplied to them.</span></span> <span data-ttu-id="00e53-110">Как правило, эти элементы управления обращаются к данным с помощью элемента управления источниками данных, например ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="00e53-110">Commonly, these controls access data through the use of a data source control, such as the ObjectDataSource.</span></span> <span data-ttu-id="00e53-111">Мы увидели, как элемент управления ObjectDataSource выступает в качестве прокси-сервера между страницей ASP.NET и базовыми данными.</span><span class="sxs-lookup"><span data-stu-id="00e53-111">We've seen how the ObjectDataSource acts as a proxy between the ASP.NET page and the underlying data.</span></span> <span data-ttu-id="00e53-112">Когда GridView необходимо отображать данные, он вызывает метод `Select()` ObjectDataSource, который, в свою очередь, вызывает метод из уровня бизнес-логики (BLL), который вызывает метод в соответствующем адаптере (DAL) уровня доступа к данным, который, в свою очередь, отправляет запрос `SELECT` в базу данных Northwind.</span><span class="sxs-lookup"><span data-stu-id="00e53-112">When a GridView needs to display data, it invokes its ObjectDataSource's `Select()` method, which in turn invokes a method from our Business Logic Layer (BLL), which calls a method in the appropriate Data Access Layer's (DAL) TableAdapter, which in turn sends a `SELECT` query to the Northwind database.</span></span>

<span data-ttu-id="00e53-113">Вспомним, что при создании TableAdapters в DAL в [первом учебном курсе](../introduction/creating-a-data-access-layer-cs.md)Visual Studio автоматически добавила методы для вставки, обновления и удаления данных из базовой таблицы базы данных.</span><span class="sxs-lookup"><span data-stu-id="00e53-113">Recall that when we created the TableAdapters in the DAL in [our first tutorial](../introduction/creating-a-data-access-layer-cs.md), Visual Studio automatically added methods for inserting, updating, and deleting data from the underlying database table.</span></span> <span data-ttu-id="00e53-114">Более того, при [создании уровня бизнес-логики](../introduction/creating-a-business-logic-layer-vb.md) мы разработали в BLL методы, которые вызывали эти методы DAL по изменению данных.</span><span class="sxs-lookup"><span data-stu-id="00e53-114">Moreover, in [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md) we designed methods in the BLL that called down into these data modification DAL methods.</span></span>

<span data-ttu-id="00e53-115">В дополнение к методу `Select()`, ObjectDataSource также имеет методы `Insert()`, `Update()`и `Delete()`.</span><span class="sxs-lookup"><span data-stu-id="00e53-115">In addition to its `Select()` method, the ObjectDataSource also has `Insert()`, `Update()`, and `Delete()` methods.</span></span> <span data-ttu-id="00e53-116">Как и метод `Select()`, эти три метода можно сопоставить с методами в базовом объекте.</span><span class="sxs-lookup"><span data-stu-id="00e53-116">Like the `Select()` method, these three methods can be mapped to methods in an underlying object.</span></span> <span data-ttu-id="00e53-117">При настройке для вставки, обновления или удаления данных элементы управления GridView, DetailsView и FormView предоставляют пользовательский интерфейс для изменения базовых данных.</span><span class="sxs-lookup"><span data-stu-id="00e53-117">When configured to insert, update, or delete data, the GridView, DetailsView, and FormView controls provide a user interface for modifying the underlying data.</span></span> <span data-ttu-id="00e53-118">Этот пользовательский интерфейс вызывает методы `Insert()`, `Update()`и `Delete()` ObjectDataSource, которые затем вызывают связанные с ним методы базового объекта (см. рис. 1).</span><span class="sxs-lookup"><span data-stu-id="00e53-118">This user interface calls the `Insert()`, `Update()`, and `Delete()` methods of the ObjectDataSource, which then invoke the underlying object's associated methods (see Figure 1).</span></span>

<span data-ttu-id="00e53-119">[![методы вставки (), обновления () и удаления () ObjectDataSource являются прокси-сервером в BLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image2.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-119">[![The ObjectDataSource's Insert(), Update(), and Delete() Methods Serve as a Proxy into the BLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image2.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image1.png)</span></span>

<span data-ttu-id="00e53-120">**Рис. 1**. методы `Insert()`, `Update()`и `Delete()` ObjectDataSource являются прокси-сервером в BLL ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-120">**Figure 1**: The ObjectDataSource's `Insert()`, `Update()`, and `Delete()` Methods Serve as a Proxy into the BLL ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image3.png))</span></span>

<span data-ttu-id="00e53-121">В этом учебнике мы рассмотрим, как сопоставлять методы `Insert()`, `Update()`и `Delete()` ObjectDataSource с методами классов в BLL, а также как настроить элементы управления GridView, DetailsView и FormView для предоставления возможностей изменения данных.</span><span class="sxs-lookup"><span data-stu-id="00e53-121">In this tutorial we'll see how to map the ObjectDataSource's `Insert()`, `Update()`, and `Delete()` methods to methods of classes in the BLL, as well as how to configure the GridView, DetailsView, and FormView controls to provide data modification capabilities.</span></span>

## <a name="step-1-creating-the-insert-update-and-delete-tutorials-web-pages"></a><span data-ttu-id="00e53-122">Шаг 1. Создание веб-страниц учебников по вставке, обновлению и удалению</span><span class="sxs-lookup"><span data-stu-id="00e53-122">Step 1: Creating the Insert, Update, and Delete Tutorials Web Pages</span></span>

<span data-ttu-id="00e53-123">Прежде чем начать изучение вставки, обновления и удаления данных, давайте сначала создадим страницы ASP.NET в нашем проекте веб-сайта, которые понадобятся для работы с этим руководством и следующих нескольких.</span><span class="sxs-lookup"><span data-stu-id="00e53-123">Before we start exploring how to insert, update, and delete data, let's first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next several ones.</span></span> <span data-ttu-id="00e53-124">Для начала добавьте новую папку с именем `EditInsertDelete`.</span><span class="sxs-lookup"><span data-stu-id="00e53-124">Start by adding a new folder named `EditInsertDelete`.</span></span> <span data-ttu-id="00e53-125">Затем добавьте в эту папку следующие страницы ASP.NET, чтобы связать каждую страницу с главной страницей `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="00e53-125">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Basics.aspx`
- `DataModificationEvents.aspx`
- `ErrorHandling.aspx`
- `UIValidation.aspx`
- `CustomizedUI.aspx`
- `OptimisticConcurrency.aspx`
- `ConfirmationOnDelete.aspx`
- `UserLevelAccess.aspx`

![Добавление страниц ASP.NET для руководств, связанных с изменением данных](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image4.png)

<span data-ttu-id="00e53-127">**Рис. 2**. добавление страниц ASP.NET для руководств, связанных с изменением данных</span><span class="sxs-lookup"><span data-stu-id="00e53-127">**Figure 2**: Add the ASP.NET Pages for the Data Modification-Related Tutorials</span></span>

<span data-ttu-id="00e53-128">Как и в других папках, `Default.aspx` в папке `EditInsertDelete` будут перечислены учебники в разделе.</span><span class="sxs-lookup"><span data-stu-id="00e53-128">Like in the other folders, `Default.aspx` in the `EditInsertDelete` folder will list the tutorials in its section.</span></span> <span data-ttu-id="00e53-129">Вспомним, что `SectionLevelTutorialListing.ascx` пользовательский элемент управления предоставляет эти функции.</span><span class="sxs-lookup"><span data-stu-id="00e53-129">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="00e53-130">Таким образом, добавьте этот пользовательский элемент управления в `Default.aspx`, перетащив его из обозреватель решений на представление конструирования страницы.</span><span class="sxs-lookup"><span data-stu-id="00e53-130">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page's Design view.</span></span>

<span data-ttu-id="00e53-131">[![добавить пользовательский элемент управления SectionLevelTutorialListing. ascx в Default. aspx](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image6.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-131">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image6.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image5.png)</span></span>

<span data-ttu-id="00e53-132">**Рис. 3**. Добавление пользовательского элемента управления `SectionLevelTutorialListing.ascx` в `Default.aspx` ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-132">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image7.png))</span></span>

<span data-ttu-id="00e53-133">Наконец, добавьте страницы в качестве записей в файл `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="00e53-133">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="00e53-134">В частности, добавьте следующую разметку после настраиваемого `<siteMapNode>`форматирования:</span><span class="sxs-lookup"><span data-stu-id="00e53-134">Specifically, add the following markup after the Customized Formatting `<siteMapNode>`:</span></span>

[!code-xml[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample1.xml)]

<span data-ttu-id="00e53-135">После обновления `Web.sitemap`просмотрите веб-сайт учебников в браузере.</span><span class="sxs-lookup"><span data-stu-id="00e53-135">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="00e53-136">В меню слева теперь содержатся элементы для учебников по редактированию, вставке и удалению.</span><span class="sxs-lookup"><span data-stu-id="00e53-136">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>

![На карте веб-узла теперь есть записи для учебников по редактированию, вставке и удалению.](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image8.png)

<span data-ttu-id="00e53-138">**Рис. 4**. схема узла теперь включает в себя записи для руководства по редактированию, вставке и удалению</span><span class="sxs-lookup"><span data-stu-id="00e53-138">**Figure 4**: The Site Map Now Includes Entries for the Editing, Inserting, and Deleting Tutorials</span></span>

## <a name="step-2-adding-and-configuring-the-objectdatasource-control"></a><span data-ttu-id="00e53-139">Шаг 2. Добавление и настройка элемента управления ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="00e53-139">Step 2: Adding and Configuring the ObjectDataSource Control</span></span>

<span data-ttu-id="00e53-140">Поскольку GridView, DetailsView и FormView имеют разные возможности изменения данных и макет, давайте рассмотрим каждый из них по отдельности.</span><span class="sxs-lookup"><span data-stu-id="00e53-140">Since the GridView, DetailsView, and FormView each differ in their data modification capabilities and layout, let's examine each one individually.</span></span> <span data-ttu-id="00e53-141">Однако, вместо того, чтобы каждый элемент управления использовал собственный объект ObjectDataSource, давайте создадим только один объект ObjectDataSource, который может совместно использоваться всеми тремя примерами элементов управления.</span><span class="sxs-lookup"><span data-stu-id="00e53-141">Rather than have each control using its own ObjectDataSource, however, let's just create a single ObjectDataSource that all three control examples can share.</span></span>

<span data-ttu-id="00e53-142">Откройте страницу `Basics.aspx`, перетащите элемент управления ObjectDataSource из области элементов в конструктор и щелкните ссылку Настроить источник данных из своего смарт-тега.</span><span class="sxs-lookup"><span data-stu-id="00e53-142">Open the `Basics.aspx` page, drag an ObjectDataSource from the Toolbox onto the Designer, and click the Configure Data Source link from its smart tag.</span></span> <span data-ttu-id="00e53-143">Поскольку `ProductsBLL` является единственным классом BLL, предоставляющим методы редактирования, вставки и удаления, настройте ObjectDataSource для использования этого класса.</span><span class="sxs-lookup"><span data-stu-id="00e53-143">Since the `ProductsBLL` is the only BLL class that provides editing, inserting, and deleting methods, configure the ObjectDataSource to use this class.</span></span>

<span data-ttu-id="00e53-144">[![настроить ObjectDataSource для использования класса ProductsBLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image10.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-144">[![Configure the ObjectDataSource to Use the ProductsBLL Class](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image10.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image9.png)</span></span>

<span data-ttu-id="00e53-145">**Рис. 5**. Настройка ObjectDataSource для использования класса `ProductsBLL` ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-145">**Figure 5**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image11.png))</span></span>

<span data-ttu-id="00e53-146">На следующем экране можно указать, какие методы класса `ProductsBLL` сопоставляются `Select()`, `Insert()`, `Update()`и `Delete()` ObjectDataSource, выбрав соответствующую вкладку и выбрав метод из раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="00e53-146">In the next screen we can specify what methods of the `ProductsBLL` class are mapped to the ObjectDataSource's `Select()`, `Insert()`, `Update()`, and `Delete()` by selecting the appropriate tab and choosing the method from the drop-down list.</span></span> <span data-ttu-id="00e53-147">Рис. 6, который должен выглядеть знакомым, теперь сопоставляет метод `Select()` ObjectDataSource с методом `GetProducts()` класса `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="00e53-147">Figure 6, which should look familiar by now, maps the ObjectDataSource's `Select()` method to the `ProductsBLL` class's `GetProducts()` method.</span></span> <span data-ttu-id="00e53-148">Методы `Insert()`, `Update()`и `Delete()` можно настроить, выбрав соответствующую вкладку в верхней части списка.</span><span class="sxs-lookup"><span data-stu-id="00e53-148">The `Insert()`, `Update()`, and `Delete()` methods can be configured by selecting the appropriate tab from the list along the top.</span></span>

<span data-ttu-id="00e53-149">[![, что ObjectDataSource возвращает все продукты](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image13.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-149">[![Have the ObjectDataSource Return All of the Products](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image13.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image12.png)</span></span>

<span data-ttu-id="00e53-150">**Рис. 6**. возвращение всех продуктов с помощью ObjectDataSource ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-150">**Figure 6**: Have the ObjectDataSource Return All of the Products ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image14.png))</span></span>

<span data-ttu-id="00e53-151">На рисунках 7, 8 и 9 показаны вкладки обновления, вставки и удаления элемента управления ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="00e53-151">Figures 7, 8, and 9 show the ObjectDataSource's UPDATE, INSERT, and DELETE tabs.</span></span> <span data-ttu-id="00e53-152">Настройте эти вкладки таким образом, чтобы методы `Insert()`, `Update()`и `Delete()` вызывали методы `UpdateProduct`, `AddProduct`и `DeleteProduct` класса `ProductsBLL` соответственно.</span><span class="sxs-lookup"><span data-stu-id="00e53-152">Configure these tabs so that the `Insert()`, `Update()`, and `Delete()` methods invoke the `ProductsBLL` class's `UpdateProduct`, `AddProduct`, and `DeleteProduct` methods, respectively.</span></span>

<span data-ttu-id="00e53-153">[![привяжите метод Update () ObjectDataSource к методу UpdateProduct класса Продуктблл](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image16.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-153">[![Map the ObjectDataSource's Update() Method to the ProductBLL Class's UpdateProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image16.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image15.png)</span></span>

<span data-ttu-id="00e53-154">**Рис. 7**. сопоставьте метод `Update()` ObjectDataSource с методом `UpdateProduct` класса `ProductBLL` ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-154">**Figure 7**: Map the ObjectDataSource's `Update()` Method to the `ProductBLL` Class's `UpdateProduct` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image17.png))</span></span>

<span data-ttu-id="00e53-155">[![сопоставлять метод вставки () ObjectDataSource с методом AddProduct класса Продуктблл](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image19.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-155">[![Map the ObjectDataSource's Insert() Method to the ProductBLL Class's AddProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image19.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image18.png)</span></span>

<span data-ttu-id="00e53-156">**Рис. 8**. привязка метода `Insert()` ObjectDataSource к методу Add `Product` класса `ProductBLL` ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-156">**Figure 8**: Map the ObjectDataSource's `Insert()` Method to the `ProductBLL` Class's Add `Product` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image20.png))</span></span>

<span data-ttu-id="00e53-157">[![соотнести метод Delete () ObjectDataSource с методом DeleteProduct класса Продуктблл](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image22.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-157">[![Map the ObjectDataSource's Delete() Method to the ProductBLL Class's DeleteProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image22.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image21.png)</span></span>

<span data-ttu-id="00e53-158">**Рис. 9**. сопоставьте метод `Delete()` ObjectDataSource с методом `DeleteProduct` класса `ProductBLL` ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-158">**Figure 9**: Map the ObjectDataSource's `Delete()` Method to the `ProductBLL` Class's `DeleteProduct` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image23.png))</span></span>

<span data-ttu-id="00e53-159">Возможно, вы заметили, что в раскрывающихся списках на вкладках обновления, вставки и удаления уже были выбраны эти методы.</span><span class="sxs-lookup"><span data-stu-id="00e53-159">You may have noticed that the drop-down lists in the UPDATE, INSERT, and DELETE tabs already had these methods selected.</span></span> <span data-ttu-id="00e53-160">Это спасибо за использование `DataObjectMethodAttribute`, которые оформляют методы `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="00e53-160">This is thanks to our use of the `DataObjectMethodAttribute` that decorates the methods of `ProductsBLL`.</span></span> <span data-ttu-id="00e53-161">Например, метод DeleteProduct имеет следующую сигнатуру:</span><span class="sxs-lookup"><span data-stu-id="00e53-161">For example, the DeleteProduct method has the following signature:</span></span>

[!code-vb[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample2.vb)]

<span data-ttu-id="00e53-162">Атрибут `DataObjectMethodAttribute` указывает назначение каждого метода — выбор, вставка, обновление или удаление, а также значение по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="00e53-162">The `DataObjectMethodAttribute` attribute indicates the purpose of each method whether it is for selecting, inserting, updating, or deleting and whether or not it's the default value.</span></span> <span data-ttu-id="00e53-163">Если эти атрибуты пропущены при создании классов BLL, необходимо вручную выбрать эти методы на вкладках обновление, вставка и удаление.</span><span class="sxs-lookup"><span data-stu-id="00e53-163">If you omitted these attributes when creating your BLL classes, you'll need to manually select the methods from the UPDATE, INSERT, and DELETE tabs.</span></span>

<span data-ttu-id="00e53-164">Убедившись, что соответствующие методы `ProductsBLL` сопоставляются с методами `Insert()`, `Update()`и `Delete()` ObjectDataSource, нажмите кнопку Готово, чтобы завершить работу мастера.</span><span class="sxs-lookup"><span data-stu-id="00e53-164">After ensuring that the appropriate `ProductsBLL` methods are mapped to the ObjectDataSource's `Insert()`, `Update()`, and `Delete()` methods, click Finish to complete the wizard.</span></span>

## <a name="examining-the-objectdatasources-markup"></a><span data-ttu-id="00e53-165">Проверка разметки ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="00e53-165">Examining the ObjectDataSource's Markup</span></span>

<span data-ttu-id="00e53-166">После настройки ObjectDataSource с помощью мастера перейдите к представлению исходного кода, чтобы проверить созданную декларативную разметку.</span><span class="sxs-lookup"><span data-stu-id="00e53-166">After configuring the ObjectDataSource through its wizard, go to the Source view to examine the generated declarative markup.</span></span> <span data-ttu-id="00e53-167">Тег `<asp:ObjectDataSource>` указывает базовый объект и методы для вызова.</span><span class="sxs-lookup"><span data-stu-id="00e53-167">The `<asp:ObjectDataSource>` tag specifies the underlying object and the methods to invoke.</span></span> <span data-ttu-id="00e53-168">Кроме того, существуют `DeleteParameters`, `UpdateParameters`и `InsertParameters`, которые сопоставляются с входными параметрами для методов `AddProduct`, `UpdateProduct`и `DeleteProduct` класса `ProductsBLL`:</span><span class="sxs-lookup"><span data-stu-id="00e53-168">Additionally, there are `DeleteParameters`, `UpdateParameters`, and `InsertParameters` that map to the input parameters for the `ProductsBLL` class's `AddProduct`, `UpdateProduct`, and `DeleteProduct` methods:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample3.aspx)]

<span data-ttu-id="00e53-169">ObjectDataSource включает параметр для каждого из входных параметров для связанных с ним методов, так же как список `SelectParameter` s присутствует, когда ObjectDataSource настроен для вызова метода Select, ожидающего входного параметра (например, `GetProductsByCategoryID(categoryID)`).</span><span class="sxs-lookup"><span data-stu-id="00e53-169">The ObjectDataSource includes a parameter for each of the input parameters for its associated methods, just like a list of `SelectParameter` s is present when the ObjectDataSource is configured to call a select method that expects an input parameter (such as `GetProductsByCategoryID(categoryID)`).</span></span> <span data-ttu-id="00e53-170">Как скоро будет видно, значения этих `DeleteParameters`, `UpdateParameters`и `InsertParameters` задаются автоматически с помощью элементов управления GridView, DetailsView и FormView перед вызовом метода `Insert()`, `Update()`или `Delete()` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="00e53-170">As we'll see shortly, values for these `DeleteParameters`, `UpdateParameters`, and `InsertParameters` are set automatically by the GridView, DetailsView, and FormView prior to invoking the ObjectDataSource's `Insert()`, `Update()`, or `Delete()` method.</span></span> <span data-ttu-id="00e53-171">Эти значения также можно задать программным способом, как описано в следующем учебном курсе.</span><span class="sxs-lookup"><span data-stu-id="00e53-171">These values can also be set programmatically as needed, as we'll discuss in a future tutorial.</span></span>

<span data-ttu-id="00e53-172">Одним из побочных эффектов использования мастера для настройки ObjectDataSource является то, что Visual Studio устанавливает для [свойства OldValuesParameterFormatString](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.oldvaluesparameterformatstring(VS.80).aspx) значение `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="00e53-172">One side effect of using the wizard to configure to ObjectDataSource is that Visual Studio sets the [OldValuesParameterFormatString property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.oldvaluesparameterformatstring(VS.80).aspx) to `original_{0}`.</span></span> <span data-ttu-id="00e53-173">Это значение свойства используется для включения исходных значений изменяемых данных и полезно в двух сценариях:</span><span class="sxs-lookup"><span data-stu-id="00e53-173">This property value is used to include the original values of the data being edited and is useful in two scenarios:</span></span>

- <span data-ttu-id="00e53-174">Если при редактировании записи пользователь может изменить значение первичного ключа.</span><span class="sxs-lookup"><span data-stu-id="00e53-174">If, when editing a record, users are able to change the primary key value.</span></span> <span data-ttu-id="00e53-175">В этом случае необходимо предоставить новое значение первичного ключа и исходное значение первичного ключа, чтобы можно было найти запись с исходным значением первичного ключа и соответствующим образом обновить его значение.</span><span class="sxs-lookup"><span data-stu-id="00e53-175">In this case, both the new primary key value and the original primary key value must be provided so that the record with the original primary key value can be found and have its value updated accordingly.</span></span>
- <span data-ttu-id="00e53-176">При использовании оптимистичного параллелизма.</span><span class="sxs-lookup"><span data-stu-id="00e53-176">When using optimistic concurrency.</span></span> <span data-ttu-id="00e53-177">Оптимистическая блокировка — это метод, гарантирующий, что два одновременно работающих пользователя не перезапишут изменения, и это раздел для будущего руководства.</span><span class="sxs-lookup"><span data-stu-id="00e53-177">Optimistic concurrency is a technique to ensure that two simultaneous users don't overwrite one another's changes, and is the topic for a future tutorial.</span></span>

<span data-ttu-id="00e53-178">Свойство `OldValuesParameterFormatString` указывает имя входных параметров в методах Update и DELETE базового объекта для исходных значений.</span><span class="sxs-lookup"><span data-stu-id="00e53-178">The `OldValuesParameterFormatString` property indicates the name of the input parameters in the underlying object's update and delete methods for the original values.</span></span> <span data-ttu-id="00e53-179">Мы обсудим это свойство и его назначение более подробно при рассмотрении оптимистичного параллелизма.</span><span class="sxs-lookup"><span data-stu-id="00e53-179">We'll discuss this property and its purpose in greater detail when we explore optimistic concurrency.</span></span> <span data-ttu-id="00e53-180">Однако я выберу его сейчас, так как методы BLL не предполагают исходные значения, поэтому важно удалить это свойство.</span><span class="sxs-lookup"><span data-stu-id="00e53-180">I bring it up now, however, because our BLL's methods do not expect the original values and therefore it's important that we remove this property.</span></span> <span data-ttu-id="00e53-181">Если для свойства `OldValuesParameterFormatString` задано значение, отличное от значения по умолчанию (`{0}`), то при попытке веб-элемента управления данными вызвать методы `Update()` или `Delete()` будет возникать ошибка, так как ObjectDataSource попытается передать как `UpdateParameters`, так и `DeleteParameters`, как и исходные параметры значения.</span><span class="sxs-lookup"><span data-stu-id="00e53-181">Leaving the `OldValuesParameterFormatString` property set to anything other than the default (`{0}`) will cause an error when a data Web control attempts to invoke the ObjectDataSource's `Update()` or `Delete()` methods because the ObjectDataSource will attempt to pass in both the `UpdateParameters` or `DeleteParameters` specified as well as original value parameters.</span></span>

<span data-ttu-id="00e53-182">Если это не совсем понятно в этом присоединении ке, не беспокойтесь, мы рассмотрим это свойство и его служебную программу в следующем учебном курсе.</span><span class="sxs-lookup"><span data-stu-id="00e53-182">If this isn't terribly clear at this juncture, don't worry, we'll examine this property and its utility in a future tutorial.</span></span> <span data-ttu-id="00e53-183">Сейчас нужно просто удалить это объявление свойства целиком из декларативного синтаксиса или установить значение по умолчанию ({0}).</span><span class="sxs-lookup"><span data-stu-id="00e53-183">For now, just be certain to either remove this property declaration entirely from the declarative syntax or set the value to the default value ({0}).</span></span>

> [!NOTE]
> <span data-ttu-id="00e53-184">Если вы просто удаляете значение свойства `OldValuesParameterFormatString` из окно свойств в представление конструирования, оно по-прежнему будет существовать в декларативном синтаксисе, но должно быть задано как пустая строка.</span><span class="sxs-lookup"><span data-stu-id="00e53-184">If you simply clear out the `OldValuesParameterFormatString` property value from the Properties window in the Design view, the property will still exist in the declarative syntax, but be set to an empty string.</span></span> <span data-ttu-id="00e53-185">Это, увы, по-прежнему приведет к возникновению описанной выше проблемы.</span><span class="sxs-lookup"><span data-stu-id="00e53-185">This, unfortunately, will still result in the same problem discussed above.</span></span> <span data-ttu-id="00e53-186">Поэтому либо удалите свойство из декларативного синтаксиса, либо из окно свойств, установите значение по умолчанию `{0}`.</span><span class="sxs-lookup"><span data-stu-id="00e53-186">Therefore, either remove the property altogether from the declarative syntax or, from the Properties window, set the value to the default, `{0}`.</span></span>

## <a name="step-3-adding-a-data-web-control-and-configuring-it-for-data-modification"></a><span data-ttu-id="00e53-187">Шаг 3. Добавление веб-элемента управления данными и его настройка для изменения данных</span><span class="sxs-lookup"><span data-stu-id="00e53-187">Step 3: Adding a Data Web Control and Configuring It for Data Modification</span></span>

<span data-ttu-id="00e53-188">После того как ObjectDataSource добавлен на страницу и настроен, мы готовы к добавлению веб-элементов управления данными на страницу, чтобы отобразить данные и предоставить пользователю возможность изменить их.</span><span class="sxs-lookup"><span data-stu-id="00e53-188">Once the ObjectDataSource has been added to the page and configured, we're ready to add data Web controls to the page to both display the data and provide a means for the end user to modify it.</span></span> <span data-ttu-id="00e53-189">Мы будем просматривать GridView, DetailsView и FormView отдельно, так как эти веб-элементы управления данными отличаются возможностями и конфигурацией изменения данных.</span><span class="sxs-lookup"><span data-stu-id="00e53-189">We'll look at the GridView, DetailsView, and FormView separately, as these data Web controls differ in their data modification capabilities and configuration.</span></span>

<span data-ttu-id="00e53-190">Как мы увидим в оставшейся части этой статьи, Добавление базовой поддержки редактирования, вставки и удаления с помощью элементов управления GridView, DetailsView и FormView — это так же просто, как проверка нескольких флажков.</span><span class="sxs-lookup"><span data-stu-id="00e53-190">As we'll see in the remainder of this article, adding very basic editing, inserting, and deleting support through the GridView, DetailsView, and FormView controls is really as simple as checking a couple of checkboxes.</span></span> <span data-ttu-id="00e53-191">В реальной среде существует множество тонкостей и пограничных вариантов, которые обеспечивают более функциональную функциональность, чем просто наpointсь и щелкая.</span><span class="sxs-lookup"><span data-stu-id="00e53-191">There are many subtleties and edge cases in the real-world that make providing such functionality more involved than just point and click.</span></span> <span data-ttu-id="00e53-192">Тем не менее, в этом учебнике основное внимание уделяется исключительно упрощению возможностей изменения данных.</span><span class="sxs-lookup"><span data-stu-id="00e53-192">This tutorial, however, focuses solely on proving simplistic data modification capabilities.</span></span> <span data-ttu-id="00e53-193">В следующих учебных курсах будут рассмотрены проблемы, которые, как нереальности, будут возникать в реальных параметрах.</span><span class="sxs-lookup"><span data-stu-id="00e53-193">Future tutorials will examine concerns that will undoubtedly arise in a real-world setting.</span></span>

## <a name="deleting-data-from-the-gridview"></a><span data-ttu-id="00e53-194">Удаление данных из GridView</span><span class="sxs-lookup"><span data-stu-id="00e53-194">Deleting Data from the GridView</span></span>

<span data-ttu-id="00e53-195">Начните с перетаскивания элемента управления GridView с панели инструментов в конструктор.</span><span class="sxs-lookup"><span data-stu-id="00e53-195">Start by dragging a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="00e53-196">Затем привяжите ObjectDataSource к GridView, выбрав его из раскрывающегося списка в смарт-теге GridView.</span><span class="sxs-lookup"><span data-stu-id="00e53-196">Next, bind the ObjectDataSource to the GridView by selecting it from the drop-down list in the GridView's smart tag.</span></span> <span data-ttu-id="00e53-197">На этом этапе декларативная разметка GridView будет выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="00e53-197">At this point the GridView's declarative markup will be:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample4.aspx)]

<span data-ttu-id="00e53-198">Привязка элемента управления GridView к ObjectDataSource через его смарт-тег имеет два преимущества:</span><span class="sxs-lookup"><span data-stu-id="00e53-198">Binding the GridView to the ObjectDataSource through its smart tag has two benefits:</span></span>

- <span data-ttu-id="00e53-199">BoundFields и Чеккбоксфиелдс создаются автоматически для каждого поля, возвращаемого ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="00e53-199">BoundFields and CheckBoxFields are automatically created for each of the fields returned by the ObjectDataSource.</span></span> <span data-ttu-id="00e53-200">Более того, свойства BoundField и CheckBoxField задаются на основе метаданных базового поля.</span><span class="sxs-lookup"><span data-stu-id="00e53-200">Moreover, the BoundField and CheckBoxField's properties are set based on the underlying field's metadata.</span></span> <span data-ttu-id="00e53-201">Например, поля `ProductID`, `CategoryName`и `SupplierName` помечаются как доступные только для чтения в `ProductsDataTable` и поэтому не должны обновляться при редактировании.</span><span class="sxs-lookup"><span data-stu-id="00e53-201">For example, the `ProductID`, `CategoryName`, and `SupplierName` fields are marked as read-only in the `ProductsDataTable` and therefore shouldn't be updatable when editing.</span></span> <span data-ttu-id="00e53-202">Для этого [свойства ReadOnly](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.readonly(VS.80).aspx) BoundFields имеют значение `True`.</span><span class="sxs-lookup"><span data-stu-id="00e53-202">To accommodate this, these BoundFields' [ReadOnly properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.readonly(VS.80).aspx) are set to `True`.</span></span>
- <span data-ttu-id="00e53-203">[Свойству DataKeyNames](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames(VS.80).aspx) присваивается поле первичного ключа базового объекта.</span><span class="sxs-lookup"><span data-stu-id="00e53-203">The [DataKeyNames property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames(VS.80).aspx) is assigned to the primary key field(s) of the underlying object.</span></span> <span data-ttu-id="00e53-204">Это важно при использовании элемента управления GridView для редактирования или удаления данных, так как это свойство указывает поле (или набор полей), уникально идентифицирующее каждую запись.</span><span class="sxs-lookup"><span data-stu-id="00e53-204">This is essential when using the GridView for editing or deleting data, as this property indicates the field (or set of fields) that unique identifies each record.</span></span> <span data-ttu-id="00e53-205">Дополнительные сведения о свойстве `DataKeyNames` см. в разделе " [основной/подробности" с помощью выбираемого справочника по GridView с подробным](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) руководством по DetailView.</span><span class="sxs-lookup"><span data-stu-id="00e53-205">For more information on the `DataKeyNames` property, refer back to the [Master/Detail Using a Selectable Master GridView with a Details DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial.</span></span>

<span data-ttu-id="00e53-206">Хотя GridView можно привязать к ObjectDataSource через окно свойств или декларативный синтаксис, это требует ручного добавления соответствующей разметки BoundField и `DataKeyNames`.</span><span class="sxs-lookup"><span data-stu-id="00e53-206">While the GridView can be bound to the ObjectDataSource through the Properties window or declarative syntax, doing so requires you to manually add the appropriate BoundField and `DataKeyNames` markup.</span></span>

<span data-ttu-id="00e53-207">Элемент управления GridView обеспечивает встроенную поддержку редактирования и удаления на уровне строк.</span><span class="sxs-lookup"><span data-stu-id="00e53-207">The GridView control provides built-in support for row-level editing and deleting.</span></span> <span data-ttu-id="00e53-208">Настройка GridView для поддержки удаления добавляет столбец кнопок удаления.</span><span class="sxs-lookup"><span data-stu-id="00e53-208">Configuring a GridView to support deleting adds a column of Delete buttons.</span></span> <span data-ttu-id="00e53-209">Когда пользователь нажимает кнопку Удалить для определенной строки, выполняется обратная передача, и GridView выполняет следующие действия:</span><span class="sxs-lookup"><span data-stu-id="00e53-209">When the end user clicks the Delete button for a particular row, a postback ensues and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="00e53-210">Значения `DeleteParameters` ObjectDataSource назначены</span><span class="sxs-lookup"><span data-stu-id="00e53-210">The ObjectDataSource's `DeleteParameters` value(s) are assigned</span></span>
2. <span data-ttu-id="00e53-211">Вызывается метод `Delete()` ObjectDataSource, удаляя указанную запись</span><span class="sxs-lookup"><span data-stu-id="00e53-211">The ObjectDataSource's `Delete()` method is invoked, deleting the specified record</span></span>
3. <span data-ttu-id="00e53-212">Элемент управления GridView повторно привязывается к ObjectDataSource, вызывая метод `Select()`</span><span class="sxs-lookup"><span data-stu-id="00e53-212">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>

<span data-ttu-id="00e53-213">Значения, присваиваемые `DeleteParameters`, являются значениями полей `DataKeyNames` строки, для которых была нажата кнопка Delete.</span><span class="sxs-lookup"><span data-stu-id="00e53-213">The values assigned to the `DeleteParameters` are the values of the `DataKeyNames` field(s) for the row whose Delete button was clicked.</span></span> <span data-ttu-id="00e53-214">Поэтому крайне важно, чтобы свойство `DataKeyNames` GridView было правильно установлено.</span><span class="sxs-lookup"><span data-stu-id="00e53-214">Therefore it's vital that a GridView's `DataKeyNames` property be correctly set.</span></span> <span data-ttu-id="00e53-215">Если он отсутствует, `DeleteParameters` будет присвоено значение `Nothing` на шаге 1, что, в свою очередь, не приведет к удалению записей на шаге 2.</span><span class="sxs-lookup"><span data-stu-id="00e53-215">If it's missing, the `DeleteParameters` will be assigned a value of `Nothing` in Step 1, which in turn will not result in any deleted records in Step 2.</span></span>

> [!NOTE]
> <span data-ttu-id="00e53-216">Коллекция `DataKeys` хранится в состоянии управления GridView s, что означает, что `DataKeys` значения будут сохраняться в обратной передаче, даже если состояние представления GridView s было отключено.</span><span class="sxs-lookup"><span data-stu-id="00e53-216">The `DataKeys` collection is stored in the GridView s control state, meaning that the `DataKeys` values will be remembered across postback even if the GridView s view state has been disabled.</span></span> <span data-ttu-id="00e53-217">Однако очень важно, чтобы состояние представления оставалось включенным для элементов управления GridView, поддерживающих редактирование или удаление (поведение по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="00e53-217">However, it is very important that view state remains enabled for GridViews that support editing or deleting (the default behavior).</span></span> <span data-ttu-id="00e53-218">Если для свойства `EnableViewState` GridView s задано значение `false`, то поведение редактирования и удаления будет работать для одного пользователя, но при наличии одновременных пользователей удаление данных существует вероятность того, что эти одновременные пользователи могут случайно удалить или изменить записи, которые им не планировалось.</span><span class="sxs-lookup"><span data-stu-id="00e53-218">If you set the GridView s `EnableViewState` property to `false`, the editing and deleting behavior will work fine for a single user, but if there are concurrent users deleting data, there exists the possibility that these concurrent users may accidentally delete or edit records that they didn't intend.</span></span> <span data-ttu-id="00e53-219">См. мою запись блога, [Предупреждение: проблемы параллелизма с ASP.NET 2,0 gridviews/DetailsView/FormView, которые поддерживают редактирование и (или) удаление, а состояние представления — отключено](http://scottonwriting.net/sowblog/posts/10054.aspx), для получения дополнительных сведений.</span><span class="sxs-lookup"><span data-stu-id="00e53-219">See my blog entry, [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx), for more information.</span></span>

<span data-ttu-id="00e53-220">Это же предупреждение также относится к DetailsView и FormView.</span><span class="sxs-lookup"><span data-stu-id="00e53-220">This same warning also applies to DetailsViews and FormViews.</span></span>

<span data-ttu-id="00e53-221">Чтобы добавить возможности удаления в GridView, просто перейдите к смарт-тегу и установите флажок Включить удаление.</span><span class="sxs-lookup"><span data-stu-id="00e53-221">To add deleting capabilities to a GridView, simply go to its smart tag and check the Enable Deleting checkbox.</span></span>

![Установите флажок "включить удаление".](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image24.png)

<span data-ttu-id="00e53-223">**Рис. 10**. Установка флажка "включить удаление"</span><span class="sxs-lookup"><span data-stu-id="00e53-223">**Figure 10**: Check the Enable Deleting Checkbox</span></span>

<span data-ttu-id="00e53-224">Установка флажка "включить удаление" из смарт-тега добавляет CommandField в GridView.</span><span class="sxs-lookup"><span data-stu-id="00e53-224">Checking the Enable Deleting checkbox from the smart tag adds a CommandField to the GridView.</span></span> <span data-ttu-id="00e53-225">CommandField визуализирует столбец в GridView с кнопками для выполнения одной или нескольких следующих задач: Выбор записи, изменение записи и удаление записи.</span><span class="sxs-lookup"><span data-stu-id="00e53-225">The CommandField renders a column in the GridView with buttons for performing one or more of the following tasks: selecting a record, editing a record, and deleting a record.</span></span> <span data-ttu-id="00e53-226">Ранее мы видели CommandField в действии с выбором записей в [главной и подробной среде с помощью выбираемого главного элемента управления GridView с учебником Details DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="00e53-226">We previously saw the CommandField in action with selecting records in the [Master/Detail Using a Selectable Master GridView with a Details DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial.</span></span>

<span data-ttu-id="00e53-227">CommandField содержит ряд свойств `ShowXButton`, которые указывают, какие ряды кнопок отображаются в CommandField.</span><span class="sxs-lookup"><span data-stu-id="00e53-227">The CommandField contains a number of `ShowXButton` properties that indicate what series of buttons are displayed in the CommandField.</span></span> <span data-ttu-id="00e53-228">Установив флажок Enable (включить удаление) CommandField, свойство `ShowDeleteButton` которого `True`, было добавлено в коллекцию Columns GridView.</span><span class="sxs-lookup"><span data-stu-id="00e53-228">By checking the Enable Deleting checkbox a CommandField whose `ShowDeleteButton` property is `True` has been added to the GridView's Columns collection.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample5.aspx)]

<span data-ttu-id="00e53-229">На этом этапе вы считаете, что он или нет, мы сделали Добавление поддержки удаления в GridView!</span><span class="sxs-lookup"><span data-stu-id="00e53-229">At this point, believe it or not, we're done with adding deleting support to the GridView!</span></span> <span data-ttu-id="00e53-230">Как показано на рис. 11, при посещении этой страницы через браузер имеется столбец с кнопками «удалить».</span><span class="sxs-lookup"><span data-stu-id="00e53-230">As Figure 11 shows, when visiting this page through a browser a column of Delete buttons is present.</span></span>

<span data-ttu-id="00e53-231">[![CommandField добавляет столбец кнопок удаления](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image26.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-231">[![The CommandField Adds a Column of Delete Buttons](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image26.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image25.png)</span></span>

<span data-ttu-id="00e53-232">**Рис. 11**. CommandField добавляет столбец кнопок удаления ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-232">**Figure 11**: The CommandField Adds a Column of Delete Buttons ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image27.png))</span></span>

<span data-ttu-id="00e53-233">Если вы создаете этот учебник с нуля самостоятельно, при тестировании этой страницы нажатие кнопки удалить вызовет исключение.</span><span class="sxs-lookup"><span data-stu-id="00e53-233">If you've been building this tutorial from the ground up on your own, when testing this page clicking the Delete button will raise an exception.</span></span> <span data-ttu-id="00e53-234">Продолжайте чтение, чтобы узнать, почему были вызваны эти исключения и как их исправить.</span><span class="sxs-lookup"><span data-stu-id="00e53-234">Continue reading to learn as to why these exceptions were raised and how to fix them.</span></span>

> [!NOTE]
> <span data-ttu-id="00e53-235">Если вы используете загрузку, прилагаемую к этому учебнику, эти проблемы уже были внесены в учетную запись.</span><span class="sxs-lookup"><span data-stu-id="00e53-235">If you're following along using the download accompanying this tutorial, these problems have already been accounted for.</span></span> <span data-ttu-id="00e53-236">Однако я рекомендую ознакомиться с приведенными ниже сведениями, чтобы определить проблемы, которые могут возникнуть и подходящие решения.</span><span class="sxs-lookup"><span data-stu-id="00e53-236">However, I encourage you to read through the details listed below to help identify problems that may arise and suitable workarounds.</span></span>

<span data-ttu-id="00e53-237">Если при попытке удалить продукт вы получаете исключение, сообщение о котором похоже на "*ObjectDataSource ' ObjectDataSource1 ' не может найти неуниверсальный метод ' DeleteProduct ', имеющий параметры: ProductID, original\_ProductID*, вероятно, вы забыли удалить свойство `OldValuesParameterFormatString` из ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="00e53-237">If, when attempting to delete a product, you get an exception whose message is similar to "*ObjectDataSource 'ObjectDataSource1' could not find a non-generic method 'DeleteProduct' that has parameters: productID, original\_ProductID*," you likely forgot to remove the `OldValuesParameterFormatString` property from the ObjectDataSource.</span></span> <span data-ttu-id="00e53-238">Если указано свойство `OldValuesParameterFormatString`, ObjectDataSource пытается передать в метод `DeleteProduct` `productID` и `original_ProductID` входные параметры.</span><span class="sxs-lookup"><span data-stu-id="00e53-238">With the `OldValuesParameterFormatString` property specified, the ObjectDataSource attempts to pass in both `productID` and `original_ProductID` input parameters to the `DeleteProduct` method.</span></span> <span data-ttu-id="00e53-239">Однако `DeleteProduct`принимает только один входной параметр, поэтому это исключение.</span><span class="sxs-lookup"><span data-stu-id="00e53-239">`DeleteProduct`, however, only accepts a single input parameter, hence the exception.</span></span> <span data-ttu-id="00e53-240">Удаление свойства `OldValuesParameterFormatString` (или присвоение ему значения `{0}`) заставляет ObjectDataSource не пытаться передать исходный входной параметр.</span><span class="sxs-lookup"><span data-stu-id="00e53-240">Removing the `OldValuesParameterFormatString` property (or setting it to `{0}`) instructs the ObjectDataSource to not attempt to pass in the original input parameter.</span></span>

<span data-ttu-id="00e53-241">[![убедитесь, что свойство OldValuesParameterFormatString было удалено.](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image29.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-241">[![Ensure That the OldValuesParameterFormatString Property Has Been Cleared Out](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image29.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image28.png)</span></span>

<span data-ttu-id="00e53-242">**Рис. 12**. Убедитесь, что свойство `OldValuesParameterFormatString` было удалено ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-242">**Figure 12**: Ensure That the `OldValuesParameterFormatString` Property Has Been Cleared Out ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image30.png))</span></span>

<span data-ttu-id="00e53-243">Даже если вы удалили свойство `OldValuesParameterFormatString`, по-прежнему возникает исключение при попытке удалить продукт с сообщением: "*инструкция DELETE конфликтует с ссылочным ограничением FK\_Order\_details\_Products"* . База данных Northwind содержит ограничение внешнего ключа между `Order Details` и `Products` таблицей, что означает, что продукт нельзя удалить из системы, если для него есть одна или несколько записей в таблице `Order Details`.</span><span class="sxs-lookup"><span data-stu-id="00e53-243">Even if you had removed the `OldValuesParameterFormatString` property, you still will get an exception when trying to delete a product with the message: "*The DELETE statement conflicted with the REFERENCE constraint 'FK\_Order\_Details\_Products'*." The Northwind database contains a foreign key constraint between the `Order Details` and `Products` table, meaning that a product cannot be deleted from the system if there are one or more records for it in the `Order Details` table.</span></span> <span data-ttu-id="00e53-244">Так как каждый продукт в базе данных Northwind имеет по крайней мере одну запись в `Order Details`, мы не можем удалить какие бы то ни было продукты, пока не удалим соответствующие записи о заказах продукта.</span><span class="sxs-lookup"><span data-stu-id="00e53-244">Since every product in the Northwind database has at least one record in `Order Details`, we cannot delete any products until we first delete the product's associated order details records.</span></span>

<span data-ttu-id="00e53-245">[![ограничение внешнего ключа запрещает удаление продуктов](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image32.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-245">[![A Foreign Key Constraint Prohibits the Deletion of Products](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image32.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image31.png)</span></span>

<span data-ttu-id="00e53-246">**Рис. 13**. ограничение внешнего ключа запрещает удаление продуктов ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-246">**Figure 13**: A Foreign Key Constraint Prohibits the Deletion of Products ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image33.png))</span></span>

<span data-ttu-id="00e53-247">В нашем руководстве мы просто удалим все записи из таблицы `Order Details`.</span><span class="sxs-lookup"><span data-stu-id="00e53-247">For our tutorial, let's just delete all of the records from the `Order Details` table.</span></span> <span data-ttu-id="00e53-248">В реальном приложении необходимо выполнить одно из следующих действий:</span><span class="sxs-lookup"><span data-stu-id="00e53-248">In a real-world application we'd need to either:</span></span>

- <span data-ttu-id="00e53-249">Наличие другого экрана для управления сведениями о заказах</span><span class="sxs-lookup"><span data-stu-id="00e53-249">Have another screen to manage order details information</span></span>
- <span data-ttu-id="00e53-250">Расширение метода `DeleteProduct` для включения логики для удаления указанных сведений о заказе продукта</span><span class="sxs-lookup"><span data-stu-id="00e53-250">Augment the `DeleteProduct` method to include logic to delete the specified product's order details</span></span>
- <span data-ttu-id="00e53-251">Изменение SQL запроса, используемого TableAdapter для включения удаления указанных сведений о заказе продукта</span><span class="sxs-lookup"><span data-stu-id="00e53-251">Modify the SQL query used by the TableAdapter to include deletion of the specified product's order details</span></span>

<span data-ttu-id="00e53-252">Просто удалим все записи из таблицы `Order Details`, чтобы обойти ограничение внешнего ключа.</span><span class="sxs-lookup"><span data-stu-id="00e53-252">Let's just delete all of the records from the `Order Details` table to circumvent the foreign key constraint.</span></span> <span data-ttu-id="00e53-253">Перейдите в обозреватель сервера в Visual Studio, щелкните правой кнопкой мыши узел `NORTHWND.MDF` и выберите команду Создать запрос.</span><span class="sxs-lookup"><span data-stu-id="00e53-253">Go to the Server Explorer in Visual Studio, right-click on the `NORTHWND.MDF` node, and choose New Query.</span></span> <span data-ttu-id="00e53-254">Затем в окне запроса выполните следующую инструкцию SQL: `DELETE FROM [Order Details]`</span><span class="sxs-lookup"><span data-stu-id="00e53-254">Then, in the query window, run the following SQL statement: `DELETE FROM [Order Details]`</span></span>

<span data-ttu-id="00e53-255">[![удалить все записи из таблицы Order Details](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image35.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-255">[![Delete All Records from the Order Details Table](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image35.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image34.png)</span></span>

<span data-ttu-id="00e53-256">**Рис. 14**. Удаление всех записей из таблицы `Order Details` ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-256">**Figure 14**: Delete All Records from the `Order Details` Table ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image36.png))</span></span>

<span data-ttu-id="00e53-257">После очистки `Order Details` таблице нажатие кнопки удалить приведет к удалению продукта без ошибок.</span><span class="sxs-lookup"><span data-stu-id="00e53-257">After clearing out the `Order Details` table clicking on the Delete button will delete the product without error.</span></span> <span data-ttu-id="00e53-258">Если нажатие кнопки удалить не приводит к удалению продукта, убедитесь, что для свойства `DataKeyNames` GridView установлено значение поля первичный ключ (`ProductID`).</span><span class="sxs-lookup"><span data-stu-id="00e53-258">If clicking on the Delete button does not delete the product, check to ensure that the GridView's `DataKeyNames` property is set to the primary key field (`ProductID`).</span></span>

> [!NOTE]
> <span data-ttu-id="00e53-259">При нажатии кнопки "Удалить" происходит обратная передача, и запись удаляется.</span><span class="sxs-lookup"><span data-stu-id="00e53-259">When clicking on the Delete button a postback ensues and the record is deleted.</span></span> <span data-ttu-id="00e53-260">Это может быть опасно, поскольку несложно случайно нажать кнопку "Удалить" в неверной строке.</span><span class="sxs-lookup"><span data-stu-id="00e53-260">This can be dangerous since it is easy to accidentally click on the wrong row's Delete button.</span></span> <span data-ttu-id="00e53-261">В следующем учебном курсе мы покажем, как добавить подтверждение на стороне клиента при удалении записи.</span><span class="sxs-lookup"><span data-stu-id="00e53-261">In a future tutorial we'll see how to add a client-side confirmation when deleting a record.</span></span>

## <a name="editing-data-with-the-gridview"></a><span data-ttu-id="00e53-262">Изменение данных с помощью GridView</span><span class="sxs-lookup"><span data-stu-id="00e53-262">Editing Data with the GridView</span></span>

<span data-ttu-id="00e53-263">Вместе с удалением элемент управления GridView также предоставляет встроенную поддержку редактирования на уровне строк.</span><span class="sxs-lookup"><span data-stu-id="00e53-263">Along with deleting, the GridView control also provides built-in row-level editing support.</span></span> <span data-ttu-id="00e53-264">Настройка элемента управления GridView для поддержки редактирования добавляет столбец кнопок редактирования.</span><span class="sxs-lookup"><span data-stu-id="00e53-264">Configuring a GridView to support editing adds a column of Edit buttons.</span></span> <span data-ttu-id="00e53-265">С точки зрения конечного пользователя нажатие кнопки Правка строки приводит к тому, что эта строка становится редактируемой, а ячейки переходят в текстовые поля, содержащие существующие значения, и заменяют кнопку изменить кнопками обновления и отмены.</span><span class="sxs-lookup"><span data-stu-id="00e53-265">From the end user's perspective, clicking a row's Edit button causes that row to become editable, turning the cells into textboxes containing the existing values and replacing the Edit button with Update and Cancel buttons.</span></span> <span data-ttu-id="00e53-266">После внесения необходимых изменений конечный пользователь может нажать кнопку обновить, чтобы сохранить изменения, или кнопку Отмена, чтобы отменить их.</span><span class="sxs-lookup"><span data-stu-id="00e53-266">After making their desired changes, the end user can click the Update button to commit the changes or the Cancel button to discard them.</span></span> <span data-ttu-id="00e53-267">В любом случае после нажатия кнопки Обновить или отмена GridView возвращается в состояние предварительного редактирования.</span><span class="sxs-lookup"><span data-stu-id="00e53-267">In either case, after clicking Update or Cancel the GridView returns to its pre-editing state.</span></span>

<span data-ttu-id="00e53-268">С нашей точки зрения разработчик страницы, когда пользователь нажимает кнопку "Изменить" для определенной строки, выполняется обратная передача, и GridView выполняет следующие действия:</span><span class="sxs-lookup"><span data-stu-id="00e53-268">From our perspective as the page developer, when the end user clicks the Edit button for a particular row, a postback ensues and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="00e53-269">Свойство `EditItemIndex` GridView присвоено индексу строки, для которой была нажата кнопка "Изменить"</span><span class="sxs-lookup"><span data-stu-id="00e53-269">The GridView's `EditItemIndex` property is assigned to the index of the row whose Edit button was clicked</span></span>
2. <span data-ttu-id="00e53-270">Элемент управления GridView повторно привязывается к ObjectDataSource, вызывая метод `Select()`</span><span class="sxs-lookup"><span data-stu-id="00e53-270">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>
3. <span data-ttu-id="00e53-271">Индекс строки, соответствующий `EditItemIndex`, подготавливается к просмотру в режиме правки.</span><span class="sxs-lookup"><span data-stu-id="00e53-271">The row index that matches the `EditItemIndex` is rendered in "edit mode."</span></span> <span data-ttu-id="00e53-272">В этом режиме кнопка "Изменить" заменяется кнопками обновления и отмены и BoundFields, свойства `ReadOnly` которых имеют значение false (по умолчанию), отображаются как веб-элементы управления TextBox, `Text` свойства которых присваиваются значениям полей данных.</span><span class="sxs-lookup"><span data-stu-id="00e53-272">In this mode, the Edit button is replaced by Update and Cancel buttons and BoundFields whose `ReadOnly` properties are False (the default) are rendered as TextBox Web controls whose `Text` properties are assigned to the data fields' values.</span></span>

<span data-ttu-id="00e53-273">На этом этапе в браузер возвращается разметка, позволяющая конечному пользователю вносить любые изменения в данные строки.</span><span class="sxs-lookup"><span data-stu-id="00e53-273">At this point the markup is returned to the browser, allowing the end user to make any changes to the row's data.</span></span> <span data-ttu-id="00e53-274">Когда пользователь нажимает кнопку "Обновить", происходит обратная передача, и GridView выполняет следующие действия:</span><span class="sxs-lookup"><span data-stu-id="00e53-274">When the user clicks the Update button, a postback occurs and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="00e53-275">`UpdateParameters` значениям ObjectDataSource присваиваются значения, вводимых конечным пользователем в интерфейс редактирования GridView.</span><span class="sxs-lookup"><span data-stu-id="00e53-275">The ObjectDataSource's `UpdateParameters` value(s) are assigned the values entered by the end user into the GridView's editing interface</span></span>
2. <span data-ttu-id="00e53-276">Вызывается метод `Update()` ObjectDataSource, который обновляет указанную запись</span><span class="sxs-lookup"><span data-stu-id="00e53-276">The ObjectDataSource's `Update()` method is invoked, updating the specified record</span></span>
3. <span data-ttu-id="00e53-277">Элемент управления GridView повторно привязывается к ObjectDataSource, вызывая метод `Select()`</span><span class="sxs-lookup"><span data-stu-id="00e53-277">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>

<span data-ttu-id="00e53-278">Значения первичного ключа, назначенные `UpdateParameters` на шаге 1, берутся из значений, указанных в свойстве `DataKeyNames`, тогда как значения непервичного ключа берутся из текста в веб-элементах управления TextBox для редактируемой строки.</span><span class="sxs-lookup"><span data-stu-id="00e53-278">The primary key values assigned to the `UpdateParameters` in Step 1 come from the values specified in the `DataKeyNames` property, whereas the non-primary key values come from the text in the TextBox Web controls for the edited row.</span></span> <span data-ttu-id="00e53-279">Как и при удалении, крайне важно, чтобы свойство `DataKeyNames` GridView было правильно установлено.</span><span class="sxs-lookup"><span data-stu-id="00e53-279">As with deleting, it is vital that a GridView's `DataKeyNames` property be correctly set.</span></span> <span data-ttu-id="00e53-280">Если он отсутствует, `UpdateParameters` значение первичного ключа будет присвоено значение `Nothing` на шаге 1, что, в свою очередь, не приведет к обновлению записей на шаге 2.</span><span class="sxs-lookup"><span data-stu-id="00e53-280">If it's missing, the `UpdateParameters` primary key value will be assigned a value of `Nothing` in Step 1, which in turn will not result in any updated records in Step 2.</span></span>

<span data-ttu-id="00e53-281">Функциональность редактирования можно активировать, просто установив флажок Включить редактирование в смарт-теге GridView.</span><span class="sxs-lookup"><span data-stu-id="00e53-281">Editing functionality can be activated by simply checking the Enable Editing checkbox in the GridView's smart tag.</span></span>

![Установите флажок Enable Edit (включить редактирование).](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image37.png)

<span data-ttu-id="00e53-283">**Рис. 15**. Установка флажка "включить редактирование"</span><span class="sxs-lookup"><span data-stu-id="00e53-283">**Figure 15**: Check the Enable Editing Checkbox</span></span>

<span data-ttu-id="00e53-284">Установка флажка Enable Edit (включить редактирование) добавит CommandField (при необходимости) и присвойте свойству `ShowEditButton` значение `True`.</span><span class="sxs-lookup"><span data-stu-id="00e53-284">Checking the Enable Editing checkbox will add a CommandField (if needed) and set its `ShowEditButton` property to `True`.</span></span> <span data-ttu-id="00e53-285">Как мы видели ранее, CommandField содержит ряд свойств `ShowXButton`, которые указывают, какие серии кнопок отображаются в CommandField.</span><span class="sxs-lookup"><span data-stu-id="00e53-285">As we saw earlier, the CommandField contains a number of `ShowXButton` properties that indicate what series of buttons are displayed in the CommandField.</span></span> <span data-ttu-id="00e53-286">Установив флажок Enable Edit (включить редактирование), вы добавите свойство `ShowEditButton` к существующему CommandField:</span><span class="sxs-lookup"><span data-stu-id="00e53-286">Checking the Enable Editing checkbox adds the `ShowEditButton` property to the existing CommandField:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample6.aspx)]

<span data-ttu-id="00e53-287">Это все, что необходимо для добавления поддержки элементарного редактирования.</span><span class="sxs-lookup"><span data-stu-id="00e53-287">That's all there is to adding rudimentary editing support.</span></span> <span data-ttu-id="00e53-288">Как показано в Figure16, интерфейс правки грубый каждый BoundField, свойство `ReadOnly` которого имеет значение `False` (значение по умолчанию) подготавливается к просмотру как текстовое поле.</span><span class="sxs-lookup"><span data-stu-id="00e53-288">As Figure16 shows, the editing interface is rather crude each BoundField whose `ReadOnly` property is set to `False` (the default) is rendered as a TextBox.</span></span> <span data-ttu-id="00e53-289">Сюда входят такие поля, как `CategoryID` и `SupplierID`, которые являются ключами к другим таблицам.</span><span class="sxs-lookup"><span data-stu-id="00e53-289">This includes fields like `CategoryID` and `SupplierID`, which are keys to other tables.</span></span>

<span data-ttu-id="00e53-290">[![нажатии кнопки "Изменить" в списке Chai s отображает строку в режиме редактирования](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image39.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-290">[![Clicking Chai s Edit Button Displays the Row in Edit Mode](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image39.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image38.png)</span></span>

<span data-ttu-id="00e53-291">**Рис. 16**. нажатие кнопки "Изменить" в списке Chai s отображает строку в режиме редактирования ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-291">**Figure 16**: Clicking Chai s Edit Button Displays the Row in Edit Mode ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image40.png))</span></span>

<span data-ttu-id="00e53-292">Помимо предоставления пользователям возможности изменять значения внешних ключей напрямую, интерфейс интерфейса правки не имеет следующих отличий.</span><span class="sxs-lookup"><span data-stu-id="00e53-292">In addition to asking users to edit foreign key values directly, the editing interface's interface is lacking in the following ways:</span></span>

- <span data-ttu-id="00e53-293">Если пользователь вводит `CategoryID` или `SupplierID`, которых нет в базе данных, `UPDATE` будет нарушать ограничение внешнего ключа, что приведет к возникновению исключения.</span><span class="sxs-lookup"><span data-stu-id="00e53-293">If the user enters a `CategoryID` or `SupplierID` that does not exist in the database, the `UPDATE` will violate a foreign key constraint, causing an exception to be raised.</span></span>
- <span data-ttu-id="00e53-294">Интерфейс редактирования не включает проверку.</span><span class="sxs-lookup"><span data-stu-id="00e53-294">The editing interface doesn't include any validation.</span></span> <span data-ttu-id="00e53-295">Если не указано требуемое значение (например, `ProductName`) или введите строковое значение, в котором ожидается числовое значение (например, введите "слишком много!").</span><span class="sxs-lookup"><span data-stu-id="00e53-295">If you don't provide a required value (such as `ProductName`), or enter a string value where a numeric value is expected (such as entering "Too much!"</span></span> <span data-ttu-id="00e53-296">в текстовое поле `UnitPrice`) будет создано исключение.</span><span class="sxs-lookup"><span data-stu-id="00e53-296">into the `UnitPrice` textbox), an exception will be thrown.</span></span> <span data-ttu-id="00e53-297">В следующем учебнике будет рассмотрено Добавление элементов управления проверки в пользовательский интерфейс редактирования.</span><span class="sxs-lookup"><span data-stu-id="00e53-297">A future tutorial will examine how to add validation controls to the editing user interface.</span></span>
- <span data-ttu-id="00e53-298">Сейчас *все* поля продуктов, которые не предназначены только для чтения, должны быть включены в GridView.</span><span class="sxs-lookup"><span data-stu-id="00e53-298">Currently, *all* product fields that are not read-only must be included in the GridView.</span></span> <span data-ttu-id="00e53-299">Если бы было необходимо удалить поле из GridView, скажем `UnitPrice`, при обновлении данных GridView не задаст значение `UnitPrice` `UpdateParameters`, что привело бы к изменению `UnitPrice` записи базы данных на `NULL` значение.</span><span class="sxs-lookup"><span data-stu-id="00e53-299">If we were to remove a field from the GridView, say `UnitPrice`, when updating the data the GridView would not set the `UnitPrice` `UpdateParameters` value, which would change the database record's `UnitPrice` to a `NULL` value.</span></span> <span data-ttu-id="00e53-300">Аналогичным образом, если обязательное поле, например `ProductName`, удаляется из GridView, обновление завершится ошибкой с тем же «*Column ' ProductName ' не допускает значения NULL*», упомянутого выше.</span><span class="sxs-lookup"><span data-stu-id="00e53-300">Similarly, if a required field, such as `ProductName`, is removed from the GridView, the update will fail with the same "*Column 'ProductName' does not allow nulls*" exception mentioned above.</span></span>
- <span data-ttu-id="00e53-301">Форматирование интерфейса редактирования оставляет массу необходимости.</span><span class="sxs-lookup"><span data-stu-id="00e53-301">The editing interface formatting leaves a lot to be desired.</span></span> <span data-ttu-id="00e53-302">`UnitPrice` отображается с четырьмя десятичными точками.</span><span class="sxs-lookup"><span data-stu-id="00e53-302">The `UnitPrice` is shown with four decimal points.</span></span> <span data-ttu-id="00e53-303">В идеале значения `CategoryID` и `SupplierID` будут содержать элементов управления DropDownList, в которых перечислены категории и поставщики в системе.</span><span class="sxs-lookup"><span data-stu-id="00e53-303">Ideally the `CategoryID` and `SupplierID` values would contain DropDownLists that list the categories and suppliers in the system.</span></span>

<span data-ttu-id="00e53-304">Это все недостатки, с которыми мы будем жить сейчас, но они будут рассмотрены в следующих руководствах.</span><span class="sxs-lookup"><span data-stu-id="00e53-304">These are all shortcomings that we'll have to live with for now, but will be addressed in future tutorials.</span></span>

## <a name="inserting-editing-and-deleting-data-with-the-detailsview"></a><span data-ttu-id="00e53-305">Вставка, изменение и удаление данных с помощью элемента DetailsView</span><span class="sxs-lookup"><span data-stu-id="00e53-305">Inserting, Editing, and Deleting Data with the DetailsView</span></span>

<span data-ttu-id="00e53-306">Как мы видели в предыдущих учебных курсах, элемент управления DetailsView отображает по одной записи за раз и, как GridView, позволяет изменять и удалять отображаемую в данный момент запись.</span><span class="sxs-lookup"><span data-stu-id="00e53-306">As we've seen in earlier tutorials, the DetailsView control displays one record at a time and, like the GridView, allows for editing and deleting of the currently displayed record.</span></span> <span data-ttu-id="00e53-307">Опыт конечного пользователя, редактирующий и удаляющий элементы из элемента DetailsView и рабочего процесса из ASP.NET, идентичен элементу GridView.</span><span class="sxs-lookup"><span data-stu-id="00e53-307">Both the end user's experience with editing and deleting items from a DetailsView and the workflow from the ASP.NET side is identical to that of the GridView.</span></span> <span data-ttu-id="00e53-308">Если элемент DetailsView отличается от GridView, он также предоставляет встроенную поддержку вставки.</span><span class="sxs-lookup"><span data-stu-id="00e53-308">Where the DetailsView differs from the GridView is that it also provides built-in inserting support.</span></span>

<span data-ttu-id="00e53-309">Чтобы продемонстрировать возможности изменения данных GridView, начните с добавления элемента DetailsView на страницу `Basics.aspx` над существующим элементом управления GridView и привяжите его к существующему ObjectDataSource через смарт-тег DetailsView.</span><span class="sxs-lookup"><span data-stu-id="00e53-309">To demonstrate the data modification capabilities of the GridView, start by adding a DetailsView to the `Basics.aspx` page above the existing GridView and bind it to the existing ObjectDataSource through the DetailsView's smart tag.</span></span> <span data-ttu-id="00e53-310">Затем очистите свойства `Height` и `Width` DetailsView, а также установите флажок Включить разбиение по страницам в смарт-теге.</span><span class="sxs-lookup"><span data-stu-id="00e53-310">Next, clear out the DetailsView's `Height` and `Width` properties, and check the Enable Paging option from the smart tag.</span></span> <span data-ttu-id="00e53-311">Чтобы включить поддержку редактирования, вставки и удаления, просто установите флажки Включить редактирование, включить вставку и включить удаление в смарт-теге.</span><span class="sxs-lookup"><span data-stu-id="00e53-311">To enable editing, inserting, and deleting support, simply check the Enable Editing, Enable Inserting, and Enable Deleting checkboxes in the smart tag.</span></span>

![Настройка элемента DetailsView для поддержки редактирования, вставки и удаления](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image41.png)

<span data-ttu-id="00e53-313">**Рис. 17**. Настройка DetailsView для поддержки редактирования, вставки и удаления</span><span class="sxs-lookup"><span data-stu-id="00e53-313">**Figure 17**: Configure the DetailsView to Support Editing, Inserting, and Deleting</span></span>

<span data-ttu-id="00e53-314">Как и в случае с GridView, Добавление поддержки правки, вставки или удаления добавляет CommandField к элементу DetailsView, как показано в следующем декларативном синтаксисе:</span><span class="sxs-lookup"><span data-stu-id="00e53-314">As with the GridView, adding editing, inserting, or deleting support adds a CommandField to the DetailsView, as the following declarative syntax shows:</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample7.aspx)]

<span data-ttu-id="00e53-315">Обратите внимание, что для DetailsView CommandField по умолчанию отображается в конце коллекции Columns.</span><span class="sxs-lookup"><span data-stu-id="00e53-315">Note that for the DetailsView the CommandField appears at the end of the Columns collection by default.</span></span> <span data-ttu-id="00e53-316">Поскольку поля DetailsView подготавливаются к просмотру как строки, CommandField отображается в виде строки с кнопками вставки, правки и удаления в нижней части элемента DetailsView.</span><span class="sxs-lookup"><span data-stu-id="00e53-316">Since the DetailsView's fields are rendered as rows, the CommandField appears as a row with Insert, Edit, and Delete buttons at the bottom of the DetailsView.</span></span>

<span data-ttu-id="00e53-317">[![настроить DetailsView для поддержки редактирования, вставки и удаления](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image43.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-317">[![Configure the DetailsView to Support Editing, Inserting, and Deleting](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image43.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image42.png)</span></span>

<span data-ttu-id="00e53-318">**Рис. 18**. Настройка элемента DetailsView для поддержки редактирования, вставки и удаления ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-318">**Figure 18**: Configure the DetailsView to Support Editing, Inserting, and Deleting ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image44.png))</span></span>

<span data-ttu-id="00e53-319">При нажатии кнопки "Удалить" начинается та же последовательность событий, что и для GridView: обратная передача. после чего элемент управления DetailsView заполняет `DeleteParameters` на основе значений `DataKeyNames`; и завершился с вызовом метода `Delete()` ObjectDataSource, который фактически удаляет продукт из базы данных.</span><span class="sxs-lookup"><span data-stu-id="00e53-319">Clicking on the Delete button starts the same sequence of events as with the GridView: a postback; followed by the DetailsView populating its ObjectDataSource's `DeleteParameters` based on the `DataKeyNames` values; and completed with a call its ObjectDataSource's `Delete()` method, which actually removes the product from the database.</span></span> <span data-ttu-id="00e53-320">Редактирование в DetailsView также работает точно так же, как GridView.</span><span class="sxs-lookup"><span data-stu-id="00e53-320">Editing in the DetailsView also works in a fashion identical to that of the GridView.</span></span>

<span data-ttu-id="00e53-321">Для вставки конечного пользователя отображается новая кнопка, которая при нажатии отображает DetailsView в режиме вставки.</span><span class="sxs-lookup"><span data-stu-id="00e53-321">For inserting, the end user is presented with a New button that, when clicked, renders the DetailsView in "insert mode."</span></span> <span data-ttu-id="00e53-322">При использовании "режима вставки" Новая кнопка заменяется кнопками вставки и отмены и только те BoundFields, для которых свойство `InsertVisible` имеет значение `True` (по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="00e53-322">With "insert mode" the New button is replaced by Insert and Cancel buttons and only those BoundFields whose `InsertVisible` property is set to `True` (the default) are displayed.</span></span> <span data-ttu-id="00e53-323">Эти поля данных, идентифицируемые как поля автоприращения, такие как `ProductID`, имеют [свойство инсертвисибле](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datacontrolfield.insertvisible(VS.80).aspx) со значением `False` при привязке элемента DetailsView к источнику данных через смарт-тег.</span><span class="sxs-lookup"><span data-stu-id="00e53-323">Those data fields identified as auto-increment fields, such as `ProductID`, have their [InsertVisible property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datacontrolfield.insertvisible(VS.80).aspx) set to `False` when binding the DetailsView to the data source through the smart tag.</span></span>

<span data-ttu-id="00e53-324">При привязке источника данных к элементу DetailsView через смарт-тег Visual Studio устанавливает свойство `InsertVisible` в значение `False` только для полей автоприращения.</span><span class="sxs-lookup"><span data-stu-id="00e53-324">When binding a data source to a DetailsView through the smart tag, Visual Studio sets the `InsertVisible` property to `False` only for auto-increment fields.</span></span> <span data-ttu-id="00e53-325">Поля, предназначенные только для чтения, такие как `CategoryName` и `SupplierName`, будут отображаться в пользовательском интерфейсе "режим вставки", если только для свойства `InsertVisible` явно не задано значение `False`.</span><span class="sxs-lookup"><span data-stu-id="00e53-325">Read-only fields, like `CategoryName` and `SupplierName`, will be displayed in the "insert mode" user interface unless their `InsertVisible` property is explicitly set to `False`.</span></span> <span data-ttu-id="00e53-326">Потратьте немного времени, чтобы задать для этих двух полей `InsertVisible` свойства `False`, с помощью декларативного синтаксиса DetailsView или ссылки Edit Fields (изменить поля) в смарт-теге.</span><span class="sxs-lookup"><span data-stu-id="00e53-326">Take a moment to set these two fields' `InsertVisible` properties to `False`, either through the DetailsView's declarative syntax or through the Edit Fields link in the smart tag.</span></span> <span data-ttu-id="00e53-327">На рис. 19 показано, как задать свойства `InsertVisible` для `False`, щелкнув ссылку Edit Fields (изменить поля).</span><span class="sxs-lookup"><span data-stu-id="00e53-327">Figure 19 shows setting the `InsertVisible` properties to `False` by clicking on the Edit Fields link.</span></span>

<span data-ttu-id="00e53-328">[![Northwind Traders теперь предлагает ACME чай](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image46.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-328">[![Northwind Traders Now Offers Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image46.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image45.png)</span></span>

<span data-ttu-id="00e53-329">**Рис. 19**. Теперь компания Northwind Traders предлагает ACME-чай ([щелкните, чтобы просмотреть изображение полного размера](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-329">**Figure 19**: Northwind Traders Now Offers Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image47.png))</span></span>

<span data-ttu-id="00e53-330">После задания свойств `InsertVisible` просмотрите страницу `Basics.aspx` в браузере и нажмите кнопку Создать.</span><span class="sxs-lookup"><span data-stu-id="00e53-330">After setting the `InsertVisible` properties, view the `Basics.aspx` page in a browser and click the New button.</span></span> <span data-ttu-id="00e53-331">На рис. 20 показана DetailsView при добавлении нового напитков, Acme чай в нашу линейку продуктов.</span><span class="sxs-lookup"><span data-stu-id="00e53-331">Figure 20 shows the DetailsView when adding a new beverage, Acme Tea, to our product line.</span></span>

<span data-ttu-id="00e53-332">[![Northwind Traders теперь предлагает ACME чай](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image49.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image48.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-332">[![Northwind Traders Now Offers Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image49.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image48.png)</span></span>

<span data-ttu-id="00e53-333">**Рис. 20**. Теперь компания Northwind Traders предлагает ACME чай ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image50.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-333">**Figure 20**: Northwind Traders Now Offers Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image50.png))</span></span>

<span data-ttu-id="00e53-334">После ввода сведений для «Acme» и нажатия кнопки «Вставить» происходит обратная передача, а новая запись добавляется в таблицу базы данных `Products`.</span><span class="sxs-lookup"><span data-stu-id="00e53-334">After entering the details for Acme Tea and clicking the Insert button, a postback ensues and the new record is added to the `Products` database table.</span></span> <span data-ttu-id="00e53-335">Так как эта DetailsView перечисляет продукты в порядке, в котором они существуют в таблице базы данных, для просмотра нового продукта необходимо выполнить страницу до последнего продукта.</span><span class="sxs-lookup"><span data-stu-id="00e53-335">Since this DetailsView lists the products in order with which they exist in the database table, we must page to the last product in order to see the new product.</span></span>

<span data-ttu-id="00e53-336">[![сведения о чай](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image52.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image51.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-336">[![Details for Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image52.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image51.png)</span></span>

<span data-ttu-id="00e53-337">**Рисунок 21**. сведения для «Acme» ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image53.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-337">**Figure 21**: Details for Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image53.png))</span></span>

> [!NOTE]
> <span data-ttu-id="00e53-338">[Свойство куррентмоде](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.currentmode(VS.80).aspx) элемента DetailsView указывает отображаемый интерфейс и может принимать одно из следующих значений: `Edit`, `Insert`или `ReadOnly`.</span><span class="sxs-lookup"><span data-stu-id="00e53-338">The DetailsView's [CurrentMode property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.currentmode(VS.80).aspx) indicates the interface being displayed and can be one of the following values: `Edit`, `Insert`, or `ReadOnly`.</span></span> <span data-ttu-id="00e53-339">[Свойство DefaultMode](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode(VS.80).aspx) указывает режим, в который элемент DetailsView возвращает значение после завершения операции правки или вставки. он удобен для отображения элемента DetailsView, который постоянно находится в режиме правки или вставки.</span><span class="sxs-lookup"><span data-stu-id="00e53-339">The [DefaultMode property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode(VS.80).aspx) indicates the mode the DetailsView returns to after an edit or insert has been completed and is useful for displaying a DetailsView that is permanently in edit or insert mode.</span></span>

<span data-ttu-id="00e53-340">Точка и щелчок функции вставки и правки элемента управления DetailsView пострадает от тех же ограничений, что и GridView: пользователь должен ввести существующие `CategoryID` и `SupplierID` значения через текстовое поле. в интерфейсе отсутствует логика проверки. все поля продуктов, которые не допускают `NULL` значений или не имеют значения по умолчанию, заданного на уровне базы данных, должны быть включены в интерфейс вставки и т. д.</span><span class="sxs-lookup"><span data-stu-id="00e53-340">The point and click inserting and editing capabilities of the DetailsView suffer from the same limitations as the GridView: the user must enter existing `CategoryID` and `SupplierID` values through a textbox; the interface lacks any validation logic; all product fields that do not allow `NULL` values or don't have a default value specified at the database level must be included in the inserting interface, and so on.</span></span>

<span data-ttu-id="00e53-341">Методы, которые мы рассмотрим для расширения и улучшения интерфейса редактирования GridView в будущих статьях, можно также применить к интерфейсам правки и вставки элемента управления DetailsView.</span><span class="sxs-lookup"><span data-stu-id="00e53-341">The techniques we will examine for extending and enhancing the GridView's editing interface in future articles can be applied to the DetailsView control's editing and inserting interfaces as well.</span></span>

## <a name="using-the-formview-for-a-more-flexible-data-modification-user-interface"></a><span data-ttu-id="00e53-342">Использование элемента FormView для более гибкого пользовательского интерфейса изменения данных</span><span class="sxs-lookup"><span data-stu-id="00e53-342">Using the FormView for a More Flexible Data Modification User Interface</span></span>

<span data-ttu-id="00e53-343">FormView предлагает встроенную поддержку вставки, редактирования и удаления данных, но поскольку в ней используются шаблоны вместо полей, нет места для добавления BoundFields или CommandField, используемых элементами управления GridView и DetailsView для предоставления данных. интерфейс изменения.</span><span class="sxs-lookup"><span data-stu-id="00e53-343">The FormView offers built-in support for inserting, editing, and deleting data, but because it uses templates instead of fields there's no place to add the BoundFields or the CommandField used by the GridView and DetailsView controls to provide the data modification interface.</span></span> <span data-ttu-id="00e53-344">Вместо этого интерфейс веб-элементов управления для сбора вводимых пользователем данных при добавлении нового элемента или редактировании существующего объекта вместе с кнопками создать, изменить, удалить, вставить, обновить и отменить необходимо вручную добавить в соответствующие шаблоны.</span><span class="sxs-lookup"><span data-stu-id="00e53-344">Instead, this interface the Web controls for collecting user input when adding a new item or editing an existing one along with the New, Edit, Delete, Insert, Update, and Cancel buttons must be added manually to the appropriate templates.</span></span> <span data-ttu-id="00e53-345">К счастью, Visual Studio автоматически создаст необходимый интерфейс при привязке элемента FormView к источнику данных с помощью раскрывающегося списка в смарт-теге.</span><span class="sxs-lookup"><span data-stu-id="00e53-345">Fortunately, Visual Studio will automatically create the needed interface when binding the FormView to a data source through the drop-down list in its smart tag.</span></span>

<span data-ttu-id="00e53-346">Чтобы продемонстрировать эти методы, начните с добавления элемента управления FormView на страницу `Basics.aspx` и из смарт-тега FormView привяжите его к уже созданному ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="00e53-346">To illustrate these techniques, start by adding a FormView to the `Basics.aspx` page and, from the FormView's smart tag, bind it to the ObjectDataSource already created.</span></span> <span data-ttu-id="00e53-347">Это приведет к созданию `EditItemTemplate`, `InsertItemTemplate`и `ItemTemplate` для элемента управления FormView с TextBox для получения веб-элементов управления ввода и кнопок пользователя для кнопок создать, изменить, удалить, вставить, обновить и отменить.</span><span class="sxs-lookup"><span data-stu-id="00e53-347">This will generate an `EditItemTemplate`, `InsertItemTemplate`, and `ItemTemplate` for the FormView with TextBox Web controls for collecting the user's input and Button Web controls for the New, Edit, Delete, Insert, Update, and Cancel buttons.</span></span> <span data-ttu-id="00e53-348">Кроме того, для свойства `DataKeyNames` FormView задается поле первичного ключа (`ProductID`) объекта, возвращаемого ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="00e53-348">Additionally, the FormView's `DataKeyNames` property is set to the primary key field (`ProductID`) of the object returned by the ObjectDataSource.</span></span> <span data-ttu-id="00e53-349">Наконец, установите флажок Включить разбиение по страницам в смарт-теге FormView.</span><span class="sxs-lookup"><span data-stu-id="00e53-349">Lastly, check the Enable Paging option in the FormView's smart tag.</span></span>

<span data-ttu-id="00e53-350">Ниже показана декларативная разметка для `ItemTemplate` FormView после привязки элемента управления FormView к ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="00e53-350">The following shows the declarative markup for the FormView's `ItemTemplate` after the FormView has been bound to the ObjectDataSource.</span></span> <span data-ttu-id="00e53-351">По умолчанию каждое поле продукта, не являющегося логическим значением, привязано к свойству `Text` элемента управления Label, тогда как каждое поле логического значения (`Discontinued`) привязано к свойству `Checked` отключенного веб-элемента управления CheckBox.</span><span class="sxs-lookup"><span data-stu-id="00e53-351">By default, each non-Boolean value product field is bound to the `Text` property of a Label Web control while each Boolean value field (`Discontinued`) is bound to the `Checked` property of a disabled CheckBox Web control.</span></span> <span data-ttu-id="00e53-352">Чтобы кнопки создания, изменения и удаления вызывали определенное поведение FormView при щелчке, необходимо установить для их `CommandName` значения `New`, `Edit`и `Delete`соответственно.</span><span class="sxs-lookup"><span data-stu-id="00e53-352">In order for the New, Edit, and Delete buttons to trigger certain FormView behavior when clicked, it is imperative that their `CommandName` values be set to `New`, `Edit`, and `Delete`, respectively.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample8.aspx)]

<span data-ttu-id="00e53-353">На рис. 22 показано `ItemTemplate` FormView при просмотре в браузере.</span><span class="sxs-lookup"><span data-stu-id="00e53-353">Figure 22 shows the FormView's `ItemTemplate` when viewed through a browser.</span></span> <span data-ttu-id="00e53-354">Каждое поле продукта отображается с кнопками создать, изменить и удалить внизу.</span><span class="sxs-lookup"><span data-stu-id="00e53-354">Each product field is listed with the New, Edit, and Delete buttons at the bottom.</span></span>

<span data-ttu-id="00e53-355">[![Дефаут FormView ItemTemplate содержит список всех полей продуктов, а также кнопки "создать", "Изменить" и "Удалить".](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image55.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image54.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-355">[![The Defaut FormView ItemTemplate Lists Each Product Field Along with New, Edit, and Delete Buttons](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image55.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image54.png)</span></span>

<span data-ttu-id="00e53-356">**Рис. 22**. дефаут FormView `ItemTemplate` список всех полей продуктов вместе с кнопками "создать", "Изменить" и "Удалить" ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image56.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-356">**Figure 22**: The Defaut FormView `ItemTemplate` Lists Each Product Field Along with New, Edit, and Delete Buttons ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image56.png))</span></span>

<span data-ttu-id="00e53-357">Как и в случае с GridView и DetailsView, нажатием кнопки удалить или любой кнопкой, LinkButton или ImageButton, свойство `CommandName` которого имеет значение Delete, вызывает обратную передачу, заполняет `DeleteParameters` ObjectDataSource на основе значения `DataKeyNames` FormView и вызывает метод `Delete()` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="00e53-357">Like with the GridView and DetailsView, clicking the Delete button or any Button, LinkButton, or ImageButton whose `CommandName` property is set to Delete causes a postback, populates the ObjectDataSource's `DeleteParameters` based on the FormView's `DataKeyNames` value, and invokes the ObjectDataSource's `Delete()` method.</span></span>

<span data-ttu-id="00e53-358">При нажатии кнопки "Изменить" происходит обратная передача данных, и данные повторно привязываются к `EditItemTemplate`, которая отвечает за визуализацию интерфейса редактирования.</span><span class="sxs-lookup"><span data-stu-id="00e53-358">When the Edit button is clicked a postback ensues and the data is rebound to the `EditItemTemplate`, which is responsible for rendering the editing interface.</span></span> <span data-ttu-id="00e53-359">Этот интерфейс включает веб-элементы управления для редактирования данных вместе с кнопками обновления и отмены.</span><span class="sxs-lookup"><span data-stu-id="00e53-359">This interface includes the Web controls for editing data along with the Update and Cancel buttons.</span></span> <span data-ttu-id="00e53-360">`EditItemTemplate` по умолчанию, создаваемая Visual Studio, содержит метку для всех полей автоприращения (`ProductID`), текстовое поле для каждого поля значения, не являющегося логическим, и флажок для каждого поля логического значения.</span><span class="sxs-lookup"><span data-stu-id="00e53-360">The default `EditItemTemplate` generated by Visual Studio contains a Label for any auto-increment fields (`ProductID`), a TextBox for each non-Boolean value field, and a CheckBox for each Boolean value field.</span></span> <span data-ttu-id="00e53-361">Такое поведение очень похоже на автоматическое создание BoundFields в элементах управления GridView и DetailsView.</span><span class="sxs-lookup"><span data-stu-id="00e53-361">This behavior is very similar to the auto-generated BoundFields in the GridView and DetailsView controls.</span></span>

> [!NOTE]
> <span data-ttu-id="00e53-362">Одной из мелких проблем с автосозданием `EditItemTemplate` FormView является то, что она отображает веб-элементы управления TextBox для полей, доступных только для чтения, таких как `CategoryName` и `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="00e53-362">One small issue with the FormView's auto-generation of the `EditItemTemplate` is that it renders TextBox Web controls for those fields that are read-only, such as `CategoryName` and `SupplierName`.</span></span> <span data-ttu-id="00e53-363">В ближайшее время мы увидим, как это учитывать.</span><span class="sxs-lookup"><span data-stu-id="00e53-363">We'll see how to account for this shortly.</span></span>

<span data-ttu-id="00e53-364">Элементы управления TextBox в `EditItemTemplate` имеют свойства `Text`, привязанные к значению соответствующего поля данных с помощью *двухсторонней привязки*.</span><span class="sxs-lookup"><span data-stu-id="00e53-364">The TextBox controls in the `EditItemTemplate` have their `Text` property bound to the value of their corresponding data field using *two-way databinding*.</span></span> <span data-ttu-id="00e53-365">Двусторонняя привязка, обозначенная `<%# Bind("dataField") %>`, выполняет привязку данных как при привязке к шаблону, так и при заполнении параметров ObjectDataSource для вставки или изменения записей.</span><span class="sxs-lookup"><span data-stu-id="00e53-365">Two-way databinding, denoted by `<%# Bind("dataField") %>`, performs databinding both when binding data to the template and when populating the ObjectDataSource's parameters for inserting or editing records.</span></span> <span data-ttu-id="00e53-366">То есть когда пользователь нажимает кнопку "Изменить" в `ItemTemplate`, метод `Bind()` возвращает указанное значение поля данных.</span><span class="sxs-lookup"><span data-stu-id="00e53-366">That is, when the user clicks the Edit button from the `ItemTemplate`, the `Bind()` method returns the specified data field value.</span></span> <span data-ttu-id="00e53-367">После того как пользователь вносит изменения и нажимает кнопку обновить, значения, соответствующие полям данных, указанным с помощью `Bind()`, применяются к `UpdateParameters`у ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="00e53-367">After the user makes their changes and clicks Update, the values posted back that correspond to the data fields specified using `Bind()` are applied to the ObjectDataSource's `UpdateParameters`.</span></span> <span data-ttu-id="00e53-368">Кроме того, односторонняя привязка, обозначающая `<%# Eval("dataField") %>`, извлекает значения полей данных только при привязке данных к шаблону и *не* возвращает значения, вводимых пользователем, в параметры источника данных при обратной передаче.</span><span class="sxs-lookup"><span data-stu-id="00e53-368">Alternatively, one-way databinding, denoted by `<%# Eval("dataField") %>`, only retrieves the data field values when binding data to the template and does *not* return the user-entered values to the data source's parameters on postback.</span></span>

<span data-ttu-id="00e53-369">В следующей декларативной разметке показано `EditItemTemplate`FormView.</span><span class="sxs-lookup"><span data-stu-id="00e53-369">The following declarative markup shows the FormView's `EditItemTemplate`.</span></span> <span data-ttu-id="00e53-370">Обратите внимание, что метод `Bind()` используется в синтаксисе привязки данных, и для веб-элементов управления "обновление" и "Отмена" заданы соответствующие свойства `CommandName`.</span><span class="sxs-lookup"><span data-stu-id="00e53-370">Note that the `Bind()` method is used in the databinding syntax here and that the Update and Cancel Button Web controls have their `CommandName` properties set accordingly.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample9.aspx)]

<span data-ttu-id="00e53-371">На этом этапе наш `EditItemTemplate`вызовет исключение при попытке использовать его.</span><span class="sxs-lookup"><span data-stu-id="00e53-371">Our `EditItemTemplate`, at this point, will cause an exception to be thrown if we attempt to use it.</span></span> <span data-ttu-id="00e53-372">Проблема заключается в том, что поля `CategoryName` и `SupplierName` отображаются как веб-элементы управления TextBox в `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="00e53-372">The problem is that the `CategoryName` and `SupplierName` fields are rendered as TextBox Web controls in the `EditItemTemplate`.</span></span> <span data-ttu-id="00e53-373">Необходимо изменить эти текстовые поля на метки или полностью удалить их.</span><span class="sxs-lookup"><span data-stu-id="00e53-373">We either need to change these TextBoxes to Labels or remove them altogether.</span></span> <span data-ttu-id="00e53-374">Давайте просто удалим их полностью из `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="00e53-374">Let's simply delete them entirely from the `EditItemTemplate`.</span></span>

<span data-ttu-id="00e53-375">На рис. 23 показан элемент FormView в браузере после нажатия кнопки Edit (изменить) для Chai.</span><span class="sxs-lookup"><span data-stu-id="00e53-375">Figure 23 shows the FormView in a browser after the Edit button has been clicked for Chai.</span></span> <span data-ttu-id="00e53-376">Обратите внимание, что поля `SupplierName` и `CategoryName`, показанные в `ItemTemplate`, больше не существуют, так как они были удалены из `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="00e53-376">Note that the `SupplierName` and `CategoryName` fields shown in the `ItemTemplate` are no longer present, as we just removed them from the `EditItemTemplate`.</span></span> <span data-ttu-id="00e53-377">При нажатии кнопки "перейти" FormView выполняет ту же последовательность шагов, что и элементы управления GridView и DetailsView.</span><span class="sxs-lookup"><span data-stu-id="00e53-377">When the Update button is clicked the FormView proceeds through the same sequence of steps as the GridView and DetailsView controls.</span></span>

<span data-ttu-id="00e53-378">[![по умолчанию в EditItemTemplate показывается каждое редактируемое поле продукта в виде текстового поля или флажка](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image58.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image57.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-378">[![By Default the EditItemTemplate Shows Each Editable Product Field as a TextBox or CheckBox](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image58.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image57.png)</span></span>

<span data-ttu-id="00e53-379">**Рис. 23**. по умолчанию в `EditItemTemplate` отображаются все редактируемые поля продуктов в виде текстового поля или флажка ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image59.png)).</span><span class="sxs-lookup"><span data-stu-id="00e53-379">**Figure 23**: By Default the `EditItemTemplate` Shows Each Editable Product Field as a TextBox or CheckBox ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image59.png))</span></span>

<span data-ttu-id="00e53-380">Когда вы нащелкнули кнопку "вставить", `ItemTemplate` подается обратная передача.</span><span class="sxs-lookup"><span data-stu-id="00e53-380">When the Insert button is clicked the FormView's `ItemTemplate` a postback ensues.</span></span> <span data-ttu-id="00e53-381">Однако данные не привязаны к элементу FormView, так как добавляется новая запись.</span><span class="sxs-lookup"><span data-stu-id="00e53-381">However, no data is bound to the FormView because a new record is being added.</span></span> <span data-ttu-id="00e53-382">Интерфейс `InsertItemTemplate` включает веб-элементы управления для добавления новой записи вместе с кнопками вставки и отмены.</span><span class="sxs-lookup"><span data-stu-id="00e53-382">The `InsertItemTemplate` interface includes the Web controls for adding a new record along with the Insert and Cancel buttons.</span></span> <span data-ttu-id="00e53-383">`InsertItemTemplate` по умолчанию, создаваемая Visual Studio, содержит текстовое поле для каждого поля значения, не являющегося логическим, и флажок для каждого поля логического значения, аналогично автоматически созданному интерфейсу `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="00e53-383">The default `InsertItemTemplate` generated by Visual Studio contains a TextBox for each non-Boolean value field and a CheckBox for each Boolean value field, similar to the auto-generated `EditItemTemplate`'s interface.</span></span> <span data-ttu-id="00e53-384">Элементы управления TextBox имеют свойство `Text`, привязанное к значению соответствующего поля данных, используя двустороннюю привязку данных.</span><span class="sxs-lookup"><span data-stu-id="00e53-384">The TextBox controls have their `Text` property bound to the value of their corresponding data field using two-way databinding.</span></span>

<span data-ttu-id="00e53-385">В следующей декларативной разметке показано `InsertItemTemplate`FormView.</span><span class="sxs-lookup"><span data-stu-id="00e53-385">The following declarative markup shows the FormView's `InsertItemTemplate`.</span></span> <span data-ttu-id="00e53-386">Обратите внимание, что метод `Bind()` используется в синтаксисе привязки данных, и для веб-элементов управления "Вставка" и "Отмена" заданы соответствующие свойства `CommandName`.</span><span class="sxs-lookup"><span data-stu-id="00e53-386">Note that the `Bind()` method is used in the databinding syntax here and that the Insert and Cancel Button Web controls have their `CommandName` properties set accordingly.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample10.aspx)]

<span data-ttu-id="00e53-387">Существует тонкость автоматического создания `InsertItemTemplate`в FormView.</span><span class="sxs-lookup"><span data-stu-id="00e53-387">There's a subtlety with the FormView's auto-generation of the `InsertItemTemplate`.</span></span> <span data-ttu-id="00e53-388">В частности, веб-элементы управления TextBox создаются даже для тех полей, которые доступны только для чтения, например `CategoryName` и `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="00e53-388">Specifically, the TextBox Web controls are created even for those fields that are read-only, such as `CategoryName` and `SupplierName`.</span></span> <span data-ttu-id="00e53-389">Как и в случае с `EditItemTemplate`, необходимо удалить эти текстовые поля из `InsertItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="00e53-389">Like with the `EditItemTemplate`, we need to remove these TextBoxes from the `InsertItemTemplate`.</span></span>

<span data-ttu-id="00e53-390">На рис. 24 показан элемент FormView в браузере при добавлении нового продукта, Acme кофе.</span><span class="sxs-lookup"><span data-stu-id="00e53-390">Figure 24 shows the FormView in a browser when adding a new product, Acme Coffee.</span></span> <span data-ttu-id="00e53-391">Обратите внимание, что поля `SupplierName` и `CategoryName`, показанные в `ItemTemplate`, больше не существуют, так как они были удалены.</span><span class="sxs-lookup"><span data-stu-id="00e53-391">Note that the `SupplierName` and `CategoryName` fields shown in the `ItemTemplate` are no longer present, as we just removed them.</span></span> <span data-ttu-id="00e53-392">При нажатии кнопки «Вставить» FormView выполняет ту же последовательность шагов, что и элемент управления DetailsView, добавляя новую запись в таблицу `Products`.</span><span class="sxs-lookup"><span data-stu-id="00e53-392">When the Insert button is clicked the FormView proceeds through the same sequence of steps as the DetailsView control, adding a new record to the `Products` table.</span></span> <span data-ttu-id="00e53-393">На рис. 25 показаны сведения о продукте ACME кофе в элементе FormView после его вставки.</span><span class="sxs-lookup"><span data-stu-id="00e53-393">Figure 25 shows Acme Coffee product's details in the FormView after it has been inserted.</span></span>

<span data-ttu-id="00e53-394">[![InsertItemTemplate определяет интерфейс вставки FormView](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image61.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image60.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-394">[![The InsertItemTemplate Dictates the FormView's Inserting Interface](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image61.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image60.png)</span></span>

<span data-ttu-id="00e53-395">**Рис. 24**. `InsertItemTemplate` определяет интерфейс вставки FormView ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image62.png))</span><span class="sxs-lookup"><span data-stu-id="00e53-395">**Figure 24**: The `InsertItemTemplate` Dictates the FormView's Inserting Interface ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image62.png))</span></span>

<span data-ttu-id="00e53-396">[![сведения о новом продукте, Acme кофе, отображаются в элементе FormView.](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image64.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image63.png)</span><span class="sxs-lookup"><span data-stu-id="00e53-396">[![The Details for New Product, Acme Coffee, are Displayed in the FormView](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image64.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image63.png)</span></span>

<span data-ttu-id="00e53-397">**Рис. 25**. сведения о новом продукте, Acme кофе, отображаются в элементе FormView ([щелкните, чтобы просмотреть изображение с полным размером](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image65.png)).</span><span class="sxs-lookup"><span data-stu-id="00e53-397">**Figure 25**: The Details for New Product, Acme Coffee, are Displayed in the FormView ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image65.png))</span></span>

<span data-ttu-id="00e53-398">Разделив интерфейсы только для чтения, редактирования и вставки на три отдельных шаблона, FormView обеспечивает более тонкую степень контроля над этими интерфейсами, чем DetailsView и GridView.</span><span class="sxs-lookup"><span data-stu-id="00e53-398">By separating out the read-only, editing, and inserting interfaces into three separate templates, the FormView allows for a finer degree of control over these interfaces than the DetailsView and GridView.</span></span>

> [!NOTE]
> <span data-ttu-id="00e53-399">Как и DetailsView, свойство `CurrentMode` FormView указывает отображаемый интерфейс, а его свойство `DefaultMode` указывает режим, в который функция FormView возвращает значение после завершения операции редактирования или вставки.</span><span class="sxs-lookup"><span data-stu-id="00e53-399">Like the DetailsView, the FormView's `CurrentMode` property indicates the interface being displayed and its `DefaultMode` property indicates the mode the FormView returns to after an edit or insert has been completed.</span></span>

## <a name="summary"></a><span data-ttu-id="00e53-400">Сводка</span><span class="sxs-lookup"><span data-stu-id="00e53-400">Summary</span></span>

<span data-ttu-id="00e53-401">В этом учебнике мы рассмотрели основы вставки, редактирования и удаления данных с помощью элементов управления GridView, DetailsView и FormView.</span><span class="sxs-lookup"><span data-stu-id="00e53-401">In this tutorial we examined the basics of inserting, editing, and deleting data using the GridView, DetailsView, and FormView.</span></span> <span data-ttu-id="00e53-402">Все три этих элемента управления предоставляют определенный уровень встроенных возможностей изменения данных, которые можно использовать без написания единой строки кода на странице ASP.NET благодаря веб-элементам управления данными и ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="00e53-402">All three of these controls provide some level of built-in data modification capabilities that can be utilized without writing a single line of code in the ASP.NET page thanks to the data Web controls and the ObjectDataSource.</span></span> <span data-ttu-id="00e53-403">Однако простые методы Point и Click отображают довольно фраил и наивный пользовательский интерфейс изменения данных.</span><span class="sxs-lookup"><span data-stu-id="00e53-403">However, the simple point and click techniques render a fairly frail and naïve data modification user interface.</span></span> <span data-ttu-id="00e53-404">Чтобы обеспечить проверку, внедрять программные значения, корректно обрабатывать исключения, настраивать пользовательский интерфейс и т. д., необходимо полагаться на множество методов, которые будут обсуждаться в следующих нескольких руководствах.</span><span class="sxs-lookup"><span data-stu-id="00e53-404">To provide validation, inject programmatic values, gracefully handle exceptions, customize the user interface, and so on, we'll need to rely on a bevy of techniques that will be discussed over the next several tutorials.</span></span>

<span data-ttu-id="00e53-405">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="00e53-405">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="00e53-406">Об авторе</span><span class="sxs-lookup"><span data-stu-id="00e53-406">About the Author</span></span>

<span data-ttu-id="00e53-407">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="00e53-407">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="00e53-408">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="00e53-408">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="00e53-409">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="00e53-409">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="00e53-410">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="00e53-410">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="00e53-411">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="00e53-411">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="00e53-412">[Назад](limiting-data-modification-functionality-based-on-the-user-cs.md)
> [Вперед](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="00e53-412">[Previous](limiting-data-modification-functionality-based-on-the-user-cs.md)
[Next](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span></span>
