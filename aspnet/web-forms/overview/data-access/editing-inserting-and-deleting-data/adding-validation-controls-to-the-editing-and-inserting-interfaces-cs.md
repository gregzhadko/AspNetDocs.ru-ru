---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs
title: Добавление элементов управления проверки в интерфейсы правки и вставки (C#) | Документация Майкрософт
author: rick-anderson
description: В этом учебнике мы посмотрим, как легко добавить элементы управления проверки в EditItemTemplate и InsertItemTemplate веб-элемента управления данными, чтобы предоставить дополнительные сведения...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 2086cb1a-ab78-49ae-9c0b-03891c69776a
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs
msc.type: authoredcontent
ms.openlocfilehash: 110ee08f1d0707664ef6268f34ceab9da30a3e61
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78494322"
---
# <a name="adding-validation-controls-to-the-editing-and-inserting-interfaces-c"></a><span data-ttu-id="79b94-103">Добавление элементов управления проверки в интерфейсы правки и вставки (C#)</span><span class="sxs-lookup"><span data-stu-id="79b94-103">Adding Validation Controls to the Editing and Inserting Interfaces (C#)</span></span>

<span data-ttu-id="79b94-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="79b94-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="79b94-105">[Скачивание примера приложения](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_19_CS.exe) или [Загрузка PDF-файла](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/datatutorial19cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="79b94-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_19_CS.exe) or [Download PDF](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/datatutorial19cs1.pdf)</span></span>

> <span data-ttu-id="79b94-106">В этом учебнике мы покажем, как легко добавить элементы управления проверки в EditItemTemplate и InsertItemTemplate веб-элемента управления данными, чтобы обеспечить пользовательский интерфейс с более надежными правами.</span><span class="sxs-lookup"><span data-stu-id="79b94-106">In this tutorial we'll see how easy it is to add validation controls to the EditItemTemplate and InsertItemTemplate of a data Web control, to provide a more foolproof user interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="79b94-107">Введение</span><span class="sxs-lookup"><span data-stu-id="79b94-107">Introduction</span></span>

<span data-ttu-id="79b94-108">Элементы управления GridView и DetailsView в примерах, рассмотренных в прошлых трех учебниках, состоят из BoundFields и Чеккбоксфиелдс (типы полей, автоматически добавленные Visual Studio при привязке элемента управления GridView или DetailsView к источнику данных. Управление через смарт-тег).</span><span class="sxs-lookup"><span data-stu-id="79b94-108">The GridView and DetailsView controls in the examples we've explored over the past three tutorials have all been composed of BoundFields and CheckBoxFields (the field types automatically added by Visual Studio when binding a GridView or DetailsView to a data source control through the smart tag).</span></span> <span data-ttu-id="79b94-109">При редактировании строки в GridView или DetailsView те BoundFields, которые не предназначены только для чтения, преобразуются в текстовые поля, из которых конечный пользователь может изменять существующие данные.</span><span class="sxs-lookup"><span data-stu-id="79b94-109">When editing a row in a GridView or DetailsView, those BoundFields that are not read-only are converted into textboxes, from which the end user can modify the existing data.</span></span> <span data-ttu-id="79b94-110">Аналогичным образом при вставке новой записи в элемент управления DetailsView эти BoundFields, свойство `InsertVisible` которых имеет значение `true` (по умолчанию), отображаются как пустые текстовые поля, в которых пользователь может предоставить значения полей новой записи.</span><span class="sxs-lookup"><span data-stu-id="79b94-110">Similarly, when inserting a new record into a DetailsView control, those BoundFields whose `InsertVisible` property is set to `true` (the default) are rendered as empty textboxes, into which the user can provide the new record's field values.</span></span> <span data-ttu-id="79b94-111">Аналогичным образом, Чеккбоксфиелдс, отключенные в стандартном интерфейсе только для чтения, преобразуются в флажки Enabled в интерфейсах правки и вставки.</span><span class="sxs-lookup"><span data-stu-id="79b94-111">Likewise, CheckBoxFields, which are disabled in the standard, read-only interface, are converted into enabled checkboxes in the editing and inserting interfaces.</span></span>

<span data-ttu-id="79b94-112">Хотя интерфейсы редактирования и вставки по умолчанию для BoundField и CheckBoxField могут быть полезными, интерфейс не имеет какой либо проверки.</span><span class="sxs-lookup"><span data-stu-id="79b94-112">While the default editing and inserting interfaces for the BoundField and CheckBoxField can be helpful, the interface lacks any sort of validation.</span></span> <span data-ttu-id="79b94-113">Если пользователь делает ввод данных недопущенным, например пропускает `ProductName` поле или вводит недопустимое значение для `UnitsInStock` (например,-50), в глубине архитектуры приложения будет создано исключение.</span><span class="sxs-lookup"><span data-stu-id="79b94-113">If a user makes a data entry mistake - such as omitting the `ProductName` field or entering an invalid value for `UnitsInStock` (such as -50) an exception will be raised from within the depths of the application architecture.</span></span> <span data-ttu-id="79b94-114">Хотя это исключение может быть корректно обработано, как показано в [предыдущем руководстве](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md), в идеале пользовательский интерфейс редактирования или вставки будет включать элементы управления проверки, чтобы предотвратить невозможность ввода таких недопустимых данных пользователем в первую очередь.</span><span class="sxs-lookup"><span data-stu-id="79b94-114">While this exception can be gracefully handled as demonstrated in the [previous tutorial](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md), ideally the editing or inserting user interface would include validation controls to prevent a user from entering such invalid data in the first place.</span></span>

<span data-ttu-id="79b94-115">Чтобы предоставить настраиваемый интерфейс редактирования или вставки, необходимо заменить BoundField или CheckBoxField на TemplateField.</span><span class="sxs-lookup"><span data-stu-id="79b94-115">In order to provide a customized editing or inserting interface, we need to replace the BoundField or CheckBoxField with a TemplateField.</span></span> <span data-ttu-id="79b94-116">Полей TemplateField, которая была темой обсуждения в разделе [Использование полей TemplateField в элементе управления GridView](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) и [Использование полей TemplateField в руководствах по элементу управления DetailsView](../custom-formatting/using-templatefields-in-the-detailsview-control-cs.md) , может состоять из нескольких шаблонов, определяющих отдельные интерфейсы для различных состояний строк.</span><span class="sxs-lookup"><span data-stu-id="79b94-116">TemplateFields, which were the topic of discussion in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) and [Using TemplateFields in the DetailsView Control](../custom-formatting/using-templatefields-in-the-detailsview-control-cs.md) tutorials, can consist of multiple templates defining separate interfaces for different row states.</span></span> <span data-ttu-id="79b94-117">`ItemTemplate` TemplateField используется для отображения полей или строк, предназначенных только для чтения, в элементах управления DetailsView или GridView, в то время как `EditItemTemplate` и `InsertItemTemplate` указывают интерфейсы для использования в режимах редактирования и вставки соответственно.</span><span class="sxs-lookup"><span data-stu-id="79b94-117">The TemplateField's `ItemTemplate` is used to when rendering read-only fields or rows in the DetailsView or GridView controls, whereas the `EditItemTemplate` and `InsertItemTemplate` indicate the interfaces to use for the editing and inserting modes, respectively.</span></span>

<span data-ttu-id="79b94-118">В этом учебнике мы рассмотрим, как легко добавить элементы управления проверки в `EditItemTemplate` и `InsertItemTemplate` для предоставления более защищенного пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="79b94-118">In this tutorial we'll see how easy it is to add validation controls to the TemplateField's `EditItemTemplate` and `InsertItemTemplate` to provide a more foolproof user interface.</span></span> <span data-ttu-id="79b94-119">В частности, в этом учебнике используется пример, созданный в статье [изучение событий, связанных с руководством по вставке, обновлению и удалению,](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) и дополнение интерфейсов правки и вставки для включения соответствующей проверки.</span><span class="sxs-lookup"><span data-stu-id="79b94-119">Specifically, this tutorial takes the example created in the [Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) tutorial and augments the editing and inserting interfaces to include appropriate validation.</span></span>

## <a name="step-1-replicating-the-example-fromexamining-the-events-associated-with-inserting-updating-and-deleting"></a><span data-ttu-id="79b94-120">Шаг 1. репликация примера из[проверки событий, связанных с вставкой, обновлением и удалением](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)</span><span class="sxs-lookup"><span data-stu-id="79b94-120">Step 1: Replicating the Example from[Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)</span></span>

<span data-ttu-id="79b94-121">В ходе [изучения событий, связанных с вставкой, обновлением и удалением](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) учебника, мы создали страницу, в которой указаны имена и цены продуктов в редактируемом элементе управления GridView.</span><span class="sxs-lookup"><span data-stu-id="79b94-121">In the [Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) tutorial we created a page that listed the names and prices of the products in an editable GridView.</span></span> <span data-ttu-id="79b94-122">Кроме того, на странице содержится элемент DetailsView, для свойства `DefaultMode` которого было задано значение `Insert`, таким образом, всегда выполняется отрисовка в режиме вставки.</span><span class="sxs-lookup"><span data-stu-id="79b94-122">Additionally, the page included a DetailsView whose `DefaultMode` property was set to `Insert`, thereby always rendering in insert mode.</span></span> <span data-ttu-id="79b94-123">С помощью этой DetailsView пользователь может ввести имя и цену для нового продукта, нажать кнопку Вставить и добавить в систему (см. рис. 1).</span><span class="sxs-lookup"><span data-stu-id="79b94-123">From this DetailsView, the user could enter the name and price for a new product, click Insert, and have it added to the system (see Figure 1).</span></span>

<span data-ttu-id="79b94-124">[![предыдущем примере позволяет пользователям добавлять новые продукты и изменять существующие.](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image2.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="79b94-124">[![The Previous Example Allows Users to Add New Products and Edit Existing Ones](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image2.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image1.png)</span></span>

<span data-ttu-id="79b94-125">**Рис. 1**. предыдущий пример позволяет пользователям добавлять новые продукты и изменять существующие ([щелкните, чтобы просмотреть изображение с полным размером](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image3.png)).</span><span class="sxs-lookup"><span data-stu-id="79b94-125">**Figure 1**: The Previous Example Allows Users to Add New Products and Edit Existing Ones ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image3.png))</span></span>

<span data-ttu-id="79b94-126">Наша цель этого руководства — расширение DetailsView и GridView для предоставления элементов управления проверки.</span><span class="sxs-lookup"><span data-stu-id="79b94-126">Our goal for this tutorial is to augment the DetailsView and GridView to provide validation controls.</span></span> <span data-ttu-id="79b94-127">В частности, наша логика проверки будет:</span><span class="sxs-lookup"><span data-stu-id="79b94-127">In particular, our validation logic will:</span></span>

- <span data-ttu-id="79b94-128">Требовать, чтобы имя было указано при вставке или изменении продукта</span><span class="sxs-lookup"><span data-stu-id="79b94-128">Require that the name be provided when inserting or editing a product</span></span>
- <span data-ttu-id="79b94-129">Требовать, чтобы цена была предоставлена при вставке записи; При редактировании записи будет по-прежнему требоваться Цена, но будет использоваться программная логика в обработчике событий `RowUpdating` GridView, уже присутствующей в предыдущем руководстве.</span><span class="sxs-lookup"><span data-stu-id="79b94-129">Require that the price be provided when inserting a record; when editing a record, we will still require a price, but will use the programmatic logic in the GridView's `RowUpdating` event handler already present from the earlier tutorial</span></span>
- <span data-ttu-id="79b94-130">Убедитесь, что значение, указанное для цены, является допустимым форматом валюты.</span><span class="sxs-lookup"><span data-stu-id="79b94-130">Ensure that the value entered for the price is a valid currency format</span></span>

<span data-ttu-id="79b94-131">Прежде чем можно будет рассмотреть возможность расширения предыдущего примера, чтобы включить проверку, сначала необходимо выполнить репликацию примера со страницы `DataModificationEvents.aspx` на страницу этого руководства, `UIValidation.aspx`.</span><span class="sxs-lookup"><span data-stu-id="79b94-131">Before we can look at augmenting the previous example to include validation, we first need to replicate the example from the `DataModificationEvents.aspx` page to the page for this tutorial, `UIValidation.aspx`.</span></span> <span data-ttu-id="79b94-132">Чтобы сделать это, необходимо скопировать декларативную разметку `DataModificationEvents.aspx` страницы и ее исходный код.</span><span class="sxs-lookup"><span data-stu-id="79b94-132">To accomplish this we need to copy over both the `DataModificationEvents.aspx` page's declarative markup and its source code.</span></span> <span data-ttu-id="79b94-133">Сначала скопируйте декларативную разметку, выполнив следующие действия.</span><span class="sxs-lookup"><span data-stu-id="79b94-133">First copy over the declarative markup by performing the following steps:</span></span>

1. <span data-ttu-id="79b94-134">Открытие страницы `DataModificationEvents.aspx` в Visual Studio</span><span class="sxs-lookup"><span data-stu-id="79b94-134">Open the `DataModificationEvents.aspx` page in Visual Studio</span></span>
2. <span data-ttu-id="79b94-135">Переход к декларативной разметке страницы (нажмите кнопку "источник" в нижней части страницы)</span><span class="sxs-lookup"><span data-stu-id="79b94-135">Go to the page's declarative markup (click on the Source button at the bottom of the page)</span></span>
3. <span data-ttu-id="79b94-136">Скопируйте текст в теги `<asp:Content>` и `</asp:Content>` (строки с 3 по 44), как показано на рис. 2.</span><span class="sxs-lookup"><span data-stu-id="79b94-136">Copy the text within the `<asp:Content>` and `</asp:Content>` tags (lines 3 through 44), as shown in Figure 2.</span></span>

<span data-ttu-id="79b94-137">[![скопировать текст в элемент управления &lt;ASP: Content&gt;](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image5.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="79b94-137">[![Copy the Text Within the &lt;asp:Content&gt; Control](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image5.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image4.png)</span></span>

<span data-ttu-id="79b94-138">**Рис. 2**. копирование текста внутри элемента управления `<asp:Content>` ([щелкните, чтобы просмотреть изображение с полным размером](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="79b94-138">**Figure 2**: Copy the Text Within the `<asp:Content>` Control ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image6.png))</span></span>

1. <span data-ttu-id="79b94-139">Открытие страницы `UIValidation.aspx`</span><span class="sxs-lookup"><span data-stu-id="79b94-139">Open the `UIValidation.aspx` page</span></span>
2. <span data-ttu-id="79b94-140">Переход к декларативной разметке страницы</span><span class="sxs-lookup"><span data-stu-id="79b94-140">Go to the page's declarative markup</span></span>
3. <span data-ttu-id="79b94-141">Вставьте текст в элемент управления `<asp:Content>`.</span><span class="sxs-lookup"><span data-stu-id="79b94-141">Paste the text within the `<asp:Content>` control.</span></span>

<span data-ttu-id="79b94-142">Чтобы скопировать исходный код, откройте страницу `DataModificationEvents.aspx.cs` и скопируйте только текст *внутри* класса `EditInsertDelete_DataModificationEvents`.</span><span class="sxs-lookup"><span data-stu-id="79b94-142">To copy over the source code, open the `DataModificationEvents.aspx.cs` page and copy just the text *within* the `EditInsertDelete_DataModificationEvents` class.</span></span> <span data-ttu-id="79b94-143">Скопируйте три обработчика событий (`Page_Load`, `GridView1_RowUpdating`и `ObjectDataSource1_Inserting`), но **не** копируйте объявление класса или операторы `using`.</span><span class="sxs-lookup"><span data-stu-id="79b94-143">Copy the three event handlers (`Page_Load`, `GridView1_RowUpdating`, and `ObjectDataSource1_Inserting`), but do **not** copy the class declaration or `using` statements.</span></span> <span data-ttu-id="79b94-144">Вставьте скопированный текст *в класс `EditInsertDelete_UIValidation` в `UIValidation.aspx.cs`* .</span><span class="sxs-lookup"><span data-stu-id="79b94-144">Paste the copied text *within* the `EditInsertDelete_UIValidation` class in `UIValidation.aspx.cs`.</span></span>

<span data-ttu-id="79b94-145">После перемещения содержимого и кода с `DataModificationEvents.aspx` на `UIValidation.aspx`, уделите несколько минут тестированию хода выполнения в браузере.</span><span class="sxs-lookup"><span data-stu-id="79b94-145">After moving over the content and code from `DataModificationEvents.aspx` to `UIValidation.aspx`, take a moment to test out your progress in a browser.</span></span> <span data-ttu-id="79b94-146">Вы должны увидеть одни и те же функции в каждой из этих двух страниц (см. рис. 1 для снимка экрана `DataModificationEvents.aspx` в действии).</span><span class="sxs-lookup"><span data-stu-id="79b94-146">You should see the same output and experience the same functionality in each of these two pages (refer back to Figure 1 for a screen shot of `DataModificationEvents.aspx` in action).</span></span>

## <a name="step-2-converting-the-boundfields-into-templatefields"></a><span data-ttu-id="79b94-147">Шаг 2. Преобразование BoundFields в полей TemplateField</span><span class="sxs-lookup"><span data-stu-id="79b94-147">Step 2: Converting the BoundFields Into TemplateFields</span></span>

<span data-ttu-id="79b94-148">Чтобы добавить элементы управления проверки в интерфейсы правки и вставки, BoundFields, используемый элементами управления DetailsView и GridView, необходимо преобразовать в полей TemplateField.</span><span class="sxs-lookup"><span data-stu-id="79b94-148">To add validation controls to the editing and inserting interfaces, the BoundFields used by the DetailsView and GridView controls need to be converted into TemplateFields.</span></span> <span data-ttu-id="79b94-149">Чтобы добиться этого, щелкните ссылку изменить столбцы и изменить поля в смарт-тегах GridView и DetailsView соответственно.</span><span class="sxs-lookup"><span data-stu-id="79b94-149">To achieve this, click on the Edit Columns and Edit Fields links in the GridView and DetailsView's smart tags, respectively.</span></span> <span data-ttu-id="79b94-150">Выберите все BoundFields и щелкните ссылку "преобразовать это поле в TemplateField".</span><span class="sxs-lookup"><span data-stu-id="79b94-150">There, select each of the BoundFields and click the "Convert this field into a TemplateField" link.</span></span>

<span data-ttu-id="79b94-151">[![преобразовать все BoundFields элемента DetailsView и GridView в полей TemplateField](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image8.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="79b94-151">[![Convert Each of the DetailsView's and GridView's BoundFields Into TemplateFields](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image8.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image7.png)</span></span>

<span data-ttu-id="79b94-152">**Рис. 3**. Преобразование всех BoundFields элементов DetailsView и GridView в полей TemplateField ([щелкните, чтобы просмотреть изображение с полным размером](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="79b94-152">**Figure 3**: Convert Each of the DetailsView's and GridView's BoundFields Into TemplateFields ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image9.png))</span></span>

<span data-ttu-id="79b94-153">При преобразовании BoundField в TemplateField с помощью диалогового окна "поля" создается TemplateField, которая имеет те же интерфейсы только для чтения, правки и вставки, что и сам BoundField.</span><span class="sxs-lookup"><span data-stu-id="79b94-153">Converting a BoundField into a TemplateField through the Fields dialog box generates a TemplateField that exhibits the same read-only, editing, and inserting interfaces as the BoundField itself.</span></span> <span data-ttu-id="79b94-154">В следующей разметке показан декларативный синтаксис поля `ProductName` в DetailsView после его преобразования в TemplateField:</span><span class="sxs-lookup"><span data-stu-id="79b94-154">The following markup shows the declarative syntax for the `ProductName` field in the DetailsView after it has been converted into a TemplateField:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample1.aspx)]

<span data-ttu-id="79b94-155">Обратите внимание, что в этом TemplateField созданы три шаблона, которые автоматически создаются `ItemTemplate`, `EditItemTemplate`и `InsertItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="79b94-155">Note that this TemplateField had three templates automatically created `ItemTemplate`, `EditItemTemplate`, and `InsertItemTemplate`.</span></span> <span data-ttu-id="79b94-156">`ItemTemplate` отображает одно значение поля данных (`ProductName`) с помощью веб-элемента управления Label, а `EditItemTemplate` и `InsertItemTemplate` представлять значение поля данных в веб-элементе управления TextBox, связывающем поле данных с свойством `Text` текстового поля, используя двустороннюю привязку данных.</span><span class="sxs-lookup"><span data-stu-id="79b94-156">The `ItemTemplate` displays a single data field value (`ProductName`) using a Label Web control, while the `EditItemTemplate` and `InsertItemTemplate` present the data field value in a TextBox Web control that associates the data field with the TextBox's `Text` property using two-way databinding.</span></span> <span data-ttu-id="79b94-157">Так как мы используем только DetailsView на этой странице для вставки, вы можете удалить `ItemTemplate` и `EditItemTemplate` из двух полей TemplateField, несмотря на то, что они не имеют вреда.</span><span class="sxs-lookup"><span data-stu-id="79b94-157">Since we are only using the DetailsView in this page for inserting, you may remove the `ItemTemplate` and `EditItemTemplate` from the two TemplateFields, although there's no harm in leaving them.</span></span>

<span data-ttu-id="79b94-158">Поскольку GridView не поддерживает встроенные функции вставки элемента управления DetailsView, преобразование поля `ProductName` GridView в TemplateField приводит только к `ItemTemplate` и `EditItemTemplate`:</span><span class="sxs-lookup"><span data-stu-id="79b94-158">Since the GridView does not support the built-in inserting features of the DetailsView, converting the GridView's `ProductName` field into a TemplateField results in only an `ItemTemplate` and `EditItemTemplate`:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample2.aspx)]

<span data-ttu-id="79b94-159">Нажимая кнопку "преобразовать это поле в TemplateField", Visual Studio создаст TemplateField, шаблоны которого имитируют пользовательский интерфейс преобразованной BoundField.</span><span class="sxs-lookup"><span data-stu-id="79b94-159">By clicking the "Convert this field into a TemplateField," Visual Studio has created a TemplateField whose templates mimic the user interface of the converted BoundField.</span></span> <span data-ttu-id="79b94-160">Это можно проверить, перейдя на эту страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="79b94-160">You can verify this by visiting this page through a browser.</span></span> <span data-ttu-id="79b94-161">Вы обнаружите, что внешний вид и поведение полей TemplateField идентичны опыту при использовании BoundFields.</span><span class="sxs-lookup"><span data-stu-id="79b94-161">You'll find that the appearance and behavior of the TemplateFields is identical to the experience when BoundFields were used instead.</span></span>

> [!NOTE]
> <span data-ttu-id="79b94-162">Вы можете настроить интерфейсы редактирования в шаблонах по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="79b94-162">Feel free to customize the editing interfaces in the templates as needed.</span></span> <span data-ttu-id="79b94-163">Например, может потребоваться, чтобы текстовое поле в `UnitPrice` полей TemplateField отображалось как меньшее текстовое поле, чем `ProductName` текстовое поле.</span><span class="sxs-lookup"><span data-stu-id="79b94-163">For example, we may want to have the TextBox in the `UnitPrice` TemplateFields rendered as a smaller textbox than the `ProductName` textbox.</span></span> <span data-ttu-id="79b94-164">Для этого можно задать для свойства `Columns` текстового поля соответствующее значение или предоставить абсолютную ширину с помощью свойства `Width`.</span><span class="sxs-lookup"><span data-stu-id="79b94-164">To accomplish this you can set the TextBox's `Columns` property to an appropriate value or provide an absolute width via the `Width` property.</span></span> <span data-ttu-id="79b94-165">В следующем учебном курсе мы посмотрим, как полностью настроить интерфейс редактирования, заменив текстовое поле на альтернативный веб-элемент управления вводом данных.</span><span class="sxs-lookup"><span data-stu-id="79b94-165">In the next tutorial we'll see how to completely customize the editing interface by replacing the TextBox with an alternate data entry Web control.</span></span>

## <a name="step-3-adding-the-validation-controls-to-the-gridviewsedititemtemplate-s"></a><span data-ttu-id="79b94-166">Шаг 3. Добавление элементов управления проверки в`EditItemTemplate` s элемента GridView</span><span class="sxs-lookup"><span data-stu-id="79b94-166">Step 3: Adding the Validation Controls to the GridView's`EditItemTemplate` s</span></span>

<span data-ttu-id="79b94-167">При создании форм ввода данных важно, чтобы пользователи вводили все необходимые поля и все предоставленные входные данные были допустимыми, правильно отформатированными значениями.</span><span class="sxs-lookup"><span data-stu-id="79b94-167">When constructing data entry forms, it is important that users enter any required fields and that all provided inputs are legal, properly-formatted values.</span></span> <span data-ttu-id="79b94-168">Чтобы обеспечить допустимость входных данных пользователя, ASP.NET предоставляет пять встроенных элементов управления проверки, предназначенных для проверки значения одного элемента управления вводом:</span><span class="sxs-lookup"><span data-stu-id="79b94-168">To help ensure that a user's inputs are valid, ASP.NET provides five built-in validation controls that are designed to be used to validate the value of a single input control:</span></span>

- <span data-ttu-id="79b94-169">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) гарантирует, что указано значение</span><span class="sxs-lookup"><span data-stu-id="79b94-169">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) ensures that a value has been provided</span></span>
- <span data-ttu-id="79b94-170">Объект [CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) проверяет значение относительно другого значения веб-элемента управления или постоянного значения или обеспечивает допустимость формата значения для указанного типа данных.</span><span class="sxs-lookup"><span data-stu-id="79b94-170">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) validates a value against another Web control value or a constant value, or ensures that the value's format is legal for a specified data type</span></span>
- <span data-ttu-id="79b94-171">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) гарантирует, что значение находится в диапазоне значений</span><span class="sxs-lookup"><span data-stu-id="79b94-171">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) ensures that a value is within a range of values</span></span>
- <span data-ttu-id="79b94-172">[Регуларекспрессионвалидатор](https://msdn.microsoft.com/library/eahwtc9e.aspx) проверяет значение по [регулярному выражению](http://en.wikipedia.org/wiki/Regular_expression)</span><span class="sxs-lookup"><span data-stu-id="79b94-172">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) validates a value against a [regular expression](http://en.wikipedia.org/wiki/Regular_expression)</span></span>
- <span data-ttu-id="79b94-173">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) проверяет значение для пользовательского, определяемого пользователем метода</span><span class="sxs-lookup"><span data-stu-id="79b94-173">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) validates a value against a custom, user-defined method</span></span>

<span data-ttu-id="79b94-174">Дополнительные сведения об этих пяти элементах управления см. в [разделе "элементы проверки" статьи](https://quickstarts.asp.net/quickstartv20/aspnet/doc/ctrlref/validation/default.aspx) [краткие руководства по ASP.NET](https://asp.net/QuickStart/aspnet/).</span><span class="sxs-lookup"><span data-stu-id="79b94-174">For more information on these five controls, check out the [Validation Controls section](https://quickstarts.asp.net/quickstartv20/aspnet/doc/ctrlref/validation/default.aspx) of the [ASP.NET Quickstart Tutorials](https://asp.net/QuickStart/aspnet/).</span></span>

<span data-ttu-id="79b94-175">В нашем учебном курсе необходимо использовать RequiredFieldValidator в элементах управления DetailsView и GridView `ProductName` полей TemplateField и RequiredFieldValidator в `UnitPrice` TemplateField DetailsView.</span><span class="sxs-lookup"><span data-stu-id="79b94-175">For our tutorial we'll need to use a RequiredFieldValidator in both the DetailsView and GridView's `ProductName` TemplateFields and a RequiredFieldValidator in the DetailsView's `UnitPrice` TemplateField.</span></span> <span data-ttu-id="79b94-176">Кроме того, необходимо добавить объект CompareValidator в элементы управления `UnitPrice` полей TemplateField, гарантирующие, что введенная цена имеет значение, большее или равное 0, и представлено в допустимом формате валюты.</span><span class="sxs-lookup"><span data-stu-id="79b94-176">Furthermore, we'll need to add a CompareValidator to both controls' `UnitPrice` TemplateFields that ensures that the entered price has a value greater than or equal to 0 and is presented in a valid currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="79b94-177">Хотя в ASP.NET 1. x существовали те же пять элементов управления проверки, ASP.NET 2,0 добавил ряд усовершенствований, две основные возможности поддержки сценариев на стороне клиента для браузеров, отличных от Internet Explorer, и возможность секционировать элементы управления проверкой на странице в группы проверки.</span><span class="sxs-lookup"><span data-stu-id="79b94-177">While ASP.NET 1.x had these same five validation controls, ASP.NET 2.0 has added a number of improvements, the main two being client-side script support for browsers other than Internet Explorer and the ability to partition validation controls on a page into validation groups.</span></span> <span data-ttu-id="79b94-178">Дополнительные сведения о новых возможностях элементов управления проверки в 2,0 см. в статье [которая разбила The проверки элементов управления в ASP.NET 2,0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="79b94-178">For more information on the new validation control features in 2.0, refer to [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span></span>

<span data-ttu-id="79b94-179">Начнем с добавления необходимых элементов управления проверки в `EditItemTemplate` s в полей TemplateField GridView.</span><span class="sxs-lookup"><span data-stu-id="79b94-179">Let's start by adding the necessary validation controls to the `EditItemTemplate` s in the GridView's TemplateFields.</span></span> <span data-ttu-id="79b94-180">Чтобы сделать это, щелкните ссылку изменить шаблоны в смарт-теге GridView, чтобы открыть интерфейс редактирования шаблонов.</span><span class="sxs-lookup"><span data-stu-id="79b94-180">To accomplish this, click on the Edit Templates link from the GridView's smart tag to bring up the template editing interface.</span></span> <span data-ttu-id="79b94-181">Здесь можно выбрать шаблон для редактирования из раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="79b94-181">From here, you can select which template to edit from the drop-down list.</span></span> <span data-ttu-id="79b94-182">Так как мы хотим расширить интерфейс редактирования, нам нужно добавить элементы управления проверки в `ProductName` и `UnitPrice``EditItemTemplate` s.</span><span class="sxs-lookup"><span data-stu-id="79b94-182">Since we want to augment the editing interface, we need to add validation controls to the `ProductName` and `UnitPrice`'s `EditItemTemplate` s.</span></span>

<span data-ttu-id="79b94-183">[![нам нужно расширить Едититемтемплатес ProductName и UnitPrice](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image11.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="79b94-183">[![We Need to Extend the ProductName and UnitPrice's EditItemTemplates](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image11.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image10.png)</span></span>

<span data-ttu-id="79b94-184">**Рис. 4**. необходимо расширить `ProductName` и `UnitPrice``EditItemTemplate` s ([щелкните, чтобы просмотреть изображение с полным размером](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="79b94-184">**Figure 4**: We Need to Extend the `ProductName` and `UnitPrice`'s `EditItemTemplate` s ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image12.png))</span></span>

<span data-ttu-id="79b94-185">В `ProductName` `EditItemTemplate`добавьте RequiredFieldValidator, перетащив его из панели элементов в интерфейс редактирования шаблона, поместив после текстового поля.</span><span class="sxs-lookup"><span data-stu-id="79b94-185">In the `ProductName` `EditItemTemplate`, add a RequiredFieldValidator by dragging it from the Toolbox into the template editing interface, placing after the TextBox.</span></span>

<span data-ttu-id="79b94-186">[![добавить RequiredFieldValidator в ProductName EditItemTemplate](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image14.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="79b94-186">[![Add a RequiredFieldValidator to the ProductName EditItemTemplate](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image14.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image13.png)</span></span>

<span data-ttu-id="79b94-187">**Рис. 5**. Добавление RequiredFieldValidator в `EditItemTemplate` `ProductName` ([щелкните, чтобы просмотреть изображение с полным размером](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="79b94-187">**Figure 5**: Add a RequiredFieldValidator to the `ProductName` `EditItemTemplate` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image15.png))</span></span>

<span data-ttu-id="79b94-188">Все элементы управления проверки работают путем проверки входных данных одного веб-элемента управления ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="79b94-188">All validation controls work by validating the input of a single ASP.NET Web control.</span></span> <span data-ttu-id="79b94-189">Поэтому необходимо указать, что RequiredFieldValidator, который мы только что добавили, должен проверяться на соответствие текстовому полю в `EditItemTemplate`; Это достигается путем присвоения [свойству ControlToValidate](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) проверяющего элемента `ID` соответствующего веб-элемента управления.</span><span class="sxs-lookup"><span data-stu-id="79b94-189">Therefore, we need to indicate that the RequiredFieldValidator we just added should validate against the TextBox in the `EditItemTemplate`; this is accomplished by setting the validation control's [ControlToValidate property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) to the `ID` of the appropriate Web control.</span></span> <span data-ttu-id="79b94-190">В настоящее время текстовое поле имеет довольно неопределенный `ID` `TextBox1`, но давайте изменим его на что-то более подходящее.</span><span class="sxs-lookup"><span data-stu-id="79b94-190">The TextBox currently has the rather nondescript `ID` of `TextBox1`, but let's change it to something more appropriate.</span></span> <span data-ttu-id="79b94-191">Щелкните текстовое поле в шаблоне, а затем в окно свойств измените `ID` с `TextBox1` на `EditProductName`.</span><span class="sxs-lookup"><span data-stu-id="79b94-191">Click on the TextBox in the template and then, from the Properties window, change the `ID` from `TextBox1` to `EditProductName`.</span></span>

<span data-ttu-id="79b94-192">[![изменить идентификатор TextBox на Едитпродуктнаме](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image17.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="79b94-192">[![Change the TextBox's ID to EditProductName](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image17.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image16.png)</span></span>

<span data-ttu-id="79b94-193">**Рис. 6**. изменение `ID` текстового поля на `EditProductName` ([щелкните, чтобы просмотреть изображение с полным размером](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="79b94-193">**Figure 6**: Change the TextBox's `ID` to `EditProductName` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image18.png))</span></span>

<span data-ttu-id="79b94-194">Затем задайте для свойства `ControlToValidate` RequiredFieldValidator значение `EditProductName`.</span><span class="sxs-lookup"><span data-stu-id="79b94-194">Next, set the RequiredFieldValidator's `ControlToValidate` property to `EditProductName`.</span></span> <span data-ttu-id="79b94-195">Наконец, задайте для [свойства ErrorMessage](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) значение "необходимо указать имя продукта", а [свойству Text](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) — значение "\*".</span><span class="sxs-lookup"><span data-stu-id="79b94-195">Finally, set the [ErrorMessage property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) to "You must provide the product's name" and the [Text property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) to "\*".</span></span> <span data-ttu-id="79b94-196">Значение свойства `Text`, если оно указано, является текстом, отображаемым элементом управления проверки, если проверка завершается неудачно.</span><span class="sxs-lookup"><span data-stu-id="79b94-196">The `Text` property value, if provided, is the text that is displayed by the validation control if the validation fails.</span></span> <span data-ttu-id="79b94-197">Значение свойства `ErrorMessage`, которое является обязательным, используется элементом управления ValidationSummary; Если значение свойства `Text` опущено, `ErrorMessage` значение свойства также является текстом, отображаемым элементом управления проверки на недопустимые входные данные.</span><span class="sxs-lookup"><span data-stu-id="79b94-197">The `ErrorMessage` property value, which is required, is used by the ValidationSummary control; if the `Text` property value is omitted, the `ErrorMessage` property value is also the text displayed by the validation control on invalid input.</span></span>

<span data-ttu-id="79b94-198">После установки этих трех свойств RequiredFieldValidator экран должен выглядеть примерно так, как показано на рис. 7.</span><span class="sxs-lookup"><span data-stu-id="79b94-198">After setting these three properties of the RequiredFieldValidator, your screen should look similar to Figure 7.</span></span>

<span data-ttu-id="79b94-199">[![задать свойства ControlToValidate, ErrorMessage и Text для RequiredFieldValidator](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image20.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="79b94-199">[![Set the RequiredFieldValidator's ControlToValidate, ErrorMessage, and Text Properties](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image20.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image19.png)</span></span>

<span data-ttu-id="79b94-200">**Рис. 7**. задание свойств `ControlToValidate`, `ErrorMessage`и `Text` для RequiredFieldValidator ([щелкните, чтобы просмотреть изображение с полным размером](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="79b94-200">**Figure 7**: Set the RequiredFieldValidator's `ControlToValidate`, `ErrorMessage`, and `Text` Properties ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image21.png))</span></span>

<span data-ttu-id="79b94-201">После добавления RequiredFieldValidator в `EditItemTemplate``ProductName` остается только добавить необходимую проверку в `UnitPrice` `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="79b94-201">With the RequiredFieldValidator added to the `ProductName` `EditItemTemplate`, all that remains is to add the necessary validation to the `UnitPrice` `EditItemTemplate`.</span></span> <span data-ttu-id="79b94-202">Поскольку мы решили, что для этой страницы `UnitPrice` не является обязательным при редактировании записи, нам не нужно добавлять RequiredFieldValidator.</span><span class="sxs-lookup"><span data-stu-id="79b94-202">Since we've decided that, for this page, the `UnitPrice` is optional when editing a record, we don't need to add a RequiredFieldValidator.</span></span> <span data-ttu-id="79b94-203">Однако нам нужно добавить объект CompareValidator, чтобы `UnitPrice`, если он указан, правильно отформатирована как денежная единица и больше или равна 0.</span><span class="sxs-lookup"><span data-stu-id="79b94-203">We do, however, need to add a CompareValidator to ensure that the `UnitPrice`, if supplied, is properly formatted as a currency and is greater than or equal to 0.</span></span>

<span data-ttu-id="79b94-204">Прежде чем добавить объект CompareValidator в `EditItemTemplate``UnitPrice`, сначала измените идентификатор веб-элемента управления TextBox с `TextBox2` на `EditUnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="79b94-204">Before we add the CompareValidator to the `UnitPrice` `EditItemTemplate`, let's first change the TextBox Web control's ID from `TextBox2` to `EditUnitPrice`.</span></span> <span data-ttu-id="79b94-205">После внесения этого изменения добавьте объект CompareValidator, установив для его свойства `ControlToValidate` значение `EditUnitPrice`, его свойство `ErrorMessage` значение "цена должна быть больше или равна нулю и не может включать символ валюты", а также его свойство `Text` в "\*".</span><span class="sxs-lookup"><span data-stu-id="79b94-205">After making this change, add the CompareValidator, setting its `ControlToValidate` property to `EditUnitPrice`, its `ErrorMessage` property to "The price must be greater than or equal to zero and cannot include the currency symbol", and its `Text` property to "\*".</span></span>

<span data-ttu-id="79b94-206">Чтобы указать, что значение `UnitPrice` должно быть больше или равно 0, установите [свойство оператора](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) CompareValidator в значение `GreaterThanEqual`, [свойство валуетокомпаре](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) в значение 0, а [свойство Type](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) — в значение `Currency`.</span><span class="sxs-lookup"><span data-stu-id="79b94-206">To indicate that the `UnitPrice` value must be greater than or equal to 0, set the CompareValidator's [Operator property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) to `GreaterThanEqual`, its [ValueToCompare property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) to "0", and its [Type property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) to `Currency`.</span></span> <span data-ttu-id="79b94-207">Следующий декларативный синтаксис показывает `EditItemTemplate` `UnitPrice` TemplateField после внесения этих изменений:</span><span class="sxs-lookup"><span data-stu-id="79b94-207">The following declarative syntax shows the `UnitPrice` TemplateField's `EditItemTemplate` after these changes have been made:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample3.aspx)]

<span data-ttu-id="79b94-208">После внесения этих изменений откройте страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="79b94-208">After making these changes, open the page in a browser.</span></span> <span data-ttu-id="79b94-209">Если вы попытаетесь опустить имя или ввести недопустимое значение цены при редактировании продукта, рядом с текстовым полем появится звездочка.</span><span class="sxs-lookup"><span data-stu-id="79b94-209">If you attempt to omit the name or enter an invalid price value when editing a product, an asterisk appears next to the textbox.</span></span> <span data-ttu-id="79b94-210">Как показано на рис. 8, значение цены, включающее символ валюты, например $19,95, считается недопустимым.</span><span class="sxs-lookup"><span data-stu-id="79b94-210">As Figure 8 shows, a price value that includes the currency symbol such as $19.95 is considered invalid.</span></span> <span data-ttu-id="79b94-211">`Currency` объекта CompareValidator `Type` допускает разделители цифр (например, запятые или точки, в зависимости от настроек языка и региональных параметров) и начальный знак плюса или минуса, но *не* допускает символ валюты.</span><span class="sxs-lookup"><span data-stu-id="79b94-211">The CompareValidator's `Currency` `Type` allows for digit separators (such as commas or periods, depending on the culture settings) and a leading plus or minus sign, but does *not* permit a currency symbol.</span></span> <span data-ttu-id="79b94-212">Это поведение может озадачить пользователей, так как интерфейс правки в настоящее время визуализирует `UnitPrice`, используя формат валюты.</span><span class="sxs-lookup"><span data-stu-id="79b94-212">This behavior may perplex users as the editing interface currently renders the `UnitPrice` using the currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="79b94-213">Вспомним, что в учебнике *события, связанные с вставкой, обновлением и удалением,* мы установили для свойства `DataFormatString` BoundField значение `{0:c}`, чтобы отформатировать его как денежную единицу.</span><span class="sxs-lookup"><span data-stu-id="79b94-213">Recall that in the *Events Associated with Inserting, Updating, and Deleting* tutorial we set the BoundField's `DataFormatString` property to `{0:c}` in order to format it as a currency.</span></span> <span data-ttu-id="79b94-214">Кроме того, свойству `ApplyFormatInEditMode` присваивается значение true, в результате чего интерфейс редактирования GridView форматирует `UnitPrice` как денежную единицу.</span><span class="sxs-lookup"><span data-stu-id="79b94-214">Furthermore, we set the `ApplyFormatInEditMode` property to true, causing the GridView's editing interface to format the `UnitPrice` as a currency.</span></span> <span data-ttu-id="79b94-215">При преобразовании BoundField в TemplateField Visual Studio отметил эти параметры и отформатирует свойство `Text` текстового поля как денежную единицу с помощью синтаксиса DataBinding `<%# Bind("UnitPrice", "{0:c}") %>`.</span><span class="sxs-lookup"><span data-stu-id="79b94-215">When converting the BoundField into a TemplateField, Visual Studio noted these settings and formatted the TextBox's `Text` property as a currency using the databinding syntax `<%# Bind("UnitPrice", "{0:c}") %>`.</span></span>

<span data-ttu-id="79b94-216">[![звездочка отображается рядом с текстовыми полями с недопустимыми входными данными](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image23.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="79b94-216">[![An Asterisk Appears Next to the Textboxes with Invalid Input](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image23.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image22.png)</span></span>

<span data-ttu-id="79b94-217">**Рис. 8**. Звездочка рядом с текстовыми полями с недопустимым входом ([щелкните, чтобы просмотреть изображение с полным размером](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="79b94-217">**Figure 8**: An Asterisk Appears Next to the Textboxes with Invalid Input ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image24.png))</span></span>

<span data-ttu-id="79b94-218">Хотя проверка работает как есть, пользователь должен вручную удалить символ валюты при редактировании записи, что неприемлемо.</span><span class="sxs-lookup"><span data-stu-id="79b94-218">While the validation works as-is, the user has to manually remove the currency symbol when editing a record, which is not acceptable.</span></span> <span data-ttu-id="79b94-219">Для устранения этой проблемы у нас есть три варианта:</span><span class="sxs-lookup"><span data-stu-id="79b94-219">To remedy this, we have three options:</span></span>

1. <span data-ttu-id="79b94-220">Настройте `EditItemTemplate` таким образом, чтобы значение `UnitPrice` не отформатировано как денежная единица.</span><span class="sxs-lookup"><span data-stu-id="79b94-220">Configure the `EditItemTemplate` so that the `UnitPrice` value is not formatted as a currency.</span></span>
2. <span data-ttu-id="79b94-221">Разрешить пользователю вводить символ валюты, удаляя объект CompareValidator и заменяя его Регуларекспрессионвалидатор, который правильно проверяет значение валюты в правильном формате.</span><span class="sxs-lookup"><span data-stu-id="79b94-221">Allow the user to enter a currency symbol by removing the CompareValidator and replacing it with a RegularExpressionValidator that properly checks for a properly formatted currency value.</span></span> <span data-ttu-id="79b94-222">Проблема в том, что регулярное выражение для проверки значения валюты не вполне достаточно и потребует написания кода, если нам хотелось бы включить параметры языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="79b94-222">The problem here is that the regular expression to validate a currency value is not pretty and would require writing code if we wanted to incorporate culture settings.</span></span>
3. <span data-ttu-id="79b94-223">Полностью удалите элемент управления проверки и полагаются на логику проверки на стороне сервера в обработчике событий `RowUpdating` GridView.</span><span class="sxs-lookup"><span data-stu-id="79b94-223">Remove the validation control altogether and rely on server-side validation logic in the GridView's `RowUpdating` event handler.</span></span>

<span data-ttu-id="79b94-224">Давайте перейдем к параметру #1 для этого упражнения.</span><span class="sxs-lookup"><span data-stu-id="79b94-224">Let's go with option #1 for this exercise.</span></span> <span data-ttu-id="79b94-225">В настоящее время `UnitPrice` форматируется как валюта из-за выражения привязки данных для текстового поля в `EditItemTemplate`: `<%# Bind("UnitPrice", "{0:c}") %>`.</span><span class="sxs-lookup"><span data-stu-id="79b94-225">Currently the `UnitPrice` is formatted as a currency due to the databinding expression for the TextBox in the `EditItemTemplate`: `<%# Bind("UnitPrice", "{0:c}") %>`.</span></span> <span data-ttu-id="79b94-226">Измените инструкцию Bind на `Bind("UnitPrice", "{0:n2}")`, которая форматирует результат как число с двумя цифрами точности.</span><span class="sxs-lookup"><span data-stu-id="79b94-226">Change the Bind statement to `Bind("UnitPrice", "{0:n2}")`, which formats the result as a number with two digits of precision.</span></span> <span data-ttu-id="79b94-227">Это можно сделать напрямую с помощью декларативного синтаксиса или щелкнув ссылку Edit DataBindings (изменить ссылки на данные) в текстовом поле `EditUnitPrice` в `EditItemTemplate`е `UnitPrice` TemplateField (см. рис. 9 и 10).</span><span class="sxs-lookup"><span data-stu-id="79b94-227">This can be done directly through the declarative syntax or by clicking on the Edit DataBindings link from the `EditUnitPrice` TextBox in the `UnitPrice` TemplateField's `EditItemTemplate` (see Figures 9 and 10).</span></span>

<span data-ttu-id="79b94-228">[![щелкните ссылку изменить привязки к элементу TextBox.](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image26.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="79b94-228">[![Click on the TextBox's Edit DataBindings link](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image26.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image25.png)</span></span>

<span data-ttu-id="79b94-229">**Рис. 9**. Щелкните ссылку Edit DataBindings (Правка) текстового поля ([щелкните, чтобы просмотреть изображение с полным размером](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="79b94-229">**Figure 9**: Click on the TextBox's Edit DataBindings link ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image27.png))</span></span>

<span data-ttu-id="79b94-230">[![указать описатель формата в инструкции BIND](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image29.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="79b94-230">[![Specify the Format Specifier in the Bind Statement](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image29.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image28.png)</span></span>

<span data-ttu-id="79b94-231">**Рис. 10**. Указание описателя формата в операторе `Bind` ([щелкните, чтобы просмотреть изображение с полным размером](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="79b94-231">**Figure 10**: Specify the Format Specifier in the `Bind` Statement ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image30.png))</span></span>

<span data-ttu-id="79b94-232">При этом изменении отформатированная Цена в интерфейсе редактирования включает запятые в качестве разделителя групп и точку в качестве десятичного разделителя, но оставляет символ валюты.</span><span class="sxs-lookup"><span data-stu-id="79b94-232">With this change, the formatted price in the editing interface includes commas as the group separator and a period as the decimal separator, but leaves off the currency symbol.</span></span>

> [!NOTE]
> <span data-ttu-id="79b94-233">`UnitPrice` `EditItemTemplate` не содержит RequiredFieldValidator, что позволяет выполнить обратную передачу и инициировать логику обновления.</span><span class="sxs-lookup"><span data-stu-id="79b94-233">The `UnitPrice` `EditItemTemplate` doesn't include a RequiredFieldValidator, allowing the postback to ensue and the updating logic to commence.</span></span> <span data-ttu-id="79b94-234">Однако обработчик событий `RowUpdating`, скопированный из руководства по *вставке, обновлению и удалению* , содержит программную проверку, которая гарантирует, что `UnitPrice` предоставляется.</span><span class="sxs-lookup"><span data-stu-id="79b94-234">However, the `RowUpdating` event handler copied over from the *Examining the Events Associated with Inserting, Updating, and Deleting* tutorial includes a programmatic check that ensures that the `UnitPrice` is provided.</span></span> <span data-ttu-id="79b94-235">Вы можете удалить эту логику, оставить ее в виде "как есть" или добавить RequiredFieldValidator в `EditItemTemplate``UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="79b94-235">Feel free to remove this logic, leave it in as-is, or add a RequiredFieldValidator to the `UnitPrice` `EditItemTemplate`.</span></span>

## <a name="step-4-summarizing-data-entry-problems"></a><span data-ttu-id="79b94-236">Шаг 4. сводка проблем ввода данных</span><span class="sxs-lookup"><span data-stu-id="79b94-236">Step 4: Summarizing Data Entry Problems</span></span>

<span data-ttu-id="79b94-237">В дополнение к пяти проверочным элементам управления ASP.NET включает [элемент управления ValidationSummary](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), который отображает `ErrorMessage`ные элементы управления проверки, которые обнаружили недопустимые данные.</span><span class="sxs-lookup"><span data-stu-id="79b94-237">In addition to the five validation controls, ASP.NET includes the [ValidationSummary control](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), which displays the `ErrorMessage` s of those validation controls that detected invalid data.</span></span> <span data-ttu-id="79b94-238">Сводные данные могут отображаться в виде текста на веб-странице или с помощью модального окна MessageBox на стороне клиента.</span><span class="sxs-lookup"><span data-stu-id="79b94-238">This summary data can be displayed as text on the web page or through a modal, client-side messagebox.</span></span> <span data-ttu-id="79b94-239">Попробуем улучшить этот учебник, чтобы включить в клиент MessageBox сводку по всем проблемам проверки.</span><span class="sxs-lookup"><span data-stu-id="79b94-239">Let's enhance this tutorial to include a client-side messagebox summarizing any validation problems.</span></span>

<span data-ttu-id="79b94-240">Для этого перетащите элемент управления ValidationSummary с панели инструментов в конструктор.</span><span class="sxs-lookup"><span data-stu-id="79b94-240">To accomplish this, drag a ValidationSummary control from the Toolbox onto the Designer.</span></span> <span data-ttu-id="79b94-241">Расположение элемента управления проверки не имеет значения, так как мы настроим его для вывода сводки только в виде MessageBox.</span><span class="sxs-lookup"><span data-stu-id="79b94-241">The location of the Validation control doesn't really matter, since we're going to configure it to only display the summary as a messagebox.</span></span> <span data-ttu-id="79b94-242">После добавления элемента управления задайте для его [Свойства шовсуммари](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) значение `false` а [свойству метода showmessagebox](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) — значение `true`.</span><span class="sxs-lookup"><span data-stu-id="79b94-242">After adding the control, set its [ShowSummary property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) to `false` and its [ShowMessageBox property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) to `true`.</span></span> <span data-ttu-id="79b94-243">Благодаря этому добавлению все ошибки проверки обрабатываются в элементе MessageBox на стороне клиента.</span><span class="sxs-lookup"><span data-stu-id="79b94-243">With this addition, any validation errors are summarized in a client-side messagebox.</span></span>

<span data-ttu-id="79b94-244">[![ошибки проверки обобщены в окне MessageBox на стороне клиента](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image32.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="79b94-244">[![The Validation Errors are Summarized in a Client-Side Messagebox](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image32.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image31.png)</span></span>

<span data-ttu-id="79b94-245">**Рис. 11**. ошибки проверки обобщены в окне MessageBox на стороне клиента ([щелкните, чтобы просмотреть изображение с полным размером](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="79b94-245">**Figure 11**: The Validation Errors are Summarized in a Client-Side Messagebox ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image33.png))</span></span>

## <a name="step-5-adding-the-validation-controls-to-the-detailsviewsinsertitemtemplate"></a><span data-ttu-id="79b94-246">Шаг 5. Добавление элементов управления проверки в`InsertItemTemplate` элемента DetailsView</span><span class="sxs-lookup"><span data-stu-id="79b94-246">Step 5: Adding the Validation Controls to the DetailsView's`InsertItemTemplate`</span></span>

<span data-ttu-id="79b94-247">Все, что остается в этом руководстве, — добавить элементы управления проверки в интерфейс вставки DetailsView.</span><span class="sxs-lookup"><span data-stu-id="79b94-247">All that remains for this tutorial is to add the validation controls to the DetailsView's inserting interface.</span></span> <span data-ttu-id="79b94-248">Процесс добавления элементов управления проверки в шаблоны DetailsView идентичен тому, что был проверен в шаге 3. Поэтому мы удалим задачу на этом шаге.</span><span class="sxs-lookup"><span data-stu-id="79b94-248">The process of adding validation controls to the DetailsView's templates is identical to that examined in Step 3; therefore, we'll breeze through the task in this step.</span></span> <span data-ttu-id="79b94-249">Как и в случае с `EditItemTemplate` GridView, я рекомендую переименовать `ID` s из текстовых полей из `TextBox1` неопределенный и `TextBox2` в `InsertProductName` и `InsertUnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="79b94-249">As we did with the GridView's `EditItemTemplate` s, I encourage you to rename the `ID` s of the TextBoxes from the nondescript `TextBox1` and `TextBox2` to `InsertProductName` and `InsertUnitPrice`.</span></span>

<span data-ttu-id="79b94-250">Добавьте RequiredFieldValidator в `InsertItemTemplate``ProductName`.</span><span class="sxs-lookup"><span data-stu-id="79b94-250">Add a RequiredFieldValidator to the `ProductName` `InsertItemTemplate`.</span></span> <span data-ttu-id="79b94-251">Присвойте `ControlToValidate` `ID` текстового поля в шаблоне, его свойству `Text` значение "\*" и свойству `ErrorMessage` значение "необходимо указать имя продукта".</span><span class="sxs-lookup"><span data-stu-id="79b94-251">Set the `ControlToValidate` to the `ID` of the TextBox in the template, its `Text` property to "\*" and its `ErrorMessage` property to "You must provide the product's name".</span></span>

<span data-ttu-id="79b94-252">Поскольку `UnitPrice` требуется для этой страницы при добавлении новой записи, добавьте RequiredFieldValidator в `UnitPrice` `InsertItemTemplate`, указав свойства `ControlToValidate`, `Text`и `ErrorMessage` соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="79b94-252">Since the `UnitPrice` is required for this page when adding a new record, add a RequiredFieldValidator to the `UnitPrice` `InsertItemTemplate`, setting its `ControlToValidate`, `Text`, and `ErrorMessage` properties appropriately.</span></span> <span data-ttu-id="79b94-253">Наконец, добавьте элемент управления CompareValidator в `InsertItemTemplate` `UnitPrice`, настроив его свойства `ControlToValidate`, `Text`, `ErrorMessage`, `Type`, `Operator`и `ValueToCompare` точно так же, как и в элементе управления CompareValidator `UnitPrice`в `EditItemTemplate`GridView.</span><span class="sxs-lookup"><span data-stu-id="79b94-253">Finally, add a CompareValidator to the `UnitPrice` `InsertItemTemplate` as well, configuring its `ControlToValidate`, `Text`, `ErrorMessage`, `Type`, `Operator`, and `ValueToCompare` properties just like we did with the `UnitPrice`'s CompareValidator in the GridView's `EditItemTemplate`.</span></span>

<span data-ttu-id="79b94-254">После добавления этих элементов управления проверки новый продукт не может быть добавлен в систему, если его имя не указано или если его цена является отрицательным числом или недопустимым форматом.</span><span class="sxs-lookup"><span data-stu-id="79b94-254">After adding these validation controls, a new product cannot be added to the system if its name is not supplied or if its price is a negative number or illegally formatted.</span></span>

<span data-ttu-id="79b94-255">[в интерфейс вставки DetailsView добавлена ![логика проверки](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image35.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="79b94-255">[![Validation Logic has been Added to the DetailsView's Inserting Interface](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image35.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image34.png)</span></span>

<span data-ttu-id="79b94-256">**Рис. 12**. логика проверки добавлена в интерфейс вставки DetailsView ([щелкните, чтобы просмотреть изображение с полным размером](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="79b94-256">**Figure 12**: Validation Logic has been Added to the DetailsView's Inserting Interface ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image36.png))</span></span>

## <a name="step-6-partitioning-the-validation-controls-into-validation-groups"></a><span data-ttu-id="79b94-257">Шаг 6. секционирование проверяющих элементов управления в группы проверки</span><span class="sxs-lookup"><span data-stu-id="79b94-257">Step 6: Partitioning the Validation Controls Into Validation Groups</span></span>

<span data-ttu-id="79b94-258">Наша страница состоит из двух логически разнородных наборов элементов управления проверки: тех, которые соответствуют интерфейсу правки GridView, и тем, которые соответствуют интерфейсу вставки DetailsView.</span><span class="sxs-lookup"><span data-stu-id="79b94-258">Our page consists of two logically disparate sets of validation controls: those that correspond to the GridView's editing interface and those that correspond to the DetailsView's inserting interface.</span></span> <span data-ttu-id="79b94-259">По умолчанию, когда выполняется обратная передача, проверяются *все* элементы управления проверки на странице.</span><span class="sxs-lookup"><span data-stu-id="79b94-259">By default, when a postback occurs *all* validation controls on the page are checked.</span></span> <span data-ttu-id="79b94-260">Однако при редактировании записи мы не хотим, чтобы элементы управления проверки интерфейса вставки элемента DetailsView были проверены.</span><span class="sxs-lookup"><span data-stu-id="79b94-260">However, when editing a record we don't want the DetailsView's inserting interface's validation controls to validate.</span></span> <span data-ttu-id="79b94-261">На рис. 13 показаны наши текущие дилеммой, когда пользователь редактирует продукт с помощью идеально допустимых значений. Если нажать кнопку обновить, это приведет к ошибке проверки, так как значения Name и Price в интерфейсе вставки пусты.</span><span class="sxs-lookup"><span data-stu-id="79b94-261">Figure 13 illustrates our current dilemma when a user is editing a product with perfectly legal values, clicking Update causes a validation error because the name and price values in the inserting interface are blank.</span></span>

<span data-ttu-id="79b94-262">[![обновление продукта приводит к срабатыванию элементов управления проверки интерфейса вставки](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image38.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="79b94-262">[![Updating a Product Causes the Inserting Interface's Validation Controls to Fire](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image38.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image37.png)</span></span>

<span data-ttu-id="79b94-263">**Рис. 13**. Обновление продукта вызывает срабатывание элементов управления проверки интерфейса вставки ([щелкните, чтобы просмотреть изображение с полным размером](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="79b94-263">**Figure 13**: Updating a Product Causes the Inserting Interface's Validation Controls to Fire ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image39.png))</span></span>

<span data-ttu-id="79b94-264">Элементы управления проверки в ASP.NET 2,0 могут быть разделены на группы проверки с помощью свойства `ValidationGroup`.</span><span class="sxs-lookup"><span data-stu-id="79b94-264">The validation controls in ASP.NET 2.0 can be partitioned into validation groups through their `ValidationGroup` property.</span></span> <span data-ttu-id="79b94-265">Чтобы связать набор элементов управления проверки в группе, просто присвойте свойству `ValidationGroup` одно и то же значение.</span><span class="sxs-lookup"><span data-stu-id="79b94-265">To associate a set of validation controls in a group, simply set their `ValidationGroup` property to the same value.</span></span> <span data-ttu-id="79b94-266">Для нашего руководства задайте для свойств `ValidationGroup` элементов управления проверки в элементе GridView полей TemplateField значение `EditValidationControls` и `ValidationGroup` свойства полей TemplateField DetailsView `InsertValidationControls`.</span><span class="sxs-lookup"><span data-stu-id="79b94-266">For our tutorial, set the `ValidationGroup` properties of the validation controls in the GridView's TemplateFields to `EditValidationControls` and the `ValidationGroup` properties of the DetailsView's TemplateFields to `InsertValidationControls`.</span></span> <span data-ttu-id="79b94-267">Эти изменения можно выполнить непосредственно в декларативной разметке или с помощью окно свойств при использовании интерфейса редактирования шаблона конструктора.</span><span class="sxs-lookup"><span data-stu-id="79b94-267">These changes can be done directly in the declarative markup or through the Properties window when using the Designer's edit template interface.</span></span>

<span data-ttu-id="79b94-268">Помимо элементов управления проверки, кнопки и элементы управления, связанные с кнопками в ASP.NET 2,0, также включают свойство `ValidationGroup`.</span><span class="sxs-lookup"><span data-stu-id="79b94-268">In addition to the validation controls, the Button and Button-related controls in ASP.NET 2.0 also include a `ValidationGroup` property.</span></span> <span data-ttu-id="79b94-269">Проверяющие элементы управления для группы проверки проверяются на допустимость только в том случае, если обратная передача вызывается кнопкой, имеющей тот же параметр `ValidationGroup` свойства.</span><span class="sxs-lookup"><span data-stu-id="79b94-269">A validation group's validators are checked for validity only when a postback is induced by a Button that has the same `ValidationGroup` property setting.</span></span> <span data-ttu-id="79b94-270">Например, чтобы кнопка вставки DetailsView активировала `InsertValidationControls` группу проверки, необходимо задать для свойства `ValidationGroup` CommandField значение `InsertValidationControls` (см. рис. 14).</span><span class="sxs-lookup"><span data-stu-id="79b94-270">For example, in order for the DetailsView's Insert button to trigger the `InsertValidationControls` validation group we need to set the CommandField's `ValidationGroup` property to `InsertValidationControls` (see Figure 14).</span></span> <span data-ttu-id="79b94-271">Кроме того, задайте для свойства Коммандфиелд'с `ValidationGroup` GridView значение `EditValidationControls`.</span><span class="sxs-lookup"><span data-stu-id="79b94-271">Additionally, set the GridView's CommandField's `ValidationGroup` property to `EditValidationControls`.</span></span>

<span data-ttu-id="79b94-272">[![установить для свойства Валидатионграуп Коммандфиелд'с DetailsView значение Инсертвалидатионконтролс](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image41.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="79b94-272">[![Set the DetailsView's CommandField's ValidationGroup property to InsertValidationControls](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image41.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image40.png)</span></span>

<span data-ttu-id="79b94-273">**Рис. 14**. установка свойства `ValidationGroup` коммандфиелд'с DetailsView в значение `InsertValidationControls` ([щелкните, чтобы просмотреть изображение с полным размером](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="79b94-273">**Figure 14**: Set the DetailsView's CommandField's `ValidationGroup` property to `InsertValidationControls` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image42.png))</span></span>

<span data-ttu-id="79b94-274">После этих изменений полей TemplateField и Коммандфиелдс DetailsView и GridView должны выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="79b94-274">After these changes, the DetailsView and GridView's TemplateFields and CommandFields should look similar to the following:</span></span>

<span data-ttu-id="79b94-275">Полей TemplateField и CommandField DetailsView</span><span class="sxs-lookup"><span data-stu-id="79b94-275">The DetailsView's TemplateFields and CommandField</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample4.aspx)]

<span data-ttu-id="79b94-276">CommandField и полей TemplateField GridView</span><span class="sxs-lookup"><span data-stu-id="79b94-276">The GridView's CommandField and TemplateFields</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample5.aspx)]

<span data-ttu-id="79b94-277">На этом этапе проверочные элементы управления, относящиеся к редактированию, срабатывают только при нажатии кнопки обновления GridView, а проверочные элементы управления, относящиеся к вставке, срабатывают только при нажатии кнопки вставки DetailsView, устраняя проблему, выделенную на рис. 13.</span><span class="sxs-lookup"><span data-stu-id="79b94-277">At this point the edit-specific validation controls fire only when the GridView's Update button is clicked and the insert-specific validation controls fire only when the DetailsView's Insert button is clicked, resolving the problem highlighted by Figure 13.</span></span> <span data-ttu-id="79b94-278">Однако после этого изменения наш элемент управления ValidationSummary больше не отображается при вводе недопустимых данных.</span><span class="sxs-lookup"><span data-stu-id="79b94-278">However, with this change our ValidationSummary control no longer displays when entering invalid data.</span></span> <span data-ttu-id="79b94-279">Элемент управления ValidationSummary также содержит свойство `ValidationGroup` и отображает сводные данные только для этих элементов управления проверки в своей группе проверки.</span><span class="sxs-lookup"><span data-stu-id="79b94-279">The ValidationSummary control also contains a `ValidationGroup` property and only shows summary information for those validation controls in its validation group.</span></span> <span data-ttu-id="79b94-280">Поэтому на этой странице должны быть два элемента управления проверки: одна для группы проверки `InsertValidationControls` и одна для `EditValidationControls`.</span><span class="sxs-lookup"><span data-stu-id="79b94-280">Therefore, we need to have two validation controls in this page, one for the `InsertValidationControls` validation group and one for `EditValidationControls`.</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample6.aspx)]

<span data-ttu-id="79b94-281">С этим добавлением наш учебник завершен.</span><span class="sxs-lookup"><span data-stu-id="79b94-281">With this addition our tutorial is complete!</span></span>

## <a name="summary"></a><span data-ttu-id="79b94-282">Сводка</span><span class="sxs-lookup"><span data-stu-id="79b94-282">Summary</span></span>

<span data-ttu-id="79b94-283">Хотя BoundFields может предоставлять и интерфейс вставки, и правки, интерфейс нельзя настраивать.</span><span class="sxs-lookup"><span data-stu-id="79b94-283">While BoundFields can provide both an inserting and editing interface, the interface is not customizable.</span></span> <span data-ttu-id="79b94-284">Как правило, нам нужно добавить элементы управления проверки в интерфейс правки и вставки, чтобы убедиться, что пользователь вводит необходимые входные данные в допустимый формат.</span><span class="sxs-lookup"><span data-stu-id="79b94-284">Commonly, we want to add validation controls to the editing and inserting interface to ensure that the user enters required inputs in a legal format.</span></span> <span data-ttu-id="79b94-285">Для этого необходимо преобразовать BoundFields в полей TemplateField и добавить элементы управления проверки к соответствующим шаблонам.</span><span class="sxs-lookup"><span data-stu-id="79b94-285">To accomplish this we must convert the BoundFields into TemplateFields and add the validation controls to the appropriate template(s).</span></span> <span data-ttu-id="79b94-286">В этом учебнике мы расширили пример из статьи *изучение событий, связанных с руководством по вставке, обновлению и удалению* , добавляя элементы управления проверки в интерфейс вставки DetailsView и интерфейс правки GridView.</span><span class="sxs-lookup"><span data-stu-id="79b94-286">In this tutorial we extended the example from the *Examining the Events Associated with Inserting, Updating, and Deleting* tutorial, adding validation controls to both the DetailsView's inserting interface and the GridView's editing interface.</span></span> <span data-ttu-id="79b94-287">Более того, мы увидели, как отображать сводные данные проверки с помощью элемента управления ValidationSummary и как секционировать элементы управления проверки на странице в отдельные группы проверки.</span><span class="sxs-lookup"><span data-stu-id="79b94-287">Moreover, we saw how to display summary validation information using the ValidationSummary control and how to partition the validation controls on the page into distinct validation groups.</span></span>

<span data-ttu-id="79b94-288">Как мы видели в этом руководстве, полей TemplateField позволяют дополнять интерфейсы правки и вставки для включения элементов управления проверки.</span><span class="sxs-lookup"><span data-stu-id="79b94-288">As we saw in this tutorial, TemplateFields allow the editing and inserting interfaces to be augmented to include validation controls.</span></span> <span data-ttu-id="79b94-289">Полей TemplateField также можно расширить для включения дополнительных входных веб-элементов управления, что позволяет заменить текстовое поле более подходящим веб-элементом управления.</span><span class="sxs-lookup"><span data-stu-id="79b94-289">TemplateFields can also be extended to include additional input Web controls, enabling the TextBox to be replaced by a more suitable Web control.</span></span> <span data-ttu-id="79b94-290">В следующем учебном курсе мы покажем, как заменить элемент управления TextBox элементом управления DropDownList с привязкой к данным, который идеально подходит при редактировании внешнего ключа (такого как `CategoryID` или `SupplierID` в таблице `Products`).</span><span class="sxs-lookup"><span data-stu-id="79b94-290">In our next tutorial we'll see how to replace the TextBox control with a data-bound DropDownList control, which is ideal when editing a foreign key (such as `CategoryID` or `SupplierID` in the `Products` table).</span></span>

<span data-ttu-id="79b94-291">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="79b94-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="79b94-292">Об авторе</span><span class="sxs-lookup"><span data-stu-id="79b94-292">About the Author</span></span>

<span data-ttu-id="79b94-293">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="79b94-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="79b94-294">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="79b94-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="79b94-295">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="79b94-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="79b94-296">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="79b94-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="79b94-297">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="79b94-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="79b94-298">Специальная благодарность</span><span class="sxs-lookup"><span data-stu-id="79b94-298">Special Thanks To</span></span>

<span data-ttu-id="79b94-299">Эта серия руководств была рассмотрена многими полезными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="79b94-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="79b94-300">Потенциальным рецензентам для этого учебника были основными рецензентами и Зак Jones.</span><span class="sxs-lookup"><span data-stu-id="79b94-300">Lead reviewers for this tutorial were Liz Shulok and Zack Jones.</span></span> <span data-ttu-id="79b94-301">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="79b94-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="79b94-302">Если это так, расположите строку в [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="79b94-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="79b94-303">[Назад](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md)
> [Вперед](customizing-the-data-modification-interface-cs.md)</span><span class="sxs-lookup"><span data-stu-id="79b94-303">[Previous](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md)
[Next](customizing-the-data-modification-interface-cs.md)</span></span>
