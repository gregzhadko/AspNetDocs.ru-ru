---
uid: web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-cs
title: Сортировка данных в элементе управления DataList или Repeater (C#) | Документация Майкрософт
author: rick-anderson
description: В этом руководстве будет рассмотрен способ включения поддержки в элементах управления DataList и Repeater сортировки, а также как создать в элементе управления DataList или Repeater, данные которого можно...
ms.author: riande
ms.date: 11/13/2006
ms.assetid: f52c302a-1b7c-46fe-8a13-8412c95cbf6d
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/sorting-data-in-a-datalist-or-repeater-control-cs
msc.type: authoredcontent
ms.openlocfilehash: ec5124cb0b449db703988bdadbaa244ff72cf363
ms.sourcegitcommit: 289e051cc8a90e8f7127e239fda73047bde4de12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/25/2019
ms.locfileid: "58425604"
---
<a name="sorting-data-in-a-datalist-or-repeater-control-c"></a><span data-ttu-id="1ead9-103">Сортировка данных в элементе управления DataList или Repeater (C#)</span><span class="sxs-lookup"><span data-stu-id="1ead9-103">Sorting Data in a DataList or Repeater Control (C#)</span></span>
====================
<span data-ttu-id="1ead9-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="1ead9-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="1ead9-105">[Скачайте пример приложения](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_CS.exe) или [скачать PDF](sorting-data-in-a-datalist-or-repeater-control-cs/_static/datatutorial45cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="1ead9-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_45_CS.exe) or [Download PDF](sorting-data-in-a-datalist-or-repeater-control-cs/_static/datatutorial45cs1.pdf)</span></span>

> <span data-ttu-id="1ead9-106">В этом руководстве будет рассмотрен способ включения поддержки в элементах управления DataList и Repeater сортировки, а также способах создания элементов управления DataList или Repeater, данные которого может быть, разбитых на страницы и сортировки.</span><span class="sxs-lookup"><span data-stu-id="1ead9-106">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>


## <a name="introduction"></a><span data-ttu-id="1ead9-107">Вступление</span><span class="sxs-lookup"><span data-stu-id="1ead9-107">Introduction</span></span>

<span data-ttu-id="1ead9-108">В [предыдущем учебном курсе](paging-report-data-in-a-datalist-or-repeater-control-cs.md) мы рассмотрели способы добавления поддержки разбиения по страницам элементом управления DataList.</span><span class="sxs-lookup"><span data-stu-id="1ead9-108">In the [previous tutorial](paging-report-data-in-a-datalist-or-repeater-control-cs.md) we examined how to add paging support to a DataList.</span></span> <span data-ttu-id="1ead9-109">Мы создали новый метод в `ProductsBLL` класс (`GetProductsAsPagedDataSource`), возвращается `PagedDataSource` объекта.</span><span class="sxs-lookup"><span data-stu-id="1ead9-109">We created a new method in the `ProductsBLL` class (`GetProductsAsPagedDataSource`) that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="1ead9-110">При привязке элемента управления DataList или Repeater, DataList или Repeater будет отображаться запрошенной страницы данных.</span><span class="sxs-lookup"><span data-stu-id="1ead9-110">When bound to a DataList or Repeater, the DataList or Repeater would display just the requested page of data.</span></span> <span data-ttu-id="1ead9-111">Этот метод похож на то, что используется внутри элементов управления GridView, DetailsView и FormView для функционирования разбиение по страницам по умолчанию встроенные.</span><span class="sxs-lookup"><span data-stu-id="1ead9-111">This technique is similar to what is used internally by the GridView, DetailsView, and FormView controls to provide their built-in default paging functionality.</span></span>

<span data-ttu-id="1ead9-112">В дополнение к предлагает техническую поддержку разбиения по страницам, GridView также включает по умолчанию, для обеспечения поддержки сортировки.</span><span class="sxs-lookup"><span data-stu-id="1ead9-112">In addition to offering paging support, the GridView also includes out of the box sorting support.</span></span> <span data-ttu-id="1ead9-113">Ни DataList, ни элемент управления Repeater предоставляет встроенные функциональные возможности сортировки; Тем не менее функциям сортировки могут добавляться с небольшой фрагмент кода.</span><span class="sxs-lookup"><span data-stu-id="1ead9-113">Neither the DataList nor Repeater provides built-in sorting functionality; however, sorting features can be added with a bit of code.</span></span> <span data-ttu-id="1ead9-114">В этом руководстве будет рассмотрен способ включения поддержки в элементах управления DataList и Repeater сортировки, а также способах создания элементов управления DataList или Repeater, данные которого может быть, разбитых на страницы и сортировки.</span><span class="sxs-lookup"><span data-stu-id="1ead9-114">In this tutorial we'll examine how to include sorting support in the DataList and Repeater, as well as how to construct a DataList or Repeater whose data can be paged and sorted.</span></span>

## <a name="a-review-of-sorting"></a><span data-ttu-id="1ead9-115">Обзор сортировки</span><span class="sxs-lookup"><span data-stu-id="1ead9-115">A Review of Sorting</span></span>

<span data-ttu-id="1ead9-116">Как мы видели в [разбиение по страницам и сортировка данных отчета](../paging-and-sorting/paging-and-sorting-report-data-cs.md) руководстве элемент управления GridView предоставляет готовые обеспечения поддержки сортировки.</span><span class="sxs-lookup"><span data-stu-id="1ead9-116">As we saw in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-cs.md) tutorial, the GridView control provides out of the box sorting support.</span></span> <span data-ttu-id="1ead9-117">Каждое поле GridView может иметь сопоставленный `SortExpression`, который указывает поле данных, по которому выполняется сортировка данных.</span><span class="sxs-lookup"><span data-stu-id="1ead9-117">Each GridView field can have an associated `SortExpression`, which indicates the data field by which to sort the data.</span></span> <span data-ttu-id="1ead9-118">При GridView s `AllowSorting` свойству `true`, каждого поля GridView, имеющий `SortExpression` значение свойства имеет его заголовок, отображаемой в качестве LinkButton.</span><span class="sxs-lookup"><span data-stu-id="1ead9-118">When the GridView s `AllowSorting` property is set to `true`, each GridView field that has a `SortExpression` property value has its header rendered as a LinkButton.</span></span> <span data-ttu-id="1ead9-119">Когда пользователь щелкает определенного заголовка s поля GridView, происходит обратная передача, и данные отсортированы в соответствии с выбранной поле s `SortExpression`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-119">When a user clicks a particular GridView field s header, a postback occurs and the data is sorted according to the clicked field s `SortExpression`.</span></span>

<span data-ttu-id="1ead9-120">Элемент управления GridView имеет `SortExpression` свойство, которое хранит `SortExpression` поля GridView отсортированы по.</span><span class="sxs-lookup"><span data-stu-id="1ead9-120">The GridView control has a `SortExpression` property as well, which stores the `SortExpression` of the GridView field the data is sorted by.</span></span> <span data-ttu-id="1ead9-121">Кроме того `SortDirection` свойство указывает, являются ли данные должны быть отсортированы в порядке возрастания или убывания (если пользователь нажимает кнопку, заменяется определенной связи заголовка поле s GridView дважды подряд, порядок сортировки).</span><span class="sxs-lookup"><span data-stu-id="1ead9-121">Additionally, a `SortDirection` property indicates whether the data is to be sorted in ascending or descending order (if a user clicks a particular GridView field s header link twice in succession, the sort order is toggled).</span></span>

<span data-ttu-id="1ead9-122">Если GridView привязан к элементу управления источника данных, он передает его `SortExpression` и `SortDirection` свойства к данным система управления версиями.</span><span class="sxs-lookup"><span data-stu-id="1ead9-122">When the GridView is bound to its data source control, it hands off its `SortExpression` and `SortDirection` properties to the data source control.</span></span> <span data-ttu-id="1ead9-123">Элемент управления источником данных извлекает данные и затем он сортируется в соответствии с предоставленным `SortExpression` и `SortDirection` свойства.</span><span class="sxs-lookup"><span data-stu-id="1ead9-123">The data source control retrieves the data and then sorts it according to the supplied `SortExpression` and `SortDirection` properties.</span></span> <span data-ttu-id="1ead9-124">После сортировки данных элемента управления источником данных возвращается к GridView.</span><span class="sxs-lookup"><span data-stu-id="1ead9-124">After sorting the data, the data source control returns it to the GridView.</span></span>

<span data-ttu-id="1ead9-125">Выполнить репликацию этой функциональности с помощью элементов управления DataList или Repeater, необходимо выполнить следующее.</span><span class="sxs-lookup"><span data-stu-id="1ead9-125">To replicate this functionality with the DataList or Repeater controls, we must:</span></span>

- <span data-ttu-id="1ead9-126">Создать интерфейс сортировки</span><span class="sxs-lookup"><span data-stu-id="1ead9-126">Create a sorting interface</span></span>
- <span data-ttu-id="1ead9-127">Помните, поля данных для сортировки и необходимость отсортировать в возрастающем или убывающем порядке</span><span class="sxs-lookup"><span data-stu-id="1ead9-127">Remember the data field to sort by and whether to sort in ascending or descending order</span></span>
- <span data-ttu-id="1ead9-128">Указать элемент управления ObjectDataSource для сортировки данных по полю данных</span><span class="sxs-lookup"><span data-stu-id="1ead9-128">Instruct the ObjectDataSource to sort the data by a particular data field</span></span>

<span data-ttu-id="1ead9-129">Это будет рассмотрено эти три задачи в шагах 3 и 4.</span><span class="sxs-lookup"><span data-stu-id="1ead9-129">We'll tackle these three tasks in steps 3 and 4.</span></span> <span data-ttu-id="1ead9-130">После этого мы рассмотрим, как включить разбиение по страницам и сортировка поддержки в элементе управления DataList или Repeater.</span><span class="sxs-lookup"><span data-stu-id="1ead9-130">Following that, we'll examine how to include both paging and sorting support in a DataList or Repeater.</span></span>

## <a name="step-2-displaying-the-products-in-a-repeater"></a><span data-ttu-id="1ead9-131">Шаг 2. Отображение продуктов в элементе управления Repeater</span><span class="sxs-lookup"><span data-stu-id="1ead9-131">Step 2: Displaying the Products in a Repeater</span></span>

<span data-ttu-id="1ead9-132">Прежде чем думать о реализации любого из функции, связанные с сортировки позволяют s начнем с получения списка продуктов в элементе управления Repeater.</span><span class="sxs-lookup"><span data-stu-id="1ead9-132">Before we worry about implementing any of the sorting-related functionality, let s start by listing the products in a Repeater control.</span></span> <span data-ttu-id="1ead9-133">Сначала откройте `Sorting.aspx` странице в `PagingSortingDataListRepeater` папку.</span><span class="sxs-lookup"><span data-stu-id="1ead9-133">Start by opening the `Sorting.aspx` page in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="1ead9-134">Добавление элемента управления Repeater на веб-страницу, установка его `ID` свойства `SortableProducts`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-134">Add a Repeater control to the web page, setting its `ID` property to `SortableProducts`.</span></span> <span data-ttu-id="1ead9-135">В смарт-теге элемента управления Repeater s, создайте новый ObjectDataSource, именуемый `ProductsDataSource` и настройте его для получения данных из `ProductsBLL` класс s `GetProducts()` метод.</span><span class="sxs-lookup"><span data-stu-id="1ead9-135">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource` and configure it to retrieve data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="1ead9-136">Выберите параметр из раскрывающегося списка на вкладках INSERT, UPDATE и DELETE (нет).</span><span class="sxs-lookup"><span data-stu-id="1ead9-136">Select the (None) option from the drop-down lists in the INSERT, UPDATE, and DELETE tabs.</span></span>


<span data-ttu-id="1ead9-137">[![Создание нового ObjectDataSource и настроить его для использования метода GetProductsAsPagedDataSource()](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-137">[![Create an ObjectDataSource and Configure it to Use the GetProductsAsPagedDataSource() Method](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image2.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image1.png)</span></span>

<span data-ttu-id="1ead9-138">**Рис. 1**: Создание нового ObjectDataSource и настройте его для использования `GetProductsAsPagedDataSource()` метод ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-138">**Figure 1**: Create an ObjectDataSource and Configure it to Use the `GetProductsAsPagedDataSource()` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image3.png))</span></span>


<span data-ttu-id="1ead9-139">[![Установите раскрывающиеся списки в UPDATE, INSERT и удаление вкладок (нет)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-139">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image5.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image4.png)</span></span>

<span data-ttu-id="1ead9-140">**Рис. 2**: Установите раскрывающиеся списки в UPDATE, INSERT и удаление вкладок (нет) ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-140">**Figure 2**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None) ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image6.png))</span></span>


<span data-ttu-id="1ead9-141">В отличие от с DataList, Visual Studio не создает автоматически `ItemTemplate` для элемента управления Repeater, после ее привязки к источнику данных.</span><span class="sxs-lookup"><span data-stu-id="1ead9-141">Unlike with the DataList, Visual Studio does not automatically create an `ItemTemplate` for the Repeater control after binding it to a data source.</span></span> <span data-ttu-id="1ead9-142">Кроме того, необходимо добавить это `ItemTemplate` декларативно, как смарт-тег элемента управления s Repeater отсутствует параметр Правка шаблонов в элементе управления DataList s.</span><span class="sxs-lookup"><span data-stu-id="1ead9-142">Furthermore, we must add this `ItemTemplate` declaratively, as the Repeater control s smart tag lacks the Edit Templates option found in the DataList s.</span></span> <span data-ttu-id="1ead9-143">S позволяют использовать тот же `ItemTemplate` из предыдущего учебника, отображаемые s название продукта, поставщика и категории.</span><span class="sxs-lookup"><span data-stu-id="1ead9-143">Let s use the same `ItemTemplate` from the previous tutorial, which displayed the product s name, supplier, and category.</span></span>

<span data-ttu-id="1ead9-144">После добавления `ItemTemplate`, Repeater и ObjectDataSource s должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="1ead9-144">After adding the `ItemTemplate`, the Repeater and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample1.aspx)]

<span data-ttu-id="1ead9-145">Рис. 3 показан эту страницу при просмотре через браузер.</span><span class="sxs-lookup"><span data-stu-id="1ead9-145">Figure 3 shows this page when viewed through a browser.</span></span>


<span data-ttu-id="1ead9-146">[![Отображается каждый продукт s имя поставщика и категории](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-146">[![Each Product s Name, Supplier, and Category is Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image8.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image7.png)</span></span>

<span data-ttu-id="1ead9-147">**Рис. 3**: Отображается каждый s имя продукта, поставщика и категории ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-147">**Figure 3**: Each Product s Name, Supplier, and Category is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image9.png))</span></span>


## <a name="step-3-instructing-the-objectdatasource-to-sort-the-data"></a><span data-ttu-id="1ead9-148">Шаг 3. Элемент управления ObjectDataSource для сортировки данных с инструкциями</span><span class="sxs-lookup"><span data-stu-id="1ead9-148">Step 3: Instructing the ObjectDataSource to Sort the Data</span></span>

<span data-ttu-id="1ead9-149">Чтобы отсортировать данные, отображаемые в элементу управления Repeater, нам нужно сообщить ObjectDataSource выражения сортировки, по которому данные должны быть отсортированы.</span><span class="sxs-lookup"><span data-stu-id="1ead9-149">To sort the data displayed in the Repeater, we need to inform the ObjectDataSource of the sort expression by which the data should be sorted.</span></span> <span data-ttu-id="1ead9-150">Прежде чем элемент управления ObjectDataSource извлекает свои данные, он инициирует его [ `Selecting` событий](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), который предоставляет возможность указать выражение сортировки.</span><span class="sxs-lookup"><span data-stu-id="1ead9-150">Before the ObjectDataSource retrieves its data, it first fires its [`Selecting` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting.aspx), which provides an opportunity for us to specify a sort expression.</span></span> <span data-ttu-id="1ead9-151">`Selecting` Обработчику события передаются в объект типа [ `ObjectDataSourceSelectingEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), который имеет свойство с именем [ `Arguments` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) типа [ `DataSourceSelectArguments` ](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span><span class="sxs-lookup"><span data-stu-id="1ead9-151">The `Selecting` event handler is passed an object of type [`ObjectDataSourceSelectingEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.aspx), which has a property named [`Arguments`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasourceselectingeventargs.arguments.aspx) of type [`DataSourceSelectArguments`](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.aspx).</span></span> <span data-ttu-id="1ead9-152">`DataSourceSelectArguments` Класс предназначен для передачи запросов, связанных с данными из объекта-получателя данных к элементу управления источника данных и включает в себя [ `SortExpression` свойство](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span><span class="sxs-lookup"><span data-stu-id="1ead9-152">The `DataSourceSelectArguments` class is designed to pass data-related requests from a consumer of data to the data source control, and includes a [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.datasourceselectarguments.sortexpression.aspx).</span></span>

<span data-ttu-id="1ead9-153">Чтобы передать данные сортировки из страницы ASP.NET элемент управления ObjectDataSource, создайте обработчик событий для `Selecting` событие и используйте следующий код:</span><span class="sxs-lookup"><span data-stu-id="1ead9-153">To pass sorting information from the ASP.NET page to the ObjectDataSource, create an event handler for the `Selecting` event and use the following code:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample2.cs)]

<span data-ttu-id="1ead9-154">*SortExpression* имя поля данных для сортировки данных путем (например, ProductName) должно быть присвоено значение.</span><span class="sxs-lookup"><span data-stu-id="1ead9-154">The *sortExpression* value should be assigned the name of the data field to sort the data by (such as ProductName ).</span></span> <span data-ttu-id="1ead9-155">Нет свойства сортировки, связанных с направлением, поэтому если необходимо отсортировать данные в порядке убывания, добавьте строку DESC для *sortExpression* значение (например, ProductName DESC).</span><span class="sxs-lookup"><span data-stu-id="1ead9-155">There is no sort direction-related property, so if you want to sort the data in descending order, append the string DESC to the *sortExpression* value (such as ProductName DESC ).</span></span>

<span data-ttu-id="1ead9-156">Попробуйте другие значения жестко для *sortExpression* и проверить результаты в браузере.</span><span class="sxs-lookup"><span data-stu-id="1ead9-156">Go ahead and try some different hard-coded values for *sortExpression* and test the results in a browser.</span></span> <span data-ttu-id="1ead9-157">Как показано на рис. 4, при использовании DESC ProductName как *sortExpression*, продукты сортируются по их имени в обратном алфавитном порядке.</span><span class="sxs-lookup"><span data-stu-id="1ead9-157">As Figure 4 shows, when using ProductName DESC as the *sortExpression*, the products are sorted by their name in reverse alphabetical order.</span></span>


<span data-ttu-id="1ead9-158">[![Продукты сортируются по имени в обратном алфавитном порядке](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-158">[![The Products are Sorted by their Name in Reverse Alphabetical Order](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image11.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image10.png)</span></span>

<span data-ttu-id="1ead9-159">**Рис. 4**: Продукты сортируются по имени в обратном алфавитном порядке ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-159">**Figure 4**: The Products are Sorted by their Name in Reverse Alphabetical Order ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image12.png))</span></span>


## <a name="step-4-creating-the-sorting-interface-and-remembering-the-sort-expression-and-direction"></a><span data-ttu-id="1ead9-160">Шаг 4. Создавать интерфейс сортировки и запоминать выражением сортировки и направлением</span><span class="sxs-lookup"><span data-stu-id="1ead9-160">Step 4: Creating the Sorting Interface and Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="1ead9-161">Включение поддержки в GridView сортировки преобразуется в текст заголовка каждого поля с возможностью сортировки s LinkButton, при нажатии сортирует данные соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="1ead9-161">Turning on sorting support in the GridView converts each sortable field s header text into a LinkButton that, when clicked, sorts the data accordingly.</span></span> <span data-ttu-id="1ead9-162">Такой интерфейс сортировки имеет смысл для элементов управления GridView, где его аккуратно расположения данных в столбцах.</span><span class="sxs-lookup"><span data-stu-id="1ead9-162">Such a sorting interface makes sense for the GridView, where its data is neatly laid out in columns.</span></span> <span data-ttu-id="1ead9-163">Для элементов управления DataList и Repeater Однако другой интерфейс сортировки потребуется.</span><span class="sxs-lookup"><span data-stu-id="1ead9-163">For the DataList and Repeater controls, however, a different sorting interface is needed.</span></span> <span data-ttu-id="1ead9-164">Общий интерфейс сортировки список данных (в отличие от сетки данных), является список раскрывающегося списка, который содержит поля, по которым данные могут быть отсортированы.</span><span class="sxs-lookup"><span data-stu-id="1ead9-164">A common sorting interface for a list of data (as opposed to a grid of data), is a drop-down list that provides the fields by which the data can be sorted.</span></span> <span data-ttu-id="1ead9-165">Позвольте s реализацией такого интерфейса в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="1ead9-165">Let s implement such an interface for this tutorial.</span></span>

<span data-ttu-id="1ead9-166">Добавление элемента управления DropDownList веб-элемент управления выше `SortableProducts` Repeater и задайте его `ID` свойства `SortBy`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-166">Add a DropDownList Web control above the `SortableProducts` Repeater and set its `ID` property to `SortBy`.</span></span> <span data-ttu-id="1ead9-167">В окне свойств нажмите кнопку с многоточием в `Items` свойство на отображение редактора коллекций ListItem.</span><span class="sxs-lookup"><span data-stu-id="1ead9-167">From the Properties window, click the ellipses in the `Items` property to bring up the ListItem Collection Editor.</span></span> <span data-ttu-id="1ead9-168">Добавить `ListItem` s, чтобы отсортировать данные по `ProductName`, `CategoryName`, и `SupplierName` поля.</span><span class="sxs-lookup"><span data-stu-id="1ead9-168">Add `ListItem` s to sort the data by the `ProductName`, `CategoryName`, and `SupplierName` fields.</span></span> <span data-ttu-id="1ead9-169">Кроме того, добавить `ListItem` для сортировки продуктов по имени в обратном алфавитном порядке.</span><span class="sxs-lookup"><span data-stu-id="1ead9-169">Also add a `ListItem` to sort the products by their name in reverse alphabetical order.</span></span>

<span data-ttu-id="1ead9-170">`ListItem` `Text` Свойства может быть присвоено любое значение (например, имя), но `Value` свойства должно быть присвоено имя поля данных (например, ProductName).</span><span class="sxs-lookup"><span data-stu-id="1ead9-170">The `ListItem` `Text` properties can be set to any value (such as Name ), but the `Value` properties must be set to the name of the data field (such as ProductName ).</span></span> <span data-ttu-id="1ead9-171">Чтобы отсортировать результаты в порядке убывания, добавьте строку DESC на имя поля данных, таких как ProductName DESC.</span><span class="sxs-lookup"><span data-stu-id="1ead9-171">To sort the results in descending order, append the string DESC to the data field name, like ProductName DESC .</span></span>


![Добавление ListItem для каждого из полей данных поддерживает сортировку](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image13.png)

<span data-ttu-id="1ead9-173">**Рис. 5**: Добавление `ListItem` для каждого поля данных поддерживает сортировку</span><span class="sxs-lookup"><span data-stu-id="1ead9-173">**Figure 5**: Add a `ListItem` for Each of the Sortable Data Fields</span></span>


<span data-ttu-id="1ead9-174">Наконец добавьте кнопку веб-элемент управления справа от элемента управления DropDownList.</span><span class="sxs-lookup"><span data-stu-id="1ead9-174">Finally, add a Button Web control to the right of the DropDownList.</span></span> <span data-ttu-id="1ead9-175">Задайте его `ID` для `RefreshRepeater` и его `Text` свойства для обновления.</span><span class="sxs-lookup"><span data-stu-id="1ead9-175">Set its `ID` to `RefreshRepeater` and its `Text` property to Refresh .</span></span>

<span data-ttu-id="1ead9-176">После создания `ListItem` s и добавив "Обновить", DropDownList и кнопка s должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="1ead9-176">After creating the `ListItem` s and adding the Refresh button, the DropDownList and Button s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample3.aspx)]

<span data-ttu-id="1ead9-177">С помощью сортировки полный DropDownList, мы теперь нужно обновить элемент управления ObjectDataSource s `Selecting` обработчик событий, что в ней используется выбранный `SortBy``ListItem` s `Value` свойство, в отличие от выражение сортировки жестко.</span><span class="sxs-lookup"><span data-stu-id="1ead9-177">With the sorting DropDownList complete, we next need to update the ObjectDataSource s `Selecting` event handler so that it uses the selected `SortBy``ListItem` s `Value` property as opposed to a hard-coded sort expression.</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample4.cs)]

<span data-ttu-id="1ead9-178">На этом этапе при первом просмотре странице продукты будут сначала упорядочены по `ProductName` поля данных, так как он s `SortBy` `ListItem` выбран по умолчанию (см. рис. 6).</span><span class="sxs-lookup"><span data-stu-id="1ead9-178">At this point when first visiting the page the products will initially be sorted by the `ProductName` data field, as it s the `SortBy` `ListItem` selected by default (see Figure 6).</span></span> <span data-ttu-id="1ead9-179">Выбрать другой параметр, например категория сортировки, а также команда Обновить вызывает обратную передачу и повторно отсортировать данные по имени категории, как показано на рис. 7.</span><span class="sxs-lookup"><span data-stu-id="1ead9-179">Selecting a different sorting option such as Category and clicking Refresh will cause a postback and re-sort the data by the category name, as Figure 7 shows.</span></span>


<span data-ttu-id="1ead9-180">[![Они отсортированы сначала по имени](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-180">[![The Products are Initially Sorted by their Name](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image15.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image14.png)</span></span>

<span data-ttu-id="1ead9-181">**Рис. 6**: Они отсортированы сначала по имени ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-181">**Figure 6**: The Products are Initially Sorted by their Name ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image16.png))</span></span>


<span data-ttu-id="1ead9-182">[![Они теперь отсортированы по категории](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-182">[![The Products are Now Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image18.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image17.png)</span></span>

<span data-ttu-id="1ead9-183">**Рис. 7**: Они теперь отсортированы по категориям ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-183">**Figure 7**: The Products are Now Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image19.png))</span></span>


> [!NOTE]
> <span data-ttu-id="1ead9-184">Нажав кнопку "Обновить" приводит к быть автоматически переупорядочены так как состояние представления элемента управления Repeater s отключена, приводящий к элементу управления Repeater, выполнять повторную привязку к источнику данных при каждой обратной передаче данных.</span><span class="sxs-lookup"><span data-stu-id="1ead9-184">Clicking the Refresh button causes the data to automatically be re-sorted because the Repeater s view state has been disabled, thereby causing the Repeater to rebind to its data source on every postback.</span></span> <span data-ttu-id="1ead9-185">Если вы ve оставить Repeater s состояние представления включено, изменив порядок сортировки выберите в раскрывающемся списке не повлияет на порядок сортировки.</span><span class="sxs-lookup"><span data-stu-id="1ead9-185">If you ve left the Repeater s view state enabled, changing the sorting drop-down list won't have any affect on the sort order.</span></span> <span data-ttu-id="1ead9-186">Чтобы исправить это, создайте обработчик событий для кнопки Обновить s `Click` событий и повторную привязку элемента управления Repeater к источнику данных (путем вызова элементу управления Repeater s `DataBind()` метод).</span><span class="sxs-lookup"><span data-stu-id="1ead9-186">To remedy this, create an event handler for the Refresh Button s `Click` event and rebind the Repeater to its data source (by calling the Repeater s `DataBind()` method).</span></span>


## <a name="remembering-the-sort-expression-and-direction"></a><span data-ttu-id="1ead9-187">Запоминание выражением сортировки и направлением</span><span class="sxs-lookup"><span data-stu-id="1ead9-187">Remembering the Sort Expression and Direction</span></span>

<span data-ttu-id="1ead9-188">При создании сортируемого DataList или Repeater на странице, где не сортировки связанных операций обратной передачи возникает, оно императивного s, что выражением сортировки и направлением запомнить, во время обратной передачи.</span><span class="sxs-lookup"><span data-stu-id="1ead9-188">When creating a sortable DataList or Repeater on a page where non-sort related postbacks may occur, it s imperative that the sort expression and direction be remembered across postbacks.</span></span> <span data-ttu-id="1ead9-189">Например представьте, что мы изменили элементу управления Repeater в этом руководстве, чтобы включить кнопку «Удалить» в каждом из продуктов.</span><span class="sxs-lookup"><span data-stu-id="1ead9-189">For example, imagine that we updated the Repeater in this tutorial to include a Delete button with each product.</span></span> <span data-ttu-id="1ead9-190">При нажатии кнопки Delete мы d выполнять определенный код для удаления выбранного продукта и затем привяжите данные к элементу управления Repeater.</span><span class="sxs-lookup"><span data-stu-id="1ead9-190">When the user clicks the Delete button we d run some code to delete the selected product and then rebind the data to the Repeater.</span></span> <span data-ttu-id="1ead9-191">Если параметры сортировки не сохраняются между обратную передачу, данные, отображаемые на экране вернется к исходный порядок сортировки.</span><span class="sxs-lookup"><span data-stu-id="1ead9-191">If the sort details are not persisted across postback, the data displayed on screen will revert to the original sort order.</span></span>

<span data-ttu-id="1ead9-192">В этом учебнике DropDownList неявно сохраняет сортировки выражения и направление в состоянии его представления для нас.</span><span class="sxs-lookup"><span data-stu-id="1ead9-192">For this tutorial, the DropDownList implicitly saves the sort expression and direction in its view state for us.</span></span> <span data-ttu-id="1ead9-193">Если мы использовали другой интерфейс сортировки один со, скажем, элементов управления LinkButton, различные параметры сортировки мы d нужно будет запоминать порядок сортировки во время обратной передачи.</span><span class="sxs-lookup"><span data-stu-id="1ead9-193">If we were using a different sorting interface one with, say, LinkButtons that provided the various sorting options we d need to take care to remember the sort order across postbacks.</span></span> <span data-ttu-id="1ead9-194">Этого можно добиться путем сохранения параметров сортировки в состоянии представления страницы s, путем включения параметра сортировки, в строке запроса или с помощью некоторых метод постоянного хранения состояний.</span><span class="sxs-lookup"><span data-stu-id="1ead9-194">This could be accomplished by storing the sorting parameters in the page s view state, by including the sort parameter in the querystring, or through some other state persistence technique.</span></span>

<span data-ttu-id="1ead9-195">Будущие примеры в этом руководстве исследуется способ сохранять параметры сортировки в состоянии представления страницы s.</span><span class="sxs-lookup"><span data-stu-id="1ead9-195">Future examples in this tutorial explore how to persist the sorting details in the page s view state.</span></span>

## <a name="step-5-adding-sorting-support-to-a-datalist-that-uses-default-paging"></a><span data-ttu-id="1ead9-196">Шаг 5. Добавление поддержки сортировки для элементов управления DataList, использующий разбиение по страницам по умолчанию</span><span class="sxs-lookup"><span data-stu-id="1ead9-196">Step 5: Adding Sorting Support to a DataList that Uses Default Paging</span></span>

<span data-ttu-id="1ead9-197">В [предыдущем учебном курсе](paging-report-data-in-a-datalist-or-repeater-control-cs.md) мы увидели, как можно реализовать разбиение по страницам по умолчанию с элементом управления DataList.</span><span class="sxs-lookup"><span data-stu-id="1ead9-197">In the [preceding tutorial](paging-report-data-in-a-datalist-or-repeater-control-cs.md) we examined how to implement default paging with a DataList.</span></span> <span data-ttu-id="1ead9-198">Позвольте s расширить этот предыдущего примера, включив возможность сортировать разбитых на страницы данных.</span><span class="sxs-lookup"><span data-stu-id="1ead9-198">Let s extend this previous example to include the ability to sort the paged data.</span></span> <span data-ttu-id="1ead9-199">Сначала откройте `SortingWithDefaultPaging.aspx` и `Paging.aspx` страниц в `PagingSortingDataListRepeater` папку.</span><span class="sxs-lookup"><span data-stu-id="1ead9-199">Start by opening the `SortingWithDefaultPaging.aspx` and `Paging.aspx` pages in the `PagingSortingDataListRepeater` folder.</span></span> <span data-ttu-id="1ead9-200">Из `Paging.aspx` нажмите кнопку "источник", чтобы просмотреть декларативная разметка страницы s.</span><span class="sxs-lookup"><span data-stu-id="1ead9-200">From the `Paging.aspx` page, click on the Source button to view the page s declarative markup.</span></span> <span data-ttu-id="1ead9-201">Копировать выделенный текст (см. рис. 8) и вставьте его в декларативной разметке `SortingWithDefaultPaging.aspx` между `<asp:Content>` теги.</span><span class="sxs-lookup"><span data-stu-id="1ead9-201">Copy the selected text (see Figure 8) and paste it into the declarative markup of `SortingWithDefaultPaging.aspx` between the `<asp:Content>` tags.</span></span>


<span data-ttu-id="1ead9-202">[![Репликация в декларативной разметке &lt;asp: Content&gt; теги из Paging.aspx SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-202">[![Replicate the Declarative Markup in the &lt;asp:Content&gt; Tags from Paging.aspx to SortingWithDefaultPaging.aspx](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image21.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image20.png)</span></span>

<span data-ttu-id="1ead9-203">**Рис. 8**: Репликация в декларативной разметке `<asp:Content>` тегов `Paging.aspx` для `SortingWithDefaultPaging.aspx` ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-203">**Figure 8**: Replicate the Declarative Markup in the `<asp:Content>` Tags from `Paging.aspx` to `SortingWithDefaultPaging.aspx` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image22.png))</span></span>


<span data-ttu-id="1ead9-204">После копирования декларативная разметка, скопируйте методы и свойства в `Paging.aspx` странице s вспомогательного класса в класс фонового кода для `SortingWithDefaultPaging.aspx`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-204">After copying the declarative markup, copy the methods and properties in the `Paging.aspx` page s code-behind class to the code-behind class for `SortingWithDefaultPaging.aspx`.</span></span> <span data-ttu-id="1ead9-205">Далее, Отвлекитесь и просмотрите `SortingWithDefaultPaging.aspx` страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="1ead9-205">Next, take a moment to view the `SortingWithDefaultPaging.aspx` page in a browser.</span></span> <span data-ttu-id="1ead9-206">Он должен продемонстрировать одинаковые функции и внешний вид, как `Paging.aspx`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-206">It should exhibit the same functionality and appearance as `Paging.aspx`.</span></span>

## <a name="enhancing-productsbll-to-include-a-default-paging-and-sorting-method"></a><span data-ttu-id="1ead9-207">Улучшение ProductsBLL, чтобы включить разбиение по страницам и метод сортировки по умолчанию</span><span class="sxs-lookup"><span data-stu-id="1ead9-207">Enhancing ProductsBLL to Include a Default Paging and Sorting Method</span></span>

<span data-ttu-id="1ead9-208">В предыдущем учебном курсе мы создали `GetProductsAsPagedDataSource(pageIndex, pageSize)` метод в `ProductsBLL` класс, который возвращается `PagedDataSource` объекта.</span><span class="sxs-lookup"><span data-stu-id="1ead9-208">In the previous tutorial we created a `GetProductsAsPagedDataSource(pageIndex, pageSize)` method in the `ProductsBLL` class that returned a `PagedDataSource` object.</span></span> <span data-ttu-id="1ead9-209">Это `PagedDataSource` заполненный объект *все* продуктов (через BLL s `GetProducts()` метод), но при привязке элемента управления DataList только те записи, соответствующий указанному *pageIndex* и *pageSize* отображались входных параметров.</span><span class="sxs-lookup"><span data-stu-id="1ead9-209">This `PagedDataSource` object was populated with *all* of the products (via the BLL s `GetProducts()` method), but when bound to the DataList only those records corresponding to the specified *pageIndex* and *pageSize* input parameters were displayed.</span></span>

<span data-ttu-id="1ead9-210">Ранее в этом учебнике мы добавили поддержку сортировки, указав выражение сортировки из ObjectDataSource s `Selecting` обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="1ead9-210">Earlier in this tutorial we added sorting support by specifying the sort expression from the ObjectDataSource s `Selecting` event handler.</span></span> <span data-ttu-id="1ead9-211">Это хорошо работает при ObjectDataSource возвращается объект, который можно сортировать, например `ProductsDataTable` возвращаемые `GetProducts()` метод.</span><span class="sxs-lookup"><span data-stu-id="1ead9-211">This works well when the ObjectDataSource is returned an object that can be sorted, like the `ProductsDataTable` returned by the `GetProducts()` method.</span></span> <span data-ttu-id="1ead9-212">Тем не менее `PagedDataSource` объект, возвращаемый `GetProductsAsPagedDataSource` метод не поддерживает сортировку его внутренний источник данных.</span><span class="sxs-lookup"><span data-stu-id="1ead9-212">However, the `PagedDataSource` object returned by the `GetProductsAsPagedDataSource` method does not support sorting of its inner data source.</span></span> <span data-ttu-id="1ead9-213">Вместо этого нам нужно отсортировать результаты, возвращаемые `GetProducts()` метод *перед* мы поместили в `PagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-213">Instead, we need to sort the results returned from the `GetProducts()` method *before* we put it in the `PagedDataSource`.</span></span>

<span data-ttu-id="1ead9-214">Для этого создайте новый метод в `ProductsBLL` класса `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-214">To accomplish this, create a new method in the `ProductsBLL` class, `GetProductsSortedAsPagedDataSource(sortExpression, pageIndex, pageSize)`.</span></span> <span data-ttu-id="1ead9-215">Чтобы отсортировать `ProductsDataTable` возвращаемые `GetProducts()` метод, укажите `Sort` свойство по умолчанию `DataTableView`:</span><span class="sxs-lookup"><span data-stu-id="1ead9-215">To sort the `ProductsDataTable` returned by the `GetProducts()` method, specify the `Sort` property of its default `DataTableView`:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample5.cs)]

<span data-ttu-id="1ead9-216">`GetProductsSortedAsPagedDataSource` Метод лишь незначительно отличается от `GetProductsAsPagedDataSource` метод, созданный в предыдущем учебном курсе.</span><span class="sxs-lookup"><span data-stu-id="1ead9-216">The `GetProductsSortedAsPagedDataSource` method differs only slightly from the `GetProductsAsPagedDataSource` method created in the previous tutorial.</span></span> <span data-ttu-id="1ead9-217">В частности `GetProductsSortedAsPagedDataSource` принимает дополнительный входной параметр `sortExpression` и присваивает это значение, чтобы `Sort` свойство `ProductDataTable` s `DefaultView`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-217">In particular, `GetProductsSortedAsPagedDataSource` accepts an additional input parameter `sortExpression` and assigns this value to the `Sort` property of the `ProductDataTable` s `DefaultView`.</span></span> <span data-ttu-id="1ead9-218">Несколько строк кода в более поздней версии, `PagedDataSource` присваивается объект s DataSource `ProductDataTable` s `DefaultView`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-218">A few lines of code later, the `PagedDataSource` object s DataSource is assigned the `ProductDataTable` s `DefaultView`.</span></span>

## <a name="calling-the-getproductssortedaspageddatasource-method-and-specifying-the-value-for-the-sortexpression-input-parameter"></a><span data-ttu-id="1ead9-219">Вызов метода GetProductsSortedAsPagedDataSource и указав значение для параметра SortExpression входных данных</span><span class="sxs-lookup"><span data-stu-id="1ead9-219">Calling the GetProductsSortedAsPagedDataSource Method and Specifying the Value for the SortExpression Input Parameter</span></span>

<span data-ttu-id="1ead9-220">С помощью `GetProductsSortedAsPagedDataSource` метод завершения, следующим шагом является для предоставления значения для этого параметра.</span><span class="sxs-lookup"><span data-stu-id="1ead9-220">With the `GetProductsSortedAsPagedDataSource` method complete, the next step is to provide the value for this parameter.</span></span> <span data-ttu-id="1ead9-221">ObjectDataSource в `SortingWithDefaultPaging.aspx` настроен для вызова `GetProductsAsPagedDataSource` и передает два входных параметра на его двух `QueryStringParameters`, которые указываются таким `SelectParameters` коллекции.</span><span class="sxs-lookup"><span data-stu-id="1ead9-221">The ObjectDataSource in `SortingWithDefaultPaging.aspx` is currently configured to call the `GetProductsAsPagedDataSource` method and passes in the two input parameters through its two `QueryStringParameters`, which are specified in the `SelectParameters` collection.</span></span> <span data-ttu-id="1ead9-222">Эти два `QueryStringParameters` указывают, что источник `GetProductsAsPagedDataSource` метод s *pageIndex* и *pageSize* параметры берутся из полей строки запроса `pageIndex` и `pageSize`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-222">These two `QueryStringParameters` indicate that the source for the `GetProductsAsPagedDataSource` method s *pageIndex* and *pageSize* parameters come from the querystring fields `pageIndex` and `pageSize`.</span></span>

<span data-ttu-id="1ead9-223">Обновить элемент управления ObjectDataSource `SelectMethod` свойство, чтобы он вызывал новый `GetProductsSortedAsPagedDataSource` метод.</span><span class="sxs-lookup"><span data-stu-id="1ead9-223">Update the ObjectDataSource s `SelectMethod` property so that it invokes the new `GetProductsSortedAsPagedDataSource` method.</span></span> <span data-ttu-id="1ead9-224">Затем добавьте новый `QueryStringParameter` таким образом, чтобы *sortExpression* входного параметра осуществляется из поля строки запроса `sortExpression`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-224">Then, add a new `QueryStringParameter` so that the *sortExpression* input parameter is accessed from the querystring field `sortExpression`.</span></span> <span data-ttu-id="1ead9-225">Задайте `QueryStringParameter` s `DefaultValue` к ProductName.</span><span class="sxs-lookup"><span data-stu-id="1ead9-225">Set the `QueryStringParameter` s `DefaultValue` to ProductName .</span></span>

<span data-ttu-id="1ead9-226">После внесения этих изменений декларативная разметка ObjectDataSource s должен выглядеть:</span><span class="sxs-lookup"><span data-stu-id="1ead9-226">After these changes, the ObjectDataSource s declarative markup should look like:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample6.aspx)]

<span data-ttu-id="1ead9-227">На этом этапе `SortingWithDefaultPaging.aspx` страницы будут отсортированы результаты в алфавитном порядке по названию продукта (см. рис. 9).</span><span class="sxs-lookup"><span data-stu-id="1ead9-227">At this point, the `SortingWithDefaultPaging.aspx` page will sort its results alphabetically by the product name (see Figure 9).</span></span> <span data-ttu-id="1ead9-228">Это обусловлено тем, по умолчанию значение ProductName, передается в качестве `GetProductsSortedAsPagedDataSource` метод s *sortExpression* параметра.</span><span class="sxs-lookup"><span data-stu-id="1ead9-228">This is because, by default, a value of ProductName is passed in as the `GetProductsSortedAsPagedDataSource` method s *sortExpression* parameter.</span></span>


<span data-ttu-id="1ead9-229">[![По умолчанию результаты сортируются по ProductName](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-229">[![By Default, the Results are Sorted by ProductName](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image24.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image23.png)</span></span>

<span data-ttu-id="1ead9-230">**Рис. 9**: По умолчанию результаты сортируются по `ProductName` ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-230">**Figure 9**: By Default, the Results are Sorted by `ProductName` ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image25.png))</span></span>


<span data-ttu-id="1ead9-231">Если вручную добавить `sortExpression` поля строки запроса, такие как `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` результаты будут отсортированы по заданному `sortExpression`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-231">If you manually add a `sortExpression` querystring field such as `SortingWithDefaultPaging.aspx?sortExpression=CategoryName` the results will be sorted by the specified `sortExpression`.</span></span> <span data-ttu-id="1ead9-232">Тем не менее это `sortExpression` параметр не включается в строке запроса при переходе на другую страницу данных.</span><span class="sxs-lookup"><span data-stu-id="1ead9-232">However, this `sortExpression` parameter is not included in the querystring when moving to a different page of data.</span></span> <span data-ttu-id="1ead9-233">На самом деле, нажав кнопку на странице Далее или последней кнопки вернетесь нас к `Paging.aspx`!</span><span class="sxs-lookup"><span data-stu-id="1ead9-233">In fact, clicking on the Next or Last page buttons takes us back to `Paging.aspx`!</span></span> <span data-ttu-id="1ead9-234">Кроме того здесь s в настоящее время сортировки интерфейс.</span><span class="sxs-lookup"><span data-stu-id="1ead9-234">Furthermore, there s currently no sorting interface.</span></span> <span data-ttu-id="1ead9-235">Единственным способом, пользователь может изменить порядок сортировки разбитых на страницы данных является прямое управление строку запроса.</span><span class="sxs-lookup"><span data-stu-id="1ead9-235">The only way a user can change the sort order of the paged data is by manipulating the querystring directly.</span></span>

## <a name="creating-the-sorting-interface"></a><span data-ttu-id="1ead9-236">Создание интерфейса сортировки</span><span class="sxs-lookup"><span data-stu-id="1ead9-236">Creating the Sorting Interface</span></span>

<span data-ttu-id="1ead9-237">Необходимо сначала обновить `RedirectUser` метод для отправки пользователю `SortingWithDefaultPaging.aspx` (а не `Paging.aspx`) и включать `sortExpression` значение в строке запроса.</span><span class="sxs-lookup"><span data-stu-id="1ead9-237">We first need to update the `RedirectUser` method to send the user to `SortingWithDefaultPaging.aspx` (instead of `Paging.aspx`) and to include the `sortExpression` value in the querystring.</span></span> <span data-ttu-id="1ead9-238">Мы также следует добавить только для чтения, страницам с именем `SortExpression` свойство.</span><span class="sxs-lookup"><span data-stu-id="1ead9-238">We should also add a read-only, page-level named `SortExpression` property.</span></span> <span data-ttu-id="1ead9-239">Это свойство, аналогичную `PageIndex` и `PageSize` свойства, созданные в предыдущем учебном курсе, возвращает значение `sortExpression` поля строки запроса, если он существует, а значение по умолчанию значение (ProductName) в противном случае.</span><span class="sxs-lookup"><span data-stu-id="1ead9-239">This property, similar to the `PageIndex` and `PageSize` properties created in the previous tutorial, returns the value of the `sortExpression` querystring field if it exists, and the default value ( ProductName ) otherwise.</span></span>

<span data-ttu-id="1ead9-240">В настоящее время `RedirectUser` метод принимает только один входной параметр индекс отображаемой страницы.</span><span class="sxs-lookup"><span data-stu-id="1ead9-240">Currently the `RedirectUser` method accepts only a single input parameter the index of the page to display.</span></span> <span data-ttu-id="1ead9-241">Тем не менее могут возникнуть ситуации, когда необходимо перенаправить пользователя на определенную страницу данных, используя выражение сортировки, отличные от какие s, указанный в строке запроса.</span><span class="sxs-lookup"><span data-stu-id="1ead9-241">However, there may be times when we want to redirect the user to a particular page of data using a sort expression other than what s specified in the querystring.</span></span> <span data-ttu-id="1ead9-242">Сейчас мы создадим интерфейс упорядочения для этой страницы, которая будет содержать несколько кнопку веб-элементов управления для сортировки данных с помощью указанного столбца.</span><span class="sxs-lookup"><span data-stu-id="1ead9-242">In a moment we'll create the sorting interface for this page, which will include a series of Button Web controls for sorting the data by a specified column.</span></span> <span data-ttu-id="1ead9-243">При нажатии одной из этих кнопок, необходимо перенаправить пользователя, передавая значение выражения сортировки, соответствующие.</span><span class="sxs-lookup"><span data-stu-id="1ead9-243">When one of those Buttons is clicked, we want to redirect the user passing in the appropriate sort expression value.</span></span> <span data-ttu-id="1ead9-244">Для обеспечения данной функциональности, создайте две версии `RedirectUser` метод.</span><span class="sxs-lookup"><span data-stu-id="1ead9-244">To provide this functionality, create two versions of the `RedirectUser` method.</span></span> <span data-ttu-id="1ead9-245">Первый из них должен принимать только индекс страницы для отображения, а второй принимает выражение страницы индекса и сортировки.</span><span class="sxs-lookup"><span data-stu-id="1ead9-245">The first one should accept just the page index to display, while the second one accepts the page index and sort expression.</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample7.cs)]

<span data-ttu-id="1ead9-246">В первом примере в этом руководстве мы создали сортировки интерфейс, с помощью элемента управления DropDownList.</span><span class="sxs-lookup"><span data-stu-id="1ead9-246">In the first example in this tutorial, we created a sorting interface using a DropDownList.</span></span> <span data-ttu-id="1ead9-247">В этом примере s позволяют использовать три кнопки веб-элементы управления, расположенный выше элемента управления DataList, один для сортировки с помощью `ProductName`, один для `CategoryName`и один для `SupplierName`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-247">For this example, let s use three Button Web controls positioned above the DataList one for sorting by `ProductName`, one for `CategoryName`, and one for `SupplierName`.</span></span> <span data-ttu-id="1ead9-248">Добавьте три кнопки веб-элементы управления, настройка их `ID` и `Text` свойства соответствующим образом:</span><span class="sxs-lookup"><span data-stu-id="1ead9-248">Add the three Button Web controls, setting their `ID` and `Text` properties appropriately:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample8.aspx)]

<span data-ttu-id="1ead9-249">Создайте `Click` обработчик событий для каждого.</span><span class="sxs-lookup"><span data-stu-id="1ead9-249">Next, create a `Click` event handler for each.</span></span> <span data-ttu-id="1ead9-250">Обработчики событий должны вызывать `RedirectUser` метода, возвращает пользователя на первую страницу, с помощью соответствующих сортировки выражения.</span><span class="sxs-lookup"><span data-stu-id="1ead9-250">The event handlers should call the `RedirectUser` method, returning the user to the first page using the appropriate sort expression.</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample9.cs)]

<span data-ttu-id="1ead9-251">При первом просмотре страницы, данные отсортированы по названию продукта в алфавитном порядке (см. рис. 9).</span><span class="sxs-lookup"><span data-stu-id="1ead9-251">When first visiting the page, the data is sorted by the product name alphabetically (refer back to Figure 9).</span></span> <span data-ttu-id="1ead9-252">Нажмите кнопку "Далее" для перехода на второй странице данных и нажмите кнопку сортировки, кнопка категории.</span><span class="sxs-lookup"><span data-stu-id="1ead9-252">Click the Next button to advance to the second page of data and then click the Sort by Category button.</span></span> <span data-ttu-id="1ead9-253">Это возвращает нас к первой странице данных, отсортированных по имени категории (см. рис. 10).</span><span class="sxs-lookup"><span data-stu-id="1ead9-253">This returns us to the first page of data, sorted by category name (see Figure 10).</span></span> <span data-ttu-id="1ead9-254">Аналогичным образом щелкнув кнопку поставщика сортировки сортирует данные поставщиком, начиная с первой страницы данных.</span><span class="sxs-lookup"><span data-stu-id="1ead9-254">Likewise, clicking the Sort by Supplier button sorts the data by supplier starting from the first page of data.</span></span> <span data-ttu-id="1ead9-255">Выбор сортировки запоминается как страницам данные.</span><span class="sxs-lookup"><span data-stu-id="1ead9-255">The sort choice is remembered as the data is paged through.</span></span> <span data-ttu-id="1ead9-256">Рис. 11 показана страница после сортировки по категориям и затем перейти на тринадцатого страницу данных.</span><span class="sxs-lookup"><span data-stu-id="1ead9-256">Figure 11 shows the page after sorting by category and then advancing to the thirteenth page of data.</span></span>


<span data-ttu-id="1ead9-257">[![Продукты упорядочены по категории](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-257">[![The Products are Sorted by Category](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image27.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image26.png)</span></span>

<span data-ttu-id="1ead9-258">**Рис. 10**: Продукты сортируются по категориям ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-258">**Figure 10**: The Products are Sorted by Category ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image28.png))</span></span>


<span data-ttu-id="1ead9-259">[![Выражение сортировки данные запоминаются при разбиения на страницы через](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-259">[![The Sort Expression is Remembered When Paging Through the Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image30.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image29.png)</span></span>

<span data-ttu-id="1ead9-260">**Рис. 11**: Выражение сортировки — запоминаются при разбиения на страницы через Data ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-260">**Figure 11**: The Sort Expression is Remembered When Paging Through the Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image31.png))</span></span>


## <a name="step-6-custom-paging-through-records-in-a-repeater"></a><span data-ttu-id="1ead9-261">Шаг 6. Пользовательское разбиение по страницам по записям в элементе управления Repeater</span><span class="sxs-lookup"><span data-stu-id="1ead9-261">Step 6: Custom Paging Through Records in a Repeater</span></span>

<span data-ttu-id="1ead9-262">В примере DataList исследуется на шаге 5 страниц по данным с применением технологии разбиения по страницам по умолчанию неэффективным.</span><span class="sxs-lookup"><span data-stu-id="1ead9-262">The DataList example examined in step 5 pages through its data using the inefficient default paging technique.</span></span> <span data-ttu-id="1ead9-263">При работе с большими объемами данных, крайне важно, что можно использовать пользовательское разбиение по страницам.</span><span class="sxs-lookup"><span data-stu-id="1ead9-263">When paging through sufficiently large amounts of data, it is imperative that custom paging be used.</span></span> <span data-ttu-id="1ead9-264">Вернитесь в [эффективного разбиения на страницы через больших объемов данных](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md) и [сортировки пользовательских данных, разбитых на страницы](../paging-and-sorting/sorting-custom-paged-data-cs.md) учебники, мы рассмотрели различия по умолчанию и пользовательское разбиение по страницам и созданный методы в BLL для Использование пользовательского разбиения по страницам и сортировка пользовательских разбитых на страницы данных.</span><span class="sxs-lookup"><span data-stu-id="1ead9-264">Back in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-cs.md) and [Sorting Custom Paged Data](../paging-and-sorting/sorting-custom-paged-data-cs.md) tutorials, we examined the differences between default and custom paging and created methods in the BLL for utilizing custom paging and sorting custom paged data.</span></span> <span data-ttu-id="1ead9-265">В частности, в этих двух предыдущих учебных курсах мы добавили следующие три метода `ProductsBLL` класса:</span><span class="sxs-lookup"><span data-stu-id="1ead9-265">In particular, in these two previous tutorials we added the following three methods to the `ProductsBLL` class:</span></span>

- <span data-ttu-id="1ead9-266">`GetProductsPaged(startRowIndex, maximumRows)` Возвращает определенное подмножество записей, начиная с *startRowIndex* и не превышает *maximumRows*.</span><span class="sxs-lookup"><span data-stu-id="1ead9-266">`GetProductsPaged(startRowIndex, maximumRows)` returns a particular subset of records starting at *startRowIndex* and not exceeding *maximumRows*.</span></span>
- <span data-ttu-id="1ead9-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` Возвращает определенное подмножество записей, отсортированных по указанным *sortExpression* входного параметра.</span><span class="sxs-lookup"><span data-stu-id="1ead9-267">`GetProductsPagedAndSorted(sortExpression, startRowIndex, maximumRows)` returns a particular subset of records sorted by the specified *sortExpression* input parameter.</span></span>
- <span data-ttu-id="1ead9-268">`TotalNumberOfProducts()` Представляет общее количество записей в `Products` таблицы базы данных.</span><span class="sxs-lookup"><span data-stu-id="1ead9-268">`TotalNumberOfProducts()` provides the total number of records in the `Products` database table.</span></span>

<span data-ttu-id="1ead9-269">Эти методы можно использовать для эффективного страницы и сортировки данных с помощью элемента управления DataList и Repeater.</span><span class="sxs-lookup"><span data-stu-id="1ead9-269">These methods can be used to efficiently page and sort through data using a DataList or Repeater control.</span></span> <span data-ttu-id="1ead9-270">Чтобы проиллюстрировать это, позвольте s начните с создания элемента управления Repeater с поддержкой пользовательского разбиения по страницам; Затем мы добавим возможности сортировки.</span><span class="sxs-lookup"><span data-stu-id="1ead9-270">To illustrate this, let s start by creating a Repeater control with custom paging support; we'll then add sorting capabilities.</span></span>

<span data-ttu-id="1ead9-271">Откройте `SortingWithCustomPaging.aspx` странице в `PagingSortingDataListRepeater` папку и добавьте элемент управления Repeater к странице, установив его `ID` свойства `Products`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-271">Open the `SortingWithCustomPaging.aspx` page in the `PagingSortingDataListRepeater` folder and add a Repeater to the page, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="1ead9-272">В смарт-теге элемента управления Repeater s, создайте новый ObjectDataSource, именуемый `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-272">From the Repeater s smart tag, create a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="1ead9-273">Настройте его для выбора данных из `ProductsBLL` класс s `GetProductsPaged` метод.</span><span class="sxs-lookup"><span data-stu-id="1ead9-273">Configure it to select its data from the `ProductsBLL` class s `GetProductsPaged` method.</span></span>


<span data-ttu-id="1ead9-274">[![Настройте элемент ObjectDataSource для использования метода GetProductsPaged класса ProductsBLL s](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-274">[![Configure the ObjectDataSource to Use the ProductsBLL Class s GetProductsPaged Method](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image33.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image32.png)</span></span>

<span data-ttu-id="1ead9-275">**Рис. 12**: Настройка ObjectDataSource для использования `ProductsBLL` класс s `GetProductsPaged` метод ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-275">**Figure 12**: Configure the ObjectDataSource to Use the `ProductsBLL` Class s `GetProductsPaged` Method ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image34.png))</span></span>


<span data-ttu-id="1ead9-276">Установите раскрывающиеся списки в UPDATE, INSERT и удаление вкладок (нет) и нажмите кнопку "Далее".</span><span class="sxs-lookup"><span data-stu-id="1ead9-276">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and then click the Next button.</span></span> <span data-ttu-id="1ead9-277">Мастер настройки источника данных, а теперь запрашивает источники `GetProductsPaged` метод s *startRowIndex* и *maximumRows* входных параметров.</span><span class="sxs-lookup"><span data-stu-id="1ead9-277">The Configure Data Source wizard now prompts for the sources of the `GetProductsPaged` method s *startRowIndex* and *maximumRows* input parameters.</span></span> <span data-ttu-id="1ead9-278">На самом деле эти параметры игнорируются.</span><span class="sxs-lookup"><span data-stu-id="1ead9-278">In actuality, these input parameters are ignored.</span></span> <span data-ttu-id="1ead9-279">Вместо этого *startRowIndex* и *maximumRows* значения будут передаваться в `Arguments` свойства в элемент управления ObjectDataSource s `Selecting` обработчик событий, как и как мы указали *sortExpression* в этой демонстрации первый учебник s.</span><span class="sxs-lookup"><span data-stu-id="1ead9-279">Instead, the *startRowIndex* and *maximumRows* values will be passed in through the `Arguments` property in the ObjectDataSource s `Selecting` event handler, just like how we specified the *sortExpression* in this tutorial s first demo.</span></span> <span data-ttu-id="1ead9-280">Таким образом оставьте источника параметра раскрывающиеся списки в мастере, установленному None.</span><span class="sxs-lookup"><span data-stu-id="1ead9-280">Therefore, leave the parameter source drop-down lists in the wizard set at None .</span></span>


<span data-ttu-id="1ead9-281">[![Оставьте набор источников параметра None](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-281">[![Leave the Parameter Sources Set to None](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image36.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image35.png)</span></span>

<span data-ttu-id="1ead9-282">**Рис. 13**: Оставьте параметр источников, задайте значение None ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-282">**Figure 13**: Leave the Parameter Sources Set to None ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image37.png))</span></span>


> [!NOTE]
> <span data-ttu-id="1ead9-283">Сделать *не* набора ObjectDataSource s `EnablePaging` свойства `true`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-283">Do *not* set the ObjectDataSource s `EnablePaging` property to `true`.</span></span> <span data-ttu-id="1ead9-284">Это приведет к ObjectDataSource автоматически включать свой собственный *startRowIndex* и *maximumRows* параметров `SelectMethod` s существующий список параметров.</span><span class="sxs-lookup"><span data-stu-id="1ead9-284">This will cause the ObjectDataSource to automatically include its own *startRowIndex* and *maximumRows* parameters to the `SelectMethod` s existing parameter list.</span></span> <span data-ttu-id="1ead9-285">`EnablePaging` Свойство полезно, когда пользовательские привязки, разбитых на страницы данных к элементу управления GridView, DetailsView и FormView, так как эти элементы управления ожидать определенных элементом управления ObjectDataSource s доступен только при `EnablePaging` свойство `true`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-285">The `EnablePaging` property is useful when binding custom paged data to a GridView, DetailsView, or FormView control because these controls expect certain behavior from the ObjectDataSource that s only available when `EnablePaging` property is `true`.</span></span> <span data-ttu-id="1ead9-286">Поскольку мы имеем вручную добавить поддержку разбиения по страницам для элементов управления DataList и Repeater, оставьте это свойство установлено в `false` (по умолчанию), как мы будем позаботимся необходимую функциональность непосредственно в странице ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="1ead9-286">Since we have to manually add the paging support for the DataList and Repeater, leave this property set to `false` (the default), as we'll bake in the needed functionality directly within our ASP.NET page.</span></span>


<span data-ttu-id="1ead9-287">Наконец, определите Repeater s `ItemTemplate` , чтобы были показаны название продукта s, категорию и поставщика.</span><span class="sxs-lookup"><span data-stu-id="1ead9-287">Finally, define the Repeater s `ItemTemplate` so that the product s name, category, and supplier are shown.</span></span> <span data-ttu-id="1ead9-288">После внесения этих изменений Repeater и ObjectDataSource s декларативный синтаксис должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="1ead9-288">After these changes, the Repeater and ObjectDataSource s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample10.aspx)]

<span data-ttu-id="1ead9-289">Отвлекитесь и посетить страницу через обозреватель и обратите внимание на то, что записи не возвращаются.</span><span class="sxs-lookup"><span data-stu-id="1ead9-289">Take a moment to visit the page through a browser and note that no records are returned.</span></span> <span data-ttu-id="1ead9-290">Это обусловлено тем, мы ve еще для указания *startRowIndex* и *maximumRows* значения параметров; таким образом, значение 0 передается в обоих.</span><span class="sxs-lookup"><span data-stu-id="1ead9-290">This is because we ve yet to specify the *startRowIndex* and *maximumRows* parameter values; therefore, values of 0 are being passed in for both.</span></span> <span data-ttu-id="1ead9-291">Чтобы задать эти значения, создайте обработчик событий для ObjectDataSource s `Selecting` событий и задать эти параметры программным образом значения для жестко запрограммированные значения от 0 до 5, соответственно:</span><span class="sxs-lookup"><span data-stu-id="1ead9-291">To specify these values, create an event handler for the ObjectDataSource s `Selecting` event and set these parameters values programmatically to hard-coded values of 0 and 5, respectively:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample11.cs)]

<span data-ttu-id="1ead9-292">После этого изменения на странице при просмотре в обозревателе отображаются первые пять продуктов.</span><span class="sxs-lookup"><span data-stu-id="1ead9-292">With this change, the page, when viewed through a browser, shows the first five products.</span></span>


<span data-ttu-id="1ead9-293">[![Отображаются первые пять записи](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-293">[![The First Five Records are Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image39.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image38.png)</span></span>

<span data-ttu-id="1ead9-294">**Рис. 14**: Отображаются первые пять записи ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-294">**Figure 14**: The First Five Records are Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image40.png))</span></span>


> [!NOTE]
> <span data-ttu-id="1ead9-295">Произойти продуктов, перечисленных на рис. 14, должны быть отсортированы по названию продукта, так как `GetProductsPaged` хранимую процедуру, которая выполняет эффективный пользовательского разбиения по страницам запрос упорядочивает результаты по `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-295">The products listed in Figure 14 happen to be sorted by product name because the `GetProductsPaged` stored procedure that performs the efficient custom paging query orders the results by `ProductName`.</span></span>


<span data-ttu-id="1ead9-296">Чтобы разрешить пользователям перемещаться по страницам, нам нужно отслеживать индекс начальной строки и максимальное число строк и помнить эти значения во время обратной передачи.</span><span class="sxs-lookup"><span data-stu-id="1ead9-296">In order to allow the user to step through the pages, we need to keep track of the start row index and maximum rows and remember these values across postbacks.</span></span> <span data-ttu-id="1ead9-297">В примере разбиение по страницам по умолчанию мы использовали поля строки запроса, чтобы сохранить эти значения; для этой демонстрации позволяют сохранять эти сведения в состоянии представления страницы s s.</span><span class="sxs-lookup"><span data-stu-id="1ead9-297">In the default paging example we used querystring fields to persist these values; for this demo, let s persist this information in the page s view state.</span></span> <span data-ttu-id="1ead9-298">Создайте следующие два свойства:</span><span class="sxs-lookup"><span data-stu-id="1ead9-298">Create the following two properties:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample12.cs)]

<span data-ttu-id="1ead9-299">Затем обновите код в обработчике событий выбор, заняв `StartRowIndex` и `MaximumRows` свойства вместо жестко запрограммированные значения от 0 до 5:</span><span class="sxs-lookup"><span data-stu-id="1ead9-299">Next, update the code in the Selecting event handler so that it uses the `StartRowIndex` and `MaximumRows` properties instead of the hard-coded values of 0 and 5:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample13.cs)]

<span data-ttu-id="1ead9-300">На этом этапе на нашей странице по-прежнему отображаются только первые пять записей.</span><span class="sxs-lookup"><span data-stu-id="1ead9-300">At this point our page still shows just the first five records.</span></span> <span data-ttu-id="1ead9-301">Однако с этими свойствами на месте, мы будет готов, чтобы создать интерфейс разбиения по страницам.</span><span class="sxs-lookup"><span data-stu-id="1ead9-301">However, with these properties in place, we re ready to create our paging interface.</span></span>

## <a name="adding-the-paging-interface"></a><span data-ttu-id="1ead9-302">Добавление интерфейса разбиения по страницам</span><span class="sxs-lookup"><span data-stu-id="1ead9-302">Adding the Paging Interface</span></span>

<span data-ttu-id="1ead9-303">Использование let s, первый же "," Назад "," следующего, последнее разбиение по страницам интерфейс используется в примере разбиение по страницам по умолчанию, включая Label Web, просматривается элемент управления, отображающий какие страницы данных и существует общее количество страниц.</span><span class="sxs-lookup"><span data-stu-id="1ead9-303">Let s use the same First, Previous, Next, Last paging interface used in the default paging example, including the Label Web control that displays what page of data is being viewed and how many total pages exist.</span></span> <span data-ttu-id="1ead9-304">Добавьте четыре кнопки веб-элементов управления и метку под элемент управления Repeater.</span><span class="sxs-lookup"><span data-stu-id="1ead9-304">Add the four Button Web controls and Label below the Repeater.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample14.aspx)]

<span data-ttu-id="1ead9-305">Создайте `Click` обработчики событий для четырех кнопок.</span><span class="sxs-lookup"><span data-stu-id="1ead9-305">Next, create `Click` event handlers for the four Buttons.</span></span> <span data-ttu-id="1ead9-306">При нажатии одной из этих кнопок, нам нужно обновить `StartRowIndex` и привяжите данные к элементу управления Repeater.</span><span class="sxs-lookup"><span data-stu-id="1ead9-306">When one of these Buttons is clicked, we need to update the `StartRowIndex` and rebind the data to the Repeater.</span></span> <span data-ttu-id="1ead9-307">Код для кнопок First, Previous и Next довольно проста, но для кнопки последней как определить индекс начальной строки для последней странице данных?</span><span class="sxs-lookup"><span data-stu-id="1ead9-307">The code for the First, Previous, and Next buttons is simple enough, but for the Last button how do we determine the start row index for the last page of data?</span></span> <span data-ttu-id="1ead9-308">Для вычисления этого индекса, а также вы можете определить Включение кнопки следующего и последнего нам необходимо знать, сколько записей в целом разбиваемых по страницам.</span><span class="sxs-lookup"><span data-stu-id="1ead9-308">To compute this index as well as being able to determine whether the Next and Last buttons should be enabled we need to know how many records in total are being paged through.</span></span> <span data-ttu-id="1ead9-309">Мы можете определить, вызвав `ProductsBLL` класс s `TotalNumberOfProducts()` метод.</span><span class="sxs-lookup"><span data-stu-id="1ead9-309">We can determine this by calling the `ProductsBLL` class s `TotalNumberOfProducts()` method.</span></span> <span data-ttu-id="1ead9-310">S позволяют создать свойство только для чтения, страницам с именем `TotalRowCount` , возвращающий результаты `TotalNumberOfProducts()` метод:</span><span class="sxs-lookup"><span data-stu-id="1ead9-310">Let s create a read-only, page-level property named `TotalRowCount` that returns the results of the `TotalNumberOfProducts()` method:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample15.cs)]

<span data-ttu-id="1ead9-311">С этим свойством теперь мы можем определить последний индекс начальной строки страницы s.</span><span class="sxs-lookup"><span data-stu-id="1ead9-311">With this property we can now determine the last page s start row index.</span></span> <span data-ttu-id="1ead9-312">В частности, он s целочисленный результат из `TotalRowCount` минус 1, деленное на `MaximumRows`, умноженному на `MaximumRows`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-312">Specifically, it s the integer result of the `TotalRowCount` minus 1 divided by `MaximumRows`, multiplied by `MaximumRows`.</span></span> <span data-ttu-id="1ead9-313">Теперь можно написать `Click` обработчики событий для четырех кнопок интерфейса разбиения на страницы:</span><span class="sxs-lookup"><span data-stu-id="1ead9-313">We can now write the `Click` event handlers for the four paging interface buttons:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample16.cs)]

<span data-ttu-id="1ead9-314">Наконец нам нужно отключить кнопки первый» и «назад в интерфейсе разбиения по страницам, при просмотре первой страницы данных и Далее» и «последняя кнопок, при просмотре на последней странице.</span><span class="sxs-lookup"><span data-stu-id="1ead9-314">Finally, we need to disable the First and Previous buttons in the paging interface when viewing the first page of data and the Next and Last buttons when viewing the last page.</span></span> <span data-ttu-id="1ead9-315">Для этого добавьте следующий код в элемент управления ObjectDataSource s `Selecting` обработчик событий:</span><span class="sxs-lookup"><span data-stu-id="1ead9-315">To accomplish this, add the following code to the ObjectDataSource s `Selecting` event handler:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample17.cs)]

<span data-ttu-id="1ead9-316">После добавления этих `Click` обработчики событий и код, чтобы включить или отключить элементы интерфейса разбиения по страницам, на основании текущий индекс начальной строки, проверка страницы в браузере.</span><span class="sxs-lookup"><span data-stu-id="1ead9-316">After adding these `Click` event handlers and the code to enable or disable the paging interface elements based on the current start row index, test the page in a browser.</span></span> <span data-ttu-id="1ead9-317">Как показано на рис. 15, при первом просмотре странице первого и кнопок будут отключены.</span><span class="sxs-lookup"><span data-stu-id="1ead9-317">As Figure 15 illustrates, when first visiting the page the First and Previous buttons will are disabled.</span></span> <span data-ttu-id="1ead9-318">Щелкните Далее, чтобы отобразить на второй странице данных, при щелчке последнего отображается последняя страница (см. рис. 16 и 17).</span><span class="sxs-lookup"><span data-stu-id="1ead9-318">Clicking Next shows the second page of data, while clicking Last displays the final page (see Figures 16 and 17).</span></span> <span data-ttu-id="1ead9-319">При просмотре на последней странице данных кнопки "Далее" и "Дата последнего будут отключены.</span><span class="sxs-lookup"><span data-stu-id="1ead9-319">When viewing the last page of data both the Next and Last buttons are disabled.</span></span>


<span data-ttu-id="1ead9-320">[![Назад и последней кнопки будут отключены при просмотре первой страницы продуктов](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-320">[![The Previous and Last Buttons are Disabled When Viewing the First Page of Products](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image42.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image41.png)</span></span>

<span data-ttu-id="1ead9-321">**Рис. 15**: Назад и последней кнопки будут отключены при просмотре первой страницы продукты ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-321">**Figure 15**: The Previous and Last Buttons are Disabled When Viewing the First Page of Products ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image43.png))</span></span>


<span data-ttu-id="1ead9-322">[![Вторая страница продуктов, которые вывод](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-322">[![The Second Page of Products are Dispalyed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image45.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image44.png)</span></span>

<span data-ttu-id="1ead9-323">**Рис. 16**: Вторая страница продуктов, которые вывод ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-323">**Figure 16**: The Second Page of Products are Dispalyed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image46.png))</span></span>


<span data-ttu-id="1ead9-324">[![Щелкнув последний отображает последней странице данных](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-324">[![Clicking Last Displays the Final Page of Data](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image48.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image47.png)</span></span>

<span data-ttu-id="1ead9-325">**Рис. 17**: Щелкнув последнего отображает данные из окончательного страницы ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-325">**Figure 17**: Clicking Last Displays the Final Page of Data ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image49.png))</span></span>


## <a name="step-7-including-sorting-support-with-the-custom-paged-repeater"></a><span data-ttu-id="1ead9-326">Шаг 7. Включая поддержки со специальной сортировки, разбитых на страницы элемент управления Repeater</span><span class="sxs-lookup"><span data-stu-id="1ead9-326">Step 7: Including Sorting Support with the Custom Paged Repeater</span></span>

<span data-ttu-id="1ead9-327">Теперь, когда используется пользовательское разбиение по страницам, мы будет готов для включения сортировки поддерживают.</span><span class="sxs-lookup"><span data-stu-id="1ead9-327">Now that custom paging has been implemented, we re ready to include sorting support.</span></span> <span data-ttu-id="1ead9-328">`ProductsBLL` Класс s `GetProductsPagedAndSorted` метод имеет те же *startRowIndex* и *maximumRows* входных параметров, как `GetProductsPaged`, но позволяет использовать дополнительный  *sortExpression* входного параметра.</span><span class="sxs-lookup"><span data-stu-id="1ead9-328">The `ProductsBLL` class s `GetProductsPagedAndSorted` method has the same *startRowIndex* and *maximumRows* input parameters as `GetProductsPaged`, but permits an additional *sortExpression* input parameter.</span></span> <span data-ttu-id="1ead9-329">Чтобы использовать `GetProductsPagedAndSorted` метода из `SortingWithCustomPaging.aspx`, необходимо выполнить следующие действия:</span><span class="sxs-lookup"><span data-stu-id="1ead9-329">To use the `GetProductsPagedAndSorted` method from `SortingWithCustomPaging.aspx`, we need to perform the following steps:</span></span>

1. <span data-ttu-id="1ead9-330">Изменить элемент управления ObjectDataSource s `SelectMethod` свойства из `GetProductsPaged` для `GetProductsPagedAndSorted`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-330">Change the ObjectDataSource s `SelectMethod` property from `GetProductsPaged` to `GetProductsPagedAndSorted`.</span></span>
2. <span data-ttu-id="1ead9-331">Добавить *sortExpression* `Parameter` объекта для ObjectDataSource s `SelectParameters` коллекции.</span><span class="sxs-lookup"><span data-stu-id="1ead9-331">Add a *sortExpression* `Parameter` object to the ObjectDataSource s `SelectParameters` collection.</span></span>
3. <span data-ttu-id="1ead9-332">Создайте закрытое, страницам `SortExpression` свойство, которое сохраняет его значение во время обратной передачи через состояние представления страницы s.</span><span class="sxs-lookup"><span data-stu-id="1ead9-332">Create a private, page-level `SortExpression` property that persists its value across postbacks through the page s view state.</span></span>
4. <span data-ttu-id="1ead9-333">Обновить элемент управления ObjectDataSource `Selecting` обработчик событий, чтобы назначить ObjectDataSource s *sortExpression* параметр значение страницам `SortExpression` свойство.</span><span class="sxs-lookup"><span data-stu-id="1ead9-333">Update the ObjectDataSource s `Selecting` event handler to assign the ObjectDataSource s *sortExpression* parameter the value of the page-level `SortExpression` property.</span></span>
5. <span data-ttu-id="1ead9-334">Создайте интерфейс сортировки.</span><span class="sxs-lookup"><span data-stu-id="1ead9-334">Create the sorting interface.</span></span>

<span data-ttu-id="1ead9-335">Начните с обновления ObjectDataSource s `SelectMethod` свойство и добавление *sortExpression* `Parameter`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-335">Start by updating the ObjectDataSource s `SelectMethod` property and adding a *sortExpression* `Parameter`.</span></span> <span data-ttu-id="1ead9-336">Убедитесь, что *sortExpression* `Parameter` s `Type` свойству `String`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-336">Make sure that the *sortExpression* `Parameter` s `Type` property is set to `String`.</span></span> <span data-ttu-id="1ead9-337">После завершения этих первых двух задач, декларативная разметка ObjectDataSource s должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="1ead9-337">After completing these first two tasks, the ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample18.aspx)]

<span data-ttu-id="1ead9-338">Теперь нам нужны уровня страницы `SortExpression` свойство, значение которого выполняется сериализация в состояние представления.</span><span class="sxs-lookup"><span data-stu-id="1ead9-338">Next, we need a page-level `SortExpression` property whose value is serialized to view state.</span></span> <span data-ttu-id="1ead9-339">Если значение выражения не сортировки не задана, используйте ProductName по умолчанию:</span><span class="sxs-lookup"><span data-stu-id="1ead9-339">If no sort expression value has been set, use ProductName as the default:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample19.cs)]

<span data-ttu-id="1ead9-340">Прежде чем элемент управления ObjectDataSource вызывает `GetProductsPagedAndSorted` метод, нам нужно установить *sortExpression* `Parameter` значению `SortExpression` свойство.</span><span class="sxs-lookup"><span data-stu-id="1ead9-340">Before the ObjectDataSource invokes the `GetProductsPagedAndSorted` method we need to set the *sortExpression* `Parameter` to the value of the `SortExpression` property.</span></span> <span data-ttu-id="1ead9-341">В `Selecting` обработчик событий, добавьте следующую строку кода:</span><span class="sxs-lookup"><span data-stu-id="1ead9-341">In the `Selecting` event handler, add the following line of code:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample20.cs)]

<span data-ttu-id="1ead9-342">Остается только реализовать интерфейс сортировки.</span><span class="sxs-lookup"><span data-stu-id="1ead9-342">All that remains is to implement the sorting interface.</span></span> <span data-ttu-id="1ead9-343">Как и в последнем примере, позвольте s имеют сортировки интерфейс, реализованный с помощью три кнопки веб-элементы управления разрешает пользователю сортировать результаты по имени продукта, категории или поставщику.</span><span class="sxs-lookup"><span data-stu-id="1ead9-343">As we did in the last example, let s have the sorting interface implemented using three Button Web controls that allow the user to sort the results by product name, category, or supplier.</span></span>


[!code-aspx[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample21.aspx)]

<span data-ttu-id="1ead9-344">Создание `Click` обработчики событий для эти три элемента управления.</span><span class="sxs-lookup"><span data-stu-id="1ead9-344">Create `Click` event handlers for these three Button controls.</span></span> <span data-ttu-id="1ead9-345">В случае сброса обработчик, `StartRowIndex` 0, задайте `SortExpression` соответствующее значение и повторную привязку данных к элементу управления Repeater:</span><span class="sxs-lookup"><span data-stu-id="1ead9-345">In the event handler, reset the `StartRowIndex` to 0, set the `SortExpression` to the appropriate value, and rebind the data to the Repeater:</span></span>


[!code-csharp[Main](sorting-data-in-a-datalist-or-repeater-control-cs/samples/sample22.cs)]

<span data-ttu-id="1ead9-346">Все, что s — его!</span><span class="sxs-lookup"><span data-stu-id="1ead9-346">That s all there is to it!</span></span> <span data-ttu-id="1ead9-347">Хотя существуют несколько этапов, чтобы получить пользовательское разбиение по страницам и сортировка реализована, действия были очень похоже на те, которые необходимы для разбиения на страницы по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="1ead9-347">While there were a number of steps to get custom paging and sorting implemented, the steps were very similar to those needed for default paging.</span></span> <span data-ttu-id="1ead9-348">Рис. 18 показаны продукты, при просмотре на последней странице данных при сортировке по категориям.</span><span class="sxs-lookup"><span data-stu-id="1ead9-348">Figure 18 shows the products when viewing the last page of data when sorted by category.</span></span>


<span data-ttu-id="1ead9-349">[![Отображаются последние данные страницы, отсортировано по категориям,](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="1ead9-349">[![The Last Page of Data, Sorted by Category, is Displayed](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image51.png)](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image50.png)</span></span>

<span data-ttu-id="1ead9-350">**Рис. 18**: Последняя страница данных, отсортировано по категориям, отображается ([Просмотр полноразмерного изображения](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="1ead9-350">**Figure 18**: The Last Page of Data, Sorted by Category, is Displayed ([Click to view full-size image](sorting-data-in-a-datalist-or-repeater-control-cs/_static/image52.png))</span></span>


> [!NOTE]
> <span data-ttu-id="1ead9-351">В предыдущих примерах, при сортировке по поставщику SupplierName использовался в качестве выражения сортировки.</span><span class="sxs-lookup"><span data-stu-id="1ead9-351">In previous examples, when sorting by the supplier SupplierName was used as the sort expression.</span></span> <span data-ttu-id="1ead9-352">Тем не менее для реализации пользовательского разбиения по страницам, нам нужно использовать CompanyName.</span><span class="sxs-lookup"><span data-stu-id="1ead9-352">However, for the custom paging implementation, we need to use CompanyName.</span></span> <span data-ttu-id="1ead9-353">Это обусловлено тем, хранимая процедура отвечает за реализацию пользовательского разбиения по страницам `GetProductsPagedAndSorted` передает выражение сортировки в `ROW_NUMBER()` ключевое слово, `ROW_NUMBER()` ключевого слова требуется действительное имя столбца, а не псевдоним.</span><span class="sxs-lookup"><span data-stu-id="1ead9-353">This is because the stored procedure responsible for implementing custom paging `GetProductsPagedAndSorted` passes the sort expression into the `ROW_NUMBER()` keyword, The `ROW_NUMBER()` keyword requires the actual column name rather than an alias.</span></span> <span data-ttu-id="1ead9-354">Таким образом, необходимо использовать `CompanyName` (имя столбца в `Suppliers` таблицы) вместо того чтобы псевдоним, используемый в `SELECT` запроса (`SupplierName`) для выражения сортировки.</span><span class="sxs-lookup"><span data-stu-id="1ead9-354">Therefore, we must use `CompanyName` (the name of the column in the `Suppliers` table) rather than the alias used in the `SELECT` query (`SupplierName`) for the sort expression.</span></span>


## <a name="summary"></a><span data-ttu-id="1ead9-355">Сводка</span><span class="sxs-lookup"><span data-stu-id="1ead9-355">Summary</span></span>

<span data-ttu-id="1ead9-356">Ни элементов управления DataList и Repeater, не предоставляют встроенную поддержку сортировки, но используя фрагмент кода и пользовательский интерфейс сортировки, можно добавить такие функциональные возможности.</span><span class="sxs-lookup"><span data-stu-id="1ead9-356">Neither the DataList nor Repeater offer built-in sorting support, but with a bit of code and a custom sorting interface, such functionality can be added.</span></span> <span data-ttu-id="1ead9-357">При реализации сортировки, но не разбивается на страницы, выражение сортировки можно указать с помощью `DataSourceSelectArguments` объект, передаваемый в элемент управления ObjectDataSource s `Select` метод.</span><span class="sxs-lookup"><span data-stu-id="1ead9-357">When implementing sorting, but not paging, the sort expression can be specified through the `DataSourceSelectArguments` object passed into the ObjectDataSource s `Select` method.</span></span> <span data-ttu-id="1ead9-358">Это `DataSourceSelectArguments` объект s `SortExpression` свойство может быть присвоено в элемент управления ObjectDataSource s `Selecting` обработчик событий.</span><span class="sxs-lookup"><span data-stu-id="1ead9-358">This `DataSourceSelectArguments` object s `SortExpression` property can be assigned in the ObjectDataSource s `Selecting` event handler.</span></span>

<span data-ttu-id="1ead9-359">Чтобы добавить возможности сортировки в элементе управления DataList или Repeater, который уже содержит поддержки разбиения по страницам, проще всего настроить уровня бизнес-логики, чтобы включить метод, который принимает выражение сортировки.</span><span class="sxs-lookup"><span data-stu-id="1ead9-359">To add sorting capabilities to a DataList or Repeater that already provides paging support, the easiest approach is to customize the Business Logic Layer to include a method that accepts a sort expression.</span></span> <span data-ttu-id="1ead9-360">Эти сведения можно затем передать в параметр в элемент управления ObjectDataSource s `SelectParameters`.</span><span class="sxs-lookup"><span data-stu-id="1ead9-360">This information can then be passed in through a parameter in the ObjectDataSource s `SelectParameters`.</span></span>

<span data-ttu-id="1ead9-361">Этот учебник завершает изучение разбиение по страницам и сортировка с использованием элементов управления DataList и Repeater.</span><span class="sxs-lookup"><span data-stu-id="1ead9-361">This tutorial completes our examination of paging and sorting with the DataList and Repeater controls.</span></span> <span data-ttu-id="1ead9-362">В этом руководстве на последнем рассмотрено Добавление кнопки веб-элементы управления в шаблоны элементов управления DataList и Repeater-s для обеспечения функций некоторые пользовательские, инициированное пользователем на основе каждого элемента.</span><span class="sxs-lookup"><span data-stu-id="1ead9-362">Our next and final tutorial will examine how to add Button Web controls to the DataList and Repeater s templates in order to provide some custom, user-initiated functionality on a per-item basis.</span></span>

<span data-ttu-id="1ead9-363">Счастливого вам программирования!</span><span class="sxs-lookup"><span data-stu-id="1ead9-363">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="1ead9-364">Об авторе</span><span class="sxs-lookup"><span data-stu-id="1ead9-364">About the Author</span></span>

<span data-ttu-id="1ead9-365">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP.NET и основатель веб- [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Microsoft с 1998 года.</span><span class="sxs-lookup"><span data-stu-id="1ead9-365">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="1ead9-366">Скотт — независимый консультант, преподаватель и автор.</span><span class="sxs-lookup"><span data-stu-id="1ead9-366">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="1ead9-367">Его последняя книга — [ *Sams Teach ASP.NET 2.0 in 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="1ead9-367">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="1ead9-368">Ним можно связаться по адресу [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1ead9-368">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="1ead9-369">или через его блог, который можно найти в [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="1ead9-369">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="1ead9-370">Особая благодарность</span><span class="sxs-lookup"><span data-stu-id="1ead9-370">Special Thanks To</span></span>

<span data-ttu-id="1ead9-371">В этой серии руководств пособий рецензировалась многими компетентными редакторами.</span><span class="sxs-lookup"><span data-stu-id="1ead9-371">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="1ead9-372">Основной рецензент этого учебного был Дэвид Suru.</span><span class="sxs-lookup"><span data-stu-id="1ead9-372">Lead reviewer for this tutorial was David Suru.</span></span> <span data-ttu-id="1ead9-373">Хотите поработать с моих последующих статей для MSDN?</span><span class="sxs-lookup"><span data-stu-id="1ead9-373">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="1ead9-374">Если Да, напишите мне [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1ead9-374">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1ead9-375">[Назад](paging-report-data-in-a-datalist-or-repeater-control-cs.md)
> [Вперед](paging-report-data-in-a-datalist-or-repeater-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="1ead9-375">[Previous](paging-report-data-in-a-datalist-or-repeater-control-cs.md)
[Next](paging-report-data-in-a-datalist-or-repeater-control-vb.md)</span></span>
