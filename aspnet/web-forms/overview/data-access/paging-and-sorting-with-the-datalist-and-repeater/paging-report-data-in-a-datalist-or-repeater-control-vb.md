---
uid: web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/paging-report-data-in-a-datalist-or-repeater-control-vb
title: Подкачка данных отчета в элементе управления DataList или Repeater (VB) | Документация Майкрософт
author: rick-anderson
description: Хотя ни элемент управления DataList, ни Repeater не поддерживают автоматическую подкачку или сортировку, в этом руководстве показано, как добавить поддержку разбиения по страницам в элемент управления DataList или Repeater,...
ms.author: riande
ms.date: 11/13/2006
ms.assetid: bbd6b7f7-b98a-48b4-93f3-341d6a4f53c0
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting-with-the-datalist-and-repeater/paging-report-data-in-a-datalist-or-repeater-control-vb
msc.type: authoredcontent
ms.openlocfilehash: 5c65ca1f263e41748d99323dbdf1c28fdd077246
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74570240"
---
# <a name="paging-report-data-in-a-datalist-or-repeater-control-vb"></a><span data-ttu-id="1986f-103">Разбиение по страницам данных отчета в элементе управления DataList или Repeater (VB)</span><span class="sxs-lookup"><span data-stu-id="1986f-103">Paging Report Data in a DataList or Repeater Control (VB)</span></span>

<span data-ttu-id="1986f-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="1986f-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="1986f-105">[Скачивание примера приложения](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_44_VB.exe) или [Загрузка PDF-файла](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/datatutorial44vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="1986f-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_44_VB.exe) or [Download PDF](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/datatutorial44vb1.pdf)</span></span>

> <span data-ttu-id="1986f-106">Хотя ни элемент управления DataList, ни Repeater не поддерживают автоматическую подкачку или сортировку, в этом учебнике показано, как добавить поддержку разбиения по страницам в элемент управления DataList или Repeater, что обеспечивает гораздо более гибкие интерфейсы разбиения по страницам и отображения данных.</span><span class="sxs-lookup"><span data-stu-id="1986f-106">While neither the DataList nor Repeater offer automatic paging or sorting support, this tutorial shows how to add paging support to the DataList or Repeater, which allows for much more flexible paging and data display interfaces.</span></span>

## <a name="introduction"></a><span data-ttu-id="1986f-107">Введение</span><span class="sxs-lookup"><span data-stu-id="1986f-107">Introduction</span></span>

<span data-ttu-id="1986f-108">Разбиение на страницы и сортировка — две очень распространенные функции при отображении данных в интерактивном приложении.</span><span class="sxs-lookup"><span data-stu-id="1986f-108">Paging and sorting are two very common features when displaying data in an online application.</span></span> <span data-ttu-id="1986f-109">Например, при поиске книг ASP.NET в книжном магазине могут содержаться сотни таких книг, но в отчете, в котором отображаются результаты поиска, отображается только десять соответствий на страницу.</span><span class="sxs-lookup"><span data-stu-id="1986f-109">For example, when searching for ASP.NET books at an online bookstore, there may be hundreds of such books, but the report listing the search results lists only ten matches per page.</span></span> <span data-ttu-id="1986f-110">Кроме того, результаты можно отсортировать по заголовку, цене, количеству страниц, имени автора и т. д.</span><span class="sxs-lookup"><span data-stu-id="1986f-110">Moreover, the results can be sorted by title, price, page count, author name, and so on.</span></span> <span data-ttu-id="1986f-111">Как мы обсуждали в учебнике по [данным отчета о разбиении по страницам и сортировке](../paging-and-sorting/paging-and-sorting-report-data-vb.md) , все элементы управления GridView, DetailsView и FormView предоставляют встроенную поддержку разбиения на страницы, которая может быть включена в такте флажка.</span><span class="sxs-lookup"><span data-stu-id="1986f-111">As we discussed in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-vb.md) tutorial, the GridView, DetailsView, and FormView controls all provide built-in paging support that can be enabled at the tick of a checkbox.</span></span> <span data-ttu-id="1986f-112">GridView также включает поддержку сортировки.</span><span class="sxs-lookup"><span data-stu-id="1986f-112">The GridView also includes sorting support.</span></span>

<span data-ttu-id="1986f-113">К сожалению, ни элемент управления DataList, ни повторитель не поддерживают автоматическое разбиение по страницам или сортировку.</span><span class="sxs-lookup"><span data-stu-id="1986f-113">Unfortunately, neither the DataList nor Repeater offer automatic paging or sorting support.</span></span> <span data-ttu-id="1986f-114">В этом учебнике мы рассмотрим, как добавить поддержку разбиения по страницам в DataList или Repeater.</span><span class="sxs-lookup"><span data-stu-id="1986f-114">In this tutorial we'll examine how to add paging support to the DataList or Repeater.</span></span> <span data-ttu-id="1986f-115">Необходимо вручную создать интерфейс разбиения по страницам, отобразить соответствующую страницу записей и запомнить страницу, которая посещается во время обратной передачи.</span><span class="sxs-lookup"><span data-stu-id="1986f-115">We must manually create the paging interface, display the appropriate page of records, and remember the page being visited across postbacks.</span></span> <span data-ttu-id="1986f-116">Хотя это занимает больше времени и кода, чем в GridView, DetailsView или FormView, элемент управления DataList и Repeater обеспечивает гораздо более гибкие интерфейсы разбиения по страницам и вывода данных.</span><span class="sxs-lookup"><span data-stu-id="1986f-116">While this does take more time and code than with the GridView, DetailsView, or FormView, the DataList and Repeater allow for much more flexible paging and data display interfaces.</span></span>

> [!NOTE]
> <span data-ttu-id="1986f-117">В этом учебнике основное внимание уделяется только разбиению на страницы.</span><span class="sxs-lookup"><span data-stu-id="1986f-117">This tutorial focuses exclusively on paging.</span></span> <span data-ttu-id="1986f-118">В следующем учебном курсе мы вернем внимание к добавлению возможностей сортировки.</span><span class="sxs-lookup"><span data-stu-id="1986f-118">In the next tutorial we'll turn our attention to adding sorting capabilities.</span></span>

## <a name="step-1-adding-the-paging-and-sorting-tutorial-web-pages"></a><span data-ttu-id="1986f-119">Шаг 1. Добавление веб-страниц учебника по разбиению по страницам и сортировке</span><span class="sxs-lookup"><span data-stu-id="1986f-119">Step 1: Adding the Paging and Sorting Tutorial Web Pages</span></span>

<span data-ttu-id="1986f-120">Прежде чем приступить к работе с этим руководством, давайте сначала добавим страницы ASP.NET, которые понадобятся для работы с этим руководством и следующего.</span><span class="sxs-lookup"><span data-stu-id="1986f-120">Before we start this tutorial, let s first take a moment to add the ASP.NET pages we'll need for this tutorial and the next one.</span></span> <span data-ttu-id="1986f-121">Начните с создания новой папки в проекте с именем `PagingSortingDataListRepeater`.</span><span class="sxs-lookup"><span data-stu-id="1986f-121">Start by creating a new folder in the project named `PagingSortingDataListRepeater`.</span></span> <span data-ttu-id="1986f-122">Затем добавьте в эту папку следующие пять страниц ASP.NET, чтобы все они были настроены для использования главной страницы `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="1986f-122">Next, add the following five ASP.NET pages to this folder, having all of them configured to use the master page `Site.master`:</span></span>

- `Default.aspx`
- `Paging.aspx`
- `Sorting.aspx`
- `SortingWithDefaultPaging.aspx`
- `SortingWithCustomPaging.aspx`

![Создание папки Пагингсортингдаталистрепеатер и добавление страниц Tutorial ASP.NET](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image1.png)

<span data-ttu-id="1986f-124">**Рис. 1**. Создание `PagingSortingDataListRepeater` папки и добавление страниц Tutorial ASP.NET</span><span class="sxs-lookup"><span data-stu-id="1986f-124">**Figure 1**: Create a `PagingSortingDataListRepeater` Folder and Add the Tutorial ASP.NET Pages</span></span>

<span data-ttu-id="1986f-125">Затем откройте страницу `Default.aspx` и перетащите `SectionLevelTutorialListing.ascx` пользовательский элемент управления из папки `UserControls` в область конструктора.</span><span class="sxs-lookup"><span data-stu-id="1986f-125">Next, open the `Default.aspx` page and drag the `SectionLevelTutorialListing.ascx` User Control from the `UserControls` folder onto the Design surface.</span></span> <span data-ttu-id="1986f-126">Этот пользовательский элемент управления, созданный при работе с [главными страницами и](../introduction/master-pages-and-site-navigation-vb.md) руководством по навигации по сайту, перечисляет карту узла и отображает эти руководства в текущем разделе в маркированном списке.</span><span class="sxs-lookup"><span data-stu-id="1986f-126">This User Control, which we created in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-vb.md) tutorial, enumerates the site map and displays those tutorials in the current section in a bulleted list.</span></span>

<span data-ttu-id="1986f-127">[![добавить пользовательский элемент управления SectionLevelTutorialListing. ascx в Default. aspx](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image3.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="1986f-127">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image3.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image2.png)</span></span>

<span data-ttu-id="1986f-128">**Рис. 2**. Добавление пользовательского элемента управления `SectionLevelTutorialListing.ascx` в `Default.aspx` ([щелкните, чтобы просмотреть изображение с полным размером](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="1986f-128">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image4.png))</span></span>

<span data-ttu-id="1986f-129">Чтобы в маркированном списке отображались учебники по разбиению на страницы и сортировка, которые будут созданы, необходимо добавить их на карту узла.</span><span class="sxs-lookup"><span data-stu-id="1986f-129">In order to have the bulleted list display the paging and sorting tutorials we'll be creating, we need to add them to the site map.</span></span> <span data-ttu-id="1986f-130">Откройте файл `Web.sitemap` и добавьте следующую разметку после изменения и удаления с помощью разметки узла схемы узла DataList:</span><span class="sxs-lookup"><span data-stu-id="1986f-130">Open the `Web.sitemap` file and add the following markup after the Editing and Deleting with the DataList site map node markup:</span></span>

[!code-xml[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample1.xml)]

![Обновление схемы узла для включения новых страниц ASP.NET](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image5.png)

<span data-ttu-id="1986f-132">**Рис. 3**. обновление схемы узла для включения новых страниц ASP.NET</span><span class="sxs-lookup"><span data-stu-id="1986f-132">**Figure 3**: Update the Site Map to Include the New ASP.NET Pages</span></span>

## <a name="a-review-of-paging"></a><span data-ttu-id="1986f-133">Проверка постраничного просмотра</span><span class="sxs-lookup"><span data-stu-id="1986f-133">A Review of Paging</span></span>

<span data-ttu-id="1986f-134">В предыдущих руководствах мы увидели, как пролистывать данные в элементах управления GridView, DetailsView и FormView.</span><span class="sxs-lookup"><span data-stu-id="1986f-134">In previous tutorials we saw how to page through the data in the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="1986f-135">Эти три элемента управления предлагают простую форму разбиения на страницы *по умолчанию* , которую можно реализовать, просто установив флажок Включить разбиение по страницам в смарт-теге элемента управления.</span><span class="sxs-lookup"><span data-stu-id="1986f-135">These three controls offer a simple form of paging called *default paging* that can be implemented by simply checking the Enable Paging option in the control s smart tag.</span></span> <span data-ttu-id="1986f-136">При использовании разбиения по страницам по умолчанию каждый раз, когда страница данных запрашивается либо на первой странице, либо когда пользователь переходит на другую страницу данных, элемент управления GridView, DetailsView или FormView повторно запрашивает *все* данные из ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="1986f-136">With default paging, each time a page of data is requested either on the first page visit or when the user navigates to a different page of data the GridView, DetailsView, or FormView control re-requests *all* of the data from the ObjectDataSource.</span></span> <span data-ttu-id="1986f-137">Затем он выводит определенный набор записей для последующего просмотра с учетом запрошенного индекса страницы и количества записей, отображаемых на странице.</span><span class="sxs-lookup"><span data-stu-id="1986f-137">It then snips out the particular set of records to display given the requested page index and the number of records to display per page.</span></span> <span data-ttu-id="1986f-138">По умолчанию мы обсуждали разбиение по страницам в учебнике по [просмотру и сортировке данных отчета](../paging-and-sorting/paging-and-sorting-report-data-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="1986f-138">We discussed default paging in detail in the [Paging and Sorting Report Data](../paging-and-sorting/paging-and-sorting-report-data-vb.md) tutorial.</span></span>

<span data-ttu-id="1986f-139">Так как разбиение по страницам по умолчанию повторно запрашивает все записи для каждой страницы, это непрактично при разбивке достаточно большого объема данных.</span><span class="sxs-lookup"><span data-stu-id="1986f-139">Since default paging re-requests all records for each page, it is not practical when paging through sufficiently large amounts of data.</span></span> <span data-ttu-id="1986f-140">Например, представьте подкачку 50 000 записей с размером страницы 10.</span><span class="sxs-lookup"><span data-stu-id="1986f-140">For example, imagine paging through 50,000 records with a page size of 10.</span></span> <span data-ttu-id="1986f-141">Каждый раз, когда пользователь переходит на новую страницу, все записи 50 000 должны быть получены из базы данных, несмотря на то, что отображаются только десять из них.</span><span class="sxs-lookup"><span data-stu-id="1986f-141">Each time the user moves to a new page, all 50,000 records must be retrieved from the database, even though only ten of them are displayed.</span></span>

<span data-ttu-id="1986f-142">*Пользовательское разбиение* на страницы решает проблемы с производительностью разбиения по страницам по умолчанию, заменяя только точное подмножество записей, отображаемых на запрошенной странице.</span><span class="sxs-lookup"><span data-stu-id="1986f-142">*Custom paging* solves the performance concerns of default paging by grabbing only the precise subset of records to display on the requested page.</span></span> <span data-ttu-id="1986f-143">При реализации пользовательского разбиения на страницы необходимо написать запрос SQL, который будет эффективно возвращать только правильный набор записей.</span><span class="sxs-lookup"><span data-stu-id="1986f-143">When implementing custom paging, we must write the SQL query that will efficiently return just the correct set of records.</span></span> <span data-ttu-id="1986f-144">Мы узнали, как создать такой запрос с помощью SQL Server 2005 s New [`ROW_NUMBER()` ключевое слово](http://www.4guysfromrolla.com/webtech/010406-1.shtml) обратно в [рамках эффективного разбиения по большим объемам данных](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="1986f-144">We saw how to create such a query using SQL Server 2005 s new [`ROW_NUMBER()` keyword](http://www.4guysfromrolla.com/webtech/010406-1.shtml) back in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) tutorial.</span></span>

<span data-ttu-id="1986f-145">Чтобы реализовать разбиение по страницам по умолчанию в элементах управления DataList или Repeater, можно использовать [класс`PagedDataSource`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.aspx) в качестве оболочки для `ProductsDataTable`, содержимое которого размещается на пейджер.</span><span class="sxs-lookup"><span data-stu-id="1986f-145">To implement default paging in the DataList or Repeater controls, we can use the [`PagedDataSource` class](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.aspx) as a wrapper around the `ProductsDataTable` whose contents are being paged.</span></span> <span data-ttu-id="1986f-146">Класс `PagedDataSource` имеет свойство `DataSource`, которое может быть назначено любому перечислимому объекту, а также свойства [`PageSize`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.pagesize.aspx) и [`CurrentPageIndex`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.currentpageindex.aspx) , указывающие количество записей, отображаемых на странице, и индекс текущей страницы.</span><span class="sxs-lookup"><span data-stu-id="1986f-146">The `PagedDataSource` class has a `DataSource` property that can be assigned to any enumerable object and [`PageSize`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.pagesize.aspx) and [`CurrentPageIndex`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.currentpageindex.aspx) properties that indicate how many records to show per page and the current page index.</span></span> <span data-ttu-id="1986f-147">После установки этих свойств `PagedDataSource` можно использовать в качестве источника данных для любого веб-элемента управления данными.</span><span class="sxs-lookup"><span data-stu-id="1986f-147">Once these properties have been set, the `PagedDataSource` can be used as the data source of any data Web control.</span></span> <span data-ttu-id="1986f-148">`PagedDataSource`при перечислении будет возвращать соответствующее подмножество записей внутреннего `DataSource` на основе свойств `PageSize` и `CurrentPageIndex`.</span><span class="sxs-lookup"><span data-stu-id="1986f-148">The `PagedDataSource`, when enumerated, will only return the appropriate subset of records of its inner `DataSource` based on the `PageSize` and `CurrentPageIndex` properties.</span></span> <span data-ttu-id="1986f-149">На рис. 4 показана функциональность класса `PagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="1986f-149">Figure 4 depicts the functionality of the `PagedDataSource` class.</span></span>

![Пажеддатасаурце упаковывает перечислимый объект с помощью страничного интерфейса.](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image6.png)

<span data-ttu-id="1986f-151">**Рис. 4**. `PagedDataSource` переносит перечислимый объект на многостраничный интерфейс</span><span class="sxs-lookup"><span data-stu-id="1986f-151">**Figure 4**: The `PagedDataSource` Wraps an Enumerable Object with a Pageable Interface</span></span>

<span data-ttu-id="1986f-152">Объект `PagedDataSource` можно создать и настроить непосредственно на уровне бизнес-логики, а также привязать к элементу управления DataList или Repeater через элемент управления ObjectDataSource или создать и настроить непосредственно в классе кода программной части ASP.NET Page s.</span><span class="sxs-lookup"><span data-stu-id="1986f-152">The `PagedDataSource` object can be created and configured directly from the Business Logic Layer and bound to a DataList or Repeater through an ObjectDataSource, or can be created and configured directly in the ASP.NET page s code-behind class.</span></span> <span data-ttu-id="1986f-153">Если используется второй подход, нам необходимо отказаться от с помощью ObjectDataSource и привязать данные, постранично, к DataList или Repeater программным способом.</span><span class="sxs-lookup"><span data-stu-id="1986f-153">If the latter approach is used, we must forgo using the ObjectDataSource and instead bind the paged data to the DataList or Repeater programmatically.</span></span>

<span data-ttu-id="1986f-154">Объект `PagedDataSource` также имеет свойства для поддержки пользовательского разбиения на страницы.</span><span class="sxs-lookup"><span data-stu-id="1986f-154">The `PagedDataSource` object also has properties to support custom paging.</span></span> <span data-ttu-id="1986f-155">Однако можно обойти использование `PagedDataSource` для пользовательского разбиения на страницы, так как у нас уже есть методы BLL в классе `ProductsBLL`, предназначенные для пользовательского разбиения на страницы, которые возвращают точные отображаемые записи.</span><span class="sxs-lookup"><span data-stu-id="1986f-155">However, we can bypass using a `PagedDataSource` for custom paging because we already have BLL methods in the `ProductsBLL` class designed for custom paging that return the precise records to display.</span></span>

<span data-ttu-id="1986f-156">В этом учебнике мы рассмотрим реализацию разбиения по страницам по умолчанию в DataList, добавив новый метод в класс `ProductsBLL`, который возвращает соответствующий настроенный объект `PagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="1986f-156">In this tutorial we'll look at implementing default paging in a DataList by adding a new method to the `ProductsBLL` class that returns an appropriately configured `PagedDataSource` object.</span></span> <span data-ttu-id="1986f-157">В следующем учебном курсе будет показано, как использовать пользовательское разбиение по страницам.</span><span class="sxs-lookup"><span data-stu-id="1986f-157">In the next tutorial, we'll see how to use custom paging.</span></span>

## <a name="step-2-adding-a-default-paging-method-in-the-business-logic-layer"></a><span data-ttu-id="1986f-158">Шаг 2. Добавление метода разбиения по страницам по умолчанию на уровне бизнес-логики</span><span class="sxs-lookup"><span data-stu-id="1986f-158">Step 2: Adding a Default Paging Method in the Business Logic Layer</span></span>

<span data-ttu-id="1986f-159">В настоящее время класс `ProductsBLL` содержит метод для возврата всех сведений о продукте `GetProducts()` и один для возврата определенного подмножества продуктов в начальный `GetProductsPaged(startRowIndex, maximumRows)`индекса.</span><span class="sxs-lookup"><span data-stu-id="1986f-159">The `ProductsBLL` class currently has a method for returning all product information `GetProducts()` and one for returning a particular subset of products at a starting index `GetProductsPaged(startRowIndex, maximumRows)`.</span></span> <span data-ttu-id="1986f-160">При использовании разбиения по страницам по умолчанию все элементы управления GridView, DetailsView и FormView используют метод `GetProducts()` для получения всех продуктов, а затем используют `PagedDataSource` внутренне для вывода только правильного подмножества записей.</span><span class="sxs-lookup"><span data-stu-id="1986f-160">With default paging, the GridView, DetailsView, and FormView controls all use the `GetProducts()` method to retrieve all products, but then use a `PagedDataSource` internally to display only the correct subset of records.</span></span> <span data-ttu-id="1986f-161">Чтобы реплицировать эту функцию с помощью элементов управления DataList и Repeater, мы можем создать в BLL новый метод, имитирующий это поведение.</span><span class="sxs-lookup"><span data-stu-id="1986f-161">To replicate this functionality with the DataList and Repeater controls, we can create a new method in the BLL that mimics this behavior.</span></span>

<span data-ttu-id="1986f-162">Добавьте метод в класс `ProductsBLL` с именем `GetProductsAsPagedDataSource`, который принимает два целочисленных входных параметра:</span><span class="sxs-lookup"><span data-stu-id="1986f-162">Add a method to the `ProductsBLL` class named `GetProductsAsPagedDataSource` that takes in two integer input parameters:</span></span>

- <span data-ttu-id="1986f-163">`pageIndex` индекс страницы для вывода, индексирования с нулевым значением и</span><span class="sxs-lookup"><span data-stu-id="1986f-163">`pageIndex` the index of the page to display, indexed at zero, and</span></span>
- <span data-ttu-id="1986f-164">`pageSize` число записей, отображаемых на странице.</span><span class="sxs-lookup"><span data-stu-id="1986f-164">`pageSize` the number of records to display per page.</span></span>

<span data-ttu-id="1986f-165">`GetProductsAsPagedDataSource` начинается с получения *всех* записей из `GetProducts()`.</span><span class="sxs-lookup"><span data-stu-id="1986f-165">`GetProductsAsPagedDataSource` starts by retrieving *all* of the records from `GetProducts()`.</span></span> <span data-ttu-id="1986f-166">Затем он создает объект `PagedDataSource`, устанавливая свойства `CurrentPageIndex` и `PageSize` в значения переданного `pageIndex` и `pageSize` параметров.</span><span class="sxs-lookup"><span data-stu-id="1986f-166">It then creates a `PagedDataSource` object, setting its `CurrentPageIndex` and `PageSize` properties to the values of the passed-in `pageIndex` and `pageSize` parameters.</span></span> <span data-ttu-id="1986f-167">Метод завершается возвратом этого настроенного `PagedDataSource`:</span><span class="sxs-lookup"><span data-stu-id="1986f-167">The method concludes by returning this configured `PagedDataSource`:</span></span>

[!code-vb[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample2.vb)]

## <a name="step-3-displaying-product-information-in-a-datalist-using-default-paging"></a><span data-ttu-id="1986f-168">Шаг 3. Отображение сведений о продукте в элементе управления DataList с помощью разбиения по страницам по умолчанию</span><span class="sxs-lookup"><span data-stu-id="1986f-168">Step 3: Displaying Product Information in a DataList Using Default Paging</span></span>

<span data-ttu-id="1986f-169">После добавления метода `GetProductsAsPagedDataSource` в класс `ProductsBLL` можно создать элемент управления DataList или Repeater, который обеспечивает разбиение по страницам по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="1986f-169">With the `GetProductsAsPagedDataSource` method added to the `ProductsBLL` class, we can now create a DataList or Repeater that provides default paging.</span></span> <span data-ttu-id="1986f-170">Для начала откройте страницу `Paging.aspx` в папке `PagingSortingDataListRepeater` и перетащите элемент управления DataList с панели инструментов в конструктор, установив для свойства DataList `ID` значение `ProductsDefaultPaging`.</span><span class="sxs-lookup"><span data-stu-id="1986f-170">Start by opening the `Paging.aspx` page in the `PagingSortingDataListRepeater` folder and drag a DataList from the Toolbox onto the Designer, setting the DataList s `ID` property to `ProductsDefaultPaging`.</span></span> <span data-ttu-id="1986f-171">Из смарт-тега DataList создайте новый объект ObjectDataSource с именем `ProductsDefaultPagingDataSource` и настройте его таким образом, чтобы он получал данные с помощью метода `GetProductsAsPagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="1986f-171">From the DataList s smart tag, create a new ObjectDataSource named `ProductsDefaultPagingDataSource` and configure it so that it retrieves data using the `GetProductsAsPagedDataSource` method.</span></span>

<span data-ttu-id="1986f-172">[![создать ObjectDataSource и настроить его для использования метода Жетпродуктсаспажеддатасаурце ()](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image8.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="1986f-172">[![Create an ObjectDataSource and Configure it to Use the GetProductsAsPagedDataSource () Method](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image8.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image7.png)</span></span>

<span data-ttu-id="1986f-173">**Рис. 5**. Создание ObjectDataSource и настройка его для использования метода `GetProductsAsPagedDataSource` `()` ([щелкните, чтобы просмотреть изображение с полным размером](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="1986f-173">**Figure 5**: Create an ObjectDataSource and Configure it to Use the `GetProductsAsPagedDataSource` `()` Method ([Click to view full-size image](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image9.png))</span></span>

<span data-ttu-id="1986f-174">Установите в раскрывающихся списках на вкладках обновления, вставки и удаления значение (нет).</span><span class="sxs-lookup"><span data-stu-id="1986f-174">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>

<span data-ttu-id="1986f-175">[![установить в раскрывающихся списках на вкладках обновления, вставки и удаления значение (нет)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image11.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="1986f-175">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image11.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image10.png)</span></span>

<span data-ttu-id="1986f-176">**Рис. 6**. Установка раскрывающихся списков на вкладках «обновить», «вставить» и «удалить» (нет) ([щелкните, чтобы просмотреть изображение с полным размером](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="1986f-176">**Figure 6**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE tabs to (None) ([Click to view full-size image](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image12.png))</span></span>

<span data-ttu-id="1986f-177">Так как метод `GetProductsAsPagedDataSource` ожидает два входных параметра, мастер запрашивает у нас источник этих значений параметров.</span><span class="sxs-lookup"><span data-stu-id="1986f-177">Since the `GetProductsAsPagedDataSource` method expects two input parameters, the wizard prompts us for the source of these parameter values.</span></span>

<span data-ttu-id="1986f-178">Значения индекса страницы и размера страницы должны быть сохранены во всех обратных передачах.</span><span class="sxs-lookup"><span data-stu-id="1986f-178">The page index and page size values must be remembered across postbacks.</span></span> <span data-ttu-id="1986f-179">Они могут храниться в состоянии представления, сохраняться в строке запроса, храниться в переменных сеанса или запоминать с помощью какой бы то ни было другой методики.</span><span class="sxs-lookup"><span data-stu-id="1986f-179">They can be stored in view state, persisted to the querystring, stored in session variables, or remembered using some other technique.</span></span> <span data-ttu-id="1986f-180">В этом учебнике мы будем использовать строку запроса, которая имеет преимущество предоставления определенной страницы данных закладками.</span><span class="sxs-lookup"><span data-stu-id="1986f-180">For this tutorial we'll use the querystring, which has the advantage of allowing a particular page of data to be bookmarked.</span></span>

<span data-ttu-id="1986f-181">В частности, используйте поля QueryString, pageIndex и pageSize для параметров `pageIndex` и `pageSize` соответственно (см. рис. 7).</span><span class="sxs-lookup"><span data-stu-id="1986f-181">In particular, use the querystring fields pageIndex and pageSize for the `pageIndex` and `pageSize` parameters, respectively (see Figure 7).</span></span> <span data-ttu-id="1986f-182">Задайте значения по умолчанию для этих параметров, так как значения строк запроса не будут представлены при первом посещении страницы пользователем.</span><span class="sxs-lookup"><span data-stu-id="1986f-182">Take a moment to set the default values for these parameters, as the querystring values won't be present when a user first visits this page.</span></span> <span data-ttu-id="1986f-183">Для `pageIndex`установите значение по умолчанию 0 (которое будет показывать первую страницу данных) и `pageSize` s по умолчанию равным 4.</span><span class="sxs-lookup"><span data-stu-id="1986f-183">For `pageIndex`, set the default value to 0 (which will show the first page of data) and `pageSize` s default value to 4.</span></span>

<span data-ttu-id="1986f-184">[![использовать строку запроса в качестве источника для параметров pageIndex и pageSize](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image14.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="1986f-184">[![Use the QueryString as the Source for the pageIndex and pageSize Parameters](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image14.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image13.png)</span></span>

<span data-ttu-id="1986f-185">**Рис. 7**. Использование строки запроса в качестве источника для параметров `pageIndex` и `pageSize` ([щелкните, чтобы просмотреть изображение с полным размером](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="1986f-185">**Figure 7**: Use the QueryString as the Source for the `pageIndex` and `pageSize` Parameters ([Click to view full-size image](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image15.png))</span></span>

<span data-ttu-id="1986f-186">После настройки ObjectDataSource Visual Studio автоматически создает `ItemTemplate` для DataList.</span><span class="sxs-lookup"><span data-stu-id="1986f-186">After configuring the ObjectDataSource, Visual Studio automatically creates an `ItemTemplate` for the DataList.</span></span> <span data-ttu-id="1986f-187">Настройте `ItemTemplate` таким образом, чтобы отображались только название, Категория и поставщик продукта.</span><span class="sxs-lookup"><span data-stu-id="1986f-187">Customize the `ItemTemplate` so that only the product s name, category, and supplier are shown.</span></span> <span data-ttu-id="1986f-188">Также задайте свойству `RepeatColumns` DataList s значение 2, его `Width` 100%, а `ItemStyle` s `Width` 50%.</span><span class="sxs-lookup"><span data-stu-id="1986f-188">Also set the DataList s `RepeatColumns` property to 2, its `Width` to 100%, and its `ItemStyle` s `Width` to 50%.</span></span> <span data-ttu-id="1986f-189">Эти параметры ширины будут предоставлять одинаковые интервалы для двух столбцов.</span><span class="sxs-lookup"><span data-stu-id="1986f-189">These width settings will provide equal spacing for the two columns.</span></span>

<span data-ttu-id="1986f-190">После внесения этих изменений разметка DataList и ObjectDataSource должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="1986f-190">After making these changes, the DataList and ObjectDataSource s markup should look similar to the following:</span></span>

[!code-aspx[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample3.aspx)]

> [!NOTE]
> <span data-ttu-id="1986f-191">Поскольку в этом учебнике не выполняются какие-либо функции обновления или удаления, можно отключить состояние представления DataList, чтобы уменьшить размер отображаемой страницы.</span><span class="sxs-lookup"><span data-stu-id="1986f-191">Since we are not performing any update or delete functionality in this tutorial, you may disable the DataList s view state to reduce the rendered page size.</span></span>

<span data-ttu-id="1986f-192">При первом посещении этой страницы в браузере не указаны параметры строки запроса `pageIndex` и `pageSize`.</span><span class="sxs-lookup"><span data-stu-id="1986f-192">When initially visiting this page through a browser, neither the `pageIndex` nor `pageSize` querystring parameters are provided.</span></span> <span data-ttu-id="1986f-193">Поэтому используются значения по умолчанию 0 и 4.</span><span class="sxs-lookup"><span data-stu-id="1986f-193">Hence, the default values of 0 and 4 are used.</span></span> <span data-ttu-id="1986f-194">Как показано на рис. 8, это приводит к отображению элемента управления DataList, отображающего первые четыре продукта.</span><span class="sxs-lookup"><span data-stu-id="1986f-194">As Figure 8 shows, this results in a DataList that displays the first four products.</span></span>

<span data-ttu-id="1986f-195">[![перечислены четыре первых продукта](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image17.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="1986f-195">[![The First Four Products are Listed](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image17.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image16.png)</span></span>

<span data-ttu-id="1986f-196">**Рис. 8**. список первых четырех продуктов ([щелкните, чтобы просмотреть изображение с полным размером](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="1986f-196">**Figure 8**: The First Four Products are Listed ([Click to view full-size image](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image18.png))</span></span>

<span data-ttu-id="1986f-197">Без интерфейса разбиения по страницам в настоящее время нет простых средств, позволяющих пользователю переходить на вторую страницу данных.</span><span class="sxs-lookup"><span data-stu-id="1986f-197">Without a paging interface, there s currently no straightforward means for a user to navigate to the second page of data.</span></span> <span data-ttu-id="1986f-198">На шаге 4 мы создадим интерфейс разбиения по страницам.</span><span class="sxs-lookup"><span data-stu-id="1986f-198">We'll create a paging interface in step 4.</span></span> <span data-ttu-id="1986f-199">Но пока вы можете выполнить разбиение на страницы только путем непосредственного указания условия разбиения по страницам в строке запроса.</span><span class="sxs-lookup"><span data-stu-id="1986f-199">For now, though, paging can only be accomplished by directly specifying the paging criteria in the querystring.</span></span> <span data-ttu-id="1986f-200">Например, чтобы просмотреть вторую страницу, измените URL-адрес в адресной строке браузера с `Paging.aspx` на `Paging.aspx?pageIndex=2` и нажмите клавишу ВВОД.</span><span class="sxs-lookup"><span data-stu-id="1986f-200">For example, to view the second page, change the URL in the browser s Address bar from `Paging.aspx` to `Paging.aspx?pageIndex=2` and hit Enter.</span></span> <span data-ttu-id="1986f-201">Это приводит к отображению второй страницы данных (см. рис. 9).</span><span class="sxs-lookup"><span data-stu-id="1986f-201">This causes the second page of data to be displayed (see Figure 9).</span></span>

<span data-ttu-id="1986f-202">[![отображается вторая страница данных](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image20.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="1986f-202">[![The Second Page of Data is Displayed](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image20.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image19.png)</span></span>

<span data-ttu-id="1986f-203">**Рис. 9**. Отображение второй страницы данных ([щелкните, чтобы просмотреть изображение с полным размером](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="1986f-203">**Figure 9**: The Second Page of Data is Displayed ([Click to view full-size image](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image21.png))</span></span>

## <a name="step-4-creating-the-paging-interface"></a><span data-ttu-id="1986f-204">Шаг 4. Создание интерфейса разбиения по страницам</span><span class="sxs-lookup"><span data-stu-id="1986f-204">Step 4: Creating the Paging Interface</span></span>

<span data-ttu-id="1986f-205">Существует множество различных интерфейсов разбиения на страницы, которые можно реализовать.</span><span class="sxs-lookup"><span data-stu-id="1986f-205">There are a variety of different paging interfaces that can be implemented.</span></span> <span data-ttu-id="1986f-206">Элементы управления GridView, DetailsView и FormView предоставляют четыре различных интерфейса для выбора:</span><span class="sxs-lookup"><span data-stu-id="1986f-206">The GridView, DetailsView, and FormView controls provide four different interfaces to choose among:</span></span>

- <span data-ttu-id="1986f-207">**Затем предыдущие** пользователи могут перемещаться по одной странице за раз, либо на следующую или предыдущую.</span><span class="sxs-lookup"><span data-stu-id="1986f-207">**Next, Previous** users can move one page at a time, to either the next or previous one.</span></span>
- <span data-ttu-id="1986f-208">**Следующий, предыдущий, первый, последний** в дополнение к кнопкам "Далее" и "назад" Этот интерфейс включает в себя первую и последнюю кнопки для перехода на первую или последнюю страницу.</span><span class="sxs-lookup"><span data-stu-id="1986f-208">**Next, Previous, First, Last** in addition to Next and Previous buttons, this interface includes First and Last buttons for moving to the very first or very last page.</span></span>
- <span data-ttu-id="1986f-209">**Числовой** список номеров страниц в интерфейсе разбиения на страницы, позволяющий пользователю быстро перейти к определенной странице.</span><span class="sxs-lookup"><span data-stu-id="1986f-209">**Numeric** lists the page numbers in the paging interface, allowing a user to quickly jump to a particular page.</span></span>
- <span data-ttu-id="1986f-210">**Числовой, первый, последний** в дополнение к числу номеров страниц содержит кнопки для перехода на первую или последнюю страницу.</span><span class="sxs-lookup"><span data-stu-id="1986f-210">**Numeric, First, Last** in addition to the numeric page numbers, includes buttons for moving to the very first or very last page.</span></span>

<span data-ttu-id="1986f-211">Для элементов управления DataList и Repeater мы обязаны выбрать интерфейс разбиения по страницам и реализовать его.</span><span class="sxs-lookup"><span data-stu-id="1986f-211">For the DataList and Repeater, we are responsible for deciding upon a paging interface and implementing it.</span></span> <span data-ttu-id="1986f-212">Это подразумевает создание необходимых веб-элементов управления на странице и отображение запрашиваемой страницы при нажатии на определенную кнопку интерфейса разбиения по страницам.</span><span class="sxs-lookup"><span data-stu-id="1986f-212">This involves creating the needed Web controls in the page and displaying the requested page when a particular paging interface button is clicked.</span></span> <span data-ttu-id="1986f-213">Кроме того, может потребоваться отключить некоторые элементы управления "интерфейс разбиения на страницы".</span><span class="sxs-lookup"><span data-stu-id="1986f-213">Additionally, certain paging interface controls may need to be disabled.</span></span> <span data-ttu-id="1986f-214">Например, при просмотре первой страницы данных с помощью следующего, предыдущего, последнего интерфейса, кнопки Первая и Предыдущная будут отключены.</span><span class="sxs-lookup"><span data-stu-id="1986f-214">For example, when viewing the first page of data using the Next, Previous, First, Last interface, both the First and Previous buttons would be disabled.</span></span>

<span data-ttu-id="1986f-215">В этом руководстве мы будем использовать следующий, предыдущий, первый, последний интерфейс.</span><span class="sxs-lookup"><span data-stu-id="1986f-215">For this tutorial, let s use the Next, Previous, First, Last interface.</span></span> <span data-ttu-id="1986f-216">Добавьте на страницу четыре веб-элемента управления Button и задайте для их `ID` s значения `FirstPage`, `PrevPage`, `NextPage`и `LastPage`.</span><span class="sxs-lookup"><span data-stu-id="1986f-216">Add four Button Web controls to the page and set their `ID` s to `FirstPage`, `PrevPage`, `NextPage`, and `LastPage`.</span></span> <span data-ttu-id="1986f-217">Задайте для свойств `Text` значение &lt;&lt; First, &lt; назад, далее &gt;и Last &gt;&gt;.</span><span class="sxs-lookup"><span data-stu-id="1986f-217">Set the `Text` properties to &lt;&lt; First, &lt; Prev, Next &gt;, and Last &gt;&gt; .</span></span>

[!code-aspx[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample4.aspx)]

<span data-ttu-id="1986f-218">Затем создайте обработчик событий `Click` для каждой из этих кнопок.</span><span class="sxs-lookup"><span data-stu-id="1986f-218">Next, create a `Click` event handler for each of these Buttons.</span></span> <span data-ttu-id="1986f-219">Сейчас мы добавим код, необходимый для вывода запрошенной страницы.</span><span class="sxs-lookup"><span data-stu-id="1986f-219">In a moment we'll add the code necessary to display the requested page.</span></span>

## <a name="remembering-the-total-number-of-records-being-paged-through"></a><span data-ttu-id="1986f-220">Запоминание общего числа записей, продаваемых по страницам</span><span class="sxs-lookup"><span data-stu-id="1986f-220">Remembering the Total Number of Records Being Paged Through</span></span>

<span data-ttu-id="1986f-221">Независимо от выбранного интерфейса разбиения по страницам необходимо вычислить и запомнить общее число записей, на которые размещается страница.</span><span class="sxs-lookup"><span data-stu-id="1986f-221">Regardless of the paging interface selected, we need to compute and remember the total number of records being paged through.</span></span> <span data-ttu-id="1986f-222">Общее число строк (в сочетании с размером страницы) определяет, сколько всего страниц данных размещается по страницам, что определяет добавление или включение элементов управления интерфейса разбиения на страницы.</span><span class="sxs-lookup"><span data-stu-id="1986f-222">The total row count (in conjunction with the page size) determines how many total pages of data are being paged through, which determines what paging interface controls are added or are enabled.</span></span> <span data-ttu-id="1986f-223">В следующем, предыдущем и первом последнем интерфейсе, который мы создаем, число страниц используется двумя способами:</span><span class="sxs-lookup"><span data-stu-id="1986f-223">In the Next, Previous, First, Last interface that we are building, the page count is used in two ways:</span></span>

- <span data-ttu-id="1986f-224">Чтобы определить, просматривается ли последняя страница, в этом случае кнопки Next и Last отключаются.</span><span class="sxs-lookup"><span data-stu-id="1986f-224">To determine whether we are viewing the last page, in which case the Next and Last buttons are disabled.</span></span>
- <span data-ttu-id="1986f-225">Если пользователь нажимает последнюю кнопку, необходимо перенесет их на последнюю страницу, индекс которой меньше, чем число страниц.</span><span class="sxs-lookup"><span data-stu-id="1986f-225">If the user clicks the Last button we need to whisk them to the last page, whose index is one less than the page count.</span></span>

<span data-ttu-id="1986f-226">Число страниц вычисляется как самое верхнее общее число строк, деленное на размер страницы.</span><span class="sxs-lookup"><span data-stu-id="1986f-226">The page count is calculated as the ceiling of the total row count divided by the page size.</span></span> <span data-ttu-id="1986f-227">Например, если выполняется разбиение на страницы 79 записей с четырьмя записями на страницу, то число страниц будет равно 20 (потолок 79/4).</span><span class="sxs-lookup"><span data-stu-id="1986f-227">For example, if we are paging through 79 records with four records per page, then the page count is 20 (the ceiling of 79 / 4).</span></span> <span data-ttu-id="1986f-228">При использовании числового интерфейса разбиения по страницам эта информация информирует нас о том, сколько числовых кнопок страницы отображать; Если интерфейс разбиения по страницам включает кнопки «Далее» и «последняя», то количество страниц используется для определения момента отключения кнопок «Далее» и «последняя».</span><span class="sxs-lookup"><span data-stu-id="1986f-228">If we are using the Numeric paging interface, this information informs us as to how many numeric page buttons to display; if our paging interface includes Next or Last buttons, the page count is used to determine when to disable the Next or Last buttons.</span></span>

<span data-ttu-id="1986f-229">Если интерфейс разбиения по страницам включает последнюю кнопку, то крайне важно, чтобы общее количество записей, разбитых на страницы, запомнилось между обратными передачами, чтобы при нажатии последней кнопки можно было определить последний индекс страницы.</span><span class="sxs-lookup"><span data-stu-id="1986f-229">If the paging interface includes a Last button, it is imperative that the total number of records being paged through be remembered across postbacks so that when the Last button is clicked we can determine the last page index.</span></span> <span data-ttu-id="1986f-230">Чтобы упростить это, создайте свойство `TotalRowCount` в классе кода программной части ASP.NET Page s, сохраняющем его значение в состоянии представления:</span><span class="sxs-lookup"><span data-stu-id="1986f-230">To facilitate this, create a `TotalRowCount` property in the ASP.NET page s code-behind class that persists its value to view state:</span></span>

[!code-vb[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample5.vb)]

<span data-ttu-id="1986f-231">Помимо `TotalRowCount`, создайте минуту, чтобы создать свойства уровня страницы только для чтения для простого доступа к индексу страницы, размеру страницы и количеству страниц:</span><span class="sxs-lookup"><span data-stu-id="1986f-231">In addition to `TotalRowCount`, take a minute to create read-only page-level properties for easily accessing the page index, page size, and page count:</span></span>

[!code-vb[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample6.vb)]

## <a name="determining-the-total-number-of-records-being-paged-through"></a><span data-ttu-id="1986f-232">Определение общего числа записей, на которые размещается страница</span><span class="sxs-lookup"><span data-stu-id="1986f-232">Determining the Total Number of Records Being Paged Through</span></span>

<span data-ttu-id="1986f-233">Объект `PagedDataSource`, возвращаемый из метода ObjectDataSource `Select()`, содержит *все* записи продукта, хотя в DataList отображаются только их подмножества.</span><span class="sxs-lookup"><span data-stu-id="1986f-233">The `PagedDataSource` object returned from the ObjectDataSource s `Select()` method has within it *all* of the product records, even though only a subset of them are displayed in the DataList.</span></span> <span data-ttu-id="1986f-234">Свойство `PagedDataSource` s [`Count`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.count.aspx) возвращает только число элементов, которые будут отображаться в DataList. [свойство`DataSourceCount`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.datasourcecount.aspx) возвращает общее число элементов в `PagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="1986f-234">The `PagedDataSource` s [`Count` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.count.aspx) returns only the number of items that will be displayed in the DataList; the [`DataSourceCount` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.datasourcecount.aspx) returns the total number of items within the `PagedDataSource`.</span></span> <span data-ttu-id="1986f-235">Поэтому необходимо назначить свойству ASP.NET Pages `TotalRowCount` значение свойства `DataSourceCount` `PagedDataSource` s.</span><span class="sxs-lookup"><span data-stu-id="1986f-235">Therefore, we need to assign the ASP.NET page s `TotalRowCount` property the value of the `PagedDataSource` s `DataSourceCount` property.</span></span>

<span data-ttu-id="1986f-236">Для этого создайте обработчик событий для события `Selected` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="1986f-236">To accomplish this, create an event handler for the ObjectDataSource s `Selected` event.</span></span> <span data-ttu-id="1986f-237">В обработчике событий `Selected` есть доступ к возвращаемому значению метода ObjectDataSource s `Select()` в данном случае — `PagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="1986f-237">In the `Selected` event handler we have access to the return value of the ObjectDataSource s `Select()` method in this case, the `PagedDataSource`.</span></span>

[!code-vb[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample7.vb)]

## <a name="displaying-the-requested-page-of-data"></a><span data-ttu-id="1986f-238">Отображение запрошенной страницы данных</span><span class="sxs-lookup"><span data-stu-id="1986f-238">Displaying the Requested Page of Data</span></span>

<span data-ttu-id="1986f-239">Когда пользователь нажимает одну из кнопок в интерфейсе разбиения по страницам, необходимо отобразить запрошенную страницу данных.</span><span class="sxs-lookup"><span data-stu-id="1986f-239">When the user clicks one of the buttons in the paging interface, we need to display the requested page of data.</span></span> <span data-ttu-id="1986f-240">Так как параметры разбиения по страницам указываются с помощью строки запроса, для отображения запрошенной страницы данных используйте `Response.Redirect(url)`, чтобы браузер пользователя повторно запрашивал страницу `Paging.aspx` с соответствующими параметрами разбиения по страницам.</span><span class="sxs-lookup"><span data-stu-id="1986f-240">Since the paging parameters are specified via the querystring, to show the requested page of data use `Response.Redirect(url)` to have the user s browser re-request the `Paging.aspx` page with the appropriate paging parameters.</span></span> <span data-ttu-id="1986f-241">Например, чтобы отобразить вторую страницу данных, необходимо перенаправить пользователя в `Paging.aspx?pageIndex=1`.</span><span class="sxs-lookup"><span data-stu-id="1986f-241">For example, to display the second page of data, we would redirect the user to `Paging.aspx?pageIndex=1`.</span></span>

<span data-ttu-id="1986f-242">Чтобы упростить это, создайте метод `RedirectUser(sendUserToPageIndex)`, который перенаправляет пользователя на `Paging.aspx?pageIndex=sendUserToPageIndex`.</span><span class="sxs-lookup"><span data-stu-id="1986f-242">To facilitate this, create a `RedirectUser(sendUserToPageIndex)` method that redirects the user to `Paging.aspx?pageIndex=sendUserToPageIndex`.</span></span> <span data-ttu-id="1986f-243">Затем вызовите этот метод из четырех кнопок `Click` обработчиков событий.</span><span class="sxs-lookup"><span data-stu-id="1986f-243">Then, call this method from the four Button `Click` event handlers.</span></span> <span data-ttu-id="1986f-244">В обработчике событий `FirstPage` `Click` вызовите метод `RedirectUser(0)`, чтобы отправить их на первую страницу. в обработчике событий `PrevPage` `Click` используйте `PageIndex - 1` в качестве индекса страницы. и т. д.</span><span class="sxs-lookup"><span data-stu-id="1986f-244">In the `FirstPage` `Click` event handler, call `RedirectUser(0)`, to send them to the first page; in the `PrevPage` `Click` event handler, use `PageIndex - 1` as the page index; and so on.</span></span>

[!code-vb[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample8.vb)]

<span data-ttu-id="1986f-245">После завершения обработчиков событий `Click` можно пролистывать записи DataList-s, нажимая кнопки.</span><span class="sxs-lookup"><span data-stu-id="1986f-245">With the `Click` event handlers complete, the DataList s records can be paged through by clicking the buttons.</span></span> <span data-ttu-id="1986f-246">Уделите немного времени для пробного использования!</span><span class="sxs-lookup"><span data-stu-id="1986f-246">Take a moment to try it out!</span></span>

## <a name="disabling-paging-interface-controls"></a><span data-ttu-id="1986f-247">Отключение элементов управления интерфейса разбиения по страницам</span><span class="sxs-lookup"><span data-stu-id="1986f-247">Disabling Paging Interface Controls</span></span>

<span data-ttu-id="1986f-248">В настоящее время все четыре кнопки включены независимо от просматриваемой страницы.</span><span class="sxs-lookup"><span data-stu-id="1986f-248">Currently, all four buttons are enabled regardless of the page being viewed.</span></span> <span data-ttu-id="1986f-249">Однако мы хотим отключить первую и предыдущую кнопки при отображении первой страницы данных, а также кнопки «Следующая» и «последняя» при отображении последней страницы.</span><span class="sxs-lookup"><span data-stu-id="1986f-249">However, we want to disable the First and Previous buttons when showing the first page of data, and the Next and Last buttons when showing the last page.</span></span> <span data-ttu-id="1986f-250">Объект `PagedDataSource`, возвращаемый методом `Select()` ObjectDataSource, имеет свойства [`IsFirstPage`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.isfirstpage.aspx) и [`IsLastPage`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.islastpage.aspx) , которые можно проверить, чтобы определить, просматривается ли первая или последняя страница данных.</span><span class="sxs-lookup"><span data-stu-id="1986f-250">The `PagedDataSource` object returned by the ObjectDataSource s `Select()` method has properties [`IsFirstPage`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.isfirstpage.aspx) and [`IsLastPage`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pageddatasource.islastpage.aspx) that we can examine to determine if we are viewing the first or last page of data.</span></span>

<span data-ttu-id="1986f-251">Добавьте следующий элемент в обработчик событий `Selected` ObjectDataSource:</span><span class="sxs-lookup"><span data-stu-id="1986f-251">Add the following to the ObjectDataSource s `Selected` event handler:</span></span>

[!code-vb[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample9.vb)]

<span data-ttu-id="1986f-252">При таком добавлении первая и предыдущая кнопки будут отключены при просмотре первой страницы, а следующая и Последняя кнопки будут отключены при просмотре последней страницы.</span><span class="sxs-lookup"><span data-stu-id="1986f-252">With this addition, the First and Previous buttons will be disabled when viewing the first page, while the Next and Last buttons will be disabled when viewing the last page.</span></span>

<span data-ttu-id="1986f-253">Давайте добавим интерфейс разбиения по страницам, уведомляя пользователя о том, на какой странице он просматривался в данный момент и сколько всего страниц.</span><span class="sxs-lookup"><span data-stu-id="1986f-253">Let s complete the paging interface by informing the user what page they re currently viewing and how many total pages exist.</span></span> <span data-ttu-id="1986f-254">Добавьте на страницу веб-элемент управления Label и задайте для его свойства `ID` значение `CurrentPageNumber`.</span><span class="sxs-lookup"><span data-stu-id="1986f-254">Add a Label Web control to the page and set its `ID` property to `CurrentPageNumber`.</span></span> <span data-ttu-id="1986f-255">Установите свойство `Text` в обработчике событий ObjectDataSource, чтобы он включал текущую просматриваемую страницу (`PageIndex + 1`) и общее число страниц (`PageCount`).</span><span class="sxs-lookup"><span data-stu-id="1986f-255">Set its `Text` property in the ObjectDataSource s Selected event handler such that it includes the current page being viewed (`PageIndex + 1`) and the total number of pages (`PageCount`).</span></span>

[!code-vb[Main](paging-report-data-in-a-datalist-or-repeater-control-vb/samples/sample10.vb)]

<span data-ttu-id="1986f-256">На рис. 10 показан `Paging.aspx` при первом посещении.</span><span class="sxs-lookup"><span data-stu-id="1986f-256">Figure 10 shows `Paging.aspx` when first visited.</span></span> <span data-ttu-id="1986f-257">Так как строка запроса пуста, элемент управления DataList по умолчанию отображает первые четыре продукта; Первая и предыдущая кнопки отключены.</span><span class="sxs-lookup"><span data-stu-id="1986f-257">Since the querystring is empty, the DataList defaults to showing the first four products; the First and Previous buttons are disabled.</span></span> <span data-ttu-id="1986f-258">При нажатии кнопки Далее отображаются четыре следующие записи (см. рис. 11). кнопки Первая и Предыдущая теперь включены.</span><span class="sxs-lookup"><span data-stu-id="1986f-258">Clicking Next displays the next four records (see Figure 11); the First and Previous buttons are now enabled.</span></span>

<span data-ttu-id="1986f-259">[![отображается первая страница данных](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image23.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="1986f-259">[![The First Page of Data is Displayed](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image23.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image22.png)</span></span>

<span data-ttu-id="1986f-260">**Рис. 10**. Отображение первой страницы данных ([щелкните, чтобы просмотреть изображение с полным размером](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="1986f-260">**Figure 10**: The First Page of Data is Displayed ([Click to view full-size image](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image24.png))</span></span>

<span data-ttu-id="1986f-261">[![отображается вторая страница данных](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image26.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="1986f-261">[![The Second Page of Data is Displayed](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image26.png)](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image25.png)</span></span>

<span data-ttu-id="1986f-262">**Рис. 11**. Отображение второй страницы данных ([щелкните, чтобы просмотреть изображение с полным размером](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="1986f-262">**Figure 11**: The Second Page of Data is Displayed ([Click to view full-size image](paging-report-data-in-a-datalist-or-repeater-control-vb/_static/image27.png))</span></span>

> [!NOTE]
> <span data-ttu-id="1986f-263">Интерфейс разбиения по страницам можно дополнительно улучшить, разрешая пользователю указать количество страниц для просмотра на странице.</span><span class="sxs-lookup"><span data-stu-id="1986f-263">The paging interface can be further enhanced by allowing the user to specify how many pages to view per page.</span></span> <span data-ttu-id="1986f-264">Например, DropDownList может быть добавлен список параметров размера страницы, например 5, 10, 25, 50 и все.</span><span class="sxs-lookup"><span data-stu-id="1986f-264">For example, a DropDownList could be added listing page size options like 5, 10, 25, 50, and All.</span></span> <span data-ttu-id="1986f-265">При выборе размера страницы необходимо перенаправить пользователя обратно в `Paging.aspx?pageIndex=0&pageSize=selectedPageSize`.</span><span class="sxs-lookup"><span data-stu-id="1986f-265">Upon selecting a page size, the user would need to be redirected back to `Paging.aspx?pageIndex=0&pageSize=selectedPageSize`.</span></span> <span data-ttu-id="1986f-266">Я оставлю за реализацию этого улучшения в качестве упражнения для читателя.</span><span class="sxs-lookup"><span data-stu-id="1986f-266">I leave implementing this enhancement as an exercise for the reader.</span></span>

## <a name="using-custom-paging"></a><span data-ttu-id="1986f-267">Использование пользовательского разбиения на страницы</span><span class="sxs-lookup"><span data-stu-id="1986f-267">Using Custom Paging</span></span>

<span data-ttu-id="1986f-268">Страницы DataList по данным с использованием неэффективного метода разбиения по страницам по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="1986f-268">The DataList pages through its data using the inefficient default paging technique.</span></span> <span data-ttu-id="1986f-269">При разбиении на страницы достаточно большого объема данных необходимо использовать настраиваемое разбиение по страницам.</span><span class="sxs-lookup"><span data-stu-id="1986f-269">When paging through sufficiently large amounts of data, it is imperative that custom paging be used.</span></span> <span data-ttu-id="1986f-270">Несмотря на то, что сведения о реализации немного отличаются, основные понятия, связанные с реализацией пользовательского разбиения по страницам в DataList, такие же, как и по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="1986f-270">Although the implementation details differ slightly, the concepts behind implementing custom paging in a DataList are the same as with default paging.</span></span> <span data-ttu-id="1986f-271">При использовании пользовательского разбиения на страницы используйте метод `ProductBLL` классов `GetProductsPaged` (вместо `GetProductsAsPagedDataSource`).</span><span class="sxs-lookup"><span data-stu-id="1986f-271">With custom paging, use the `ProductBLL` class s `GetProductsPaged` method (instead of `GetProductsAsPagedDataSource`).</span></span> <span data-ttu-id="1986f-272">Как обсуждалось в [рамках эффективного разбиения по большим объемам данных](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) , `GetProductsPaged` должен быть передан Индекс начальной строки и максимальное число возвращаемых строк.</span><span class="sxs-lookup"><span data-stu-id="1986f-272">As discussed in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) tutorial, `GetProductsPaged` must be passed the start row index and maximum number of rows to return.</span></span> <span data-ttu-id="1986f-273">Эти параметры можно поддерживать через строку запроса, как и параметры `pageIndex` и `pageSize`, используемые при разбиении по страницам по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="1986f-273">These parameters can be maintained through the querystring just like the `pageIndex` and `pageSize` parameters used in default paging.</span></span>

<span data-ttu-id="1986f-274">Поскольку нет `PagedDataSource` с пользовательским разбиением на страницы, необходимо использовать альтернативные методы для определения общего количества записей, продаваемых по страницам, и сведения о том, следует ли повторно отобразить первую или последнюю страницу данных.</span><span class="sxs-lookup"><span data-stu-id="1986f-274">Since there s no `PagedDataSource` with custom paging, alternative techniques must be used to determine the total number of records being paged through and whether we re displaying the first or last page of data.</span></span> <span data-ttu-id="1986f-275">Метод `TotalNumberOfProducts()` в классе `ProductsBLL` возвращает общее количество продуктов, на которых размещается страница.</span><span class="sxs-lookup"><span data-stu-id="1986f-275">The `TotalNumberOfProducts()` method in the `ProductsBLL` class returns the total number of products being paged through.</span></span> <span data-ttu-id="1986f-276">Чтобы определить, просматривается ли первая страница данных, проверьте Индекс начальной строки, если он равен нулю, а затем просматривается первая страница.</span><span class="sxs-lookup"><span data-stu-id="1986f-276">To determine if the first page of data is being viewed, examine the start row index if it is zero, then the first page is being viewed.</span></span> <span data-ttu-id="1986f-277">Последняя страница просматривается, если индекс начальной строки плюс максимальное число возвращаемых строк больше или равно общему количеству записей, на которые размещается страница.</span><span class="sxs-lookup"><span data-stu-id="1986f-277">The last page is being viewed if the start row index plus the maximum rows to return is greater than or equal to the total number of records being paged through.</span></span>

<span data-ttu-id="1986f-278">В следующем руководстве мы подробно рассмотрим реализацию пользовательского разбиения по страницам.</span><span class="sxs-lookup"><span data-stu-id="1986f-278">We'll explore implementing custom paging in greater detail in the next tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="1986f-279">Сводка</span><span class="sxs-lookup"><span data-stu-id="1986f-279">Summary</span></span>

<span data-ttu-id="1986f-280">Хотя ни DataList, ни Repeater не предлагают встроенную поддержку разбиения по страницам в элементах управления GridView, DetailsView и FormView, такие функции можно добавлять с минимальными усилиями.</span><span class="sxs-lookup"><span data-stu-id="1986f-280">While neither the DataList nor Repeater offers the out of the box paging support found in the GridView, DetailsView, and FormView controls, such functionality can be added with minimal effort.</span></span> <span data-ttu-id="1986f-281">Самым простым способом реализации разбиения по страницам по умолчанию является заключение всего набора продуктов в `PagedDataSource`, а затем привязка `PagedDataSource` к элементу управления DataList или Repeater.</span><span class="sxs-lookup"><span data-stu-id="1986f-281">The easiest way to implement default paging is to wrap the entire set of products within a `PagedDataSource` and then bind the `PagedDataSource` to the DataList or Repeater.</span></span> <span data-ttu-id="1986f-282">В этом руководстве мы добавили метод `GetProductsAsPagedDataSource` в класс `ProductsBLL` для возврата `PagedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="1986f-282">In this tutorial we added the `GetProductsAsPagedDataSource` method to the `ProductsBLL` class to return the `PagedDataSource`.</span></span> <span data-ttu-id="1986f-283">Класс `ProductsBLL` уже содержит методы, необходимые для пользовательского разбиения на страницы `GetProductsPaged` и `TotalNumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="1986f-283">The `ProductsBLL` class already contains the methods needed for custom paging `GetProductsPaged` and `TotalNumberOfProducts`.</span></span>

<span data-ttu-id="1986f-284">Вместе с извлечением точного набора записей, отображаемых для пользовательского разбиения на страницы, или всех записей в `PagedDataSource` для разбиения по страницам по умолчанию также необходимо добавить интерфейс разбиения по страницам вручную.</span><span class="sxs-lookup"><span data-stu-id="1986f-284">Along with retrieving either the precise set of records to display for custom paging or all records in a `PagedDataSource` for default paging, we also need to manually add the paging interface.</span></span> <span data-ttu-id="1986f-285">В этом учебнике мы создали новый, предыдущий, последний интерфейс с четырьмя веб-элементами управления "Кнопка".</span><span class="sxs-lookup"><span data-stu-id="1986f-285">For this tutorial we created a Next, Previous, First, Last interface with four Button Web controls.</span></span> <span data-ttu-id="1986f-286">Кроме того, элемент управления Label, отображающий текущий номер страницы и общее число страниц, был добавлен.</span><span class="sxs-lookup"><span data-stu-id="1986f-286">Also, a Label control displaying the current page number and total number of pages was added.</span></span>

<span data-ttu-id="1986f-287">В следующем учебном курсе будет показано, как добавить поддержку сортировки в DataList и Repeater.</span><span class="sxs-lookup"><span data-stu-id="1986f-287">In the next tutorial we'll see how to add sorting support to the DataList and Repeater.</span></span> <span data-ttu-id="1986f-288">Также будет показано, как создать элемент управления DataList, который может быть одновременно выведен на страницы и отсортирован (с примерами по умолчанию и пользовательским разбиением по страницам).</span><span class="sxs-lookup"><span data-stu-id="1986f-288">We'll also see how to create a DataList that can be both paged and sorted (with examples using default and custom paging).</span></span>

<span data-ttu-id="1986f-289">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="1986f-289">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="1986f-290">Об авторе</span><span class="sxs-lookup"><span data-stu-id="1986f-290">About the Author</span></span>

<span data-ttu-id="1986f-291">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="1986f-291">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="1986f-292">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="1986f-292">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="1986f-293">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="1986f-293">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="1986f-294">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1986f-294">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="1986f-295">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="1986f-295">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="1986f-296">Специальная благодарность</span><span class="sxs-lookup"><span data-stu-id="1986f-296">Special Thanks To</span></span>

<span data-ttu-id="1986f-297">Эта серия руководств была рассмотрена многими полезными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="1986f-297">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="1986f-298">Потенциальные рецензенты для этого руководства были основными рецензентами, Кен Песписа и Бернадетте Леигх.</span><span class="sxs-lookup"><span data-stu-id="1986f-298">Lead reviewers for this tutorial were Liz Shulok, Ken Pespisa, and Bernadette Leigh.</span></span> <span data-ttu-id="1986f-299">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="1986f-299">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="1986f-300">Если это так, расположите строку в [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1986f-300">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="1986f-301">[Назад](sorting-data-in-a-datalist-or-repeater-control-cs.md)
> [Вперед](sorting-data-in-a-datalist-or-repeater-control-vb.md)</span><span class="sxs-lookup"><span data-stu-id="1986f-301">[Previous](sorting-data-in-a-datalist-or-repeater-control-cs.md)
[Next](sorting-data-in-a-datalist-or-repeater-control-vb.md)</span></span>
