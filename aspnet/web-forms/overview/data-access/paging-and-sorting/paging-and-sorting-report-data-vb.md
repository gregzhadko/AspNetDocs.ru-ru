---
uid: web-forms/overview/data-access/paging-and-sorting/paging-and-sorting-report-data-vb
title: Разбиение на страницы и сортировка данных отчета (VB) | Документация Майкрософт
author: rick-anderson
description: Разбиение на страницы и сортировка — две очень распространенные функции при отображении данных в интерактивном приложении. В этом учебнике мы рассмотрим добавление сортировки и...
ms.author: riande
ms.date: 08/15/2006
ms.assetid: b895e37e-0e69-45cc-a7e4-17ddd2e1b38d
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/paging-and-sorting-report-data-vb
msc.type: authoredcontent
ms.openlocfilehash: 6785b5cd2d4d3a2c2e7f2c2fea93f5cd5e2fdf24
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74619107"
---
# <a name="paging-and-sorting-report-data-vb"></a><span data-ttu-id="4e26a-104">Разбиение по страницам и упорядочение данных отчета (VB)</span><span class="sxs-lookup"><span data-stu-id="4e26a-104">Paging and Sorting Report Data (VB)</span></span>

<span data-ttu-id="4e26a-105">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="4e26a-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="4e26a-106">[Скачивание примера приложения](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_24_VB.exe) или [Загрузка PDF-файла](paging-and-sorting-report-data-vb/_static/datatutorial24vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="4e26a-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_24_VB.exe) or [Download PDF](paging-and-sorting-report-data-vb/_static/datatutorial24vb1.pdf)</span></span>

> <span data-ttu-id="4e26a-107">Разбиение на страницы и сортировка — две очень распространенные функции при отображении данных в интерактивном приложении.</span><span class="sxs-lookup"><span data-stu-id="4e26a-107">Paging and sorting are two very common features when displaying data in an online application.</span></span> <span data-ttu-id="4e26a-108">В этом учебнике мы рассмотрим добавление сортировки и разбиения по страницам к нашим отчетам, которые затем будут создаваться на следующих учебных курсах.</span><span class="sxs-lookup"><span data-stu-id="4e26a-108">In this tutorial we'll take a first look at adding sorting and paging to our reports, which we will then build upon in future tutorials.</span></span>

## <a name="introduction"></a><span data-ttu-id="4e26a-109">Введение</span><span class="sxs-lookup"><span data-stu-id="4e26a-109">Introduction</span></span>

<span data-ttu-id="4e26a-110">Разбиение на страницы и сортировка — две очень распространенные функции при отображении данных в интерактивном приложении.</span><span class="sxs-lookup"><span data-stu-id="4e26a-110">Paging and sorting are two very common features when displaying data in an online application.</span></span> <span data-ttu-id="4e26a-111">Например, при поиске книг ASP.NET в книжном магазине могут содержаться сотни таких книг, но в отчете, в котором отображаются результаты поиска, отображается только десять соответствий на страницу.</span><span class="sxs-lookup"><span data-stu-id="4e26a-111">For example, when searching for ASP.NET books at an online bookstore, there may be hundreds of such books, but the report listing the search results lists only ten matches per page.</span></span> <span data-ttu-id="4e26a-112">Кроме того, результаты можно отсортировать по заголовку, цене, количеству страниц, имени автора и т. д.</span><span class="sxs-lookup"><span data-stu-id="4e26a-112">Moreover, the results can be sorted by title, price, page count, author name, and so on.</span></span> <span data-ttu-id="4e26a-113">Хотя последние 23 учебников проверили, как создавать разнообразные отчеты, включая интерфейсы, позволяющие добавлять, изменять и удалять данные, мы не рассматривали, как сортировать данные, и только те примеры разбиения на страницы были просмотрены с помощью DetailsView и FormView элементы управления.</span><span class="sxs-lookup"><span data-stu-id="4e26a-113">While the past 23 tutorials have examined how to build a variety of reports, including interfaces that permit adding, editing, and deleting data, we ve not looked at how to sort data and the only paging examples we ve seen have been with the DetailsView and FormView controls.</span></span>

<span data-ttu-id="4e26a-114">В этом учебнике мы посмотрим, как добавить в наши отчеты сортировку и разбиение по страницам, что можно сделать, просто установив несколько флажков.</span><span class="sxs-lookup"><span data-stu-id="4e26a-114">In this tutorial we'll see how to add sorting and paging to our reports, which can be accomplished by simply checking a few checkboxes.</span></span> <span data-ttu-id="4e26a-115">К сожалению, Эта упрощенная реализация имеет свои недостатки, поэтому интерфейс сортировки остается нежелательным, а подпрограммы разбиения по страницам не предназначены для эффективного разбиения по большим результирующим наборам.</span><span class="sxs-lookup"><span data-stu-id="4e26a-115">Unfortunately, this simplistic implementation has its drawbacks the sorting interface leaves a bit to be desired and the paging routines are not designed for efficiently paging through large result sets.</span></span> <span data-ttu-id="4e26a-116">В следующих учебных курсах будет рассказано, как преодолеть ограничения готовых решений по разбиению на страницы и упорядочения.</span><span class="sxs-lookup"><span data-stu-id="4e26a-116">Future tutorials will explore how to overcome the limitations of the out-of-the-box paging and sorting solutions.</span></span>

## <a name="step-1-adding-the-paging-and-sorting-tutorial-web-pages"></a><span data-ttu-id="4e26a-117">Шаг 1. Добавление веб-страниц учебника по разбиению по страницам и сортировке</span><span class="sxs-lookup"><span data-stu-id="4e26a-117">Step 1: Adding the Paging and Sorting Tutorial Web Pages</span></span>

<span data-ttu-id="4e26a-118">Прежде чем приступить к работе с этим руководством, давайте сначала добавим страницы ASP.NET, которые понадобятся для работы с этим руководством и следующих трех.</span><span class="sxs-lookup"><span data-stu-id="4e26a-118">Before we start this tutorial, let s first take a moment to add the ASP.NET pages we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="4e26a-119">Начните с создания новой папки в проекте с именем `PagingAndSorting`.</span><span class="sxs-lookup"><span data-stu-id="4e26a-119">Start by creating a new folder in the project named `PagingAndSorting`.</span></span> <span data-ttu-id="4e26a-120">Затем добавьте в эту папку следующие пять страниц ASP.NET, чтобы все они были настроены для использования главной страницы `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="4e26a-120">Next, add the following five ASP.NET pages to this folder, having all of them configured to use the master page `Site.master`:</span></span>

- `Default.aspx`
- `SimplePagingSorting.aspx`
- `EfficientPaging.aspx`
- `SortParameter.aspx`
- `CustomSortingUI.aspx`

![Создание папки PagingAndSorting и добавление страниц Tutorial ASP.NET](paging-and-sorting-report-data-vb/_static/image1.png)

<span data-ttu-id="4e26a-122">**Рис. 1**. Создание папки PagingAndSorting и добавление страниц Tutorial ASP.NET</span><span class="sxs-lookup"><span data-stu-id="4e26a-122">**Figure 1**: Create a PagingAndSorting Folder and Add the Tutorial ASP.NET Pages</span></span>

<span data-ttu-id="4e26a-123">Затем откройте страницу `Default.aspx` и перетащите `SectionLevelTutorialListing.ascx` пользовательский элемент управления из папки `UserControls` в область конструктора.</span><span class="sxs-lookup"><span data-stu-id="4e26a-123">Next, open the `Default.aspx` page and drag the `SectionLevelTutorialListing.ascx` User Control from the `UserControls` folder onto the Design surface.</span></span> <span data-ttu-id="4e26a-124">Этот пользовательский элемент управления, созданный при работе с [главными страницами и](../introduction/master-pages-and-site-navigation-vb.md) руководством по навигации по сайту, перечисляет карту узла и отображает эти руководства в текущем разделе в маркированном списке.</span><span class="sxs-lookup"><span data-stu-id="4e26a-124">This User Control, which we created in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-vb.md) tutorial, enumerates the site map and displays those tutorials in the current section in a bulleted list.</span></span>

![Добавление пользовательского элемента управления SectionLevelTutorialListing. ascx в Default. aspx](paging-and-sorting-report-data-vb/_static/image2.png)

<span data-ttu-id="4e26a-126">**Рис. 2**. Добавление пользовательского элемента управления SectionLevelTutorialListing. ascx в Default. aspx</span><span class="sxs-lookup"><span data-stu-id="4e26a-126">**Figure 2**: Add the SectionLevelTutorialListing.ascx User Control to Default.aspx</span></span>

<span data-ttu-id="4e26a-127">Чтобы в маркированном списке отображались учебники по разбиению на страницы и сортировка, которые будут созданы, необходимо добавить их на карту узла.</span><span class="sxs-lookup"><span data-stu-id="4e26a-127">In order to have the bulleted list display the paging and sorting tutorials we'll be creating, we need to add them to the site map.</span></span> <span data-ttu-id="4e26a-128">Откройте файл `Web.sitemap` и добавьте следующую разметку после разметки узла "изменение", "Вставка" и "удаление".</span><span class="sxs-lookup"><span data-stu-id="4e26a-128">Open the `Web.sitemap` file and add the following markup after the Editing, Inserting, and Deleting site map node markup:</span></span>

[!code-xml[Main](paging-and-sorting-report-data-vb/samples/sample1.xml)]

![Обновление схемы узла для включения новых страниц ASP.NET](paging-and-sorting-report-data-vb/_static/image3.png)

<span data-ttu-id="4e26a-130">**Рис. 3**. обновление схемы узла для включения новых страниц ASP.NET</span><span class="sxs-lookup"><span data-stu-id="4e26a-130">**Figure 3**: Update the Site Map to Include the New ASP.NET Pages</span></span>

## <a name="step-2-displaying-product-information-in-a-gridview"></a><span data-ttu-id="4e26a-131">Шаг 2. Отображение сведений о продукте в элементе управления GridView</span><span class="sxs-lookup"><span data-stu-id="4e26a-131">Step 2: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="4e26a-132">Прежде чем реализовать возможности разбиения по страницам и сортировки, давайте сначала создадим Стандартный несортируемый, нестраничный элемент управления GridView, содержащий сведения о продукте.</span><span class="sxs-lookup"><span data-stu-id="4e26a-132">Before we actually implement paging and sorting capabilities, let s first create a standard non-sortable, non-pageable GridView that lists the product information.</span></span> <span data-ttu-id="4e26a-133">Это задача, которую мы много раз сделали в рамках этой серии руководств, поэтому эти действия должны быть знакомы.</span><span class="sxs-lookup"><span data-stu-id="4e26a-133">This is a task we ve done many times before throughout this tutorial series so these steps should be familiar.</span></span> <span data-ttu-id="4e26a-134">Для начала откройте страницу `SimplePagingSorting.aspx` и перетащите элемент управления GridView с панели инструментов в конструктор, установив для свойства `ID` значение `Products`.</span><span class="sxs-lookup"><span data-stu-id="4e26a-134">Start by opening the `SimplePagingSorting.aspx` page and drag a GridView control from the Toolbox onto the Designer, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="4e26a-135">Затем создайте новый элемент ObjectDataSource, использующий метод `GetProducts()` класса ProductsBLL для возврата всей информации о продукте.</span><span class="sxs-lookup"><span data-stu-id="4e26a-135">Next, create a new ObjectDataSource that uses the ProductsBLL class s `GetProducts()` method to return all of the product information.</span></span>

![Получение сведений обо всех продуктах с помощью метода Products ()](paging-and-sorting-report-data-vb/_static/image4.png)

<span data-ttu-id="4e26a-137">**Рис. 4**. Получение сведений обо всех продуктах с помощью метода Products ()</span><span class="sxs-lookup"><span data-stu-id="4e26a-137">**Figure 4**: Retrieve Information About All of the Products Using the GetProducts() Method</span></span>

<span data-ttu-id="4e26a-138">Так как отчет является отчетом только для чтения, нет необходимости сопоставлять методы `Insert()`, `Update()`или `Delete()` с соответствующими методами `ProductsBLL`. Поэтому выберите (нет) в раскрывающемся списке для вкладок обновления, вставки и удаления.</span><span class="sxs-lookup"><span data-stu-id="4e26a-138">Since this report is a read-only report, there s no need to map the ObjectDataSource s `Insert()`, `Update()`, or `Delete()` methods to corresponding `ProductsBLL` methods; therefore, choose (None) from the drop-down list for the UPDATE, INSERT, and DELETE tabs.</span></span>

![Выберите параметр (нет) в раскрывающемся списке на вкладках обновить, вставить и удалить.](paging-and-sorting-report-data-vb/_static/image5.png)

<span data-ttu-id="4e26a-140">**Рис. 5**. Выбор параметра (нет) в раскрывающемся списке на вкладках «обновить», «вставить» и «удалить»</span><span class="sxs-lookup"><span data-stu-id="4e26a-140">**Figure 5**: Choose the (None) Option in the Drop-Down List in the UPDATE, INSERT, and DELETE Tabs</span></span>

<span data-ttu-id="4e26a-141">Теперь давайте настроим поля GridView s таким образом, чтобы отображались только названия продуктов, поставщики, категории, цены и неподдерживаемые состояния.</span><span class="sxs-lookup"><span data-stu-id="4e26a-141">Next, let s customize the GridView s fields so that only the products names, suppliers, categories, prices, and discontinued statuses are displayed.</span></span> <span data-ttu-id="4e26a-142">Более того, вы можете изменять форматирование на уровне полей, например настраивать свойства `HeaderText` или форматировать цену как валюту.</span><span class="sxs-lookup"><span data-stu-id="4e26a-142">Furthermore, feel free to make any field-level formatting changes, such as adjusting the `HeaderText` properties or formatting the price as a currency.</span></span> <span data-ttu-id="4e26a-143">После этих изменений декларативная разметка GridView s должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="4e26a-143">After these changes, your GridView s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](paging-and-sorting-report-data-vb/samples/sample2.aspx)]

<span data-ttu-id="4e26a-144">На рис. 6 показан ход работы в браузере.</span><span class="sxs-lookup"><span data-stu-id="4e26a-144">Figure 6 shows our progress thus far when viewed through a browser.</span></span> <span data-ttu-id="4e26a-145">Обратите внимание, что на странице перечислены все продукты на одном экране, в которых отображаются названия, категории, поставщики, цены и состояние "снято с производства".</span><span class="sxs-lookup"><span data-stu-id="4e26a-145">Note that the page lists all of the products in one screen, showing each product s name, category, supplier, price, and discontinued status.</span></span>

<span data-ttu-id="4e26a-146">[![все продукты перечислены](paging-and-sorting-report-data-vb/_static/image7.png)](paging-and-sorting-report-data-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="4e26a-146">[![Each of the Products are Listed](paging-and-sorting-report-data-vb/_static/image7.png)](paging-and-sorting-report-data-vb/_static/image6.png)</span></span>

<span data-ttu-id="4e26a-147">**Рис. 6**. список всех продуктов ([щелкните, чтобы просмотреть изображение с полным размером](paging-and-sorting-report-data-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="4e26a-147">**Figure 6**: Each of the Products are Listed ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image8.png))</span></span>

## <a name="step-3-adding-paging-support"></a><span data-ttu-id="4e26a-148">Шаг 3. Добавление поддержки разбиения по страницам</span><span class="sxs-lookup"><span data-stu-id="4e26a-148">Step 3: Adding Paging Support</span></span>

<span data-ttu-id="4e26a-149">Список *всех* продуктов на одном экране может привести к перегрузке информации для пользователя, который извлечет данные.</span><span class="sxs-lookup"><span data-stu-id="4e26a-149">Listing *all* of the products on one screen can lead to information overload for the user perusing the data.</span></span> <span data-ttu-id="4e26a-150">Чтобы сделать результаты более управляемыми, можно разбить данные на меньшие страницы данных и позволить пользователю пошаговое выполнение данных по одной странице за раз.</span><span class="sxs-lookup"><span data-stu-id="4e26a-150">To help make the results more manageable, we can break up the data into smaller pages of data and allow the user to step through the data one page at a time.</span></span> <span data-ttu-id="4e26a-151">Для этого просто установите флажок Включить разбиение по страницам из смарт-тега GridView s (при этом [свойству`AllowPaging`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.allowpaging.aspx) GridView s задается значение `true`).</span><span class="sxs-lookup"><span data-stu-id="4e26a-151">To accomplish this simply check the Enable Paging checkbox from the GridView s smart tag (this sets the GridView s [`AllowPaging` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.allowpaging.aspx) to `true`).</span></span>

<span data-ttu-id="4e26a-152">[![установите флажок Включить разбиение по страницам, чтобы добавить поддержку разбиения по страницам](paging-and-sorting-report-data-vb/_static/image10.png)](paging-and-sorting-report-data-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="4e26a-152">[![Check the Enable Paging Checkbox to Add Paging Support](paging-and-sorting-report-data-vb/_static/image10.png)](paging-and-sorting-report-data-vb/_static/image9.png)</span></span>

<span data-ttu-id="4e26a-153">**Рис. 7**. Установка флажка "включить разбиение на страницы" для добавления поддержки разбиения по страницам ([щелкните, чтобы просмотреть изображение с полным размером](paging-and-sorting-report-data-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="4e26a-153">**Figure 7**: Check the Enable Paging Checkbox to Add Paging Support ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image11.png))</span></span>

<span data-ttu-id="4e26a-154">Включение разбиения на страницы ограничивает количество записей, отображаемых на странице, и добавляет *интерфейс разбиения по страницам* в GridView.</span><span class="sxs-lookup"><span data-stu-id="4e26a-154">Enabling paging limits the number of records shown per page and adds a *paging interface* to the GridView.</span></span> <span data-ttu-id="4e26a-155">Интерфейс разбиения по страницам по умолчанию, показанный на рис. 7, — это серия номеров страниц, позволяющая пользователю быстро переходить с одной страницы данных на другую.</span><span class="sxs-lookup"><span data-stu-id="4e26a-155">The default paging interface, shown in Figure 7, is a series of page numbers, allowing the user to quickly navigate from one page of data to another.</span></span> <span data-ttu-id="4e26a-156">Этот интерфейс разбиения по страницам должен быть знакомым, так как мы видели его при добавлении поддержки разбиения по страницам к элементам управления DetailsView и FormView в прошлых учебных курсах.</span><span class="sxs-lookup"><span data-stu-id="4e26a-156">This paging interface should look familiar, as we ve seen it when adding paging support to the DetailsView and FormView controls in past tutorials.</span></span>

<span data-ttu-id="4e26a-157">Элементы управления DetailsView и FormView отображают только одну запись на страницу.</span><span class="sxs-lookup"><span data-stu-id="4e26a-157">Both the DetailsView and FormView controls only show a single record per page.</span></span> <span data-ttu-id="4e26a-158">Однако GridView обращается к своему [свойству`PageSize`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.pagesize.aspx) , чтобы определить количество записей, отображаемых на странице (по умолчанию это свойство имеет значение 10).</span><span class="sxs-lookup"><span data-stu-id="4e26a-158">The GridView, however, consults its [`PageSize` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.pagesize.aspx) to determine how many records to show per page (this property defaults to a value of 10).</span></span>

<span data-ttu-id="4e26a-159">Этот интерфейс разбиения по страницам GridView, DetailsView и FormView можно настроить с помощью следующих свойств:</span><span class="sxs-lookup"><span data-stu-id="4e26a-159">This GridView, DetailsView, and FormView s paging interface can be customized using the following properties:</span></span>

- <span data-ttu-id="4e26a-160">`PagerStyle` указывает сведения о стиле для интерфейса разбиения на страницы; можно указать такие параметры, как `BackColor`, `ForeColor`, `CssClass`, `HorizontalAlign`и т. д.</span><span class="sxs-lookup"><span data-stu-id="4e26a-160">`PagerStyle` indicates the style information for the paging interface; can specify settings like `BackColor`, `ForeColor`, `CssClass`, `HorizontalAlign`, and so on.</span></span>
- <span data-ttu-id="4e26a-161">`PagerSettings` содержит множество свойств, которые могут настраивать функциональность интерфейса разбиения по страницам. `PageButtonCount` указывает максимальное число номеров страниц, отображаемых в интерфейсе разбиения на страницы (по умолчанию — 10); [свойство`Mode`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pagersettings.mode.aspx) указывает, как работает интерфейс разбиения по страницам и может принимать следующие значения:</span><span class="sxs-lookup"><span data-stu-id="4e26a-161">`PagerSettings` contains a bevy of properties that can customize the functionality of the paging interface; `PageButtonCount` indicates the maximum number of numeric page numbers displayed in the paging interface (the default is 10); the [`Mode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.pagersettings.mode.aspx) indicates how the paging interface operates and can be set to:</span></span> 

    - <span data-ttu-id="4e26a-162">`NextPrevious` показаны кнопки «Далее» и «назад», позволяющие пользователю переходить вперед или назад на одну страницу за раз.</span><span class="sxs-lookup"><span data-stu-id="4e26a-162">`NextPrevious` shows a Next and Previous buttons, allowing the user to step forwards or backwards one page at a time</span></span>
    - <span data-ttu-id="4e26a-163">`NextPreviousFirstLast` в дополнение к кнопкам "Далее" и "назад", также включены первая и Последняя кнопки, что позволяет пользователю быстро перейти на первую или последнюю страницу данных.</span><span class="sxs-lookup"><span data-stu-id="4e26a-163">`NextPreviousFirstLast` in addition to Next and Previous buttons, First and Last buttons are also included, allowing the user to quickly move to the first or last page of data</span></span>
    - <span data-ttu-id="4e26a-164">`Numeric` показывает ряд номеров страниц, позволяя пользователю сразу перейти к любой странице.</span><span class="sxs-lookup"><span data-stu-id="4e26a-164">`Numeric` shows a series of page numbers, allowing the user to immediately jump to any page</span></span>
    - <span data-ttu-id="4e26a-165">`NumericFirstLast` в дополнение к номерам страниц, включает в себя первую и последнюю кнопки, позволяя пользователю быстро перейти на первую или последнюю страницу данных; кнопки Первая и последняя отображаются только в том случае, если не удается уместить все числовые номера страниц</span><span class="sxs-lookup"><span data-stu-id="4e26a-165">`NumericFirstLast` in addition to the page numbers, includes First and Last buttons, allowing the user to quickly move to the first or last page of data; the First/Last buttons are only shown if all of the numeric page numbers cannot fit</span></span>

<span data-ttu-id="4e26a-166">Более того, GridView, DetailsView и FormView предлагают свойства `PageIndex` и `PageCount`, которые указывают текущую просматриваемую страницу и общее количество страниц данных соответственно.</span><span class="sxs-lookup"><span data-stu-id="4e26a-166">Moreover, the GridView, DetailsView, and FormView all offer the `PageIndex` and `PageCount` properties, which indicate the current page being viewed and the total number of pages of data, respectively.</span></span> <span data-ttu-id="4e26a-167">Свойство `PageIndex` индексируется начиная с 0, что означает, что при просмотре первой страницы данных `PageIndex` будет равно 0.</span><span class="sxs-lookup"><span data-stu-id="4e26a-167">The `PageIndex` property is indexed starting at 0, meaning that when viewing the first page of data `PageIndex` will equal 0.</span></span> <span data-ttu-id="4e26a-168">`PageCount`, с другой стороны, начинает подсчитать 1, что означает, что `PageIndex` ограничены значениями от 0 до `PageCount - 1`.</span><span class="sxs-lookup"><span data-stu-id="4e26a-168">`PageCount`, on the other hand, starts counting at 1, meaning that `PageIndex` is limited to the values between 0 and `PageCount - 1`.</span></span>

<span data-ttu-id="4e26a-169">Подождите немного, чтобы улучшить внешний вид интерфейса разбиения по страницам GridView s.</span><span class="sxs-lookup"><span data-stu-id="4e26a-169">Let s take a moment to improve the default appearance of our GridView s paging interface.</span></span> <span data-ttu-id="4e26a-170">В частности, добавим интерфейс разбиения по страницам вправо с помощью светло-серого фона.</span><span class="sxs-lookup"><span data-stu-id="4e26a-170">Specifically, let s have the paging interface right-aligned with a light gray background.</span></span> <span data-ttu-id="4e26a-171">Вместо того, чтобы задавать эти свойства напрямую через свойство `PagerStyle` GridView s, давайте создадим класс CSS в `Styles.css` с именем `PagerRowStyle`, а затем присвоить свойство `CssClass` `PagerStyle` с помощью нашей темы.</span><span class="sxs-lookup"><span data-stu-id="4e26a-171">Rather than setting these properties directly through the GridView s `PagerStyle` property, let s create a CSS class in `Styles.css` named `PagerRowStyle` and then assign the `PagerStyle` s `CssClass` property through our Theme.</span></span> <span data-ttu-id="4e26a-172">Сначала откройте `Styles.css` и добавьте следующее определение класса CSS:</span><span class="sxs-lookup"><span data-stu-id="4e26a-172">Start by opening `Styles.css` and adding the following CSS class definition:</span></span>

[!code-css[Main](paging-and-sorting-report-data-vb/samples/sample3.css)]

<span data-ttu-id="4e26a-173">Затем откройте файл `GridView.skin` в папке `DataWebControls` в папке `App_Themes`.</span><span class="sxs-lookup"><span data-stu-id="4e26a-173">Next, open the `GridView.skin` file in the `DataWebControls` folder within the `App_Themes` folder.</span></span> <span data-ttu-id="4e26a-174">Как мы обсуждали в учебнике « *главные страницы и Навигация по узлу* », файлы обложки можно использовать для указания значений свойств по умолчанию для веб-элемента управления.</span><span class="sxs-lookup"><span data-stu-id="4e26a-174">As we discussed in the *Master Pages and Site Navigation* tutorial, Skin files can be used to specify the default property values for a Web control.</span></span> <span data-ttu-id="4e26a-175">Таким образом, дополните существующие параметры, дополняя установку свойства `PagerStyle` s `CssClass` в значение `PagerRowStyle`.</span><span class="sxs-lookup"><span data-stu-id="4e26a-175">Therefore, augment the existing settings to include setting the `PagerStyle` s `CssClass` property to `PagerRowStyle`.</span></span> <span data-ttu-id="4e26a-176">Кроме того, давайте настроим интерфейс разбиения на страницы, чтобы отображать не более пяти кнопок с числовыми страницами, используя интерфейс разбиения по страницам `NumericFirstLast`.</span><span class="sxs-lookup"><span data-stu-id="4e26a-176">Also, let s configure the paging interface to show at most five numeric page buttons using the `NumericFirstLast` paging interface.</span></span>

[!code-aspx[Main](paging-and-sorting-report-data-vb/samples/sample4.aspx)]

## <a name="the-paging-user-experience"></a><span data-ttu-id="4e26a-177">Пользовательский интерфейс разбиения по страницам</span><span class="sxs-lookup"><span data-stu-id="4e26a-177">The Paging User Experience</span></span>

<span data-ttu-id="4e26a-178">На рис. 8 показана веб-страница при посещении через браузер после установки флажка "включить разбиение по страницам в GridView s" и настройки `PagerStyle` и `PagerSettings` в `GridView.skin`ном файле.</span><span class="sxs-lookup"><span data-stu-id="4e26a-178">Figure 8 shows the web page when visited through a browser after the GridView s Enable Paging checkbox has been checked and the `PagerStyle` and `PagerSettings` configurations have been made through the `GridView.skin` file.</span></span> <span data-ttu-id="4e26a-179">Обратите внимание, что отображается только десять записей, а интерфейс разбиения по страницам указывает, что мы просматриваем первую страницу данных.</span><span class="sxs-lookup"><span data-stu-id="4e26a-179">Note how only ten records are shown, and the paging interface indicates that we are viewing the first page of data.</span></span>

<span data-ttu-id="4e26a-180">[![с включенным разбиением на страницы в каждый момент времени отображается только подмножество записей.](paging-and-sorting-report-data-vb/_static/image13.png)](paging-and-sorting-report-data-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="4e26a-180">[![With Paging Enabled, Only a Subset of the Records are Displayed at a Time](paging-and-sorting-report-data-vb/_static/image13.png)](paging-and-sorting-report-data-vb/_static/image12.png)</span></span>

<span data-ttu-id="4e26a-181">**Рис. 8**. при включенном разбиении по страницам в каждый момент времени отображается только подмножество записей ([щелкните, чтобы просмотреть изображение с полным размером](paging-and-sorting-report-data-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="4e26a-181">**Figure 8**: With Paging Enabled, Only a Subset of the Records are Displayed at a Time ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image14.png))</span></span>

<span data-ttu-id="4e26a-182">Когда пользователь щелкает один из номеров страниц в интерфейсе разбиения по страницам, выполняется обратная передача, и страница перегружается, отображая запрошенные записи.</span><span class="sxs-lookup"><span data-stu-id="4e26a-182">When the user clicks on one of the page numbers in the paging interface, a postback ensues and the page reloads showing that requested page s records.</span></span> <span data-ttu-id="4e26a-183">На рис. 9 показаны результаты после продолжений для просмотра последней страницы данных.</span><span class="sxs-lookup"><span data-stu-id="4e26a-183">Figure 9 shows the results after opting to view the final page of data.</span></span> <span data-ttu-id="4e26a-184">Обратите внимание, что последняя страница содержит только одну запись; Это связано с тем, что в итоге имеется 81 записей, что приводит к восьми страницам из 10 записей на страницу и одной странице с отдельной записью.</span><span class="sxs-lookup"><span data-stu-id="4e26a-184">Notice that the final page only has one record; this is because there are 81 records in total, resulting in eight pages of 10 records per page plus one page with a lone record.</span></span>

<span data-ttu-id="4e26a-185">[![щелчком номера страницы вызывается обратная передача и отображается соответствующее подмножество записей.](paging-and-sorting-report-data-vb/_static/image16.png)](paging-and-sorting-report-data-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="4e26a-185">[![Clicking On a Page Number Causes a Postback and Shows the Appropriate Subset of Records](paging-and-sorting-report-data-vb/_static/image16.png)](paging-and-sorting-report-data-vb/_static/image15.png)</span></span>

<span data-ttu-id="4e26a-186">**Рис. 9**. щелчок номера страницы вызывает обратную передачу и отображает соответствующее подмножество записей ([щелкните, чтобы просмотреть изображение с полным размером](paging-and-sorting-report-data-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="4e26a-186">**Figure 9**: Clicking On a Page Number Causes a Postback and Shows the Appropriate Subset of Records ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image17.png))</span></span>

## <a name="paging-s-server-side-workflow"></a><span data-ttu-id="4e26a-187">Рабочий процесс на стороне сервера с разбивкой на страницы</span><span class="sxs-lookup"><span data-stu-id="4e26a-187">Paging s Server-Side Workflow</span></span>

<span data-ttu-id="4e26a-188">Когда пользователь нажимает кнопку в интерфейсе разбиения по страницам, происходит обратная передача, и начинается следующий рабочий процесс на стороне сервера:</span><span class="sxs-lookup"><span data-stu-id="4e26a-188">When the end user clicks on a button in the paging interface, a postback ensues and the following server-side workflow begins:</span></span>

1. <span data-ttu-id="4e26a-189">Вызывается событие `PageIndexChanging` GridView s (или DetailsView или FormView)</span><span class="sxs-lookup"><span data-stu-id="4e26a-189">The GridView s (or DetailsView or FormView) `PageIndexChanging` event fires</span></span>
2. <span data-ttu-id="4e26a-190">ObjectDataSource повторно запрашивает *все* данные из BLL; значения свойств `PageIndex` и `PageSize` GridView используются для определения того, какие записи, возвращаемые BLL, должны отображаться в GridView.</span><span class="sxs-lookup"><span data-stu-id="4e26a-190">The ObjectDataSource re-requests *all* of the data from the BLL; the GridView s `PageIndex` and `PageSize` property values are used to determine what records returned from the BLL need to be displayed in the GridView</span></span>
3. <span data-ttu-id="4e26a-191">Вызывается событие `PageIndexChanged` GridView s</span><span class="sxs-lookup"><span data-stu-id="4e26a-191">The GridView s `PageIndexChanged` event fires</span></span>

<span data-ttu-id="4e26a-192">На шаге 2 элемент управления ObjectDataSource повторно запрашивает все данные из источника данных.</span><span class="sxs-lookup"><span data-stu-id="4e26a-192">In Step 2, the ObjectDataSource re-requests all of the data from its data source.</span></span> <span data-ttu-id="4e26a-193">Этот стиль разбиения на страницы обычно называется *разбиением по страницам по умолчанию*, так как он используется по умолчанию при установке свойства `AllowPaging` в значение `true`.</span><span class="sxs-lookup"><span data-stu-id="4e26a-193">This style of paging is commonly referred to as *default paging*, as it s the paging behavior used by default when setting the `AllowPaging` property to `true`.</span></span> <span data-ttu-id="4e26a-194">При использовании разбиения по страницам по умолчанию веб-элемент управления данными упрощает получение всех записей для каждой страницы данных, несмотря на то, что только подмножество записей фактически подготавливается к просмотру в формате HTML, отправленном в браузер.</span><span class="sxs-lookup"><span data-stu-id="4e26a-194">With default paging the data Web control naively retrieves all records for each page of data, even though only a subset of records are actually rendered into the HTML that s sent to the browser.</span></span> <span data-ttu-id="4e26a-195">Если данные базы данных не кэшируются в BLL или ObjectDataSource, разбиение по страницам по умолчанию неработоспособно для достаточно больших наборов результатов или для веб-приложений с большим числом параллельных пользователей.</span><span class="sxs-lookup"><span data-stu-id="4e26a-195">Unless the database data is cached by the BLL or ObjectDataSource, default paging is unworkable for sufficiently large result sets or for web applications with many concurrent users.</span></span>

<span data-ttu-id="4e26a-196">В следующем учебном курсе мы рассмотрим, как реализовать *пользовательское разбиение по страницам*.</span><span class="sxs-lookup"><span data-stu-id="4e26a-196">In the next tutorial we'll examine how to implement *custom paging*.</span></span> <span data-ttu-id="4e26a-197">С помощью пользовательского разбиения по страницам можно указать, что ObjectDataSource получает только точный набор записей, необходимых для запрошенной страницы данных.</span><span class="sxs-lookup"><span data-stu-id="4e26a-197">With custom paging you can specifically instruct the ObjectDataSource to only retrieve the precise set of records needed for the requested page of data.</span></span> <span data-ttu-id="4e26a-198">Как можно себе представить, пользовательское разбиение по страницам значительно повышает эффективность разбиения на страницы больших результирующих наборов.</span><span class="sxs-lookup"><span data-stu-id="4e26a-198">As you can imagine, custom paging greatly improves the efficiency of paging through large result sets.</span></span>

> [!NOTE]
> <span data-ttu-id="4e26a-199">Хотя разбиение по страницам по умолчанию не подходит при подсчете достаточно большого количества результирующих наборов или для сайтов с множеством одновременных пользователей, следует понимать, что для пользовательского разбиения на страницы требуется больше изменений и усилий для реализации и не так просто установить флажок (как по умолчанию разбиение на страницы).</span><span class="sxs-lookup"><span data-stu-id="4e26a-199">While default paging is not suitable when paging through sufficiently large result sets or for sites with many simultaneous users, realize that custom paging requires more changes and effort to implement and is not as simple as checking a checkbox (as is default paging).</span></span> <span data-ttu-id="4e26a-200">Таким образом, подкачка по умолчанию может быть идеальным выбором для небольших веб-сайтов с низким трафиком или при разбиении по страницам относительно небольших результирующих наборов, так как она намного проще и быстрее реализуется.</span><span class="sxs-lookup"><span data-stu-id="4e26a-200">Therefore, default paging may be the ideal choice for small, low-traffic websites or when paging through relatively small result sets, as it s much easier and quicker to implement.</span></span>

<span data-ttu-id="4e26a-201">Например, если мы уверены, что в нашей базе данных не будет более 100 продуктов, минимальный выигрыш в производительности, получаемый с помощью пользовательского разбиения по страницам, скорее всего, будет смещен на усилия, необходимые для его реализации.</span><span class="sxs-lookup"><span data-stu-id="4e26a-201">For example, if we know that we'll never have more than 100 products in our database, the minimal performance gain enjoyed by custom paging is likely offset by the effort required to implement it.</span></span> <span data-ttu-id="4e26a-202">Но если, однако, у нас может быть тысячи или десятков тысяч продуктов, *не* реализация пользовательского разбиения по страницам будет существенно препятствовать масштабируемости нашего приложения.</span><span class="sxs-lookup"><span data-stu-id="4e26a-202">If, however, we may one day have thousands or tens of thousands of products, *not* implementing custom paging would greatly hamper the scalability of our application.</span></span>

## <a name="step-4-customizing-the-paging-experience"></a><span data-ttu-id="4e26a-203">Шаг 4. Настройка интерфейса разбиения по страницам</span><span class="sxs-lookup"><span data-stu-id="4e26a-203">Step 4: Customizing the Paging Experience</span></span>

<span data-ttu-id="4e26a-204">Веб-элементы управления данными предоставляют ряд свойств, которые можно использовать для повышения удобства работы с разбиением на страницы пользователя.</span><span class="sxs-lookup"><span data-stu-id="4e26a-204">The data Web controls provide a number of properties that can be used to enhance the user s paging experience.</span></span> <span data-ttu-id="4e26a-205">Например, свойство `PageCount` указывает, сколько всего страниц имеется, а свойство `PageIndex` указывает на текущую просматриваемую страницу и может быть настроено для быстрого перемещения пользователя на определенную страницу.</span><span class="sxs-lookup"><span data-stu-id="4e26a-205">The `PageCount` property, for example, indicates how many total pages there are, while the `PageIndex` property indicates the current page being visited and can be set to quickly move a user to a specific page.</span></span> <span data-ttu-id="4e26a-206">Чтобы продемонстрировать, как использовать эти свойства для улучшения процесса разбиения по страницам пользователей, добавим к нашей странице веб-элемент управления Label, который информирует пользователя о том, какую страницу в данный момент посещает, а также элемент управления DropDownList, позволяющий быстро перейти к любой странице. .</span><span class="sxs-lookup"><span data-stu-id="4e26a-206">To illustrate how to use these properties to improve upon the user s paging experience, let s add a Label Web control to our page that informs the user what page they re currently visiting, along with a DropDownList control that allows them to quickly jump to any given page.</span></span>

<span data-ttu-id="4e26a-207">Сначала добавьте на страницу веб-элемент управления Label, задайте для его свойства `ID` значение `PagingInformation`и удалите свойство `Text`.</span><span class="sxs-lookup"><span data-stu-id="4e26a-207">First, add a Label Web control to your page, set its `ID` property to `PagingInformation`, and clear out its `Text` property.</span></span> <span data-ttu-id="4e26a-208">Затем создайте обработчик событий для события `DataBound` GridView s и добавьте следующий код:</span><span class="sxs-lookup"><span data-stu-id="4e26a-208">Next, create an event handler for the GridView s `DataBound` event and add the following code:</span></span>

[!code-vb[Main](paging-and-sorting-report-data-vb/samples/sample5.vb)]

<span data-ttu-id="4e26a-209">Этот обработчик событий назначает свойству `PagingInformation` Label `Text` сообщение, информирующее пользователя о том, что на данный момент находится страница, на которой он находится, `Products.PageIndex + 1` о том, сколько всего страниц `Products.PageCount` (мы добавили 1 к свойству `Products.PageIndex`, так как `PageIndex` индексируется, начиная с 0).</span><span class="sxs-lookup"><span data-stu-id="4e26a-209">This event handler assigns the `PagingInformation` Label s `Text` property to a message informing the user the page they are currently visiting `Products.PageIndex + 1` out of how many total pages `Products.PageCount` (we add 1 to the `Products.PageIndex` property because `PageIndex` is indexed starting at 0).</span></span> <span data-ttu-id="4e26a-210">В отличие от обработчика событий `PageIndexChanged` я выбрал свойство назначить эту метку s `Text` в обработчике событий `DataBound`, так как событие `DataBound` срабатывает каждый раз, когда данные привязаны к GridView, а обработчик событий `PageIndexChanged` срабатывает только при изменении индекса страницы.</span><span class="sxs-lookup"><span data-stu-id="4e26a-210">I chose the assign this Label s `Text` property in the `DataBound` event handler as opposed to the `PageIndexChanged` event handler because the `DataBound` event fires every time data is bound to the GridView whereas the `PageIndexChanged` event handler only fires when the page index is changed.</span></span> <span data-ttu-id="4e26a-211">Когда элемент управления GridView изначально привязан к данным на первом посещении страницы, `PageIndexChanging` событие не срабатывает (в то время как `DataBound` событие).</span><span class="sxs-lookup"><span data-stu-id="4e26a-211">When the GridView is initially data bound on the first page visit, the `PageIndexChanging` event doesn t fire (whereas the `DataBound` event does).</span></span>

<span data-ttu-id="4e26a-212">Благодаря этому пользователю отображается сообщение, показывающее, на какой странице они находятся, и сколько всего страниц данных.</span><span class="sxs-lookup"><span data-stu-id="4e26a-212">With this addition, the user is now shown a message indicating what page they are visiting and how many total pages of data there are.</span></span>

<span data-ttu-id="4e26a-213">[![отображаются номер текущей страницы и общее количество страниц.](paging-and-sorting-report-data-vb/_static/image19.png)](paging-and-sorting-report-data-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="4e26a-213">[![The Current Page Number and Total Number of Pages are Displayed](paging-and-sorting-report-data-vb/_static/image19.png)](paging-and-sorting-report-data-vb/_static/image18.png)</span></span>

<span data-ttu-id="4e26a-214">**Рис. 10**. Отображение номера текущей страницы и общего числа страниц ([щелкните, чтобы просмотреть изображение с полным размером](paging-and-sorting-report-data-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="4e26a-214">**Figure 10**: The Current Page Number and Total Number of Pages are Displayed ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image20.png))</span></span>

<span data-ttu-id="4e26a-215">Кроме элемента управления Label, добавим элемент управления DropDownList, который перечисляет номера страниц в GridView с выбранной просматриваемой страницей.</span><span class="sxs-lookup"><span data-stu-id="4e26a-215">In addition to the Label control, let s also add a DropDownList control that lists the page numbers in the GridView with the currently viewed page selected.</span></span> <span data-ttu-id="4e26a-216">Идея в том, что пользователь может быстро перейти с текущей страницы на другую, просто выбрав новый индекс страницы из DropDownList.</span><span class="sxs-lookup"><span data-stu-id="4e26a-216">The idea here is that the user can quickly jump from the current page to another by simply selecting the new page index from the DropDownList.</span></span> <span data-ttu-id="4e26a-217">Для начала добавьте элемент DropDownList в конструктор, задав для его свойства `ID` значение `PageList` и установив флажок Включить автообратную передачу из своего смарт-тега.</span><span class="sxs-lookup"><span data-stu-id="4e26a-217">Start by adding a DropDownList to the Designer, setting its `ID` property to `PageList` and checking the Enable AutoPostBack option from its smart tag.</span></span>

<span data-ttu-id="4e26a-218">Затем вернитесь к обработчику событий `DataBound` и добавьте следующий код:</span><span class="sxs-lookup"><span data-stu-id="4e26a-218">Next, return to the `DataBound` event handler and add the following code:</span></span>

[!code-vb[Main](paging-and-sorting-report-data-vb/samples/sample6.vb)]

<span data-ttu-id="4e26a-219">Этот код начинается с очистки элементов в элементе DropDownList `PageList`.</span><span class="sxs-lookup"><span data-stu-id="4e26a-219">This code begins by clearing out the items in the `PageList` DropDownList.</span></span> <span data-ttu-id="4e26a-220">Это может показаться излишним, поскольку в одном из них не должно быть изменено число страниц, но другие пользователи могут одновременно использовать систему, добавляя или удаляя записи из таблицы `Products`.</span><span class="sxs-lookup"><span data-stu-id="4e26a-220">This may seem superfluous, since one wouldn't expect the number of pages to change, but other users may be using the system simultaneously, adding or removing records from the `Products` table.</span></span> <span data-ttu-id="4e26a-221">Такие операции вставки или удаления могут изменить количество страниц данных.</span><span class="sxs-lookup"><span data-stu-id="4e26a-221">Such insertions or deletions could alter the number of pages of data.</span></span>

<span data-ttu-id="4e26a-222">Затем необходимо еще раз создать номера страниц и сопоставить его с текущим `PageIndex` GridView, выбранном по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="4e26a-222">Next, we need to create the page numbers again and have the one that maps to the current GridView `PageIndex` selected by default.</span></span> <span data-ttu-id="4e26a-223">Это достигается с помощью цикла от 0 до `PageCount - 1`, добавления нового `ListItem` в каждой итерации и присвоения свойству `Selected` значения true, если текущий индекс итерации равен свойству `PageIndex` GridView s.</span><span class="sxs-lookup"><span data-stu-id="4e26a-223">We accomplish this with a loop from 0 to `PageCount - 1`, adding a new `ListItem` in each iteration and setting its `Selected` property to true if the current iteration index equals the GridView s `PageIndex` property.</span></span>

<span data-ttu-id="4e26a-224">Наконец, необходимо создать обработчик событий для события DropDownList `SelectedIndexChanged`, которое срабатывает каждый раз, когда пользователь выбирает другой элемент из списка.</span><span class="sxs-lookup"><span data-stu-id="4e26a-224">Finally, we need to create an event handler for the DropDownList s `SelectedIndexChanged` event, which fires each time the user pick a different item from the list.</span></span> <span data-ttu-id="4e26a-225">Чтобы создать этот обработчик событий, просто дважды щелкните элемент DropDownList в конструкторе, а затем добавьте следующий код:</span><span class="sxs-lookup"><span data-stu-id="4e26a-225">To create this event handler, simply double-click the DropDownList in the Designer, then add the following code:</span></span>

[!code-vb[Main](paging-and-sorting-report-data-vb/samples/sample7.vb)]

<span data-ttu-id="4e26a-226">Как показано на рис. 11, простое изменение свойства `PageIndex` GridView s приводит к повторной привязке данных к GridView.</span><span class="sxs-lookup"><span data-stu-id="4e26a-226">As Figure 11 shows, merely changing the GridView s `PageIndex` property causes the data to be rebound to the GridView.</span></span> <span data-ttu-id="4e26a-227">В обработчике событий `DataBound` GridView s выбрано соответствующее `ListItem` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="4e26a-227">In the GridView s `DataBound` event handler, the appropriate DropDownList `ListItem` is selected.</span></span>

<span data-ttu-id="4e26a-228">[![пользователь автоматически переводится на шестую страницу при выборе элемента раскрывающегося списка Page 6.](paging-and-sorting-report-data-vb/_static/image22.png)](paging-and-sorting-report-data-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="4e26a-228">[![The User is Automatically Taken to the Sixth Page When Selecting the Page 6 Drop-Down List Item](paging-and-sorting-report-data-vb/_static/image22.png)](paging-and-sorting-report-data-vb/_static/image21.png)</span></span>

<span data-ttu-id="4e26a-229">**Рис. 11**. пользователь автоматически переводится на шестую страницу при выборе элемента в раскрывающемся списке Page 6 ([щелкните, чтобы просмотреть изображение с полным размером](paging-and-sorting-report-data-vb/_static/image23.png)).</span><span class="sxs-lookup"><span data-stu-id="4e26a-229">**Figure 11**: The User is Automatically Taken to the Sixth Page When Selecting the Page 6 Drop-Down List Item ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image23.png))</span></span>

## <a name="step-5-adding-bi-directional-sorting-support"></a><span data-ttu-id="4e26a-230">Шаг 5. Добавление поддержки двунаправленной сортировки</span><span class="sxs-lookup"><span data-stu-id="4e26a-230">Step 5: Adding Bi-Directional Sorting Support</span></span>

<span data-ttu-id="4e26a-231">Добавление поддержки двунаправленной сортировки так же просто, как и Добавление поддержки разбиения по страницам, достаточно проверить параметр Включить сортировку из смарт-тега GridView s (который задает для [свойства`AllowSorting`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.allowsorting.aspx) GridView s значение `true`).</span><span class="sxs-lookup"><span data-stu-id="4e26a-231">Adding bi-directional sorting support is as simple as adding paging support simply check the Enable Sorting option from the GridView s smart tag (which sets the GridView s [`AllowSorting` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.allowsorting.aspx) to `true`).</span></span> <span data-ttu-id="4e26a-232">При этом каждый из заголовков полей GridView s подготавливается к просмотру, что при щелчке вызывает обратную передачу и возвращает данные, отсортированные по выбранному столбцу в возрастающем порядке.</span><span class="sxs-lookup"><span data-stu-id="4e26a-232">This renders each of the headers of the GridView s fields as LinkButtons that, when clicked, cause a postback and return the data sorted by the clicked column in ascending order.</span></span> <span data-ttu-id="4e26a-233">Повторное нажатие одной и той же заголовка LinkButton приводит к тому, что данные сортируются в убывающем порядке.</span><span class="sxs-lookup"><span data-stu-id="4e26a-233">Clicking the same header LinkButton again re-sorts the data in descending order.</span></span>

> [!NOTE]
> <span data-ttu-id="4e26a-234">Если используется пользовательский уровень доступа к данным, а не типизированный набор данных, то в смарт-теге GridView s может не быть параметра Включить сортировку.</span><span class="sxs-lookup"><span data-stu-id="4e26a-234">If you are using a custom Data Access Layer rather than a Typed DataSet, you may not have an Enable Sorting option in the GridView s smart tag.</span></span> <span data-ttu-id="4e26a-235">Этот флажок доступен только для элементов управления GridView, привязанных к источникам данных, которые изначально поддерживают сортировку.</span><span class="sxs-lookup"><span data-stu-id="4e26a-235">Only GridViews bound to data sources that natively support sorting have this checkbox available.</span></span> <span data-ttu-id="4e26a-236">Типизированный набор данных обеспечивает встроенную поддержку сортировки, так как ADO.NET DataTable предоставляет метод `Sort`, который при вызове сортирует таблицы DataTables с использованием заданного критерия.</span><span class="sxs-lookup"><span data-stu-id="4e26a-236">The Typed DataSet provides out-of-the-box sorting support since the ADO.NET DataTable provides a `Sort` method that, when invoked, sorts the DataTable s DataRows using the criteria specified.</span></span>

<span data-ttu-id="4e26a-237">Если DAL не возвращает объекты, которые изначально поддерживают сортировку, необходимо настроить ObjectDataSource для передачи сведений о сортировке на уровень бизнес-логики, который может либо отсортировать данные, либо иметь данные, отсортированные по DAL.</span><span class="sxs-lookup"><span data-stu-id="4e26a-237">If your DAL does not return objects that natively support sorting you will need to configure the ObjectDataSource to pass sorting information to the Business Logic Layer, which can either sort the data or have the data sorted by the DAL.</span></span> <span data-ttu-id="4e26a-238">В следующем учебном курсе мы расскажем, как сортировать данные на уровнях бизнес-логики и доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="4e26a-238">We'll explore how to sort data at the Business Logic and Data Access Layers in a future tutorial.</span></span>

<span data-ttu-id="4e26a-239">Элементы LinkButton, выполняющие сортировку, подготавливаются к просмотру как гиперссылки HTML, текущие цвета (синие для непосещенных ссылок и темно-красный для посещенной ссылки) конфликтуют с цветом фона строки заголовка.</span><span class="sxs-lookup"><span data-stu-id="4e26a-239">The sorting LinkButtons are rendered as HTML hyperlinks, whose current colors (blue for an unvisited link and a dark red for a visited link) clash with the background color of the header row.</span></span> <span data-ttu-id="4e26a-240">Вместо этого пусть все ссылки на строки заголовков отображаются белым цветом, независимо от того, были ли они просмотрены или нет.</span><span class="sxs-lookup"><span data-stu-id="4e26a-240">Instead, let s have all header row links displayed in white, regardless of whether they ve been visited or not.</span></span> <span data-ttu-id="4e26a-241">Это можно сделать, добавив следующий элемент в класс `Styles.css`:</span><span class="sxs-lookup"><span data-stu-id="4e26a-241">This can be accomplished by adding the following to the `Styles.css` class:</span></span>

[!code-css[Main](paging-and-sorting-report-data-vb/samples/sample8.css)]

<span data-ttu-id="4e26a-242">Этот синтаксис указывает, что при отображении гиперссылок внутри элемента, использующего класс Хеадерстиле, используется белый текст.</span><span class="sxs-lookup"><span data-stu-id="4e26a-242">This syntax indicates to use white text when displaying those hyperlinks within an element that uses the HeaderStyle class.</span></span>

<span data-ttu-id="4e26a-243">После этого добавления CSS при посещении страницы в браузере экран должен выглядеть примерно так, как показано на рис. 12.</span><span class="sxs-lookup"><span data-stu-id="4e26a-243">After this CSS addition, when visiting the page through a browser your screen should look similar to Figure 12.</span></span> <span data-ttu-id="4e26a-244">В частности, на рис. 12 показаны результаты после нажатия ссылки заголовка поля цены.</span><span class="sxs-lookup"><span data-stu-id="4e26a-244">In particular, Figure 12 shows the results after the Price field s header link has been clicked.</span></span>

<span data-ttu-id="4e26a-245">[![результаты отсортированы по UnitPrice в возрастающем порядке](paging-and-sorting-report-data-vb/_static/image25.png)](paging-and-sorting-report-data-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="4e26a-245">[![The Results Have Been Sorted by the UnitPrice in Ascending Order](paging-and-sorting-report-data-vb/_static/image25.png)](paging-and-sorting-report-data-vb/_static/image24.png)</span></span>

<span data-ttu-id="4e26a-246">**Рис. 12**. результаты отсортированы по UnitPrice в возрастающем порядке ([щелкните, чтобы просмотреть изображение с полным размером](paging-and-sorting-report-data-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="4e26a-246">**Figure 12**: The Results Have Been Sorted by the UnitPrice in Ascending Order ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image26.png))</span></span>

## <a name="examining-the-sorting-workflow"></a><span data-ttu-id="4e26a-247">Проверка рабочего процесса сортировки</span><span class="sxs-lookup"><span data-stu-id="4e26a-247">Examining the Sorting Workflow</span></span>

<span data-ttu-id="4e26a-248">Все поля GridView для BoundField, CheckBoxField, TemplateField и т. д. имеют свойство `SortExpression`, которое указывает выражение, которое должно использоваться для сортировки данных при щелчке ссылки заголовка поля сортировки.</span><span class="sxs-lookup"><span data-stu-id="4e26a-248">All GridView fields the BoundField, CheckBoxField, TemplateField, and so on have a `SortExpression` property that indicates the expression that should be used to sort the data when that field s sorting header link is clicked.</span></span> <span data-ttu-id="4e26a-249">GridView также имеет свойство `SortExpression`.</span><span class="sxs-lookup"><span data-stu-id="4e26a-249">The GridView also has a `SortExpression` property.</span></span> <span data-ttu-id="4e26a-250">Когда вы щелкнули заголовок элемента управления LinkButton, GridView присваивает этому полю `SortExpression` значение свойству `SortExpression`.</span><span class="sxs-lookup"><span data-stu-id="4e26a-250">When a sorting header LinkButton is clicked, the GridView assigns that field s `SortExpression` value to its `SortExpression` property.</span></span> <span data-ttu-id="4e26a-251">Затем данные повторно извлекаются из ObjectDataSource и сортируются в соответствии со свойством `SortExpression` GridView s.</span><span class="sxs-lookup"><span data-stu-id="4e26a-251">Next, the data is re-retrieved from the ObjectDataSource and sorted according to the GridView s `SortExpression` property.</span></span> <span data-ttu-id="4e26a-252">В следующем списке подробно описана последовательность действий, которые выполняются при сортировке пользователем данных в элементе управления GridView.</span><span class="sxs-lookup"><span data-stu-id="4e26a-252">The following list details the sequence of steps that transpires when an end user sorts the data in a GridView:</span></span>

1. <span data-ttu-id="4e26a-253">[Событие сортировки](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sorting(VS.80).aspx) GridView s срабатывает</span><span class="sxs-lookup"><span data-stu-id="4e26a-253">The GridView s [Sorting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sorting(VS.80).aspx) fires</span></span>
2. <span data-ttu-id="4e26a-254">[Свойство`SortExpression`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sortexpression.aspx) GridView s установлено в `SortExpression` поля, для которого была нажата заголовком LinkButton.</span><span class="sxs-lookup"><span data-stu-id="4e26a-254">The GridView s [`SortExpression` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sortexpression.aspx) is set to the `SortExpression` of the field whose sorting header LinkButton was clicked</span></span>
3. <span data-ttu-id="4e26a-255">ObjectDataSource повторно извлекает все данные из слоя BLL, а затем сортирует данные с помощью элемента GridView s `SortExpression`</span><span class="sxs-lookup"><span data-stu-id="4e26a-255">The ObjectDataSource re-retrieves all of the data from the BLL and then sorts the data using the GridView s `SortExpression`</span></span>
4. <span data-ttu-id="4e26a-256">Свойство `PageIndex` GridView s сбрасывается в 0, что означает, что при сортировке пользователя на первую страницу данных (предполагается, что была реализована поддержка разбиения по страницам)</span><span class="sxs-lookup"><span data-stu-id="4e26a-256">The GridView s `PageIndex` property is reset to 0, meaning that when sorting the user is returned to the first page of data (assuming paging support has been implemented)</span></span>
5. <span data-ttu-id="4e26a-257">Вызывается [событие`Sorted`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sorted(VS.80).aspx) GridView s</span><span class="sxs-lookup"><span data-stu-id="4e26a-257">The GridView s [`Sorted` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sorted(VS.80).aspx) fires</span></span>

<span data-ttu-id="4e26a-258">Как и при использовании разбиения по страницам по умолчанию, параметр сортировки по умолчанию повторно извлекает *все* записи из слоя BLL.</span><span class="sxs-lookup"><span data-stu-id="4e26a-258">Like with default paging, the default sorting option re-retrieves *all* of the records from the BLL.</span></span> <span data-ttu-id="4e26a-259">При использовании сортировки без разбиения на страницы или при использовании разбиения по страницам по умолчанию не существует способа обойти это снижение производительности (чем больше кэширования данных базы данных).</span><span class="sxs-lookup"><span data-stu-id="4e26a-259">When using sorting without paging or when using sorting with default paging, there s no way to circumvent this performance hit (short of caching the database data).</span></span> <span data-ttu-id="4e26a-260">Однако, как мы увидим в следующем учебном курсе, можно эффективно сортировать данные при использовании пользовательского разбиения по страницам.</span><span class="sxs-lookup"><span data-stu-id="4e26a-260">However, as we'll see in a future tutorial, it s possible to efficiently sort data when using custom paging.</span></span>

<span data-ttu-id="4e26a-261">При привязке ObjectDataSource к GridView с помощью раскрывающегося списка в смарт-теге GridView s каждое поле GridView автоматически имеет свойство `SortExpression`, присвоенное имени поля данных в классе `ProductsRow`.</span><span class="sxs-lookup"><span data-stu-id="4e26a-261">When binding an ObjectDataSource to the GridView through the drop-down list in the GridView s smart tag, each GridView field automatically has its `SortExpression` property assigned to the name of the data field in the `ProductsRow` class.</span></span> <span data-ttu-id="4e26a-262">Например, `ProductName` BoundField s `SortExpression` имеет значение `ProductName`, как показано в следующей декларативной разметке:</span><span class="sxs-lookup"><span data-stu-id="4e26a-262">For example, the `ProductName` BoundField s `SortExpression` is set to `ProductName`, as shown in the following declarative markup:</span></span>

[!code-aspx[Main](paging-and-sorting-report-data-vb/samples/sample9.aspx)]

<span data-ttu-id="4e26a-263">Поле можно настроить таким образом, чтобы оно не было упорядочено путем очистки свойства `SortExpression` (присвоение его пустой строке).</span><span class="sxs-lookup"><span data-stu-id="4e26a-263">A field can be configured so that it s not sortable by clearing out its `SortExpression` property (assigning it to an empty string).</span></span> <span data-ttu-id="4e26a-264">Чтобы проиллюстрировать это, представьте, что мы не хотим, чтобы наши клиенты могли сортировать наши продукты по цене.</span><span class="sxs-lookup"><span data-stu-id="4e26a-264">To illustrate this, imagine that we didn't want to let our customers sort our products by price.</span></span> <span data-ttu-id="4e26a-265">Свойство `UnitPrice` BoundField s `SortExpression` может быть удалено из декларативной разметки или в диалоговом окне поля (доступ к которому можно получить, щелкнув ссылку изменить столбцы в смарт-теге GridView).</span><span class="sxs-lookup"><span data-stu-id="4e26a-265">The `UnitPrice` BoundField s `SortExpression` property can be removed either from the declarative markup or through the Fields dialog box (which is accessible by clicking on the Edit Columns link in the GridView s smart tag).</span></span>

![Результаты отсортированы по UnitPrice в возрастающем порядке.](paging-and-sorting-report-data-vb/_static/image27.png)

<span data-ttu-id="4e26a-267">**Рис. 13**. результаты отсортированы по UnitPrice в возрастающем порядке</span><span class="sxs-lookup"><span data-stu-id="4e26a-267">**Figure 13**: The Results Have Been Sorted by the UnitPrice in Ascending Order</span></span>

<span data-ttu-id="4e26a-268">После удаления свойства `SortExpression` для `UnitPrice` BoundField заголовок подготавливается к просмотру как текст, а не как связь, тем самым запрещая пользователям сортировать данные по цене.</span><span class="sxs-lookup"><span data-stu-id="4e26a-268">Once the `SortExpression` property has been removed for the `UnitPrice` BoundField, the header is rendered as text rather than as a link, thereby preventing users from sorting the data by price.</span></span>

<span data-ttu-id="4e26a-269">[![, удалив свойство SortExpression, пользователи больше не смогут Сортировать продукты по цене](paging-and-sorting-report-data-vb/_static/image29.png)](paging-and-sorting-report-data-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="4e26a-269">[![By Removing the SortExpression Property, Users Can No Longer Sort the Products By Price](paging-and-sorting-report-data-vb/_static/image29.png)](paging-and-sorting-report-data-vb/_static/image28.png)</span></span>

<span data-ttu-id="4e26a-270">**Рис. 14**. Если удалить свойство SortExpression, пользователи больше не смогут Сортировать продукты по цене ([щелкните, чтобы просмотреть изображение с полным размером](paging-and-sorting-report-data-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="4e26a-270">**Figure 14**: By Removing the SortExpression Property, Users Can No Longer Sort the Products By Price ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image30.png))</span></span>

## <a name="programmatically-sorting-the-gridview"></a><span data-ttu-id="4e26a-271">Программная сортировка GridView</span><span class="sxs-lookup"><span data-stu-id="4e26a-271">Programmatically Sorting the GridView</span></span>

<span data-ttu-id="4e26a-272">Можно также отсортировать содержимое элемента управления GridView программным способом с помощью [`Sort`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sort.aspx)GridView s.</span><span class="sxs-lookup"><span data-stu-id="4e26a-272">You can also sort the contents of the GridView programmatically by using the GridView s [`Sort` method](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.sort.aspx).</span></span> <span data-ttu-id="4e26a-273">Просто передайте значение `SortExpression`, чтобы выполнить сортировку вместе с [`SortDirection`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sortdirection.aspx) (`Ascending` или `Descending`), и данные GridView s будут повторно отсортированы.</span><span class="sxs-lookup"><span data-stu-id="4e26a-273">Simply pass in the `SortExpression` value to sort by along with the [`SortDirection`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sortdirection.aspx) (`Ascending` or `Descending`), and the GridView s data will be re-sorted.</span></span>

<span data-ttu-id="4e26a-274">Предположим, причина, по которой мы отключили сортировку `UnitPrice`, была обусловлена тем, что наши клиенты были бы просто покупать только продукты с самой низкой ценой.</span><span class="sxs-lookup"><span data-stu-id="4e26a-274">Imagine that the reason we turned off sorting by the `UnitPrice` was because we were worried that our customers would simply buy only the lowest-priced products.</span></span> <span data-ttu-id="4e26a-275">Тем не менее мы хотим предоставить им возможность покупать самые ресурсоемкие продукты, поэтому мы можем отсортировать продукты по цене, но только начиная с самой дорогостоящей цены.</span><span class="sxs-lookup"><span data-stu-id="4e26a-275">However, we want to encourage them to buy the most expensive products, so we d like them to be able to sort the products by price, but only from the most expensive price to the least.</span></span>

<span data-ttu-id="4e26a-276">Для этого добавьте к странице веб-элемент управления Button, задайте для свойства `ID` значение `SortPriceDescending`, а для свойства `Text` — Сортировать по цене.</span><span class="sxs-lookup"><span data-stu-id="4e26a-276">To accomplish this add a Button Web control to the page, set its `ID` property to `SortPriceDescending`, and its `Text` property to Sort by Price.</span></span> <span data-ttu-id="4e26a-277">Затем создайте обработчик событий для кнопки `Click` событие, дважды щелкнув элемент управления "Кнопка" в конструкторе.</span><span class="sxs-lookup"><span data-stu-id="4e26a-277">Next, create an event handler for the Button s `Click` event by double-clicking the Button control in the Designer.</span></span> <span data-ttu-id="4e26a-278">Добавьте следующий код в этот обработчик событий:</span><span class="sxs-lookup"><span data-stu-id="4e26a-278">Add the following code to this event handler:</span></span>

[!code-vb[Main](paging-and-sorting-report-data-vb/samples/sample10.vb)]

<span data-ttu-id="4e26a-279">При нажатии этой кнопки пользователь возвращается к первой странице с продуктами, отсортированными по цене, от наиболее дорогих и наименее дорогих (см. рис. 15).</span><span class="sxs-lookup"><span data-stu-id="4e26a-279">Clicking this Button returns the user to the first page with the products sorted by price, from most expensive to least expensive (see Figure 15).</span></span>

<span data-ttu-id="4e26a-280">[![нажатии кнопки упорядочивает продукты от наиболее дорогих до наименее](paging-and-sorting-report-data-vb/_static/image32.png)](paging-and-sorting-report-data-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="4e26a-280">[![Clicking the Button Orders the Products From the Most Expensive to the Least](paging-and-sorting-report-data-vb/_static/image32.png)](paging-and-sorting-report-data-vb/_static/image31.png)</span></span>

<span data-ttu-id="4e26a-281">**Рис. 15**. нажатие кнопки упорядочивает продукты от наиболее дорогих к наименьшему ([щелкните, чтобы просмотреть изображение с полным размером](paging-and-sorting-report-data-vb/_static/image33.png)).</span><span class="sxs-lookup"><span data-stu-id="4e26a-281">**Figure 15**: Clicking the Button Orders the Products From the Most Expensive to the Least ([Click to view full-size image](paging-and-sorting-report-data-vb/_static/image33.png))</span></span>

## <a name="summary"></a><span data-ttu-id="4e26a-282">Сводка</span><span class="sxs-lookup"><span data-stu-id="4e26a-282">Summary</span></span>

<span data-ttu-id="4e26a-283">В этом учебнике мы рассмотрели, как реализовать возможности разбиения по страницам и сортировки по умолчанию, которые были так же просты, как проверка флажка.</span><span class="sxs-lookup"><span data-stu-id="4e26a-283">In this tutorial we saw how to implement default paging and sorting capabilities, both of which were as easy as checking a checkbox!</span></span> <span data-ttu-id="4e26a-284">Когда пользователь сортирует или выполняет сортировку по данным, аналогичный рабочий процесс разбирается так:</span><span class="sxs-lookup"><span data-stu-id="4e26a-284">When a user sorts or pages through data, a similar workflow unfolds:</span></span>

1. <span data-ttu-id="4e26a-285">Обратная передача</span><span class="sxs-lookup"><span data-stu-id="4e26a-285">A postback ensues</span></span>
2. <span data-ttu-id="4e26a-286">Срабатывает событие предварительного уровня веб-элемента управления данными (`PageIndexChanging` или `Sorting`)</span><span class="sxs-lookup"><span data-stu-id="4e26a-286">The data Web control s pre-level event fires (`PageIndexChanging` or `Sorting`)</span></span>
3. <span data-ttu-id="4e26a-287">Элемент ObjectDataSource повторно извлекает все данные</span><span class="sxs-lookup"><span data-stu-id="4e26a-287">All of the data is re-retrieved by the ObjectDataSource</span></span>
4. <span data-ttu-id="4e26a-288">Срабатывает событие последующей загрузки веб-элемента управления данными (`PageIndexChanged` или `Sorted`)</span><span class="sxs-lookup"><span data-stu-id="4e26a-288">The data Web control s post-level event fires (`PageIndexChanged` or `Sorted`)</span></span>

<span data-ttu-id="4e26a-289">Несмотря на то, что реализация базового разбиения по страницам и упорядочения является очень простой, для использования более эффективного пользовательского разбиения на страницы или дальнейшего улучшения интерфейса разбиения по страницам или сортировки требуется больше усилий.</span><span class="sxs-lookup"><span data-stu-id="4e26a-289">While implementing basic paging and sorting is a breeze, more effort must be exerted to utilize the more efficient custom paging or to further enhance the paging or sorting interface.</span></span> <span data-ttu-id="4e26a-290">В следующих руководствах будут рассмотрены эти темы.</span><span class="sxs-lookup"><span data-stu-id="4e26a-290">Future tutorials will explore these topics.</span></span>

<span data-ttu-id="4e26a-291">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="4e26a-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="4e26a-292">Об авторе</span><span class="sxs-lookup"><span data-stu-id="4e26a-292">About the Author</span></span>

<span data-ttu-id="4e26a-293">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="4e26a-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="4e26a-294">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="4e26a-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="4e26a-295">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="4e26a-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="4e26a-296">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="4e26a-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="4e26a-297">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="4e26a-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="4e26a-298">[Назад](creating-a-customized-sorting-user-interface-cs.md)
> [Вперед](efficiently-paging-through-large-amounts-of-data-vb.md)</span><span class="sxs-lookup"><span data-stu-id="4e26a-298">[Previous](creating-a-customized-sorting-user-interface-cs.md)
[Next](efficiently-paging-through-large-amounts-of-data-vb.md)</span></span>
