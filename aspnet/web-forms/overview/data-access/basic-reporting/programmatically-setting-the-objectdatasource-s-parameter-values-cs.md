---
uid: web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
title: Программная установка значений параметров ObjectDataSource (C#) | Документация Майкрософт
author: rick-anderson
description: В этом учебнике мы рассмотрим добавление метода к DAL и BLL, который принимает один входной параметр и возвращает данные. В примере будет задан этот параметр...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 1c4588bb-255d-4088-b319-5208da756f4d
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
msc.type: authoredcontent
ms.openlocfilehash: 8aa57172abcfc779fa74b128ad76d42c41dc5b98
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78465942"
---
# <a name="programmatically-setting-the-objectdatasources-parameter-values-c"></a><span data-ttu-id="7dcf0-104">Программная установка значений параметров ObjectDataSource (C#)</span><span class="sxs-lookup"><span data-stu-id="7dcf0-104">Programmatically Setting the ObjectDataSource's Parameter Values (C#)</span></span>

<span data-ttu-id="7dcf0-105">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="7dcf0-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="7dcf0-106">[Скачивание примера приложения](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe) или [Загрузка PDF-файла](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="7dcf0-106">[Download Sample App](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe) or [Download PDF](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span></span>

> <span data-ttu-id="7dcf0-107">В этом учебнике мы рассмотрим добавление метода к DAL и BLL, который принимает один входной параметр и возвращает данные.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-107">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter and returns data.</span></span> <span data-ttu-id="7dcf0-108">В этом примере этот параметр будет задан программно.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-108">The example will set this parameter programmatically.</span></span>

## <a name="introduction"></a><span data-ttu-id="7dcf0-109">Введение</span><span class="sxs-lookup"><span data-stu-id="7dcf0-109">Introduction</span></span>

<span data-ttu-id="7dcf0-110">Как было показано в [предыдущем учебном курсе](declarative-parameters-cs.md), для декларативной передачи значений параметров в методы ObjectDataSource можно использовать ряд параметров.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-110">As we saw in the [previous tutorial](declarative-parameters-cs.md), a number of options are available for declaratively passing parameter values to the ObjectDataSource's methods.</span></span> <span data-ttu-id="7dcf0-111">Если значение параметра жестко запрограммировано, поступает из веб-элемента управления на странице или находится в любом другом источнике, который читается источником данных `Parameter` объектом, например, это значение может быть привязано к входному параметру без написания строки кода.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-111">If the parameter value is hard-coded, comes from a Web control on the page, or is in any other source that is readable by a data source `Parameter` object, for example, that value can be bound to the input parameter without writing a line of code.</span></span>

<span data-ttu-id="7dcf0-112">Однако могут возникнуть случаи, когда значение параметра поступает из некоторого источника, который еще не учитывается одним из встроенных источников данных `Parameter` объектов.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-112">There may be times, however, when the parameter value comes from some source not already accounted for by one of the built-in data source `Parameter` objects.</span></span> <span data-ttu-id="7dcf0-113">Если наш сайт поддерживал учетные записи пользователей, может потребоваться задать параметр на основе идентификатора пользователя, вошедшего в систему в текущий момент.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-113">If our site supported user accounts we might want to set the parameter based on the currently logged in visitor's User ID.</span></span> <span data-ttu-id="7dcf0-114">Или может потребоваться настроить значение параметра перед его отправкой в метод базового объекта ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-114">Or we may need to customize the parameter value before sending it along to the ObjectDataSource's underlying object's method.</span></span>

<span data-ttu-id="7dcf0-115">Каждый раз, когда вызывается метод `Select` ObjectDataSource, ObjectDataSource сначала создает свое [событие SELECT](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="7dcf0-115">Whenever the ObjectDataSource's `Select` method is invoked the ObjectDataSource first raises its [Selecting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span></span> <span data-ttu-id="7dcf0-116">Затем вызывается метод базового объекта ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-116">The ObjectDataSource's underlying object's method is then invoked.</span></span> <span data-ttu-id="7dcf0-117">После этого срабатывает [выбранное событие](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) ObjectDataSource (рис. 1 иллюстрирует эту последовательность событий).</span><span class="sxs-lookup"><span data-stu-id="7dcf0-117">Once that completes the ObjectDataSource's [Selected event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) fires (Figure 1 illustrates this sequence of events).</span></span> <span data-ttu-id="7dcf0-118">Значения параметров, передаваемые в метод базового объекта ObjectDataSource, можно задать или настроить в обработчике событий для события `Selecting`.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-118">The parameter values passed into the ObjectDataSource's underlying object's method can be set or customized in an event handler for the `Selecting` event.</span></span>

<span data-ttu-id="7dcf0-119">[![выбранное событие ObjectDataSource и события выбора вызываются до и после вызова метода базового объекта](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="7dcf0-119">[![The ObjectDataSource's Selected and Selecting Events Fire Before and After Its Underlying Object's Method is Invoked](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span></span>

<span data-ttu-id="7dcf0-120">**Рис. 1**. события `Selected` и `Selecting` ObjectDataSource срабатывают до и после вызова метода базового объекта ([щелкните, чтобы просмотреть изображение с полным размером](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="7dcf0-120">**Figure 1**: The ObjectDataSource's `Selected` and `Selecting` Events Fire Before and After Its Underlying Object's Method is Invoked ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png))</span></span>

<span data-ttu-id="7dcf0-121">В этом учебнике мы рассмотрим добавление метода к DAL и BLL, который принимает один входной параметр `Month`, типа `int` и возвращает объект `EmployeesDataTable`, заполненный такими сотрудниками, годовщина найма которых находится в указанном `Month`.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-121">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter `Month`, of type `int` and returns an `EmployeesDataTable` object populated with those employees that have their hiring anniversary in the specified `Month`.</span></span> <span data-ttu-id="7dcf0-122">В нашем примере этот параметр будет задан программно на основе текущего месяца, в котором отображается список «годовщины сотрудников в этом месяце».</span><span class="sxs-lookup"><span data-stu-id="7dcf0-122">Our example will set this parameter programmatically based on the current month, showing a list of "Employee Anniversaries This Month."</span></span>

<span data-ttu-id="7dcf0-123">Приступим.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-123">Let's get started!</span></span>

## <a name="step-1-adding-a-method-toemployeestableadapter"></a><span data-ttu-id="7dcf0-124">Шаг 1. Добавление метода в`EmployeesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="7dcf0-124">Step 1: Adding a Method to`EmployeesTableAdapter`</span></span>

<span data-ttu-id="7dcf0-125">Для нашего первого примера необходимо добавить средства для получения тех сотрудников, чьи `HireDate` произошли в указанный месяц.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-125">For our first example we need to add a means to retrieve those employees whose `HireDate` occurred in a specified month.</span></span> <span data-ttu-id="7dcf0-126">Чтобы обеспечить эту функциональность в соответствии с нашей архитектурой, необходимо сначала создать метод в `EmployeesTableAdapter`, который сопоставляется с соответствующей инструкцией SQL.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-126">To provide this functionality in accordance with our architecture we need to first create a method in `EmployeesTableAdapter` that maps to the proper SQL statement.</span></span> <span data-ttu-id="7dcf0-127">Чтобы выполнить это, сначала откройте типизированный набор данных Northwind.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-127">To accomplish this, start by opening the Northwind Typed DataSet.</span></span> <span data-ttu-id="7dcf0-128">Щелкните правой кнопкой мыши метку `EmployeesTableAdapter` и выберите команду Добавить запрос.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-128">Right-click on the `EmployeesTableAdapter` label and choose Add Query.</span></span>

<span data-ttu-id="7dcf0-129">[![добавить новый запрос в Емплойистаблеадаптер](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="7dcf0-129">[![Add a New Query to the EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span></span>

<span data-ttu-id="7dcf0-130">**Рис. 2**. Добавление нового запроса в `EmployeesTableAdapter` ([щелкните, чтобы просмотреть изображение с полным размером](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="7dcf0-130">**Figure 2**: Add a New Query to the `EmployeesTableAdapter` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png))</span></span>

<span data-ttu-id="7dcf0-131">Выберите, чтобы добавить инструкцию SQL, которая возвращает строки.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-131">Choose to add a SQL statement that returns rows.</span></span> <span data-ttu-id="7dcf0-132">Когда вы найдете на экран указание `SELECT` оператора, будет уже загружена инструкция `SELECT` по умолчанию для `EmployeesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-132">When you reach the Specify a `SELECT` Statement screen the default `SELECT` statement for the `EmployeesTableAdapter` will already be loaded.</span></span> <span data-ttu-id="7dcf0-133">Просто добавьте в предложение `WHERE`: `WHERE DATEPART(m, HireDate) = @Month`.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-133">Simply add in the `WHERE` clause: `WHERE DATEPART(m, HireDate) = @Month`.</span></span> <span data-ttu-id="7dcf0-134">[DatePart](https://msdn.microsoft.com/library/ms174420.aspx) — это функция T-SQL, которая возвращает определенную часть даты типа `datetime`; в этом случае мы используем `DATEPART` для возврата месяца `HireDate` столбца.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) is a T-SQL function that returns a particular date portion of a `datetime` type; in this case we're using `DATEPART` to return the month of the `HireDate` column.</span></span>

<span data-ttu-id="7dcf0-135">[![возвращать только те строки, в которых столбец HireDate меньше или равен параметру @HiredBeforeDate](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="7dcf0-135">[![Return Only Those Rows Where the HireDate Column is Less Than or Equal to the @HiredBeforeDate Parameter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span></span>

<span data-ttu-id="7dcf0-136">**Рис. 3**. возврат только тех строк, в которых столбец `HireDate` меньше или равен параметру `@HiredBeforeDate` ([щелкните, чтобы просмотреть изображение с полным размером](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="7dcf0-136">**Figure 3**: Return Only Those Rows Where the `HireDate` Column is Less Than or Equal to the `@HiredBeforeDate` Parameter ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png))</span></span>

<span data-ttu-id="7dcf0-137">Наконец, измените имена методов `FillBy` и `GetDataBy` на `FillByHiredDateMonth` и `GetEmployeesByHiredDateMonth`соответственно.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-137">Finally, change the `FillBy` and `GetDataBy` method names to `FillByHiredDateMonth` and `GetEmployeesByHiredDateMonth`, respectively.</span></span>

<span data-ttu-id="7dcf0-138">[![выбрать более подходящие имена методов, чем Филлби и Жетдатаби](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="7dcf0-138">[![Choose More Appropriate Method Names Than FillBy and GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span></span>

<span data-ttu-id="7dcf0-139">**Рис. 4**. выбор более подходящих имен методов, чем `FillBy` и `GetDataBy` ([щелкните, чтобы просмотреть изображение с полным размером](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="7dcf0-139">**Figure 4**: Choose More Appropriate Method Names Than `FillBy` and `GetDataBy` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png))</span></span>

<span data-ttu-id="7dcf0-140">Нажмите кнопку Готово, чтобы завершить работу мастера и вернуться к области конструктора набора данных.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-140">Click Finish to complete the wizard and return to the DataSet's design surface.</span></span> <span data-ttu-id="7dcf0-141">Теперь `EmployeesTableAdapter` должен включать новый набор методов для доступа к сотрудникам, нанятым в течение указанного месяца.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-141">The `EmployeesTableAdapter` should now include a new set of methods for accessing employees hired in a specified month.</span></span>

<span data-ttu-id="7dcf0-142">[![новые методы появляются в область конструкторае набора данных.](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="7dcf0-142">[![The New Methods Appear in the DataSet's Design Surface](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span></span>

<span data-ttu-id="7dcf0-143">**Рис. 5**. новые методы отображаются в область конструкторае набора данных ([щелкните, чтобы просмотреть изображение с полным размером](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="7dcf0-143">**Figure 5**: The New Methods Appear in the DataSet's Design Surface ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png))</span></span>

## <a name="step-2-adding-thegetemployeesbyhireddatemonthmonthmethod-to-the-business-logic-layer"></a><span data-ttu-id="7dcf0-144">Шаг 2. Добавление метода`GetEmployeesByHiredDateMonth(month)`к слою бизнес-логики</span><span class="sxs-lookup"><span data-stu-id="7dcf0-144">Step 2: Adding the`GetEmployeesByHiredDateMonth(month)`Method to the Business Logic Layer</span></span>

<span data-ttu-id="7dcf0-145">Так как наша архитектура приложения использует отдельный слой для бизнес-логики и логики доступа к данным, нам нужно добавить к BLL метод, который обращается к DAL для получения сотрудников, нанятых до указанной даты.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-145">Since our application architecture uses a separate layer for the business logic and data access logic, we need to add a method to our BLL that calls down to the DAL to retrieve employees hired before a specified date.</span></span> <span data-ttu-id="7dcf0-146">Откройте файл `EmployeesBLL.cs` и добавьте следующий метод:</span><span class="sxs-lookup"><span data-stu-id="7dcf0-146">Open the `EmployeesBLL.cs` file and add the following method:</span></span>

[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample1.cs)]

<span data-ttu-id="7dcf0-147">Как и в случае с другими методами в этом классе, `GetEmployeesByHiredDateMonth(month)` просто вызывает DAL и возвращает результаты.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-147">As with our other methods in this class, `GetEmployeesByHiredDateMonth(month)` simply calls down into the DAL and returns the results.</span></span>

## <a name="step-3-displaying-employees-whose-hiring-anniversary-is-this-month"></a><span data-ttu-id="7dcf0-148">Шаг 3. Отображение сотрудников, годовщина найма которых находится в этом месяце</span><span class="sxs-lookup"><span data-stu-id="7dcf0-148">Step 3: Displaying Employees Whose Hiring Anniversary Is This Month</span></span>

<span data-ttu-id="7dcf0-149">Последний шаг в этом примере — отображение сотрудников, годовщина найма которых составляет этот месяц.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-149">Our final step for this example is to display those employees whose hiring anniversary is this month.</span></span> <span data-ttu-id="7dcf0-150">Начните с добавления элемента управления GridView на страницу `ProgrammaticParams.aspx` в папке `BasicReporting` и добавьте новый элемент управления ObjectDataSource в качестве источника данных.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-150">Start by adding a GridView to the `ProgrammaticParams.aspx` page in the `BasicReporting` folder and add a new ObjectDataSource as its data source.</span></span> <span data-ttu-id="7dcf0-151">Настройте ObjectDataSource для использования класса `EmployeesBLL`, `SelectMethod` для которого задано значение `GetEmployeesByHiredDateMonth(month)`.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-151">Configure the ObjectDataSource to use the `EmployeesBLL` class with the `SelectMethod` set to `GetEmployeesByHiredDateMonth(month)`.</span></span>

<span data-ttu-id="7dcf0-152">[![использования класса Емплойисблл](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="7dcf0-152">[![Use the EmployeesBLL Class](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span></span>

<span data-ttu-id="7dcf0-153">**Рис. 6**. использование класса `EmployeesBLL` ([щелкните, чтобы просмотреть изображение с полным размером](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="7dcf0-153">**Figure 6**: Use the `EmployeesBLL` Class ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png))</span></span>

<span data-ttu-id="7dcf0-154">[![SELECT из метода Жетемплойисбихиреддатемонс (month)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="7dcf0-154">[![Select From the GetEmployeesByHiredDateMonth(month) method](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span></span>

<span data-ttu-id="7dcf0-155">**Рис. 7**. выбор из метода `GetEmployeesByHiredDateMonth(month)` ([щелкните, чтобы просмотреть изображение с полным размером](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="7dcf0-155">**Figure 7**: Select From the `GetEmployeesByHiredDateMonth(month)` method ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png))</span></span>

<span data-ttu-id="7dcf0-156">На последнем экране будет предложено указать источник значения параметра `month`.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-156">The final screen asks us to provide the `month` parameter value's source.</span></span> <span data-ttu-id="7dcf0-157">Так как это значение будет задано программно, оставьте параметр Источник параметра значение по умолчанию нет и нажмите кнопку Готово.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-157">Since we'll set this value programmatically, leave the Parameter source set to the default None option and click Finish.</span></span>

<span data-ttu-id="7dcf0-158">[![параметр источнику параметра оставить значение нет](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="7dcf0-158">[![Leave the Parameter Source Set to None](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span></span>

<span data-ttu-id="7dcf0-159">**Рис. 8**. Оставьте параметр Источник параметра равным None ([щелкните, чтобы просмотреть изображение с полным размером](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png)).</span><span class="sxs-lookup"><span data-stu-id="7dcf0-159">**Figure 8**: Leave the Parameter Source Set to None ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png))</span></span>

<span data-ttu-id="7dcf0-160">Будет создан объект `Parameter` в коллекции `SelectParameters` ObjectDataSource, для которой не указано значение.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-160">This will create a `Parameter` object in the ObjectDataSource's `SelectParameters` collection that does not have a value specified.</span></span>

[!code-aspx[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample2.aspx)]

<span data-ttu-id="7dcf0-161">Чтобы программно задать это значение, необходимо создать обработчик событий для события `Selecting` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-161">To set this value programmatically, we need to create an event handler for the ObjectDataSource's `Selecting` event.</span></span> <span data-ttu-id="7dcf0-162">Чтобы сделать это, перейдите к представление конструирования и дважды щелкните элемент ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-162">To accomplish this, go to the Design view and double-click the ObjectDataSource.</span></span> <span data-ttu-id="7dcf0-163">Кроме того, можно выбрать элемент ObjectDataSource, вернуться к окно свойств и щелкнуть значок с молнией.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-163">Alternatively, select the ObjectDataSource, go to the Properties window, and click the lightning bolt icon.</span></span> <span data-ttu-id="7dcf0-164">Затем либо дважды щелкните текстовое поле рядом с событием `Selecting`, либо введите имя обработчика событий, который вы хотите использовать.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-164">Next, either double-click in the textbox next to the `Selecting` event or type in the name of the event handler you want to use.</span></span>

![Щелкните значок с молнией в окне "Свойства", чтобы получить список событий веб-элемента управления](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image25.png)

<span data-ttu-id="7dcf0-166">**Рис. 9**. Щелкните значок с молнией в окне свойств, чтобы получить список событий веб-элемента управления</span><span class="sxs-lookup"><span data-stu-id="7dcf0-166">**Figure 9**: Click on the Lightning Bolt Icon in the Properties Window to List a Web Control's Events</span></span>

<span data-ttu-id="7dcf0-167">Оба подхода добавляют новый обработчик событий для события `Selecting` ObjectDataSource в класс кода программной части страницы.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-167">Both approaches add a new event handler for the ObjectDataSource's `Selecting` event to the page's code-behind class.</span></span> <span data-ttu-id="7dcf0-168">В этом обработчике событий можно выполнять чтение и запись значений параметров с помощью `e.InputParameters[parameterName]`, где *`parameterName`* является значением атрибута `Name` в теге `<asp:Parameter>` (`InputParameters` коллекция также может индексироваться по порядковому номеру, как в `e.InputParameters[index]`).</span><span class="sxs-lookup"><span data-stu-id="7dcf0-168">In this event handler we can read and write to the parameter values using `e.InputParameters[parameterName]`, where *`parameterName`* is the value of the `Name` attribute in the `<asp:Parameter>` tag (the `InputParameters` collection can also be indexed ordinally, as in `e.InputParameters[index]`).</span></span> <span data-ttu-id="7dcf0-169">Чтобы задать для параметра `month` текущий месяц, добавьте следующий объект в обработчик событий `Selecting`:</span><span class="sxs-lookup"><span data-stu-id="7dcf0-169">To set the `month` parameter to the current month, add the following to the `Selecting` event handler:</span></span>

[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample3.cs)]

<span data-ttu-id="7dcf0-170">При просмотре этой страницы в браузере мы видим, что только один сотрудник был нанят в этом месяце (март) Мария Каллахан, которая была в компании с 1994.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-170">When visiting this page through a browser we can see that only one employee was hired this month (March) Laura Callahan, who's been with the company since 1994.</span></span>

<span data-ttu-id="7dcf0-171">[![сотрудников, годовщины которых показаны в этом месяце](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="7dcf0-171">[![Those Employees Whose Anniversaries This Month Are Shown](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span></span>

<span data-ttu-id="7dcf0-172">**Рис. 10**. показаны сотрудники, годовщины которых отображаются в этом месяце ([щелкните, чтобы просмотреть изображение с полным размером](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="7dcf0-172">**Figure 10**: Those Employees Whose Anniversaries This Month Are Shown ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png))</span></span>

## <a name="summary"></a><span data-ttu-id="7dcf0-173">Сводка</span><span class="sxs-lookup"><span data-stu-id="7dcf0-173">Summary</span></span>

<span data-ttu-id="7dcf0-174">Хотя значения параметров ObjectDataSource обычно могут быть заданы декларативно, не требуя строки кода, можно легко задать значения параметров программным способом.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-174">While the ObjectDataSource's parameters' values can typically be set declaratively, without requiring a line of code, it's easy to set the parameter values programmatically.</span></span> <span data-ttu-id="7dcf0-175">Все, что нам нужно сделать, — это создать обработчик событий для события `Selecting` ObjectDataSource, который срабатывает перед вызовом метода базового объекта, и вручную задать значения для одного или нескольких параметров через коллекцию `InputParameters`.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-175">All we need to do is create an event handler for the ObjectDataSource's `Selecting` event, which fires before the underlying object's method is invoked, and manually set the values for one or more parameters via the `InputParameters` collection.</span></span>

<span data-ttu-id="7dcf0-176">В этом руководстве заканчивается раздел "основные отчеты".</span><span class="sxs-lookup"><span data-stu-id="7dcf0-176">This tutorial concludes the Basic Reporting section.</span></span> <span data-ttu-id="7dcf0-177">В [следующем учебнике](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) описывается раздел сценарии фильтрации и основной информации, в котором мы рассмотрим методы, позволяющие посетителям фильтровать данные и переходить от главного отчета к подробному отчету.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-177">The [next tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) kicks off the Filtering and Master-Details Scenarios section, in which we'll look at techniques for allowing the visitor to filter data and drill down from a master report into a details report.</span></span>

<span data-ttu-id="7dcf0-178">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="7dcf0-178">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="7dcf0-179">Об авторе</span><span class="sxs-lookup"><span data-stu-id="7dcf0-179">About the Author</span></span>

<span data-ttu-id="7dcf0-180">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="7dcf0-181">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-181">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="7dcf0-182">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="7dcf0-182">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="7dcf0-183">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7dcf0-183">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="7dcf0-184">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="7dcf0-184">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="7dcf0-185">Специальная благодарность</span><span class="sxs-lookup"><span data-stu-id="7dcf0-185">Special Thanks To</span></span>

<span data-ttu-id="7dcf0-186">Эта серия руководств была рассмотрена многими полезными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-186">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="7dcf0-187">Специалист по интересу для этого руководства был Хилтон Гизнау.</span><span class="sxs-lookup"><span data-stu-id="7dcf0-187">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="7dcf0-188">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="7dcf0-188">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="7dcf0-189">Если это так, расположите строку в [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7dcf0-189">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="7dcf0-190">[Назад](declarative-parameters-cs.md)
> [Вперед](displaying-data-with-the-objectdatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="7dcf0-190">[Previous](declarative-parameters-cs.md)
[Next](displaying-data-with-the-objectdatasource-vb.md)</span></span>
