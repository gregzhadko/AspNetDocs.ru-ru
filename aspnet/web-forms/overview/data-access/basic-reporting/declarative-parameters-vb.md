---
uid: web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
title: Декларативные параметры (VB) | Документация Майкрософт
author: rick-anderson
description: В этом учебнике мы продемонстрируем, как использовать набор параметров в жестко запрограммированное значение для выбора данных, отображаемых в элементе управления DetailsView.
ms.author: riande
ms.date: 03/31/2010
ms.assetid: dc1234a3-114f-4c9a-8d25-50ca03cc8e8e
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
msc.type: authoredcontent
ms.openlocfilehash: cdc42752fc78d18366af037a81fe4ebe5a1646ef
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78483132"
---
# <a name="declarative-parameters-vb"></a><span data-ttu-id="3405b-103">Декларативные параметры (VB)</span><span class="sxs-lookup"><span data-stu-id="3405b-103">Declarative Parameters (VB)</span></span>

<span data-ttu-id="3405b-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="3405b-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="3405b-105">[Скачивание примера приложения](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) или [Загрузка PDF-файла](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="3405b-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) or [Download PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span></span>

> <span data-ttu-id="3405b-106">В этом учебнике мы продемонстрируем, как использовать набор параметров в жестко запрограммированное значение для выбора данных, отображаемых в элементе управления DetailsView.</span><span class="sxs-lookup"><span data-stu-id="3405b-106">In this tutorial we'll illustrate how to use a parameter set to a hard-coded value to select the data to display in a DetailsView control.</span></span>

## <a name="introduction"></a><span data-ttu-id="3405b-107">Введение</span><span class="sxs-lookup"><span data-stu-id="3405b-107">Introduction</span></span>

<span data-ttu-id="3405b-108">В [последнем учебном курсе](displaying-data-with-the-objectdatasource-vb.md) мы рассматривали отображение данных с элементами управления GridView, DetailsView и FormView, привязанными к элементу управления ObjectDataSource, вызвавшему метод `GetProducts()` из класса `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="3405b-108">In the [last tutorial](displaying-data-with-the-objectdatasource-vb.md) we looked at displaying data with the GridView, DetailsView, and FormView controls bound to an ObjectDataSource control that invoked the `GetProducts()` method from the `ProductsBLL` class.</span></span> <span data-ttu-id="3405b-109">Метод `GetProducts()` возвращает строго типизированный объект DataTable, заполненный всеми записями из таблицы `Products` базы данных Northwind.</span><span class="sxs-lookup"><span data-stu-id="3405b-109">The `GetProducts()` method returns a strongly-typed DataTable populated with all of the records from the Northwind database's `Products` table.</span></span> <span data-ttu-id="3405b-110">Класс `ProductsBLL` содержит дополнительные методы для возврата только подмножества продуктов — `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`и `GetProductsBySupplierID(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="3405b-110">The `ProductsBLL` class contains additional methods for returning just subsets of the products - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, and `GetProductsBySupplierID(supplierID)`.</span></span> <span data-ttu-id="3405b-111">Эти три метода предполагают входной параметр, указывающий, как отфильтровать возвращенные сведения о продукте.</span><span class="sxs-lookup"><span data-stu-id="3405b-111">These three methods expect an input parameter indicating how to filter the returned product information.</span></span>

<span data-ttu-id="3405b-112">ObjectDataSource можно использовать для вызова методов, которые предполагают входные параметры, но для этого необходимо указать, откуда берутся значения этих параметров.</span><span class="sxs-lookup"><span data-stu-id="3405b-112">The ObjectDataSource can be used to invoke methods that expect input parameters, but in order to do so we must specify where the values for these parameters come from.</span></span> <span data-ttu-id="3405b-113">Значения параметров могут быть жестко запрограммированы или могут поступать из различных динамических источников, включая значения QueryString, переменные сеанса, значение свойства веб-элемента управления на странице или другие.</span><span class="sxs-lookup"><span data-stu-id="3405b-113">The parameter values can be hard-coded or can come from a variety of dynamic sources, including: querystring values, Session variables, the property value of a Web control on the page, or others.</span></span>

<span data-ttu-id="3405b-114">В этом руководстве начнем с демонстрации того, как использовать набор параметров для жестко запрограммированного значения.</span><span class="sxs-lookup"><span data-stu-id="3405b-114">For this tutorial let's start by illustrating how to use a parameter set to a hard-coded value.</span></span> <span data-ttu-id="3405b-115">В частности, мы рассмотрим добавление элемента DetailsView на страницу, на котором отображаются сведения о конкретном продукте, а именно Chef Anton's Gumbo, который имеет `ProductID` 5.</span><span class="sxs-lookup"><span data-stu-id="3405b-115">Specifically, we'll look at adding a DetailsView to the page that displays information about a specific product, namely Chef Anton's Gumbo Mix, which has a `ProductID` of 5.</span></span> <span data-ttu-id="3405b-116">Далее мы посмотрим, как задать значение параметра на основе веб-элемента управления.</span><span class="sxs-lookup"><span data-stu-id="3405b-116">Next, we'll see how to set the parameter value based on a Web control.</span></span> <span data-ttu-id="3405b-117">В частности, мы будем использовать текстовое поле для ввода пользователя в страну, после чего она может нажать кнопку, чтобы просмотреть список поставщиков, находящихся в этой стране.</span><span class="sxs-lookup"><span data-stu-id="3405b-117">In particular, we'll use a TextBox to let the user type in a country, after which they can click a Button to see the list of suppliers that reside in that country.</span></span>

## <a name="using-a-hard-coded-parameter-value"></a><span data-ttu-id="3405b-118">Использование жестко запрограммированного значения параметра</span><span class="sxs-lookup"><span data-stu-id="3405b-118">Using a Hard-Coded Parameter Value</span></span>

<span data-ttu-id="3405b-119">Для первого примера Начните с добавления элемента управления DetailsView на страницу `DeclarativeParams.aspx` в папке `BasicReporting`.</span><span class="sxs-lookup"><span data-stu-id="3405b-119">For the first example, start by adding a DetailsView control to the `DeclarativeParams.aspx` page in the `BasicReporting` folder.</span></span> <span data-ttu-id="3405b-120">Из смарт-тега DetailsView выберите &lt;создать источник данных&gt; из раскрывающегося списка и выберите Добавление элемента управления ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="3405b-120">From the DetailsView's smart tag, select &lt;New data source&gt; from the drop-down list and choose to add an ObjectDataSource.</span></span>

<span data-ttu-id="3405b-121">[![добавить элемент управления ObjectDataSource на страницу](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="3405b-121">[![Add an ObjectDataSource to the Page](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span></span>

<span data-ttu-id="3405b-122">**Рис. 1**. Добавление элемента управления ObjectDataSource на страницу ([щелкните, чтобы просмотреть изображение с полным размером](declarative-parameters-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="3405b-122">**Figure 1**: Add an ObjectDataSource to the Page ([Click to view full-size image](declarative-parameters-vb/_static/image3.png))</span></span>

<span data-ttu-id="3405b-123">Будет автоматически запущен мастер выбора источника данных элемента управления ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="3405b-123">This will automatically start the ObjectDataSource control's Choose Data Source wizard.</span></span> <span data-ttu-id="3405b-124">Выберите класс `ProductsBLL` на первом экране мастера.</span><span class="sxs-lookup"><span data-stu-id="3405b-124">Select the `ProductsBLL` class from the first screen of the wizard.</span></span>

<span data-ttu-id="3405b-125">[![выберите класс ProductsBLL](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="3405b-125">[![Select the ProductsBLL Class](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span></span>

<span data-ttu-id="3405b-126">**Рис. 2**. выбор класса `ProductsBLL` ([щелкните, чтобы просмотреть изображение с полным размером](declarative-parameters-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="3405b-126">**Figure 2**: Select the `ProductsBLL` Class ([Click to view full-size image](declarative-parameters-vb/_static/image6.png))</span></span>

<span data-ttu-id="3405b-127">Так как нам нужно отобразить сведения о конкретном продукте, мы хотим использовать метод `GetProductByProductID(productID)`.</span><span class="sxs-lookup"><span data-stu-id="3405b-127">Since we want to display information about a particular product we want to use the `GetProductByProductID(productID)` method.</span></span>

<span data-ttu-id="3405b-128">[![выбрать метод Жетпродуктбипродуктид (productID)](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="3405b-128">[![Choose the GetProductByProductID(productID) method](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span></span>

<span data-ttu-id="3405b-129">**Рис. 3**. выбор метода `GetProductByProductID(productID)` ([щелкните, чтобы просмотреть изображение с полным размером](declarative-parameters-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="3405b-129">**Figure 3**: Choose the `GetProductByProductID(productID)` method ([Click to view full-size image](declarative-parameters-vb/_static/image9.png))</span></span>

<span data-ttu-id="3405b-130">Так как выбранный метод включает параметр, в мастере есть еще один экран, где вам будет предложено определить значение, которое будет использоваться для параметра.</span><span class="sxs-lookup"><span data-stu-id="3405b-130">Since the method we selected includes a parameter, there's one more screen for the wizard, where we're asked to define the value to be used for the parameter.</span></span> <span data-ttu-id="3405b-131">В списке слева отображаются все параметры для выбранного метода.</span><span class="sxs-lookup"><span data-stu-id="3405b-131">The list on the left shows all of the parameters for the selected method.</span></span> <span data-ttu-id="3405b-132">Для `GetProductByProductID(productID)` существует только один `productID`.</span><span class="sxs-lookup"><span data-stu-id="3405b-132">For `GetProductByProductID(productID)` there's only one `productID`.</span></span> <span data-ttu-id="3405b-133">Справа можно указать значение для выбранного параметра.</span><span class="sxs-lookup"><span data-stu-id="3405b-133">On the right we can specify the value for the selected parameter.</span></span> <span data-ttu-id="3405b-134">Раскрывающийся список Источник параметра перечисляет различные возможные источники для значения параметра.</span><span class="sxs-lookup"><span data-stu-id="3405b-134">The parameter source drop-down list enumerates the various possible sources for the parameter value.</span></span> <span data-ttu-id="3405b-135">Так как нам нужно указать жестко заданное значение 5 для параметра `productID`, оставьте Источник параметра как нет и введите 5 в текстовое поле DefaultValue.</span><span class="sxs-lookup"><span data-stu-id="3405b-135">Since we want to specify a hard-coded value of 5 for the `productID` parameter, leave the Parameter source as None and enter 5 into the DefaultValue textbox.</span></span>

<span data-ttu-id="3405b-136">[![жестко запрограммированное значение параметра, равное 5, будет использоваться для параметра productID.](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="3405b-136">[![A Hard-Coded Parameter Value of 5 Will Be Used for the productID Parameter](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span></span>

<span data-ttu-id="3405b-137">**Рис. 4**. жестко запрограммированное значение параметра, равное 5, будет использоваться для параметра `productID` ([щелкните, чтобы просмотреть изображение с полным размером](declarative-parameters-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="3405b-137">**Figure 4**: A Hard-Coded Parameter Value of 5 Will Be Used for the `productID` Parameter ([Click to view full-size image](declarative-parameters-vb/_static/image12.png))</span></span>

<span data-ttu-id="3405b-138">После завершения работы мастера настройки источника данных декларативная разметка элемента управления ObjectDataSource включает объект `Parameter` в коллекцию `SelectParameters` для каждого входного параметра, ожидаемого методом, определенным в свойстве `SelectMethod`.</span><span class="sxs-lookup"><span data-stu-id="3405b-138">After completing the Configure Data Source wizard, the ObjectDataSource control's declarative markup includes a `Parameter` object in the `SelectParameters` collection for each of the input parameters expected by the method defined in the `SelectMethod` property.</span></span> <span data-ttu-id="3405b-139">Так как метод, который мы используем в этом примере, принимает только один входной параметр, `parameterID`, здесь есть только одна запись.</span><span class="sxs-lookup"><span data-stu-id="3405b-139">Since the method we're using in this example expects just a single input parameter, `parameterID`, there's only one entry here.</span></span> <span data-ttu-id="3405b-140">Коллекция `SelectParameters` может содержать любой класс, производный от класса `Parameter` в пространстве имен `System.Web.UI.WebControls`.</span><span class="sxs-lookup"><span data-stu-id="3405b-140">The `SelectParameters` collection can contain any class that derives from the `Parameter` class in the `System.Web.UI.WebControls` namespace.</span></span> <span data-ttu-id="3405b-141">Для жестко запрограммированных значений параметров используется базовый класс `Parameter`, но для других параметров источника параметра используется производный `Parameter` класс. При необходимости можно также создать собственные [пользовательские типы параметров](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11).</span><span class="sxs-lookup"><span data-stu-id="3405b-141">For hard-coded parameter values the base `Parameter` class is used, but for the other parameter source options a derived `Parameter` class is used; you can also create your own [custom parameter types](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), if needed.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="3405b-142">Если вы используете собственный компьютер, декларативная разметка, отображаемая на этом этапе, может включать значения свойств `InsertMethod`, `UpdateMethod`и `DeleteMethod`, а также `DeleteParameters`.</span><span class="sxs-lookup"><span data-stu-id="3405b-142">If you're following along on your own computer the declarative markup you see at this point may include values for the `InsertMethod`, `UpdateMethod`, and `DeleteMethod` properties, as well as `DeleteParameters`.</span></span> <span data-ttu-id="3405b-143">Мастер выбора источника данных ObjectDataSource автоматически задает методы из `ProductBLL`, которые будут использоваться для вставки, обновления и удаления, поэтому, если вы явно не сняли их, они будут добавлены в разметку выше.</span><span class="sxs-lookup"><span data-stu-id="3405b-143">The ObjectDataSource's Choose Data Source wizard automatically specifies the methods from the `ProductBLL` to use for inserting, updating, and deleting, so unless you explicitly cleared those out, they'll be included in the markup above.</span></span>

<span data-ttu-id="3405b-144">При посещении этой страницы веб-элемент управления данными будет вызывать метод `Select` ObjectDataSource, который будет вызывать метод `GetProductByProductID(productID)` класса `ProductsBLL`, используя жестко заданное значение 5 для входного параметра `productID`.</span><span class="sxs-lookup"><span data-stu-id="3405b-144">When visiting this page, the data Web control will invoke the ObjectDataSource's `Select` method, which will call the `ProductsBLL` class's `GetProductByProductID(productID)` method using the hard-coded value of 5 for the `productID` input parameter.</span></span> <span data-ttu-id="3405b-145">Метод возвратит строго типизированный `ProductDataTable` объект, содержащий одну строку со сведениями о Gumbo Anton's Chef (продукт с `ProductID` 5).</span><span class="sxs-lookup"><span data-stu-id="3405b-145">The method will return a strongly-typed `ProductDataTable` object that contains a single row with information about Chef Anton's Gumbo Mix (the product with `ProductID` 5).</span></span>

<span data-ttu-id="3405b-146">[![сведения о наборе Gumbo Anton's Chef](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="3405b-146">[![Information About Chef Anton's Gumbo Mix are Displayed](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span></span>

<span data-ttu-id="3405b-147">**Рис. 5**. отображаются сведения о наборе Gumbo Chef Anton's ([щелкните, чтобы просмотреть изображение с полным размером](declarative-parameters-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="3405b-147">**Figure 5**: Information About Chef Anton's Gumbo Mix are Displayed ([Click to view full-size image](declarative-parameters-vb/_static/image15.png))</span></span>

## <a name="setting-the-parameter-value-to-the-property-value-of-a-web-control"></a><span data-ttu-id="3405b-148">Присвоение параметру значения свойства веб-элемента управления</span><span class="sxs-lookup"><span data-stu-id="3405b-148">Setting the Parameter Value to the Property Value of a Web Control</span></span>

<span data-ttu-id="3405b-149">Значения параметров ObjectDataSource также могут быть заданы на основе значения веб-элемента управления на странице.</span><span class="sxs-lookup"><span data-stu-id="3405b-149">The ObjectDataSource's parameter values can also be set based on the value of a Web control on the page.</span></span> <span data-ttu-id="3405b-150">Чтобы проиллюстрировать это, рассмотрим элемент управления GridView, в котором перечислены все поставщики, расположенные в стране, указанной пользователем.</span><span class="sxs-lookup"><span data-stu-id="3405b-150">To illustrate this, let's have a GridView that lists all of the suppliers that are located in a country specified by the user.</span></span> <span data-ttu-id="3405b-151">Чтобы сделать это, добавьте на страницу текстовое поле, в которое пользователь может ввести название страны.</span><span class="sxs-lookup"><span data-stu-id="3405b-151">To accomplish this start by adding a TextBox to the page into which the user can enter a country name.</span></span> <span data-ttu-id="3405b-152">Присвойте свойству `ID` этого элемента управления TextBox значение `CountryName`.</span><span class="sxs-lookup"><span data-stu-id="3405b-152">Set this TextBox control's `ID` property to `CountryName`.</span></span> <span data-ttu-id="3405b-153">Также добавьте веб-элемент управления Button.</span><span class="sxs-lookup"><span data-stu-id="3405b-153">Also add a Button Web control.</span></span>

<span data-ttu-id="3405b-154">[![добавить текстовое поле на страницу с ИДЕНТИФИКАТОРом CountryName](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="3405b-154">[![Add a TextBox to the Page with ID CountryName](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span></span>

<span data-ttu-id="3405b-155">**Рис. 6**. Добавление на страницу текстового поля с `ID` `CountryName` ([щелкните, чтобы просмотреть изображение с полным размером](declarative-parameters-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="3405b-155">**Figure 6**: Add a TextBox to the Page with `ID` `CountryName` ([Click to view full-size image](declarative-parameters-vb/_static/image18.png))</span></span>

<span data-ttu-id="3405b-156">Затем добавьте элемент управления GridView на страницу и в смарт-теге выберите Добавление нового элемента ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="3405b-156">Next, add a GridView to the page and, from the smart tag, choose to add a new ObjectDataSource.</span></span> <span data-ttu-id="3405b-157">Так как мы хотим отобразить сведения о поставщиках, выберите класс `SuppliersBLL` на первом экране мастера.</span><span class="sxs-lookup"><span data-stu-id="3405b-157">Since we want to display supplier information select the `SuppliersBLL` class from the wizard's first screen.</span></span> <span data-ttu-id="3405b-158">На втором экране выберите метод `GetSuppliersByCountry(country)`.</span><span class="sxs-lookup"><span data-stu-id="3405b-158">From the second screen, pick the `GetSuppliersByCountry(country)` method.</span></span>

<span data-ttu-id="3405b-159">[![выбрать метод Жетсупплиерсбикаунтри (Country)](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="3405b-159">[![Choose the GetSuppliersByCountry(country) Method](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span></span>

<span data-ttu-id="3405b-160">**Рис. 7**. выбор метода `GetSuppliersByCountry(country)` ([щелкните, чтобы просмотреть изображение с полным размером](declarative-parameters-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="3405b-160">**Figure 7**: Choose the `GetSuppliersByCountry(country)` Method ([Click to view full-size image](declarative-parameters-vb/_static/image21.png))</span></span>

<span data-ttu-id="3405b-161">Так как метод `GetSuppliersByCountry(country)` имеет входной параметр, мастер снова включает в себя окончательный экран для выбора значения параметра.</span><span class="sxs-lookup"><span data-stu-id="3405b-161">Since the `GetSuppliersByCountry(country)` method has an input parameter, the wizard once again includes a final screen for choosing the parameter value.</span></span> <span data-ttu-id="3405b-162">На этот раз задайте источнику параметров значение Control.</span><span class="sxs-lookup"><span data-stu-id="3405b-162">This time, set the Parameter source to Control.</span></span> <span data-ttu-id="3405b-163">При этом раскрывающийся список ControlID будет заполнен именами элементов управления на странице. Выберите элемент управления `CountryName` из списка.</span><span class="sxs-lookup"><span data-stu-id="3405b-163">This will populate the ControlID drop-down list with the names of the controls on the page; select the `CountryName` control from the list.</span></span> <span data-ttu-id="3405b-164">При первом посещении страницы текстовое поле `CountryName` будет пустым, поэтому результаты не будут возвращены и ничего не отобразится.</span><span class="sxs-lookup"><span data-stu-id="3405b-164">When the page is first visited the `CountryName` TextBox will be blank, so no results are returned and nothing is displayed.</span></span> <span data-ttu-id="3405b-165">Если требуется отобразить некоторые результаты по умолчанию, задайте соответствующее текстовое поле DefaultValue.</span><span class="sxs-lookup"><span data-stu-id="3405b-165">If you want to display some results by default, set the DefaultValue textbox accordingly.</span></span>

<span data-ttu-id="3405b-166">[![присвоить параметру значение элемента управления CountryName](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="3405b-166">[![Set the Parameter Value to the CountryName Control Value](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span></span>

<span data-ttu-id="3405b-167">**Рис. 8**. Присвоение параметру значения элемента управления `CountryName` ([щелкните, чтобы просмотреть изображение с полным размером](declarative-parameters-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="3405b-167">**Figure 8**: Set the Parameter Value to the `CountryName` Control Value ([Click to view full-size image](declarative-parameters-vb/_static/image24.png))</span></span>

<span data-ttu-id="3405b-168">Декларативная разметка ObjectDataSource немного отличается от нашего первого примера с использованием [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) вместо стандартного объекта `Parameter`.</span><span class="sxs-lookup"><span data-stu-id="3405b-168">The ObjectDataSource's declarative markup differs slightly from our first example, using a [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) instead of the standard `Parameter` object.</span></span> <span data-ttu-id="3405b-169">У `ControlParameter` есть дополнительные свойства, позволяющие указать `ID` веб-элемента управления и значение свойства, которое будет использоваться для параметра (`PropertyName`).</span><span class="sxs-lookup"><span data-stu-id="3405b-169">A `ControlParameter` has additional properties to specify the `ID` of the Web control and the property value to use for the parameter (`PropertyName`).</span></span> <span data-ttu-id="3405b-170">Мастер настройки источника данных был достаточно интеллектуальным, чтобы определить, что для текстового поля, скорее всего, потребуется использовать свойство `Text` для значения параметра.</span><span class="sxs-lookup"><span data-stu-id="3405b-170">The Configure Data Source wizard was smart enough to determine that, for a TextBox, we'll likely want to use the `Text` property for the parameter value.</span></span> <span data-ttu-id="3405b-171">Однако если вы хотите использовать другое значение свойства из веб-элемента управления, можно изменить значение `PropertyName` здесь или щелкнув ссылку "Показывать дополнительные свойства" в мастере.</span><span class="sxs-lookup"><span data-stu-id="3405b-171">If, however, you want to use a different property value from the Web control you can change the `PropertyName` value here or by clicking the "Show advanced properties" link in the wizard.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample2.aspx)]

<span data-ttu-id="3405b-172">При первом посещении страницы в первый раз `CountryName` TextBox пуст.</span><span class="sxs-lookup"><span data-stu-id="3405b-172">When visiting the page for the first time the `CountryName` TextBox is empty.</span></span> <span data-ttu-id="3405b-173">Метод `Select` ObjectDataSource по-прежнему вызывается GridView, но значение `Nothing` передается в метод `GetSuppliersByCountry(country)`.</span><span class="sxs-lookup"><span data-stu-id="3405b-173">The ObjectDataSource's `Select` method is still invoked by the GridView, but a value of `Nothing` is passed into the `GetSuppliersByCountry(country)` method.</span></span> <span data-ttu-id="3405b-174">TableAdapter преобразует `Nothing` в базу данных `NULL` значение (`DBNull.Value`), но запрос, используемый методом `GetSuppliersByCountry(country)`, записывается таким способом, что он не возвращает никаких значений, если для параметра `NULL` указано значение `@CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="3405b-174">The TableAdapter converts the `Nothing` into a database `NULL` value (`DBNull.Value`), but the query used by the `GetSuppliersByCountry(country)` method is written such that it doesn't return any values when a `NULL` value is specified for the `@CategoryID` parameter.</span></span> <span data-ttu-id="3405b-175">Вкратце, поставщики не возвращаются.</span><span class="sxs-lookup"><span data-stu-id="3405b-175">In short, no suppliers are returned.</span></span>

<span data-ttu-id="3405b-176">Однако после того, как посетитель введет в страну и нажимает кнопку «Показывать поставщиков», чтобы вызвать обратную передачу, повторно запрашивается метод `Select` ObjectDataSource, передающий значение `Text` элемента управления TextBox в качестве параметра `country`.</span><span class="sxs-lookup"><span data-stu-id="3405b-176">Once the visitor enters in a country, however, and clicks the Show Suppliers button to cause a postback, the ObjectDataSource's `Select` method is requeried, passing in the TextBox control's `Text` value as the `country` parameter.</span></span>

<span data-ttu-id="3405b-177">[Отображаются ![поставщиков из Канады](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="3405b-177">[![Those Suppliers from Canada are Shown](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span></span>

<span data-ttu-id="3405b-178">**Рис. 9**. показаны поставщики из Канады ([щелкните, чтобы просмотреть изображение с полным размером](declarative-parameters-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="3405b-178">**Figure 9**: Those Suppliers from Canada are Shown ([Click to view full-size image](declarative-parameters-vb/_static/image27.png))</span></span>

## <a name="showing-all-suppliers-by-default"></a><span data-ttu-id="3405b-179">Отображение всех поставщиков по умолчанию</span><span class="sxs-lookup"><span data-stu-id="3405b-179">Showing All Suppliers By Default</span></span>

<span data-ttu-id="3405b-180">Вместо того чтобы показывать ни одного из поставщиков при первом просмотре страницы, может потребоваться сначала отобразить *всех* поставщиков, чтобы пользователь мог немного очистить вниз по списку, введя название страны в текстовом поле.</span><span class="sxs-lookup"><span data-stu-id="3405b-180">Rather than show none of the suppliers when first viewing the page we may want to show *all* suppliers at first, allowing the user to pare down the list by entering a country name in the TextBox.</span></span> <span data-ttu-id="3405b-181">Если текстовое поле пусто, метод `GetSuppliersByCountry(country)` `SuppliersBLL` класса передается в `Nothing` для его входного параметра *`country`* .</span><span class="sxs-lookup"><span data-stu-id="3405b-181">When the TextBox is empty, the `SuppliersBLL` class's `GetSuppliersByCountry(country)` method is passed in `Nothing` for its *`country`* input parameter.</span></span> <span data-ttu-id="3405b-182">Это `Nothing` значение затем передается в метод `GetSupplierByCountry(country)` DAL, где он преобразуется в базу данных `NULL` значение параметра `@Country` в следующем запросе:</span><span class="sxs-lookup"><span data-stu-id="3405b-182">This `Nothing` value is then passed down into the DAL's `GetSupplierByCountry(country)` method, where it's translated to a database `NULL` value for the `@Country` parameter in the following query:</span></span>

[!code-sql[Main](declarative-parameters-vb/samples/sample3.sql)]

<span data-ttu-id="3405b-183">Выражение `Country = NULL` всегда возвращает значение false, даже для записей, у которых `Country` столбец имеет `NULL` значение. Поэтому записи не возвращаются.</span><span class="sxs-lookup"><span data-stu-id="3405b-183">The expression `Country = NULL` always returns False, even for records whose `Country` column has a `NULL` value; therefore, no records are returned.</span></span>

<span data-ttu-id="3405b-184">Чтобы получить *список всех* поставщиков, если текстовое поле Country (страна) пустое, можно дополнить метод `GetSuppliersByCountry(country)` в BLL, чтобы вызвать метод `GetSuppliers()`, если параметр Country имеет значение `Nothing` и вызывать метод `GetSuppliersByCountry(country)` DAL в противном случае.</span><span class="sxs-lookup"><span data-stu-id="3405b-184">To return *all* suppliers when the country TextBox is empty, we can augment the `GetSuppliersByCountry(country)` method in the BLL to invoke the `GetSuppliers()` method when its country parameter is `Nothing` and to call the DAL's `GetSuppliersByCountry(country)` method otherwise.</span></span> <span data-ttu-id="3405b-185">Это приведет к возврату всех поставщиков, если не указана страна и соответствующее подмножество поставщиков при включении параметра Country.</span><span class="sxs-lookup"><span data-stu-id="3405b-185">This will have the effect of returning all suppliers when no country is specified and the appropriate subset of suppliers when the country parameter is included.</span></span>

<span data-ttu-id="3405b-186">Измените метод `GetSuppliersByCountry(country)` в классе `SuppliersBLL` на следующий:</span><span class="sxs-lookup"><span data-stu-id="3405b-186">Change the `GetSuppliersByCountry(country)` method in the `SuppliersBLL` class to the following:</span></span>

[!code-vb[Main](declarative-parameters-vb/samples/sample4.vb)]

<span data-ttu-id="3405b-187">После этого изменения `DeclarativeParams.aspx` страница отображает всех поставщиков при первом посещении (или при пустом текстовом поле `CountryName`).</span><span class="sxs-lookup"><span data-stu-id="3405b-187">With this change the `DeclarativeParams.aspx` page shows all of the suppliers when first visited (or whenever the `CountryName` TextBox is empty).</span></span>

<span data-ttu-id="3405b-188">[![все поставщики теперь отображаются по умолчанию](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="3405b-188">[![All Suppliers are Now Shown by Default](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span></span>

<span data-ttu-id="3405b-189">**Рис. 10**. все поставщики теперь отображаются по умолчанию ([щелкните, чтобы просмотреть изображение с полным размером](declarative-parameters-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="3405b-189">**Figure 10**: All Suppliers are Now Shown by Default ([Click to view full-size image](declarative-parameters-vb/_static/image30.png))</span></span>

## <a name="summary"></a><span data-ttu-id="3405b-190">Сводка</span><span class="sxs-lookup"><span data-stu-id="3405b-190">Summary</span></span>

<span data-ttu-id="3405b-191">Чтобы использовать методы с входными параметрами, необходимо указать значения для параметров в коллекции `SelectParameters` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="3405b-191">In order to use methods with input parameters, we need to specify the values for the parameters in the ObjectDataSource's `SelectParameters` collection.</span></span> <span data-ttu-id="3405b-192">Различные типы параметров позволяют получить значение параметра из различных источников.</span><span class="sxs-lookup"><span data-stu-id="3405b-192">Different types of parameters allow for the parameter value to be obtained from different sources.</span></span> <span data-ttu-id="3405b-193">Тип параметра по умолчанию использует жестко заданное значение, но так же просто (и без строки кода) значения параметров можно получить из строки запроса, переменных сеанса, файлов cookie и даже введенных пользователем значений из веб-элементов управления на странице.</span><span class="sxs-lookup"><span data-stu-id="3405b-193">The default parameter type uses a hard-coded value, but just as easily (and without a line of code) parameter values can be obtained from the querystring, Session variables, cookies, and even user-entered values from Web controls on the page.</span></span>

<span data-ttu-id="3405b-194">В примерах, рассмотренных в этом учебнике, показано, как использовать значения декларативных параметров.</span><span class="sxs-lookup"><span data-stu-id="3405b-194">The examples we looked at in this tutorial illustrated how to use declarative parameter values.</span></span> <span data-ttu-id="3405b-195">Однако могут возникнуть ситуации, когда нам нужно использовать недоступный источник параметра, например текущую дату и время, или, если наш сайт использовал членство, идентификатор пользователя посетителя.</span><span class="sxs-lookup"><span data-stu-id="3405b-195">However, there may be times when we need to use a parameter source that's not available, such as the current date and time, or, if our site was using Membership, the User ID of the visitor.</span></span> <span data-ttu-id="3405b-196">Для таких сценариев мы можем задать значения параметров программным способом до того, как ObjectDataSource вызовет метод базового объекта.</span><span class="sxs-lookup"><span data-stu-id="3405b-196">For such scenarios we can set the parameter values programmatically prior to the ObjectDataSource invoking its underlying object's method.</span></span> <span data-ttu-id="3405b-197">Мы посмотрим, как это сделать в [следующем руководстве](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md).</span><span class="sxs-lookup"><span data-stu-id="3405b-197">We'll see how to accomplish this in the [next tutorial](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md).</span></span>

<span data-ttu-id="3405b-198">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="3405b-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="3405b-199">Об авторе</span><span class="sxs-lookup"><span data-stu-id="3405b-199">About the Author</span></span>

<span data-ttu-id="3405b-200">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="3405b-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="3405b-201">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="3405b-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="3405b-202">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="3405b-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="3405b-203">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3405b-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="3405b-204">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="3405b-204">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="3405b-205">Специальная благодарность</span><span class="sxs-lookup"><span data-stu-id="3405b-205">Special Thanks To</span></span>

<span data-ttu-id="3405b-206">Эта серия руководств была рассмотрена многими полезными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="3405b-206">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="3405b-207">Специалист по интересу для этого руководства был Хилтон Гизнау.</span><span class="sxs-lookup"><span data-stu-id="3405b-207">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="3405b-208">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="3405b-208">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="3405b-209">Если это так, расположите строку в [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3405b-209">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="3405b-210">[Назад](displaying-data-with-the-objectdatasource-vb.md)
> [Вперед](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span><span class="sxs-lookup"><span data-stu-id="3405b-210">[Previous](displaying-data-with-the-objectdatasource-vb.md)
[Next](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span></span>
