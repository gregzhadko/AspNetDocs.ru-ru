---
uid: web-forms/overview/data-access/basic-reporting/displaying-data-with-the-objectdatasource-vb
title: Отображение данных с помощью ObjectDataSource (VB) | Документация Майкрософт
author: rick-anderson
description: В этом учебнике рассматривается элемент управления ObjectDataSource, использующий этот элемент управления. Вы можете привязать данные, полученные из BLL, созданного в предыдущем руководстве, без Хави...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: d62c3a63-0940-4019-874e-4a4047df0c1c
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/displaying-data-with-the-objectdatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 754188352cbfb08e610027f5b7890a32bd88ae26
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74609560"
---
# <a name="displaying-data-with-the-objectdatasource-vb"></a><span data-ttu-id="0ff95-103">Отображение данных с помощью элемента управления ObjectDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="0ff95-103">Displaying Data With the ObjectDataSource (VB)</span></span>

<span data-ttu-id="0ff95-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0ff95-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0ff95-105">[Скачивание примера приложения](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_4_VB.exe) или [Загрузка PDF-файла](displaying-data-with-the-objectdatasource-vb/_static/datatutorial04vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0ff95-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_4_VB.exe) or [Download PDF](displaying-data-with-the-objectdatasource-vb/_static/datatutorial04vb1.pdf)</span></span>

> <span data-ttu-id="0ff95-106">В этом учебнике рассматривается элемент управления ObjectDataSource, использующий этот элемент управления. Вы можете привязать данные, полученные из BLL, созданного в предыдущем учебном курсе, без необходимости писать строчку кода!</span><span class="sxs-lookup"><span data-stu-id="0ff95-106">This tutorial looks at the ObjectDataSource control Using this control you can bind data retrieved from the BLL created in the previous tutorial without having to write a line of code!</span></span>

## <a name="introduction"></a><span data-ttu-id="0ff95-107">Введение</span><span class="sxs-lookup"><span data-stu-id="0ff95-107">Introduction</span></span>

<span data-ttu-id="0ff95-108">Теперь, когда архитектура приложения и макет страницы веб-сайта завершены, мы готовы приступить к изучению способов выполнения разнообразных задач, связанных с данными и отчетами.</span><span class="sxs-lookup"><span data-stu-id="0ff95-108">With our application architecture and website page layout complete, we're ready to start exploring how to accomplish a variety of common data- and reporting-related tasks.</span></span> <span data-ttu-id="0ff95-109">В предыдущих руководствах мы рассмотрели, как программно привязывать данные из DAL и BLL к веб-элементу управления данными на странице ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="0ff95-109">In the previous tutorials we've seen how to programmatically bind data from the DAL and BLL to a data Web control in an ASP.NET page.</span></span> <span data-ttu-id="0ff95-110">Этот синтаксис назначает свойство `DataSource` веб-элемента управления данными для отображаемых данных, а затем вызывает метод `DataBind()` элемента управления в качестве шаблона, используемого в приложениях ASP.NET 1. x, и может продолжать использовать в приложениях 2,0.</span><span class="sxs-lookup"><span data-stu-id="0ff95-110">This syntax assigning the data Web control's `DataSource` property to the data to display and then calling the control's `DataBind()` method was the pattern used in ASP.NET 1.x applications, and can continue to be used in your 2.0 applications.</span></span> <span data-ttu-id="0ff95-111">Однако новые элементы управления источниками данных ASP.NET 2.0 обеспечивают декларативный способ работы с данными.</span><span class="sxs-lookup"><span data-stu-id="0ff95-111">However, ASP.NET 2.0's new data source controls offer a declarative way to work with data.</span></span> <span data-ttu-id="0ff95-112">С помощью этих элементов управления можно привязывать данные, полученные из BLL, созданного в предыдущем учебном курсе, без написания кода!</span><span class="sxs-lookup"><span data-stu-id="0ff95-112">Using these controls you can bind data retrieved from the BLL created in the previous tutorial without having to write a line of code!</span></span>

<span data-ttu-id="0ff95-113">ASP.NET 2,0 поставляется с пятью встроенными элементами управления источниками данных: [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx)и [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx) , хотя при необходимости можно создавать собственные [пользовательские элементы управления источниками данных](https://msdn.microsoft.com/library/default.asp?url=/library/dnvs05/html/DataSourceCon1.asp).</span><span class="sxs-lookup"><span data-stu-id="0ff95-113">ASP.NET 2.0 ships with five built-in data source controls [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx), and [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx) although you can build your own [custom data source controls](https://msdn.microsoft.com/library/default.asp?url=/library/dnvs05/html/DataSourceCon1.asp), if needed.</span></span> <span data-ttu-id="0ff95-114">Поскольку мы разработали архитектуру для нашего учебного приложения, мы будем использовать ObjectDataSource для наших классов BLL.</span><span class="sxs-lookup"><span data-stu-id="0ff95-114">Since we have developed an architecture for our tutorial application, we'll be using the ObjectDataSource against our BLL classes.</span></span>

![ASP.NET 2,0 включает пять встроенных элементов управления источниками данных](displaying-data-with-the-objectdatasource-vb/_static/image1.png)

<span data-ttu-id="0ff95-116">**Рис. 1**. ASP.NET 2,0 включает пять встроенных элементов управления источниками данных</span><span class="sxs-lookup"><span data-stu-id="0ff95-116">**Figure 1**: ASP.NET 2.0 Includes Five Built-In Data Source Controls</span></span>

<span data-ttu-id="0ff95-117">Элемент управления ObjectDataSource выступает в качестве прокси-сервера для работы с другим объектом.</span><span class="sxs-lookup"><span data-stu-id="0ff95-117">The ObjectDataSource serves as a proxy for working with some other object.</span></span> <span data-ttu-id="0ff95-118">Чтобы настроить ObjectDataSource, мы указываем этот базовый объект и как его методы сопоставляются с методами `Select`, `Insert`, `Update`и `Delete` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0ff95-118">To configure the ObjectDataSource we specify this underlying object and how its methods map to the ObjectDataSource's `Select`, `Insert`, `Update`, and `Delete` methods.</span></span> <span data-ttu-id="0ff95-119">После указания этого базового объекта и его методов, сопоставленных с ObjectDataSource, можно привязать ObjectDataSource к веб-элементу управления данными.</span><span class="sxs-lookup"><span data-stu-id="0ff95-119">Once this underlying object has been specified and its methods mapped to the ObjectDataSource's, we can then bind the ObjectDataSource to a data Web control.</span></span> <span data-ttu-id="0ff95-120">ASP.NET поставляется с множеством веб-элементов управления данными, включая GridView, DetailsView, RadioButtonList и DropDownList, среди прочих.</span><span class="sxs-lookup"><span data-stu-id="0ff95-120">ASP.NET ships with many data Web controls, including the GridView, DetailsView, RadioButtonList, and DropDownList, among others.</span></span> <span data-ttu-id="0ff95-121">Во время жизненного цикла страницы для веб-элемента управления данными может потребоваться доступ к данным, к которым он привязан, что достигается путем вызова метода `Select` элемента ObjectDataSource. Если веб-элемент управления данными поддерживает вставку, обновление или удаление, то могут выполняться вызовы методов `Insert`, `Update`или `Delete` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0ff95-121">During the page lifecycle, the data Web control may need to access the data it's bound to, which it will accomplish by invoking its ObjectDataSource's `Select` method; if the data Web control supports inserting, updating, or deleting, calls may be made to its ObjectDataSource's `Insert`, `Update`, or `Delete` methods.</span></span> <span data-ttu-id="0ff95-122">Затем эти вызовы направляются ObjectDataSource в соответствующие методы базового объекта, как показано на следующей схеме.</span><span class="sxs-lookup"><span data-stu-id="0ff95-122">These calls are then routed by the ObjectDataSource to the appropriate underlying object's methods as the following diagram illustrates.</span></span>

<span data-ttu-id="0ff95-123">[![элемент управления ObjectDataSource выступает в качестве прокси-сервера](displaying-data-with-the-objectdatasource-vb/_static/image3.png)](displaying-data-with-the-objectdatasource-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="0ff95-123">[![The ObjectDataSource Serves as a Proxy](displaying-data-with-the-objectdatasource-vb/_static/image3.png)](displaying-data-with-the-objectdatasource-vb/_static/image2.png)</span></span>

<span data-ttu-id="0ff95-124">**Рис. 2**. элемент управления ObjectDataSource выступает в качестве учетной записи-посредника ([щелкните, чтобы просмотреть изображение с полным размером](displaying-data-with-the-objectdatasource-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="0ff95-124">**Figure 2**: The ObjectDataSource Serves as a Proxy ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image4.png))</span></span>

<span data-ttu-id="0ff95-125">Хотя ObjectDataSource можно использовать для вызова методов для вставки, обновления или удаления данных, давайте просто рассмотрим возврат данных. в следующих учебных курсах рассматривается использование веб-элементов управления ObjectDataSource и Data, изменяющих данные.</span><span class="sxs-lookup"><span data-stu-id="0ff95-125">While the ObjectDataSource can be used to invoke methods for inserting, updating, or deleting data, let's just focus on returning data; future tutorials will explore using the ObjectDataSource and data Web controls that modify data.</span></span>

## <a name="step-1-adding-and-configuring-the-objectdatasource-control"></a><span data-ttu-id="0ff95-126">Шаг 1. Добавление и настройка элемента управления ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="0ff95-126">Step 1: Adding and Configuring the ObjectDataSource Control</span></span>

<span data-ttu-id="0ff95-127">Для начала откройте страницу `SimpleDisplay.aspx` в папке `BasicReporting`, переключитесь на представление конструирования, а затем перетащите элемент управления ObjectDataSource с панели элементов на область конструктора страницы.</span><span class="sxs-lookup"><span data-stu-id="0ff95-127">Start by opening the `SimpleDisplay.aspx` page in the `BasicReporting` folder, switch to Design view, and then drag an ObjectDataSource control from the Toolbox onto the page's design surface.</span></span> <span data-ttu-id="0ff95-128">Элемент управления ObjectDataSource отображается в области конструктора в виде серого прямоугольника, так как он не создает никакой разметки. Он просто обращается к данным, вызывая метод из указанного объекта.</span><span class="sxs-lookup"><span data-stu-id="0ff95-128">The ObjectDataSource appears as a gray box on the design surface because it does not produce any markup; it simply accesses data by invoking a method from a specified object.</span></span> <span data-ttu-id="0ff95-129">Данные, возвращаемые ObjectDataSource, могут отображаться веб-элементом управления данными, таким как GridView, DetailsView, FormView и т. д.</span><span class="sxs-lookup"><span data-stu-id="0ff95-129">The data returned by an ObjectDataSource can be displayed by a data Web control, such as the GridView, DetailsView, FormView, and so on.</span></span>

> [!NOTE]
> <span data-ttu-id="0ff95-130">Кроме того, можно сначала добавить веб-элемент управления данными на страницу, а затем из смарт-тега выбрать параметр &lt;создать источник данных&gt; из раскрывающегося списка.</span><span class="sxs-lookup"><span data-stu-id="0ff95-130">Alternatively, you may first add the data Web control to the page and then, from its smart tag, choose the &lt;New data source&gt; option from the drop-down list.</span></span>

<span data-ttu-id="0ff95-131">Чтобы указать базовый объект ObjectDataSource и способ его соответствия методам объекта ObjectDataSource, щелкните ссылку Настроить источник данных из смарт-тега ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0ff95-131">To specify the ObjectDataSource's underlying object and how that object's methods map to the ObjectDataSource's, click on the Configure Data Source link from the ObjectDataSource's smart tag.</span></span>

<span data-ttu-id="0ff95-132">[![щелкните ссылку Настройка источника данных из смарт-тега.](displaying-data-with-the-objectdatasource-vb/_static/image6.png)](displaying-data-with-the-objectdatasource-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="0ff95-132">[![Click the Configure Data Source Link from the Smart Tag](displaying-data-with-the-objectdatasource-vb/_static/image6.png)](displaying-data-with-the-objectdatasource-vb/_static/image5.png)</span></span>

<span data-ttu-id="0ff95-133">**Рис. 3**. Щелкните ссылку Настройка источника данных из смарт-тега ([щелкните, чтобы просмотреть изображение с полным размером](displaying-data-with-the-objectdatasource-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="0ff95-133">**Figure 3**: Click the Configure Data Source Link from the Smart Tag ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image7.png))</span></span>

<span data-ttu-id="0ff95-134">Откроется мастер настройки источника данных.</span><span class="sxs-lookup"><span data-stu-id="0ff95-134">This brings up the Configure Data Source wizard.</span></span> <span data-ttu-id="0ff95-135">Сначала необходимо указать объект, с которым будет работать элемент управления ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0ff95-135">First, we must specify the object the ObjectDataSource is to work with.</span></span> <span data-ttu-id="0ff95-136">Если установлен флажок "Показывать только компоненты данных", раскрывающийся список на этом экране содержит только те объекты, которые были дополнены атрибутом `DataObject`.</span><span class="sxs-lookup"><span data-stu-id="0ff95-136">If the "Show only data components" checkbox is checked, the drop-down list on this screen lists only those objects that have been decorated with the `DataObject` attribute.</span></span> <span data-ttu-id="0ff95-137">В настоящее время наш список включает адаптеры таблиц в типизированном наборе данных и классы BLL, созданные в предыдущем руководстве.</span><span class="sxs-lookup"><span data-stu-id="0ff95-137">Currently our list includes the TableAdapters in the Typed DataSet and the BLL classes we created in the previous tutorial.</span></span> <span data-ttu-id="0ff95-138">Если вы забыли добавить атрибут `DataObject` к классам уровня бизнес-логики, они не будут отображаться в этом списке.</span><span class="sxs-lookup"><span data-stu-id="0ff95-138">If you forgot to add the `DataObject` attribute to the Business Logic Layer classes you won't see them in this list.</span></span> <span data-ttu-id="0ff95-139">В этом случае снимите флажок "Показывать только компоненты данных", чтобы просмотреть все объекты, которые должны содержать классы BLL (вместе с другими классами в типизированном наборе DataSet, DataTables, DataRow и т. д.).</span><span class="sxs-lookup"><span data-stu-id="0ff95-139">In that case, uncheck the "Show only data components" checkbox to view all objects, which should include the BLL classes (along with the other classes in the Typed DataSet the DataTables, DataRows, and so on).</span></span>

<span data-ttu-id="0ff95-140">На первом экране выберите класс `ProductsBLL` из раскрывающегося списка и нажмите кнопку Далее.</span><span class="sxs-lookup"><span data-stu-id="0ff95-140">From this first screen choose the `ProductsBLL` class from the drop-down list and click Next.</span></span>

<span data-ttu-id="0ff95-141">[![указать объект для использования с элементом управления ObjectDataSource](displaying-data-with-the-objectdatasource-vb/_static/image9.png)](displaying-data-with-the-objectdatasource-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="0ff95-141">[![Specify the Object to Use with the ObjectDataSource Control](displaying-data-with-the-objectdatasource-vb/_static/image9.png)](displaying-data-with-the-objectdatasource-vb/_static/image8.png)</span></span>

<span data-ttu-id="0ff95-142">**Рис. 4**. Указание объекта для использования с элементом управления ObjectDataSource ([щелкните, чтобы просмотреть изображение с полным размером](displaying-data-with-the-objectdatasource-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="0ff95-142">**Figure 4**: Specify the Object to Use with the ObjectDataSource Control ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image10.png))</span></span>

<span data-ttu-id="0ff95-143">На следующем экране мастера появится запрос на выбор метода, который должен вызывать элемент управления ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0ff95-143">The next screen in the wizard prompts you to select what method the ObjectDataSource should invoke.</span></span> <span data-ttu-id="0ff95-144">Раскрывающийся список содержит методы, возвращающие данные в объекте, выбранном на предыдущем экране.</span><span class="sxs-lookup"><span data-stu-id="0ff95-144">The drop-down lists those methods that return data in the object selected from the previous screen.</span></span> <span data-ttu-id="0ff95-145">Здесь мы видим `GetProductByProductID`, `GetProducts`, `GetProductsByCategoryID`и `GetProductsBySupplierID`.</span><span class="sxs-lookup"><span data-stu-id="0ff95-145">Here we see `GetProductByProductID`, `GetProducts`, `GetProductsByCategoryID`, and `GetProductsBySupplierID`.</span></span> <span data-ttu-id="0ff95-146">Выберите метод `GetProducts` из раскрывающегося списка и нажмите кнопку "Готово" (если вы добавили `DataObjectMethodAttribute` в методы `ProductBLL`, как показано в предыдущем руководстве, этот параметр будет выбран по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="0ff95-146">Select the `GetProducts` method from the drop-down list and click Finish (if you added the `DataObjectMethodAttribute` to the `ProductBLL`'s methods as shown in the previous tutorial, this option will be selected by default).</span></span>

<span data-ttu-id="0ff95-147">[![выбор метода возврата данных на вкладке «Выбор»](displaying-data-with-the-objectdatasource-vb/_static/image12.png)](displaying-data-with-the-objectdatasource-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="0ff95-147">[![Choose the Method for Returning Data from the SELECT Tab](displaying-data-with-the-objectdatasource-vb/_static/image12.png)](displaying-data-with-the-objectdatasource-vb/_static/image11.png)</span></span>

<span data-ttu-id="0ff95-148">**Рис. 5**. Выбор метода возврата данных на вкладке "выбор" ([щелкните, чтобы просмотреть изображение с полным размером](displaying-data-with-the-objectdatasource-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="0ff95-148">**Figure 5**: Choose the Method for Returning Data from the SELECT Tab ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image13.png))</span></span>

## <a name="configure-the-objectdatasource-manually"></a><span data-ttu-id="0ff95-149">Настройка ObjectDataSource вручную</span><span class="sxs-lookup"><span data-stu-id="0ff95-149">Configure the ObjectDataSource Manually</span></span>

<span data-ttu-id="0ff95-150">Мастер настройки источников данных ObjectDataSource позволяет быстро указать используемый объект и определить, какие методы объекта вызываются.</span><span class="sxs-lookup"><span data-stu-id="0ff95-150">The ObjectDataSource's Configure Data Source wizard offers a quick way to specify the object it uses and to associate what methods of the object are invoked.</span></span> <span data-ttu-id="0ff95-151">Однако можно настроить ObjectDataSource с помощью его свойств либо с помощью окно свойств, либо непосредственно в декларативной разметке.</span><span class="sxs-lookup"><span data-stu-id="0ff95-151">You can, however, configure the ObjectDataSource through its properties, either through the Properties window or directly in the declarative markup.</span></span> <span data-ttu-id="0ff95-152">Просто задайте для свойства `TypeName` тип используемого базового объекта, а `SelectMethod` методу, который будет вызываться при извлечении данных.</span><span class="sxs-lookup"><span data-stu-id="0ff95-152">Simply set the `TypeName` property to the type of the underlying object to be used, and the `SelectMethod` to the method to invoke when retrieving data.</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-vb/samples/sample1.aspx)]

<span data-ttu-id="0ff95-153">Даже если вы предпочитаете Мастер настройки источников данных, может возникнуть необходимость ручной настройки ObjectDataSource, так как мастер отображает только классы, созданные разработчиком.</span><span class="sxs-lookup"><span data-stu-id="0ff95-153">Even if you prefer the Configure Data Source wizard there may be times when you need to manually configure the ObjectDataSource, as the wizard only lists developer-created classes.</span></span> <span data-ttu-id="0ff95-154">Если необходимо привязать ObjectDataSource к классу в .NET Framework например, в [классе членства](https://msdn.microsoft.com/library/system.web.security.membership.aspx), для доступа к сведениям об учетной записи пользователя или к [классу каталога](https://msdn.microsoft.com/library/system.io.directory.aspx) для работы со сведениями файловой системы, необходимо вручную задать свойства ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0ff95-154">If you want to bind the ObjectDataSource to a class in the .NET Framework such as the [Membership class](https://msdn.microsoft.com/library/system.web.security.membership.aspx), to access user account information, or the [Directory class](https://msdn.microsoft.com/library/system.io.directory.aspx) to work with file system information you'll need to manually set the ObjectDataSource's properties.</span></span>

## <a name="step-2-adding-a-data-web-control-and-binding-it-to-the-objectdatasource"></a><span data-ttu-id="0ff95-155">Шаг 2. Добавление веб-элемента управления данными и его привязка к ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="0ff95-155">Step 2: Adding a Data Web Control and Binding it to the ObjectDataSource</span></span>

<span data-ttu-id="0ff95-156">После того как ObjectDataSource добавлен на страницу и настроен, мы готовы к добавлению веб-элементов управления данными на страницу для вывода данных, возвращаемых методом `Select` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0ff95-156">Once the ObjectDataSource has been added to the page and configured, we're ready to add data Web controls to the page to display the data returned by the ObjectDataSource's `Select` method.</span></span> <span data-ttu-id="0ff95-157">Любой веб-элемент управления данными может быть привязан к элементу ObjectDataSource; Рассмотрим отображение данных ObjectDataSource в элементе управления GridView, DetailsView и FormView.</span><span class="sxs-lookup"><span data-stu-id="0ff95-157">Any data Web control can be bound to an ObjectDataSource; let's look at displaying the ObjectDataSource's data in a GridView, DetailsView, and FormView.</span></span>

## <a name="binding-a-gridview-to-the-objectdatasource"></a><span data-ttu-id="0ff95-158">Привязка элемента управления GridView к элементу управления ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="0ff95-158">Binding a GridView to the ObjectDataSource</span></span>

<span data-ttu-id="0ff95-159">Добавление элемента управления GridView из панели элементов в область конструктора `SimpleDisplay.aspx`.</span><span class="sxs-lookup"><span data-stu-id="0ff95-159">Add a GridView control from the Toolbox to `SimpleDisplay.aspx`'s design surface.</span></span> <span data-ttu-id="0ff95-160">В смарт-теге GridView выберите элемент управления ObjectDataSource, добавленный на шаге 1.</span><span class="sxs-lookup"><span data-stu-id="0ff95-160">From the GridView's smart tag, choose the ObjectDataSource control we added in Step 1.</span></span> <span data-ttu-id="0ff95-161">Это автоматически создаст BoundField в GridView для каждого свойства, возвращаемого данными из метода `Select` ObjectDataSource (а именно, свойства, определенные в таблице Products.).</span><span class="sxs-lookup"><span data-stu-id="0ff95-161">This will automatically create a BoundField in the GridView for each property returned by the data from the ObjectDataSource's `Select` method (namely, the properties defined by the Products DataTable).</span></span>

<span data-ttu-id="0ff95-162">[![элемент GridView добавлен на страницу и привязан к элементу управления ObjectDataSource](displaying-data-with-the-objectdatasource-vb/_static/image15.png)](displaying-data-with-the-objectdatasource-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="0ff95-162">[![A GridView Has Been Added to the Page and Bound to the ObjectDataSource](displaying-data-with-the-objectdatasource-vb/_static/image15.png)](displaying-data-with-the-objectdatasource-vb/_static/image14.png)</span></span>

<span data-ttu-id="0ff95-163">**Рис. 6**. элемент управления GridView добавлен на страницу и привязан к элементу ObjectDataSource ([щелкните, чтобы просмотреть изображение с полным размером](displaying-data-with-the-objectdatasource-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="0ff95-163">**Figure 6**: A GridView Has Been Added to the Page and Bound to the ObjectDataSource ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image16.png))</span></span>

<span data-ttu-id="0ff95-164">Затем можно настроить, изменить или удалить BoundFields GridView, щелкнув параметр Edit Columns (изменить столбцы) в смарт-теге.</span><span class="sxs-lookup"><span data-stu-id="0ff95-164">You can then customize, rearrange, or remove the GridView's BoundFields by clicking the Edit Columns option from the smart tag.</span></span>

<span data-ttu-id="0ff95-165">[![управления BoundFields GridView с помощью диалогового окна "изменение столбцов"](displaying-data-with-the-objectdatasource-vb/_static/image18.png)](displaying-data-with-the-objectdatasource-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="0ff95-165">[![Manage the GridView's BoundFields Through the Edit Columns Dialog Box](displaying-data-with-the-objectdatasource-vb/_static/image18.png)](displaying-data-with-the-objectdatasource-vb/_static/image17.png)</span></span>

<span data-ttu-id="0ff95-166">**Рис. 7**. Управление BoundFields GridView с помощью диалогового окна "изменение столбцов" ([щелкните, чтобы просмотреть изображение с полным размером](displaying-data-with-the-objectdatasource-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="0ff95-166">**Figure 7**: Manage the GridView's BoundFields Through the Edit Columns Dialog Box ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image19.png))</span></span>

<span data-ttu-id="0ff95-167">Уделите немного времени, чтобы изменить BoundFields GridView, удалив `ProductID`, `SupplierID`, `CategoryID`, `QuantityPerUnit`, `UnitsInStock`, `UnitsOnOrder`и `ReorderLevel` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="0ff95-167">Take a moment to modify the GridView's BoundFields, removing the `ProductID`, `SupplierID`, `CategoryID`, `QuantityPerUnit`, `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` BoundFields.</span></span> <span data-ttu-id="0ff95-168">Просто выберите BoundField из списка в левом нижнем углу и нажмите кнопку Удалить (красный значок X), чтобы удалить их.</span><span class="sxs-lookup"><span data-stu-id="0ff95-168">Simply select the BoundField from the list in the bottom left and click the delete button (the red X) to remove them.</span></span> <span data-ttu-id="0ff95-169">Затем измените расположение BoundFields, чтобы `CategoryName` и `SupplierName` BoundFields предшествовать `UnitPrice` BoundField, выбрав эти BoundFields и щелкнув стрелку вверх.</span><span class="sxs-lookup"><span data-stu-id="0ff95-169">Next, Rearrange the BoundFields so that the `CategoryName` and `SupplierName` BoundFields precede the `UnitPrice` BoundField by selecting these BoundFields and clicking the up arrow.</span></span> <span data-ttu-id="0ff95-170">Задайте для свойств `HeaderText` оставшихся BoundFields значения `Products`, `Category`, `Supplier`и `Price`соответственно.</span><span class="sxs-lookup"><span data-stu-id="0ff95-170">Set the `HeaderText` properties of the remaining BoundFields to `Products`, `Category`, `Supplier`, and `Price`, respectively.</span></span> <span data-ttu-id="0ff95-171">Затем по`Price` BoundField в формате валюты, задав для свойства `HtmlEncode` BoundField значение false, а для свойства `DataFormatString` значение `{0:c}`.</span><span class="sxs-lookup"><span data-stu-id="0ff95-171">Next, have the `Price` BoundField formatted as a currency by setting the BoundField's `HtmlEncode` property to False and its `DataFormatString` property to `{0:c}`.</span></span> <span data-ttu-id="0ff95-172">Наконец, выровняйте `Price` по правому краю и `Discontinued` флажок в центре через свойство `ItemStyle`/`HorizontalAlign`.</span><span class="sxs-lookup"><span data-stu-id="0ff95-172">Finally, horizontally align the `Price` to the right and the `Discontinued` checkbox in the center via the `ItemStyle`/`HorizontalAlign` property.</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="0ff95-173">[![были настроены BoundFields GridView](displaying-data-with-the-objectdatasource-vb/_static/image21.png)](displaying-data-with-the-objectdatasource-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="0ff95-173">[![The GridView's BoundFields Have Been Customized](displaying-data-with-the-objectdatasource-vb/_static/image21.png)](displaying-data-with-the-objectdatasource-vb/_static/image20.png)</span></span>

<span data-ttu-id="0ff95-174">**Рис. 8**. BoundFields GridView были настроены ([щелкните, чтобы просмотреть изображение с полным размером](displaying-data-with-the-objectdatasource-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="0ff95-174">**Figure 8**: The GridView's BoundFields Have Been Customized ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image22.png))</span></span>

## <a name="using-themes-for-a-consistent-look"></a><span data-ttu-id="0ff95-175">Использование тем для единообразного вида</span><span class="sxs-lookup"><span data-stu-id="0ff95-175">Using Themes for a Consistent Look</span></span>

<span data-ttu-id="0ff95-176">Эти учебники посвящены удалению любых параметров стиля уровня элемента управления, вместо этого при необходимости можно использовать каскадные таблицы стилей, определенные во внешнем файле.</span><span class="sxs-lookup"><span data-stu-id="0ff95-176">These tutorials strive to remove any control-level style settings, instead using cascading style sheets defined in an external file whenever possible.</span></span> <span data-ttu-id="0ff95-177">Файл `Styles.css` содержит классы CSS `DataWebControlStyle`, `HeaderStyle`, `RowStyle`и `AlternatingRowStyle`, которые следует использовать для диктовки внешнего вида веб-элементов управления данными, используемых в этих учебниках.</span><span class="sxs-lookup"><span data-stu-id="0ff95-177">The `Styles.css` file contains `DataWebControlStyle`, `HeaderStyle`, `RowStyle`, and `AlternatingRowStyle` CSS classes that should be used to dictate the appearance of the data Web controls used in these tutorials.</span></span> <span data-ttu-id="0ff95-178">Для этого можно задать для свойства `CssClass` GridView значение `DataWebControlStyle`, а также свойства `HeaderStyle`, `RowStyle`и `AlternatingRowStyle` свойства `CssClass` соответственно.</span><span class="sxs-lookup"><span data-stu-id="0ff95-178">To accomplish this, we could set the GridView's `CssClass` property to `DataWebControlStyle`, and its `HeaderStyle`, `RowStyle`, and `AlternatingRowStyle` properties' `CssClass` properties accordingly.</span></span>

<span data-ttu-id="0ff95-179">Если установить эти `CssClass` свойства в веб-элементе управления, нам нужно не забывать явно задавать значения этих свойств для каждого и каждого веб-элемента управления данными, добавляемых в наши руководства.</span><span class="sxs-lookup"><span data-stu-id="0ff95-179">If we set these `CssClass` properties at the Web control we'd need to remember to explicitly set these property values for each and every data Web control added to our tutorials.</span></span> <span data-ttu-id="0ff95-180">Более управляемый подход заключается в определении свойств, связанных с CSS по умолчанию для элементов управления GridView, DetailsView и FormView, с помощью темы.</span><span class="sxs-lookup"><span data-stu-id="0ff95-180">A more manageable approach is to define the default CSS-related properties for the GridView, DetailsView, and FormView controls using a Theme.</span></span> <span data-ttu-id="0ff95-181">Тема — это коллекция параметров свойств уровня элементов управления, изображений и классов CSS, которые можно применить к страницам на сайте для обеспечения общего внешнего вида и поведения.</span><span class="sxs-lookup"><span data-stu-id="0ff95-181">A Theme is a collection of control-level property settings, images, and CSS classes that can be applied to pages across a site to enforce a common look and feel.</span></span>

<span data-ttu-id="0ff95-182">Наша тема не будет включать изображения или файлы CSS (мы будем оставлять таблицу стилей `Styles.css` "как есть", определенную в корневой папке веб-приложения), но будет содержать две обложки.</span><span class="sxs-lookup"><span data-stu-id="0ff95-182">Our Theme won't include any images or CSS files (we'll leave the stylesheet `Styles.css` as-is, defined in the root folder of the web application), but will include two Skins.</span></span> <span data-ttu-id="0ff95-183">Обложка — это файл, который определяет свойства по умолчанию для веб-элемента управления.</span><span class="sxs-lookup"><span data-stu-id="0ff95-183">A Skin is a file that defines the default properties for a Web control.</span></span> <span data-ttu-id="0ff95-184">В частности, у нас будет файл обложки для элементов управления GridView и DetailsView, указывающий свойства, связанные с `CssClass`по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="0ff95-184">Specifically, we'll have a Skin file for the GridView and DetailsView controls, indicating the default `CssClass`-related properties.</span></span>

<span data-ttu-id="0ff95-185">Для начала добавьте новый файл обложки в проект с именем `GridView.skin`, щелкнув правой кнопкой мыши имя проекта в обозреватель решений и выбрав пункт Добавить новый элемент.</span><span class="sxs-lookup"><span data-stu-id="0ff95-185">Start by adding a new Skin File to your project named `GridView.skin` by right-clicking on the project name in the Solution Explorer and choosing Add New Item.</span></span>

<span data-ttu-id="0ff95-186">[![добавить файл обложки с именем GridView. Skin](displaying-data-with-the-objectdatasource-vb/_static/image24.png)](displaying-data-with-the-objectdatasource-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="0ff95-186">[![Add a Skin File Named GridView.skin](displaying-data-with-the-objectdatasource-vb/_static/image24.png)](displaying-data-with-the-objectdatasource-vb/_static/image23.png)</span></span>

<span data-ttu-id="0ff95-187">**Рис. 9**. Добавление файла обложки с именем `GridView.skin` ([щелкните, чтобы просмотреть изображение с полным размером](displaying-data-with-the-objectdatasource-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="0ff95-187">**Figure 9**: Add a Skin File Named `GridView.skin` ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image25.png))</span></span>

<span data-ttu-id="0ff95-188">Файлы обложки необходимо поместить в тему, расположенную в папке `App_Themes`.</span><span class="sxs-lookup"><span data-stu-id="0ff95-188">Skin files need to be placed in a Theme, which are located in the `App_Themes` folder.</span></span> <span data-ttu-id="0ff95-189">Так как у нас еще нет такой папки, Visual Studio будет предлагать создать ее для нас при добавлении нашей первой обложки.</span><span class="sxs-lookup"><span data-stu-id="0ff95-189">Since we don't yet have such a folder, Visual Studio will kindly offer to create one for us when adding our first Skin.</span></span> <span data-ttu-id="0ff95-190">Нажмите кнопку Да, чтобы создать папку `App_Theme` и поместить в нее новый файл `GridView.skin`.</span><span class="sxs-lookup"><span data-stu-id="0ff95-190">Click Yes to create the `App_Theme` folder and place the new `GridView.skin` file there.</span></span>

<span data-ttu-id="0ff95-191">[![позволить Visual Studio создать App_Theme папку](displaying-data-with-the-objectdatasource-vb/_static/image27.png)](displaying-data-with-the-objectdatasource-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="0ff95-191">[![Let Visual Studio Create the App_Theme Folder](displaying-data-with-the-objectdatasource-vb/_static/image27.png)](displaying-data-with-the-objectdatasource-vb/_static/image26.png)</span></span>

<span data-ttu-id="0ff95-192">**Рис. 10**. Разрешите Visual Studio создать папку `App_Theme` ([щелкните, чтобы просмотреть изображение с полным размером](displaying-data-with-the-objectdatasource-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="0ff95-192">**Figure 10**: Let Visual Studio Create the `App_Theme` Folder ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image28.png))</span></span>

<span data-ttu-id="0ff95-193">Будет создана новая тема в папке `App_Themes` с именем GridView с файлом обложки `GridView.skin`.</span><span class="sxs-lookup"><span data-stu-id="0ff95-193">This will create a new Theme in the `App_Themes` folder named GridView with the Skin file `GridView.skin`.</span></span>

![Тема GridView добавлена в папку App_Theme](displaying-data-with-the-objectdatasource-vb/_static/image29.png)

<span data-ttu-id="0ff95-195">**Рис. 11**. Тема GridView добавлена в папку `App_Theme`</span><span class="sxs-lookup"><span data-stu-id="0ff95-195">**Figure 11**: The GridView Theme has Been Added to the `App_Theme` Folder</span></span>

<span data-ttu-id="0ff95-196">Переименуйте тему GridView в WebControl (щелкните правой кнопкой мыши папку GridView в папке `App_Theme` и выберите пункт Переименовать).</span><span class="sxs-lookup"><span data-stu-id="0ff95-196">Rename the GridView Theme to DataWebControls (right-click on the GridView folder in the `App_Theme` folder and choose Rename).</span></span> <span data-ttu-id="0ff95-197">Затем введите в файл `GridView.skin` следующую разметку:</span><span class="sxs-lookup"><span data-stu-id="0ff95-197">Next, enter the following markup into the `GridView.skin` file:</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-vb/samples/sample3.aspx)]

<span data-ttu-id="0ff95-198">Это определяет свойства по умолчанию для свойств, связанных с `CssClass`, для любого элемента управления GridView на любой странице, использующей тему WebControl.</span><span class="sxs-lookup"><span data-stu-id="0ff95-198">This defines the default properties for the `CssClass`-related properties for any GridView in any page that uses the DataWebControls Theme.</span></span> <span data-ttu-id="0ff95-199">Давайте добавим еще одну обложку DetailsView, веб-элемент управления данными, который скоро будет использоваться.</span><span class="sxs-lookup"><span data-stu-id="0ff95-199">Let's add another Skin for the DetailsView, a data Web control that we'll be using shortly.</span></span> <span data-ttu-id="0ff95-200">Добавьте новую обложку в тему WebControl с именем `DetailsView.skin` и добавьте следующую разметку:</span><span class="sxs-lookup"><span data-stu-id="0ff95-200">Add a new Skin to the DataWebControls Theme named `DetailsView.skin` and add the following markup:</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-vb/samples/sample4.aspx)]

<span data-ttu-id="0ff95-201">После определения темы последним шагом является применение темы к нашей ASP.NET странице.</span><span class="sxs-lookup"><span data-stu-id="0ff95-201">With our Theme defined, the last step is to apply the Theme to our ASP.NET page.</span></span> <span data-ttu-id="0ff95-202">Тему можно применять к отдельным страницам или ко всем страницам на веб-сайте.</span><span class="sxs-lookup"><span data-stu-id="0ff95-202">A Theme can be applied on a page-by-page basis or for all pages in a website.</span></span> <span data-ttu-id="0ff95-203">Давайте будем использовать эту тему для всех страниц на веб-сайте.</span><span class="sxs-lookup"><span data-stu-id="0ff95-203">Let's use this theme for all pages in the website.</span></span> <span data-ttu-id="0ff95-204">Для этого добавьте следующую разметку в раздел `<system.web>` `Web.config`:</span><span class="sxs-lookup"><span data-stu-id="0ff95-204">To accomplish this, add the following markup to `Web.config`'s `<system.web>` section:</span></span>

[!code-xml[Main](displaying-data-with-the-objectdatasource-vb/samples/sample5.xml)]

<span data-ttu-id="0ff95-205">Вот и все!</span><span class="sxs-lookup"><span data-stu-id="0ff95-205">That's all there is to it!</span></span> <span data-ttu-id="0ff95-206">Параметр `styleSheetTheme` указывает, что свойства, заданные в теме, *не* должны переопределять свойства, заданные на уровне элемента управления.</span><span class="sxs-lookup"><span data-stu-id="0ff95-206">The `styleSheetTheme` setting indicates that the properties specified in the Theme should *not* override the properties specified at the control level.</span></span> <span data-ttu-id="0ff95-207">Чтобы указать, что параметры темы должны закозырить параметры управления, вместо `styleSheetTheme`используйте `theme` атрибут. к сожалению, параметры темы не отображаются в представление конструирования Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0ff95-207">To specify that Theme settings should trump control settings, use the `theme` attribute in place of `styleSheetTheme`; unfortunately, Theme settings do not appear in the Visual Studio Design view.</span></span> <span data-ttu-id="0ff95-208">Дополнительные сведения о темах и обложках см. в разделе [Общие сведения о темах и обложках ASP.NET](https://msdn.microsoft.com/library/ykzx33wh.aspx) и [стили на стороне сервера с помощью тем](https://quickstarts.asp.net/quickstartv20/aspnet/doc/themes/stylesheettheme.aspx) . Дополнительные сведения о настройке страницы для использования темы см. [в разделе Практические руководства. применение ASP.NET тем](https://msdn.microsoft.com/library/0yy5hxdk%28VS.80%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="0ff95-208">Refer to [ASP.NET Themes and Skins Overview](https://msdn.microsoft.com/library/ykzx33wh.aspx) and [Server-Side Styles Using Themes](https://quickstarts.asp.net/quickstartv20/aspnet/doc/themes/stylesheettheme.aspx) for more information on Themes and Skins; see [How To: Apply ASP.NET Themes](https://msdn.microsoft.com/library/0yy5hxdk%28VS.80%29.aspx) for more on configuring a page to use a theme.</span></span>

<span data-ttu-id="0ff95-209">[![элементе GridView отображаются название продукта, категория, поставщик, Цена и неподдерживаемые сведения.](displaying-data-with-the-objectdatasource-vb/_static/image31.png)](displaying-data-with-the-objectdatasource-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="0ff95-209">[![The GridView Displays the Product's Name, Category, Supplier, Price, and Discontinued Information](displaying-data-with-the-objectdatasource-vb/_static/image31.png)](displaying-data-with-the-objectdatasource-vb/_static/image30.png)</span></span>

<span data-ttu-id="0ff95-210">**Рис. 12**. Отображение имени продукта, категории, поставщика, цены и неподдерживаемой информации в элементе GridView ([щелкните, чтобы просмотреть изображение с полным размером](displaying-data-with-the-objectdatasource-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="0ff95-210">**Figure 12**: The GridView Displays the Product's Name, Category, Supplier, Price, and Discontinued Information ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image32.png))</span></span>

## <a name="displaying-one-record-at-a-time-in-the-detailsview"></a><span data-ttu-id="0ff95-211">Отображение одной записи за раз в элементе DetailsView</span><span class="sxs-lookup"><span data-stu-id="0ff95-211">Displaying One Record at a Time in the DetailsView</span></span>

<span data-ttu-id="0ff95-212">Элемент GridView отображает по одной строке для каждой записи, возвращенной элементом управления источником данных, к которому он привязан.</span><span class="sxs-lookup"><span data-stu-id="0ff95-212">The GridView displays one row for each record returned by the data source control to which it's bound.</span></span> <span data-ttu-id="0ff95-213">Однако бывают ситуации, когда нам нужно отобразить единственную запись или только одну запись за раз.</span><span class="sxs-lookup"><span data-stu-id="0ff95-213">There are times, however, when we may want to display a sole record or just one record at a time.</span></span> <span data-ttu-id="0ff95-214">[Элемент управления DetailsView](https://msdn.microsoft.com/library/s3w1w7t4.aspx) предлагает эту функцию, который готовится к просмотру как HTML-`<table>` с двумя столбцами и одной строкой для каждого столбца или свойства, привязанного к элементу управления.</span><span class="sxs-lookup"><span data-stu-id="0ff95-214">The [DetailsView control](https://msdn.microsoft.com/library/s3w1w7t4.aspx) offers this functionality, rendering as an HTML `<table>` with two columns and one row for each column or property bound to the control.</span></span> <span data-ttu-id="0ff95-215">Можно представить DetailsView как GridView с одной записью, повернутой на 90 градусов.</span><span class="sxs-lookup"><span data-stu-id="0ff95-215">You can think of the DetailsView as a GridView with a single record rotated 90 degrees.</span></span>

<span data-ttu-id="0ff95-216">Начните с добавления элемента управления DetailsView *над* GridView в `SimpleDisplay.aspx`.</span><span class="sxs-lookup"><span data-stu-id="0ff95-216">Start by adding a DetailsView control *above* the GridView in `SimpleDisplay.aspx`.</span></span> <span data-ttu-id="0ff95-217">Затем привяжите его к тому же элементу управления ObjectDataSource, что и GridView.</span><span class="sxs-lookup"><span data-stu-id="0ff95-217">Next, bind it to the same ObjectDataSource control as the GridView.</span></span> <span data-ttu-id="0ff95-218">Как и в GridView, BoundField будет добавлен к элементу DetailsView для каждого свойства в объекте, возвращаемом методом `Select` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0ff95-218">Like with the GridView, a BoundField will be added to the DetailsView for each property in the object returned by the ObjectDataSource's `Select` method.</span></span> <span data-ttu-id="0ff95-219">Единственное отличие заключается в том, что BoundFields DetailsView располагаются горизонтально, а не вертикально.</span><span class="sxs-lookup"><span data-stu-id="0ff95-219">The only difference is that the DetailsView's BoundFields are laid out horizontally rather than vertically.</span></span>

<span data-ttu-id="0ff95-220">[![добавить элемент DetailsView на страницу и привязать его к элементу управления ObjectDataSource](displaying-data-with-the-objectdatasource-vb/_static/image34.png)](displaying-data-with-the-objectdatasource-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="0ff95-220">[![Add a DetailsView to the Page and Bind it to the ObjectDataSource](displaying-data-with-the-objectdatasource-vb/_static/image34.png)](displaying-data-with-the-objectdatasource-vb/_static/image33.png)</span></span>

<span data-ttu-id="0ff95-221">**Рис. 13**. Добавление элемента DetailsView на страницу и привязка его к ObjectDataSource ([щелкните, чтобы просмотреть изображение с полным размером](displaying-data-with-the-objectdatasource-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="0ff95-221">**Figure 13**: Add a DetailsView to the Page and Bind it to the ObjectDataSource ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image35.png))</span></span>

<span data-ttu-id="0ff95-222">Как и GridView, BoundFields элемента DetailsView можно настроить таким образом, чтобы обеспечить более настраиваемое отображение данных, возвращаемых ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0ff95-222">Like the GridView, the DetailsView's BoundFields can be tweaked to provide a more customized display of the data returned by the ObjectDataSource.</span></span> <span data-ttu-id="0ff95-223">На рис. 14 показана DetailsView после того, как свойства BoundFields и `CssClass` были настроены таким образом, чтобы его внешний вид был похож на пример GridView.</span><span class="sxs-lookup"><span data-stu-id="0ff95-223">Figure 14 shows the DetailsView after its BoundFields and `CssClass` properties have been configured to make its appearance similar to the GridView example.</span></span>

<span data-ttu-id="0ff95-224">[![элемент DetailsView показывает одну запись](displaying-data-with-the-objectdatasource-vb/_static/image37.png)](displaying-data-with-the-objectdatasource-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="0ff95-224">[![The DetailsView Shows a Single Record](displaying-data-with-the-objectdatasource-vb/_static/image37.png)](displaying-data-with-the-objectdatasource-vb/_static/image36.png)</span></span>

<span data-ttu-id="0ff95-225">**Рис. 14**. элемент DetailsView отображает одну запись ([щелкните, чтобы просмотреть изображение с полным размером](displaying-data-with-the-objectdatasource-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="0ff95-225">**Figure 14**: The DetailsView Shows a Single Record ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image38.png))</span></span>

<span data-ttu-id="0ff95-226">Обратите внимание, что элемент DetailsView отображает только первую запись, возвращенную ее источником данных.</span><span class="sxs-lookup"><span data-stu-id="0ff95-226">Note that the DetailsView only displays the first record returned by its data source.</span></span> <span data-ttu-id="0ff95-227">Чтобы разрешить пользователю выполнять все записи по отдельности, необходимо включить разбиение по страницам DetailsView.</span><span class="sxs-lookup"><span data-stu-id="0ff95-227">To allow the user to step through all of the records, one at a time, we must enable paging for the DetailsView.</span></span> <span data-ttu-id="0ff95-228">Для этого вернитесь в Visual Studio и установите флажок Включить разбиение по страницам в смарт-теге DetailsView.</span><span class="sxs-lookup"><span data-stu-id="0ff95-228">To do so, return to Visual Studio and check the Enable Paging checkbox in the DetailsView's smart tag.</span></span>

<span data-ttu-id="0ff95-229">[![включить разбиение по страницам в элементе управления DetailsView](displaying-data-with-the-objectdatasource-vb/_static/image40.png)](displaying-data-with-the-objectdatasource-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="0ff95-229">[![Enable Paging in the DetailsView Control](displaying-data-with-the-objectdatasource-vb/_static/image40.png)](displaying-data-with-the-objectdatasource-vb/_static/image39.png)</span></span>

<span data-ttu-id="0ff95-230">**Рис. 15**. Включение разбиения по страницам в элементе управления DetailsView ([щелкните, чтобы просмотреть изображение с полным размером](displaying-data-with-the-objectdatasource-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="0ff95-230">**Figure 15**: Enable Paging in the DetailsView Control ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image41.png))</span></span>

<span data-ttu-id="0ff95-231">[![с включенным разбиением на страницы DetailsView позволяет пользователю просматривать любой из продуктов.](displaying-data-with-the-objectdatasource-vb/_static/image43.png)](displaying-data-with-the-objectdatasource-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="0ff95-231">[![With Paging Enabled, the DetailsView Allows the User to View Any of the Products](displaying-data-with-the-objectdatasource-vb/_static/image43.png)](displaying-data-with-the-objectdatasource-vb/_static/image42.png)</span></span>

<span data-ttu-id="0ff95-232">**Рис. 16**. при включенном разбиении по страницам DetailsView позволяет пользователю просматривать любой из продуктов ([щелкните, чтобы просмотреть изображение с полным размером](displaying-data-with-the-objectdatasource-vb/_static/image44.png)).</span><span class="sxs-lookup"><span data-stu-id="0ff95-232">**Figure 16**: With Paging Enabled, the DetailsView Allows the User to View Any of the Products ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image44.png))</span></span>

<span data-ttu-id="0ff95-233">Дополнительные сведения о разбиении на страницы см. в следующих руководствах.</span><span class="sxs-lookup"><span data-stu-id="0ff95-233">We'll talk more about paging in future tutorials.</span></span>

## <a name="a-more-flexible-layout-for-showing-one-record-at-a-time"></a><span data-ttu-id="0ff95-234">Более гибкий макет для отображения одной записи за раз</span><span class="sxs-lookup"><span data-stu-id="0ff95-234">A More Flexible Layout for Showing One Record at a Time</span></span>

<span data-ttu-id="0ff95-235">Элемент DetailsView очень жестко показывает, как он отображает каждую запись, возвращенную из ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0ff95-235">The DetailsView is pretty rigid in how it displays each record returned from the ObjectDataSource.</span></span> <span data-ttu-id="0ff95-236">Нам может потребоваться более гибкое представление данных.</span><span class="sxs-lookup"><span data-stu-id="0ff95-236">We may want a more flexible view of the data.</span></span> <span data-ttu-id="0ff95-237">Например, вместо отображения названия продукта, категории, поставщика, цены и сведений о неподдерживаемой информации в отдельной строке нам может потребоваться показать название и цену продукта в заголовке `<h4>`, а сведения о категории и поставщике отображаются под названием и ценой меньшего размера шрифта.</span><span class="sxs-lookup"><span data-stu-id="0ff95-237">For example, rather than showing the product's name, category, supplier, price, and discontinued information each on a separate row, we may want to show the product name and price in an `<h4>` heading, with the category and supplier information appearing below the name and price in a smaller font size.</span></span> <span data-ttu-id="0ff95-238">И мы можем не позаботиться о названиях свойств (продукт, Категория и т. д.) рядом со значениями.</span><span class="sxs-lookup"><span data-stu-id="0ff95-238">And we may not care to show the property names (Product, Category, and so on) next to the values.</span></span>

<span data-ttu-id="0ff95-239">[Элемент управления FormView](https://msdn.microsoft.com/library/fyf1dk77.aspx) обеспечивает этот уровень настройки.</span><span class="sxs-lookup"><span data-stu-id="0ff95-239">The [FormView control](https://msdn.microsoft.com/library/fyf1dk77.aspx) provides this level of customization.</span></span> <span data-ttu-id="0ff95-240">Вместо использования полей (таких как GridView и DetailsView), FormView использует шаблоны, которые позволяют использовать сочетание веб-элементов управления, статического HTML и [синтаксиса привязки данных](http://www.15seconds.com/issue/040630.htm).</span><span class="sxs-lookup"><span data-stu-id="0ff95-240">Rather than using fields (like the GridView and DetailsView do), the FormView uses templates, which allow for a mix of Web controls, static HTML, and [databinding syntax](http://www.15seconds.com/issue/040630.htm).</span></span> <span data-ttu-id="0ff95-241">Если вы знакомы с элементом управления Repeater из ASP.NET 1. x, вы можете представить FormView как Repeater для отображения одной записи.</span><span class="sxs-lookup"><span data-stu-id="0ff95-241">If you are familiar with the Repeater control from ASP.NET 1.x, you can think of the FormView as the Repeater for showing a single record.</span></span>

<span data-ttu-id="0ff95-242">Добавление элемента управления FormView в рабочую область конструктора `SimpleDisplay.aspx` страницы.</span><span class="sxs-lookup"><span data-stu-id="0ff95-242">Add a FormView control to the `SimpleDisplay.aspx` page's design surface.</span></span> <span data-ttu-id="0ff95-243">Изначально FormView отображается в виде серого блока, что информирует нас о том, что необходимо предоставить, как минимум, `ItemTemplate`элемента управления.</span><span class="sxs-lookup"><span data-stu-id="0ff95-243">Initially the FormView displays as a gray block, informing us that we need to provide, at minimum, the control's `ItemTemplate`.</span></span>

<span data-ttu-id="0ff95-244">[![FormView должен включать ItemTemplate](displaying-data-with-the-objectdatasource-vb/_static/image46.png)](displaying-data-with-the-objectdatasource-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="0ff95-244">[![The FormView Must Include an ItemTemplate](displaying-data-with-the-objectdatasource-vb/_static/image46.png)](displaying-data-with-the-objectdatasource-vb/_static/image45.png)</span></span>

<span data-ttu-id="0ff95-245">**Рис. 17**. элемент FormView должен включать `ItemTemplate` ([щелкните, чтобы просмотреть изображение с полным размером](displaying-data-with-the-objectdatasource-vb/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="0ff95-245">**Figure 17**: The FormView Must Include an `ItemTemplate` ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image47.png))</span></span>

<span data-ttu-id="0ff95-246">Можно привязать FormView непосредственно к элементу управления источника данных с помощью смарт-тега FormView, который автоматически создает `ItemTemplate` по умолчанию (вместе с `EditItemTemplate` и `InsertItemTemplate`, если заданы свойства `InsertMethod` и `UpdateMethod` элемента управления ObjectDataSource).</span><span class="sxs-lookup"><span data-stu-id="0ff95-246">You can bind the FormView directly to a data source control through the FormView's smart tag, which will create a default `ItemTemplate` automatically (along with an `EditItemTemplate` and `InsertItemTemplate`, if the ObjectDataSource control's `InsertMethod` and `UpdateMethod` properties are set).</span></span> <span data-ttu-id="0ff95-247">Однако в этом примере мы выполним привязку данных к FormView и указываем его `ItemTemplate` вручную.</span><span class="sxs-lookup"><span data-stu-id="0ff95-247">However, for this example let's bind the data to the FormView and specify its `ItemTemplate` manually.</span></span> <span data-ttu-id="0ff95-248">Начните с установки свойства `DataSourceID` FormView в `ID` элемента управления ObjectDataSource `ObjectDataSource1`.</span><span class="sxs-lookup"><span data-stu-id="0ff95-248">Start by setting the FormView's `DataSourceID` property to the `ID` of the ObjectDataSource control, `ObjectDataSource1`.</span></span> <span data-ttu-id="0ff95-249">Затем создайте `ItemTemplate` таким образом, чтобы он отображал название и цену продукта в `<h4>` элементе, а названия категорий и грузоотправителей под меньшим размером шрифта.</span><span class="sxs-lookup"><span data-stu-id="0ff95-249">Next, create the `ItemTemplate` so that it displays the product's name and price in an `<h4>` element and the category and shipper names beneath that in a smaller font size.</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-vb/samples/sample6.aspx)]

<span data-ttu-id="0ff95-250">[![первый продукт (Chai) отображается в пользовательском формате](displaying-data-with-the-objectdatasource-vb/_static/image49.png)](displaying-data-with-the-objectdatasource-vb/_static/image48.png)</span><span class="sxs-lookup"><span data-stu-id="0ff95-250">[![The First Product (Chai) is Displayed in a Custom Format](displaying-data-with-the-objectdatasource-vb/_static/image49.png)](displaying-data-with-the-objectdatasource-vb/_static/image48.png)</span></span>

<span data-ttu-id="0ff95-251">**Рис. 18**. первый продукт (Chai) отображается в настраиваемом формате ([щелкните, чтобы просмотреть изображение с полным размером](displaying-data-with-the-objectdatasource-vb/_static/image50.png))</span><span class="sxs-lookup"><span data-stu-id="0ff95-251">**Figure 18**: The First Product (Chai) is Displayed in a Custom Format ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image50.png))</span></span>

<span data-ttu-id="0ff95-252">`<%# Eval(propertyName) %>` является синтаксисом привязки данных.</span><span class="sxs-lookup"><span data-stu-id="0ff95-252">The `<%# Eval(propertyName) %>` is the databinding syntax.</span></span> <span data-ttu-id="0ff95-253">Метод `Eval` возвращает значение указанного свойства для текущего объекта, привязанного к элементу управления FormView.</span><span class="sxs-lookup"><span data-stu-id="0ff95-253">The `Eval` method returns the value of the specified property for the current object being bound to the FormView control.</span></span> <span data-ttu-id="0ff95-254">Ознакомьтесь со статьей об [упрощенном и расширенном синтаксисе привязки данных в ASP.NET 2,0](http://www.15seconds.com/issue/040630.htm) , чтобы получить дополнительные сведения о Homer данных.</span><span class="sxs-lookup"><span data-stu-id="0ff95-254">Check out Alex Homer's article [Simplified and Extended Data Binding Syntax in ASP.NET 2.0](http://www.15seconds.com/issue/040630.htm) for more information on the ins and outs of databinding.</span></span>

<span data-ttu-id="0ff95-255">Как и DetailsView, FormView показывает только первую запись, возвращенную из ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0ff95-255">Like the DetailsView, the FormView only shows the first record returned from the ObjectDataSource.</span></span> <span data-ttu-id="0ff95-256">Можно включить разбиение по страницам в FormView, чтобы посетители могли пошагово прокручивать продукты по одному за раз.</span><span class="sxs-lookup"><span data-stu-id="0ff95-256">You can enable paging in the FormView to allow visitors to step through the products one at a time.</span></span>

## <a name="summary"></a><span data-ttu-id="0ff95-257">Сводка</span><span class="sxs-lookup"><span data-stu-id="0ff95-257">Summary</span></span>

<span data-ttu-id="0ff95-258">Доступ к данным уровня бизнес-логики и их отображение могут осуществляться без написания строки кода благодаря элементу управления ObjectDataSource в ASP.NET 2.0.</span><span class="sxs-lookup"><span data-stu-id="0ff95-258">Accessing and displaying data from a Business Logic Layer can be accomplished without writing a line of code thanks to ASP.NET 2.0's ObjectDataSource control.</span></span> <span data-ttu-id="0ff95-259">ObjectDataSource вызывает указанный метод класса и возвращает результаты.</span><span class="sxs-lookup"><span data-stu-id="0ff95-259">The ObjectDataSource invokes a specified method of a class and returns the results.</span></span> <span data-ttu-id="0ff95-260">Эти результаты могут отображаться в веб-элементе управления данными, привязанном к ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0ff95-260">These results can be displayed in a data Web control that's bound to the ObjectDataSource.</span></span> <span data-ttu-id="0ff95-261">В этом учебнике мы рассматривали привязку элементов управления GridView, DetailsView и FormView к элементу ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="0ff95-261">In this tutorial we looked at binding the GridView, DetailsView, and FormView controls to the ObjectDataSource.</span></span>

<span data-ttu-id="0ff95-262">До сих пор мы видели, как использовать ObjectDataSource для вызова метода без параметров, но что если бы мы хотим вызвать метод, который предполагает ввод входных параметров, например `GetProductsByCategoryID(categoryID)`класса `ProductBLL`?</span><span class="sxs-lookup"><span data-stu-id="0ff95-262">So far we've only seen how to use the ObjectDataSource to invoke a parameter-less method, but what if we want to invoke a method that expects input parameters, such as the `ProductBLL` class's `GetProductsByCategoryID(categoryID)`?</span></span> <span data-ttu-id="0ff95-263">Чтобы вызвать метод, который ожидает один или несколько параметров, необходимо настроить ObjectDataSource для указания значений этих параметров.</span><span class="sxs-lookup"><span data-stu-id="0ff95-263">In order to call a method that expects one or more parameters we must configure the ObjectDataSource to specify the values for these parameters.</span></span> <span data-ttu-id="0ff95-264">Мы посмотрим, как это сделать в [следующем руководстве](declarative-parameters-vb.md).</span><span class="sxs-lookup"><span data-stu-id="0ff95-264">We'll see how to accomplish this in our [next tutorial](declarative-parameters-vb.md).</span></span>

<span data-ttu-id="0ff95-265">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="0ff95-265">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="0ff95-266">Дополнительные сведения</span><span class="sxs-lookup"><span data-stu-id="0ff95-266">Further Reading</span></span>

<span data-ttu-id="0ff95-267">Дополнительные сведения о разделах, обсуждаемых в этом руководстве, см. в следующих ресурсах:</span><span class="sxs-lookup"><span data-stu-id="0ff95-267">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="0ff95-268">Создание собственных элементов управления источниками данных</span><span class="sxs-lookup"><span data-stu-id="0ff95-268">Create Your Own Data Source Controls</span></span>](https://msdn.microsoft.com/library/ms364049.aspx)
- [<span data-ttu-id="0ff95-269">Примеры GridView для ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="0ff95-269">GridView Examples for ASP.NET 2.0</span></span>](https://msdn.microsoft.com/library/aa479339.aspx)
- [<span data-ttu-id="0ff95-270">Упрощенный и расширенный синтаксис привязки данных в ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="0ff95-270">Simplified and Extended Data Binding Syntax in ASP.NET 2.0</span></span>](http://www.15seconds.com/issue/040630.htm)
- [<span data-ttu-id="0ff95-271">Темы в ASP.NET 2,0</span><span class="sxs-lookup"><span data-stu-id="0ff95-271">Themes in ASP.NET 2.0</span></span>](http://www.odetocode.com/Articles/423.aspx)
- [<span data-ttu-id="0ff95-272">Стили на стороне сервера, использующие темы</span><span class="sxs-lookup"><span data-stu-id="0ff95-272">Server-Side Styles Using Themes</span></span>](https://quickstarts.asp.net/quickstartv20/aspnet/doc/themes/stylesheettheme.aspx)
- [<span data-ttu-id="0ff95-273">Как программно применить темы ASP.NET</span><span class="sxs-lookup"><span data-stu-id="0ff95-273">How To: Apply ASP.NET Themes Programmatically</span></span>](https://msdn.microsoft.com/library/tx35bd89.aspx)

## <a name="about-the-author"></a><span data-ttu-id="0ff95-274">Об авторе</span><span class="sxs-lookup"><span data-stu-id="0ff95-274">About the Author</span></span>

<span data-ttu-id="0ff95-275">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="0ff95-275">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0ff95-276">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="0ff95-276">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0ff95-277">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="0ff95-277">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0ff95-278">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0ff95-278">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="0ff95-279">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="0ff95-279">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="0ff95-280">Специальная благодарность</span><span class="sxs-lookup"><span data-stu-id="0ff95-280">Special Thanks To</span></span>

<span data-ttu-id="0ff95-281">Эта серия руководств была рассмотрена многими полезными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="0ff95-281">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="0ff95-282">Специалист по интересу для этого руководства был Хилтон Гизнау.</span><span class="sxs-lookup"><span data-stu-id="0ff95-282">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="0ff95-283">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="0ff95-283">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="0ff95-284">Если это так, расположите строку в [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="0ff95-284">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0ff95-285">[Назад](programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)
> [Вперед](declarative-parameters-vb.md)</span><span class="sxs-lookup"><span data-stu-id="0ff95-285">[Previous](programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)
[Next](declarative-parameters-vb.md)</span></span>
