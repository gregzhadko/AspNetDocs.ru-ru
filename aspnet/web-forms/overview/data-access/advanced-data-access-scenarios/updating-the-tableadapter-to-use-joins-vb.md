---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
title: Обновление адаптера таблицы для использования JOIN (Visual Basic) | Документация Майкрософт
author: rick-anderson
description: При работе с базой данных, довольно часто запрашивать данные, которые распределены по нескольким таблицам. Для получения данных из двух различных таблиц можно использовать любой...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: e624a3e0-061b-4efc-8b0e-5877f9ff6714
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
msc.type: authoredcontent
ms.openlocfilehash: d5a7b61d447631f5e65ca8a3dfac9c58c108643f
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/01/2019
ms.locfileid: "57048541"
---
<a name="updating-the-tableadapter-to-use-joins-vb"></a><span data-ttu-id="8a05a-104">Обновление адаптера таблицы TableAdapter для использования JOIN (VB)</span><span class="sxs-lookup"><span data-stu-id="8a05a-104">Updating the TableAdapter to Use JOINs (VB)</span></span>
====================
<span data-ttu-id="8a05a-105">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="8a05a-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8a05a-106">[Скачать код](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) или [скачать PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="8a05a-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span></span>

> <span data-ttu-id="8a05a-107">При работе с базой данных, довольно часто запрашивать данные, которые распределены по нескольким таблицам.</span><span class="sxs-lookup"><span data-stu-id="8a05a-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="8a05a-108">Для получения данных из двух различных таблиц можно использовать операцию СОЕДИНЕНИЯ или коррелированные вложенные запросы.</span><span class="sxs-lookup"><span data-stu-id="8a05a-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="8a05a-109">В этом руководстве мы сравнение коррелированные вложенные запросы и синтаксис JOIN перед тем как рассмотреть способ создания, включающий ОБЪЕДИНЕНИЕ в его основного запроса адаптера таблицы.</span><span class="sxs-lookup"><span data-stu-id="8a05a-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>


## <a name="introduction"></a><span data-ttu-id="8a05a-110">Вступление</span><span class="sxs-lookup"><span data-stu-id="8a05a-110">Introduction</span></span>

<span data-ttu-id="8a05a-111">С реляционными базами данных данные, которые мы заинтересованы в работе с часто распределены по нескольким таблицам.</span><span class="sxs-lookup"><span data-stu-id="8a05a-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="8a05a-112">Например если отображение информации о продукте мы скорее всего требуется перечислить каждой соответствующей категории s продукта и имен поставщиков s.</span><span class="sxs-lookup"><span data-stu-id="8a05a-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="8a05a-113">`Products` Таблица имеет `CategoryID` и `SupplierID` значения, но фактическое имя, категорию и поставщика находятся в `Categories` и `Suppliers` таблицы, соответственно.</span><span class="sxs-lookup"><span data-stu-id="8a05a-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="8a05a-114">Чтобы получить данные из другой, связанные таблицы, мы может либо использовать *коррелированных вложенных запросах* или `JOIN` *s*.</span><span class="sxs-lookup"><span data-stu-id="8a05a-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="8a05a-115">Коррелированные вложенные запросы — это вложенный `SELECT` запрос, который ссылается на столбцы во внешнем запросе.</span><span class="sxs-lookup"><span data-stu-id="8a05a-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="8a05a-116">Например, в [создание уровня доступа к данным](../introduction/creating-a-data-access-layer-vb.md) руководстве мы использовали двух коррелированных запросов осуществляется в `ProductsTableAdapter` s основного запроса для возвращения имен категорию и поставщика для каждого продукта.</span><span class="sxs-lookup"><span data-stu-id="8a05a-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="8a05a-117">Объект `JOIN` SQL конструкция, которая объединяет связанные строки из двух различных таблиц.</span><span class="sxs-lookup"><span data-stu-id="8a05a-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="8a05a-118">Мы использовали `JOIN` в [запрос данных с помощью элемента управления SqlDataSource](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) руководству, чтобы отобразить сведения о категории наряду с каждого продукта.</span><span class="sxs-lookup"><span data-stu-id="8a05a-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="8a05a-119">Причина, мы abstained с помощью `JOIN` s с помощью адаптеров таблиц — из-за ограничений в мастере адаптера таблицы s автоматически создает соответствующий `INSERT`, `UPDATE`, и `DELETE` инструкций.</span><span class="sxs-lookup"><span data-stu-id="8a05a-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="8a05a-120">В частности при наличии основного запроса адаптера таблицы s `JOIN` s, TableAdapter не может автоматически создавать специализированные инструкции SQL или хранимые процедуры для его `InsertCommand`, `UpdateCommand`, и `DeleteCommand` свойства.</span><span class="sxs-lookup"><span data-stu-id="8a05a-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="8a05a-121">В этом руководстве мы кратко сравнивает и контрастности коррелированных вложенных запросах и `JOIN` s перед изучением Создание TableAdapter, который включает в себя `JOIN` s в его основной запрос.</span><span class="sxs-lookup"><span data-stu-id="8a05a-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="8a05a-122">Сравнивает и противопоставляет коррелированных вложенных запросах и`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="8a05a-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="8a05a-123">Помните, что `ProductsTableAdapter` создана в первом учебнике `Northwind` набор данных использует коррелированные вложенные запросы, чтобы вернуть каждый s соответствующий категорию и поставщика название продукта.</span><span class="sxs-lookup"><span data-stu-id="8a05a-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="8a05a-124">`ProductsTableAdapter` s основного запроса приведен ниже.</span><span class="sxs-lookup"><span data-stu-id="8a05a-124">The `ProductsTableAdapter` s main query is shown below.</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample1.sql)]

<span data-ttu-id="8a05a-125">Двух коррелированных запросов - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` и `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` -являются `SELECT` запросы, которые возвращают одно значение каждого продукта в качестве дополнительного столбца во внешнем `SELECT` списке столбцов инструкции s.</span><span class="sxs-lookup"><span data-stu-id="8a05a-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="8a05a-126">Кроме того `JOIN` может использоваться для получения имени поставщика и категории каждого продукта s.</span><span class="sxs-lookup"><span data-stu-id="8a05a-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="8a05a-127">Следующий запрос возвращает такие же выходные данные, что и выше, но использует `JOIN` s вместо вложенных запросов:</span><span class="sxs-lookup"><span data-stu-id="8a05a-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample2.sql)]

<span data-ttu-id="8a05a-128">Объект `JOIN` объединяет записи из одной таблицы с записями из другой таблицы, на основе определенных критериев.</span><span class="sxs-lookup"><span data-stu-id="8a05a-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="8a05a-129">В запросе выше, к примеру `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` сообщает SQL Server для слияния каждой записи продукта с категорией записи, которой `CategoryID` значение соответствует продукт s `CategoryID` значение.</span><span class="sxs-lookup"><span data-stu-id="8a05a-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="8a05a-130">Результаты слияния позволяет нам работать с в соответствующие поля категории для каждого продукта (такие как `CategoryName`).</span><span class="sxs-lookup"><span data-stu-id="8a05a-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="8a05a-131">`JOIN` s обычно используются при запросе данных из реляционных баз данных.</span><span class="sxs-lookup"><span data-stu-id="8a05a-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="8a05a-132">Если вы не знакомы с `JOIN` синтаксис или нужно немного освежить по его использованию, d рекомендую [SQL Join руководстве](http://www.w3schools.com/sql/sql_join.asp) в [W3 Schools](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="8a05a-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="8a05a-133">Также следует ознакомиться, [ `JOIN` основы](https://msdn.microsoft.com/library/ms191517.aspx) и [запросах](https://msdn.microsoft.com/library/ms189575.aspx) разделы [документации по SQL](https://msdn.microsoft.com/library/ms130214.aspx).</span><span class="sxs-lookup"><span data-stu-id="8a05a-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>


<span data-ttu-id="8a05a-134">Так как `JOIN` s коррелированные вложенные запросы могут совместно использовать и извлекать данные из других таблиц, многие разработчики, остаются головой (Joe weinman) и хотите узнать, какие подходы использовать.</span><span class="sxs-lookup"><span data-stu-id="8a05a-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="8a05a-135">Все SQL гуру я ve говорили, что примерно то же самое, что он t важны с точки как SQL Server будет создавать планы выполнения примерно идентичны.</span><span class="sxs-lookup"><span data-stu-id="8a05a-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="8a05a-136">Их рекомендации будет используйте технику, вам и вашей группе наиболее удобен.</span><span class="sxs-lookup"><span data-stu-id="8a05a-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="8a05a-137">Он заслуживает отметить, что после imparting этому совету экспертам немедленно express свои предпочтения `JOIN` s через коррелированные вложенные запросы.</span><span class="sxs-lookup"><span data-stu-id="8a05a-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="8a05a-138">При создании слой доступа к данным, использующего типизированные наборы DataSet, инструменты работают лучше при использовании вложенных запросов.</span><span class="sxs-lookup"><span data-stu-id="8a05a-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="8a05a-139">В частности, мастер TableAdapter s не автоматически создаст соответствующий `INSERT`, `UPDATE`, и `DELETE` инструкции, если основной запрос содержит любые `JOIN` s, но будет автоматически создавать эти инструкции, если корреляции вложенные запросы используются.</span><span class="sxs-lookup"><span data-stu-id="8a05a-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="8a05a-140">Чтобы изучить этот недостаток, создание временных типизированный набор DataSet в `~/App_Code/DAL` папку.</span><span class="sxs-lookup"><span data-stu-id="8a05a-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="8a05a-141">При работе с мастером настройки адаптера таблицы решили использовать специализированные инструкции SQL и введите следующую `SELECT` запроса (см. рис. 1):</span><span class="sxs-lookup"><span data-stu-id="8a05a-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample3.sql)]


<span data-ttu-id="8a05a-142">[![Введите основной запрос, который содержит соединения](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="8a05a-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span></span>

<span data-ttu-id="8a05a-143">**Рис. 1**: Введите запрос Main, который содержит `JOIN` s ([Просмотр полноразмерного изображения](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="8a05a-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span></span>


<span data-ttu-id="8a05a-144">По умолчанию, автоматически создаст TableAdapter `INSERT`, `UPDATE`, и `DELETE` инструкций на основе основного запроса.</span><span class="sxs-lookup"><span data-stu-id="8a05a-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="8a05a-145">Если нажать кнопку «Дополнительно», вы увидите, что эта функция включена.</span><span class="sxs-lookup"><span data-stu-id="8a05a-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="8a05a-146">Несмотря на этот параметр TableAdapter будет невозможно создать `INSERT`, `UPDATE`, и `DELETE` инструкции так, как основной запрос содержит `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="8a05a-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>


![Введите основной запрос, который содержит соединения](updating-the-tableadapter-to-use-joins-vb/_static/image4.png)

<span data-ttu-id="8a05a-148">**Рис. 2**: Введите основной запрос, который содержит `JOIN` s</span><span class="sxs-lookup"><span data-stu-id="8a05a-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>


<span data-ttu-id="8a05a-149">Нажмите кнопку Готово, чтобы завершить работу мастера.</span><span class="sxs-lookup"><span data-stu-id="8a05a-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="8a05a-150">На этом этапе ваш набор данных s конструктор будет включать одним адаптером TableAdapter с объект DataTable со столбцами для каждого из полей, возвращаемых в `SELECT` списка столбца запроса s.</span><span class="sxs-lookup"><span data-stu-id="8a05a-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="8a05a-151">Сюда входят `CategoryName` и `SupplierName`, как показано на рис. 3.</span><span class="sxs-lookup"><span data-stu-id="8a05a-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>


![Объект DataTable со столбцом для каждого поля, возвращаемые в списке столбцов](updating-the-tableadapter-to-use-joins-vb/_static/image5.png)

<span data-ttu-id="8a05a-153">**Рис. 3**: Объект DataTable со столбцом для каждого поля, возвращаемые в списке столбцов</span><span class="sxs-lookup"><span data-stu-id="8a05a-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>


<span data-ttu-id="8a05a-154">Хотя объект DataTable есть соответствующие столбцы, TableAdapter отсутствуют значения для его `InsertCommand`, `UpdateCommand`, и `DeleteCommand` свойства.</span><span class="sxs-lookup"><span data-stu-id="8a05a-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="8a05a-155">Чтобы проверить это, щелкните TableAdapter в конструкторе и перейдите в окно свойств.</span><span class="sxs-lookup"><span data-stu-id="8a05a-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="8a05a-156">Там вы увидите, что `InsertCommand`, `UpdateCommand`, и `DeleteCommand` задано значение (None).</span><span class="sxs-lookup"><span data-stu-id="8a05a-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>


<span data-ttu-id="8a05a-157">[![InsertCommand, UpdateCommand и DeleteCommand свойства задаются (нет)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="8a05a-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span></span>

<span data-ttu-id="8a05a-158">**Рис. 4**: `InsertCommand`, `UpdateCommand`, И `DeleteCommand` свойств (нет) ([Просмотр полноразмерного изображения](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="8a05a-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span></span>


<span data-ttu-id="8a05a-159">Чтобы обойти этот недостаток, мы можно вручную указать инструкций SQL и параметры для `InsertCommand`, `UpdateCommand`, и `DeleteCommand` свойств с помощью окна «Свойства».</span><span class="sxs-lookup"><span data-stu-id="8a05a-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="8a05a-160">Может в качестве альтернативы мы начнем с настройки адаптера таблицы s основного запроса к *не* , содержащие любые `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="8a05a-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="8a05a-161">Таким образом, `INSERT`, `UPDATE`, и `DELETE` инструкции, чтобы автоматически создавать для нас.</span><span class="sxs-lookup"><span data-stu-id="8a05a-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="8a05a-162">После завершения работы мастера, мы может затем вручную обновите TableAdapter s `SelectCommand` из окна свойств, чтобы он включал `JOIN` синтаксис.</span><span class="sxs-lookup"><span data-stu-id="8a05a-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="8a05a-163">Хотя этот подход работает, это очень значительно усложняло работу при использовании ad-hoc-запросов SQL, так как в основном запросе s TableAdapter в любое время, повторно настроить в мастере, автоматически созданные `INSERT`, `UPDATE`, и `DELETE` инструкций создаются повторно.</span><span class="sxs-lookup"><span data-stu-id="8a05a-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="8a05a-164">Это означает, что все мы впоследствии присвоить пользовательские настройки будут потеряны, если мы щелкнули правой кнопкой мыши в TableAdapter, выбрали Настройка из контекстного меню и завершения работы мастера снова.</span><span class="sxs-lookup"><span data-stu-id="8a05a-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="8a05a-165">Хрупкости s TableAdapter, который автоматически генерируемым `INSERT`, `UPDATE`, и `DELETE` инструкций является, к счастью, ограничен специализированные инструкции SQL.</span><span class="sxs-lookup"><span data-stu-id="8a05a-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="8a05a-166">Если TableAdapter использует хранимые процедуры, можно настроить `SelectCommand`, `InsertCommand`, `UpdateCommand`, или `DeleteCommand` хранимые процедуры и повторно запустите мастер настройки адаптера таблицы без необходимости бояться, что хранимые процедуры будут изменить.</span><span class="sxs-lookup"><span data-stu-id="8a05a-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="8a05a-167">Следующие несколько шагов, мы создадим адаптер таблицы, изначально использует основной запрос, который пропускает любые `JOIN` s таким образом, чтобы соответствующий вставки, обновления и удаления хранимых процедур будут создаваться автоматически.</span><span class="sxs-lookup"><span data-stu-id="8a05a-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="8a05a-168">Затем мы обновим `SelectCommand` таким образом, использующий `JOIN` , возвращает дополнительные столбцы из связанных таблиц.</span><span class="sxs-lookup"><span data-stu-id="8a05a-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="8a05a-169">Наконец мы создадим соответствующий класс уровня бизнес-логики и демонстрируют использование TableAdapter в веб-страницу ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8a05a-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="8a05a-170">Шаг 1. Создание с помощью упрощенного основного запроса адаптера таблицы</span><span class="sxs-lookup"><span data-stu-id="8a05a-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="8a05a-171">В этом руководстве мы добавим TableAdapter и DataTable со строгой типизацией для `Employees` в таблицу `NorthwindWithSprocs` набора данных.</span><span class="sxs-lookup"><span data-stu-id="8a05a-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="8a05a-172">`Employees` Таблица содержит `ReportsTo` поле, которое указано `EmployeeID` диспетчера сотрудника s.</span><span class="sxs-lookup"><span data-stu-id="8a05a-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="8a05a-173">Например, сотрудник, Петров Anne имеет `ReportTo` значение 5, которое равно `EmployeeID` из Стивен Иванов.</span><span class="sxs-lookup"><span data-stu-id="8a05a-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="8a05a-174">Следовательно Anne сообщает Стивен, ее Менеджер.</span><span class="sxs-lookup"><span data-stu-id="8a05a-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="8a05a-175">А также отчеты каждому сотруднику s `ReportsTo` значение, мы может также потребоваться извлечения имени записью их менеджера.</span><span class="sxs-lookup"><span data-stu-id="8a05a-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="8a05a-176">Это можно сделать с помощью `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="8a05a-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="8a05a-177">Однако применение `JOIN` при первоначальном создании TableAdapter исключает возможность мастера автоматического создания соответствующих вставки, обновления и удаления возможности.</span><span class="sxs-lookup"><span data-stu-id="8a05a-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="8a05a-178">Таким образом, мы начнем с создания адаптера таблицы, основного запроса не содержит `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="8a05a-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="8a05a-179">Затем, на шаге 2, мы обновим основного запроса хранимые процедуры, чтобы получить имя диспетчера s через `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="8a05a-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="8a05a-180">Сначала откройте `NorthwindWithSprocs` набора данных в `~/App_Code/DAL` папку.</span><span class="sxs-lookup"><span data-stu-id="8a05a-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="8a05a-181">Щелкните правой кнопкой мыши в конструкторе и выберите Добавить параметр в контекстном меню выбрать пункт меню адаптера таблицы.</span><span class="sxs-lookup"><span data-stu-id="8a05a-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="8a05a-182">Это приведет к запуску мастера настройки адаптера таблицы.</span><span class="sxs-lookup"><span data-stu-id="8a05a-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="8a05a-183">Как показано на рис. 5, имеют мастер создал новые хранимые процедуры и нажмите кнопку Далее.</span><span class="sxs-lookup"><span data-stu-id="8a05a-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="8a05a-184">О создании новых хранимых процедур с помощью мастера TableAdapter s, обратитесь к [создание новых хранимых процедур для адаптеров таблиц TableAdapter типизированного набора DataSet s](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) руководства.</span><span class="sxs-lookup"><span data-stu-id="8a05a-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>


<span data-ttu-id="8a05a-185">[![Выберите создать новые хранимые процедуры параметр](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="8a05a-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span></span>

<span data-ttu-id="8a05a-186">**Рис. 5**: Укажите, создать новые хранимые процедуры параметр ([Просмотр полноразмерного изображения](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="8a05a-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span></span>


<span data-ttu-id="8a05a-187">Используйте следующую команду `SELECT` инструкции для основного запроса адаптера таблицы s:</span><span class="sxs-lookup"><span data-stu-id="8a05a-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample4.sql)]

<span data-ttu-id="8a05a-188">Так как этот запрос не содержит `JOIN` s, адаптера таблицы мастер автоматически создаст хранимых процедур с соответствующим `INSERT`, `UPDATE`, и `DELETE` инструкции, а также хранимой процедуры для выполнения основной запрос.</span><span class="sxs-lookup"><span data-stu-id="8a05a-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="8a05a-189">Следующий шаг позволит нам имя процедуры, которые хранятся адаптера таблицы.</span><span class="sxs-lookup"><span data-stu-id="8a05a-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="8a05a-190">Используйте имена `Employees_Select`, `Employees_Insert`, `Employees_Update`, и `Employees_Delete`, как показано на рис. 6.</span><span class="sxs-lookup"><span data-stu-id="8a05a-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>


<span data-ttu-id="8a05a-191">[![Имя процедуры, которые хранятся адаптера таблицы](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="8a05a-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span></span>

<span data-ttu-id="8a05a-192">**Рис. 6**: Имя TableAdapter s хранимые процедуры ([Просмотр полноразмерного изображения](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="8a05a-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span></span>


<span data-ttu-id="8a05a-193">Последним шагом запрашивает имя s методы адаптера таблицы.</span><span class="sxs-lookup"><span data-stu-id="8a05a-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="8a05a-194">Используйте `Fill` и `GetEmployees` как имена методов.</span><span class="sxs-lookup"><span data-stu-id="8a05a-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="8a05a-195">Также не забудьте оставить флажок создавать методы для отправки обновлений непосредственно в базу данных (GenerateDBDirectMethods) флажок установленным.</span><span class="sxs-lookup"><span data-stu-id="8a05a-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>


<span data-ttu-id="8a05a-196">[![Имя свойства Fill методы TableAdapter s и GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="8a05a-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span></span>

<span data-ttu-id="8a05a-197">**Рис. 7**: Имя TableAdapter s методы `Fill` и `GetEmployees` ([Просмотр полноразмерного изображения](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="8a05a-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span></span>


<span data-ttu-id="8a05a-198">После завершения работы мастера, Отвлекитесь и проверьте хранимые процедуры в базе данных.</span><span class="sxs-lookup"><span data-stu-id="8a05a-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="8a05a-199">Вы увидите четыре новых: `Employees_Select`, `Employees_Insert`, `Employees_Update`, и `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="8a05a-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="8a05a-200">Затем проверьте `EmployeesDataTable` и `EmployeesTableAdapter` только что создали.</span><span class="sxs-lookup"><span data-stu-id="8a05a-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="8a05a-201">Объект DataTable содержит столбец для каждого поля, возвращенной основным запросом.</span><span class="sxs-lookup"><span data-stu-id="8a05a-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="8a05a-202">Щелкните TableAdapter и перейдите в окно свойств.</span><span class="sxs-lookup"><span data-stu-id="8a05a-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="8a05a-203">Там вы увидите, что `InsertCommand`, `UpdateCommand`, и `DeleteCommand` свойства настроены правильно для вызова соответствующих хранимых процедур.</span><span class="sxs-lookup"><span data-stu-id="8a05a-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>


<span data-ttu-id="8a05a-204">[![TableAdapter включает вставки, обновления и удаления возможности](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="8a05a-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span></span>

<span data-ttu-id="8a05a-205">**Рис. 8**: TableAdapter включает Insert, Update и удалить возможности ([Просмотр полноразмерного изображения](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="8a05a-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span></span>


<span data-ttu-id="8a05a-206">С помощью инструкции insert, update и delete хранимые процедуры, автоматически созданные и `InsertCommand`, `UpdateCommand`, и `DeleteCommand` свойства правильно настроены, можно приступить к настройке `SelectCommand` s хранимой процедуры для возврата дополнительных сведения о диспетчере каждого сотрудника s.</span><span class="sxs-lookup"><span data-stu-id="8a05a-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="8a05a-207">В частности, необходимо обновить `Employees_Select` хранимой процедуры для использования `JOIN` и возврата manager s `FirstName` и `LastName` значения.</span><span class="sxs-lookup"><span data-stu-id="8a05a-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="8a05a-208">После обновления хранимой процедуры, необходимо обновить объект DataTable, теперь она содержит следующие дополнительные столбцы.</span><span class="sxs-lookup"><span data-stu-id="8a05a-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="8a05a-209">Это будет рассмотрено, эти две задачи на шагах 2 и 3.</span><span class="sxs-lookup"><span data-stu-id="8a05a-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="8a05a-210">Шаг 2. Настройка хранимой процедуры для включения`JOIN`</span><span class="sxs-lookup"><span data-stu-id="8a05a-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="8a05a-211">Start, перейдя в проводник по серверам, углубляться в папке Stored Procedures s базы данных Northwind и открыв `Employees_Select` хранимой процедуры.</span><span class="sxs-lookup"><span data-stu-id="8a05a-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="8a05a-212">Если вы не видите эту хранимую процедуру, хранимые процедуры папку правой кнопкой мыши и выберите "Обновить".</span><span class="sxs-lookup"><span data-stu-id="8a05a-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="8a05a-213">Обновить хранимую процедуру, чтобы он использовал `LEFT JOIN` для возврата manager s сначала имени и фамилии:</span><span class="sxs-lookup"><span data-stu-id="8a05a-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample5.sql)]

<span data-ttu-id="8a05a-214">После обновления `SELECT` инструкции, сохранить эти изменения, перейдите в меню "файл" и выберите Save `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="8a05a-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="8a05a-215">В качестве альтернативы можно щелкните значок "Сохранить" на панели инструментов или нажмите сочетание клавиш Ctrl + S.</span><span class="sxs-lookup"><span data-stu-id="8a05a-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="8a05a-216">После сохранения изменений, щелкните правой кнопкой мыши `Employees_Select` хранимой процедуры в обозревателе серверов и выберите команду выполнить.</span><span class="sxs-lookup"><span data-stu-id="8a05a-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="8a05a-217">Это выполните хранимую процедуру и показать его результаты в окне вывода (см. рис. 9).</span><span class="sxs-lookup"><span data-stu-id="8a05a-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>


<span data-ttu-id="8a05a-218">[![Результаты хранимой процедуры отображаются в окне вывода](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="8a05a-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span></span>

<span data-ttu-id="8a05a-219">**Рис. 9**: Результаты хранимой процедуры отображаются в окне вывода ([Просмотр полноразмерного изображения](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="8a05a-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span></span>


## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="8a05a-220">Шаг 3. Обновление столбцов s DataTable</span><span class="sxs-lookup"><span data-stu-id="8a05a-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="8a05a-221">На этом этапе `Employees_Select` хранимая процедура возвращает `ManagerFirstName` и `ManagerLastName` значения, но `EmployeesDataTable` отсутствует этих столбцов.</span><span class="sxs-lookup"><span data-stu-id="8a05a-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="8a05a-222">Эти отсутствующие столбцы можно добавить к таблице DataTable в одном из двух способов:</span><span class="sxs-lookup"><span data-stu-id="8a05a-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="8a05a-223">**Вручную** — щелкните правой кнопкой мыши в таблице в конструкторе наборов данных и из меню "Добавить", выберите столбец.</span><span class="sxs-lookup"><span data-stu-id="8a05a-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="8a05a-224">Можно затем назовите этот столбец и задайте свойства, соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="8a05a-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="8a05a-225">**Автоматически** -мастера настройки адаптера таблицы будет обновлять столбцы s DataTable в соответствии с полям, возвращенным `SelectCommand` хранимой процедуры.</span><span class="sxs-lookup"><span data-stu-id="8a05a-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="8a05a-226">Если вы используете специализированные инструкции SQL, мастер также удалит `InsertCommand`, `UpdateCommand`, и `DeleteCommand` свойства с момента `SelectCommand` теперь содержит `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="8a05a-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="8a05a-227">Но при использовании хранимых процедур, эти свойства команды остаются без изменений.</span><span class="sxs-lookup"><span data-stu-id="8a05a-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="8a05a-228">Ручное добавление столбцов таблицы данных мы изучили в предыдущих учебных курсах, включая [Master/Detail, с использованием маркированного списка основных записей с элементом управления DataList сведения](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) и [загрузка файлов](../working-with-binary-files/uploading-files-vb.md), и мы Рассмотрим этот процесс более подробно в снова в нашем следующем учебном курсе.</span><span class="sxs-lookup"><span data-stu-id="8a05a-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) and [Uploading Files](../working-with-binary-files/uploading-files-vb.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="8a05a-229">Для этого руководства но позвольте s использовать автоматической настройке с помощью мастера настройки адаптера таблицы.</span><span class="sxs-lookup"><span data-stu-id="8a05a-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="8a05a-230">Запустите, щелкнув правой кнопкой мыши `EmployeesTableAdapter` и выбрав пункт "Настройка" в контекстном меню.</span><span class="sxs-lookup"><span data-stu-id="8a05a-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="8a05a-231">Откроется мастер настройки адаптера таблицы, который перечисляет хранимые процедуры, используемые для выбора, вставки, обновления и удаления, а также их возвращаемые значения и параметры (если таковые имеются).</span><span class="sxs-lookup"><span data-stu-id="8a05a-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="8a05a-232">Рис. 10 показан этот мастер.</span><span class="sxs-lookup"><span data-stu-id="8a05a-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="8a05a-233">Здесь можно увидеть, что `Employees_Select` хранимая процедура возвращает теперь `ManagerFirstName` и `ManagerLastName` поля.</span><span class="sxs-lookup"><span data-stu-id="8a05a-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>


<span data-ttu-id="8a05a-234">[![В мастере показан список обновленных столбцов для Employees_Select хранимой процедуры](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="8a05a-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span></span>

<span data-ttu-id="8a05a-235">**Рис. 10**: В мастере отображается список столбцов обновлены для `Employees_Select` хранимой процедуры ([Просмотр полноразмерного изображения](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="8a05a-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span></span>


<span data-ttu-id="8a05a-236">Следуйте указаниям мастера, нажмите кнопку Finish.</span><span class="sxs-lookup"><span data-stu-id="8a05a-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="8a05a-237">При возвращении в конструктор DataSet, `EmployeesDataTable` включает два дополнительных столбца: `ManagerFirstName` и `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="8a05a-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>


<span data-ttu-id="8a05a-238">[![EmployeesDataTable содержит два новых столбца](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="8a05a-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span></span>

<span data-ttu-id="8a05a-239">**Рис. 11**: `EmployeesDataTable` Содержит два новых столбца ([Просмотр полноразмерного изображения](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="8a05a-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span></span>


<span data-ttu-id="8a05a-240">Чтобы проиллюстрировать, обновленный `Employees_Select` хранимая процедура по сути и что вставки, обновления и удаления возможностей адаптера таблицы по-прежнему работают, давайте s Создание веб-страницы, который позволяет пользователю просматривать и удалять сотрудников.</span><span class="sxs-lookup"><span data-stu-id="8a05a-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="8a05a-241">Прежде чем мы создания такой страницы, тем не менее, необходимо сначала создать новый класс в уровне бизнес-логики для работы с сотрудниками из `NorthwindWithSprocs` набора данных.</span><span class="sxs-lookup"><span data-stu-id="8a05a-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="8a05a-242">На шаге 4 мы создадим `EmployeesBLLWithSprocs` класса.</span><span class="sxs-lookup"><span data-stu-id="8a05a-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="8a05a-243">На шаге 5 мы будем использовать этот класс со страницы ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8a05a-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="8a05a-244">Шаг 4. Реализация уровня бизнес-логики</span><span class="sxs-lookup"><span data-stu-id="8a05a-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="8a05a-245">Создайте новый файл класса в `~/App_Code/BLL` папку с именем `EmployeesBLLWithSprocs.vb`.</span><span class="sxs-lookup"><span data-stu-id="8a05a-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.vb`.</span></span> <span data-ttu-id="8a05a-246">Этот класс имитирует существующий семантику `EmployeesBLL` класса, только этот новый один обеспечивает меньшее число методов и использует `NorthwindWithSprocs` набора данных (вместо `Northwind` набора данных).</span><span class="sxs-lookup"><span data-stu-id="8a05a-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="8a05a-247">Добавьте следующий код в класс `EmployeesBLLWithSprocs` .</span><span class="sxs-lookup"><span data-stu-id="8a05a-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>


[!code-vb[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample6.vb)]

<span data-ttu-id="8a05a-248">`EmployeesBLLWithSprocs` Класс s `Adapter` свойство возвращает экземпляр `NorthwindWithSprocs` s набора данных `EmployeesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="8a05a-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="8a05a-249">Это значение используется класс s `GetEmployees` и `DeleteEmployee` методы.</span><span class="sxs-lookup"><span data-stu-id="8a05a-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="8a05a-250">`GetEmployees` Вызовы методов `EmployeesTableAdapter` соответствующий s `GetEmployees` метод, который вызывает `Employees_Select` хранимой процедуры и заполняет его результаты в `EmployeeDataTable`.</span><span class="sxs-lookup"><span data-stu-id="8a05a-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="8a05a-251">`DeleteEmployee` Аналогичным образом вызывает метод `EmployeesTableAdapter` s `Delete` метод, который вызывает `Employees_Delete` хранимой процедуры.</span><span class="sxs-lookup"><span data-stu-id="8a05a-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="8a05a-252">Шаг 5. Работа с данными на уровне представления данных</span><span class="sxs-lookup"><span data-stu-id="8a05a-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="8a05a-253">С помощью `EmployeesBLLWithSprocs` класс полный, мы будет готов для работы с данными о сотрудниках через страницы ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8a05a-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="8a05a-254">Откройте `JOINs.aspx` странице в `AdvancedDAL` папки и перетащите элемент управления GridView с панели элементов в конструктор, установив его `ID` свойства `Employees`.</span><span class="sxs-lookup"><span data-stu-id="8a05a-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="8a05a-255">Затем из смарт-тега GridView s, привязка сетки для нового элемента управления ObjectDataSource с именем `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="8a05a-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="8a05a-256">Настройка ObjectDataSource на использование `EmployeesBLLWithSprocs` класса и из вкладки SELECT и DELETE, убедитесь, что `GetEmployees` и `DeleteEmployee` методы выбираются из раскрывающихся списков.</span><span class="sxs-lookup"><span data-stu-id="8a05a-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="8a05a-257">Нажмите кнопку Готово, чтобы завершить настройку s ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="8a05a-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>


<span data-ttu-id="8a05a-258">[![Настройка ObjectDataSource на использование класса EmployeesBLLWithSprocs](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="8a05a-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span></span>

<span data-ttu-id="8a05a-259">**Рис. 12**: Настройка ObjectDataSource для использования `EmployeesBLLWithSprocs` класс ([Просмотр полноразмерного изображения](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="8a05a-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span></span>


<span data-ttu-id="8a05a-260">[![У использование ObjectDataSource GetEmployees и методы DeleteEmployee](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="8a05a-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span></span>

<span data-ttu-id="8a05a-261">**Рис. 13**: Для использования ObjectDataSource `GetEmployees` и `DeleteEmployee` методы ([Просмотр полноразмерного изображения](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="8a05a-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span></span>


<span data-ttu-id="8a05a-262">Visual Studio добавит поле BoundField GridView для каждого из `EmployeesDataTable` s столбцов.</span><span class="sxs-lookup"><span data-stu-id="8a05a-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="8a05a-263">Удалить все эти поля BoundField, кроме `Title`, `LastName`, `FirstName`, `ManagerFirstName`, и `ManagerLastName` и переименуйте `HeaderText` свойства для последних четырех полей BoundFields Фамилия, имя, имя диспетчера s, и Диспетчер s Last Name, соответственно.</span><span class="sxs-lookup"><span data-stu-id="8a05a-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="8a05a-264">Чтобы разрешить пользователям удалять сотрудников на этой странице, нам нужно сделать две вещи.</span><span class="sxs-lookup"><span data-stu-id="8a05a-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="8a05a-265">Во-первых указать для предоставления Удаление возможностей, выбрав параметр Разрешить удаление смарт-теге GridView.</span><span class="sxs-lookup"><span data-stu-id="8a05a-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="8a05a-266">Во-вторых, измените элемент управления ObjectDataSource s `OldValuesParameterFormatString` из значения установлено с помощью мастера ObjectDataSource (`original_{0}`) к значению по умолчанию (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="8a05a-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="8a05a-267">После внесения этих изменений, GridView и ObjectDataSource s декларативной разметке должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="8a05a-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample7.aspx)]

<span data-ttu-id="8a05a-268">Протестировать страницу, посетив его через браузер.</span><span class="sxs-lookup"><span data-stu-id="8a05a-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="8a05a-269">Как показано на рис. 14, будут отображаться на странице каждого сотрудника и его s имя диспетчера (если они есть).</span><span class="sxs-lookup"><span data-stu-id="8a05a-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>


<span data-ttu-id="8a05a-270">[![СОЕДИНЕНИЕ в Employees_Select хранимая процедура возвращает имя диспетчера s](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="8a05a-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span></span>

<span data-ttu-id="8a05a-271">**Рис. 14**: `JOIN` В `Employees_Select` хранимая процедура возвращает диспетчер s имя ([Просмотр полноразмерного изображения](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="8a05a-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span></span>


<span data-ttu-id="8a05a-272">При нажатии кнопки Delete запускается удаление рабочего процесса, который завершающийся выполнения `Employees_Delete` хранимой процедуры.</span><span class="sxs-lookup"><span data-stu-id="8a05a-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="8a05a-273">Тем не менее попытка `DELETE` инструкции в хранимой процедуре завершается неудачно из-за нарушения ограничения внешнего ключа (см. рис. 15).</span><span class="sxs-lookup"><span data-stu-id="8a05a-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="8a05a-274">В частности, каждый сотрудник имеет одну или несколько записей `Orders` таблицы, вызывая delete переход на другой.</span><span class="sxs-lookup"><span data-stu-id="8a05a-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>


<span data-ttu-id="8a05a-275">[![Удаление сотрудника с соответствующими результатами заказов в нарушение ограничения внешнего ключа](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="8a05a-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span></span>

<span data-ttu-id="8a05a-276">**Рис. 15**: Удаление сотрудника с соответствующими результатами заказов в нарушение ограничения внешнего ключа ([Просмотр полноразмерного изображения](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="8a05a-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span></span>


<span data-ttu-id="8a05a-277">Чтобы разрешить сотрудника удалена, вы может:</span><span class="sxs-lookup"><span data-stu-id="8a05a-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="8a05a-278">Ограничение внешнего ключа для каскадное удаление, обновление</span><span class="sxs-lookup"><span data-stu-id="8a05a-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="8a05a-279">Вручную удалите записи из `Orders` таблицы для сотрудников, которые вы хотите удалить, или</span><span class="sxs-lookup"><span data-stu-id="8a05a-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="8a05a-280">Обновление `Employees_Delete` хранимую процедуру, чтобы сначала удалить связанные записи из `Orders` таблицы перед удалением `Employees` записи.</span><span class="sxs-lookup"><span data-stu-id="8a05a-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="8a05a-281">Мы описывала этот вариант в [существующих хранимых процедур для адаптеров таблиц TableAdapter типизированного набора DataSet s](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) руководства.</span><span class="sxs-lookup"><span data-stu-id="8a05a-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>

<span data-ttu-id="8a05a-282">Оставить этот в качестве упражнения для чтения.</span><span class="sxs-lookup"><span data-stu-id="8a05a-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="8a05a-283">Сводка</span><span class="sxs-lookup"><span data-stu-id="8a05a-283">Summary</span></span>

<span data-ttu-id="8a05a-284">При работе с реляционными базами данных, обычно для запросов, чтобы извлечь данные из нескольких связанных таблиц.</span><span class="sxs-lookup"><span data-stu-id="8a05a-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="8a05a-285">Зависимые вложенные запросы и `JOIN` предоставляет два различных способа для доступа к данным из связанных таблиц в запросе.</span><span class="sxs-lookup"><span data-stu-id="8a05a-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="8a05a-286">В предыдущих учебных курсах, мы внесли чаще всего использовать коррелированных вложенных запросов, поскольку TableAdapter не может автоматически создавать `INSERT`, `UPDATE`, и `DELETE` инструкций для запросов с использованием `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="8a05a-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="8a05a-287">Хотя эти значения можно указать вручную, при использовании инструкции SQL ad-hoc все настройки будут перезаписаны при завершении выполнения мастера настройки адаптера таблицы.</span><span class="sxs-lookup"><span data-stu-id="8a05a-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="8a05a-288">К счастью адаптеры таблиц, созданных с помощью хранимых процедур не приводит же хрупкости, как были созданы с помощью нерегламентированных инструкций SQL.</span><span class="sxs-lookup"><span data-stu-id="8a05a-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="8a05a-289">Таким образом, можно создать адаптер таблицы использует которого основного запроса `JOIN` при использовании хранимых процедур.</span><span class="sxs-lookup"><span data-stu-id="8a05a-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="8a05a-290">В этом руководстве мы рассмотрели создание таких адаптера таблицы.</span><span class="sxs-lookup"><span data-stu-id="8a05a-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="8a05a-291">Мы начали с помощью `JOIN`-меньше `SELECT` запрос для основного запроса адаптера таблицы s, чтобы соответствующий вставки, обновления и удаления хранимых процедур будет автоматически создана.</span><span class="sxs-lookup"><span data-stu-id="8a05a-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="8a05a-292">С помощью адаптера таблицы s начальная настройка завершена, дополнена необходимостью `SelectCommand` хранимой процедуры для использования `JOIN` и повторного запуска мастера настройки адаптера таблицы для обновления `EmployeesDataTable` s столбцов.</span><span class="sxs-lookup"><span data-stu-id="8a05a-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="8a05a-293">Повторный запуск мастера настройки адаптера таблицы автоматически обновляется `EmployeesDataTable` столбцы для отображения поля данных, возвращенных `Employees_Select` хранимой процедуры.</span><span class="sxs-lookup"><span data-stu-id="8a05a-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="8a05a-294">Кроме того удалось добавлена эти столбцы вручную к таблице DataTable.</span><span class="sxs-lookup"><span data-stu-id="8a05a-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="8a05a-295">Мы рассмотрим вручную Добавление столбцов к таблице DataTable в следующем учебном курсе.</span><span class="sxs-lookup"><span data-stu-id="8a05a-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="8a05a-296">Счастливого вам программирования!</span><span class="sxs-lookup"><span data-stu-id="8a05a-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="8a05a-297">Об авторе</span><span class="sxs-lookup"><span data-stu-id="8a05a-297">About the Author</span></span>

<span data-ttu-id="8a05a-298">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP.NET и основатель веб- [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Microsoft с 1998 года.</span><span class="sxs-lookup"><span data-stu-id="8a05a-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="8a05a-299">Скотт — независимый консультант, преподаватель и автор.</span><span class="sxs-lookup"><span data-stu-id="8a05a-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="8a05a-300">Его последняя книга — [ *Sams Teach ASP.NET 2.0 in 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="8a05a-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="8a05a-301">Ним можно связаться по адресу [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8a05a-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="8a05a-302">или через его блог, который можно найти в [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="8a05a-302">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="8a05a-303">Особая благодарность</span><span class="sxs-lookup"><span data-stu-id="8a05a-303">Special Thanks To</span></span>

<span data-ttu-id="8a05a-304">В этой серии руководств пособий рецензировалась многими компетентными редакторами.</span><span class="sxs-lookup"><span data-stu-id="8a05a-304">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="8a05a-305">Хилтон Geisenow, Дэвид Suru и Терезой Мерфи, стали Лиз Шалок в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="8a05a-305">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="8a05a-306">Хотите поработать с моих последующих статей для MSDN?</span><span class="sxs-lookup"><span data-stu-id="8a05a-306">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="8a05a-307">Если Да, напишите мне [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8a05a-307">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="8a05a-308">[Назад](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
> [Вперед](adding-additional-datatable-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="8a05a-308">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](adding-additional-datatable-columns-vb.md)</span></span>
