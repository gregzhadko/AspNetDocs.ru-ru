---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
title: Работа с вычисленными столбцами (VB) | Документация Майкрософт
author: rick-anderson
description: При создании таблицы базы данных Microsoft SQL Server позволяет определить вычисляемый столбец, значение которого вычисляется из выражения, которое обычно референ...
ms.author: riande
ms.date: 08/03/2007
ms.assetid: 5811b8ff-ed56-40fc-9397-6b69ae09a8f6
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-vb
msc.type: authoredcontent
ms.openlocfilehash: e425d7363c2cdea6efb0ba51f3fc2b6a5330bf2a
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78420858"
---
# <a name="working-with-computed-columns-vb"></a><span data-ttu-id="62b89-103">Работа с вычисляемыми столбцами (VB)</span><span class="sxs-lookup"><span data-stu-id="62b89-103">Working with Computed Columns (VB)</span></span>

<span data-ttu-id="62b89-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="62b89-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="62b89-105">[Скачать код](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) или [скачать PDF](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="62b89-105">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_VB.zip) or [Download PDF](working-with-computed-columns-vb/_static/datatutorial71vb1.pdf)</span></span>

> <span data-ttu-id="62b89-106">При создании таблицы базы данных Microsoft SQL Server позволяет определить вычисляемый столбец, значение которого вычисляется на основе выражения, которое обычно ссылается на другие значения в той же записи базы данных.</span><span class="sxs-lookup"><span data-stu-id="62b89-106">When creating a database table, Microsoft SQL Server allows you to define a computed column whose value is calculated from an expression that usually references other values in the same database record.</span></span> <span data-ttu-id="62b89-107">Такие значения доступны только для чтения в базе данных, что требует особых рекомендаций при работе с адаптерами таблиц.</span><span class="sxs-lookup"><span data-stu-id="62b89-107">Such values are read-only at the database, which requires special considerations when working with TableAdapters.</span></span> <span data-ttu-id="62b89-108">В этом учебнике мы научитесь решать проблемы, связанные с вычисленными столбцами.</span><span class="sxs-lookup"><span data-stu-id="62b89-108">In this tutorial we learn how to meet the challenges posed by computed columns.</span></span>

## <a name="introduction"></a><span data-ttu-id="62b89-109">Введение</span><span class="sxs-lookup"><span data-stu-id="62b89-109">Introduction</span></span>

<span data-ttu-id="62b89-110">Microsoft SQL Server допускает *[вычисляемые столбцы](https://msdn.microsoft.com/library/ms191250.aspx)* , которые представляют собой столбцы, значения которых вычисляются из выражения, которое обычно ссылается на значения из других столбцов в той же таблице.</span><span class="sxs-lookup"><span data-stu-id="62b89-110">Microsoft SQL Server allows for *[computed columns](https://msdn.microsoft.com/library/ms191250.aspx)*, which are columns whose values are calculated from an expression that usually references the values from other columns in the same table.</span></span> <span data-ttu-id="62b89-111">Например, модель данных отслеживания времени может иметь таблицу с именем `ServiceLog` со столбцами, включая `ServicePerformed`, `EmployeeID`, `Rate`и `Duration`, среди прочих.</span><span class="sxs-lookup"><span data-stu-id="62b89-111">As an example, a time tracking data model might have a table named `ServiceLog` with columns including `ServicePerformed`, `EmployeeID`, `Rate`, and `Duration`, among others.</span></span> <span data-ttu-id="62b89-112">Хотя сумма оплаты за единицу обслуживания (умноженная на длительность) может быть вычислена через веб-страницу или другой программный интерфейс, может оказаться полезным включить в таблицу `ServiceLog` столбец с именем `AmountDue`, который сообщил об этой информации.</span><span class="sxs-lookup"><span data-stu-id="62b89-112">While the amount due per service item (being the rate multiplied by the duration) could be calculated through a web page or other programmatic interface, it might be handy to include a column in the `ServiceLog` table named `AmountDue` that reported this information.</span></span> <span data-ttu-id="62b89-113">Этот столбец может быть создан в виде обычного столбца, но его необходимо обновлять всякий раз, когда изменились `Rate` или `Duration` значения столбцов.</span><span class="sxs-lookup"><span data-stu-id="62b89-113">This column could be created as a normal column, but it would need to be updated anytime the `Rate` or `Duration` column values changed.</span></span> <span data-ttu-id="62b89-114">Лучшим подходом является создание `AmountDue` столбца вычисляемого столбца с помощью `Rate * Duration`выражения.</span><span class="sxs-lookup"><span data-stu-id="62b89-114">A better approach would be to make the `AmountDue` column a computed column using the expression `Rate * Duration`.</span></span> <span data-ttu-id="62b89-115">Это приведет к тому, что SQL Server автоматически вычислит `AmountDue` значение столбца при каждом обращении в запросе.</span><span class="sxs-lookup"><span data-stu-id="62b89-115">Doing so would cause SQL Server to automatically calculate the `AmountDue` column value whenever it was referenced in a query.</span></span>

<span data-ttu-id="62b89-116">Поскольку значение вычисляемого столбца определяется выражением, такие столбцы доступны только для чтения и поэтому не могут иметь присвоенные значения в операторах `INSERT` и `UPDATE`.</span><span class="sxs-lookup"><span data-stu-id="62b89-116">Since a computed column s value is determined by an expression, such columns are read-only and therefore cannot have values assigned to them in `INSERT` or `UPDATE` statements.</span></span> <span data-ttu-id="62b89-117">Однако если вычисленные столбцы являются частью основного запроса для TableAdapter, использующего специальные инструкции SQL, они автоматически включаются в автоматически создаваемые `INSERT` и `UPDATE` инструкции.</span><span class="sxs-lookup"><span data-stu-id="62b89-117">However, when computed columns are part of the main query for a TableAdapter that uses ad-hoc SQL statements, they are automatically included in the auto-generated `INSERT` and `UPDATE` statements.</span></span> <span data-ttu-id="62b89-118">Таким образом, для удаления ссылок на все вычисленные столбцы необходимо обновить `INSERT`ные и `UPDATE`ные запросы TableAdapter, а также свойства `InsertCommand` и `UpdateCommand`.</span><span class="sxs-lookup"><span data-stu-id="62b89-118">Consequently, the TableAdapter s `INSERT` and `UPDATE` queries and `InsertCommand` and `UpdateCommand` properties must be updated to remove references to any computed columns.</span></span>

<span data-ttu-id="62b89-119">Одна из проблем использования вычисленных столбцов с TableAdapter, использующих специальные инструкции SQL, заключается в том, что адаптеры `INSERT` и `UPDATE` автоматически создаются повторно при каждом завершении работы мастера настройки TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="62b89-119">One challenge of using computed columns with a TableAdapter that uses ad-hoc SQL statements is that the TableAdapter s `INSERT` and `UPDATE` queries are automatically regenerated any time the TableAdapter Configuration wizard is completed.</span></span> <span data-ttu-id="62b89-120">Поэтому вычисленные столбцы, вручную удаленные из `INSERT` и `UPDATE` запросы, будут снова отображаться при повторном запуске мастера.</span><span class="sxs-lookup"><span data-stu-id="62b89-120">Therefore, the computed columns manually removed from the `INSERT` and `UPDATE` queries will reappear if the wizard is re-run.</span></span> <span data-ttu-id="62b89-121">Хотя адаптеры таблиц, использующие хранимые процедуры, не страдает от этого хрупкости, они имеют свои собственные особенности, которые мы будем решать на шаге 3.</span><span class="sxs-lookup"><span data-stu-id="62b89-121">Although TableAdapters that use stored procedures don t suffer from this brittleness, they do have their own quirks that we will address in Step 3.</span></span>

<span data-ttu-id="62b89-122">В этом учебнике мы добавим вычисляемый столбец в таблицу `Suppliers` базы данных Northwind, а затем создадим соответствующий адаптер TableAdapter для работы с этой таблицей и ее вычисляемым столбцом.</span><span class="sxs-lookup"><span data-stu-id="62b89-122">In this tutorial we will add a computed column to the `Suppliers` table in the Northwind database and then create a corresponding TableAdapter to work with this table and its computed column.</span></span> <span data-ttu-id="62b89-123">Наш адаптер TableAdapter будет использовать хранимые процедуры вместо специальных инструкций SQL, чтобы наши настройки не были потеряны при использовании мастера настройки адаптера таблицы.</span><span class="sxs-lookup"><span data-stu-id="62b89-123">We will have our TableAdapter use stored procedures instead of ad-hoc SQL statements so that our customizations aren't lost when the TableAdapter Configuration wizard is used.</span></span>

<span data-ttu-id="62b89-124">Давайте приступим к работе!</span><span class="sxs-lookup"><span data-stu-id="62b89-124">Let s get started!</span></span>

## <a name="step-1-adding-a-computed-column-to-thesupplierstable"></a><span data-ttu-id="62b89-125">Шаг 1. Добавление вычисляемого столбца в таблицу`Suppliers`</span><span class="sxs-lookup"><span data-stu-id="62b89-125">Step 1: Adding a Computed Column to the`Suppliers`Table</span></span>

<span data-ttu-id="62b89-126">База данных «Борей» не имеет ни одного вычисленного столбца, поэтому нам нужно будет добавить ее.</span><span class="sxs-lookup"><span data-stu-id="62b89-126">The Northwind database does not have any computed columns so we will need to add one ourselves.</span></span> <span data-ttu-id="62b89-127">В этом руководстве мы добавим вычисляемый столбец в таблицу `Suppliers` с именем `FullContactName`, которая возвращает имя контактного лица, название и компанию, в которой они работают, в следующем формате: `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="62b89-127">For this tutorial let s add a computed column to the `Suppliers` table called `FullContactName` that returns the contact s name, title, and the company they work for in the following format: `ContactName` (`ContactTitle`, `CompanyName`).</span></span> <span data-ttu-id="62b89-128">Этот вычисляемый столбец может использоваться в отчетах при отображении сведений о поставщиках.</span><span class="sxs-lookup"><span data-stu-id="62b89-128">This computed column might be used in reports when displaying information about suppliers.</span></span>

<span data-ttu-id="62b89-129">Для начала откройте определение таблицы `Suppliers`, щелкнув правой кнопкой мыши таблицу `Suppliers` в обозреватель сервера и выбрав Открыть определение таблицы в контекстном меню.</span><span class="sxs-lookup"><span data-stu-id="62b89-129">Start by opening the `Suppliers` table definition by right-clicking on the `Suppliers` table in the Server Explorer and choosing Open Table Definition from the context-menu.</span></span> <span data-ttu-id="62b89-130">В результате будут отображены столбцы таблицы и их свойства, например тип данных, разрешены ли `NULL` s и т. д.</span><span class="sxs-lookup"><span data-stu-id="62b89-130">This will display the columns of the table and their properties, such as their data type, whether they allow `NULL` s, and so forth.</span></span> <span data-ttu-id="62b89-131">Чтобы добавить вычисляемый столбец, начните с ввода имени столбца в определение таблицы.</span><span class="sxs-lookup"><span data-stu-id="62b89-131">To add a computed column, start by typing in the name of the column into the table definition.</span></span> <span data-ttu-id="62b89-132">Затем введите его выражение в текстовое поле (формула) в разделе спецификация вычисляемого столбца окно свойств столбца (см. рис. 1).</span><span class="sxs-lookup"><span data-stu-id="62b89-132">Next, enter its expression into the (Formula) textbox under the Computed Column Specification section in the Column Properties window (see Figure 1).</span></span> <span data-ttu-id="62b89-133">Присвойте вычисляемому столбцу имя `FullContactName` и используйте следующее выражение:</span><span class="sxs-lookup"><span data-stu-id="62b89-133">Name the computed column `FullContactName` and use the following expression:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample1.sql)]

<span data-ttu-id="62b89-134">Обратите внимание, что строки можно объединить в SQL с помощью оператора `+`.</span><span class="sxs-lookup"><span data-stu-id="62b89-134">Note that strings can be concatenated in SQL using the `+` operator.</span></span> <span data-ttu-id="62b89-135">Оператор `CASE` может использоваться как условный в традиционном языке программирования.</span><span class="sxs-lookup"><span data-stu-id="62b89-135">The `CASE` statement can be used like a conditional in a traditional programming language.</span></span> <span data-ttu-id="62b89-136">В приведенном выше выражении оператор `CASE` можно считать следующим образом: Если `ContactTitle` не `NULL` то выводит значение `ContactTitle`, объединенное с запятой, в противном случае ничего не выдает.</span><span class="sxs-lookup"><span data-stu-id="62b89-136">In the above expression the `CASE` statement can be read as: If `ContactTitle` is not `NULL` then output the `ContactTitle` value concatenated with a comma, otherwise emit nothing.</span></span> <span data-ttu-id="62b89-137">Дополнительные сведения о целесообразности оператора `CASE` см. [в разделе возможности SQL `CASE`](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span><span class="sxs-lookup"><span data-stu-id="62b89-137">For more on the usefulness of the `CASE` statement, see [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span></span>

> [!NOTE]
> <span data-ttu-id="62b89-138">Вместо использования оператора `CASE` здесь можно было бы использовать `ISNULL(ContactTitle, '')`.</span><span class="sxs-lookup"><span data-stu-id="62b89-138">Instead of using a `CASE` statement here, we could have alternatively used `ISNULL(ContactTitle, '')`.</span></span> <span data-ttu-id="62b89-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) возвращает *чеккекспрессион* , если он не равен null, в противном случае возвращает *replacementValue*.</span><span class="sxs-lookup"><span data-stu-id="62b89-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) returns *checkExpression* if it is non-NULL, otherwise it returns *replacementValue*.</span></span> <span data-ttu-id="62b89-140">Хотя `ISNULL` или `CASE` будут работать в этом экземпляре, существуют более сложные сценарии, в которых гибкость оператора `CASE` не может быть сопоставлена с `ISNULL`.</span><span class="sxs-lookup"><span data-stu-id="62b89-140">While either `ISNULL` or `CASE` will work in this instance, there are more intricate scenarios where the flexibility of the `CASE` statement cannot be matched by `ISNULL`.</span></span>

<span data-ttu-id="62b89-141">После добавления этого вычисляемого столбца экран должен выглядеть, как на снимке экрана на рис. 1.</span><span class="sxs-lookup"><span data-stu-id="62b89-141">After adding this computed column your screen should look like the screen shot in Figure 1.</span></span>

<span data-ttu-id="62b89-142">[![добавить вычисляемый столбец с именем Фуллконтактнаме в таблицу «Поставщики»](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="62b89-142">[![Add a Computed Column Named FullContactName to the Suppliers Table](working-with-computed-columns-vb/_static/image2.png)](working-with-computed-columns-vb/_static/image1.png)</span></span>

<span data-ttu-id="62b89-143">**Рис. 1**. Добавление вычисляемого столбца с именем `FullContactName` в таблицу `Suppliers` ([щелкните, чтобы просмотреть изображение с полным размером](working-with-computed-columns-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="62b89-143">**Figure 1**: Add a Computed Column Named `FullContactName` to the `Suppliers` Table ([Click to view full-size image](working-with-computed-columns-vb/_static/image3.png))</span></span>

<span data-ttu-id="62b89-144">После именования вычисляемого столбца и ввода его выражения сохраните изменения в таблице, щелкнув значок сохранить на панели инструментов, нажав клавиши CTRL + S или выбрав пункт Сохранить `Suppliers`в меню файл.</span><span class="sxs-lookup"><span data-stu-id="62b89-144">After naming the computed column and entering its expression, save the changes to the table by clicking the Save icon in the toolbar, by hitting Ctrl+S, or by going to the File menu and choosing Save `Suppliers`.</span></span>

<span data-ttu-id="62b89-145">При сохранении таблицы необходимо обновить обозреватель сервера, включая только что добавленный столбец в списке столбцов `Suppliers` таблица.</span><span class="sxs-lookup"><span data-stu-id="62b89-145">Saving the table should refresh the Server Explorer, including the just-added column in the `Suppliers` table s column list.</span></span> <span data-ttu-id="62b89-146">Кроме того, выражение, вводимое в текстовое поле (формула), автоматически подстраивается к эквивалентному выражению, которое приводит к ненужным пробелам, заключает имена столбцов в квадратные скобки (`[]`) и включает круглые скобки для более четкого отображения порядка операций:</span><span class="sxs-lookup"><span data-stu-id="62b89-146">Furthermore, the expression entered into the (Formula) textbox will automatically adjust to an equivalent expression that strips unnecessary whitespace, surrounds column names with brackets (`[]`), and includes parentheses to more explicitly show the order of operations:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample2.sql)]

<span data-ttu-id="62b89-147">Дополнительные сведения о вычисленных столбцах в Microsoft SQL Server см. в [технической документации](https://msdn.microsoft.com/library/ms191250.aspx).</span><span class="sxs-lookup"><span data-stu-id="62b89-147">For more information on computed columns in Microsoft SQL Server, refer to the [technical documentation](https://msdn.microsoft.com/library/ms191250.aspx).</span></span> <span data-ttu-id="62b89-148">Кроме того, ознакомьтесь со [статьей практическое руководство. Указание вычисленных столбцов](https://msdn.microsoft.com/library/ms188300.aspx) для пошагового руководства по созданию вычисленных столбцов.</span><span class="sxs-lookup"><span data-stu-id="62b89-148">Also check out the [How to: Specify Computed Columns](https://msdn.microsoft.com/library/ms188300.aspx) for a step-by-step walkthrough of creating computed columns.</span></span>

> [!NOTE]
> <span data-ttu-id="62b89-149">По умолчанию вычисляемые столбцы физически не хранятся в таблице, а пересчитываются при каждом обращении к ним в запросе.</span><span class="sxs-lookup"><span data-stu-id="62b89-149">By default, computed columns are not physically stored in the table but are instead recalculated each time they are referenced in a query.</span></span> <span data-ttu-id="62b89-150">При установке флажка является материализованным, однако можно указать SQL Server физически сохранить вычисляемый столбец в таблице.</span><span class="sxs-lookup"><span data-stu-id="62b89-150">By checking the Is Persisted checkbox, however, you can instruct SQL Server to physically store the computed column in the table.</span></span> <span data-ttu-id="62b89-151">Это позволяет создать индекс для вычисляемого столбца, что может повысить производительность запросов, использующих значение вычисляемого столбца в своих `WHERE` предложениях.</span><span class="sxs-lookup"><span data-stu-id="62b89-151">Doing so allows an index to be created on the computed column, which can improve the performance of queries that use the computed column value in their `WHERE` clauses.</span></span> <span data-ttu-id="62b89-152">Дополнительные сведения см. [в разделе Создание индексов на рассчитанных столбцах](https://msdn.microsoft.com/library/ms189292.aspx) .</span><span class="sxs-lookup"><span data-stu-id="62b89-152">See [Creating Indexes on Computed Columns](https://msdn.microsoft.com/library/ms189292.aspx) for more information.</span></span>

## <a name="step-2-viewing-the-computed-column-s-values"></a><span data-ttu-id="62b89-153">Шаг 2. Просмотр значений вычисляемого столбца</span><span class="sxs-lookup"><span data-stu-id="62b89-153">Step 2: Viewing the Computed Column s Values</span></span>

<span data-ttu-id="62b89-154">Прежде чем начать работу на уровне доступа к данным, потратьте минуту, чтобы просмотреть значения `FullContactName`.</span><span class="sxs-lookup"><span data-stu-id="62b89-154">Before we start work on the Data Access Layer, let s take a minute to view the `FullContactName` values.</span></span> <span data-ttu-id="62b89-155">В обозреватель сервера щелкните правой кнопкой мыши `Suppliers` имя таблицы и выберите в контекстном меню команду Создать запрос.</span><span class="sxs-lookup"><span data-stu-id="62b89-155">From the Server Explorer, right-click on the `Suppliers` table name and choose New Query from the context-menu.</span></span> <span data-ttu-id="62b89-156">Откроется окно запроса, в котором мы предложим выбрать таблицы для включения в запрос.</span><span class="sxs-lookup"><span data-stu-id="62b89-156">This will bring up a Query window that prompts us to choose what tables to include in the query.</span></span> <span data-ttu-id="62b89-157">Добавьте таблицу `Suppliers` и нажмите кнопку Закрыть.</span><span class="sxs-lookup"><span data-stu-id="62b89-157">Add the `Suppliers` table and click Close.</span></span> <span data-ttu-id="62b89-158">Затем проверьте столбцы `CompanyName`, `ContactName`, `ContactTitle`и `FullContactName` из таблицы Поставщики.</span><span class="sxs-lookup"><span data-stu-id="62b89-158">Next, check the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` columns from the Suppliers table.</span></span> <span data-ttu-id="62b89-159">Наконец, щелкните значок красного восклицательного знака на панели инструментов, чтобы выполнить запрос и просмотреть результаты.</span><span class="sxs-lookup"><span data-stu-id="62b89-159">Finally, click the red exclamation point icon in the Toolbar to execute the query and view the results.</span></span>

<span data-ttu-id="62b89-160">Как показано на рис. 2, результаты включают `FullContactName`, в котором перечислены столбцы `CompanyName`, `ContactName`и `ContactTitle` в формате `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="62b89-160">As Figure 2 shows, the results include `FullContactName`, which lists the `CompanyName`, `ContactName`, and `ContactTitle` columns using the format `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="62b89-161">[![Фуллконтактнаме использует формат ContactName (Контакттитле, CompanyName).](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="62b89-161">[![The FullContactName Uses the Format ContactName (ContactTitle, CompanyName)](working-with-computed-columns-vb/_static/image5.png)](working-with-computed-columns-vb/_static/image4.png)</span></span>

<span data-ttu-id="62b89-162">**Рис. 2**. `FullContactName` использует формат `ContactName` (`ContactTitle`, `CompanyName`) ([щелкните, чтобы просмотреть изображение с полным размером](working-with-computed-columns-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="62b89-162">**Figure 2**: The `FullContactName` Uses the Format `ContactName` (`ContactTitle`, `CompanyName`) ([Click to view full-size image](working-with-computed-columns-vb/_static/image6.png))</span></span>

## <a name="step-3-adding-thesupplierstableadapterto-the-data-access-layer"></a><span data-ttu-id="62b89-163">Шаг 3. Добавление`SuppliersTableAdapter`к слою доступа к данным</span><span class="sxs-lookup"><span data-stu-id="62b89-163">Step 3: Adding the`SuppliersTableAdapter`to the Data Access Layer</span></span>

<span data-ttu-id="62b89-164">Чтобы работать со сведениями о поставщиках в нашем приложении, необходимо сначала создать TableAdapter и DataTable в DAL.</span><span class="sxs-lookup"><span data-stu-id="62b89-164">In order to work with the supplier information in our application we need to first create a TableAdapter and DataTable in our DAL.</span></span> <span data-ttu-id="62b89-165">В идеале это можно сделать с помощью тех же простых действий, которые были проверены в предыдущих учебных курсах.</span><span class="sxs-lookup"><span data-stu-id="62b89-165">Ideally, this would be accomplished using the same straightforward steps examined in earlier tutorials.</span></span> <span data-ttu-id="62b89-166">Однако работа с вычисленными столбцами вводит несколько вринклес, которые проводят обсуждение.</span><span class="sxs-lookup"><span data-stu-id="62b89-166">However, working with computed columns introduces a few wrinkles that merit discussion.</span></span>

<span data-ttu-id="62b89-167">При использовании TableAdapter, использующего специальные инструкции SQL, можно просто включить вычисляемый столбец в основной запрос TableAdapter s с помощью мастера настройки адаптера таблицы.</span><span class="sxs-lookup"><span data-stu-id="62b89-167">If you are using a TableAdapter that uses ad-hoc SQL statements, you can simply include the computed column in the TableAdapter s main query via the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="62b89-168">Однако это автоматически создаст `INSERT` и `UPDATE` инструкции, включающие вычисляемый столбец.</span><span class="sxs-lookup"><span data-stu-id="62b89-168">This, however, will auto-generate `INSERT` and `UPDATE` statements that include the computed column.</span></span> <span data-ttu-id="62b89-169">При попытке выполнить один из этих методов `SqlException` с сообщением, что столбец *ColumnName* не может быть изменен, поскольку это либо вычисляемый столбец, либо результат выполнения оператора UNION.</span><span class="sxs-lookup"><span data-stu-id="62b89-169">If you attempt to execute one of these methods, a `SqlException` with the message The column *ColumnName* cannot be modified because it is either a computed column or is the result of a UNION operator will be thrown.</span></span> <span data-ttu-id="62b89-170">Хотя `INSERT` и `UPDATE` можно вручную настроить с помощью свойств TableAdapter s `InsertCommand` и `UpdateCommand`, эти настройки будут потеряны при повторном запуске мастера настройки адаптера таблицы.</span><span class="sxs-lookup"><span data-stu-id="62b89-170">While the `INSERT` and `UPDATE` statement can be manually adjusted through the TableAdapter s `InsertCommand` and `UpdateCommand` properties, these customizations will be lost whenever the TableAdapter Configuration wizard is re-run.</span></span>

<span data-ttu-id="62b89-171">Из-за хрупкости адаптеров таблиц, использующих специальные инструкции SQL, рекомендуется использовать хранимые процедуры при работе с вычисленными столбцами.</span><span class="sxs-lookup"><span data-stu-id="62b89-171">Due to the brittleness of TableAdapters that use ad-hoc SQL statements, it is recommended that we use stored procedures when working with computed columns.</span></span> <span data-ttu-id="62b89-172">Если вы используете существующие хранимые процедуры, просто настройте TableAdapter, как описано в статье [использование существующих хранимых процедур для адаптеров таблиц с типом DataSet s](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="62b89-172">If you are using existing stored procedures, simply configure the TableAdapter as discussed in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="62b89-173">Если мастер TableAdapter создает хранимые процедуры для вас, важно сначала опустить все вычисленные столбцы из основного запроса.</span><span class="sxs-lookup"><span data-stu-id="62b89-173">If you have the TableAdapter wizard create the stored procedures for you, however, it is important to initially omit any computed columns from the main query.</span></span> <span data-ttu-id="62b89-174">Если включить вычисляемый столбец в основной запрос, мастер настройки адаптера таблицы сообщит, что после завершения не сможет создать соответствующие хранимые процедуры.</span><span class="sxs-lookup"><span data-stu-id="62b89-174">If you include a computed column in the main query, the TableAdapter Configuration wizard will inform you, upon completion, that it cannot create the corresponding stored procedures.</span></span> <span data-ttu-id="62b89-175">Вкратце, нам нужно сначала настроить TableAdapter с помощью вычисляемого основного запроса без столбца, а затем вручную обновить соответствующую хранимую процедуру и `SelectCommand` TableAdapter, чтобы включить вычисляемый столбец.</span><span class="sxs-lookup"><span data-stu-id="62b89-175">In short, we need to initially configure the TableAdapter using a computed column-free main query and then manually update the corresponding stored procedure and the TableAdapter s `SelectCommand` to include the computed column.</span></span> <span data-ttu-id="62b89-176">Этот подход аналогичен тому, который использовался в руководстве по [обновлению адаптера таблицы TableAdapter для использования](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s* .</span><span class="sxs-lookup"><span data-stu-id="62b89-176">This approach is similar to the one used in the [Updating the TableAdapter to Use](updating-the-tableadapter-to-use-joins-vb.md)`JOIN`*s* tutorial.</span></span>

<span data-ttu-id="62b89-177">В этом руководстве мы добавим новый адаптер TableAdapter и автоматически создадим хранимые процедуры для нас.</span><span class="sxs-lookup"><span data-stu-id="62b89-177">For this tutorial, let s add a new TableAdapter and have it automatically create the stored procedures for us.</span></span> <span data-ttu-id="62b89-178">Следовательно, необходимо сначала опустить `FullContactName` вычисляемый столбец из основного запроса.</span><span class="sxs-lookup"><span data-stu-id="62b89-178">Consequently, we will need to initially omit the `FullContactName` computed column from the main query.</span></span>

<span data-ttu-id="62b89-179">Сначала откройте набор данных `NorthwindWithSprocs` в папке `~/App_Code/DAL`.</span><span class="sxs-lookup"><span data-stu-id="62b89-179">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="62b89-180">Щелкните правой кнопкой мыши в конструкторе и в контекстном меню выберите Добавить новый адаптер таблицы.</span><span class="sxs-lookup"><span data-stu-id="62b89-180">Right-click in the Designer and, from the context-menu, choose to add a new TableAdapter.</span></span> <span data-ttu-id="62b89-181">Запустится мастер настройки адаптера таблицы.</span><span class="sxs-lookup"><span data-stu-id="62b89-181">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="62b89-182">Укажите базу данных для запроса данных (`NORTHWNDConnectionString` из `Web.config`) и нажмите кнопку Далее.</span><span class="sxs-lookup"><span data-stu-id="62b89-182">Specify the database to query data from (`NORTHWNDConnectionString` from `Web.config`) and click Next.</span></span> <span data-ttu-id="62b89-183">Так как мы еще не создали хранимые процедуры для запроса или изменения таблицы `Suppliers`, выберите параметр создать новые хранимые процедуры, чтобы мастер создаст их для нас, и нажмите кнопку Далее.</span><span class="sxs-lookup"><span data-stu-id="62b89-183">Since we have not yet created any stored procedures for querying or modifying the `Suppliers` table, select the Create new stored procedures option so that the wizard will create them for us and click Next.</span></span>

<span data-ttu-id="62b89-184">[![выберите параметр создать новые хранимые процедуры.](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="62b89-184">[![Choose the Create new stored procedures Option](working-with-computed-columns-vb/_static/image8.png)](working-with-computed-columns-vb/_static/image7.png)</span></span>

<span data-ttu-id="62b89-185">**Рис. 3**. Выбор параметра "создать новые хранимые процедуры" ([щелкните, чтобы просмотреть изображение с полным размером](working-with-computed-columns-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="62b89-185">**Figure 3**: Choose the Create new stored procedures Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image9.png))</span></span>

<span data-ttu-id="62b89-186">На следующем шаге мы предложим ввести основной запрос.</span><span class="sxs-lookup"><span data-stu-id="62b89-186">The subsequent step prompts us for the main query.</span></span> <span data-ttu-id="62b89-187">Введите следующий запрос, который возвращает столбцы `SupplierID`, `CompanyName`, `ContactName`и `ContactTitle` для каждого поставщика.</span><span class="sxs-lookup"><span data-stu-id="62b89-187">Enter the following query, which returns the `SupplierID`, `CompanyName`, `ContactName`, and `ContactTitle` columns for each supplier.</span></span> <span data-ttu-id="62b89-188">Обратите внимание, что этот запрос намеренно опускает вычисляемый столбец (`FullContactName`); будет обновлена соответствующая хранимая процедура для включения этого столбца на шаге 4.</span><span class="sxs-lookup"><span data-stu-id="62b89-188">Note that this query purposefully omits the computed column (`FullContactName`); we will update the corresponding stored procedure to include this column in Step 4.</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample3.sql)]

<span data-ttu-id="62b89-189">После ввода основного запроса и нажатия кнопки Далее мастер позволяет присвоить имя четыре хранимых процедурах, которые будут созданы.</span><span class="sxs-lookup"><span data-stu-id="62b89-189">After entering the main query and clicking Next, the wizard allows us to name the four stored procedures it will generate.</span></span> <span data-ttu-id="62b89-190">Назовите эти хранимые процедуры `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`и `Suppliers_Delete`, как показано на рис. 4.</span><span class="sxs-lookup"><span data-stu-id="62b89-190">Name these stored procedures `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, and `Suppliers_Delete`, as Figure 4 illustrates.</span></span>

<span data-ttu-id="62b89-191">[![настроить имена автоматически создаваемых хранимых процедур](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="62b89-191">[![Customize the Names of the Auto-Generated Stored Procedures](working-with-computed-columns-vb/_static/image11.png)](working-with-computed-columns-vb/_static/image10.png)</span></span>

<span data-ttu-id="62b89-192">**Рис. 4**. Настройка имен автоматически создаваемых хранимых процедур ([щелкните, чтобы просмотреть изображение с полным размером](working-with-computed-columns-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="62b89-192">**Figure 4**: Customize the Names of the Auto-Generated Stored Procedures ([Click to view full-size image](working-with-computed-columns-vb/_static/image12.png))</span></span>

<span data-ttu-id="62b89-193">Следующий шаг мастера позволяет присвоить имя методам TableAdapter и указать шаблоны, используемые для доступа к данным и их обновления.</span><span class="sxs-lookup"><span data-stu-id="62b89-193">The next wizard step allows us to name the TableAdapter s methods and specify the patterns used to access and update data.</span></span> <span data-ttu-id="62b89-194">Оставьте все три флажка установленными, но переименуйте метод `GetData` в `GetSuppliers`.</span><span class="sxs-lookup"><span data-stu-id="62b89-194">Leave all three checkboxes checked, but rename the `GetData` method to `GetSuppliers`.</span></span> <span data-ttu-id="62b89-195">Нажмите кнопку Готово, чтобы завершить работу с мастером.</span><span class="sxs-lookup"><span data-stu-id="62b89-195">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="62b89-196">[![переименование метода GetData в поставщики](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="62b89-196">[![Rename the GetData Method to GetSuppliers](working-with-computed-columns-vb/_static/image14.png)](working-with-computed-columns-vb/_static/image13.png)</span></span>

<span data-ttu-id="62b89-197">**Рис. 5**. Переименование метода `GetData` в `GetSuppliers` ([щелкните, чтобы просмотреть изображение с полным размером](working-with-computed-columns-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="62b89-197">**Figure 5**: Rename the `GetData` Method to `GetSuppliers` ([Click to view full-size image](working-with-computed-columns-vb/_static/image15.png))</span></span>

<span data-ttu-id="62b89-198">После нажатия кнопки Готово мастер создаст четыре хранимых процедуры и добавит TableAdapter и соответствующий объект DataTable в типизированный набор данных.</span><span class="sxs-lookup"><span data-stu-id="62b89-198">Upon clicking Finish, the wizard will create the four stored procedures and add the TableAdapter and corresponding DataTable to the Typed DataSet.</span></span>

## <a name="step-4-including-the-computed-column-in-the-tableadapter-s-main-query"></a><span data-ttu-id="62b89-199">Шаг 4. Включение вычисляемого столбца в основной запрос TableAdapter s</span><span class="sxs-lookup"><span data-stu-id="62b89-199">Step 4: Including the Computed Column in the TableAdapter s Main Query</span></span>

<span data-ttu-id="62b89-200">Теперь необходимо обновить TableAdapter и DataTable, созданные на шаге 3, чтобы включить `FullContactName` вычисляемый столбец.</span><span class="sxs-lookup"><span data-stu-id="62b89-200">We now need to update the TableAdapter and DataTable created in Step 3 to include the `FullContactName` computed column.</span></span> <span data-ttu-id="62b89-201">Данное действие состоит из следующих шагов:</span><span class="sxs-lookup"><span data-stu-id="62b89-201">This involves two steps:</span></span>

1. <span data-ttu-id="62b89-202">Обновление `Suppliers_Select` хранимой процедуры для получения `FullContactName` вычисляемого столбца;</span><span class="sxs-lookup"><span data-stu-id="62b89-202">Updating the `Suppliers_Select` stored procedure to return the `FullContactName` computed column, and</span></span>
2. <span data-ttu-id="62b89-203">Обновление таблицы данных для включения соответствующего столбца `FullContactName`.</span><span class="sxs-lookup"><span data-stu-id="62b89-203">Updating the DataTable to include a corresponding `FullContactName` column.</span></span>

<span data-ttu-id="62b89-204">Начните с перехода к обозреватель сервера и углублением в папку хранимых процедур.</span><span class="sxs-lookup"><span data-stu-id="62b89-204">Start by navigating to the Server Explorer and drilling down into the Stored Procedures folder.</span></span> <span data-ttu-id="62b89-205">Откройте `Suppliers_Select` хранимую процедуру и обновите запрос `SELECT`, включив в него `FullContactName` вычисляемый столбец:</span><span class="sxs-lookup"><span data-stu-id="62b89-205">Open the `Suppliers_Select` stored procedure and update the `SELECT` query to include the `FullContactName` computed column:</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample4.sql)]

<span data-ttu-id="62b89-206">Сохраните изменения в хранимой процедуре, щелкнув значок сохранить на панели инструментов, нажав клавиши CTRL + S или выбрав пункт Сохранить `Suppliers_Select` в меню файл.</span><span class="sxs-lookup"><span data-stu-id="62b89-206">Save the changes to the stored procedure by clicking the Save icon in the Toolbar, by hitting Ctrl+S, or by choosing the Save `Suppliers_Select` option from the File menu.</span></span>

<span data-ttu-id="62b89-207">Затем вернитесь в конструктор наборов данных, щелкните правой кнопкой мыши `SuppliersTableAdapter`и выберите в контекстном меню пункт Настроить.</span><span class="sxs-lookup"><span data-stu-id="62b89-207">Next, return to the DataSet Designer, right-click on the `SuppliersTableAdapter`, and choose Configure from the context-menu.</span></span> <span data-ttu-id="62b89-208">Обратите внимание, что столбец `Suppliers_Select` теперь содержит столбец `FullContactName` в коллекции столбцов данных.</span><span class="sxs-lookup"><span data-stu-id="62b89-208">Note that the `Suppliers_Select` column now includes the `FullContactName` column in its Data Columns collection.</span></span>

<span data-ttu-id="62b89-209">[![запуске мастера настройки TableAdapter для обновления столбцов DataTable s](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="62b89-209">[![Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns](working-with-computed-columns-vb/_static/image17.png)](working-with-computed-columns-vb/_static/image16.png)</span></span>

<span data-ttu-id="62b89-210">**Рис. 6**. Запуск мастера настройки адаптеров таблиц для обновления столбцов DataTable ([щелкните, чтобы просмотреть изображение с полным размером](working-with-computed-columns-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="62b89-210">**Figure 6**: Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns ([Click to view full-size image](working-with-computed-columns-vb/_static/image18.png))</span></span>

<span data-ttu-id="62b89-211">Нажмите кнопку Готово, чтобы завершить работу с мастером.</span><span class="sxs-lookup"><span data-stu-id="62b89-211">Click Finish to complete the wizard.</span></span> <span data-ttu-id="62b89-212">При этом соответствующий столбец будет автоматически добавлен в `SuppliersDataTable`.</span><span class="sxs-lookup"><span data-stu-id="62b89-212">This will automatically add a corresponding column to the `SuppliersDataTable`.</span></span> <span data-ttu-id="62b89-213">Мастер TableAdapter достаточно интеллектуально для определения того, что столбец `FullContactName` является вычисляемым и, следовательно, доступен только для чтения.</span><span class="sxs-lookup"><span data-stu-id="62b89-213">The TableAdapter wizard is smart enough to detect that the `FullContactName` column is a computed column and therefore read-only.</span></span> <span data-ttu-id="62b89-214">Следовательно, он устанавливает для свойства Column `ReadOnly` значение `true`.</span><span class="sxs-lookup"><span data-stu-id="62b89-214">Consequently, it sets the column s `ReadOnly` property to `true`.</span></span> <span data-ttu-id="62b89-215">Чтобы проверить это, выберите столбец из `SuppliersDataTable` а затем перейдите к окно свойств (см. рис. 7).</span><span class="sxs-lookup"><span data-stu-id="62b89-215">To verify this, select the column from the `SuppliersDataTable` and then go to the Properties window (see Figure 7).</span></span> <span data-ttu-id="62b89-216">Обратите внимание, что свойства `FullContactName` столбцов `DataType` и `MaxLength` также заданы соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="62b89-216">Note that the `FullContactName` column s `DataType` and `MaxLength` properties are also set accordingly.</span></span>

<span data-ttu-id="62b89-217">[![столбец Фуллконтактнаме помечен как "только для чтения"](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="62b89-217">[![The FullContactName Column is Marked as Read-Only](working-with-computed-columns-vb/_static/image20.png)](working-with-computed-columns-vb/_static/image19.png)</span></span>

<span data-ttu-id="62b89-218">**Рис. 7**. столбец `FullContactName` помечен как "только для чтения" ([щелкните, чтобы просмотреть изображение с полным размером](working-with-computed-columns-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="62b89-218">**Figure 7**: The `FullContactName` Column is Marked as Read-Only ([Click to view full-size image](working-with-computed-columns-vb/_static/image21.png))</span></span>

## <a name="step-5-adding-agetsupplierbysupplieridmethod-to-the-tableadapter"></a><span data-ttu-id="62b89-219">Шаг 5. Добавление метода`GetSupplierBySupplierID`в TableAdapter</span><span class="sxs-lookup"><span data-stu-id="62b89-219">Step 5: Adding a`GetSupplierBySupplierID`Method to the TableAdapter</span></span>

<span data-ttu-id="62b89-220">В этом учебнике мы создадим страницу ASP.NET, в которой будут отображаться поставщики в обновляемой сетке.</span><span class="sxs-lookup"><span data-stu-id="62b89-220">For this tutorial we will create an ASP.NET page that displays the suppliers in an updateable grid.</span></span> <span data-ttu-id="62b89-221">В прошлых учебных курсах мы обновили одну запись из уровня бизнес-логики, извлекая эту конкретную запись из DAL в виде строго типизированной таблицы данных, обновляя ее свойства, а затем отправляя обновленную таблицу данных обратно в DAL для распространения изменений в база данных.</span><span class="sxs-lookup"><span data-stu-id="62b89-221">In past tutorials we have updated a single record from the Business Logic Layer by retrieving that particular record from the DAL as a strongly-typed DataTable, updating its properties, and then sending the updated DataTable back to the DAL to propagate the changes to the database.</span></span> <span data-ttu-id="62b89-222">Чтобы выполнить этот первый шаг, нужно получить запись, обновляемую из DAL. необходимо сначала добавить в DAL метод `GetSupplierBySupplierID(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="62b89-222">To accomplish this first step - retrieving the record being updated from the DAL - we need to first add a `GetSupplierBySupplierID(supplierID)` method to the DAL.</span></span>

<span data-ttu-id="62b89-223">Щелкните правой кнопкой мыши `SuppliersTableAdapter` в конструкторе набора данных и выберите в контекстном меню пункт Добавить запрос.</span><span class="sxs-lookup"><span data-stu-id="62b89-223">Right-click on the `SuppliersTableAdapter` in the DataSet Design and choose the Add Query option from the context-menu.</span></span> <span data-ttu-id="62b89-224">Как мы делали на шаге 3, позвольте мастеру создать новую хранимую процедуру для нас, выбрав параметр создать новую хранимую процедуру (см. рис. 3 на снимке экрана этого шага мастера).</span><span class="sxs-lookup"><span data-stu-id="62b89-224">As we did in Step 3, let the wizard generate a new stored procedure for us by selecting the Create new stored procedure option (refer back to Figure 3 for a screenshot of this wizard step).</span></span> <span data-ttu-id="62b89-225">Поскольку этот метод возвращает запись с несколькими столбцами, укажите, что нам нужно использовать SQL-запрос, который возвращает строки, и нажмите кнопку Далее.</span><span class="sxs-lookup"><span data-stu-id="62b89-225">Since this method will return a record with multiple columns, indicate that we want to use a SQL query that is a SELECT which returns rows and click Next.</span></span>

<span data-ttu-id="62b89-226">[![выберите параметр выбрать, возвращающий строки.](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="62b89-226">[![Choose the SELECT which returns rows Option](working-with-computed-columns-vb/_static/image23.png)](working-with-computed-columns-vb/_static/image22.png)</span></span>

<span data-ttu-id="62b89-227">**Рис. 8**. Выбор параметра выбор возвращающих строк ([щелкните, чтобы просмотреть изображение с полным размером](working-with-computed-columns-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="62b89-227">**Figure 8**: Choose the SELECT which returns rows Option ([Click to view full-size image](working-with-computed-columns-vb/_static/image24.png))</span></span>

<span data-ttu-id="62b89-228">На следующем шаге мы предложим ввести запрос для использования в этом методе.</span><span class="sxs-lookup"><span data-stu-id="62b89-228">The subsequent step prompts us for the query to use for this method.</span></span> <span data-ttu-id="62b89-229">Введите следующую запись, которая возвращает те же поля данных, что и основной запрос, но для конкретного поставщика.</span><span class="sxs-lookup"><span data-stu-id="62b89-229">Enter the following, which returns the same data fields as the main query but for a particular supplier.</span></span>

[!code-sql[Main](working-with-computed-columns-vb/samples/sample5.sql)]

<span data-ttu-id="62b89-230">На следующем экране запрашивается имя хранимой процедуры, которая будет создана автоматически.</span><span class="sxs-lookup"><span data-stu-id="62b89-230">The next screen asks us to name the stored procedure that will be auto-generated.</span></span> <span data-ttu-id="62b89-231">Назовите эту хранимую процедуру `Suppliers_SelectBySupplierID` и нажмите кнопку Далее.</span><span class="sxs-lookup"><span data-stu-id="62b89-231">Name this stored procedure `Suppliers_SelectBySupplierID` and click Next.</span></span>

<span data-ttu-id="62b89-232">[![имя хранимой процедуры Suppliers_SelectBySupplierID](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="62b89-232">[![Name the Stored Procedure Suppliers_SelectBySupplierID](working-with-computed-columns-vb/_static/image26.png)](working-with-computed-columns-vb/_static/image25.png)</span></span>

<span data-ttu-id="62b89-233">**Рис. 9**. присвойте хранимой процедуре имя `Suppliers_SelectBySupplierID` ([щелкните, чтобы просмотреть изображение с полным размером](working-with-computed-columns-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="62b89-233">**Figure 9**: Name the Stored Procedure `Suppliers_SelectBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image27.png))</span></span>

<span data-ttu-id="62b89-234">Наконец, мастер запрашивает у нас шаблоны доступа к данным и имена методов для использования в TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="62b89-234">Lastly, the wizard prompts us for the data access patterns and method names to use for the TableAdapter.</span></span> <span data-ttu-id="62b89-235">Оставьте оба флажка установленными, но переименуйте `FillBy` и `GetDataBy` методы в `FillBySupplierID` и `GetSupplierBySupplierID`соответственно.</span><span class="sxs-lookup"><span data-stu-id="62b89-235">Leave both checkboxes checked, but rename the `FillBy` and `GetDataBy` methods to `FillBySupplierID` and `GetSupplierBySupplierID`, respectively.</span></span>

<span data-ttu-id="62b89-236">[![назовите методы TableAdapter Филлбисупплиерид и Жетсупплиербисупплиерид.](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="62b89-236">[![Name the TableAdapter Methods FillBySupplierID and GetSupplierBySupplierID](working-with-computed-columns-vb/_static/image29.png)](working-with-computed-columns-vb/_static/image28.png)</span></span>

<span data-ttu-id="62b89-237">**Рис. 10**. Именование методов TableAdapter `FillBySupplierID` и `GetSupplierBySupplierID` ([щелкните, чтобы просмотреть изображение с полным размером](working-with-computed-columns-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="62b89-237">**Figure 10**: Name the TableAdapter Methods `FillBySupplierID` and `GetSupplierBySupplierID` ([Click to view full-size image](working-with-computed-columns-vb/_static/image30.png))</span></span>

<span data-ttu-id="62b89-238">Нажмите кнопку Готово, чтобы завершить работу с мастером.</span><span class="sxs-lookup"><span data-stu-id="62b89-238">Click Finish to complete the wizard.</span></span>

## <a name="step-6-creating-the-business-logic-layer"></a><span data-ttu-id="62b89-239">Шаг 6. Создание уровня бизнес-логики</span><span class="sxs-lookup"><span data-stu-id="62b89-239">Step 6: Creating the Business Logic Layer</span></span>

<span data-ttu-id="62b89-240">Перед созданием страницы ASP.NET, использующей вычисляемый столбец, созданный на шаге 1, сначала необходимо добавить соответствующие методы в BLL.</span><span class="sxs-lookup"><span data-stu-id="62b89-240">Before we create an ASP.NET page that uses the computed column created in Step 1, we first need to add the corresponding methods in the BLL.</span></span> <span data-ttu-id="62b89-241">Наша страница ASP.NET, которая будет создана на шаге 7, позволит пользователям просматривать и изменять поставщиков.</span><span class="sxs-lookup"><span data-stu-id="62b89-241">Our ASP.NET page, which we will create in Step 7, will allow users to view and edit suppliers.</span></span> <span data-ttu-id="62b89-242">Таким образом, нам нужно, чтобы наш BLL предоставил, как минимум, метод для получения всех поставщиков и другого для обновления конкретного поставщика.</span><span class="sxs-lookup"><span data-stu-id="62b89-242">Therefore, we need our BLL to provide, at minimum, a method to get all of the suppliers and another to update a particular supplier.</span></span>

<span data-ttu-id="62b89-243">Создайте новый файл класса с именем `SuppliersBLLWithSprocs` в папке `~/App_Code/BLL` и добавьте следующий код:</span><span class="sxs-lookup"><span data-stu-id="62b89-243">Create a new class file named `SuppliersBLLWithSprocs` in the `~/App_Code/BLL` folder and add the following code:</span></span>

[!code-vb[Main](working-with-computed-columns-vb/samples/sample6.vb)]

<span data-ttu-id="62b89-244">Как и в других классах BLL, `SuppliersBLLWithSprocs` имеет свойство `Protected` `Adapter`, которое возвращает экземпляр класса `SuppliersTableAdapter` вместе с двумя методами `Public`: `GetSuppliers` и `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="62b89-244">Like the other BLL classes, `SuppliersBLLWithSprocs` has a `Protected` `Adapter` property that returns an instance of the `SuppliersTableAdapter` class along with two `Public` methods: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="62b89-245">Метод `GetSuppliers` вызывает и возвращает `SuppliersDataTable`, возвращенный соответствующим методом `GetSupplier` в слое доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="62b89-245">The `GetSuppliers` method calls and returns the `SuppliersDataTable` returned by the corresponding `GetSupplier` method in the Data Access Layer.</span></span> <span data-ttu-id="62b89-246">Метод `UpdateSupplier` извлекает сведения об определенном поставщике, который обновляется посредством вызова метода DAL s `GetSupplierBySupplierID(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="62b89-246">The `UpdateSupplier` method retrieves information about the particular supplier being updated via a call to the DAL s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="62b89-247">Затем он обновляет свойства `CategoryName`, `ContactName`и `ContactTitle` и фиксирует эти изменения в базе данных, вызывая метод доступа к данным уровня s `Update`, передавая измененный объект `SuppliersRow`.</span><span class="sxs-lookup"><span data-stu-id="62b89-247">It then updates the `CategoryName`, `ContactName`, and `ContactTitle` properties and commits these changes to the database by calling the Data Access Layer s `Update` method, passing in the modified `SuppliersRow` object.</span></span>

> [!NOTE]
> <span data-ttu-id="62b89-248">За исключением `SupplierID` и `CompanyName`, все столбцы в таблице «поставщики» допускают значения `NULL`.</span><span class="sxs-lookup"><span data-stu-id="62b89-248">Except for `SupplierID` and `CompanyName`, all columns in the Suppliers table allow `NULL` values.</span></span> <span data-ttu-id="62b89-249">Таким образом, если переданные параметры `contactName` или `contactTitle` `Nothing` необходимо установить соответствующие свойства `ContactName` и `ContactTitle` для `NULL` значения базы данных с помощью методов `SetContactNameNull` и `SetContactTitleNull` соответственно.</span><span class="sxs-lookup"><span data-stu-id="62b89-249">Therefore, if the passed-in `contactName` or `contactTitle` parameters are `Nothing` we need to set the corresponding `ContactName` and `ContactTitle` properties to a `NULL` database value using the `SetContactNameNull` and `SetContactTitleNull` methods, respectively.</span></span>

## <a name="step-7-working-with-the-computed-column-from-the-presentation-layer"></a><span data-ttu-id="62b89-250">Шаг 7. Работа с вычисляемым столбцом на уровне представления</span><span class="sxs-lookup"><span data-stu-id="62b89-250">Step 7: Working with the Computed Column from the Presentation Layer</span></span>

<span data-ttu-id="62b89-251">Если вычисляемый столбец добавлен в таблицу `Suppliers`, а DAL и BLL обновлены соответствующим образом, мы готовы к созданию страницы ASP.NET, которая работает с вычисляемым столбцом `FullContactName`.</span><span class="sxs-lookup"><span data-stu-id="62b89-251">With the computed column added to the `Suppliers` table and the DAL and BLL updated accordingly, we are ready to build an ASP.NET page that works with the `FullContactName` computed column.</span></span> <span data-ttu-id="62b89-252">Для начала откройте страницу `ComputedColumns.aspx` в папке `AdvancedDAL` и перетащите элемент управления GridView с панели инструментов в конструктор.</span><span class="sxs-lookup"><span data-stu-id="62b89-252">Start by opening the `ComputedColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="62b89-253">Задайте для свойства `ID` GridView s значение `Suppliers` и из его смарт-тега привяжите его к новому ObjectDataSource с именем `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="62b89-253">Set the GridView s `ID` property to `Suppliers` and, from its smart tag, bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="62b89-254">Настройте ObjectDataSource для использования класса `SuppliersBLLWithSprocs`, добавленного на шаге 6, и нажмите кнопку Далее.</span><span class="sxs-lookup"><span data-stu-id="62b89-254">Configure the ObjectDataSource to use the `SuppliersBLLWithSprocs` class we added back in Step 6 and click Next.</span></span>

<span data-ttu-id="62b89-255">[![настроить ObjectDataSource для использования класса Супплиерсбллвисспрокс](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="62b89-255">[![Configure the ObjectDataSource to Use the SuppliersBLLWithSprocs Class](working-with-computed-columns-vb/_static/image32.png)](working-with-computed-columns-vb/_static/image31.png)</span></span>

<span data-ttu-id="62b89-256">**Рис. 11**. Настройка ObjectDataSource для использования класса `SuppliersBLLWithSprocs` ([щелкните, чтобы просмотреть изображение с полным размером](working-with-computed-columns-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="62b89-256">**Figure 11**: Configure the ObjectDataSource to Use the `SuppliersBLLWithSprocs` Class ([Click to view full-size image](working-with-computed-columns-vb/_static/image33.png))</span></span>

<span data-ttu-id="62b89-257">В классе `SuppliersBLLWithSprocs` определены только два метода: `GetSuppliers` и `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="62b89-257">There are only two methods defined in the `SuppliersBLLWithSprocs` class: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="62b89-258">Убедитесь, что эти два метода указаны на вкладках выбор и обновление соответственно, и нажмите кнопку Готово, чтобы завершить настройку ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="62b89-258">Ensure that these two methods are specified in the SELECT and UPDATE tabs, respectively, and click Finish to complete the configuration of the ObjectDataSource.</span></span>

<span data-ttu-id="62b89-259">После завершения работы мастера настройки источника данных Visual Studio добавит BoundField для каждого возвращаемого поля данных.</span><span class="sxs-lookup"><span data-stu-id="62b89-259">Upon completion of the Data Source Configuration wizard, Visual Studio will add a BoundField for each of the data fields returned.</span></span> <span data-ttu-id="62b89-260">Удалите `SupplierID` BoundField и измените свойства `HeaderText` `CompanyName`, `ContactName`, `ContactTitle`и `FullContactName` BoundFields на "компания", "имя контакта", "заголовок" и "полное имя контакта" соответственно.</span><span class="sxs-lookup"><span data-stu-id="62b89-260">Remove the `SupplierID` BoundField and change the `HeaderText` properties of the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` BoundFields to Company, Contact Name, Title, and Full Contact Name, respectively.</span></span> <span data-ttu-id="62b89-261">В смарт-теге установите флажок Enable Edit (включить редактирование), чтобы включить встроенные возможности редактирования GridView s.</span><span class="sxs-lookup"><span data-stu-id="62b89-261">From the smart tag, check the Enable Editing checkbox to turn on the GridView s built-in editing capabilities.</span></span>

<span data-ttu-id="62b89-262">Помимо добавления BoundFields в GridView, завершение работы мастера источников данных также приводит к тому, что Visual Studio устанавливает свойство `OldValuesParameterFormatString` ObjectDataSource s в исходное\_{0}.</span><span class="sxs-lookup"><span data-stu-id="62b89-262">In addition to adding BoundFields to the GridView, completion of the Data Source Wizard also causes Visual Studio to set the ObjectDataSource s `OldValuesParameterFormatString` property to original\_{0}.</span></span> <span data-ttu-id="62b89-263">Верните этот параметр к значению по умолчанию {0}.</span><span class="sxs-lookup"><span data-stu-id="62b89-263">Revert this setting back to its default value, {0} .</span></span>

<span data-ttu-id="62b89-264">После внесения этих изменений в GridView и ObjectDataSource их декларативная разметка должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="62b89-264">After making these edits to the GridView and ObjectDataSource, their declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](working-with-computed-columns-vb/samples/sample7.aspx)]

<span data-ttu-id="62b89-265">Затем перейдите на эту страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="62b89-265">Next, visit this page through a browser.</span></span> <span data-ttu-id="62b89-266">Как показано на рис. 12, каждый поставщик перечислен в сетке, которая содержит столбец `FullContactName`, значение которого является просто объединением других трех столбцов, отформатированных как `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="62b89-266">As Figure 12 shows, each supplier is listed in a grid that includes the `FullContactName` column, whose value is simply the concatenation of the other three columns formatted as `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>

<span data-ttu-id="62b89-267">[![каждый поставщик указан в сетке](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="62b89-267">[![Each Supplier is Listed in the Grid](working-with-computed-columns-vb/_static/image35.png)](working-with-computed-columns-vb/_static/image34.png)</span></span>

<span data-ttu-id="62b89-268">**Рис. 12**. Каждый поставщик отображается в сетке ([щелкните, чтобы просмотреть изображение с полным размером](working-with-computed-columns-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="62b89-268">**Figure 12**: Each Supplier is Listed in the Grid ([Click to view full-size image](working-with-computed-columns-vb/_static/image36.png))</span></span>

<span data-ttu-id="62b89-269">Нажатие кнопки "Изменить" для конкретного поставщика вызывает обратную передачу и отрисовывает эту строку в интерфейсе редактирования (см. рис. 13).</span><span class="sxs-lookup"><span data-stu-id="62b89-269">Clicking the Edit button for a particular supplier causes a postback and has that row rendered in its editing interface (see Figure 13).</span></span> <span data-ttu-id="62b89-270">Первые три столбца отображаются в интерфейсе редактирования по умолчанию — элемент управления TextBox, для свойства `Text` которого задано значение поля данных.</span><span class="sxs-lookup"><span data-stu-id="62b89-270">The first three columns render in their default editing interface - a TextBox control whose `Text` property is set to the value of the data field.</span></span> <span data-ttu-id="62b89-271">Однако столбец `FullContactName` остается в виде текста.</span><span class="sxs-lookup"><span data-stu-id="62b89-271">The `FullContactName` column, however, remains as text.</span></span> <span data-ttu-id="62b89-272">Когда BoundFields был добавлен в GridView после завершения работы мастера настройки источника данных, свойству `FullContactName` BoundField `ReadOnly` s было присвоено значение `True`, так как для соответствующего `FullContactName` столбца в `SuppliersDataTable` свойство `ReadOnly` имеет значение `True`.</span><span class="sxs-lookup"><span data-stu-id="62b89-272">When the BoundFields were added to the GridView at the completion of the Data Source Configuration wizard, the `FullContactName` BoundField s `ReadOnly` property was set to `True` because the corresponding `FullContactName` column in the `SuppliersDataTable` has its `ReadOnly` property set to `True`.</span></span> <span data-ttu-id="62b89-273">Как отмечалось на шаге 4, свойству `FullContactName` s `ReadOnly` было присвоено значение `True`, поскольку TableAdapter обнаружил, что столбец был вычисляемым столбцом.</span><span class="sxs-lookup"><span data-stu-id="62b89-273">As noted in Step 4, the `FullContactName` s `ReadOnly` property was set to `True` because the TableAdapter detected that the column was a computed column.</span></span>

<span data-ttu-id="62b89-274">[![столбец Фуллконтактнаме недоступен для редактирования](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="62b89-274">[![The FullContactName Column is Not Editable](working-with-computed-columns-vb/_static/image38.png)](working-with-computed-columns-vb/_static/image37.png)</span></span>

<span data-ttu-id="62b89-275">**Рис. 13**. столбец `FullContactName` недоступен для редактирования ([щелкните, чтобы просмотреть изображение с полным размером](working-with-computed-columns-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="62b89-275">**Figure 13**: The `FullContactName` Column is Not Editable ([Click to view full-size image](working-with-computed-columns-vb/_static/image39.png))</span></span>

<span data-ttu-id="62b89-276">Обновите значение одного или нескольких редактируемых столбцов и нажмите кнопку "Обновить".</span><span class="sxs-lookup"><span data-stu-id="62b89-276">Go ahead and update the value of one or more of the editable columns and click Update.</span></span> <span data-ttu-id="62b89-277">Обратите внимание, что значение `FullContactName` s автоматически обновляется, чтобы отразить изменение.</span><span class="sxs-lookup"><span data-stu-id="62b89-277">Note how the `FullContactName` s value is automatically updated to reflect the change.</span></span>

> [!NOTE]
> <span data-ttu-id="62b89-278">В настоящее время GridView использует BoundFields для редактируемых полей, что приводит к интерфейсу редактирования по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="62b89-278">The GridView currently uses BoundFields for the editable fields, resulting in the default editing interface.</span></span> <span data-ttu-id="62b89-279">Так как поле `CompanyName` является обязательным, оно должно быть преобразовано в TemplateField, включающее RequiredFieldValidator.</span><span class="sxs-lookup"><span data-stu-id="62b89-279">Since the `CompanyName` field is required, it should be converted into a TemplateField that includes a RequiredFieldValidator.</span></span> <span data-ttu-id="62b89-280">Я оставлю это в качестве упражнения для заинтересованного читателя.</span><span class="sxs-lookup"><span data-stu-id="62b89-280">I leave this as an exercise for the interested reader.</span></span> <span data-ttu-id="62b89-281">Пошаговые инструкции по преобразованию BoundField в TemplateField и добавлению элементов управления проверки см. в руководстве [Добавление элементов управления проверки в интерфейсы правки и вставки](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="62b89-281">Consult the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial for step-by-step instructions on converting a BoundField to a TemplateField and adding validation controls.</span></span>

## <a name="summary"></a><span data-ttu-id="62b89-282">Сводка</span><span class="sxs-lookup"><span data-stu-id="62b89-282">Summary</span></span>

<span data-ttu-id="62b89-283">При определении схемы для таблицы Microsoft SQL Server позволяет включать в нее вычисленные столбцы.</span><span class="sxs-lookup"><span data-stu-id="62b89-283">When defining the schema for a table, Microsoft SQL Server allows the inclusion of computed columns.</span></span> <span data-ttu-id="62b89-284">Это столбцы, значения которых рассчитываются из выражения, которое обычно ссылается на значения из других столбцов в той же записи.</span><span class="sxs-lookup"><span data-stu-id="62b89-284">These are columns whose values are calculated from an expression that usually references the values from other columns in the same record.</span></span> <span data-ttu-id="62b89-285">Поскольку значения для вычисленных столбцов основаны на выражении, они доступны только для чтения и им нельзя присвоить значение в `INSERT` или `UPDATE` инструкции.</span><span class="sxs-lookup"><span data-stu-id="62b89-285">Since the values for computed columns are based on an expression, they are read-only and cannot be assigned a value in an `INSERT` or `UPDATE` statement.</span></span> <span data-ttu-id="62b89-286">Это приводит к проблемам при использовании вычисляемого столбца в основном запросе адаптера таблицы TableAdapter, который пытается автоматически формировать соответствующие инструкции `INSERT`, `UPDATE`и `DELETE`.</span><span class="sxs-lookup"><span data-stu-id="62b89-286">This introduces challenges when using a computed column in the main query of a TableAdapter that tries to automatically generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span>

<span data-ttu-id="62b89-287">В этом учебнике мы обсуждали методы обхода проблем, вызванных вычисленными столбцами.</span><span class="sxs-lookup"><span data-stu-id="62b89-287">In this tutorial we discussed techniques for circumventing the challenges posed by computed columns.</span></span> <span data-ttu-id="62b89-288">В частности, мы использовали хранимые процедуры в нашем TableAdapter для преодоления хрупкости, встроенных в адаптеры TableAdapter, которые используют специальные инструкции SQL.</span><span class="sxs-lookup"><span data-stu-id="62b89-288">In particular, we used stored procedures in our TableAdapter to overcome the brittleness inherent in TableAdapters that use ad-hoc SQL statements.</span></span> <span data-ttu-id="62b89-289">При создании новых хранимых процедур с помощью мастера TableAdapter важно, чтобы основной запрос изначально не пропустил все вычисленные столбцы, так как их присутствие не позволит создавать хранимые процедуры модификации данных.</span><span class="sxs-lookup"><span data-stu-id="62b89-289">When having the TableAdapter wizard create new stored procedures, it is important that we have the main query initially omit any computed columns because their presence prevents the data modification stored procedures from being generated.</span></span> <span data-ttu-id="62b89-290">После первоначальной настройки TableAdapter можно повторно включить в его `SelectCommand` хранимую процедуру, включив в нее все вычисленные столбцы.</span><span class="sxs-lookup"><span data-stu-id="62b89-290">After the TableAdapter has been initially configured, its `SelectCommand` stored procedure can be retooled to include any computed columns.</span></span>

<span data-ttu-id="62b89-291">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="62b89-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="62b89-292">Об авторе</span><span class="sxs-lookup"><span data-stu-id="62b89-292">About the Author</span></span>

<span data-ttu-id="62b89-293">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="62b89-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="62b89-294">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="62b89-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="62b89-295">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="62b89-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="62b89-296">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="62b89-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="62b89-297">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="62b89-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="62b89-298">Специальная благодарность</span><span class="sxs-lookup"><span data-stu-id="62b89-298">Special Thanks To</span></span>

<span data-ttu-id="62b89-299">Эта серия руководств была рассмотрена многими полезными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="62b89-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="62b89-300">Потенциальные рецензенты для этого учебника были Хилтон Жеисенов и Терезой Мерфи.</span><span class="sxs-lookup"><span data-stu-id="62b89-300">Lead reviewers for this tutorial were Hilton Geisenow and Teresa Murphy.</span></span> <span data-ttu-id="62b89-301">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="62b89-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="62b89-302">Если это так, расположите строку в [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="62b89-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="62b89-303">[Назад](adding-additional-datatable-columns-vb.md)
> [Вперед](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span><span class="sxs-lookup"><span data-stu-id="62b89-303">[Previous](adding-additional-datatable-columns-vb.md)
[Next](configuring-the-data-access-layer-s-connection-and-command-level-settings-vb.md)</span></span>
