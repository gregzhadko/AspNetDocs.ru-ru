---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-vb
title: Фильтрация с помощью элемента управления DropDownList (VB) основной/подробности | Документация Майкрософт
author: rick-anderson
description: В этом руководстве будет показано, как отображение основных записей в элемент управления DropDownList и сведений выбранного элемента списка в элементе управления GridView.
ms.author: riande
ms.date: 03/31/2010
ms.assetid: ea44717e-ab2e-46cd-a692-e4a9c0de194c
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-vb
msc.type: authoredcontent
ms.openlocfilehash: d9d50da7f11d1494d49fbeaa18a45991e577cdb3
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/01/2019
ms.locfileid: "57027991"
---
<a name="masterdetail-filtering-with-a-dropdownlist-vb"></a><span data-ttu-id="c6d41-103">Фильтрация "Основной/подробности" с помощью элемента управления DropDownList (VB)</span><span class="sxs-lookup"><span data-stu-id="c6d41-103">Master/Detail Filtering With a DropDownList (VB)</span></span>
====================
<span data-ttu-id="c6d41-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c6d41-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c6d41-105">[Скачайте пример приложения](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_7_VB.exe) или [скачать PDF](master-detail-filtering-with-a-dropdownlist-vb/_static/datatutorial07vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c6d41-105">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_7_VB.exe) or [Download PDF](master-detail-filtering-with-a-dropdownlist-vb/_static/datatutorial07vb1.pdf)</span></span>

> <span data-ttu-id="c6d41-106">В этом руководстве будет показано, как отображение основных записей в элемент управления DropDownList и сведений выбранного элемента списка в элементе управления GridView.</span><span class="sxs-lookup"><span data-stu-id="c6d41-106">In this tutorial we'll see how to display the master records in a DropDownList control and the details of the selected list item in a GridView.</span></span>


## <a name="introduction"></a><span data-ttu-id="c6d41-107">Вступление</span><span class="sxs-lookup"><span data-stu-id="c6d41-107">Introduction</span></span>

<span data-ttu-id="c6d41-108">Распространенным типом отчета является *отчет "основной/подробности"*, в который начинается с демонстрации определенного набора «основных» записей.</span><span class="sxs-lookup"><span data-stu-id="c6d41-108">A common type of report is the *master/detail report*, in which the report begins by showing some set of "master" records.</span></span> <span data-ttu-id="c6d41-109">Пользователь может затем перейти к одной из основных записей, таким образом просматривая основной записи «подробности».</span><span class="sxs-lookup"><span data-stu-id="c6d41-109">The user can then drill down into one of the master records, thereby viewing that master record's "details."</span></span> <span data-ttu-id="c6d41-110">«Основной/подробности» сообщает являются идеальным выбором для визуализации отношений «один ко многим», например отчет все категории и позволяющего пользователю выбрать определенную категорию и отобразить соответствующие продукты.</span><span class="sxs-lookup"><span data-stu-id="c6d41-110">Master/detail reports are an ideal choice for visualizing one-to-many relationships, such as a report showing all of the categories and then allowing a user to select a particular category and display its associated products.</span></span> <span data-ttu-id="c6d41-111">Кроме того отчеты «основной/подробности» полезны для отображения подробных сведений из чрезвычайно «широких» таблиц (таблиц со множеством столбцов).</span><span class="sxs-lookup"><span data-stu-id="c6d41-111">Additionally, master/detail reports are useful for displaying detailed information from particularly "wide" tables (ones that have a lot of columns).</span></span> <span data-ttu-id="c6d41-112">Например, уровень «основной» отчета «основной/подробности» могут отображаться только продукта имя и цену за единицу продуктов в базе данных, и подробное изучение конкретного продукта будет отображать дополнительные поля продукта (категория, поставщик, количество в единицах измерения, и т. д).</span><span class="sxs-lookup"><span data-stu-id="c6d41-112">For example, the "master" level of a master/detail report might show just the product name and unit price of the products in the database, and drilling down into a particular product would show the additional product fields (category, supplier, quantity per unit, and so on).</span></span>

<span data-ttu-id="c6d41-113">Существует много способов, с помощью которых можно реализовать отчета «основной/подробности».</span><span class="sxs-lookup"><span data-stu-id="c6d41-113">There are many ways with which a master/detail report can be implemented.</span></span> <span data-ttu-id="c6d41-114">В этом и трех следующих руководствах мы рассмотрим различные отчеты «основной/подробности».</span><span class="sxs-lookup"><span data-stu-id="c6d41-114">Over this and the next three tutorials we'll look at a variety of master/detail reports.</span></span> <span data-ttu-id="c6d41-115">В этом руководстве мы рассмотрим отображение основных записей в [управления DropDownList](https://msdn.microsoft.com/library/dtx91y0z.aspx) и сведений выбранного элемента списка в элементе управления GridView.</span><span class="sxs-lookup"><span data-stu-id="c6d41-115">In this tutorial we'll see how to display the master records in a [DropDownList control](https://msdn.microsoft.com/library/dtx91y0z.aspx) and the details of the selected list item in a GridView.</span></span> <span data-ttu-id="c6d41-116">В частности отчет «основной/подробности» этого руководства будут перечислены категории и сведения о продукте.</span><span class="sxs-lookup"><span data-stu-id="c6d41-116">In particular, this tutorial's master/detail report will list category and product information.</span></span>

## <a name="step-1-displaying-the-categories-in-a-dropdownlist"></a><span data-ttu-id="c6d41-117">Шаг 1. Отображение категорий в элементе управления DropDownList</span><span class="sxs-lookup"><span data-stu-id="c6d41-117">Step 1: Displaying the Categories in a DropDownList</span></span>

<span data-ttu-id="c6d41-118">Категории в элементе управления DropDownList, перечислит нашего отчета «основной/подробности» с продуктами выбранного элемента списка отображаются ниже на странице в элементе управления GridView.</span><span class="sxs-lookup"><span data-stu-id="c6d41-118">Our master/detail report will list the categories in a DropDownList, with the selected list item's products displayed further down in the page in a GridView.</span></span> <span data-ttu-id="c6d41-119">Первой задачей, то категорий, отображаемых в элементе управления DropDownList.</span><span class="sxs-lookup"><span data-stu-id="c6d41-119">The first task ahead of us, then, is to have the categories displayed in a DropDownList.</span></span> <span data-ttu-id="c6d41-120">Откройте `FilterByDropDownList.aspx` странице в `Filtering` папки, перетащите DropDownList с панели элементов в конструктор страницы и задать его `ID` свойства `Categories`.</span><span class="sxs-lookup"><span data-stu-id="c6d41-120">Open the `FilterByDropDownList.aspx` page in the `Filtering` folder, drag on a DropDownList from the Toolbox onto the page's designer, and set its `ID` property to `Categories`.</span></span> <span data-ttu-id="c6d41-121">Затем щелкните ссылку выберите источник данных смарт-теге DropDownList.</span><span class="sxs-lookup"><span data-stu-id="c6d41-121">Next, click on the Choose Data Source link from the DropDownList's smart tag.</span></span> <span data-ttu-id="c6d41-122">Откроется мастер настройки источника данных.</span><span class="sxs-lookup"><span data-stu-id="c6d41-122">This will display the Data Source Configuration wizard.</span></span>


<span data-ttu-id="c6d41-123">[![Укажите источник данных DropDownList](master-detail-filtering-with-a-dropdownlist-vb/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c6d41-123">[![Specify the DropDownList's Data Source](master-detail-filtering-with-a-dropdownlist-vb/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image1.png)</span></span>

<span data-ttu-id="c6d41-124">**Рис. 1**: Укажите источник данных DropDownList ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="c6d41-124">**Figure 1**: Specify the DropDownList's Data Source ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image3.png))</span></span>


<span data-ttu-id="c6d41-125">Добавить новый ObjectDataSource, именуемый `CategoriesDataSource` , вызывающий `CategoriesBLL` класса `GetCategories()` метод.</span><span class="sxs-lookup"><span data-stu-id="c6d41-125">Choose to add a new ObjectDataSource named `CategoriesDataSource` that invokes the `CategoriesBLL` class's `GetCategories()` method.</span></span>


<span data-ttu-id="c6d41-126">[![Добавьте новый ObjectDataSource, именуемый CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-vb/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="c6d41-126">[![Add a New ObjectDataSource Named CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-vb/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image4.png)</span></span>

<span data-ttu-id="c6d41-127">**Рис. 2**: Добавить новый элемент управления ObjectDataSource с именем `CategoriesDataSource` ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="c6d41-127">**Figure 2**: Add a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image6.png))</span></span>


<span data-ttu-id="c6d41-128">[![Выберите для использования класса](master-detail-filtering-with-a-dropdownlist-vb/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="c6d41-128">[![Choose to Use the CategoriesBLL Class](master-detail-filtering-with-a-dropdownlist-vb/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image7.png)</span></span>

<span data-ttu-id="c6d41-129">**Рис. 3**: Выбор `CategoriesBLL` класс ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="c6d41-129">**Figure 3**: Choose to Use the `CategoriesBLL` Class ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image9.png))</span></span>


<span data-ttu-id="c6d41-130">[![Настройте элемент ObjectDataSource для использования метода GetCategories()](master-detail-filtering-with-a-dropdownlist-vb/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="c6d41-130">[![Configure the ObjectDataSource to Use the GetCategories() Method](master-detail-filtering-with-a-dropdownlist-vb/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image10.png)</span></span>

<span data-ttu-id="c6d41-131">**Рис. 4**: Настройка ObjectDataSource для использования `GetCategories()` метод ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="c6d41-131">**Figure 4**: Configure the ObjectDataSource to Use the `GetCategories()` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image12.png))</span></span>


<span data-ttu-id="c6d41-132">После настройки ObjectDataSource все равно небходимо указать поле источника данных, которые должны отображаться в DropDownList, а какие должно быть связано в качестве значения для элемента списка.</span><span class="sxs-lookup"><span data-stu-id="c6d41-132">After configuring the ObjectDataSource we still need to specify what data source field should be displayed in DropDownList and which one should be associated as the value for the list item.</span></span> <span data-ttu-id="c6d41-133">У `CategoryName` как отображение и `CategoryID` как значение для каждого элемента списка.</span><span class="sxs-lookup"><span data-stu-id="c6d41-133">Have the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>


<span data-ttu-id="c6d41-134">[![Иметь элемент управления DropDownList отображает поле «Категория» и CategoryID использовать как значение](master-detail-filtering-with-a-dropdownlist-vb/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="c6d41-134">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-a-dropdownlist-vb/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image13.png)</span></span>

<span data-ttu-id="c6d41-135">**Рис. 5**: Иметь элемент управления DropDownList отображает `CategoryName` и использует `CategoryID` как значение ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="c6d41-135">**Figure 5**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image15.png))</span></span>


<span data-ttu-id="c6d41-136">На этом этапе у нас есть элемент управления DropDownList, заполненный записями из `Categories` (все действия выполняются приблизительно за шесть секунд).</span><span class="sxs-lookup"><span data-stu-id="c6d41-136">At this point we have a DropDownList control that's populated with the records from the `Categories` table (all accomplished in about six seconds).</span></span> <span data-ttu-id="c6d41-137">Рис. 6 показаны до сих при просмотре через браузер.</span><span class="sxs-lookup"><span data-stu-id="c6d41-137">Figure 6 shows our progress thus far when viewed through a browser.</span></span>


<span data-ttu-id="c6d41-138">[![Раскрывающийся список с текущими категориями](master-detail-filtering-with-a-dropdownlist-vb/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="c6d41-138">[![A Drop-Down Lists the Current Categories](master-detail-filtering-with-a-dropdownlist-vb/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image16.png)</span></span>

<span data-ttu-id="c6d41-139">**Рис. 6**: Раскрывающийся список текущих категорий ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="c6d41-139">**Figure 6**: A Drop-Down Lists the Current Categories ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image18.png))</span></span>


## <a name="step-2-adding-the-products-gridview"></a><span data-ttu-id="c6d41-140">Шаг 2. Добавление элемента GridView с продуктами</span><span class="sxs-lookup"><span data-stu-id="c6d41-140">Step 2: Adding the Products GridView</span></span>

<span data-ttu-id="c6d41-141">Последним шагом создания отчета «основной/подробности» является отображение списка продуктов, связанных с выбранной категорией.</span><span class="sxs-lookup"><span data-stu-id="c6d41-141">That last step in our master/detail report is to list the products associated with the selected category.</span></span> <span data-ttu-id="c6d41-142">Для этого добавьте на страницу GridView и создайте новый ObjectDataSource, именуемый `productsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="c6d41-142">To accomplish this, add a GridView to the page and create a new ObjectDataSource named `productsDataSource`.</span></span> <span data-ttu-id="c6d41-143">У `productsDataSource` должен получать данные от `ProductsBLL` класса `GetProductsByCategoryID(categoryID)` метод.</span><span class="sxs-lookup"><span data-stu-id="c6d41-143">Have the `productsDataSource` control cull its data from the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span>


<span data-ttu-id="c6d41-144">[![Выберите метод GetProductsByCategoryID(categoryID)](master-detail-filtering-with-a-dropdownlist-vb/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="c6d41-144">[![Select the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-a-dropdownlist-vb/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image19.png)</span></span>

<span data-ttu-id="c6d41-145">**Рис. 7**: Выберите `GetProductsByCategoryID(categoryID)` метод ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="c6d41-145">**Figure 7**: Select the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image21.png))</span></span>


<span data-ttu-id="c6d41-146">После выбора этого метода мастер ObjectDataSource запрашивает значения для метода *`categoryID`* параметра.</span><span class="sxs-lookup"><span data-stu-id="c6d41-146">After choosing this method, the ObjectDataSource wizard prompts us for the value for the method's *`categoryID`* parameter.</span></span> <span data-ttu-id="c6d41-147">Чтобы использовать значение выбранного `categories` элемент DropDownList источника параметра установите для элемента управления, а для ControlID – `Categories`.</span><span class="sxs-lookup"><span data-stu-id="c6d41-147">To use the value of the selected `categories` DropDownList item set the Parameter source to Control and the ControlID to `Categories`.</span></span>


<span data-ttu-id="c6d41-148">[![Значение параметра categoryID значение DropDownList категорий](master-detail-filtering-with-a-dropdownlist-vb/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="c6d41-148">[![Set the categoryID Parameter to the Value of the Categories DropDownList](master-detail-filtering-with-a-dropdownlist-vb/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image22.png)</span></span>

<span data-ttu-id="c6d41-149">**Рис. 8**: Задайте *`categoryID`* параметр значению `Categories` DropDownList ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="c6d41-149">**Figure 8**: Set the *`categoryID`* Parameter to the Value of the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image24.png))</span></span>


<span data-ttu-id="c6d41-150">Отвлекитесь и просмотрите ход работы в браузере.</span><span class="sxs-lookup"><span data-stu-id="c6d41-150">Take a moment to check out our progress in a browser.</span></span> <span data-ttu-id="c6d41-151">При первом просмотре страницы, продукты, принадлежащие выбранной категории (Напитки) отображаются (как показано на рис. 9), но изменения в элемент управления DropDownList данные не обновляются.</span><span class="sxs-lookup"><span data-stu-id="c6d41-151">When first visiting the page, those products belong to the selected category (Beverages) are displayed (as shown in Figure 9), but changing the DropDownList doesn't update the data.</span></span> <span data-ttu-id="c6d41-152">Это обусловлено тем, для обновления GridView необходимо осуществление обратной передачи.</span><span class="sxs-lookup"><span data-stu-id="c6d41-152">This is because a postback must occur for the GridView to update.</span></span> <span data-ttu-id="c6d41-153">Для этого у нас есть два варианта (ни один из которых требует написания кода):</span><span class="sxs-lookup"><span data-stu-id="c6d41-153">To accomplish this we have two options (neither of which requires writing any code):</span></span>

- <span data-ttu-id="c6d41-154">**Задайте свойства AutoPostBack**[свойство AutoPostBack](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)**значение true.**</span><span class="sxs-lookup"><span data-stu-id="c6d41-154">**Set the categories DropDownList's**[AutoPostBack property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)**to True.**</span></span> <span data-ttu-id="c6d41-155">(Это можно сделать, выбрав вариант включить AutoPostBack в смарт-теге DropDownList.) Это приведет к запуску обратную передачу при выборе DropDownList элемент изменен пользователем.</span><span class="sxs-lookup"><span data-stu-id="c6d41-155">(You can accomplish this by checking the Enable AutoPostBack option in the DropDownList's smart tag.) This will trigger a postback whenever the DropDownList's selected item is changed by the user.</span></span> <span data-ttu-id="c6d41-156">Таким образом когда пользователь выбирает новую категорию в элементе управления DropDownList произойдет обратная передача и GridView будет обновлен продуктами для новой выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="c6d41-156">Therefore, when the user selects a new category from the DropDownList a postback will ensue and the GridView will be updated with the products for the newly selected category.</span></span> <span data-ttu-id="c6d41-157">(Это подход, который я использовал в этом руководстве).</span><span class="sxs-lookup"><span data-stu-id="c6d41-157">(This is the approach I've used in this tutorial.)</span></span>
- <span data-ttu-id="c6d41-158">**Добавьте кнопку веб-элемент управления рядом с DropDownList.**</span><span class="sxs-lookup"><span data-stu-id="c6d41-158">**Add a Button Web control next to the DropDownList.**</span></span> <span data-ttu-id="c6d41-159">Задайте его `Text` свойство для обновления или что-то подобное.</span><span class="sxs-lookup"><span data-stu-id="c6d41-159">Set its `Text` property to Refresh or something similar.</span></span> <span data-ttu-id="c6d41-160">При таком подходе пользователь потребуется выбрать новую категорию и нажмите кнопку.</span><span class="sxs-lookup"><span data-stu-id="c6d41-160">With this approach, the user will need to select a new category and then click the Button.</span></span> <span data-ttu-id="c6d41-161">Нажмите кнопку вызывает обратную передачу и обновление GridView отображены продукты выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="c6d41-161">Clicking the Button will cause a postback and update the GridView to list those products of the selected category.</span></span>

<span data-ttu-id="c6d41-162">На рис. 9 и 10 показана работа отчета «основной/подробности» в действии.</span><span class="sxs-lookup"><span data-stu-id="c6d41-162">Figures 9 and 10 illustrate the master/detail report in action.</span></span>


<span data-ttu-id="c6d41-163">[![При первом просмотре странице отображаются продукты отображаются](master-detail-filtering-with-a-dropdownlist-vb/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="c6d41-163">[![When First Visiting the Page, the Beverage Products are Displayed](master-detail-filtering-with-a-dropdownlist-vb/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image25.png)</span></span>

<span data-ttu-id="c6d41-164">**Рис. 9**: При первом просмотре странице отображаются продукты отображаются ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="c6d41-164">**Figure 9**: When First Visiting the Page, the Beverage Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image27.png))</span></span>


<span data-ttu-id="c6d41-165">[![Выбор нового продукта (Produce) автоматически вызывает обратную передачу, обновляется GridView](master-detail-filtering-with-a-dropdownlist-vb/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="c6d41-165">[![Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView](master-detail-filtering-with-a-dropdownlist-vb/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image28.png)</span></span>

<span data-ttu-id="c6d41-166">**Рис. 10**: Выбор нового продукта (Produce) автоматически вызывает обратную передачу, обновляется GridView ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="c6d41-166">**Figure 10**: Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image30.png))</span></span>


## <a name="adding-a----choose-a-category----list-item"></a><span data-ttu-id="c6d41-167">Добавление элемента списка «--выберите категорию--»</span><span class="sxs-lookup"><span data-stu-id="c6d41-167">Adding a "-- Choose a Category --" List Item</span></span>

<span data-ttu-id="c6d41-168">При первом просмотре `FilterByDropDownList.aspx` странице категорий, по умолчанию, показывающие отображаются продукты в GridView выбран первый элемент списка DropDownList (Напитки).</span><span class="sxs-lookup"><span data-stu-id="c6d41-168">When first visiting the `FilterByDropDownList.aspx` page the categories DropDownList's first list item (Beverages) is selected by default, showing the beverage products in the GridView.</span></span> <span data-ttu-id="c6d41-169">Вместо отображения продуктов первой категории, нам может потребоваться вместо этого элемент DropDownList выбран, — говорит нечто вроде: «--выберите категорию--».</span><span class="sxs-lookup"><span data-stu-id="c6d41-169">Rather than showing the first category's products, we may want to instead have a DropDownList item selected that says something like, "-- Choose a Category --".</span></span>

<span data-ttu-id="c6d41-170">Чтобы добавить новый элемент списка DropDownList, перейдите в окно свойств и щелкните эллипсы в `Items` свойство.</span><span class="sxs-lookup"><span data-stu-id="c6d41-170">To add a new list item to the DropDownList, go to the Properties window and click on the ellipses in the `Items` property.</span></span> <span data-ttu-id="c6d41-171">Добавить новый элемент списка с `Text` «--выберите категорию--» и `Value` `-1`.</span><span class="sxs-lookup"><span data-stu-id="c6d41-171">Add a new list item with the `Text` "-- Choose a Category --" and the `Value` `-1`.</span></span>


<span data-ttu-id="c6d41-172">[![Добавление выберите категорию--элемента списка](master-detail-filtering-with-a-dropdownlist-vb/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="c6d41-172">[![Add a -- Choose a Category -- List Item](master-detail-filtering-with-a-dropdownlist-vb/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image31.png)</span></span>

<span data-ttu-id="c6d41-173">**Рис. 11**: Добавление выберите категорию--элемент списка ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="c6d41-173">**Figure 11**: Add a -- Choose a Category -- List Item ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image33.png))</span></span>


<span data-ttu-id="c6d41-174">Кроме того можно добавить элемент списка, добавив следующую разметку в элемент управления DropDownList:</span><span class="sxs-lookup"><span data-stu-id="c6d41-174">Alternatively, you can add the list item by adding the following markup to the DropDownList:</span></span>


[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-vb/samples/sample1.aspx)]

<span data-ttu-id="c6d41-175">Кроме того, нам нужно установить элемент управления DropDownList `AppendDataBoundItems` значение True, так как при привязке категорий к DropDownList из ObjectDataSource они будут перезаписывать все элементы списка, добавленные вручную, если `AppendDataBoundItems` не установлено значение True.</span><span class="sxs-lookup"><span data-stu-id="c6d41-175">Additionally, we need to set the DropDownList control's `AppendDataBoundItems` to True because when the categories are bound to the DropDownList from the ObjectDataSource they'll overwrite any manually-added list items if `AppendDataBoundItems` isn't True.</span></span>


![Установите для свойства AppendDataBoundItems значение true](master-detail-filtering-with-a-dropdownlist-vb/_static/image34.png)

<span data-ttu-id="c6d41-177">**Рис. 12**: Задайте `AppendDataBoundItems` присваивается значение True</span><span class="sxs-lookup"><span data-stu-id="c6d41-177">**Figure 12**: Set the `AppendDataBoundItems` Property to True</span></span>


<span data-ttu-id="c6d41-178">После внесения этих изменений при первом просмотре страницы выбран параметр «--выберите категорию--» и продукты не отображаются.</span><span class="sxs-lookup"><span data-stu-id="c6d41-178">After these changes, when first visiting the page the "-- Choose a Category --" option is selected and no products are displayed.</span></span>


<span data-ttu-id="c6d41-179">[![При загрузке начальной страницы продукты не отображаются](master-detail-filtering-with-a-dropdownlist-vb/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="c6d41-179">[![On the Initial Page Load No Products are Displayed](master-detail-filtering-with-a-dropdownlist-vb/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image35.png)</span></span>

<span data-ttu-id="c6d41-180">**Рис. 13**: На начальной странице продукты нет нагрузки отображаются ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="c6d41-180">**Figure 13**: On the Initial Page Load No Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image37.png))</span></span>


<span data-ttu-id="c6d41-181">Поскольку выбран элемент списка «--выберите категорию--» продукты не отображаются при, так как его значение равно `-1` и нет ни одного продукта в базе данных с помощью `CategoryID` из `-1`.</span><span class="sxs-lookup"><span data-stu-id="c6d41-181">The reason no products are displayed when because the "-- Choose a Category --" list item is selected is because its value is `-1` and there are no products in the database with a `CategoryID` of `-1`.</span></span> <span data-ttu-id="c6d41-182">Если это поведение необходимо, то дело сделано на этом этапе!</span><span class="sxs-lookup"><span data-stu-id="c6d41-182">If this is the behavior you want then you're done at this point!</span></span> <span data-ttu-id="c6d41-183">Если, однако будет отображаться *все* категорий при выборе элемента списка «--выберите категорию--» вернитесь `ProductsBLL` и настройте `GetProductsByCategoryID(categoryID)` метод, чтобы он вызывал `GetProducts()` метод Если переданный в *`categoryID`* меньше нуля:</span><span class="sxs-lookup"><span data-stu-id="c6d41-183">If, however, you want to display *all* of the categories when the "-- Choose a Category --" list item is selected, return to the `ProductsBLL` class and customize the `GetProductsByCategoryID(categoryID)` method so that it invokes the `GetProducts()` method if the passed in *`categoryID`* parameter is less than zero:</span></span>


[!code-vb[Main](master-detail-filtering-with-a-dropdownlist-vb/samples/sample2.vb)]

<span data-ttu-id="c6d41-184">Используемый прием аналогичен приемом, использованным для отображения всех поставщиков в [декларативные параметры](../basic-reporting/declarative-parameters-cs.md) учебника, несмотря на то, что в этом примере мы используем значение `-1` для указания, что все записи должны быть извлечь в отличие от `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="c6d41-184">The technique used here is similar to the approach we used to display all suppliers back in the [Declarative Parameters](../basic-reporting/declarative-parameters-cs.md) tutorial, although for this example we're using a value of `-1` to indicate that all records should be retrieved as opposed to `Nothing`.</span></span> <span data-ttu-id="c6d41-185">Это обусловлено *`categoryID`* параметр `GetProductsByCategoryID(categoryID)` метод ожидает в качестве целочисленное значение, переданное в, тогда как в этом руководстве декларативным параметрам передавался входной строковой параметр.</span><span class="sxs-lookup"><span data-stu-id="c6d41-185">This is because the *`categoryID`* parameter of the `GetProductsByCategoryID(categoryID)` method expects as integer value passed in, whereas in the Declarative Parameters tutorial we were passing in a string input parameter.</span></span>

<span data-ttu-id="c6d41-186">Рис. 14 показан снимок экрана `FilterByDropDownList.aspx` при выборе параметра «--выберите категорию--».</span><span class="sxs-lookup"><span data-stu-id="c6d41-186">Figure 14 shows a screen shot of `FilterByDropDownList.aspx` when the "-- Choose a Category --" option is selected.</span></span> <span data-ttu-id="c6d41-187">Здесь по умолчанию отображаются все продукты, и пользователь может сузить отображаемые, выбрав определенную категорию.</span><span class="sxs-lookup"><span data-stu-id="c6d41-187">Here, all of the products are displayed by default, and the user can narrow the display by choosing a specific category.</span></span>


<span data-ttu-id="c6d41-188">[![Все продукты, теперь в списке по умолчанию](master-detail-filtering-with-a-dropdownlist-vb/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="c6d41-188">[![All of the Products are Now Listed By Default](master-detail-filtering-with-a-dropdownlist-vb/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image38.png)</span></span>

<span data-ttu-id="c6d41-189">**Рис. 14**: Все продукты, теперь в списке по умолчанию ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="c6d41-189">**Figure 14**: All of the Products are Now Listed By Default ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image40.png))</span></span>


## <a name="summary"></a><span data-ttu-id="c6d41-190">Сводка</span><span class="sxs-lookup"><span data-stu-id="c6d41-190">Summary</span></span>

<span data-ttu-id="c6d41-191">При отображении иерархически связанных данных часто полезно представлять данные с помощью отчетов «основной/подробности», из которых пользователь может начать изучение данных в верхней части иерархии и перейти к подробным сведениям.</span><span class="sxs-lookup"><span data-stu-id="c6d41-191">When displaying hierarchically-related data, it often helps to present the data using master/detail reports, from which the user can start perusing the data from the top of the hierarchy and drill down into details.</span></span> <span data-ttu-id="c6d41-192">В этом руководстве было рассмотрено создание "основной/подробности" простой отчет, показывающий продукты выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="c6d41-192">In this tutorial we examined building a simple master/detail report showing a selected category's products.</span></span> <span data-ttu-id="c6d41-193">Это осуществлялось с помощью элемента управления DropDownList для списка категорий и GridView для продуктов, принадлежащих выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="c6d41-193">This was accomplished by using a DropDownList for the list of categories and a GridView for the products belonging to the selected category.</span></span>

<span data-ttu-id="c6d41-194">В [следующему руководству](master-detail-filtering-with-two-dropdownlists-vb.md) мы рассмотрим один шаг интерфейс DropDownList, с помощью двух элементов управления DropDownList.</span><span class="sxs-lookup"><span data-stu-id="c6d41-194">In the [next tutorial](master-detail-filtering-with-two-dropdownlists-vb.md) we'll take the DropDownList interface one step further, using two DropDownLists.</span></span>

<span data-ttu-id="c6d41-195">Счастливого вам программирования!</span><span class="sxs-lookup"><span data-stu-id="c6d41-195">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c6d41-196">Об авторе</span><span class="sxs-lookup"><span data-stu-id="c6d41-196">About the Author</span></span>

<span data-ttu-id="c6d41-197">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP.NET и основатель веб- [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Microsoft с 1998 года.</span><span class="sxs-lookup"><span data-stu-id="c6d41-197">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c6d41-198">Скотт — независимый консультант, преподаватель и автор.</span><span class="sxs-lookup"><span data-stu-id="c6d41-198">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c6d41-199">Его последняя книга — [ *Sams Teach ASP.NET 2.0 in 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="c6d41-199">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c6d41-200">Ним можно связаться по адресу [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c6d41-200">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="c6d41-201">или через его блог, который можно найти в [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="c6d41-201">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c6d41-202">[Назад](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)
> [Вперед](master-detail-filtering-with-two-dropdownlists-vb.md)</span><span class="sxs-lookup"><span data-stu-id="c6d41-202">[Previous](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)
[Next](master-detail-filtering-with-two-dropdownlists-vb.md)</span></span>
