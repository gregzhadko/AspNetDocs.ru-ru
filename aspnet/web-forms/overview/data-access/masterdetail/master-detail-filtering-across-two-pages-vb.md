---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-across-two-pages-vb
title: «Основной/подробности» фильтрации на двух страницах (VB) | Документация Майкрософт
author: rick-anderson
description: В этом руководстве мы Реализуйте этот шаблон с помощью элемента управления GridView для отображения списка поставщиков в базе данных. Каждая строка поставщика в GridView будет содержать Vie...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 361d6a44-3f1f-4daf-85df-d4c2b8bf065d
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-across-two-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: 5569af095909b4aacaaf559dfae025d13805a510
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "65129540"
---
# <a name="masterdetail-filtering-across-two-pages-vb"></a><span data-ttu-id="6bd73-104">Фильтрация "Основной/подробности" на двух страницах (VB)</span><span class="sxs-lookup"><span data-stu-id="6bd73-104">Master/Detail Filtering Across Two Pages (VB)</span></span>

<span data-ttu-id="6bd73-105">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="6bd73-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="6bd73-106">[Скачайте пример приложения](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_9_VB.exe) или [скачать PDF](master-detail-filtering-across-two-pages-vb/_static/datatutorial09vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="6bd73-106">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_9_VB.exe) or [Download PDF](master-detail-filtering-across-two-pages-vb/_static/datatutorial09vb1.pdf)</span></span>

> <span data-ttu-id="6bd73-107">В этом руководстве мы Реализуйте этот шаблон с помощью элемента управления GridView для отображения списка поставщиков в базе данных.</span><span class="sxs-lookup"><span data-stu-id="6bd73-107">In this tutorial we'll implement this pattern by using a GridView to list the suppliers in the database.</span></span> <span data-ttu-id="6bd73-108">Каждая строка поставщика в GridView будет содержать ссылку Просмотр продуктов, что, если он выбран, будет переводить пользователя на отдельную страницу со списком продуктов для выбранного поставщика.</span><span class="sxs-lookup"><span data-stu-id="6bd73-108">Each supplier row in the GridView will contain a View Products link that, when clicked, will take the user to a separate page that lists those products for the selected supplier.</span></span>

## <a name="introduction"></a><span data-ttu-id="6bd73-109">Вступление</span><span class="sxs-lookup"><span data-stu-id="6bd73-109">Introduction</span></span>

<span data-ttu-id="6bd73-110">В предыдущих двух учебных курсах был рассмотрен способ отображения отчетов «основной/подробности» на одной веб-странице, используя списки DropDownList для отображения «основных» записей и [GridView](master-detail-filtering-with-a-dropdownlist-vb.md) или [DetailsView](master-detail-filtering-with-two-dropdownlists-vb.md) управления для отображения» Подробности».</span><span class="sxs-lookup"><span data-stu-id="6bd73-110">In the previous two tutorials we saw how to display master/detail reports in a single web page using DropDownLists to display the "master" records and a [GridView](master-detail-filtering-with-a-dropdownlist-vb.md) or [DetailsView](master-detail-filtering-with-two-dropdownlists-vb.md) control to display the "details."</span></span> <span data-ttu-id="6bd73-111">Другим распространенным шаблоном для обобщенных и подробных отчетов является основных записей на одной странице, а также сведения, отображаемые на другом.</span><span class="sxs-lookup"><span data-stu-id="6bd73-111">Another common pattern used for master/details reports is to have the master records on one web page and the details shown on another.</span></span> <span data-ttu-id="6bd73-112">Форум по веб-сайта, например [на форумах ASP.NET](https://forums.asp.net/), — отличный пример этого шаблона на практике.</span><span class="sxs-lookup"><span data-stu-id="6bd73-112">A forum website, like [the ASP.NET Forums](https://forums.asp.net/), is a great example of this pattern in practice.</span></span> <span data-ttu-id="6bd73-113">Форумы ASP.NET состоят из множества форумов Приступая к работе, веб-формы, элементы управления представления данных и т. д.</span><span class="sxs-lookup"><span data-stu-id="6bd73-113">The ASP.NET Forums are composed of a variety of forums Getting Started, Web Forms, Data Presentation Controls, and so on.</span></span> <span data-ttu-id="6bd73-114">Каждый форум состоит из множества обсуждений, и каждый поток состоит из ряда сообщений.</span><span class="sxs-lookup"><span data-stu-id="6bd73-114">Each forum is composed of many threads and each thread is composed of a number of posts.</span></span> <span data-ttu-id="6bd73-115">На домашней странице форумов ASP.NET содержится список форумов.</span><span class="sxs-lookup"><span data-stu-id="6bd73-115">On the ASP.NET Forums homepage, the forums are listed.</span></span> <span data-ttu-id="6bd73-116">Щелкнув на форуме перейти к `ShowForum.aspx` страницу, которая содержится список обсуждений этого форума.</span><span class="sxs-lookup"><span data-stu-id="6bd73-116">Clicking on a forum whisks you to a `ShowForum.aspx` page, which lists the threads for that forum.</span></span> <span data-ttu-id="6bd73-117">Аналогично, если щелкнуть в потоке, отобразится `ShowPost.aspx`, сообщениями для потока, который был щелкнут.</span><span class="sxs-lookup"><span data-stu-id="6bd73-117">Likewise, clicking on a thread takes you to `ShowPost.aspx`, which displays the posts for the thread that was clicked.</span></span>

<span data-ttu-id="6bd73-118">В этом руководстве мы Реализуйте этот шаблон с помощью элемента управления GridView для отображения списка поставщиков в базе данных.</span><span class="sxs-lookup"><span data-stu-id="6bd73-118">In this tutorial we'll implement this pattern by using a GridView to list the suppliers in the database.</span></span> <span data-ttu-id="6bd73-119">Каждая строка поставщика в GridView будет содержать ссылку Просмотр продуктов, что, если он выбран, будет переводить пользователя на отдельную страницу со списком продуктов для выбранного поставщика.</span><span class="sxs-lookup"><span data-stu-id="6bd73-119">Each supplier row in the GridView will contain a View Products link that, when clicked, will take the user to a separate page that lists those products for the selected supplier.</span></span>

## <a name="step-1-addingsupplierlistmasteraspxandproductsforsupplierdetailsaspxpages-to-thefilteringfolder"></a><span data-ttu-id="6bd73-120">Шаг 1. Добавление`SupplierListMaster.aspx`и`ProductsForSupplierDetails.aspx`страниц к`Filtering`папки</span><span class="sxs-lookup"><span data-stu-id="6bd73-120">Step 1: Adding`SupplierListMaster.aspx`and`ProductsForSupplierDetails.aspx`Pages to the`Filtering`Folder</span></span>

<span data-ttu-id="6bd73-121">При определении макета страниц в третьем учебнике мы добавили ряд «стартовых» страниц в `BasicReporting`, `Filtering`, и `CustomFormatting` папки.</span><span class="sxs-lookup"><span data-stu-id="6bd73-121">When defining the page layout in the third tutorial we added a number of "starter" pages in the `BasicReporting`, `Filtering`, and `CustomFormatting` folders.</span></span> <span data-ttu-id="6bd73-122">Тем не менее, мы не добавляли начальной страницы в этом руководстве в это время, поэтому Отвлекитесь и добавьте новую страницу, чтобы `Filtering` папки: `SupplierListMaster.aspx` и `ProductsForSupplierDetails.aspx`.</span><span class="sxs-lookup"><span data-stu-id="6bd73-122">However, we did not add a starter page for this tutorial at that time, so take a moment to add two new pages to the `Filtering` folder: `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx`.</span></span> <span data-ttu-id="6bd73-123">`SupplierListMaster.aspx` будет список «основных» записей (поставщики) при `ProductsForSupplierDetails.aspx` будут отображаться продукты для выбранного поставщика.</span><span class="sxs-lookup"><span data-stu-id="6bd73-123">`SupplierListMaster.aspx` will list the "master" records (the suppliers) while `ProductsForSupplierDetails.aspx` will display the products for the selected supplier.</span></span>

<span data-ttu-id="6bd73-124">При создании этих двух новых страниц не забудьте связать их с `Site.master` главной страницы.</span><span class="sxs-lookup"><span data-stu-id="6bd73-124">When creating these two new pages be certain to associate them with the `Site.master` master page.</span></span>

![Добавление страниц SupplierListMaster.aspx и Productsforsupplierdetails.aspx в папку фильтрации](master-detail-filtering-across-two-pages-vb/_static/image1.png)

<span data-ttu-id="6bd73-126">**Рис. 1**: Добавить `SupplierListMaster.aspx` и `ProductsForSupplierDetails.aspx` страниц к `Filtering` папки</span><span class="sxs-lookup"><span data-stu-id="6bd73-126">**Figure 1**: Add the `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx` Pages to the `Filtering` Folder</span></span>

<span data-ttu-id="6bd73-127">Кроме того, при добавлении новых страниц к проекту, не забудьте обновить файл карты узла, `Web.sitemap`, соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="6bd73-127">Also, when adding new pages to the project, be sure to update the site map file, `Web.sitemap`, accordingly.</span></span> <span data-ttu-id="6bd73-128">В этом руководстве просто добавьте `SupplierListMaster.aspx` страницы в карту узла, используя следующее содержимое XML в качестве дочернего элемента для элемента `<siteMapNode>` элемент:</span><span class="sxs-lookup"><span data-stu-id="6bd73-128">For this tutorial simply add the `SupplierListMaster.aspx` page to the site map using the following XML content as a child of the Filtering Reports `<siteMapNode>` element:</span></span>

[!code-xml[Main](master-detail-filtering-across-two-pages-vb/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="6bd73-129">Вы можете помочь автоматизировать процесс обновления файла карты узла, когда Добавление нового ASP.NET страницы с использованием [к. Скотт Аллен](http://odetocode.com/Blogs/scott/)бесплатного [макроса карты узла](http://odetocode.com/Blogs/scott/archive/2005/11/29/2537.aspx).</span><span class="sxs-lookup"><span data-stu-id="6bd73-129">You can help automate the process of updating the site map file when adding new ASP.NET pages using [K. Scott Allen](http://odetocode.com/Blogs/scott/)'s free Visual Studio [Site Map Macro](http://odetocode.com/Blogs/scott/archive/2005/11/29/2537.aspx).</span></span>

## <a name="step-2-displaying-the-supplier-list-insupplierlistmasteraspx"></a><span data-ttu-id="6bd73-130">Шаг 2. Отображение списка поставщиков на странице`SupplierListMaster.aspx`</span><span class="sxs-lookup"><span data-stu-id="6bd73-130">Step 2: Displaying the Supplier List in`SupplierListMaster.aspx`</span></span>

<span data-ttu-id="6bd73-131">С помощью `SupplierListMaster.aspx` и `ProductsForSupplierDetails.aspx` страницы, созданные, следующим этапом является создание элемента управления GridView для поставщиков в `SupplierListMaster.aspx`.</span><span class="sxs-lookup"><span data-stu-id="6bd73-131">With the `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx` pages created, our next step is to create the GridView of suppliers in `SupplierListMaster.aspx`.</span></span> <span data-ttu-id="6bd73-132">Добавьте на страницу GridView и привяжите его к элементу управления ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="6bd73-132">Add a GridView to the page and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="6bd73-133">Следует использовать данный элемент управления ObjectDataSource `SuppliersBLL` класса `GetSuppliers()` метод для возврата всех поставщиков.</span><span class="sxs-lookup"><span data-stu-id="6bd73-133">This ObjectDataSource should use the `SuppliersBLL` class's `GetSuppliers()` method to return all suppliers.</span></span>

<span data-ttu-id="6bd73-134">[![Выбор метода Getsuppliers() класса](master-detail-filtering-across-two-pages-vb/_static/image3.png)](master-detail-filtering-across-two-pages-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-134">[![Select the SuppliersBLL Class](master-detail-filtering-across-two-pages-vb/_static/image3.png)](master-detail-filtering-across-two-pages-vb/_static/image2.png)</span></span>

<span data-ttu-id="6bd73-135">**Рис. 2**: Выберите `SuppliersBLL` класс ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-135">**Figure 2**: Select the `SuppliersBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image4.png))</span></span>

<span data-ttu-id="6bd73-136">[![Настройка ObjectDataSource на использование метода GetSuppliers()](master-detail-filtering-across-two-pages-vb/_static/image6.png)](master-detail-filtering-across-two-pages-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-136">[![Configure the ObjectDataSource to Use the GetSuppliers() Method](master-detail-filtering-across-two-pages-vb/_static/image6.png)](master-detail-filtering-across-two-pages-vb/_static/image5.png)</span></span>

<span data-ttu-id="6bd73-137">**Рис. 3**: Настройка ObjectDataSource для использования `GetSuppliers()` метод ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-137">**Figure 3**: Configure the ObjectDataSource to Use the `GetSuppliers()` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image7.png))</span></span>

<span data-ttu-id="6bd73-138">Нам нужно включить ссылку под названием Просмотр продуктов в каждой строке GridView, при нажатии ведет `ProductsForSupplierDetails.aspx` передачи в выделенной строке `SupplierID` значение через строку запроса.</span><span class="sxs-lookup"><span data-stu-id="6bd73-138">We need to include a link titled View Products in each GridView row that, when clicked, takes the user to `ProductsForSupplierDetails.aspx` passing in the selected row's `SupplierID` value through the querystring.</span></span> <span data-ttu-id="6bd73-139">Например, если пользователь щелкает ссылку Просмотр продуктов для поставщика Tokyo Traders (который имеет `SupplierID` равным 4), они должны отправляться `ProductsForSupplierDetails.aspx?SupplierID=4`.</span><span class="sxs-lookup"><span data-stu-id="6bd73-139">For example, if user clicks on the View Products link for the Tokyo Traders supplier (which has a `SupplierID` value of 4), they should be sent to `ProductsForSupplierDetails.aspx?SupplierID=4`.</span></span>

<span data-ttu-id="6bd73-140">Для этого добавьте [HyperLinkField](https://msdn.microsoft.com/library/system.web.ui.webcontrols.hyperlinkfield.aspx) к GridView, что добавляет гиперссылку для каждой строки GridView.</span><span class="sxs-lookup"><span data-stu-id="6bd73-140">To accomplish this, add a [HyperLinkField](https://msdn.microsoft.com/library/system.web.ui.webcontrols.hyperlinkfield.aspx) to the GridView, which adds a hyperlink to each GridView row.</span></span> <span data-ttu-id="6bd73-141">Запустить, щелкнув ссылку Правка столбцов смарт-теге элемента GridView.</span><span class="sxs-lookup"><span data-stu-id="6bd73-141">Start by clicking the Edit Columns link from the GridView's smart tag.</span></span> <span data-ttu-id="6bd73-142">Затем выберите поле HyperLinkField в списке в левом верхнем углу и щелкните "Добавить", чтобы включить поле HyperLinkField в списке полей GridView.</span><span class="sxs-lookup"><span data-stu-id="6bd73-142">Next, select the HyperLinkField from the list in the upper left and click Add to include the HyperLinkField in the GridView's field list.</span></span>

<span data-ttu-id="6bd73-143">[![Добавление поля HyperLinkField к элементу GridView](master-detail-filtering-across-two-pages-vb/_static/image9.png)](master-detail-filtering-across-two-pages-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-143">[![Add a HyperLinkField to the GridView](master-detail-filtering-across-two-pages-vb/_static/image9.png)](master-detail-filtering-across-two-pages-vb/_static/image8.png)</span></span>

<span data-ttu-id="6bd73-144">**Рис. 4**: Добавление поля HyperLinkField к GridView ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-144">**Figure 4**: Add a HyperLinkField to the GridView ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image10.png))</span></span>

<span data-ttu-id="6bd73-145">Поле HyperLinkField можно настроить таким образом, чтобы использовать тот же текст или URL-адрес значения по ссылке в каждой строке GridView, или эти значения могут основываться на значениях данных, привязанных ко всем строкам.</span><span class="sxs-lookup"><span data-stu-id="6bd73-145">The HyperLinkField can be configured to use the same text or URL values the link in each GridView row, or can base these values on the data values bound to each particular row.</span></span> <span data-ttu-id="6bd73-146">Для указания статического значения для всех строк используйте свойство `Text` или `NavigateUrl` свойства.</span><span class="sxs-lookup"><span data-stu-id="6bd73-146">To specify a static value across all rows use the HyperLinkField's `Text` or `NavigateUrl` properties.</span></span> <span data-ttu-id="6bd73-147">Поскольку мы хотим текст ссылки должен быть одинаковым для всех строк, установка для свойства `Text` свойства для просмотра продуктов.</span><span class="sxs-lookup"><span data-stu-id="6bd73-147">Since we want the link text to be the same for all rows, set the HyperLinkField's `Text` property to View Products.</span></span>

<span data-ttu-id="6bd73-148">[![Значение свойства Text HyperLinkField Просмотр продуктов](master-detail-filtering-across-two-pages-vb/_static/image12.png)](master-detail-filtering-across-two-pages-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-148">[![Set the HyperLinkField's Text Property to View Products](master-detail-filtering-across-two-pages-vb/_static/image12.png)](master-detail-filtering-across-two-pages-vb/_static/image11.png)</span></span>

<span data-ttu-id="6bd73-149">**Рис. 5**: Установка для свойства `Text` свойства для просмотра продуктов ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-149">**Figure 5**: Set the HyperLinkField's `Text` Property to View Products ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image13.png))</span></span>

<span data-ttu-id="6bd73-150">Чтобы задать текст или значения URL-адрес должен быть основан на базовых данных, привязанных к строке GridView, укажите текст поля данных или значения URL-адрес должен быть взят из в `DataTextField` или `DataNavigateUrlFields` свойства.</span><span class="sxs-lookup"><span data-stu-id="6bd73-150">To set the text or URL values to be based on the underlying data bound to the GridView row, specify the data fields the text or URL values should be pulled from in the `DataTextField` or `DataNavigateUrlFields` properties.</span></span> <span data-ttu-id="6bd73-151">`DataTextField` может устанавливаться только для одного поля данных; `DataNavigateUrlFields`, тем не менее, можно присвоить разделенный запятыми список полей данных.</span><span class="sxs-lookup"><span data-stu-id="6bd73-151">`DataTextField` can only be set to a single data field; `DataNavigateUrlFields`, however, can be set to a comma-delimited list of data fields.</span></span> <span data-ttu-id="6bd73-152">Мы часто понадобится текст или URL-адрес на сочетании значения поля данных текущей строки и определенной статической разметки.</span><span class="sxs-lookup"><span data-stu-id="6bd73-152">We frequently need to base the text or URL on a combination of the current row's data field value and some static markup.</span></span> <span data-ttu-id="6bd73-153">В этом руководстве, например, мы хотим URL-адрес ссылок поля HyperLinkField быть `ProductsForSupplierDetails.aspx?SupplierID=supplierID`, где *`supplierID`* строка каждого элемента GridView `SupplierID` значение.</span><span class="sxs-lookup"><span data-stu-id="6bd73-153">In this tutorial, for example, we want the URL of the HyperLinkField's links to be `ProductsForSupplierDetails.aspx?SupplierID=supplierID`, where *`supplierID`* is each GridView's row's `SupplierID` value.</span></span> <span data-ttu-id="6bd73-154">Обратите внимание, что нам нужно как статическим, так и управляемые данными значения здесь: `ProductsForSupplierDetails.aspx?SupplierID=` часть URL-адреса ссылки является статическим, тогда как *`supplierID`* часть является управляемой данными как его значение равно собственное значение `SupplierID` значение.</span><span class="sxs-lookup"><span data-stu-id="6bd73-154">Notice that we need both static and data-driven values here: the `ProductsForSupplierDetails.aspx?SupplierID=` portion of the link's URL is static, whereas the *`supplierID`* portion is data-driven as its value is each row's own `SupplierID` value.</span></span>

<span data-ttu-id="6bd73-155">Для указания сочетания статических и управляемых данными значений, используйте `DataTextFormatString` и `DataNavigateUrlFormatString` свойства.</span><span class="sxs-lookup"><span data-stu-id="6bd73-155">To indicate a combination of static and data-driven values, use the `DataTextFormatString` and `DataNavigateUrlFormatString` properties.</span></span> <span data-ttu-id="6bd73-156">В этих свойствах статическую разметку при необходимости введите и затем установите маркер `{0}` нужное значение поля, указанного в `DataTextField` или `DataNavigateUrlFields` свойства для отображения.</span><span class="sxs-lookup"><span data-stu-id="6bd73-156">In these properties enter the static markup as needed and then use the marker `{0}` where you want the value of the field specified in the `DataTextField` or `DataNavigateUrlFields` properties to appear.</span></span> <span data-ttu-id="6bd73-157">Если `DataNavigateUrlFields` свойство имеет несколько полей использование `{0}` там, где требуется вставить, значение первого поля `{1}` для второго значения поля и т. д.</span><span class="sxs-lookup"><span data-stu-id="6bd73-157">If the `DataNavigateUrlFields` property has multiple fields specified use `{0}` where you want the first field value inserted, `{1}` for the second field value, and so on.</span></span>

<span data-ttu-id="6bd73-158">Применяется в этом руководстве, нам нужно установить `DataNavigateUrlFields` свойства `SupplierID`, так как это поле данных, значение которого необходимо настроить на основе строки, и `DataNavigateUrlFormatString` свойства `ProductsForSupplierDetails.aspx?SupplierID={0}`.</span><span class="sxs-lookup"><span data-stu-id="6bd73-158">Applying this to our tutorial, we need to set the `DataNavigateUrlFields` property to `SupplierID`, since that's the data field whose value we need to customize on a per-row basis, and the `DataNavigateUrlFormatString` property to `ProductsForSupplierDetails.aspx?SupplierID={0}`.</span></span>

<span data-ttu-id="6bd73-159">[![Настройка HyperLinkField на включение URL-адрес соответствующие ссылки, в зависимости от SupplierID](master-detail-filtering-across-two-pages-vb/_static/image15.png)](master-detail-filtering-across-two-pages-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-159">[![Configure the HyperLinkField to Include the Proper Link URL Based Upon the SupplierID](master-detail-filtering-across-two-pages-vb/_static/image15.png)](master-detail-filtering-across-two-pages-vb/_static/image14.png)</span></span>

<span data-ttu-id="6bd73-160">**Рис. 6**: Настройка HyperLinkField на включение правильной ссылки URL-адрес на основе при `SupplierID` ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-160">**Figure 6**: Configure the HyperLinkField to Include the Proper Link URL Based Upon the `SupplierID` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image16.png))</span></span>

<span data-ttu-id="6bd73-161">После добавления HyperLinkField, вы можете настроить и изменить порядок полей GridView.</span><span class="sxs-lookup"><span data-stu-id="6bd73-161">After adding the HyperLinkField, feel free to customize and reorder the GridView's fields.</span></span> <span data-ttu-id="6bd73-162">В следующей разметке показан GridView после внесения некоторых незначительных изменений на уровне полей.</span><span class="sxs-lookup"><span data-stu-id="6bd73-162">The following markup shows the GridView after I've made some minor field-level customizations.</span></span>

[!code-aspx[Main](master-detail-filtering-across-two-pages-vb/samples/sample2.aspx)]

<span data-ttu-id="6bd73-163">Отвлекитесь и просмотрите `SupplierListMaster.aspx` страницы в обозревателе.</span><span class="sxs-lookup"><span data-stu-id="6bd73-163">Take a moment to view the `SupplierListMaster.aspx` page through a browser.</span></span> <span data-ttu-id="6bd73-164">Как показано на рис. 7, страницы в настоящее время список всех поставщиков, включая ссылку Просмотр продуктов.</span><span class="sxs-lookup"><span data-stu-id="6bd73-164">As Figure 7 shows, the page currently lists all of the suppliers including a View Products link.</span></span> <span data-ttu-id="6bd73-165">Щелкнув Просмотр продуктов ссылке вы перейдете на `ProductsForSupplierDetails.aspx`, передав вдоль поставщика `SupplierID` в строке запроса.</span><span class="sxs-lookup"><span data-stu-id="6bd73-165">Clicking on the View Products link will take you to `ProductsForSupplierDetails.aspx`, passing along the supplier's `SupplierID` in the querystring.</span></span>

<span data-ttu-id="6bd73-166">[![Каждая строка поставщика содержит ссылку Просмотр продуктов](master-detail-filtering-across-two-pages-vb/_static/image18.png)](master-detail-filtering-across-two-pages-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-166">[![Each Supplier Row Contains a View Products Link](master-detail-filtering-across-two-pages-vb/_static/image18.png)](master-detail-filtering-across-two-pages-vb/_static/image17.png)</span></span>

<span data-ttu-id="6bd73-167">**Рис. 7**: Каждая строка поставщика содержит ссылку Просмотр продуктов ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-167">**Figure 7**: Each Supplier Row Contains a View Products Link ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image19.png))</span></span>

## <a name="step-3-listing-the-suppliers-products-inproductsforsupplierdetailsaspx"></a><span data-ttu-id="6bd73-168">Шаг 3. Перечисление продуктов поставщика в`ProductsForSupplierDetails.aspx`</span><span class="sxs-lookup"><span data-stu-id="6bd73-168">Step 3: Listing the Supplier's Products in`ProductsForSupplierDetails.aspx`</span></span>

<span data-ttu-id="6bd73-169">На этом этапе `SupplierListMaster.aspx` отправляет пользователей на странице `ProductsForSupplierDetails.aspx`, передав выбранного поставщика `SupplierID` в строке запроса.</span><span class="sxs-lookup"><span data-stu-id="6bd73-169">At this point the `SupplierListMaster.aspx` page is sending users to `ProductsForSupplierDetails.aspx`, passing the selected supplier's `SupplierID` in the querystring.</span></span> <span data-ttu-id="6bd73-170">Последним шагом данного учебного курса является отображение продуктов в элементе управления GridView на `ProductsForSupplierDetails.aspx` которого `SupplierID` равно `SupplierID` переданного через строку запроса.</span><span class="sxs-lookup"><span data-stu-id="6bd73-170">The tutorial's final step is to display the products in a GridView in `ProductsForSupplierDetails.aspx` whose `SupplierID` equals the `SupplierID` passed in through the querystring.</span></span> <span data-ttu-id="6bd73-171">Для этого необходимо добавить GridView к `ProductsForSupplierDetails.aspx` страницы, используя новый элемент управления ObjectDataSource с именем `ProductsBySupplierDataSource` , вызывающий `GetProductsBySupplierID(supplierID)` метода из `ProductsBLL` класса.</span><span class="sxs-lookup"><span data-stu-id="6bd73-171">To accomplish this start by adding a GridView to the `ProductsForSupplierDetails.aspx` page, using a new ObjectDataSource control named `ProductsBySupplierDataSource` that invokes the `GetProductsBySupplierID(supplierID)` method from the `ProductsBLL` class.</span></span>

<span data-ttu-id="6bd73-172">[![Добавьте новый ObjectDataSource, именуемый ProductsBySupplierDataSource](master-detail-filtering-across-two-pages-vb/_static/image21.png)](master-detail-filtering-across-two-pages-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-172">[![Add a New ObjectDataSource Named ProductsBySupplierDataSource](master-detail-filtering-across-two-pages-vb/_static/image21.png)](master-detail-filtering-across-two-pages-vb/_static/image20.png)</span></span>

<span data-ttu-id="6bd73-173">**Рис. 8**: Добавить новый элемент управления ObjectDataSource с именем `ProductsBySupplierDataSource` ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-173">**Figure 8**: Add a New ObjectDataSource Named `ProductsBySupplierDataSource` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image22.png))</span></span>

<span data-ttu-id="6bd73-174">[![Выбор класса](master-detail-filtering-across-two-pages-vb/_static/image24.png)](master-detail-filtering-across-two-pages-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-174">[![Select the ProductsBLL Class](master-detail-filtering-across-two-pages-vb/_static/image24.png)](master-detail-filtering-across-two-pages-vb/_static/image23.png)</span></span>

<span data-ttu-id="6bd73-175">**Рис. 9**: Выберите `ProductsBLL` класс ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-175">**Figure 9**: Select the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image25.png))</span></span>

<span data-ttu-id="6bd73-176">[![У элемента управления ObjectDataSource вызвать метод GetProductsBySupplierID(supplierID)](master-detail-filtering-across-two-pages-vb/_static/image27.png)](master-detail-filtering-across-two-pages-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-176">[![Have the ObjectDataSource Invoke the GetProductsBySupplierID(supplierID) Method](master-detail-filtering-across-two-pages-vb/_static/image27.png)](master-detail-filtering-across-two-pages-vb/_static/image26.png)</span></span>

<span data-ttu-id="6bd73-177">**Рис. 10**: Иметь элемент управления ObjectDataSource вызывает `GetProductsBySupplierID(supplierID)` метод ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-177">**Figure 10**: Have the ObjectDataSource Invoke the `GetProductsBySupplierID(supplierID)` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image28.png))</span></span>

<span data-ttu-id="6bd73-178">Последний шаг в мастере настройки источника данных запрос на указание источника `GetProductsBySupplierID(supplierID)` метода *`supplierID`* параметра.</span><span class="sxs-lookup"><span data-stu-id="6bd73-178">The final step of the Configure Data Source wizard asks us to provide the source of the `GetProductsBySupplierID(supplierID)` method's *`supplierID`* parameter.</span></span> <span data-ttu-id="6bd73-179">Чтобы использовать значения строки запроса, в качестве источника параметра строки запроса и введите имя значения строки запроса для использования в текстовом поле QueryStringField (`SupplierID`).</span><span class="sxs-lookup"><span data-stu-id="6bd73-179">To use the querystring value, set the Parameter source to QueryString and enter the name of the querystring value to use in the QueryStringField textbox (`SupplierID`).</span></span>

<span data-ttu-id="6bd73-180">[![Заполнение supplierID значение параметра из значения строки запроса SupplierID](master-detail-filtering-across-two-pages-vb/_static/image30.png)](master-detail-filtering-across-two-pages-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-180">[![Populate the supplierID Parameter Value from the SupplierID Querystring Value](master-detail-filtering-across-two-pages-vb/_static/image30.png)](master-detail-filtering-across-two-pages-vb/_static/image29.png)</span></span>

<span data-ttu-id="6bd73-181">**Рис. 11**: Заполнение *`supplierID`* значение параметра из `SupplierID` значение строки запроса ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-181">**Figure 11**: Populate the *`supplierID`* Parameter Value from the `SupplierID` Querystring Value ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image31.png))</span></span>

<span data-ttu-id="6bd73-182">Вот и все!</span><span class="sxs-lookup"><span data-stu-id="6bd73-182">That's all there is to it!</span></span> <span data-ttu-id="6bd73-183">Рис. 12 показан `ProductsForSupplierDetails.aspx` странице открываемая при щелчке ссылки Tokyo Traders из `SupplierListMaster.aspx`.</span><span class="sxs-lookup"><span data-stu-id="6bd73-183">Figure 12 shows the `ProductsForSupplierDetails.aspx` page when visited by clicking the Tokyo Traders link from `SupplierListMaster.aspx`.</span></span>

<span data-ttu-id="6bd73-184">[![Отображаются продукты поставляемые Tokyo Traders](master-detail-filtering-across-two-pages-vb/_static/image33.png)](master-detail-filtering-across-two-pages-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-184">[![The Products Supplied by Tokyo Traders are Shown](master-detail-filtering-across-two-pages-vb/_static/image33.png)](master-detail-filtering-across-two-pages-vb/_static/image32.png)</span></span>

<span data-ttu-id="6bd73-185">**Рис. 12**: Отображаются продукты поставляемые Tokyo Traders ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-185">**Figure 12**: The Products Supplied by Tokyo Traders are Shown ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image34.png))</span></span>

## <a name="displaying-supplier-information-inproductsforsupplierdetailsaspx"></a><span data-ttu-id="6bd73-186">Отображение информации о поставщике в`ProductsForSupplierDetails.aspx`</span><span class="sxs-lookup"><span data-stu-id="6bd73-186">Displaying Supplier Information in`ProductsForSupplierDetails.aspx`</span></span>

<span data-ttu-id="6bd73-187">Как показано на рис. 12, `ProductsForSupplierDetails.aspx` просто перечислены продукты, поставляемые `SupplierID` указано в строке запроса.</span><span class="sxs-lookup"><span data-stu-id="6bd73-187">As Figure 12 shows, the `ProductsForSupplierDetails.aspx` page simply lists the products that are supplied by the `SupplierID` specified in the querystring.</span></span> <span data-ttu-id="6bd73-188">Кто-то отправил непосредственно на эту страницу, тем не менее, не будет знать, что рис. 12 показаны продукты Tokyo Traders.</span><span class="sxs-lookup"><span data-stu-id="6bd73-188">Someone sent directly to this page, however, would not know that Figure 12 is showing Tokyo Traders' products.</span></span> <span data-ttu-id="6bd73-189">Чтобы исправить это, мы можем отобразить сведения о поставщике на этой странице также.</span><span class="sxs-lookup"><span data-stu-id="6bd73-189">To remedy this we can display supplier information in this page as well.</span></span>

<span data-ttu-id="6bd73-190">Начните с добавления элемент управления FormView над элементом GridView продуктов.</span><span class="sxs-lookup"><span data-stu-id="6bd73-190">Start by adding a FormView above the products GridView.</span></span> <span data-ttu-id="6bd73-191">Создать новый элемент управления ObjectDataSource с именем `SuppliersDataSource` , вызывающий `SuppliersBLL` класса `GetSupplierBySupplierID(supplierID)` метод.</span><span class="sxs-lookup"><span data-stu-id="6bd73-191">Create a new ObjectDataSource control named `SuppliersDataSource` that invokes the `SuppliersBLL` class's `GetSupplierBySupplierID(supplierID)` method.</span></span>

<span data-ttu-id="6bd73-192">[![Выбор метода Getsuppliers() класса](master-detail-filtering-across-two-pages-vb/_static/image36.png)](master-detail-filtering-across-two-pages-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-192">[![Select the SuppliersBLL Class](master-detail-filtering-across-two-pages-vb/_static/image36.png)](master-detail-filtering-across-two-pages-vb/_static/image35.png)</span></span>

<span data-ttu-id="6bd73-193">**Рис. 13**: Выберите `SuppliersBLL` класс ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-193">**Figure 13**: Select the `SuppliersBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image37.png))</span></span>

<span data-ttu-id="6bd73-194">[![У элемента управления ObjectDataSource вызова метода GetSupplierBySupplierID(supplierID)](master-detail-filtering-across-two-pages-vb/_static/image39.png)](master-detail-filtering-across-two-pages-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-194">[![Have the ObjectDataSource Invoke the GetSupplierBySupplierID(supplierID) Method](master-detail-filtering-across-two-pages-vb/_static/image39.png)](master-detail-filtering-across-two-pages-vb/_static/image38.png)</span></span>

<span data-ttu-id="6bd73-195">**Рис. 14**: Иметь элемент управления ObjectDataSource вызывает `GetSupplierBySupplierID(supplierID)` метод ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-195">**Figure 14**: Have the ObjectDataSource Invoke the `GetSupplierBySupplierID(supplierID)` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image40.png))</span></span>

<span data-ttu-id="6bd73-196">Как и в `ProductsBySupplierDataSource`, имеют *`supplierID`* параметру присвоено значение `SupplierID` значение строки запроса.</span><span class="sxs-lookup"><span data-stu-id="6bd73-196">As with the `ProductsBySupplierDataSource`, have the *`supplierID`* parameter assigned the value of the `SupplierID` querystring value.</span></span>

<span data-ttu-id="6bd73-197">[![Заполнение supplierID значение параметра из значения строки запроса SupplierID](master-detail-filtering-across-two-pages-vb/_static/image42.png)](master-detail-filtering-across-two-pages-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-197">[![Populate the supplierID Parameter Value from the SupplierID Querystring Value](master-detail-filtering-across-two-pages-vb/_static/image42.png)](master-detail-filtering-across-two-pages-vb/_static/image41.png)</span></span>

<span data-ttu-id="6bd73-198">**Рис. 15**: Заполнение *`supplierID`* значение параметра из `SupplierID` значение строки запроса ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-198">**Figure 15**: Populate the *`supplierID`* Parameter Value from the `SupplierID` Querystring Value ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image43.png))</span></span>

<span data-ttu-id="6bd73-199">При привязке FormView к ObjectDataSource в режиме конструктора, Visual Studio автоматически создаст FormView `ItemTemplate`, `InsertItemTemplate`, и `EditItemTemplate` с элементами управления Label и веб-текстовое поле для каждого поля данных, возвращенных Элемент управления ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="6bd73-199">When binding the FormView to the ObjectDataSource in the Design view, Visual Studio will automatically create the FormView's `ItemTemplate`, `InsertItemTemplate`, and `EditItemTemplate` with Label and TextBox Web controls for each of the data fields returned by the ObjectDataSource.</span></span> <span data-ttu-id="6bd73-200">Так как нам нужно только отобразить поставщика сведения можно удалить `InsertItemTemplate` и `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="6bd73-200">Since we just want to display supplier information feel free to remove the `InsertItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="6bd73-201">Далее следует изменить ItemTemplate, чтобы он отображал название компании поставщика в `<h3>` элемент и адрес, Город, Страна и номер телефона под названием компании.</span><span class="sxs-lookup"><span data-stu-id="6bd73-201">Next, edit the ItemTemplate so that it displays the supplier's company name in an `<h3>` element and the address, city, country, and phone number beneath the company name.</span></span> <span data-ttu-id="6bd73-202">Кроме того, можно вручную задать FormView `DataSourceID` и создайте `ItemTemplate` разметки, как делалось в "[отображение данных с ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md)" Учебник.</span><span class="sxs-lookup"><span data-stu-id="6bd73-202">Alternatively, you can manually set the FormView's `DataSourceID` and create the `ItemTemplate` markup, as we did back in the "[Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md)" tutorial.</span></span>

<span data-ttu-id="6bd73-203">После внесения этих изменений декларативная разметка FormView должна выглядеть следующим:</span><span class="sxs-lookup"><span data-stu-id="6bd73-203">After these edits the FormView's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-across-two-pages-vb/samples/sample3.aspx)]

<span data-ttu-id="6bd73-204">Рис. 16 показана снимок экрана `ProductsForSupplierDetails.aspx` странице после информации о поставщике, описанные выше был включен.</span><span class="sxs-lookup"><span data-stu-id="6bd73-204">Figure 16 shows a screen shot of the `ProductsForSupplierDetails.aspx` page after the supplier information detailed above has been included.</span></span>

<span data-ttu-id="6bd73-205">[![Список продуктов включает сводку о поставщике](master-detail-filtering-across-two-pages-vb/_static/image45.png)](master-detail-filtering-across-two-pages-vb/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-205">[![The List of Products Includes a Summary About the Supplier](master-detail-filtering-across-two-pages-vb/_static/image45.png)](master-detail-filtering-across-two-pages-vb/_static/image44.png)</span></span>

<span data-ttu-id="6bd73-206">**Рис. 16**: Список продуктов включает сводку о Supplier ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-206">**Figure 16**: The List of Products Includes a Summary About the Supplier ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image46.png))</span></span>

## <a name="applying-the-final-touches-for-theproductsforsupplierdetailsaspxui"></a><span data-ttu-id="6bd73-207">Последние касается для`ProductsForSupplierDetails.aspx`пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="6bd73-207">Applying the Final Touches for the`ProductsForSupplierDetails.aspx`UI</span></span>

<span data-ttu-id="6bd73-208">Для улучшения пользователь интерфейс для этого отчета существует ряд дополнений, мы работаем для внесения `ProductsForSupplierDetails.aspx` страницы.</span><span class="sxs-lookup"><span data-stu-id="6bd73-208">To improve the user experience for this report there are a couple of additions we ought to make to the `ProductsForSupplierDetails.aspx` page.</span></span> <span data-ttu-id="6bd73-209">В настоящее время единственным способом, пользователь может перейти от `ProductsForSupplierDetails.aspx` страницы обратно к списку поставщиков является нажмите кнопку "Назад" браузера.</span><span class="sxs-lookup"><span data-stu-id="6bd73-209">Currently the only way a user can go from the `ProductsForSupplierDetails.aspx` page back to the list of suppliers is to click their browser's back button.</span></span> <span data-ttu-id="6bd73-210">Давайте добавим элемент управления HyperLink для `ProductsForSupplierDetails.aspx` страницы, которая ссылается на `SupplierListMaster.aspx`, предоставляя другим способом для пользователя, чтобы вернуться к основному списку.</span><span class="sxs-lookup"><span data-stu-id="6bd73-210">Let's add a HyperLink control to the `ProductsForSupplierDetails.aspx` page that links back to `SupplierListMaster.aspx`, providing another way for the user to return to the master list.</span></span>

<span data-ttu-id="6bd73-211">[![Добавление элемента управления HyperLink для возврата пользователя страниц SupplierListMaster.aspx](master-detail-filtering-across-two-pages-vb/_static/image48.png)](master-detail-filtering-across-two-pages-vb/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-211">[![Add a HyperLink Control to Take the User Back to SupplierListMaster.aspx](master-detail-filtering-across-two-pages-vb/_static/image48.png)](master-detail-filtering-across-two-pages-vb/_static/image47.png)</span></span>

<span data-ttu-id="6bd73-212">**Рис. 17**: Добавление элемента управления HyperLink для возврата пользователя к `SupplierListMaster.aspx` ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-212">**Figure 17**: Add a HyperLink Control to Take the User Back to `SupplierListMaster.aspx` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image49.png))</span></span>

<span data-ttu-id="6bd73-213">Если пользователь щелкает ссылку Просмотр продуктов для поставщика, который не имеет любых продуктов `ProductsBySupplierDataSource` ObjectDataSource в `ProductsForSupplierDetails.aspx` не вернет результаты.</span><span class="sxs-lookup"><span data-stu-id="6bd73-213">If the user clicks on the View Products link for a supplier that doesn't have any products, the `ProductsBySupplierDataSource` ObjectDataSource in `ProductsForSupplierDetails.aspx` won't return any results.</span></span> <span data-ttu-id="6bd73-214">GridView, привязанный к ObjectDataSource не будет отображать разметку, полученный в пустую область страницы в браузере пользователя.</span><span class="sxs-lookup"><span data-stu-id="6bd73-214">The GridView bound to the ObjectDataSource won't render any markup resulting in a blank region on the page in the user's browser.</span></span> <span data-ttu-id="6bd73-215">Для более ясного сообщения пользователю и что нет ни одного продукта, связанного с выбранным поставщиком можно присвоить свойству `EmptyDataText` в сообщение, должно отображаться при возникновении такой ситуации свойство.</span><span class="sxs-lookup"><span data-stu-id="6bd73-215">To more clearly communicate to the user that there are no products associated with the selected supplier we can set the GridView's `EmptyDataText` property to the message we want displayed when such a situation arises.</span></span> <span data-ttu-id="6bd73-216">Я установил этого свойства значение «Нет ни одного продукта, предоставляемые этой поставщиком»</span><span class="sxs-lookup"><span data-stu-id="6bd73-216">I've set this property to "There are no products provided by this supplier�"</span></span>

<span data-ttu-id="6bd73-217">По умолчанию все поставщики в базе данных northwinds поставляют предоставляют хотя бы один продукт.</span><span class="sxs-lookup"><span data-stu-id="6bd73-217">By default, all suppliers in the Northwinds database provide at least one product.</span></span> <span data-ttu-id="6bd73-218">Тем не менее, в этом руководстве я изменил `Products` таблицы, чтобы поставщик Escargots Nouveaux больше не связан с продуктами.</span><span class="sxs-lookup"><span data-stu-id="6bd73-218">However, for this tutorial I've manually modified the `Products` table so that the supplier Escargots Nouveaux is no longer associated with any products.</span></span> <span data-ttu-id="6bd73-219">Рис. 18 показана страница подробностей для Escargots Nouveaux после внесения этого изменения.</span><span class="sxs-lookup"><span data-stu-id="6bd73-219">Figure 18 shows the details page for Escargots Nouveaux after this change has been made.</span></span>

<span data-ttu-id="6bd73-220">[![Пользователи получат сообщение о том, что у поставщика отсутствуют продукты](master-detail-filtering-across-two-pages-vb/_static/image51.png)](master-detail-filtering-across-two-pages-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="6bd73-220">[![Users are Informed that the Supplier Doesn't Provide Any Products](master-detail-filtering-across-two-pages-vb/_static/image51.png)](master-detail-filtering-across-two-pages-vb/_static/image50.png)</span></span>

<span data-ttu-id="6bd73-221">**Рис. 18**: Пользователи получат сообщение о том, что у поставщика отсутствуют продукты ([Просмотр полноразмерного изображения](master-detail-filtering-across-two-pages-vb/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="6bd73-221">**Figure 18**: Users are Informed that the Supplier Doesn't Provide Any Products ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image52.png))</span></span>

## <a name="summary"></a><span data-ttu-id="6bd73-222">Сводка</span><span class="sxs-lookup"><span data-stu-id="6bd73-222">Summary</span></span>

<span data-ttu-id="6bd73-223">Хотя основные и подробные записи в основных/подробных отчетах могут отображаться на одной странице, на многих веб-сайтах они размещены на двух веб-страницах.</span><span class="sxs-lookup"><span data-stu-id="6bd73-223">While master/detail reports can display both the master and detail records on a single page, in many websites they are separated out across two web pages.</span></span> <span data-ttu-id="6bd73-224">В этом учебнике мы рассмотрели способы реализация такого отчета «основной/подробности» посредством перечисления поставщиков в элементе управления GridView на «основной» веб-странице и соответствующих продуктов на странице «Подробности».</span><span class="sxs-lookup"><span data-stu-id="6bd73-224">In this tutorial we looked at how to implement such a master/detail report by having the suppliers listed in a GridView in the "master" web page and the associated products listed in the "details" page.</span></span> <span data-ttu-id="6bd73-225">Каждая строка поставщика на главной веб-странице содержит ссылку на страницу сведений, которая передается строки `SupplierID` значение.</span><span class="sxs-lookup"><span data-stu-id="6bd73-225">Each supplier row in the master web page contained a link to the details page that passed along the row's `SupplierID` value.</span></span> <span data-ttu-id="6bd73-226">Такие ссылки определенных строк можно легко добавить с помощью поля HyperLinkField элемента GridView.</span><span class="sxs-lookup"><span data-stu-id="6bd73-226">Such row-specific links can be easily added using the GridView's HyperLinkField.</span></span>

<span data-ttu-id="6bd73-227">На странице подробностей Получение продуктов для указанного поставщика достигалось посредством вызова принадлежащего `ProductsBLL` класса `GetProductsBySupplierID(supplierID)` метод.</span><span class="sxs-lookup"><span data-stu-id="6bd73-227">In the details page retrieving those products for the specified supplier was accomplished by invoking the `ProductsBLL` class's `GetProductsBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="6bd73-228">*`supplierID`* Значение параметра было указано декларативно с помощью строки запроса как источник параметра.</span><span class="sxs-lookup"><span data-stu-id="6bd73-228">The *`supplierID`* parameter value was specified declaratively using the querystring as the parameter source.</span></span> <span data-ttu-id="6bd73-229">Мы также рассмотрели способы отображения сведений о поставщике на странице подробностей с помощью элемента FormView.</span><span class="sxs-lookup"><span data-stu-id="6bd73-229">We also looked at how to display the supplier details in the details page using a FormView.</span></span>

<span data-ttu-id="6bd73-230">Наши [следующему руководству](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md) является последним, посвященным отчетам «основной/подробности».</span><span class="sxs-lookup"><span data-stu-id="6bd73-230">Our [next tutorial](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md) is the final one on master/detail reports.</span></span> <span data-ttu-id="6bd73-231">Мы рассмотрим Отображение списка продуктов в элементе управления GridView, в котором каждая строка содержит кнопки "выбрать".</span><span class="sxs-lookup"><span data-stu-id="6bd73-231">We'll look at how to display a list of products in a GridView where each row has a Select button.</span></span> <span data-ttu-id="6bd73-232">При нажатии кнопки Select будут отображаться сведения о продукте в элементе управления DetailsView на этой же странице.</span><span class="sxs-lookup"><span data-stu-id="6bd73-232">Clicking on the Select button will display that product's details in a DetailsView control on the same page.</span></span>

<span data-ttu-id="6bd73-233">Счастливого вам программирования!</span><span class="sxs-lookup"><span data-stu-id="6bd73-233">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="6bd73-234">Об авторе</span><span class="sxs-lookup"><span data-stu-id="6bd73-234">About the Author</span></span>

<span data-ttu-id="6bd73-235">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP.NET и основатель веб- [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Microsoft с 1998 года.</span><span class="sxs-lookup"><span data-stu-id="6bd73-235">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="6bd73-236">Скотт — независимый консультант, преподаватель и автор.</span><span class="sxs-lookup"><span data-stu-id="6bd73-236">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="6bd73-237">Его последняя книга — [ *Sams Teach ASP.NET 2.0 in 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="6bd73-237">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="6bd73-238">Ним можно связаться по адресу [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6bd73-238">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="6bd73-239">или через его блог, который можно найти в [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="6bd73-239">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="6bd73-240">Особая благодарность</span><span class="sxs-lookup"><span data-stu-id="6bd73-240">Special Thanks To</span></span>

<span data-ttu-id="6bd73-241">В этой серии руководств пособий рецензировалась многими компетентными редакторами.</span><span class="sxs-lookup"><span data-stu-id="6bd73-241">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="6bd73-242">Основной рецензент этого учебного был (Hilton giesenow).</span><span class="sxs-lookup"><span data-stu-id="6bd73-242">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="6bd73-243">Хотите поработать с моих последующих статей для MSDN?</span><span class="sxs-lookup"><span data-stu-id="6bd73-243">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="6bd73-244">Если Да, напишите мне [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="6bd73-244">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="6bd73-245">[Назад](master-detail-filtering-with-two-dropdownlists-vb.md)
> [Вперед](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md)</span><span class="sxs-lookup"><span data-stu-id="6bd73-245">[Previous](master-detail-filtering-with-two-dropdownlists-vb.md)
[Next](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md)</span></span>
