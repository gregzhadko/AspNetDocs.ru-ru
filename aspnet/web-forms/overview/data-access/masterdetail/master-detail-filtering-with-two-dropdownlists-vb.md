---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-with-two-dropdownlists-vb
title: Фильтрация "основной/подробности" с помощью двух элементов управления DropDownList (VB) | Документация Майкрософт
author: rick-anderson
description: Это руководство расширяет отношение "основной/подробности", добавляя третий слой, используя два элемента управления DropDownList для выбора нужного родителя и бабушке писи...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 11ae4f64-01ba-4823-95f4-a2fe1f84f7d7
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-with-two-dropdownlists-vb
msc.type: authoredcontent
ms.openlocfilehash: 166d6a7664a326361dc2a3f115eddb988cd39d20
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78424296"
---
# <a name="masterdetail-filtering-with-two-dropdownlists-vb"></a><span data-ttu-id="31f00-103">Фильтрация "Основной/подробности" с помощью двух элементов управления DropDownList (VB)</span><span class="sxs-lookup"><span data-stu-id="31f00-103">Master/Detail Filtering With Two DropDownLists (VB)</span></span>

<span data-ttu-id="31f00-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="31f00-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="31f00-105">[Скачивание примера приложения](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_8_VB.exe) или [Загрузка PDF-файла](master-detail-filtering-with-two-dropdownlists-vb/_static/datatutorial08vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="31f00-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_8_VB.exe) or [Download PDF](master-detail-filtering-with-two-dropdownlists-vb/_static/datatutorial08vb1.pdf)</span></span>

> <span data-ttu-id="31f00-106">Это руководство расширяет отношение "основной/подробности", добавляя третий слой, используя два элемента управления DropDownList для выбора нужных записей родителей и бабушкх.</span><span class="sxs-lookup"><span data-stu-id="31f00-106">This tutorial expands the master/detail relationship to add a third layer, using two DropDownList controls to select the desired parent and grandparent records.</span></span>

## <a name="introduction"></a><span data-ttu-id="31f00-107">Введение</span><span class="sxs-lookup"><span data-stu-id="31f00-107">Introduction</span></span>

<span data-ttu-id="31f00-108">В [предыдущем учебном курсе](master-detail-filtering-with-a-dropdownlist-vb.md) мы рассмотрели, как отобразить простой отчет «основной/подробности» с помощью одного элемента управления DropDownList, заполненного категориями, и элементом управления GridView, отображающим продукты, принадлежащие выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="31f00-108">In the [previous tutorial](master-detail-filtering-with-a-dropdownlist-vb.md) we examined how to display a simple master/details report using a single DropDownList populated with the categories and a GridView showing those products that belong to the selected category.</span></span> <span data-ttu-id="31f00-109">Этот шаблон отчета хорошо работает при отображении записей с отношением "один ко многим" и может быть легко расширено для работы в сценариях, включающих несколько связей "один ко многим".</span><span class="sxs-lookup"><span data-stu-id="31f00-109">This report pattern works well when displaying records that have a one-to-many relationship and can easily be extended to work for scenarios that include multiple one-to-many relationships.</span></span> <span data-ttu-id="31f00-110">Например, система ввода заказов будет иметь таблицы, соответствующие клиентам, заказам и позициям строк заказа.</span><span class="sxs-lookup"><span data-stu-id="31f00-110">For example, an order entry system would have tables that correspond to customers, orders, and order line items.</span></span> <span data-ttu-id="31f00-111">У данного клиента может быть несколько заказов с каждым заказом, состоящим из нескольких элементов.</span><span class="sxs-lookup"><span data-stu-id="31f00-111">A given customer may have multiple orders with each order consisting of multiple items.</span></span> <span data-ttu-id="31f00-112">Такие данные могут быть представлены пользователю с двумя элементов управления DropDownList и GridView.</span><span class="sxs-lookup"><span data-stu-id="31f00-112">Such data can be presented to the user with two DropDownLists and a GridView.</span></span> <span data-ttu-id="31f00-113">Первый DropDownList будет иметь элемент списка для каждого клиента в базе данных со вторым содержимым заказами, размещенными выбранным клиентом.</span><span class="sxs-lookup"><span data-stu-id="31f00-113">The first DropDownList would have a list item for each customer in the database with the second one's contents being the orders placed by the selected customer.</span></span> <span data-ttu-id="31f00-114">Элемент управления GridView будет перечислять элементы строк из выбранного заказа.</span><span class="sxs-lookup"><span data-stu-id="31f00-114">A GridView would list the line items from the selected order.</span></span>

<span data-ttu-id="31f00-115">Хотя база данных Northwind включает в себя каноническую информацию о клиенте/заказе или заказе в своих `Customers`, `Orders`и `Order Details` таблицах, эти таблицы не фиксируются в нашей архитектуре.</span><span class="sxs-lookup"><span data-stu-id="31f00-115">While the Northwind database include the canonical customer/order/order details information in its `Customers`, `Orders`, and `Order Details` tables, these tables aren't captured in our architecture.</span></span> <span data-ttu-id="31f00-116">Тем не менее, мы можем проиллюстрировать использование двух зависимых элементов управления DropDownList.</span><span class="sxs-lookup"><span data-stu-id="31f00-116">Nonetheless, we can still illustrate using two dependent DropDownLists.</span></span> <span data-ttu-id="31f00-117">В первом списке DropDownList будут перечислены категории и вторая продукция, относящаяся к выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="31f00-117">The first DropDownList will list the categories and the second the products belonging to the selected category.</span></span> <span data-ttu-id="31f00-118">Затем DetailsView будет выводить сведения о выбранном продукте.</span><span class="sxs-lookup"><span data-stu-id="31f00-118">A DetailsView will then list the details of the selected product.</span></span>

## <a name="step-1-creating-and-populating-the-categories-dropdownlist"></a><span data-ttu-id="31f00-119">Шаг 1. Создание и заполнение элемента DropDownList в категориях</span><span class="sxs-lookup"><span data-stu-id="31f00-119">Step 1: Creating and Populating the Categories DropDownList</span></span>

<span data-ttu-id="31f00-120">Первая цель — добавить DropDownList, в котором перечислены категории.</span><span class="sxs-lookup"><span data-stu-id="31f00-120">Our first goal is to add the DropDownList that lists the categories.</span></span> <span data-ttu-id="31f00-121">Эти действия были подробно рассмотрены в предыдущем руководстве, но здесь приведены сводные сведения о полноте.</span><span class="sxs-lookup"><span data-stu-id="31f00-121">These steps were examined in detail in the preceding tutorial, but are summarized here for completeness.</span></span>

<span data-ttu-id="31f00-122">Откройте страницу `MasterDetailsDetails.aspx` в папке `Filtering`, добавьте DropDownList на страницу, задайте для свойства `ID` значение `Categories`, а затем щелкните ссылку Настроить источник данных в своем смарт-теге.</span><span class="sxs-lookup"><span data-stu-id="31f00-122">Open the `MasterDetailsDetails.aspx` page in the `Filtering` folder, add a DropDownList to the page, set its `ID` property to `Categories`, and then click the Configure Data Source link in its smart tag.</span></span> <span data-ttu-id="31f00-123">В мастере настройки источника данных выберите Добавление нового источника данных.</span><span class="sxs-lookup"><span data-stu-id="31f00-123">From the Data Source Configuration Wizard choose to add a new data source.</span></span>

<span data-ttu-id="31f00-124">[![добавить новый источник данных для DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image2.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-124">[![Add a New Data Source for the DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image2.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image1.png)</span></span>

<span data-ttu-id="31f00-125">**Рис. 1**. Добавление нового источника данных для DropDownList ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-125">**Figure 1**: Add a New Data Source for the DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image3.png))</span></span>

<span data-ttu-id="31f00-126">Новый источник данных должен, естественно, быть ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="31f00-126">The new data source should, naturally, be an ObjectDataSource.</span></span> <span data-ttu-id="31f00-127">Назовите этот новый элемент ObjectDataSource `CategoriesDataSource` и вызовите метод `GetCategories()` объекта `CategoriesBLL`.</span><span class="sxs-lookup"><span data-stu-id="31f00-127">Name this new ObjectDataSource `CategoriesDataSource` and have it invoke the `CategoriesBLL` object's `GetCategories()` method.</span></span>

<span data-ttu-id="31f00-128">[![выбрать использование класса CategoriesBLL](master-detail-filtering-with-two-dropdownlists-vb/_static/image5.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-128">[![Choose to Use the CategoriesBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image5.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image4.png)</span></span>

<span data-ttu-id="31f00-129">**Рис. 2**. Выбор использования класса `CategoriesBLL` ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-129">**Figure 2**: Choose to Use the `CategoriesBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image6.png))</span></span>

<span data-ttu-id="31f00-130">[![настроить ObjectDataSource для использования метода-Categories ()](master-detail-filtering-with-two-dropdownlists-vb/_static/image8.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-130">[![Configure the ObjectDataSource to Use the GetCategories() Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image8.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image7.png)</span></span>

<span data-ttu-id="31f00-131">**Рис. 3**. Настройка ObjectDataSource для использования метода `GetCategories()` ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-131">**Figure 3**: Configure the ObjectDataSource to Use the `GetCategories()` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image9.png))</span></span>

<span data-ttu-id="31f00-132">После настройки ObjectDataSource необходимо указать, какое поле источника данных должно отображаться в элементе управления DropDownList `Categories` и какое значение должно быть настроено в качестве значения для элемента списка.</span><span class="sxs-lookup"><span data-stu-id="31f00-132">After configuring the ObjectDataSource we still need to specify which data source field should be displayed in the `Categories` DropDownList and which one should be configured as the value for the list item.</span></span> <span data-ttu-id="31f00-133">Задайте поле `CategoryName` как отображаемое и `CategoryID` в качестве значения для каждого элемента списка.</span><span class="sxs-lookup"><span data-stu-id="31f00-133">Set the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>

<span data-ttu-id="31f00-134">[![отображать поле CategoryName и использовать CategoryID в качестве значения](master-detail-filtering-with-two-dropdownlists-vb/_static/image11.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-134">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-two-dropdownlists-vb/_static/image11.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image10.png)</span></span>

<span data-ttu-id="31f00-135">**Рис. 4**. отображение поля `CategoryName` в DropDownList и использование `CategoryID` в качестве значения ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-135">**Figure 4**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image12.png))</span></span>

<span data-ttu-id="31f00-136">На этом этапе у нас есть элемент управления DropDownList (`Categories`), который заполняется записями из `Categories` таблицы.</span><span class="sxs-lookup"><span data-stu-id="31f00-136">At this point we have a DropDownList control (`Categories`) that's populated with the records from the `Categories` table.</span></span> <span data-ttu-id="31f00-137">Когда пользователь выбирает новую категорию из DropDownList, необходимо выполнить обратную передачу, чтобы обновить DropDownList продукта, который мы создадим на шаге 2.</span><span class="sxs-lookup"><span data-stu-id="31f00-137">When the user chooses a new category from the DropDownList we'll want a postback to occur in order to refresh the product DropDownList that we're going to create in Step 2.</span></span> <span data-ttu-id="31f00-138">Поэтому установите флажок Включить автообратную передачу из смарт-тега `categories` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="31f00-138">Therefore, check the Enable AutoPostBack option from the `categories` DropDownList's smart tag.</span></span>

<span data-ttu-id="31f00-139">[![включить автообратную передачу для DropDownList категорий](master-detail-filtering-with-two-dropdownlists-vb/_static/image14.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-139">[![Enable AutoPostBack for the Categories DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image14.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image13.png)</span></span>

<span data-ttu-id="31f00-140">**Рис. 5**. Включение автообратной передачи для `Categories` DropDownList ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-140">**Figure 5**: Enable AutoPostBack for the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image15.png))</span></span>

## <a name="step-2-displaying-the-selected-categorys-products-in-a-second-dropdownlist"></a><span data-ttu-id="31f00-141">Шаг 2. Отображение продуктов выбранной категории во втором элементе DropDownList</span><span class="sxs-lookup"><span data-stu-id="31f00-141">Step 2: Displaying the Selected Category's Products in a Second DropDownList</span></span>

<span data-ttu-id="31f00-142">После завершения работы с DropDownList `Categories` наш следующий шаг — отображение элемента DropDownList для продуктов, принадлежащих выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="31f00-142">With the `Categories` DropDownList completed, our next step is to display a DropDownList of products belonging to the selected category.</span></span> <span data-ttu-id="31f00-143">Для этого добавьте в страницу другое окно DropDownList с именем `ProductsByCategory`.</span><span class="sxs-lookup"><span data-stu-id="31f00-143">To accomplish this, add another DropDownList to the page named `ProductsByCategory`.</span></span> <span data-ttu-id="31f00-144">Как и в `Categories` DropDownList, создайте новый элемент ObjectDataSource для `ProductsByCategory` DropDownList с именем `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="31f00-144">As with the `Categories` DropDownList, create a new ObjectDataSource for the `ProductsByCategory` DropDownList named `ProductsByCategoryDataSource`.</span></span>

<span data-ttu-id="31f00-145">[![добавить новый источник данных для DropDownList ProductsByCategory](master-detail-filtering-with-two-dropdownlists-vb/_static/image17.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-145">[![Add a New Data Source for the ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image17.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image16.png)</span></span>

<span data-ttu-id="31f00-146">**Рис. 6**. Добавление нового источника данных для элемента DropDownList `ProductsByCategory` ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-146">**Figure 6**: Add a New Data Source for the `ProductsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image18.png))</span></span>

<span data-ttu-id="31f00-147">[![создать новый элемент управления ObjectDataSource с именем Продуктсбикатегоридатасаурце](master-detail-filtering-with-two-dropdownlists-vb/_static/image20.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-147">[![Create a New ObjectDataSource Named ProductsByCategoryDataSource](master-detail-filtering-with-two-dropdownlists-vb/_static/image20.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image19.png)</span></span>

<span data-ttu-id="31f00-148">**Рис. 7**. Создание нового элемента управления ObjectDataSource с именем `ProductsByCategoryDataSource` ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-148">**Figure 7**: Create a New ObjectDataSource Named `ProductsByCategoryDataSource` ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image21.png))</span></span>

<span data-ttu-id="31f00-149">Поскольку `ProductsByCategory` DropDownList должны отображать только те продукты, которые относятся к выбранной категории, элемент ObjectDataSource должен вызвать метод `GetProductsByCategoryID(categoryID)` из объекта `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="31f00-149">Since the `ProductsByCategory` DropDownList needs to display just those products belonging to the selected category, have the ObjectDataSource invoke the `GetProductsByCategoryID(categoryID)` method from the `ProductsBLL` object.</span></span>

<span data-ttu-id="31f00-150">[![выбрать использование класса ProductsBLL](master-detail-filtering-with-two-dropdownlists-vb/_static/image23.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-150">[![Choose to Use the ProductsBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image23.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image22.png)</span></span>

<span data-ttu-id="31f00-151">**Рис. 8**. Выбор использования класса `ProductsBLL` ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-151">**Figure 8**: Choose to Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image24.png))</span></span>

<span data-ttu-id="31f00-152">[![настроить ObjectDataSource для использования метода GetProductsByCategoryID (categoryID)](master-detail-filtering-with-two-dropdownlists-vb/_static/image26.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-152">[![Configure the ObjectDataSource to Use the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image26.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image25.png)</span></span>

<span data-ttu-id="31f00-153">**Рис. 9**. Настройка ObjectDataSource для использования метода `GetProductsByCategoryID(categoryID)` ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-153">**Figure 9**: Configure the ObjectDataSource to Use the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image27.png))</span></span>

<span data-ttu-id="31f00-154">На последнем шаге мастера необходимо указать значение параметра *`categoryID`* .</span><span class="sxs-lookup"><span data-stu-id="31f00-154">In the final step of the wizard we need to specify the value of the *`categoryID`* parameter.</span></span> <span data-ttu-id="31f00-155">Присвойте этот параметр выбранному элементу из `Categories` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="31f00-155">Assign this parameter to the selected item from the `Categories` DropDownList.</span></span>

<span data-ttu-id="31f00-156">[![извлечь значение параметра categoryID из DropDownList категорий](master-detail-filtering-with-two-dropdownlists-vb/_static/image29.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-156">[![Pull the categoryID Parameter Value from the Categories DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image29.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image28.png)</span></span>

<span data-ttu-id="31f00-157">**Рис. 10**. извлечение значения *`categoryID`* параметра из `Categories` DropDownList ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-157">**Figure 10**: Pull the *`categoryID`* Parameter Value from the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image30.png))</span></span>

<span data-ttu-id="31f00-158">После настройки ObjectDataSource остается только указать поля источника данных, используемые для вывода и значения элементов DropDownList.</span><span class="sxs-lookup"><span data-stu-id="31f00-158">With the ObjectDataSource configured, all that remains is to specify what data source fields are used for the display and value of the DropDownList's items.</span></span> <span data-ttu-id="31f00-159">Отобразите поле `ProductName` и используйте в качестве значения поле `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="31f00-159">Display the `ProductName` field and use the `ProductID` field as the value.</span></span>

<span data-ttu-id="31f00-160">[![указать поля источника данных, используемые для свойств Text и Value элемента списка DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image32.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-160">[![Specify the Data Source Fields Used for the DropDownList's ListItems' Text and Value Properties](master-detail-filtering-with-two-dropdownlists-vb/_static/image32.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image31.png)</span></span>

<span data-ttu-id="31f00-161">**Рис. 11**. Указание полей источника данных, используемых для свойств `ListItem` s "`Text` и `Value` элемента DropDownList ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-161">**Figure 11**: Specify the Data Source Fields Used for the DropDownList's `ListItem` s' `Text` and `Value` Properties ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image33.png))</span></span>

<span data-ttu-id="31f00-162">С помощью элемента управления DropDownList и `ProductsByCategory`, настроенного на нашей странице, будут отображены два элементов управления DropDownList: Первая выводит все категории, а вторая — список продуктов, принадлежащих выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="31f00-162">With the ObjectDataSource and `ProductsByCategory` DropDownList configured our page will display two DropDownLists: the first will list all of the categories while the second will list those products belonging to the selected category.</span></span> <span data-ttu-id="31f00-163">Когда пользователь выбирает новую категорию из первого элемента DropDownList, будет предприниматься обратная передача, а второй элемент DropDownList будет привязан повторно, отображая продукты, принадлежащие к только что выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="31f00-163">When the user selects a new category from the first DropDownList, a postback will ensue and the second DropDownList will be rebound, showing those products that belong to the newly selected category.</span></span> <span data-ttu-id="31f00-164">На рисунках 12 и 13 показаны `MasterDetailsDetails.aspx` в действии при просмотре в браузере.</span><span class="sxs-lookup"><span data-stu-id="31f00-164">Figures 12 and 13 show `MasterDetailsDetails.aspx` in action when viewed through a browser.</span></span>

<span data-ttu-id="31f00-165">[![при первом посещении страницы выбирается Категория «напитки»](master-detail-filtering-with-two-dropdownlists-vb/_static/image35.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-165">[![When First Visiting the Page, the Beverages Category is Selected](master-detail-filtering-with-two-dropdownlists-vb/_static/image35.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image34.png)</span></span>

<span data-ttu-id="31f00-166">**Рис. 12**. при первом посещении страницы выбирается Категория «напитки» ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image36.png)).</span><span class="sxs-lookup"><span data-stu-id="31f00-166">**Figure 12**: When First Visiting the Page, the Beverages Category is Selected ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image36.png))</span></span>

<span data-ttu-id="31f00-167">[![выборе другой категории отображаются продукты новой категории.](master-detail-filtering-with-two-dropdownlists-vb/_static/image38.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-167">[![Choosing a Different Category Displays the New Category's Products](master-detail-filtering-with-two-dropdownlists-vb/_static/image38.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image37.png)</span></span>

<span data-ttu-id="31f00-168">**Рис. 13**. Выбор другой категории отображает продукты новой категории ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-168">**Figure 13**: Choosing a Different Category Displays the New Category's Products ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image39.png))</span></span>

<span data-ttu-id="31f00-169">В настоящее время `productsByCategory` DropDownList, при изменении, *не вызывает* обратную передачу.</span><span class="sxs-lookup"><span data-stu-id="31f00-169">Currently the `productsByCategory` DropDownList, when changed, does *not* cause a postback.</span></span> <span data-ttu-id="31f00-170">Однако мы хотим, чтобы обратная передача выполнялась после добавления элемента DetailsView для вывода сведений о выбранном продукте (шаг 3).</span><span class="sxs-lookup"><span data-stu-id="31f00-170">However, we will want a postback to occur once we add a DetailsView to display the selected product's details (Step 3).</span></span> <span data-ttu-id="31f00-171">Поэтому установите флажок Включить автообратную передачу из смарт-тега `productsByCategory` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="31f00-171">Therefore, check the Enable AutoPostBack checkbox from the `productsByCategory` DropDownList's smart tag.</span></span>

<span data-ttu-id="31f00-172">[![включить функцию автообратной передачи для DropDownList productsByCategory](master-detail-filtering-with-two-dropdownlists-vb/_static/image41.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-172">[![Enable the AutoPostBack Feature for the productsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image41.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image40.png)</span></span>

<span data-ttu-id="31f00-173">**Рис. 14**. Включение функции автообратной передачи для элемента DropDownList `productsByCategory` ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-173">**Figure 14**: Enable the AutoPostBack Feature for the `productsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image42.png))</span></span>

## <a name="step-3-using-a-detailsview-to-display-details-for-the-selected-product"></a><span data-ttu-id="31f00-174">Шаг 3. Отображение сведений о выбранном продукте с помощью элемента DetailsView</span><span class="sxs-lookup"><span data-stu-id="31f00-174">Step 3: Using a DetailsView to Display Details for the Selected Product</span></span>

<span data-ttu-id="31f00-175">Последним шагом является отображение сведений о выбранном продукте в элементе DetailsView.</span><span class="sxs-lookup"><span data-stu-id="31f00-175">The final step is to display the details for the selected product in a DetailsView.</span></span> <span data-ttu-id="31f00-176">Для этого добавьте DetailsView на страницу, задайте для свойства `ID` значение `ProductDetails`и создайте для него новый элемент управления ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="31f00-176">To accomplish this, add a DetailsView to the page, set its `ID` property to `ProductDetails`, and create a new ObjectDataSource for it.</span></span> <span data-ttu-id="31f00-177">Настройте этот элемент ObjectDataSource, чтобы извлечь данные из метода `GetProductByProductID(productID)` класса `ProductsBLL`, используя выбранное значение `ProductsByCategory` DropDownList для значения параметра *`productID`* .</span><span class="sxs-lookup"><span data-stu-id="31f00-177">Configure this ObjectDataSource to pull its data from the `ProductsBLL` class's `GetProductByProductID(productID)` method using the selected value of the `ProductsByCategory` DropDownList for the value of the *`productID`* parameter.</span></span>

<span data-ttu-id="31f00-178">[![выбрать использование класса ProductsBLL](master-detail-filtering-with-two-dropdownlists-vb/_static/image44.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-178">[![Choose to Use the ProductsBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image44.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image43.png)</span></span>

<span data-ttu-id="31f00-179">**Рис. 15**. Выбор использования класса `ProductsBLL` ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-179">**Figure 15**: Choose to Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image45.png))</span></span>

<span data-ttu-id="31f00-180">[![настроить ObjectDataSource для использования метода Жетпродуктбипродуктид (productID)](master-detail-filtering-with-two-dropdownlists-vb/_static/image47.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-180">[![Configure the ObjectDataSource to Use the GetProductByProductID(productID) Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image47.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image46.png)</span></span>

<span data-ttu-id="31f00-181">**Рис. 16**. Настройка ObjectDataSource для использования метода `GetProductByProductID(productID)` ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-181">**Figure 16**: Configure the ObjectDataSource to Use the `GetProductByProductID(productID)` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image48.png))</span></span>

<span data-ttu-id="31f00-182">[![извлечь значение параметра productID из DropDownList ProductsByCategory](master-detail-filtering-with-two-dropdownlists-vb/_static/image50.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-182">[![Pull the productID Parameter Value from the ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image50.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image49.png)</span></span>

<span data-ttu-id="31f00-183">**Рис. 17**. извлечение значения *`productID`* параметра из `ProductsByCategory` DropDownList ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-183">**Figure 17**: Pull the *`productID`* Parameter Value from the `ProductsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image51.png))</span></span>

<span data-ttu-id="31f00-184">Можно выбрать отображение любого из доступных полей в `ProductDetails` DetailsView.</span><span class="sxs-lookup"><span data-stu-id="31f00-184">You can choose to display any of the available fields in the `ProductDetails` DetailsView.</span></span> <span data-ttu-id="31f00-185">Я решил удалить поля `ProductID`, `SupplierID`и `CategoryID`, а также изменить порядок и отформатировать оставшиеся поля.</span><span class="sxs-lookup"><span data-stu-id="31f00-185">I've opted to remove the `ProductID`, `SupplierID`, and `CategoryID` fields and reordered and formatted the remaining fields.</span></span> <span data-ttu-id="31f00-186">Кроме того, я очистил свойства `Height` и `Width` DetailsView, позволяя элементу DetailsView расшириться до ширины, необходимой для наилучшего представления данных, а не ограничиваться заданным размером.</span><span class="sxs-lookup"><span data-stu-id="31f00-186">In addition, I cleared out the DetailsView's `Height` and `Width` properties, allowing the DetailsView to expand to the width needed to best display its data rather than having it constrained to a specified size.</span></span> <span data-ttu-id="31f00-187">Полная разметка показана ниже:</span><span class="sxs-lookup"><span data-stu-id="31f00-187">The full markup appears below:</span></span>

[!code-aspx[Main](master-detail-filtering-with-two-dropdownlists-vb/samples/sample1.aspx)]

<span data-ttu-id="31f00-188">Уделите немного времени, чтобы испытать страницу `MasterDetailsDetails.aspx` в браузере.</span><span class="sxs-lookup"><span data-stu-id="31f00-188">Take a moment to try out the `MasterDetailsDetails.aspx` page in a browser.</span></span> <span data-ttu-id="31f00-189">На первый взгляд может показаться, что все работает надлежащим образом, но есть несложная проблема.</span><span class="sxs-lookup"><span data-stu-id="31f00-189">At first glance it may appear that everything is working as desired, but there's a subtle problem.</span></span> <span data-ttu-id="31f00-190">При выборе новой категории `ProductsByCategory` DropDownList обновляется, чтобы включить эти продукты для выбранной категории, но `ProductDetails` DetailsView продолжает отображать предыдущую информацию о продукте.</span><span class="sxs-lookup"><span data-stu-id="31f00-190">When you choose a new category the `ProductsByCategory` DropDownList is updated to include those products for the selected category, but the `ProductDetails` DetailsView continued to show the previous product information.</span></span> <span data-ttu-id="31f00-191">Элемент DetailsView обновляется при выборе другого продукта для выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="31f00-191">The DetailsView is updated when choosing a different product for the selected category.</span></span> <span data-ttu-id="31f00-192">Более того, при тщательном тестировании вы обнаружите, что если постоянно выбрать новые категории (например, выбрать напитки из `Categories` DropDownList, затем «специи», а затем Конфектионс), то при каждом выборе категории DetailsView будет обновлено `ProductDetails`.</span><span class="sxs-lookup"><span data-stu-id="31f00-192">Furthermore, if you test thoroughly enough, you'll find that if you continually choose new categories (such as choosing Beverages from the `Categories` DropDownList, then Condiments, then Confections) every other category selection causes the `ProductDetails` DetailsView to be refreshed.</span></span>

<span data-ttu-id="31f00-193">Чтобы помочь конкретизировать эту проблему, давайте взглянем на конкретный пример.</span><span class="sxs-lookup"><span data-stu-id="31f00-193">To help concretize this problem, let's look at a specific example.</span></span> <span data-ttu-id="31f00-194">При первом посещении страницы выбирается Категория «напитки», а связанные продукты загружаются в `ProductsByCategory` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="31f00-194">When you first visit the page the Beverages category is selected and the related products are loaded in the `ProductsByCategory` DropDownList.</span></span> <span data-ttu-id="31f00-195">Chai — это выбранный продукт, и его сведения отображаются в `ProductDetails` DetailsView, как показано на рис. 18.</span><span class="sxs-lookup"><span data-stu-id="31f00-195">Chai is the selected product and its details are displayed in the `ProductDetails` DetailsView, as shown in Figure 18.</span></span>

<span data-ttu-id="31f00-196">[![сведения о выбранном продукте отображаются в элементе DetailsView](master-detail-filtering-with-two-dropdownlists-vb/_static/image53.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-196">[![The Selected Product's Details are Displayed in a DetailsView](master-detail-filtering-with-two-dropdownlists-vb/_static/image53.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image52.png)</span></span>

<span data-ttu-id="31f00-197">**Рис. 18**. сведения о выбранном продукте отображаются в элементе DetailsView ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-197">**Figure 18**: The Selected Product's Details are Displayed in a DetailsView ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image54.png))</span></span>

<span data-ttu-id="31f00-198">Если вы изменяете выбор категории с "Напиткиs" на «специи», происходит обратная передача, и `ProductsByCategory` DropDownList обновляется соответствующим образом, но элемент DetailsView по-прежнему отображает сведения для Chai.</span><span class="sxs-lookup"><span data-stu-id="31f00-198">If you change the category selection from Beverages to Condiments, a postback occurs and the `ProductsByCategory` DropDownList is updated accordingly, but the DetailsView still displays details for Chai.</span></span>

<span data-ttu-id="31f00-199">[![сведения о выбранном ранее продукте по-прежнему отображаются](master-detail-filtering-with-two-dropdownlists-vb/_static/image56.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-199">[![The Previously Selected Product's Details are Still Displayed](master-detail-filtering-with-two-dropdownlists-vb/_static/image56.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image55.png)</span></span>

<span data-ttu-id="31f00-200">**Рис. 19**. сведения о выбранном ранее продукте по-прежнему отображаются ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-200">**Figure 19**: The Previously Selected Product's Details are Still Displayed ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image57.png))</span></span>

<span data-ttu-id="31f00-201">При выборе нового продукта из списка элемент DetailsView обновляется, как и ожидалось.</span><span class="sxs-lookup"><span data-stu-id="31f00-201">Picking a new product from the list refreshes the DetailsView as expected.</span></span> <span data-ttu-id="31f00-202">Если после изменения продукта выбрать новую категорию, то DetailsView снова не обновится.</span><span class="sxs-lookup"><span data-stu-id="31f00-202">If you pick a new category after changing the product, the DetailsView again won't refresh.</span></span> <span data-ttu-id="31f00-203">Однако если вместо выбора нового продукта выбрана новая категория, элемент DetailsView обновится.</span><span class="sxs-lookup"><span data-stu-id="31f00-203">However, if instead of choosing a new product you selected a new category, the DetailsView would refresh.</span></span> <span data-ttu-id="31f00-204">Что происходит в мире?</span><span class="sxs-lookup"><span data-stu-id="31f00-204">What in the world is going on here?</span></span>

<span data-ttu-id="31f00-205">Проблема — это проблема времени в жизненном цикле страницы.</span><span class="sxs-lookup"><span data-stu-id="31f00-205">The problem is a timing issue in the page's lifecycle.</span></span> <span data-ttu-id="31f00-206">Каждый раз, когда запрашивается страница, она проходит ряд шагов в качестве ее отрисовки.</span><span class="sxs-lookup"><span data-stu-id="31f00-206">Whenever a page is requested it proceeds through a number of steps as its rendering.</span></span> <span data-ttu-id="31f00-207">В одном из этих действий элементы управления ObjectDataSource проверяют, изменились ли какие либо их `SelectParameters` значения.</span><span class="sxs-lookup"><span data-stu-id="31f00-207">In one of these steps the ObjectDataSource controls check to see if any of their `SelectParameters` values have changed.</span></span> <span data-ttu-id="31f00-208">Если да, то веб-элемент управления данными, привязанный к ObjectDataSource, знает, что ему нужно обновить его отображение.</span><span class="sxs-lookup"><span data-stu-id="31f00-208">If so, the data Web control bound to the ObjectDataSource knows that it needs to refresh its display.</span></span> <span data-ttu-id="31f00-209">Например, если выбрана новая категория, `ProductsByCategoryDataSource` ObjectDataSource обнаруживает, что значения ее параметров изменились и `ProductsByCategory` DropDownList выполняет повторную привязку, получая продукты для выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="31f00-209">For example, when a new category is selected, the `ProductsByCategoryDataSource` ObjectDataSource detects that its parameter values have changed and the `ProductsByCategory` DropDownList rebinds itself, getting the products for the selected category.</span></span>

<span data-ttu-id="31f00-210">Проблема, которая возникает в этой ситуации, заключается в том, что точка жизненного цикла страницы, которая проверяется на предмет измененных параметров, выполняется *перед* повторной привязкой связанных веб-элементов управления данными.</span><span class="sxs-lookup"><span data-stu-id="31f00-210">The problem that arises in this situation is that the point in the page lifecycle that the ObjectDataSources check for changed parameters occurs *before* the rebinding of the associated data Web controls.</span></span> <span data-ttu-id="31f00-211">Поэтому при выборе новой категории `ProductsByCategoryDataSource` ObjectDataSource обнаруживает изменение значения его параметра.</span><span class="sxs-lookup"><span data-stu-id="31f00-211">Therefore, when selecting a new category the `ProductsByCategoryDataSource` ObjectDataSource detects a change in its parameter's value.</span></span> <span data-ttu-id="31f00-212">Тем не менее, ObjectDataSource, используемый `ProductDetails` DetailsView, не запомните никаких изменений, так как `ProductsByCategory` DropDownList еще не был привязан.</span><span class="sxs-lookup"><span data-stu-id="31f00-212">The ObjectDataSource used by the `ProductDetails` DetailsView, however, doesn't note any such changes because the `ProductsByCategory` DropDownList has yet to be rebound.</span></span> <span data-ttu-id="31f00-213">Позднее в жизненном цикле `ProductsByCategory` DropDownList повторно привязывается к элементу ObjectDataSource, заменяя продукты для вновь выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="31f00-213">Later in the lifecycle the `ProductsByCategory` DropDownList rebinds to its ObjectDataSource, grabbing the products for the newly selected category.</span></span> <span data-ttu-id="31f00-214">Хотя значение DropDownList `ProductsByCategory` изменилось, элемент управления ObjectDataSource `ProductDetails` DetailsView уже выполнил проверку значения параметра; Таким образом, элемент DetailsView отображает свои предыдущие результаты.</span><span class="sxs-lookup"><span data-stu-id="31f00-214">While the `ProductsByCategory` DropDownList's value has changed, the `ProductDetails` DetailsView's ObjectDataSource has already done its parameter value check; therefore, the DetailsView displays its previous results.</span></span> <span data-ttu-id="31f00-215">Это взаимодействие показано на рис. 20.</span><span class="sxs-lookup"><span data-stu-id="31f00-215">This interaction is depicted in Figure 20.</span></span>

<span data-ttu-id="31f00-216">[![значение ProductsByCategory DropDownList изменяется после того, как ObjectDataSource Продуктдетаилс DetailsView проверяет наличие изменений](master-detail-filtering-with-two-dropdownlists-vb/_static/image59.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-216">[![The ProductsByCategory DropDownList Value Changes After the ProductDetails DetailsView's ObjectDataSource Checks for Changes](master-detail-filtering-with-two-dropdownlists-vb/_static/image59.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image58.png)</span></span>

<span data-ttu-id="31f00-217">**Рис. 20**. значение `ProductsByCategory` DropDownList изменяется после того, как элемент управления ObjectDataSource `ProductDetails` DetailsView проверяет наличие изменений ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="31f00-217">**Figure 20**: The `ProductsByCategory` DropDownList Value Changes After the `ProductDetails` DetailsView's ObjectDataSource Checks for Changes ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image60.png))</span></span>

<span data-ttu-id="31f00-218">Для устранения этой проблемы необходимо явно выполнить привязку `ProductDetails` DetailsView после привязки `ProductsByCategory` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="31f00-218">To remedy this we need to explicitly rebind the `ProductDetails` DetailsView after the `ProductsByCategory` DropDownList has been bound.</span></span> <span data-ttu-id="31f00-219">Это можно сделать, вызвав метод `DataBind()` `ProductDetails` DetailsView, когда срабатывает событие `DataBound` `ProductsByCategory` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="31f00-219">We can accomplish this by calling the `ProductDetails` DetailsView's `DataBind()` method when the `ProductsByCategory` DropDownList's `DataBound` event fires.</span></span> <span data-ttu-id="31f00-220">Добавьте следующий код обработчика событий в класс кода программной части `MasterDetailsDetails.aspx` страницы (см. "[программное задание значений параметров ObjectDataSource](../basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)" для обсуждения добавления обработчика событий):</span><span class="sxs-lookup"><span data-stu-id="31f00-220">Add the following event handler code to the `MasterDetailsDetails.aspx` page's code-behind class (refer to the "[Programmatically Setting the ObjectDataSource's Parameter Values](../basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)" for a discussion on how to add an event handler):</span></span>

[!code-vb[Main](master-detail-filtering-with-two-dropdownlists-vb/samples/sample2.vb)]

<span data-ttu-id="31f00-221">После того как был добавлен явный вызов метода `DataBind()` `ProductDetails` DetailsView, учебник работает правильно.</span><span class="sxs-lookup"><span data-stu-id="31f00-221">After this explicit call to the `ProductDetails` DetailsView's `DataBind()` method has been added, the tutorial works as expected.</span></span> <span data-ttu-id="31f00-222">На рис. 21 показано, как это изменение исправлено в нашей предыдущей проблеме.</span><span class="sxs-lookup"><span data-stu-id="31f00-222">Figure 21 highlights how this changed remedied our earlier problem.</span></span>

<span data-ttu-id="31f00-223">[![Продуктдетаилс DetailsView явно обновляется при срабатывании события привязки к данным DropDownList ProductsByCategory](master-detail-filtering-with-two-dropdownlists-vb/_static/image62.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="31f00-223">[![The ProductDetails DetailsView is Explicitly Refreshed When the ProductsByCategory DropDownList's DataBound Event Fires](master-detail-filtering-with-two-dropdownlists-vb/_static/image62.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image61.png)</span></span>

<span data-ttu-id="31f00-224">**Рисунок 21**. `ProductDetails` DetailsView явно обновляется при срабатывании события `DataBound` `ProductsByCategory` DropDownList ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-two-dropdownlists-vb/_static/image63.png)).</span><span class="sxs-lookup"><span data-stu-id="31f00-224">**Figure 21**: The `ProductDetails` DetailsView is Explicitly Refreshed When the `ProductsByCategory` DropDownList's `DataBound` Event Fires ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image63.png))</span></span>

## <a name="summary"></a><span data-ttu-id="31f00-225">Сводка</span><span class="sxs-lookup"><span data-stu-id="31f00-225">Summary</span></span>

<span data-ttu-id="31f00-226">Элемент DropDownList выступает в качестве идеального элемента пользовательского интерфейса для отчетов «основной/подробности», где существует связь «один ко многим» между главной и подробной записями.</span><span class="sxs-lookup"><span data-stu-id="31f00-226">The DropDownList serves as an ideal user interface element for master/detail reports where there is a one-to-many relationship between the master and detail records.</span></span> <span data-ttu-id="31f00-227">В предыдущем учебном курсе мы увидели, как использовать одно DropDownList для фильтрации продуктов, отображаемых выбранной категорией.</span><span class="sxs-lookup"><span data-stu-id="31f00-227">In the preceding tutorial we saw how to use a single DropDownList to filter the products displayed by the selected category.</span></span> <span data-ttu-id="31f00-228">В этом руководстве мы заменили элемент управления GridView для продуктов элементом управления DropDownList и используем DetailsView для просмотра сведений о выбранном продукте.</span><span class="sxs-lookup"><span data-stu-id="31f00-228">In this tutorial we replaced the GridView of products with a DropDownList, and used a DetailsView to display the details of the selected product.</span></span> <span data-ttu-id="31f00-229">Концепции, обсуждаемые в этом руководстве, можно легко расширить на модели данных, включающие в себя несколько связей «один ко многим», таких как клиенты, заказы и элементы заказов.</span><span class="sxs-lookup"><span data-stu-id="31f00-229">The concepts discussed in this tutorial can easily be extended to data models involving multiple one-to-many relationships, such as customers, orders, and order items.</span></span> <span data-ttu-id="31f00-230">В целом, всегда можно добавить элемент DropDownList для каждой из сущностей «один» в связях «один ко многим».</span><span class="sxs-lookup"><span data-stu-id="31f00-230">In general, you can always add a DropDownList for each of the "one" entities in the one-to-many relationships.</span></span>

<span data-ttu-id="31f00-231">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="31f00-231">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="31f00-232">Об авторе</span><span class="sxs-lookup"><span data-stu-id="31f00-232">About the Author</span></span>

<span data-ttu-id="31f00-233">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="31f00-233">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="31f00-234">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="31f00-234">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="31f00-235">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="31f00-235">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="31f00-236">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="31f00-236">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="31f00-237">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="31f00-237">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="31f00-238">Специальная благодарность</span><span class="sxs-lookup"><span data-stu-id="31f00-238">Special Thanks To</span></span>

<span data-ttu-id="31f00-239">Эта серия руководств была рассмотрена многими полезными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="31f00-239">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="31f00-240">Специалист по интересу для этого руководства был Хилтон Гизнау.</span><span class="sxs-lookup"><span data-stu-id="31f00-240">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="31f00-241">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="31f00-241">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="31f00-242">Если это так, расположите строку в [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="31f00-242">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="31f00-243">[Назад](master-detail-filtering-with-a-dropdownlist-vb.md)
> [Вперед](master-detail-filtering-across-two-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="31f00-243">[Previous](master-detail-filtering-with-a-dropdownlist-vb.md)
[Next](master-detail-filtering-across-two-pages-vb.md)</span></span>
