---
uid: web-forms/overview/data-access/introduction/creating-a-data-access-layer-vb
title: Создание уровня доступа к данным (Visual Basic) | Документация Майкрософт
author: rick-anderson
description: В этом руководстве мы начнем с самого начала и создать доступа к данным уровня (DAL), использование типизированных наборов данных, доступ к сведениям в базе данных.
ms.author: riande
ms.date: 04/05/2010
ms.assetid: 6227233a-6254-4b6b-9a89-947efef22330
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-data-access-layer-vb
msc.type: authoredcontent
ms.openlocfilehash: e4715862d7bc89f37a74ef63ee09e69e6e2d2665
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/09/2019
ms.locfileid: "59396893"
---
# <a name="creating-a-data-access-layer-vb"></a>Создание уровня доступа к данным (VB)

по [Скотт Митчелл](https://twitter.com/ScottOnWriting)

[Скачайте пример приложения](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_1_VB.exe) или [скачать PDF](creating-a-data-access-layer-vb/_static/datatutorial01vb1.pdf)

> В этом руководстве мы начнем с самого начала и создать доступа к данным уровня (DAL), использование типизированных наборов данных, доступ к сведениям в базе данных.


## <a name="introduction"></a>Вступление

Веб-разработчиков вся деятельность работа с данными. Мы создаем базы данных для хранения данных, код для извлечения и изменения данных и веб-страниц для сбора и их обобщения. Это первый учебник из длинной серии, в которой будут рассмотрены приемы реализации этих распространенных схем в ASP.NET 2.0. Мы начнем с создания [архитектуры программного обеспечения](http://en.wikipedia.org/wiki/Software_architecture) состоит из доступа уровня данным (DAL) с помощью типизированных наборов DataSet, слоя бизнес-логики (BLL), реализующего выполнение пользовательских бизнес-правил и состоит из ASP.NET уровня представления страниц, совместно использовать общий макет страницы. После этого серверной части фундамента, мы перейдем к созданию отчетов, демонстрации методов отображения, суммировать, собирать и проверять данные из веб-приложения. Учебных курсах предусмотрена краткая форма изложения и предоставляются поэтапные указания со множеством снимков экранов покажем процесс визуально. Каждое руководство доступно в C# и Visual Basic версии и загрузить полный код, используемый. (Первый учебный курс довольно длинный, но остальные будут представлены в гораздо более удобоваримых порциях.)

Эти руководства мы будем использовать версию базы данных Northwind, помещаются в Microsoft SQL Server 2005 Express Edition `App_Data` каталога. В дополнение к файлу базы данных `App_Data` папка также содержит скрипты SQL для создания базы данных, в случае, если вы хотите использовать другая версия базы данных. Эти скрипты могут также быть [скачать непосредственно из Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), если вы хотите использовать. При использовании другой версии SQL Server, базы данных "Борей", необходимо обновить `NORTHWNDConnectionString` в приложения `Web.config` файл. Веб-приложение было создано с помощью Visual Studio 2005 Professional Edition как проект веб-узел системы файла. Однако все учебные будет работать одинаково хорошо с бесплатной версии Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).

В этом руководстве мы начнем с самого начала и создать доступа к данным уровня (DAL), следуют создание [слой бизнес-логики (BLL)](creating-a-business-logic-layer-vb.md) в второй руководства и работать над [навигацииимакетстраницы](master-pages-and-site-navigation-vb.md) в третьем. Учебники после третий будет основываться на фундаменте, заложенном в первых трех. У нас есть много в этом первом учебнике, поэтому запускайте Visual Studio и давайте начнем!

## <a name="step-1-creating-a-web-project-and-connecting-to-the-database"></a>Шаг 1. Создание веб-проекта и подключение к базе данных

Чтобы создать наш слой доступа к данным (DAL), необходимо сначала создать веб-сайт и настроить базу данных. Начните с создания нового файла на основе системы веб-сайт ASP.NET. Чтобы выполнить это, перейдите к меню "файл" и выберите новый веб-сайт, отображает диалоговое окно нового веб-сайта. Выберите шаблон веб-сайт ASP.NET, задайте раскрывающемся списке расположение в файловой системе, выберите папку для размещения веб-сайта и выбранный язык Visual Basic.


[![CСоздание веб-сайта New File System-Based](creating-a-data-access-layer-vb/_static/image2.png)](creating-a-data-access-layer-vb/_static/image1.png)

**Рис. 1**: Создание веб-сайта New File System-Based ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image3.png))


Это создаст новый веб-сайт с `Default.aspx` страницы ASP.NET, `App_Data` папки и `Web.config` файла.

Веб-сайт создан следующим шагом является добавление ссылки на базу данных в обозревателе серверов Visual Studio. Путем добавления базы данных в проводник по серверам можно добавить таблицы, хранимые процедуры, представления и т. д. все это выполняется из среды Visual Studio. Также можно просматривать табличные данные или создавать собственные запросы вручную или графически с помощью построителя запросов. Кроме того при конструировании типизированных наборов DataSet для слоя DAL необходимо указать Visual Studio в базу данных, из которой должны конструироваться типизированные наборы DataSet. Хотя имеется возможность предоставить эти сведения о подключении в определенный момент времени, Visual Studio автоматически заполняет стрелку раскрывающегося списка баз данных, уже зарегистрирован в обозревателе серверов.

Инструкции по добавлению базы данных Northwind в проводник по серверам зависят от того, требуется ли использовать базу данных SQL Server 2005 Express Edition в `App_Data` папку или при наличии Microsoft SQL Server 2000 или Настройка сервера базы данных 2005, который вы хотите использовать Вместо этого.

## <a name="using-a-database-in-theappdatafolder"></a>С помощью базы данных в`App_Data`папки

Если у вас нет SQL Server 2000 или 2005 сервер базы данных для подключения к, или вы просто хотите избежать добавления базы данных на сервер базы данных, можно использовать версию SQL Server 2005 Express Edition базы данных Northwind, расположенного в загруженных веб-сайт e's `App_Data` папку (`NORTHWND.MDF`).

База данных, помещенная в `App_Data` , автоматически добавляется в проводник по серверам. При условии, что у вас есть SQL Server 2005 Express Edition на компьютере вы увидите узел с именем NORTHWND. MDF-ФАЙЛОМ, в обозревателе серверов, которые можно развернуть и изучить его таблиц, представлений, хранимых процедур и т. д. (см. рис. 2).

`App_Data` Могут содержаться также Microsoft Access `.mdb` файлы, которые, как их аналоги SQL Server, автоматически добавляется в проводник по серверам. Если вы не хотите использовать любой из параметров SQL Server, вы всегда можете [загрузить версию файла базы данных "Борей" Microsoft Access](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) в `App_Data` каталога. Имейте в виду, однако, базы данных Access не так многофункциональны, как SQL Server и не предназначены для использования в сценариях веб-сайта. Кроме того несколько учебников 35-будет использовать некоторые функции уровня базы данных, не поддерживаемые Access.

## <a name="connecting-to-the-database-in-a-microsoft-sql-server-2000-or-2005-database-server"></a>Подключение к базе данных на сервере базы данных Microsoft SQL Server 2000 или 2005

Кроме того можно подключиться к базе данных "Борей" на сервере базы данных. Если сервер базы данных не имеет базу данных "Борей", сначала необходимо добавить его к серверу базы данных, запустив сценарий установки, входящий в этом руководстве для загрузки или с помощью [загрузку версии SQL Server 2000 "Борей" и сценарий установки](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) непосредственно с веб-сайта корпорации Майкрософт.

После установки базы данных, перейдите в проводник по серверам в Visual Studio, щелкните правой кнопкой мыши узел Data Connections и выберите Добавить подключение. Если вы не видите перейдите в представление обозревателя серверов / обозревателя серверов, или нажмите сочетание клавиш Ctrl + Alt + S. Это приведет к появлению диалогового окна добавления соединения, где можно указать сервер для подключения, сведения для проверки подлинности и имя базы данных. Когда вы успешно настроили подключение к базе данных и нажмет кнопку OK, базы данных будут добавлены как узел в узле подключения к данным. Можно развернуть узел базы данных для просмотра таблиц, представлений, хранимых процедур и т. д.


![Добавление подключения к базе данных "Борей" сервер базы данных](creating-a-data-access-layer-vb/_static/image4.png)

**Рис. 2**: Добавление подключения к базе данных "Борей" сервер базы данных


## <a name="step-2-creating-the-data-access-layer"></a>Шаг 2. Создание уровня доступа к данным

При работе с данным один из вариантов — для внедрения логики конкретных данных непосредственно в слой представления (в веб-приложения образуют уровень представления страниц ASP.NET). Это может занять виде написания кода ADO.NET в части кода страницы ASP.NET или с помощью элемента управления SqlDataSource из части, содержащей разметку. В любом случае этот подход жестко связывает логику доступа к данным со слоем представления. Тем не менее, рекомендуется разделить логику доступа к данным от слоя представления. Этот отдельный слой называется уровня доступа к данным, коротко DAL и обычно реализуется в виде отдельного проекта библиотеки классов. Преимущества этой многоуровневой архитектуры хорошо документированы (см. в разделе «Дополнительные материалы» в конце этого руководства, сведения об этих преимуществах) и именно этот подход, который будет использоваться в этой серии.

Весь код, характерное для базового источника данных, например, создание подключения к базе данных, выполнив `SELECT`, `INSERT`, `UPDATE`, и `DELETE` команды и т. д. должны быть расположены в слое DAL. Уровень представления данных не должен содержать все ссылки на такой код доступа к данным, но вместо этого следует выполнять вызовы к слою DAL запросов для всех данных. Уровни доступа к данным обычно содержат методы для доступа к нижележащей базы данных. Базы данных Northwind, например, имеет `Products` и `Categories` которых регистрируются продукты для продажи и категории, к которым они относятся. В наш слой DAL войдут такие методы, такие как:

- `GetCategories(),` который возвращает сведения обо всех категорий
- `GetProducts()`, который возвращает сведения обо всех продуктов
- `GetProductsByCategoryID(categoryID)`, возвращающий все продукты, принадлежащие к указанной категории
- `GetProductByProductID(productID)`, который возвращает сведения об определенном продукте

При вызове этих методов будет подключиться к базе данных, выдают соотвтетствующий запрос и возвращают результаты. Важно, способ возврата этих результатов. Эти методы могут просто вернуть DataSet или DataReader, заполненный посредством запроса к базе данных, но в идеале эти результаты следует возвращать посредством *строго типизированных объектов*. Строго типизированный объект является одним, схема которого жестко определяется во время компиляции, а обратное, нестрого типизированного объекта, — один, схема которого известен только во время выполнения.

Например DataReader и DataSet (по умолчанию) являются слабо типизированных объектов, поскольку их схема определяется столбцов, возвращаемых запросом к базе данных, используемый для заполнения их. Для доступа к определенному столбцу из слабо типизированный объект DataTable, нам нужно использовать синтаксис, как: `DataTable.Rows(index)("columnName")`. В этом примере нестрогая типизация объекта DataTable проявляется тот факт, что нам нужно получить доступ к имени столбца, с помощью строки или порядкового индекса. Строго типизированный объект DataTable, с другой стороны, будут иметь все его столбцы реализованы в виде свойств, приводит к коду, который выглядит следующим образом: `DataTable.Rows(index).columnName`.

Для возвращения строго типизированных объектов, разработчики могут создавать собственные настраиваемые бизнес-объекты или использовать типизированные наборы DataSet. Бизнес-объект реализуется разработчиком, как класс, свойства которого, как правило, отражают столбцы базовой таблицы базы данных бизнес-объект представляет. Типизированный набор DataSet представляет собой класс, созданный Visual Studio, на основе схемы базы данных и члены которого являются строго типизированными в соответствии с этой схемы. Сам типизированный набор DataSet состоит из классов, расширяющих классы ADO.NET DataSet, DataTable и DataRow. В дополнение к строго типизированных таблиц DataTable типизированных наборов DataSet теперь относятся также адаптеры TableAdapter, являющиеся классами, методами для заполнения набора данных DataTables и внесения изменений, сделанных в объектах DataTable в базе данных.

> [!NOTE]
> Дополнительные сведения о преимуществах и недостатках использования типизированных наборов DataSet и пользовательских бизнес-объектов см. [проектирование компонентов слоев данных и передачи данных через уровни](https://msdn.microsoft.com/library/ms978496.aspx).


Мы будем использовать строго типизированных наборов DataSet для архитектуры предусмотренной данными учебными курсами. Рис. 3 показан рабочий процесс между разными слоями приложения, использующего типизированные наборы DataSet.


[![ALl, код доступа к данным, ограничены DAL](creating-a-data-access-layer-vb/_static/image6.png)](creating-a-data-access-layer-vb/_static/image5.png)

**Рис. 3**: Все код доступа к данным, ограничены DAL ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image7.png))


## <a name="creating-a-typed-dataset-and-table-adapter"></a>Создание типизированного набора данных и адаптера таблицы

Чтобы начать создание DAL, начнем с добавления типизированный набор DataSet в свой проект. Для этого щелкните правой кнопкой мыши узел проекта в обозревателе решений и выберите команду Добавить новый элемент. В списке шаблонов выберите DataSet и назовите его `Northwind.xsd`.


[![CВыберите, чтобы добавить новый набор данных в проект](creating-a-data-access-layer-vb/_static/image9.png)](creating-a-data-access-layer-vb/_static/image8.png)

**Рис. 4**: Выберите Добавить новый набор данных в проект ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image10.png))


После нажатия кнопки Добавить, когда будет предложено добавить набор данных `App_Code` папку, выберите "Да". После этого отображается конструктор для типизированного набора DataSet и запускается мастер настройки TableAdapter, дает возможность добавить первый адаптер TableAdapter к типизированному DataSet.

Типизированный набор DataSet выступает в качестве строго типизированной коллекции данных. он состоит из строго типизированных экземпляров таблицы DataTable, в свою очередь каждый из которых состоит из строго типизированных экземпляров строки DataRow. Мы создадим строго типизированного DataTable для каждого из базовых таблиц базы данных, которые мы должны работать с в этой серии учебных курсов. Начнем с создания таблицы DataTable для `Products` таблицы.

Имейте в виду, что строго типизированных таблиц DataTable не содержат все сведения о том, как получить доступ к данным из их базовой таблицы базы данных. Для извлечения данных для заполнения таблицы DataTable используется класс TableAdapter, который функционирует как наш уровень доступа к данным. Для наших `Products` DataTable, TableAdapter будет содержать методы `GetProducts()`, `GetProductByCategoryID(categoryID)`, и так далее, мы также вызовем от слоя представления. Роль таблицы DataTable является служат в качестве строго типизированных объектов, используемый для передачи данных между уровнями.

Мастер настройки TableAdapter начинает, предлагающее выбрать базу данных для работы с. Выберите в раскрывающемся списке отображаются предлагаемые базы данных в обозревателе серверов. Если базы данных Northwind не был добавлен в проводник по серверам, можно нажмите кнопку Создать подключение в данный момент для этого.


[![CВыберите базы данных Northwind из раскрывающегося списка](creating-a-data-access-layer-vb/_static/image12.png)](creating-a-data-access-layer-vb/_static/image11.png)

**Рис. 5**: Выберите базу данных "Борей" в раскрывающемся списке ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image13.png))


После выбора базы данных и нажмите кнопку Далее, появляется необходимость сохранить строку подключения в `Web.config` файл. Путем сохранения строки подключения позволяет избежать внесения ее жестких закодированных классов TableAdapter, что упрощает ситуацию, если строку подключения в будущем изменится. Если принято решение сохранить строку подключения в файле конфигурации будет располагаться в `<connectionStrings>` раздела, в котором может быть [при необходимости зашифрованных](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) целью повышения безопасности или последующего изменения посредством новой страницы свойств ASP.NET 2.0 в Средства администрирования IIS графического пользовательского интерфейса, более идеально подходит для администраторов.


[![SСохранить строку подключения в файл Web.config](creating-a-data-access-layer-vb/_static/image15.png)](creating-a-data-access-layer-vb/_static/image14.png)

**Рис. 6**: Сохранение подключения в `Web.config` ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image16.png))


Далее нам нужно определить схему для первой строго типизированного DataTable и предоставить первый метод для нашего адаптера TableAdapter для использования при заполнении набора данных со строгой типизацией. Эти два этапа завершаются одновременно путем создания запроса, возвращающего столбцы из таблицы, которые требуется отразить в нашем объекте DataTable. В конце работы мастера мы предоставим имя метода для этого запроса. После, завершены, этот метод может вызываться из слоя представления. Этот метод будет выполнить определенный запрос и заполнять строго типизированный объект DataTable.

Чтобы приступить к определению запроса SQL, сначала необходимо указать способ TableAdapter будет выдавать запрос. Можно использовать специальный оператор SQL, создайте новую хранимую процедуру или использовать существующую хранимую процедуру. В этих учебниках мы будем использовать специализированные инструкции SQL. Ссылаться на [Брайан Нойс](http://briannoyes.net/)статье Вэнса [создавать слой доступа к данным с помощью конструктора набора данных Visual Studio 2005](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) пример использования хранимых процедур.


[![Qзапрос данных с помощью инструкции SQL Ad-Hoc](creating-a-data-access-layer-vb/_static/image18.png)](creating-a-data-access-layer-vb/_static/image17.png)

**Рис. 7**: Запрос данных с помощью инструкции SQL Ad-Hoc ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image19.png))


На этом этапе можно ввести запрос SQL вручную. При создании первого метода в адаптере TableAdapter обычно требуется, чтобы запрос будет возвращать те столбцы, которые необходимо воспроизвести в соответствующем объекте DataTable. Это можно сделать, создав запрос, возвращающий все столбцы и строки из `Products` таблицы:


[![EЦентральный SQL запрос в текстовое поле](creating-a-data-access-layer-vb/_static/image21.png)](creating-a-data-access-layer-vb/_static/image20.png)

**Рис. 8**: Введите SQL запрос в текстовое поле ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image22.png))


В качестве альтернативы построителя запросов и конструирования запроса, графически, как показано на рис. 9.


[![CЗапрос графически посредством редактора запросов reate](creating-a-data-access-layer-vb/_static/image24.png)](creating-a-data-access-layer-vb/_static/image23.png)

**Рис. 9**: Создайте запрос графически посредством редактора запросов ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image25.png))


После создания запроса, но прежде чем переходить к следующему экрану нажмите кнопку "Дополнительно" ". В проектах веб-узла «Generate Insert, Update и Delete операторы» является единственным дополнительный параметр выбран по умолчанию; Если запустить этот мастер из библиотеки классов или проекта Windows будет также выбран параметр «Использовать оптимистичный параллелизм». Не устанавливайте параметр «Использовать оптимистичный параллелизм» флажок сейчас. Оптимистичный параллелизм будет изучаться в последующих учебных курсах.


[![Sвыберете только создать Insert, Update и Delete инструкции параметр](creating-a-data-access-layer-vb/_static/image27.png)](creating-a-data-access-layer-vb/_static/image26.png)

**Рис. 10**: Только создать Insert, Update и Delete инструкции SELECT параметр ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image28.png))


Проверив Дополнительные параметры, нажмите кнопку Далее, чтобы перейти к заключительному экрану. Здесь мы предлагается выбрать методы, добавляемые к TableAdapter. Существует два варианта внесения данных:

- **Заполнение DataTable** при таком подходе создается метод, принимающий DataTable в качестве параметра и заполняющий его на основе результатов запроса. Класс DataAdapter в среде ADO.NET, например, реализует этот шаблон с помощью его `Fill()` метод.
- **Возвращение DataTable** при таком подходе метод создает и заполняет DataTable и возвращает его в качестве возвращаемого значения метода.

Вы можете реализовывать один или оба этих варианта TableAdapter. Можно также переименовать приведенные здесь методы. Оставим установленными оба флажка, несмотря на то, что мы будем только использовать второй вариант данных учебных курсах. Кроме того, переименуем довольно общий метод `GetData` метод `GetProducts`.

Если этот флажок установлен, последний флажок «GenerateDBDirectMethods», создает `Insert()`, `Update()`, и `Delete()` методы адаптера таблицы. Если этот флажок не установлен, все обновления необходимо будет сделать с помощью единственной TableAdapter `Update()` метод, который принимает типизированный набор DataSet, DataTable, один DataRow или массив из DataRow. (Если вы уже снят флажок «Generate Insert, Update и Delete операторы» параметр из числа дополнительных свойств, на рис. 9, этот флажок параметра не окажет никакого воздействия.) Оставим этот флажок установленным.


[![Cизменить имя метода GetData на GetProducts](creating-a-data-access-layer-vb/_static/image30.png)](creating-a-data-access-layer-vb/_static/image29.png)

**Рис. 11**: Измените имя метода из `GetData` для `GetProducts` ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image31.png))


Следуйте указаниям мастера, нажмите кнопку Finish. После закрытия мастера мы возвращаемся в конструктор DataSet, указывающие DataTable, что мы только что создали. Можно просмотреть список столбцов в `Products` DataTable (`ProductID`, `ProductName`, и так далее), а также методы `ProductsTableAdapter` (`Fill()` и `GetProducts()`).


[![Tон Products DataTable и ProductsTableAdapter были добавлены к типизированному DataSet](creating-a-data-access-layer-vb/_static/image33.png)](creating-a-data-access-layer-vb/_static/image32.png)

**Рис. 12**: `Products` DataTable и `ProductsTableAdapter` были добавлены к типизированному DataSet ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image34.png))


На этом этапе у нас есть типизированный DataSet с единственным объектом DataTable (`Northwind.Products`) и строго типизированный класс DataAdapter (`NorthwindTableAdapters.ProductsTableAdapter`) с `GetProducts()` метод. Эти объекты могут использоваться для доступа к списку всех продуктов из кода следующего вида:

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample1.vb)]

Этот код не требует от нас написания ни одного бита кода, характерного для доступа к данным. Нам не пришлось создавать экземпляры любого классов ADO.NET, мы не требуется сослаться на любые строки подключения SQL-запросы или хранимые процедуры. Вместо этого код доступа к данным на нижнем уровне обеспечивается классом TableAdapter для нас.

Каждый объект, используемый в этом примере также является строго типизированным, что позволяет Visual Studio предоставить функцию IntelliSense и проверку типов во время компиляции. И лучше всего все объекты DataTable, возвращаемые TableAdapter, которые могут быть привязаны к данным ASP.NET веб-элементов управления GridView, DetailsView, DropDownList, CheckBoxList и несколько других. В следующем примере показано привязки таблицы DataTable, возвращенный `GetProducts()` к GridView в всего лишь трех строк кода в `Page_Load` обработчик событий.

AllProducts.aspx

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample2.aspx)]

AllProducts.aspx.vb

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample3.vb)]


[![Tон список продуктов отображается в элементе управления GridView](creating-a-data-access-layer-vb/_static/image36.png)](creating-a-data-access-layer-vb/_static/image35.png)

**Рис. 13**: Список продуктов, отображаемый в элементе управления GridView ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image37.png))


Хотя в этом примере потребовалось написать три строки кода в странице ASP.NET `Page_Load` обработчик событий, в будущих учебных курсах мы изучим способ использования ObjectDataSource для декларативного извлечения данных из слоя DAL. С помощью ObjectDataSource не придется писать код и получите поддержку разбиения по страницам и сортировки!

## <a name="step-3-adding-parameterized-methods-to-the-data-access-layer"></a>Шаг 3. Добавление параметризованных методов к слою доступа данных к

На этом этапе наши `ProductsTableAdapter` обладает всего лишь один метод `GetProducts()`, который возвращает все продукты в базе данных. Хотя возможность работы со всеми продуктами является безусловно, полезной, бывают случаи, когда нам требуется получить сведения о конкретном продукте или все продукты, принадлежащие к определенной категории. Добавление таких функций к слою доступа данных можно добавить в TableAdapter параметризованные методы.

Давайте добавим `GetProductsByCategoryID(categoryID)` метод. Для добавления нового метода к слою DAL вернитесь в конструктор DataSet, щелкните правой кнопкой мыши в `ProductsTableAdapter` раздела и выберите Добавить запрос.


![Щелкните правой кнопкой мыши TableAdapter и выберите Добавить запрос](creating-a-data-access-layer-vb/_static/image38.png)

**Рис. 14**: Щелкните правой кнопкой мыши TableAdapter и выберите Добавить запрос


Мы сначала появляется запрос о способе доступа к базе данных с помощью специального оператора SQL или новой или существующей хранимой процедуры. Выберите для использования инструкции SQL ad-hoc еще раз. Затем запрашивается тип запроса SQL, мы бы хотели использовать. Поскольку нам требуется возвратить все продукты, принадлежащие к указанной категории, нам потребуется написать `SELECT` возвращающий строки.


[![CВыберите для создания ВЫБЕРИТЕ оператор которого возвращает строки](creating-a-data-access-layer-vb/_static/image40.png)](creating-a-data-access-layer-vb/_static/image39.png)

**Рис. 15**: Решили создать `SELECT` инструкции которого возвращает строки ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image41.png))


Следующим шагом является определение SQL-запрос, используемый для доступа к данным. Поскольку нам требуется возвратить только те продукты, которые принадлежат определенной категории, используйте тот же `SELECT` инструкции от `GetProducts()`, но добавьте следующий `WHERE` предложение: `WHERE CategoryID = @CategoryID`. `@CategoryID` Параметр указывает мастеру TableAdapter сообщается, что мы создаем метод будет требуется входной параметр соответствующего типа (а именно неотрицательного целого).


[![EВведите запрос, чтобы только возвращать продукты в категории указан](creating-a-data-access-layer-vb/_static/image43.png)](creating-a-data-access-layer-vb/_static/image42.png)

**Рис. 16**: Введите запрос только возвращает продукты в категории указано ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image44.png))


На заключительном этапе можно выбрать которой шаблоны использования, а также настроить имена создаваемых методов доступа к данным. Для шаблона Fill изменим имя на `FillByCategoryID` и для возврата шаблона возврата объекта DataTable ( `GetX` методы), мы используем `GetProductsByCategoryID`.


[![CВыберите имена для методов класса TableAdapter](creating-a-data-access-layer-vb/_static/image46.png)](creating-a-data-access-layer-vb/_static/image45.png)

**Рис. 17**: Выберите имена для методов класса TableAdapter ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image47.png))


По завершении работы мастера конструктор DataSet входят новые методы TableAdapter.


![Теперь продукты можно запрашивать по категории](creating-a-data-access-layer-vb/_static/image48.png)

**Рис. 18**: Теперь продукты можно запрашивать по категории


Отвлекитесь и добавьте `GetProductByProductID(productID)` метод, используя ту же методику.

Эти параметризованные запросы можно протестировать непосредственно из конструктора DataSet. Щелкните правой кнопкой мыши метод в TableAdapter и выберите данные для предварительного просмотра. Затем введите значения для параметров и нажмите кнопку предварительного просмотра.


[![TОтображаются те продукты, принадлежащие к категории «Напитки»](creating-a-data-access-layer-vb/_static/image50.png)](creating-a-data-access-layer-vb/_static/image49.png)

**Рис. 19**: Показаны эти продукты, принадлежащие к категории «Напитки» ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image51.png))


С помощью `GetProductsByCategoryID(categoryID)` метода в DAL, теперь можно создать страницу ASP.NET, отображающую только продукты указанной категории. В следующем примере показано все продукты, которые находятся в категории «Напитки», которые имеют `CategoryID` 1.

Beverages.aspx

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample4.aspx)]

Beverages.aspx.vb

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample5.vb)]


[![TЭти продукты в категории «Напитки» отображаются](creating-a-data-access-layer-vb/_static/image53.png)](creating-a-data-access-layer-vb/_static/image52.png)

**Рис. 20**: Эти продукты из категории «Напитки» отображаются ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image54.png))


## <a name="step-4-inserting-updating-and-deleting-data"></a>Шаг 4. Вставка, обновление и удаление данных

Существует два метода, обычно используется для вставки, обновления и удаления данных. Первая схема, которую я называю непосредственной схемы базы данных, включает в себя создание методов, которые при вызове проблема `INSERT`, `UPDATE`, или `DELETE` команду к базе данных, работающий с единственной записью базы данных. Такие методы обычно передается последовательность скалярных значений (целые числа, строки, логические значения, значений даты и времени и т. д.), которые соответствуют значения для вставки, обновления или удаления. Например, с помощью этого шаблона для `Products` метод удаления принимает целый параметр, таблицы, указывающее, `ProductID` записи для удаления, хотя метод вставки принимает строку для `ProductName`, десятичное значение для `UnitPrice`, целое число для `UnitsOnStock`, и т. д.


[![Eдля базы данных немедленно отправляется ACH Insert, Update и запрос на удаление](creating-a-data-access-layer-vb/_static/image56.png)](creating-a-data-access-layer-vb/_static/image55.png)

**Рис. 21**: Для базы данных немедленно отправляется каждый Insert, Update и запрос на удаление ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image57.png))


Другая схема, которую я буду называть шаблон пакетного обновления, является обновление всей DataSet, DataTable или коллекции из DataRow в один вызов метода. В этом шаблоне разработчик удаляет, операции вставки и изменение объектов DataRow в DataTable и затем передает эти DataRow или DataTable в метод обновления. Затем этот метод перечисляет переданные DataRow, определяет ли они были изменены, добавленных или удаленных (с помощью объекта DataRow [свойства RowState](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) значение) и отправляет запрос к соответствующей базе данных для каждой записи.


[![Aвсе изменения синхронизируются с базы данных при метод Update вызывается](creating-a-data-access-layer-vb/_static/image59.png)](creating-a-data-access-layer-vb/_static/image58.png)

**Рис. 22**: Все изменения синхронизируются с базой данных, когда вызывается метод Update ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image60.png))


TableAdapter используется схема пакетного обновления по умолчанию, но также поддерживает непосредственной схемы базы данных. Так как мы выбрали вариант «Generate Insert, Update и Delete операторы» в дополнительных свойствах, при создании TableAdapter, `ProductsTableAdapter` содержит `Update()` , реализующий схему пакетного обновления. В частности, TableAdapter содержит `Update()` метод, который может быть передан типизированному набору DataSet, строго типизированный объект DataTable или один или несколько строк DataRow. Если флажок установлен флажок «GenerateDBDirectMethods», при первоначальном создании TableAdapter непосредственной схемы базы данных также будет реализована через `Insert()`, `Update()`, и `Delete()` методы.

Обе схемы изменения данных используют свойства `InsertCommand`, `UpdateCommand`, и `DeleteCommand` TableAdapter для обращения к их `INSERT`, `UPDATE`, и `DELETE` команды в базу данных. Можно проверять и изменять `InsertCommand`, `UpdateCommand`, и `DeleteCommand` свойства, щелкните TableAdapter в конструкторе наборов данных и затем перейдите в окно свойств. (Убедитесь, что выбран TableAdapter и что `ProductsTableAdapter` объект является выбранный в раскрывающемся списке в окне «Свойства».)


[![TTableAdapter ему InsertCommand, UpdateCommand и свойства DeleteCommand](creating-a-data-access-layer-vb/_static/image62.png)](creating-a-data-access-layer-vb/_static/image61.png)

**Рис. 23**: TableAdapter имеет `InsertCommand`, `UpdateCommand`, и `DeleteCommand` свойства ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image63.png))


Чтобы просмотреть или изменить любые из этих свойств команды базы данных, щелкните `CommandText` подсвойств, чтобы открыть построитель запросов.


[![Cастройка вставки, обновления и удаления инструкций в построителе запросов](creating-a-data-access-layer-vb/_static/image65.png)](creating-a-data-access-layer-vb/_static/image64.png)

**Рис. 24**: Настройка `INSERT`, `UPDATE`, и `DELETE` операторы в построителе запросов ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image66.png))


В следующем примере кода показано, как использовать схему пакетного обновления выполнить удвоение цены всех продуктов, являются не снятых с производства 25 единиц на складе не превышает:

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample6.vb)]

В приведенном ниже коде показано, как использовать непосредственной схемы базы данных программным способом удалить конкретный продукт, а затем обновить один, а затем добавьте новую:

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample7.vb)]

## <a name="creating-custom-insert-update-and-delete-methods"></a>Создание пользовательских вставки, обновления и удаления методов

`Insert()`, `Update()`, И `Delete()` , созданные непосредственным методом базы данных может оказаться несколько громоздкими, особенно для таблиц с большим числом столбцов. Просмотрев в предыдущем примере кода без функции IntelliSense помогают неясно, особенно что `Products` сопоставляет каждый входной параметр, чтобы `Update()` и `Insert()` методы. Возможны случаи, когда требуется только обновить один или два столбца или требуется настраиваемый метод `Insert()` метод, который будет, возможно, возвращают значение вновь вставленной записи `IDENTITY` поле (с автоматическим приращением).

Для создания такого настраиваемого метода, вернитесь в конструктор набора данных. Щелкните правой кнопкой мыши TableAdapter и выберите Добавить запрос, возврат к мастеру TableAdapter. На втором экране указывается тип создаваемого запроса. Давайте создадим метод, который добавляется новый продукт, а затем возвращает значение вновь добавленной записи `ProductID`. Поэтому выберем создание `INSERT` запроса.


[![Cсоздать метод для добавления создать строку к таблице Products](creating-a-data-access-layer-vb/_static/image68.png)](creating-a-data-access-layer-vb/_static/image67.png)

**Рис. 25**: Создайте метод для добавления строки New `Products` таблицы ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image69.png))


На следующем экране `InsertCommand`в `CommandText` отображается. Нарастим этот запрос, добавив `SELECT SCOPE_IDENTITY()` в конце запроса, который возвращает последнее значение identity, вставленное в `IDENTITY` столбец в той же области. (См. в разделе [технической документации](https://msdn.microsoft.com/library/ms190315.aspx) Дополнительные сведения о `SCOPE_IDENTITY()` и почему может потребоваться [использовать область\_IDENTITY() вместо @@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Убедитесь, что `INSERT` инструкция точкой с запятой перед добавлением `SELECT` инструкции.


[![Augment запрос может вернуть значение SCOPE_IDENTITY()](creating-a-data-access-layer-vb/_static/image71.png)](creating-a-data-access-layer-vb/_static/image70.png)

**Рис. 26**: Расширение запроса для возврата `SCOPE_IDENTITY()` значение ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image72.png))


Наконец, назовите новый метод `InsertProduct`.


[![SET имя метода для InsertProduct](creating-a-data-access-layer-vb/_static/image74.png)](creating-a-data-access-layer-vb/_static/image73.png)

**Рис. 27**: Задайте имя нового метода `InsertProduct` ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image75.png))


При возвращении в конструктор DataSet будет видно, что `ProductsTableAdapter` содержит новый метод `InsertProduct`. Если этого нового метода нет параметра для каждого столбца в `Products` вполне вероятно, что вы забыли завершить оператор `INSERT` инструкция точкой с запятой. Настройка `InsertProduct` метод и убедитесь в наличии операторы `INSERT` и `SELECT` инструкций.

По умолчанию вставьте методы без запросов методы проблему, т.е. они возвращают число затронутых строк. Тем не менее, мы хотим `InsertProduct` метод для возврата значения, возвращаемые запросом, не число обработанных строк. Для этого необходимо настроить `InsertProduct` метода `ExecuteMode` свойства `Scalar`.


[![Cизменить свойство ExecuteMode скалярных](creating-a-data-access-layer-vb/_static/image77.png)](creating-a-data-access-layer-vb/_static/image76.png)

**Рис. 28**: Изменение `ExecuteMode` свойства `Scalar` ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image78.png))


В следующем коде показан этот новый `InsertProduct` метод в действии:

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample8.vb)]

## <a name="step-5-completing-the-data-access-layer"></a>Шаг 5. Завершение работы на уровне доступа к данным

Обратите внимание, что `ProductsTableAdapters` возвращает `CategoryID` и `SupplierID` значения из `Products` таблицы, но не включает в себя `CategoryName` столбец из `Categories` таблицы или `CompanyName` столбец из `Suppliers` Таблица, несмотря на то, что скорее всего, это те столбцы необходимо отобразить при выводе информации о продукте. Мы можем расширить исходный метод TableAdapter, `GetProducts()`, обоих `CategoryName` и `CompanyName` значения столбцов, что приведет к обновлению строго типизированного DataTable для включения этих новых столбцов.

Это может оказаться сложной, однако как методов класса TableAdapter для вставки, обновления, и основаны на удаление данных этого исходного метода. К счастью, создаваемые автоматически методы для вставки, обновления и удаления не оказывают влияния вложенные запросы в `SELECT` предложение. При этом не забудьте добавить наши запросы к `Categories` и `Suppliers` как подзапросы, а не `JOIN` s, мы избавимся от необходимости переделывать эти методы для изменения данных. Щелкните правой кнопкой мыши `GetProducts()` метод в `ProductsTableAdapter` и выберите команду Настройка. Затем Организуйте оператор `SELECT` предложение, таким образом, например:

[!code-sql[Main](creating-a-data-access-layer-vb/samples/sample9.sql)]


[![Uбновить инструкцию SELECT для метода GetProducts()](creating-a-data-access-layer-vb/_static/image80.png)](creating-a-data-access-layer-vb/_static/image79.png)

**Рис. 29**: Обновление `SELECT` инструкции для `GetProducts()` метод ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image81.png))


После обновления `GetProducts()` метод для использования этого нового запроса объект DataTable будет включать два новых столбца: `CategoryName` и `SupplierName`.


![Products DataTable содержит два новых столбца](creating-a-data-access-layer-vb/_static/image82.png)

**Рис. 30**: `Products` DataTable содержит два новых столбца


Отвлекитесь и обновить `SELECT` предложение в `GetProductsByCategoryID(categoryID)` также метод.

Если вы обновляете `GetProducts()` `SELECT` с помощью `JOIN` конструктор DataSet будет невозможно автоматическое создание методов для вставки, обновления и удаления данных базы данных, с помощью базы данных направить шаблон. Вместо этого необходимо создать их вручную во многом как это делалось с `InsertProduct` метод ранее в этом учебнике. Кроме того, вы будете вручную должны предоставить `InsertCommand`, `UpdateCommand`, и `DeleteCommand` значения свойств, если вы хотите использовать схему пакетного обновления.

## <a name="adding-the-remaining-tableadapters"></a>Добавление оставшихся TableAdapter

До сих пор мы рассмотрел лишь работа с одним адаптером TableAdapter для одной таблицы базы данных. Тем не менее в базе данных "Борей" содержит несколько связанных таблиц, которые потребуются для работы с нашего веб-приложения. Типизированный набор DataSet может содержать несколько связанных таблиц DataTable. Следовательно для завершения создания слоя DAL необходимо добавить объекты DataTable других таблиц, которые мы будем использовать в этих учебниках. К добавлению нового TableAdapter к типизированному набору DataSet, откройте конструктор DataSet, щелкните правой кнопкой мыши в конструкторе и выберите команду Добавить / TableAdapter. Это создаст новые DataTable и TableAdapter и пошаговыми руководствами для мастера, мы рассмотрели ранее в этом учебнике.

Занять несколько минут на создание следующих адаптеров TableAdapter и методов с помощью следующих запросов. Обратите внимание, что запросы в `ProductsTableAdapter` содержать вложенных запросов, чтобы скопировать имена категорию и поставщика каждого продукта. Кроме того, если вы выполняли все, вы уже добавили `ProductsTableAdapter` класса `GetProducts()` и `GetProductsByCategoryID(categoryID)` методы.

- **ProductsTableAdapter**

  - **GetProducts**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample10.sql)]
  - **Метода GetProductsByCategoryID**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample11.sql)]
  - **Метода GetProductsBySupplierID**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample12.sql)]
  - **GetProductByProductID**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample13.sql)]
- **CategoriesTableAdapter**

  - **GetCategories**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample14.sql)]
  - **Метод GetCategoryByCategoryID**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample15.sql)]
- **SuppliersTableAdapter**

  - **GetSuppliers**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample16.sql)]
  - **GetSuppliersByCountry**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample17.sql)]
  - **GetSupplierBySupplierID**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample18.sql)]
- **EmployeesTableAdapter**

  - **GetEmployees**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample19.sql)]
  - **GetEmployeesByManager**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample20.sql)]
  - **GetEmployeeByEmployeeID**: 

      [!code-sql[Main](creating-a-data-access-layer-vb/samples/sample21.sql)]


[![Tон набора данных конструктор после четырех адаптеров таблиц были добавлены](creating-a-data-access-layer-vb/_static/image84.png)](creating-a-data-access-layer-vb/_static/image83.png)

**Рис. 31**: Набор данных конструктор после четырех адаптеров таблиц были добавлены ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image85.png))


## <a name="adding-custom-code-to-the-dal"></a>Добавление пользовательского кода в слой DAL

TableAdapter и DataTable, добавленные к типизированному набору DataSet выражаются в виде файла определения схемы XML (`Northwind.xsd`). Эти данные схемы можно просмотреть, щелкнув правой кнопкой мыши `Northwind.xsd` в обозревателе решений и выбрав представление кода.


[![Tон файл определения схемы XML (XSD) для типизированного набора DataSet типизированного](creating-a-data-access-layer-vb/_static/image87.png)](creating-a-data-access-layer-vb/_static/image86.png)

**Рис. 32**: Файл определения схемы XML (XSD) для типизированного типизированный набор DataSet ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image88.png))


Эти данные схемы преобразуются в код C# или Visual Basic во время разработки при компиляции или во время выполнения (при необходимости), после чего можно пошагово выполнить его с помощью отладчика. Чтобы просмотреть этот автоматически созданный код перейдите представления классов и углубитесь для классов TableAdapter или типизированного DataSet. Если вы не видите представление классов на экране, перейдите к меню "Вид" и выберите его оттуда или нажмите сочетание клавиш Ctrl + Shift + C. Из представления классов, вы увидите, свойства, методы и события классов типизированного набора DataSet и адаптера таблицы. Для просмотра кода конкретного метода дважды щелкните имя метода в окне просмотра классов или его правой кнопкой мыши и выберите Go To Definition.


![Проверьте автоматически созданный код, выбрав перейти к определению представления классов](creating-a-data-access-layer-vb/_static/image89.png)

**Рис. 33**: Проверьте автоматически созданный код, выбрав перейти к определению представления классов


Автоматически созданный код может быть экономит время, код зачастую имеет слишком общий и необходимо выполнить настройку в соответствии с потребностями приложения. Риск расширения автоматически созданный код, состоит в том, что средства, сгенерировавшего код может решить, что пришло время повторно «создать» и перезаписать сделанные настройки. С помощью .NET 2.0 концепция частичных классов можно легко разделить класс по нескольким файлам. Это позволяет добавлять собственные методы, свойства и события к автоматически созданным классам не нужно беспокоиться о перезаписи сделанных настроек Visual Studio.

Демонстрация настройки слоя DAL добавим `GetProducts()` метод `SuppliersRow` класса. `SuppliersRow` Класс представляет одну запись в `Suppliers` таблицы; каждый поставщик может ноль для многих продуктов, поэтому `GetProducts()` возвращает все продукты указанного поставщика. Чтобы выполнить это создать новый файл класса в `App_Code` папку с именем `SuppliersRow.vb` и добавьте следующий код:

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample22.vb)]

Этот частичный класс указывает компилятору на необходимость что при создании `Northwind.SuppliersRow` класса для включения `GetProducts()` метод, мы только что определили. Если вы сборку проекта, а затем вернитесь в окно просмотра классов вы увидите `GetProducts()` теперь отображается как метод `Northwind.SuppliersRow`.


![Метод GetProducts() — теперь является частью класса Northwind.SuppliersRow](creating-a-data-access-layer-vb/_static/image90.png)

**Рис. 34**: `GetProducts()` Метод — теперь часть `Northwind.SuppliersRow` класса


`GetProducts()` Метод теперь может использоваться для перечисления набора продуктов конкретного поставщика, как показано в следующем коде:

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample23.vb)]

Эти данные также могут отображаться в любом из ASP. NET данные веб-элементов управления. На следующей странице используется элемент управления GridView с двумя полями:

- Поле BoundField отображает имена всех поставщиков и
- Поле TemplateField содержит элемент управления BulletedList, привязанный к результаты, возвращенные `GetProducts()` для каждого поставщика.

Будет рассмотрен способ отображения таких отчетов «основной-подробности» в последующих учебных курсах. Сейчас этот пример предназначен для иллюстрации использования пользовательского метода, добавленного к `Northwind.SuppliersRow` класса.

SuppliersAndProducts.aspx

[!code-aspx[Main](creating-a-data-access-layer-vb/samples/sample24.aspx)]

SuppliersAndProducts.aspx.vb

[!code-vb[Main](creating-a-data-access-layer-vb/samples/sample25.vb)]


[![TНазвание компании поставщика он указан в столбце слева, их продукты — в правом](creating-a-data-access-layer-vb/_static/image92.png)](creating-a-data-access-layer-vb/_static/image91.png)

**Рис. 35**: Название компании поставщика указан в столбце слева, их продукты — в правом ([Просмотр полноразмерного изображения](creating-a-data-access-layer-vb/_static/image93.png))


## <a name="summary"></a>Сводка

При создании веб-приложения Создание слоя DAL следует выполнять на один из первых этапов, до начала создания слоя представления. С помощью Visual Studio слой DAL на основе типизированных наборов данных — это задача, можно выполнить в 10 – 15 минут без написания кода. Руководства, в дальнейшем будут созданы на этот слой DAL. В [следующему руководству](creating-a-business-logic-layer-vb.md) мы определить ряд бизнес-правил и способы их реализации в отдельном уровне бизнес-логики см. в разделе.

Счастливого вам программирования!

## <a name="further-reading"></a>Дополнительные сведения

Дополнительные сведения по темам, обсуждавшимся в этом руководстве см. в следующих ресурсах:

- [Создание слоя DAL с использованием строго типизированных адаптеров TableAdapter и таблиц DataTable в среде VS 2005 и ASP.NET 2.0](https://weblogs.asp.net/scottgu/435498)
- [Проектирование компонентов слоев данных и передача данных через слои](https://msdn.microsoft.com/library/ms978496.aspx)
- [Создание уровня доступа к данным с помощью конструктора набора данных Visual Studio 2005](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner)
- [Шифрование данных конфигурации в ASP.NET 2.0 приложения](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)
- [Общие сведения об адаптере таблиц](https://msdn.microsoft.com/library/bz9tthwx.aspx)
- [Работа с типизированного набора данных](https://msdn.microsoft.com/library/esbykkzb.aspx)
- [С помощью доступа к данным со строгой типизацией в Visual Studio 2005 и ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/020806-1.aspx)
- [Как расширение методов TableAdapter](https://blogs.msdn.com/vbteam/archive/2005/05/04/ExtendingTableAdapters.aspx)
- [Извлечение скалярных данных из хранимой процедуры](http://aspnet.4guysfromrolla.com/articles/062905-1.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a>Учебные видеоматериалы по таким темам, содержащихся в этом руководстве

- [Уровни доступа к данным в приложениях ASP.NET](../../../videos/data-access/adonet-data-services/data-access-layers-in-aspnet-applications.md)
- [Как привязка Dataset вручную к Datagrid](../../../videos/data-access/adonet-data-services/how-to-manually-bind-a-dataset-to-a-datagrid.md)
- [Порядок работы с наборами данных и фильтрами из приложения ASP](../../../videos/data-access/adonet-data-services/how-to-work-with-datasets-and-filters-from-an-asp-application.md)

## <a name="about-the-author"></a>Об авторе

[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP.NET и основатель веб- [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Microsoft с 1998 года. Скотт — независимый консультант, преподаватель и автор. Его последняя книга — [ *Sams Teach ASP.NET 2.0 in 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco). Ним можно связаться по адресу [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) или через его блог, который можно найти в [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).

## <a name="special-thanks-to"></a>Особая благодарность

В этой серии руководств пособий рецензировалась многими компетентными редакторами. Стали Лиз Шалок в этом руководстве, Ron Green, (Hilton giesenow), Деннис Patterson, (Liz Shulok), Абель Gomez и Карлос Сантос. Хотите поработать с моих последующих статей для MSDN? Если Да, напишите мне [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)

> [!div class="step-by-step"]
> [Назад](master-pages-and-site-navigation-cs.md)
> [Вперед](creating-a-business-logic-layer-vb.md)
