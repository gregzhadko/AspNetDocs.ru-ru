---
uid: web-forms/overview/data-access/working-with-batched-data/batch-deleting-vb
title: Пакетное удаление (VB) | Документация Майкрософт
author: rick-anderson
description: Узнайте, как удалить несколько записей базы данных за одну операцию. На уровне пользовательского интерфейса сборка создается на основе расширенного элемента управления GridView, созданного в более ранней TUT...
ms.author: riande
ms.date: 06/26/2007
ms.assetid: 4fb72f75-32ab-4bf7-a764-be20367be726
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: 0974a16764eee2ef03cf36b4b15f9ef41f99982b
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74621652"
---
# <a name="batch-deleting-vb"></a><span data-ttu-id="b4cc2-104">Пакетное удаление (VB)</span><span class="sxs-lookup"><span data-stu-id="b4cc2-104">Batch Deleting (VB)</span></span>

<span data-ttu-id="b4cc2-105">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b4cc2-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b4cc2-106">[Скачать код](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_65_VB.zip) или [скачать PDF](batch-deleting-vb/_static/datatutorial65vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="b4cc2-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_65_VB.zip) or [Download PDF](batch-deleting-vb/_static/datatutorial65vb1.pdf)</span></span>

> <span data-ttu-id="b4cc2-107">Узнайте, как удалить несколько записей базы данных за одну операцию.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-107">Learn how to delete multiple database records in a single operation.</span></span> <span data-ttu-id="b4cc2-108">На уровне пользовательского интерфейса мы создаем Улучшенный элемент управления GridView, созданный в предыдущем руководстве.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-108">In the User Interface Layer we build upon an enhanced GridView created in an earlier tutorial.</span></span> <span data-ttu-id="b4cc2-109">На уровне доступа к данным мы переносите несколько операций удаления в рамках транзакции, чтобы гарантировать успешность всех удалений или отката всех удалений.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-109">In the Data Access Layer we wrap the multiple Delete operations within a transaction to ensure that all deletions succeed or all deletions are rolled back.</span></span>

## <a name="introduction"></a><span data-ttu-id="b4cc2-110">Введение</span><span class="sxs-lookup"><span data-stu-id="b4cc2-110">Introduction</span></span>

<span data-ttu-id="b4cc2-111">В [предыдущем учебнике](batch-updating-vb.md) было рассмотрено, как создать интерфейс редактирования пакетной службы с помощью полностью изменяемого GridView.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-111">The [preceding tutorial](batch-updating-vb.md) explored how to create a batch editing interface using a fully-editable GridView.</span></span> <span data-ttu-id="b4cc2-112">В ситуациях, когда пользователи часто редактируют много записей одновременно, интерфейсу редактирования пакетов потребуется гораздо меньше обратных передач и переключений контекста мыши, что повышает эффективность конечных пользователей.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-112">In situations where users are commonly editing many records at once, a batch editing interface will require far fewer postbacks and keyboard-to-mouse context switches, thereby improving the end user s efficiency.</span></span> <span data-ttu-id="b4cc2-113">Этот метод также полезен для страниц, где пользователи часто удаляют много записей за один переход.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-113">This technique is similarly useful for pages where it is common for users to delete many records in one go.</span></span>

<span data-ttu-id="b4cc2-114">Любой пользователь, который использовал Интернет-клиент электронной почты, уже знаком с одним из наиболее распространенных интерфейсов удаления пакетов: флажок в каждой строке сетки с соответствующей кнопкой Удалить все отмеченные элементы (см. рис. 1).</span><span class="sxs-lookup"><span data-stu-id="b4cc2-114">Anyone who has used an online email client is already familiar with one of the most common batch deleting interfaces: a checkbox in each row in a grid with a corresponding Delete All Checked Items button (see Figure 1).</span></span> <span data-ttu-id="b4cc2-115">Этот учебник довольно короткий, поскольку мы уже выполнили всю работу в предыдущих руководствах по созданию веб-интерфейса и метода удаления серии записей как единой атомарной операции.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-115">This tutorial is rather short because we ve already done all of the hard work in previous tutorials in creating both the web-based interface and a method to delete a series of records as a single atomic operation.</span></span> <span data-ttu-id="b4cc2-116">В руководстве по [добавлению в столбец GridView в учебнике "флажки"](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) мы создали элемент управления GridView со столбцом флажков и в рамках руководства по [транзакциям изменения базы данных](wrapping-database-modifications-within-a-transaction-vb.md) , которые мы создали в BLL метод, который использовал транзакцию для удаления `List<T>` `ProductID` значений.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-116">In the [Adding a GridView Column of Checkboxes](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) tutorial we created a GridView with a column of checkboxes and in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md) tutorial we created a method in the BLL that would use a transaction to delete a `List<T>` of `ProductID` values.</span></span> <span data-ttu-id="b4cc2-117">В этом учебнике мы выполним сборку и слияние предыдущих возможностей, чтобы создать пример рабочего удаления пакета.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-117">In this tutorial, we will build upon and merge our previous experiences to create a working batch deleting example.</span></span>

<span data-ttu-id="b4cc2-118">[![каждая строка содержит флажок](batch-deleting-vb/_static/image1.gif)](batch-deleting-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b4cc2-118">[![Each Row Includes a Checkbox](batch-deleting-vb/_static/image1.gif)](batch-deleting-vb/_static/image1.png)</span></span>

<span data-ttu-id="b4cc2-119">**Рис. 1**. Каждая строка содержит флажок ([щелкните, чтобы просмотреть изображение с полным размером](batch-deleting-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="b4cc2-119">**Figure 1**: Each Row Includes a Checkbox ([Click to view full-size image](batch-deleting-vb/_static/image2.png))</span></span>

## <a name="step-1-creating-the-batch-deleting-interface"></a><span data-ttu-id="b4cc2-120">Шаг 1. Создание пакетного удаления интерфейса</span><span class="sxs-lookup"><span data-stu-id="b4cc2-120">Step 1: Creating the Batch Deleting Interface</span></span>

<span data-ttu-id="b4cc2-121">Так как мы уже создали интерфейс удаления пакета в разделе [Добавление столбца GridView](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) в учебнике по флажкам, мы можем просто скопировать его в `BatchDelete.aspx`, а не создавать его с нуля.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-121">Since we already created the batch deleting interface in the [Adding a GridView Column of Checkboxes](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) tutorial, we can simply copy it to `BatchDelete.aspx` rather than creating it from scratch.</span></span> <span data-ttu-id="b4cc2-122">Для начала откройте страницу `BatchDelete.aspx` в папке `BatchData` и странице `CheckBoxField.aspx` в папке `EnhancedGridView`.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-122">Start by opening the `BatchDelete.aspx` page in the `BatchData` folder and the `CheckBoxField.aspx` page in the `EnhancedGridView` folder.</span></span> <span data-ttu-id="b4cc2-123">На странице `CheckBoxField.aspx` перейдите к представлению исходного кода и скопируйте разметку между тегами `<asp:Content>`, как показано на рис. 2.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-123">From the `CheckBoxField.aspx` page, go to the Source view and copy the markup between the `<asp:Content>` tags as shown in Figure 2.</span></span>

<span data-ttu-id="b4cc2-124">[![скопировать декларативную разметку CheckBoxField. aspx в буфер обмена](batch-deleting-vb/_static/image2.gif)](batch-deleting-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="b4cc2-124">[![Copy the Declarative Markup of CheckBoxField.aspx to the Clipboard](batch-deleting-vb/_static/image2.gif)](batch-deleting-vb/_static/image3.png)</span></span>

<span data-ttu-id="b4cc2-125">**Рис. 2**. копирование декларативной разметки `CheckBoxField.aspx` в буфер обмена ([щелкните, чтобы просмотреть изображение с полным размером](batch-deleting-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="b4cc2-125">**Figure 2**: Copy the Declarative Markup of `CheckBoxField.aspx` to the Clipboard ([Click to view full-size image](batch-deleting-vb/_static/image4.png))</span></span>

<span data-ttu-id="b4cc2-126">Затем перейдите в представление исходного кода в `BatchDelete.aspx` и вставьте содержимое буфера обмена в теги `<asp:Content>`.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-126">Next, go to the Source view in `BatchDelete.aspx` and paste the contents of the clipboard within the `<asp:Content>` tags.</span></span> <span data-ttu-id="b4cc2-127">Также скопируйте и вставьте код из класса кода программной части в `CheckBoxField.aspx.vb` в класс кода программной части в `BatchDelete.aspx.vb` (`DeleteSelectedProducts` Button s `Click` обработчик событий, метод `ToggleCheckState` и обработчики событий `Click` для кнопок `CheckAll` и `UncheckAll`).</span><span class="sxs-lookup"><span data-stu-id="b4cc2-127">Also copy and paste the code from within the code-behind class in `CheckBoxField.aspx.vb` to within the code-behind class in `BatchDelete.aspx.vb` (the `DeleteSelectedProducts` Button s `Click` event handler, the `ToggleCheckState` method, and the `Click` event handlers for the `CheckAll` and `UncheckAll` Buttons).</span></span> <span data-ttu-id="b4cc2-128">После копирования содержимого класс кода программной части `BatchDelete.aspx` страница s должен содержать следующий код:</span><span class="sxs-lookup"><span data-stu-id="b4cc2-128">After copying over this content, the `BatchDelete.aspx` page s code-behind class should contain the following code:</span></span>

[!code-vb[Main](batch-deleting-vb/samples/sample1.vb)]

<span data-ttu-id="b4cc2-129">После копирования декларативной разметки и исходного кода уделите несколько минут тестированию `BatchDelete.aspx`, просмотрев их в браузере.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-129">After copying over the declarative markup and source code, take a moment to test `BatchDelete.aspx` by viewing it through a browser.</span></span> <span data-ttu-id="b4cc2-130">Вы увидите элемент управления GridView со списком первых десяти продуктов в GridView с каждой строкой, содержащей название продукта, категорию и цену вместе с флажком.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-130">You should see a GridView listing the first ten products in a GridView with each row listing the product s name, category, and price along with a checkbox.</span></span> <span data-ttu-id="b4cc2-131">Должны быть три кнопки: проверить все, снять все и удалить выбранные продукты.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-131">There should be three buttons: Check All, Uncheck All, and Delete Selected Products.</span></span> <span data-ttu-id="b4cc2-132">При нажатии кнопки "проверить все" выбираются все флажки, а снимите все флажки.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-132">Clicking the Check All button selects all checkboxes, while Uncheck All clears all checkboxes.</span></span> <span data-ttu-id="b4cc2-133">При нажатии кнопки Удалить выбранные продукты отображается сообщение со списком `ProductID` значений выбранных продуктов, но на самом деле эти продукты не удаляются.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-133">Clicking Delete Selected Products displays a message that lists the `ProductID` values of the selected products, but does not actually delete the products.</span></span>

<span data-ttu-id="b4cc2-134">[![интерфейс из CheckBoxField. aspx был перемещен в Батчделетинг. aspx](batch-deleting-vb/_static/image3.gif)](batch-deleting-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="b4cc2-134">[![The Interface from CheckBoxField.aspx has been Moved to BatchDeleting.aspx](batch-deleting-vb/_static/image3.gif)](batch-deleting-vb/_static/image5.png)</span></span>

<span data-ttu-id="b4cc2-135">**Рис. 3**. интерфейс из `CheckBoxField.aspx` был перемещен в `BatchDeleting.aspx` ([щелкните, чтобы просмотреть изображение с полным размером](batch-deleting-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b4cc2-135">**Figure 3**: The Interface from `CheckBoxField.aspx` has been Moved to `BatchDeleting.aspx` ([Click to view full-size image](batch-deleting-vb/_static/image6.png))</span></span>

## <a name="step-2-deleting-the-checked-products-using-transactions"></a><span data-ttu-id="b4cc2-136">Шаг 2. Удаление проверенных продуктов с помощью транзакций</span><span class="sxs-lookup"><span data-stu-id="b4cc2-136">Step 2: Deleting the Checked Products Using Transactions</span></span>

<span data-ttu-id="b4cc2-137">Если пакет удаляется из пакета в `BatchDeleting.aspx`, остается только обновить код, чтобы кнопка Удалить выбранные продукты удалила проверенные продукты с помощью метода `DeleteProductsWithTransaction` в классе `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-137">With the batch deleting interface successfully copied over to `BatchDeleting.aspx`, all that remains is to update the code so that the Delete Selected Products button deletes the checked products using the `DeleteProductsWithTransaction` method in the `ProductsBLL` class.</span></span> <span data-ttu-id="b4cc2-138">Этот метод, добавленный в инструкции по [переносу изменений базы данных в рамках руководства по транзакциям](wrapping-database-modifications-within-a-transaction-vb.md) , принимает в качестве входных данных `List(Of T)` `ProductID` значений и удаляет все соответствующие `ProductID` в области транзакции.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-138">This method, added in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md) tutorial, accepts as its input a `List(Of T)` of `ProductID` values and deletes each corresponding `ProductID` within the scope of a transaction.</span></span>

<span data-ttu-id="b4cc2-139">`DeleteSelectedProducts` Button `Click` обработчик событий в настоящее время использует следующий цикл `For Each` для прохода по каждой строке GridView:</span><span class="sxs-lookup"><span data-stu-id="b4cc2-139">The `DeleteSelectedProducts` Button s `Click` event handler currently uses the following `For Each` loop to iterate through each GridView row:</span></span>

[!code-vb[Main](batch-deleting-vb/samples/sample2.vb)]

<span data-ttu-id="b4cc2-140">Для каждой строки ссылка на веб-элемент управления CheckBox `ProductSelector` программными средствами.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-140">For each row, the `ProductSelector` CheckBox Web control is programmatically referenced.</span></span> <span data-ttu-id="b4cc2-141">Если флажок установлен, строка s `ProductID` извлекается из коллекции `DataKeys` и свойство `DeleteResults` метка s `Text` обновляется для включения сообщения, указывающего на то, что строка была выбрана для удаления.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-141">If it is checked, the row s `ProductID` is retrieved from the `DataKeys` collection and the `DeleteResults` Label s `Text` property is updated to include a message indicating that the row was selected for deletion.</span></span>

<span data-ttu-id="b4cc2-142">Приведенный выше код фактически не удаляет какие-либо записи, так как вызов метода `ProductsBLL` класса s `Delete` комментария. Была ли эта логика удаления применена, код удалит продукты, но не в атомарной операции.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-142">The above code does not actually delete any records as the call to the `ProductsBLL` class s `Delete` method is commented out. Were this delete logic to be applied, the code would delete the products but not within an atomic operation.</span></span> <span data-ttu-id="b4cc2-143">То есть, если первые несколько удалений в последовательности завершились с ошибкой позже (возможно, из-за нарушения ограничения внешнего ключа), будет создано исключение, но уже удаленные продукты останутся прежними.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-143">That is, if the first few deletes in the sequence succeeded, but a later one failed (perhaps due to a foreign key constraint violation), an exception would be thrown but those products already deleted would remain deleted.</span></span>

<span data-ttu-id="b4cc2-144">Чтобы обеспечить атомарность, необходимо вместо этого использовать метод `ProductsBLL` Class s `DeleteProductsWithTransaction`.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-144">In order to assure atomicity, we need to instead use the `ProductsBLL` class s `DeleteProductsWithTransaction` method.</span></span> <span data-ttu-id="b4cc2-145">Поскольку этот метод принимает список значений `ProductID`, необходимо сначала скомпилировать этот список из сетки, а затем передать его в качестве параметра.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-145">Because this method accepts a list of `ProductID` values, we need to first compile this list from the grid and then pass it as a parameter.</span></span> <span data-ttu-id="b4cc2-146">Сначала мы создадим экземпляр `List(Of T)` типа `Integer`.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-146">We first create an instance of a `List(Of T)` of type `Integer`.</span></span> <span data-ttu-id="b4cc2-147">В цикле `For Each` необходимо добавить выбранные продукты `ProductID` значения в эту `List(Of T)`.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-147">Within the `For Each` loop we need to add the selected products `ProductID` values to this `List(Of T)`.</span></span> <span data-ttu-id="b4cc2-148">После цикла этот `List(Of T)` должен быть передан методу `ProductsBLL` класса s `DeleteProductsWithTransaction`.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-148">After the loop this `List(Of T)` must be passed to the `ProductsBLL` class s `DeleteProductsWithTransaction` method.</span></span> <span data-ttu-id="b4cc2-149">Обновите `DeleteSelectedProducts` кнопку s `Click` обработчик событий, используя следующий код:</span><span class="sxs-lookup"><span data-stu-id="b4cc2-149">Update the `DeleteSelectedProducts` Button s `Click` event handler with the following code:</span></span>

[!code-vb[Main](batch-deleting-vb/samples/sample3.vb)]

<span data-ttu-id="b4cc2-150">Обновленный код создает `List(Of T)` типа `Integer` (`productIDsToDelete`) и заполняет его `ProductID`ными значениями для удаления.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-150">The updated code creates a `List(Of T)` of type `Integer` (`productIDsToDelete`) and populates it with the `ProductID` values to delete.</span></span> <span data-ttu-id="b4cc2-151">Если после цикла `For Each`а выбран по крайней мере один продукт, вызывается метод `ProductsBLL` класса s `DeleteProductsWithTransaction` и этот список передается.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-151">After the `For Each` loop, if there is at least one product selected, the `ProductsBLL` class s `DeleteProductsWithTransaction` method is called and passed this list.</span></span> <span data-ttu-id="b4cc2-152">Также отображается метка `DeleteResults` и данные, повторно привязанные к GridView (чтобы недавно удаленные записи больше не отображались в виде строк в сетке).</span><span class="sxs-lookup"><span data-stu-id="b4cc2-152">The `DeleteResults` Label is also displayed and the data rebound to the GridView (so that the newly-deleted records no longer appear as rows in the grid).</span></span>

<span data-ttu-id="b4cc2-153">На рис. 4 показан элемент управления GridView после выбора нескольких строк для удаления.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-153">Figure 4 shows the GridView after a number of rows have been selected for deletion.</span></span> <span data-ttu-id="b4cc2-154">На рис. 5 показан экран сразу после нажатия кнопки Удалить выбранные продукты.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-154">Figure 5 shows the screen immediately after the Delete Selected Products button has been clicked.</span></span> <span data-ttu-id="b4cc2-155">Обратите внимание, что на рис. 5 `ProductID` значения удаленных записей отображаются в метке под GridView, а эти строки больше не находятся в GridView.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-155">Note that in Figure 5 the `ProductID` values of the deleted records are displayed in the Label beneath the GridView and those rows are no longer in the GridView.</span></span>

<span data-ttu-id="b4cc2-156">[![выбранные продукты будут удалены](batch-deleting-vb/_static/image4.gif)](batch-deleting-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b4cc2-156">[![The Selected Products Will Be Deleted](batch-deleting-vb/_static/image4.gif)](batch-deleting-vb/_static/image7.png)</span></span>

<span data-ttu-id="b4cc2-157">**Рис. 4**. выбранные продукты будут удалены ([щелкните, чтобы просмотреть изображение с полным размером](batch-deleting-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="b4cc2-157">**Figure 4**: The Selected Products Will Be Deleted ([Click to view full-size image](batch-deleting-vb/_static/image8.png))</span></span>

<span data-ttu-id="b4cc2-158">[![значения ProductID для удаленных продуктов перечислены под GridView](batch-deleting-vb/_static/image5.gif)](batch-deleting-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="b4cc2-158">[![The Deleted Products ProductID Values are Listed Beneath the GridView](batch-deleting-vb/_static/image5.gif)](batch-deleting-vb/_static/image9.png)</span></span>

<span data-ttu-id="b4cc2-159">**Рис. 5**. удаленные продукты, `ProductID` значения перечислены под элементом управления GridView ([щелкните, чтобы просмотреть изображение с полным размером](batch-deleting-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="b4cc2-159">**Figure 5**: The Deleted Products `ProductID` Values are Listed Beneath the GridView ([Click to view full-size image](batch-deleting-vb/_static/image10.png))</span></span>

> [!NOTE]
> <span data-ttu-id="b4cc2-160">Чтобы протестировать атомарность `DeleteProductsWithTransaction` метода, вручную добавьте запись для продукта в `Order Details` таблицу и попытайтесь удалить этот продукт (вместе с другими).</span><span class="sxs-lookup"><span data-stu-id="b4cc2-160">To test the `DeleteProductsWithTransaction` method s atomicity, manually add an entry for a product in the `Order Details` table and then attempt to delete that product (along with others).</span></span> <span data-ttu-id="b4cc2-161">При попытке удалить продукт с соответствующим порядком будет получено нарушение ограничения внешнего ключа, но обратите внимание, что выполняется откат других выбранных продуктов.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-161">You will receive a foreign key constraint violation when attempting to delete the product with an associated order, but note how the other selected products deletions are rolled back.</span></span>

## <a name="summary"></a><span data-ttu-id="b4cc2-162">Сводка</span><span class="sxs-lookup"><span data-stu-id="b4cc2-162">Summary</span></span>

<span data-ttu-id="b4cc2-163">Создание пакетного удаления интерфейса включает добавление GridView со столбцом флажков и веб-элементом управления Button, который при нажатии удалит все выбранные строки как единую атомарную операцию.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-163">Creating a batch deleting interface involves adding a GridView with a column of checkboxes and a Button Web control that, when clicked, will delete all of the selected rows as a single atomic operation.</span></span> <span data-ttu-id="b4cc2-164">В этом учебнике мы создали такой интерфейс, пиеЦинг совместную работу в двух предыдущих учебных курсах, [добавив столбец GridView с флажками](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) и [заключив изменения базы данных в рамках транзакции](wrapping-database-modifications-within-a-transaction-vb.md).</span><span class="sxs-lookup"><span data-stu-id="b4cc2-164">In this tutorial we built such an interface by piecing together work done in two previous tutorials, [Adding a GridView Column of Checkboxes](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) and [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md).</span></span> <span data-ttu-id="b4cc2-165">В первом учебном курсе мы создали GridView со столбцом флажков, а в последнем мы реализовали в BLL метод, который при передаче `List(Of T)` из `ProductID`ных значений удаляет их все в области транзакции.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-165">In the first tutorial we created a GridView with a column of checkboxes and in the latter we implemented a method in the BLL that, when passed a `List(Of T)` of `ProductID` values, deleted them all within the scope of a transaction.</span></span>

<span data-ttu-id="b4cc2-166">В следующем учебном курсе мы создадим интерфейс для выполнения пакетных вставок.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-166">In the next tutorial we'll create an interface for performing batch inserts.</span></span>

<span data-ttu-id="b4cc2-167">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="b4cc2-167">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="b4cc2-168">Об авторе</span><span class="sxs-lookup"><span data-stu-id="b4cc2-168">About the Author</span></span>

<span data-ttu-id="b4cc2-169">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-169">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b4cc2-170">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-170">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b4cc2-171">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="b4cc2-171">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="b4cc2-172">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b4cc2-172">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="b4cc2-173">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="b4cc2-173">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="b4cc2-174">Специальная благодарность</span><span class="sxs-lookup"><span data-stu-id="b4cc2-174">Special Thanks To</span></span>

<span data-ttu-id="b4cc2-175">Эта серия руководств была рассмотрена многими полезными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-175">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b4cc2-176">Потенциальные рецензенты для этого учебника были Хилтон Гизнау и Терезой Мерфи.</span><span class="sxs-lookup"><span data-stu-id="b4cc2-176">Lead reviewers for this tutorial were Hilton Giesenow and Teresa Murphy.</span></span> <span data-ttu-id="b4cc2-177">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="b4cc2-177">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b4cc2-178">Если это так, расположите строку в [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b4cc2-178">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="b4cc2-179">[Назад](batch-updating-vb.md)
> [Вперед](batch-inserting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="b4cc2-179">[Previous](batch-updating-vb.md)
[Next](batch-inserting-vb.md)</span></span>
