---
uid: web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-acess-two-pages-datalist-vb
title: Фильтрация "основной/подробности" на двух страницах (VB) | Документация Майкрософт
author: rick-anderson
description: В этом учебнике рассматривается разделение отчета «основной/подробности» на две страницы. На странице "Главная" мы используем элемент управления Repeater для отображения списка катег...
ms.author: riande
ms.date: 10/30/2010
ms.assetid: f1a1be2c-6fd9-4a09-916e-aa1b98d5cf17
msc.legacyurl: /web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-acess-two-pages-datalist-vb
msc.type: authoredcontent
ms.openlocfilehash: 037e5f47efff88bfcbec57b11efa4fec04f9542d
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74591498"
---
# <a name="masterdetail-filtering-across-two-pages-vb"></a><span data-ttu-id="ac8ef-104">Фильтрация "Основной/подробности" на двух страницах (VB)</span><span class="sxs-lookup"><span data-stu-id="ac8ef-104">Master/Detail Filtering Across Two Pages (VB)</span></span>

<span data-ttu-id="ac8ef-105">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ac8ef-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ac8ef-106">[Скачивание примера приложения](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_34_VB.exe) или [Загрузка PDF-файла](master-detail-filtering-acess-two-pages-datalist-vb/_static/datatutorial34vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="ac8ef-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_34_VB.exe) or [Download PDF](master-detail-filtering-acess-two-pages-datalist-vb/_static/datatutorial34vb1.pdf)</span></span>

> <span data-ttu-id="ac8ef-107">В этом учебнике рассматривается разделение отчета «основной/подробности» на две страницы.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-107">In this tutorial we look at how to separate a master/detail report across two pages.</span></span> <span data-ttu-id="ac8ef-108">На главной странице мы используем элемент управления Repeater для отображения списка категорий, при щелчке которого пользователь перейдет на страницу "сведения", где в DataList в двух столбцах отображаются продукты, принадлежащие выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-108">In the "master" page we use a Repeater control to render a list of categories that, when clicked, will take the user to the "details" page where a two-column DataList shows those products belonging to the selected category.</span></span>

## <a name="introduction"></a><span data-ttu-id="ac8ef-109">Введение</span><span class="sxs-lookup"><span data-stu-id="ac8ef-109">Introduction</span></span>

<span data-ttu-id="ac8ef-110">В учебнике « [основной/подробности» в двух страницах](../masterdetail/master-detail-filtering-across-two-pages-vb.md) мы рассматривали этот шаблон с помощью элемента управления GridView для отображения всех поставщиков в системе.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-110">In the [Master/Detail Filtering Across Two Pages](../masterdetail/master-detail-filtering-across-two-pages-vb.md) tutorial, we examined this pattern using a GridView to display all of the suppliers in the system.</span></span> <span data-ttu-id="ac8ef-111">Этот GridView включал в себя HyperLinkField, который отображается в виде ссылки на вторую страницу, передавая `SupplierID` в строке запроса.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-111">This GridView included a HyperLinkField, which rendered as a link to a second page, passing along the `SupplierID` in the querystring.</span></span> <span data-ttu-id="ac8ef-112">На второй странице используется GridView для перечисления продуктов, предоставляемых выбранным поставщиком.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-112">The second page used a GridView to list those products provided by the selected supplier.</span></span>

<span data-ttu-id="ac8ef-113">Такие Многостраничные отчеты «основной/подробности» могут быть выполнены также с помощью элементов управления DataList и Repeater.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-113">Such two-page master/detail reports can be accomplished using DataList and Repeater controls as well.</span></span> <span data-ttu-id="ac8ef-114">Единственное отличие заключается в том, что ни DataList, ни Repeater не поддерживают элемент управления HyperLinkField.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-114">The only difference is that neither the DataList nor the Repeater provides support for the HyperLinkField control.</span></span> <span data-ttu-id="ac8ef-115">Вместо этого необходимо добавить веб-элемент управления HyperLink или элемент HTML Anchor (`<a>`) в `ItemTemplate`элемента управления.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-115">Instead, we must add a HyperLink Web control or an anchor HTML element (`<a>`) within the control's `ItemTemplate`.</span></span> <span data-ttu-id="ac8ef-116">Затем можно настроить свойство `NavigateUrl` гиперссылки или атрибут `href` привязки с помощью декларативных или программных подходов.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-116">The HyperLink's `NavigateUrl` property or the anchor's `href` attribute can then be customized using declarative or programmatic approaches.</span></span>

<span data-ttu-id="ac8ef-117">В этом учебнике мы рассмотрим пример, который перечисляет категории в маркированном списке на одной странице с помощью элемента управления Repeater.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-117">In this tutorial we'll explore an example that lists the categories in a bulleted list on one page using a Repeater control.</span></span> <span data-ttu-id="ac8ef-118">Каждый элемент списка будет включать имя и описание категории, а имя категории отображается как ссылка на вторую страницу.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-118">Each list item will include the category's name and description, with the category name displayed as a link to a second page.</span></span> <span data-ttu-id="ac8ef-119">Если щелкнуть эту ссылку, пользователь перенесет на вторую страницу, где в DataList будут показаны продукты, принадлежащие к выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-119">Clicking on this link will whisk the user to the second page, where a DataList will show those products that belong to the selected category.</span></span>

## <a name="step-1-displaying-the-categories-in-a-bulleted-list"></a><span data-ttu-id="ac8ef-120">Шаг 1. Отображение категорий в маркированном списке</span><span class="sxs-lookup"><span data-stu-id="ac8ef-120">Step 1: Displaying the Categories in a Bulleted List</span></span>

<span data-ttu-id="ac8ef-121">Первый шаг при создании отчета «основной/подробности» начинается с отображения «главных» записей.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-121">The first step in creating any master/detail report is to start by displaying the "master" records.</span></span> <span data-ttu-id="ac8ef-122">Поэтому нашей первой задачей является отображение категорий на странице «Главная».</span><span class="sxs-lookup"><span data-stu-id="ac8ef-122">Therefore, our first task is to display the categories in the "master" page.</span></span> <span data-ttu-id="ac8ef-123">Откройте страницу `CategoryListMaster.aspx` в папке `DataListRepeaterFiltering`, добавьте элемент управления Repeater и в смарт-теге выберите Добавить новый объект ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-123">Open the `CategoryListMaster.aspx` page in the `DataListRepeaterFiltering` folder, add a Repeater control, and, from the smart tag, opt to add a new ObjectDataSource.</span></span> <span data-ttu-id="ac8ef-124">Настройте новый элемент ObjectDataSource таким образом, чтобы он обращается к своим данным из метода `GetCategories` класса `CategoriesBLL` (см. рис. 1).</span><span class="sxs-lookup"><span data-stu-id="ac8ef-124">Configure the new ObjectDataSource so that it accesses its data from the `CategoriesBLL` class's `GetCategories` method (see Figure 1).</span></span>

<span data-ttu-id="ac8ef-125">[![настроить ObjectDataSource для использования метода Categories класса CategoriesBLL](master-detail-filtering-acess-two-pages-datalist-vb/_static/image2.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ac8ef-125">[![Configure the ObjectDataSource to Use the CategoriesBLL Class's GetCategories Method](master-detail-filtering-acess-two-pages-datalist-vb/_static/image2.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image1.png)</span></span>

<span data-ttu-id="ac8ef-126">**Рис. 1**. Настройка ObjectDataSource для использования метода `GetCategories` класса `CategoriesBLL` ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-acess-two-pages-datalist-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="ac8ef-126">**Figure 1**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class's `GetCategories` Method ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image3.png))</span></span>

<span data-ttu-id="ac8ef-127">Затем определите шаблоны Repeater таким образом, чтобы имя и описание каждой категории отображались как элемент в маркированном списке.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-127">Next, define the Repeater's templates such that it displays each category name and description as an item in a bulleted list.</span></span> <span data-ttu-id="ac8ef-128">Давайте еще не будем беспокоиться о том, что каждая категория имеет ссылку на страницу сведений.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-128">Let's not yet worry about having each category link to the details page.</span></span> <span data-ttu-id="ac8ef-129">Ниже показана декларативная разметка для элемента управления Repeater и ObjectDataSource:</span><span class="sxs-lookup"><span data-stu-id="ac8ef-129">The following shows the declarative markup for the Repeater and ObjectDataSource:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample1.aspx)]

<span data-ttu-id="ac8ef-130">После завершения этой разметки уделите время для просмотра хода выполнения через браузер.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-130">With this markup complete, take a moment to view our progress through a browser.</span></span> <span data-ttu-id="ac8ef-131">Как показано на рис. 2, элемент Repeater отображается в виде маркированного списка, в котором указаны имя и описание каждой категории.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-131">As Figure 2 shows, the Repeater renders as a bulleted list showing each category's name and description.</span></span>

<span data-ttu-id="ac8ef-132">[![каждая категория отображается как маркированный элемент списка](master-detail-filtering-acess-two-pages-datalist-vb/_static/image5.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ac8ef-132">[![Each Category is Displayed as a Bulleted List Item](master-detail-filtering-acess-two-pages-datalist-vb/_static/image5.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image4.png)</span></span>

<span data-ttu-id="ac8ef-133">**Рис. 2**. Каждая категория отображается как маркированный элемент списка ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-acess-two-pages-datalist-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="ac8ef-133">**Figure 2**: Each Category is Displayed as a Bulleted List Item ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image6.png))</span></span>

## <a name="step-2-turning-the-category-name-into-a-link-to-the-details-page"></a><span data-ttu-id="ac8ef-134">Шаг 2. преобразование имени категории в ссылку на страницу сведений</span><span class="sxs-lookup"><span data-stu-id="ac8ef-134">Step 2: Turning the Category Name into a Link to the Details Page</span></span>

<span data-ttu-id="ac8ef-135">Чтобы разрешить пользователю отображать сведения об определенной категории, необходимо добавить ссылку на каждый маркированный список, при щелчке которого пользователь перейдет на вторую страницу (`ProductsForCategoryDetails.aspx`).</span><span class="sxs-lookup"><span data-stu-id="ac8ef-135">To allow a user to display the "details" information for a given category, we need to add a link to each bulleted list item that, when clicked, will take the user to the second page (`ProductsForCategoryDetails.aspx`).</span></span> <span data-ttu-id="ac8ef-136">На этой второй странице будут отображаться продукты для выбранной категории с помощью DataList.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-136">This second page will then display the products for the selected category using a DataList.</span></span> <span data-ttu-id="ac8ef-137">Чтобы определить категорию, для которой была нажата ссылка, необходимо передать `CategoryID` на вторую страницу с помощью какого-либо механизма.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-137">In order to determine the category whose link was clicked, we need to pass the clicked category's `CategoryID` to the second page through some mechanism.</span></span> <span data-ttu-id="ac8ef-138">Самый простой и простой способ переносить скалярные данные с одной страницы на другую — через строку запроса, которая является вариантом, который мы будем использовать в этом учебнике.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-138">The simplest, most straightforward way to transfer scalar data from one page to another is through the querystring, which is the option we'll use in this tutorial.</span></span> <span data-ttu-id="ac8ef-139">В частности, на странице `ProductsForCategoryDetails.aspx` будет считаться, что выбранное *`categoryID`* значение передается через поле QueryString с именем `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-139">In particular, the `ProductsForCategoryDetails.aspx` page will expect the selected *`categoryID`* value to be passed through a querystring field named `CategoryID`.</span></span> <span data-ttu-id="ac8ef-140">Например, чтобы просмотреть продукты для категории «напитки» с `CategoryID` 1, пользователь будет посещать `ProductsForCategoryDetails.aspx?CategoryID=1`.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-140">For example, to view the products for the Beverages category, which has a `CategoryID` of 1, a user would visit `ProductsForCategoryDetails.aspx?CategoryID=1`.</span></span>

<span data-ttu-id="ac8ef-141">Чтобы создать гиперссылку для каждого элемента маркированного списка в элементе управления Repeater, необходимо добавить в `ItemTemplate`элемент Web Control HyperLink или HTML Anchor (`<a>`).</span><span class="sxs-lookup"><span data-stu-id="ac8ef-141">To create a hyperlink for each bulleted list item in the Repeater we need to either add a HyperLink Web control or an HTML anchor element (`<a>`) to the `ItemTemplate`.</span></span> <span data-ttu-id="ac8ef-142">В сценариях, где гиперссылка отображается одинаково для каждой строки, любой из этих подходов будет достаточно.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-142">In scenarios where the hyperlink is displayed the same for each row, either approach will suffice.</span></span> <span data-ttu-id="ac8ef-143">Для повторяющихся элементов я предпочитаю использовать элемент Anchor.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-143">For Repeaters, I prefer using the anchor element.</span></span> <span data-ttu-id="ac8ef-144">Чтобы использовать элемент Anchor, обновите ItemTemplate элемента Repeater на:</span><span class="sxs-lookup"><span data-stu-id="ac8ef-144">To use the anchor element, update the Repeater's ItemTemplate to:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample2.aspx)]

<span data-ttu-id="ac8ef-145">Обратите внимание, что `CategoryID` можно внедрить непосредственно в атрибут `href` элемента привязки. Тем не менее, для этого необходимо ограничить значение `href` атрибута апострофами (и кавычками), так как метод `Eval` в атрибуте `href` отделяет строку (`"CategoryID"`) кавычками.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-145">Note that the `CategoryID` can be injected directly within the anchor element's `href` attribute; however, to do so be certain to delimit the `href` attribute's value with apostrophes (and note quotation marks) since the `Eval` method within the `href` attribute delimits its string (`"CategoryID"`) with quotation marks.</span></span> <span data-ttu-id="ac8ef-146">Вместо этого можно использовать веб-элемент управления HyperLink:</span><span class="sxs-lookup"><span data-stu-id="ac8ef-146">Alternatively, a HyperLink Web control can be used instead:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample3.aspx)]

<span data-ttu-id="ac8ef-147">Обратите внимание на то, как статическая часть URL-адреса — `ProductsForCategoryDetails.aspx?CategoryID` — добавляется к результату `Eval("CategoryID")` непосредственно в синтаксисе привязки данных с помощью сцепления строк.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-147">Note how the static portion of the URL — `ProductsForCategoryDetails.aspx?CategoryID` — is appended to the result of `Eval("CategoryID")` directly within the databinding syntax using string concatenation.</span></span>

<span data-ttu-id="ac8ef-148">Одним из преимуществ использования элемента управления HyperLink является возможность программного доступа к нему из обработчика `ItemDataBound` событий Repeater, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-148">One benefit of using the HyperLink control is that it can be programmatically accessed from the Repeater's `ItemDataBound` event handler, if needed.</span></span> <span data-ttu-id="ac8ef-149">Например, можно отобразить имя категории как текст, а не как ссылку для категорий без связанных продуктов.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-149">For example, you might want to display the category name as text rather than as a link for categories with no associated products.</span></span> <span data-ttu-id="ac8ef-150">Такую проверку можно выполнить программно в обработчике событий `ItemDataBound`. для категорий без связанных продуктов в свойстве `NavigateUrl` гиперссылки может быть задана пустая строка, что приводит к отображению конкретного имени категории в виде обычного текста (а не в виде ссылки).</span><span class="sxs-lookup"><span data-stu-id="ac8ef-150">Such a check could be programmatically performed in the `ItemDataBound` event handler; for categories with no associated products, the HyperLink's `NavigateUrl` property could be set to a blank string, thereby resulting in that particular category name rendering as plain text (rather than as a link).</span></span> <span data-ttu-id="ac8ef-151">Дополнительные сведения о форматировании содержимого DataList и Repeater на основе программной логики с помощью обработчика событий `ItemDataBound` см. в статье Форматирование элементов управления DataList [и Repeater на основе данных](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb.md) .</span><span class="sxs-lookup"><span data-stu-id="ac8ef-151">Refer back to the [Formatting the DataList and Repeater Based Upon Data](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb.md) tutorial for more information on formatting the DataList and Repeater's contents based on programmatic logic through the `ItemDataBound` event handler.</span></span>

<span data-ttu-id="ac8ef-152">Если вы выполняете следующие функции, вы можете использовать на странице подход к элементу привязки или элементу управления HyperLink.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-152">If you are following along, feel free to use either the anchor element or HyperLink control approach in your page.</span></span> <span data-ttu-id="ac8ef-153">Независимо от подхода при просмотре страницы в браузере каждое имя категории должно быть отображено в виде ссылки на `ProductsForCategoryDetails.aspx`, передавая соответствующее значение `CategoryID` (см. рис. 3).</span><span class="sxs-lookup"><span data-stu-id="ac8ef-153">Regardless of the approach, when viewing the page through a browser each category name should be rendered as a link to `ProductsForCategoryDetails.aspx`, passing in the applicable `CategoryID` value (see Figure 3).</span></span>

<span data-ttu-id="ac8ef-154">[![имена категорий теперь можно связать с ProductsForCategoryDetails. aspx](master-detail-filtering-acess-two-pages-datalist-vb/_static/image8.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ac8ef-154">[![The Category Names Now Link to ProductsForCategoryDetails.aspx](master-detail-filtering-acess-two-pages-datalist-vb/_static/image8.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image7.png)</span></span>

<span data-ttu-id="ac8ef-155">**Рис. 3**. имена категорий теперь связаны с `ProductsForCategoryDetails.aspx` ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-acess-two-pages-datalist-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="ac8ef-155">**Figure 3**: The Category Names Now Link to `ProductsForCategoryDetails.aspx` ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image9.png))</span></span>

## <a name="step-3-listing-the-products-that-belong-to-the-selected-category"></a><span data-ttu-id="ac8ef-156">Шаг 3. Перечисление продуктов, относящихся к выбранной категории</span><span class="sxs-lookup"><span data-stu-id="ac8ef-156">Step 3: Listing the Products that Belong to the Selected Category</span></span>

<span data-ttu-id="ac8ef-157">По завершении страницы `CategoryListMaster.aspx` все готово к внедрению страницы "сведения", `ProductsForCategoryDetails.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-157">With the `CategoryListMaster.aspx` page complete, we're ready to turn our attention to implementing the "details" page, `ProductsForCategoryDetails.aspx`.</span></span> <span data-ttu-id="ac8ef-158">Откройте эту страницу, перетащите элемент управления DataList с панели инструментов в конструктор и задайте для его свойства `ID` значение `ProductsInCategory`.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-158">Open this page, drag a DataList from the Toolbox onto the Designer, and set its `ID` property to `ProductsInCategory`.</span></span> <span data-ttu-id="ac8ef-159">Затем в смарт-теге DataList выберите Добавить на страницу новый элемент управления ObjectDataSource, назвав его `ProductsInCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-159">Next, from the DataList's smart tag choose to add a new ObjectDataSource to the page, naming it `ProductsInCategoryDataSource`.</span></span> <span data-ttu-id="ac8ef-160">Настройте его таким способом, чтобы он вызывал метод `GetProductsByCategoryID(categoryID)` класса `ProductsBLL`; Задайте для раскрывающихся списков на вкладках Вставка, обновление и удаление значение (нет).</span><span class="sxs-lookup"><span data-stu-id="ac8ef-160">Configure it such that it calls the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method; set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>

<span data-ttu-id="ac8ef-161">[![настроить ObjectDataSource для использования метода GetProductsByCategoryID (categoryID) класса ProductsBLL](master-detail-filtering-acess-two-pages-datalist-vb/_static/image11.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="ac8ef-161">[![Configure the ObjectDataSource to Use the ProductsBLL Class's GetProductsByCategoryID(categoryID) Method](master-detail-filtering-acess-two-pages-datalist-vb/_static/image11.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image10.png)</span></span>

<span data-ttu-id="ac8ef-162">**Рис. 4**. Настройка ObjectDataSource для использования метода `GetProductsByCategoryID(categoryID)` класса `ProductsBLL` ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-acess-two-pages-datalist-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="ac8ef-162">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class's `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image12.png))</span></span>

<span data-ttu-id="ac8ef-163">Поскольку метод `GetProductsByCategoryID(categoryID)` принимает входной параметр ( *`categoryID`* ), мастер выбора источника данных предлагает нам возможность указать источник параметра.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-163">Since the `GetProductsByCategoryID(categoryID)` method accepts an input parameter (*`categoryID`*), the Choose Data Source wizard offers us an opportunity to specify the parameter's source.</span></span> <span data-ttu-id="ac8ef-164">Задайте в качестве источника параметра значение QueryString с помощью `CategoryID`QueryStringField.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-164">Set the parameter source to QueryString using the QueryStringField `CategoryID`.</span></span>

<span data-ttu-id="ac8ef-165">[![использовать поле строки кода CategoryID в качестве источника параметра](master-detail-filtering-acess-two-pages-datalist-vb/_static/image14.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ac8ef-165">[![Use the Querystring Field CategoryID as the Parameter's Source](master-detail-filtering-acess-two-pages-datalist-vb/_static/image14.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image13.png)</span></span>

<span data-ttu-id="ac8ef-166">**Рис. 5**. Использование поля QueryString `CategoryID` в качестве источника параметра ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-acess-two-pages-datalist-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="ac8ef-166">**Figure 5**: Use the Querystring Field `CategoryID` as the Parameter's Source ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image15.png))</span></span>

<span data-ttu-id="ac8ef-167">Как мы видели в предыдущих руководствах, после завершения работы с мастером выбор источника данных Visual Studio автоматически создает `ItemTemplate` для элемента управления DataList, в котором перечислены имена и значения полей данных.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-167">As we've seen in previous tutorials, after completing the Choose Data Source wizard, Visual Studio automatically creates an `ItemTemplate` for the DataList that lists each data field name and value.</span></span> <span data-ttu-id="ac8ef-168">Замените этот шаблон на тот, который содержит только название продукта, поставщика и цену.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-168">Replace this template with one that lists only the product's name, supplier, and price.</span></span> <span data-ttu-id="ac8ef-169">Также задайте для свойства `RepeatColumns` элемента управления DataList значение 2.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-169">Also, set the DataList's `RepeatColumns` property to 2.</span></span> <span data-ttu-id="ac8ef-170">После этих изменений декларативная разметка DataList и ObjectDataSource должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="ac8ef-170">After these changes, your DataList and ObjectDataSource's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample4.aspx)]

<span data-ttu-id="ac8ef-171">Чтобы просмотреть эту страницу в действии, начните со страницы `CategoryListMaster.aspx`. затем щелкните ссылку в маркированном списке категории.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-171">To view this page in action, start from the `CategoryListMaster.aspx` page; next, click on a link in the categories bulleted list.</span></span> <span data-ttu-id="ac8ef-172">В этом случае вы перейдете к `ProductsForCategoryDetails.aspx`, передав `CategoryID` через строку запроса.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-172">Doing so will take you to `ProductsForCategoryDetails.aspx`, passing along the `CategoryID` through the querystring.</span></span> <span data-ttu-id="ac8ef-173">`ProductsInCategoryDataSource` ObjectDataSource в `ProductsForCategoryDetails.aspx` будет получать только продукты для указанной категории и отображать их в DataList, который отображает два продукта в строке.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-173">The `ProductsInCategoryDataSource` ObjectDataSource in `ProductsForCategoryDetails.aspx` will then get just those products for the specified category and display them in the DataList, which renders two products per row.</span></span> <span data-ttu-id="ac8ef-174">На рис. 6 показан снимок экрана `ProductsForCategoryDetails.aspx` при просмотре напитков.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-174">Figure 6 shows a screenshot of `ProductsForCategoryDetails.aspx` when viewing the Beverages.</span></span>

<span data-ttu-id="ac8ef-175">[![отображаются напитки, по две строки](master-detail-filtering-acess-two-pages-datalist-vb/_static/image17.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="ac8ef-175">[![The Beverages are Displayed, Two per Row](master-detail-filtering-acess-two-pages-datalist-vb/_static/image17.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image16.png)</span></span>

<span data-ttu-id="ac8ef-176">**Рис. 6**. отображаются напитки, две на строку ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-acess-two-pages-datalist-vb/_static/image18.png)).</span><span class="sxs-lookup"><span data-stu-id="ac8ef-176">**Figure 6**: The Beverages are Displayed, Two per Row ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image18.png))</span></span>

## <a name="step-4-displaying-category-information-on-productsforcategorydetailsaspx"></a><span data-ttu-id="ac8ef-177">Шаг 4. Отображение сведений о категории в ProductsForCategoryDetails. aspx</span><span class="sxs-lookup"><span data-stu-id="ac8ef-177">Step 4: Displaying Category Information on ProductsForCategoryDetails.aspx</span></span>

<span data-ttu-id="ac8ef-178">Когда пользователь щелкает категорию в `CategoryListMaster.aspx`, он предпринимается для `ProductsForCategoryDetails.aspx` и отображения продуктов, принадлежащих выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-178">When a user clicks on a category in `CategoryListMaster.aspx`, they are taken to `ProductsForCategoryDetails.aspx` and shown the products that belong to the selected category.</span></span> <span data-ttu-id="ac8ef-179">Однако в `ProductsForCategoryDetails.aspx` нет визуальных подсказок относительно выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-179">However, in `ProductsForCategoryDetails.aspx` there are no visual cues as to what category was selected.</span></span> <span data-ttu-id="ac8ef-180">Пользователь, который выбрал элемент напитки, но случайно щелкнул «специи», не имеет возможности выпустить свою ошибку после достижения `ProductsForCategoryDetails.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-180">A user that meant to click Beverages, but accidentally clicked Condiments, has no way of realizing their mistake once they reach `ProductsForCategoryDetails.aspx`.</span></span> <span data-ttu-id="ac8ef-181">Чтобы решить эту потенциальную проблему, можно отобразить сведения о выбранной категории — ее имя и описание — в верхней части страницы `ProductsForCategoryDetails.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-181">To alleviate this potential problem, we can display information about the selected category — its name and description — at the top of the `ProductsForCategoryDetails.aspx` page.</span></span>

<span data-ttu-id="ac8ef-182">Для этого добавьте элемент FormView над элементом управления Repeater в `ProductsForCategoryDetails.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-182">To accomplish this, add a FormView above the Repeater control in `ProductsForCategoryDetails.aspx`.</span></span> <span data-ttu-id="ac8ef-183">Затем добавьте новый элемент управления ObjectDataSource на страницу из смарт-тега FormView с именем `CategoryDataSource` и настройте его для использования метода `GetCategoryByCategoryID(categoryID)` класса `CategoriesBLL`.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-183">Next, add a new ObjectDataSource to the page from the FormView's smart tag named `CategoryDataSource` and configure it to use the `CategoriesBLL` class's `GetCategoryByCategoryID(categoryID)` method.</span></span>

<span data-ttu-id="ac8ef-184">[![доступ к сведениям о категории с помощью метода Жеткатегорибикатегорид (categoryID) класса CategoriesBLL](master-detail-filtering-acess-two-pages-datalist-vb/_static/image20.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="ac8ef-184">[![Access Information about the Category through the CategoriesBLL Class's GetCategoryByCategoryID(categoryID) Method](master-detail-filtering-acess-two-pages-datalist-vb/_static/image20.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image19.png)</span></span>

<span data-ttu-id="ac8ef-185">**Рис. 7**. доступ к сведениям о категории с помощью метода `GetCategoryByCategoryID(categoryID)` класса `CategoriesBLL` ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-acess-two-pages-datalist-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="ac8ef-185">**Figure 7**: Access Information about the Category through the `CategoriesBLL` Class's `GetCategoryByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image21.png))</span></span>

<span data-ttu-id="ac8ef-186">Как и в случае с `ProductsInCategoryDataSource` ObjectDataSource, добавленным на шаге 3, мастер настройки источника данных `CategoryDataSource`запрашивает источник для входного параметра метода `GetCategoryByCategoryID(categoryID)`.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-186">As with the `ProductsInCategoryDataSource` ObjectDataSource added in Step 3, the `CategoryDataSource`'s Configure Data Source wizard prompts us for a source for the `GetCategoryByCategoryID(categoryID)` method's input parameter.</span></span> <span data-ttu-id="ac8ef-187">Используйте те же параметры, что и ранее, установив для источника параметра значение QueryString, а для значения QueryStringField — `CategoryID` (см. рис. 5).</span><span class="sxs-lookup"><span data-stu-id="ac8ef-187">Use the exact same settings as before, setting the parameter source to QueryString and the QueryStringField value to `CategoryID` (refer back to Figure 5).</span></span>

<span data-ttu-id="ac8ef-188">После завершения работы мастера Visual Studio автоматически создает `ItemTemplate`, `EditItemTemplate`и `InsertItemTemplate` для FormView.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-188">After completing the wizard, Visual Studio automatically creates an `ItemTemplate`, `EditItemTemplate`, and `InsertItemTemplate` for the FormView.</span></span> <span data-ttu-id="ac8ef-189">Так как мы предоставляем интерфейс только для чтения, вы можете удалить `EditItemTemplate` и `InsertItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-189">Since we're providing a read-only interface, feel free to remove the `EditItemTemplate` and `InsertItemTemplate`.</span></span> <span data-ttu-id="ac8ef-190">Кроме того, вы можете настроить `ItemTemplate`FormView.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-190">Also, feel free to customize the FormView's `ItemTemplate`.</span></span> <span data-ttu-id="ac8ef-191">После удаления лишних шаблонов и настройки ItemTemplate декларативная разметка FormView и ObjectDataSource должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="ac8ef-191">After removing the superfluous templates and customizing the ItemTemplate, your FormView and ObjectDataSource's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample5.aspx)]

<span data-ttu-id="ac8ef-192">На рис. 8 показан снимок экрана при просмотре этой страницы в браузере.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-192">Figure 8 shows a screen shot when viewing this page through a browser.</span></span>

> [!NOTE]
> <span data-ttu-id="ac8ef-193">Помимо FormView, я также добавил элемент управления HyperLink над FormView, который вернет пользователя в список категорий (`CategoryListMaster.aspx`).</span><span class="sxs-lookup"><span data-stu-id="ac8ef-193">In addition to the FormView, I've also added a HyperLink control above the FormView that will take the user back to the list of categories (`CategoryListMaster.aspx`).</span></span> <span data-ttu-id="ac8ef-194">Вы можете поместить эту ссылку в другое место или полностью опустить ее.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-194">Feel free to place this link elsewhere or to omit it altogether.</span></span>

<span data-ttu-id="ac8ef-195">[Сведения о категории ![теперь отображаются в верхней части страницы](master-detail-filtering-acess-two-pages-datalist-vb/_static/image23.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="ac8ef-195">[![Category Information is Now Displayed at the Top of the Page](master-detail-filtering-acess-two-pages-datalist-vb/_static/image23.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image22.png)</span></span>

<span data-ttu-id="ac8ef-196">**Рис. 8**. Теперь сведения о категориях отображаются в верхней части страницы ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-acess-two-pages-datalist-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="ac8ef-196">**Figure 8**: Category Information is Now Displayed at the Top of the Page ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image24.png))</span></span>

## <a name="step-5-displaying-a-message-if-no-products-belong-to-the-selected-category"></a><span data-ttu-id="ac8ef-197">Шаг 5. Отображение сообщения, если продукты не относятся к выбранной категории</span><span class="sxs-lookup"><span data-stu-id="ac8ef-197">Step 5: Displaying a Message if No Products Belong to the Selected Category</span></span>

<span data-ttu-id="ac8ef-198">На `CategoryListMaster.aspx` странице перечислены все категории в системе, независимо от наличия связанных с ними продуктов.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-198">The `CategoryListMaster.aspx` page lists all categories in the system, regardless of whether there are any associated products.</span></span> <span data-ttu-id="ac8ef-199">Если пользователь щелкает категорию без связанных продуктов, элемент управления DataList в `ProductsForCategoryDetails.aspx` не будет подготовлен, так как его источник данных не будет содержать никаких элементов.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-199">If a user clicks on a category with no associated products, the DataList in `ProductsForCategoryDetails.aspx` will not be rendered, as its data source will not have any items.</span></span> <span data-ttu-id="ac8ef-200">Как мы видели в прошлых учебных курсах, GridView предоставляет свойство `EmptyDataText`, которое можно использовать для указания текстового сообщения, которое должно отображаться, если в его источнике данных нет записей.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-200">As we've seen in past tutorials, the GridView provides an `EmptyDataText` property that can be used to specify a text message to display if there are no records in its data source.</span></span> <span data-ttu-id="ac8ef-201">Увы, ни элемент управления DataList, ни Repeater не имеют такого свойства.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-201">Unfortunately, neither the DataList nor Repeater has such a property.</span></span>

<span data-ttu-id="ac8ef-202">Чтобы отобразить сообщение о том, что для выбранной категории нет соответствующих продуктов, необходимо добавить на страницу элемент управления Label, для которого в свойстве `Text` назначено сообщение, которое будет отображаться в случае отсутствия соответствующих продуктов.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-202">In order to display a message informing the user that there are no matching products for the selected category, we need to add a Label control to the page whose `Text` property is assigned the message to display in the event that there are no matching products.</span></span> <span data-ttu-id="ac8ef-203">Затем необходимо программно задать свойство `Visible` в зависимости от того, содержит ли DataList какие либо элементы.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-203">We then need to programmatically set its `Visible` property based on whether or not the DataList contains any items.</span></span>

<span data-ttu-id="ac8ef-204">Чтобы сделать это, начните с добавления метки под элементом управления DataList.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-204">To accomplish this, start by adding a Label beneath the DataList.</span></span> <span data-ttu-id="ac8ef-205">Присвойте свойству `ID` `NoProductsMessage` и его свойству `Text` значение "отсутствуют продукты для выбранной категории..." Далее необходимо программно задать свойство `Visible` этой метки в зависимости от того, были ли данные привязаны к `ProductsInCategory` DataList.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-205">Set its `ID` property to `NoProductsMessage` and its `Text` property to "There are no products for the selected category…" Next, we need to programmatically set this Label's `Visible` property based on whether or not any data was bound to the `ProductsInCategory` DataList.</span></span> <span data-ttu-id="ac8ef-206">Это назначение должно быть выполнено после привязки данных к DataList.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-206">This assignment must be made after the data has been bound to the DataList.</span></span> <span data-ttu-id="ac8ef-207">Для элементов GridView, DetailsView и FormView можно создать обработчик событий для события `DataBound` элемента управления, которое срабатывает после завершения привязки данных.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-207">For the GridView, DetailsView, and FormView, we could create an event handler for the control's `DataBound` event, which fires after databinding has completed.</span></span> <span data-ttu-id="ac8ef-208">Однако ни элемент управления DataList, ни Repeater не имеют доступного `DataBound` события.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-208">However, neither the DataList nor the Repeater has a `DataBound` event available.</span></span>

<span data-ttu-id="ac8ef-209">В этом конкретном примере можно назначить свойство `Visible` метки в обработчике событий `Page_Load`, поскольку данные будут назначены элементу управления DataList до события `Load` страницы.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-209">For this particular example we can assign the Label's `Visible` property in the `Page_Load` event handler, since the data will have been assigned to the DataList prior to the page's `Load` event.</span></span> <span data-ttu-id="ac8ef-210">Однако этот подход не будет работать в общем случае, так как данные из ObjectDataSource могут быть привязаны к DataList позже в жизненном цикле страницы.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-210">However, this approach would not work in the general case, as the data from the ObjectDataSource might be bound to the DataList later in the page's lifecycle.</span></span> <span data-ttu-id="ac8ef-211">Например, если отображаемые данные основаны на значении в другом элементе управления, например при отображении отчета «основной/подробности» с помощью DropDownList для хранения «основных» записей, данные могут быть не привязаны к веб-элементу управления данными до тех пор, пока не будет `PreRender` этапа жизненного цикла страницы.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-211">For example, if the displayed data is based upon the value in another control, such as it is when displaying a master/detail report using a DropDownList to hold the "master" records, the data may not rebound to the data Web control until the `PreRender` stage in the page's life cycle.</span></span>

<span data-ttu-id="ac8ef-212">Одним из решений, которые будут работать во всех случаях, является присвоение свойству `Visible` `False` в обработчике событий `ItemDataBound` (или `ItemCreated`) DataList при привязке типа элемента `Item` или `AlternatingItem`.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-212">One solution which will work for all cases is to assign the `Visible` property to `False` in the DataList's `ItemDataBound` (or `ItemCreated`) event handler when binding an item type of `Item` or `AlternatingItem`.</span></span> <span data-ttu-id="ac8ef-213">В этом случае мы понимаем, что в источнике данных есть хотя бы один элемент данных, и поэтому может скрыть `NoProductsMessage` метку.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-213">In such a case we know that there is at least one data item in the data source and therefore can hide the `NoProductsMessage` Label.</span></span> <span data-ttu-id="ac8ef-214">В дополнение к этому обработчику событий нам также нужен обработчик событий `DataBinding` элемента управления DataList, в котором мы инициализируем свойство `Visible` метки для `True`.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-214">In addition to this event handler, we also need an event handler for the DataList's `DataBinding` event, where we initialize the Label's `Visible` property to `True`.</span></span> <span data-ttu-id="ac8ef-215">Так как событие `DataBinding` срабатывает до `ItemDataBound` событий, для свойства `Visible` метки первоначально устанавливается значение `True`. Однако если имеются какие бы то ни было элементы данных, для них будет задано значение `False`.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-215">Since the `DataBinding` event fires before the `ItemDataBound` events, the Label's `Visible` property will initially be set to `True`; if there are any data items, however, it will be set to `False`.</span></span> <span data-ttu-id="ac8ef-216">Следующий код реализует эту логику:</span><span class="sxs-lookup"><span data-stu-id="ac8ef-216">The following code implements this logic:</span></span>

[!code-vb[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample6.vb)]

<span data-ttu-id="ac8ef-217">Все категории в базе данных Northwind связаны с одним или несколькими продуктами.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-217">All of the categories in the Northwind database are associated with one or more products.</span></span> <span data-ttu-id="ac8ef-218">Чтобы протестировать эту функцию, я вручную настроил базу данных Northwind для этого руководства, переназначит все продукты, связанные с категорией создания (`CategoryID` = 7), в категорию Seafood (`CategoryID` = 8).</span><span class="sxs-lookup"><span data-stu-id="ac8ef-218">To test this feature, I've manually adjusted the Northwind database for this tutorial, reassigning all products associated with the Produce category (`CategoryID` = 7) to the Seafood category (`CategoryID` = 8).</span></span> <span data-ttu-id="ac8ef-219">Это можно сделать в обозреватель сервера, выбрав Создать запрос и используя следующую инструкцию `UPDATE`:</span><span class="sxs-lookup"><span data-stu-id="ac8ef-219">This can be accomplished from the Server Explorer by choosing New Query and using the following `UPDATE` statement:</span></span>

[!code-sql[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample7.sql)]

<span data-ttu-id="ac8ef-220">После обновления базы данных вернитесь на страницу `CategoryListMaster.aspx` и щелкните ссылку Создать.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-220">After updating the database accordingly, return to the `CategoryListMaster.aspx` page and click on the Produce link.</span></span> <span data-ttu-id="ac8ef-221">Поскольку больше нет продуктов, принадлежащих категории создать, вы должны увидеть "продукты для выбранной категории отсутствуют..." сообщение, как показано на рис. 9.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-221">Since there are no longer any products belonging to the Produce category, you should see the "There are no products for the selected category…" message, as shown in Figure 9.</span></span>

<span data-ttu-id="ac8ef-222">[![отображается сообщение, если нет продуктов, принадлежащих к выбранной категории](master-detail-filtering-acess-two-pages-datalist-vb/_static/image26.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="ac8ef-222">[![A Message is Displayed if there are No Products Belonging to the Selected Category](master-detail-filtering-acess-two-pages-datalist-vb/_static/image26.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image25.png)</span></span>

<span data-ttu-id="ac8ef-223">**Рис. 9**. сообщение отображается, если нет продуктов, принадлежащих к выбранной категории ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-acess-two-pages-datalist-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="ac8ef-223">**Figure 9**: A Message is Displayed if there are No Products Belonging to the Selected Category ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image27.png))</span></span>

## <a name="summary"></a><span data-ttu-id="ac8ef-224">Сводка</span><span class="sxs-lookup"><span data-stu-id="ac8ef-224">Summary</span></span>

<span data-ttu-id="ac8ef-225">В то время как отчеты «основной/подробности» могут отображать как основные, так и подробные записи на одной странице, во многих веб-сайтах они разделяются на две веб-страницы.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-225">While master/detail reports can display both the master and detail records on a single page, in many websites they are separated out across two web pages.</span></span> <span data-ttu-id="ac8ef-226">В этом учебнике мы рассмотрели, как реализовать такой отчет «основной/подробности», используя категории, перечисленные в маркированном списке, с помощью повторителя на главной веб-странице и связанных продуктов, перечисленных на странице «сведения».</span><span class="sxs-lookup"><span data-stu-id="ac8ef-226">In this tutorial we looked at how to implement such a master/detail report by having the categories listed in a bulleted list using a Repeater in the "master" web page and the associated products listed in the "details" page.</span></span> <span data-ttu-id="ac8ef-227">Каждый элемент списка на главной веб-странице содержал ссылку на страницу сведений, переданную по значению `CategoryID` строки.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-227">Each list item in the master web page contained a link to the details page that passed along the row's `CategoryID` value.</span></span>

<span data-ttu-id="ac8ef-228">На странице сведений получение этих продуктов для указанного поставщика осуществлялось с помощью метода `GetProductsByCategoryID(categoryID)` класса `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-228">In the details page retrieving those products for the specified supplier was accomplished through the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="ac8ef-229">Значение параметра *`categoryID`* было указано декларативно с использованием значения `CategoryID` QueryString в качестве источника параметра.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-229">The *`categoryID`* parameter value was specified declaratively using the `CategoryID` querystring value as the parameter source.</span></span> <span data-ttu-id="ac8ef-230">Мы также рассмотрели, как отобразить сведения о категории на странице сведений с помощью FormView и как отобразить сообщение, если нет продуктов, принадлежащих к выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-230">We also looked at how to display category details in the details page using a FormView and how to display a message if there were no products belonging to the selected category.</span></span>

<span data-ttu-id="ac8ef-231">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="ac8ef-231">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="ac8ef-232">Об авторе</span><span class="sxs-lookup"><span data-stu-id="ac8ef-232">About the Author</span></span>

<span data-ttu-id="ac8ef-233">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-233">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ac8ef-234">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-234">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ac8ef-235">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="ac8ef-235">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="ac8ef-236">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ac8ef-236">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="ac8ef-237">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="ac8ef-237">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="ac8ef-238">Особая благодарность...</span><span class="sxs-lookup"><span data-stu-id="ac8ef-238">Special Thanks To…</span></span>

<span data-ttu-id="ac8ef-239">Эта серия руководств была рассмотрена многими полезными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-239">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ac8ef-240">Потенциальным рецензентам для этого учебника были Зак Jones и основными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="ac8ef-240">Lead reviewers for this tutorial were Zack Jones and Liz Shulok.</span></span> <span data-ttu-id="ac8ef-241">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="ac8ef-241">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ac8ef-242">Если это так, расположите строку в [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ac8ef-242">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ac8ef-243">[Назад](master-detail-filtering-with-a-dropdownlist-datalist-vb.md)
> [Вперед](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ac8ef-243">[Previous](master-detail-filtering-with-a-dropdownlist-datalist-vb.md)
[Next](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md)</span></span>
