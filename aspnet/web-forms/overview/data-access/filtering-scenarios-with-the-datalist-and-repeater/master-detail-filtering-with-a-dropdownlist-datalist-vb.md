---
uid: web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-with-a-dropdownlist-datalist-vb
title: Фильтрация с помощью элемента управления DropDownList (VB) основной/подробности | Документация Майкрософт
author: rick-anderson
description: В этом руководстве показано, как отображать отчеты «основной/подробности» на одной веб-странице, используя списки DropDownList для отображения «master» записей и элемент управления DataList для displ...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: ad0f1014-1eff-465f-bdc6-93058de00e44
msc.legacyurl: /web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-with-a-dropdownlist-datalist-vb
msc.type: authoredcontent
ms.openlocfilehash: 13d67b3f4f2613c820baa3ec52d49ad6ea556f9d
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/01/2019
ms.locfileid: "57045611"
---
<a name="masterdetail-filtering-with-a-dropdownlist-vb"></a><span data-ttu-id="10e92-103">Фильтрация "Основной/подробности" с помощью элемента управления DropDownList (VB)</span><span class="sxs-lookup"><span data-stu-id="10e92-103">Master/Detail Filtering With a DropDownList (VB)</span></span>
====================
<span data-ttu-id="10e92-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="10e92-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="10e92-105">[Скачайте пример приложения](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_33_VB.exe) или [скачать PDF](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/datatutorial33vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="10e92-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_33_VB.exe) or [Download PDF](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/datatutorial33vb1.pdf)</span></span>

> <span data-ttu-id="10e92-106">В этом руководстве показано, как отображать отчеты «основной/подробности» на одной веб-странице, используя списки DropDownList для отображения «основных» записей и элемент управления DataList для «подробностей».</span><span class="sxs-lookup"><span data-stu-id="10e92-106">In this tutorial we see how to display master/detail reports in a single web page using DropDownLists to display the "master" records and a DataList to display the "details".</span></span>


## <a name="introduction"></a><span data-ttu-id="10e92-107">Вступление</span><span class="sxs-lookup"><span data-stu-id="10e92-107">Introduction</span></span>

<span data-ttu-id="10e92-108">Отчет «основной/подробности», который мы впервые создали с помощью элемента управления GridView в более ранней ["основной/подробности" Фильтрация с помощью элемента управления DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) руководства начинается с демонстрации определенного набора «основных» записей.</span><span class="sxs-lookup"><span data-stu-id="10e92-108">The master/detail report, which we first created using a GridView in the earlier [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial, begins by showing some set of "master" records.</span></span> <span data-ttu-id="10e92-109">Пользователь может затем перейти к одной из основных записей, таким образом просматривая основной записи «подробности».</span><span class="sxs-lookup"><span data-stu-id="10e92-109">The user can then drill down into one of the master records, thereby viewing that master record's "details."</span></span> <span data-ttu-id="10e92-110">Отчеты «основной/подробности» являются идеальным выбором для визуализации отношений «один ко многим», а также для отображения подробных сведений из особенно «широких» таблиц (таблиц со множеством столбцов).</span><span class="sxs-lookup"><span data-stu-id="10e92-110">Master/detail reports are an ideal choice for visualizing one-to-many relationships and for displaying detailed information from particularly "wide" tables (ones that have a lot of columns).</span></span> <span data-ttu-id="10e92-111">Курсах было продемонстрировано, как реализовать отчетов «основной/подробности», с помощью элементов управления GridView и DetailsView в предыдущих учебных курсах.</span><span class="sxs-lookup"><span data-stu-id="10e92-111">We've explored how to implement master/detail reports using the GridView and DetailsView controls in previous tutorials.</span></span> <span data-ttu-id="10e92-112">В этом руководстве и следующих двух будут изучены эти понятия, но внимание уделяется использованию элементов управления DataList и Repeater элементы управления.</span><span class="sxs-lookup"><span data-stu-id="10e92-112">In this tutorial and the next two, we'll reexamine these concepts, but focus on using DataList and Repeater controls instead.</span></span>

<span data-ttu-id="10e92-113">В этом руководстве мы рассмотрим использование элемента управления DropDownList для размещения «основных» записей, с записями «сведения», отображаемый в элементе управления DataList.</span><span class="sxs-lookup"><span data-stu-id="10e92-113">In this tutorial, we'll look at using a DropDownList to contain the "master" records, with the "details" records displayed in a DataList.</span></span>

## <a name="step-1-adding-the-masterdetail-tutorial-web-pages"></a><span data-ttu-id="10e92-114">Шаг 1. Добавление веб-страниц учебного "основной/подробности"</span><span class="sxs-lookup"><span data-stu-id="10e92-114">Step 1: Adding the Master/Detail Tutorial Web Pages</span></span>

<span data-ttu-id="10e92-115">Прежде чем приступать к этом руководстве, давайте добавим папку страницы ASP.NET, которые потребуются для этого учебника и следующих двух дело отчеты «основной/подробности» с помощью элементов управления DataList и Repeater некоторое время.</span><span class="sxs-lookup"><span data-stu-id="10e92-115">Before we start this tutorial, let's first take a moment to add the folder and ASP.NET pages we'll need for this tutorial and the next two dealing with master/detail reports using the DataList and Repeater controls.</span></span> <span data-ttu-id="10e92-116">Начнем с создания новой папки в проект с именем `DataListRepeaterFiltering`.</span><span class="sxs-lookup"><span data-stu-id="10e92-116">Start by creating a new folder in the project named `DataListRepeaterFiltering`.</span></span> <span data-ttu-id="10e92-117">Добавьте следующие пять страниц ASP.NET в этой папке, в которых настроено использование главной страницы `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="10e92-117">Next, add the following five ASP.NET pages to this folder, having all of them configured to use the master page `Site.master`:</span></span>

- `Default.aspx`
- `FilterByDropDownList.aspx`
- `CategoryListMaster.aspx`
- `ProductsForCategoryDetails.aspx`
- `CategoriesAndProducts.aspx`


![Создание папки DataListRepeaterFiltering и добавление страниц учебника по ASP.NET](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image1.png)

<span data-ttu-id="10e92-119">**Рис. 1**: Создание `DataListRepeaterFiltering` папки и добавление страниц учебника по ASP.NET</span><span class="sxs-lookup"><span data-stu-id="10e92-119">**Figure 1**: Create a `DataListRepeaterFiltering` Folder and Add the Tutorial ASP.NET Pages</span></span>


<span data-ttu-id="10e92-120">Затем откройте `Default.aspx` страницы и перетащите `SectionLevelTutorialListing.ascx` пользовательского элемента управления с `UserControls` папку в область конструктора.</span><span class="sxs-lookup"><span data-stu-id="10e92-120">Next, open the `Default.aspx` page and drag the `SectionLevelTutorialListing.ascx` User Control from the `UserControls` folder onto the Design surface.</span></span> <span data-ttu-id="10e92-121">Данный пользовательский элемент управления, созданный в учебном курсе [главные страницы и структуру переходов узла](../introduction/master-pages-and-site-navigation-vb.md) , просматривает карту узла и отображает руководства из текущего раздела в виде маркированного списка.</span><span class="sxs-lookup"><span data-stu-id="10e92-121">This User Control, which we created in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-vb.md) tutorial, enumerates the site map and displays the tutorials from the current section in a bulleted list.</span></span>


<span data-ttu-id="10e92-122">[![Добавление элемента управления Sectionleveltutoriallisting.ascx к странице Default.aspx](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image3.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="10e92-122">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image3.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image2.png)</span></span>

<span data-ttu-id="10e92-123">**Рис. 2**: Добавить `SectionLevelTutorialListing.ascx` для пользовательского элемента управления `Default.aspx` ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="10e92-123">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image4.png))</span></span>


<span data-ttu-id="10e92-124">Чтобы маркированный список отображал руководства «основной/подробности», которые будут созданы, необходимо добавить их в карту узла.</span><span class="sxs-lookup"><span data-stu-id="10e92-124">In order to have the bulleted list display the master/detail tutorials we'll be creating, we need to add them to the site map.</span></span> <span data-ttu-id="10e92-125">Откройте `Web.sitemap` файл и добавьте следующую разметку после разметки узла карты сайта «Отображение данных с помощью элементов управления DataList и Repeater»:</span><span class="sxs-lookup"><span data-stu-id="10e92-125">Open the `Web.sitemap` file and add the following markup after the "Displaying Data with the DataList and Repeater" site map node markup:</span></span>

[!code-xml[Main](master-detail-filtering-with-a-dropdownlist-datalist-vb/samples/sample1.xml)]


![Обновление карты узла для добавления новых страниц ASP.NET](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image5.png)

<span data-ttu-id="10e92-127">**Рис. 3**: Обновление карты узла для добавления новых страниц ASP.NET</span><span class="sxs-lookup"><span data-stu-id="10e92-127">**Figure 3**: Update the Site Map to Include the New ASP.NET Pages</span></span>


## <a name="step-2-displaying-the-categories-in-a-dropdownlist"></a><span data-ttu-id="10e92-128">Шаг 2. Отображение категорий в элементе управления DropDownList</span><span class="sxs-lookup"><span data-stu-id="10e92-128">Step 2: Displaying the Categories in a DropDownList</span></span>

<span data-ttu-id="10e92-129">Категории в элементе управления DropDownList, перечислит нашего отчета «основной/подробности» с продуктами выбранного элемента списка отображаются ниже на странице в элементе управления DataList.</span><span class="sxs-lookup"><span data-stu-id="10e92-129">Our master/detail report will list the categories in a DropDownList, with the selected list item's products displayed further down in the page in a DataList.</span></span> <span data-ttu-id="10e92-130">Первой задачей, то категорий, отображаемых в элементе управления DropDownList.</span><span class="sxs-lookup"><span data-stu-id="10e92-130">The first task ahead of us, then, is to have the categories displayed in a DropDownList.</span></span> <span data-ttu-id="10e92-131">Сначала откройте `FilterByDropDownList.aspx` странице в `DataListRepeaterFiltering` папки и перетащите DropDownList с панели элементов в конструктор страницы.</span><span class="sxs-lookup"><span data-stu-id="10e92-131">Start by opening the `FilterByDropDownList.aspx` page in the `DataListRepeaterFiltering` folder and drag a DropDownList from the Toolbox onto the page's designer.</span></span> <span data-ttu-id="10e92-132">Затем задайте DropDownList `ID` свойства `Categories`.</span><span class="sxs-lookup"><span data-stu-id="10e92-132">Next, set the DropDownList's `ID` property to `Categories`.</span></span> <span data-ttu-id="10e92-133">Щелкните ссылку выберите источник данных смарт-теге DropDownList и создайте новый ObjectDataSource, именуемый `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="10e92-133">Click on the Choose Data Source link from the DropDownList's smart tag and create a new ObjectDataSource named `CategoriesDataSource`.</span></span>


<span data-ttu-id="10e92-134">[![Добавьте новый ObjectDataSource, именуемый CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image7.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="10e92-134">[![Add a New ObjectDataSource Named CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image7.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image6.png)</span></span>

<span data-ttu-id="10e92-135">**Рис. 4**: Добавить новый элемент управления ObjectDataSource с именем `CategoriesDataSource` ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="10e92-135">**Figure 4**: Add a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image8.png))</span></span>


<span data-ttu-id="10e92-136">Настройка нового ObjectDataSource, таким образом, он вызывает `CategoriesBLL` класса `GetCategories()` метод.</span><span class="sxs-lookup"><span data-stu-id="10e92-136">Configure the new ObjectDataSource such that it invokes the `CategoriesBLL` class's `GetCategories()` method.</span></span> <span data-ttu-id="10e92-137">После настройки ObjectDataSource все равно небходимо указать поле источника данных, которые должны отображаться в DropDownList, а какие должно быть связано в качестве значения для каждого элемента списка.</span><span class="sxs-lookup"><span data-stu-id="10e92-137">After configuring the ObjectDataSource we still need to specify what data source field should be displayed in the DropDownList and which one should be associated as the value for each list item.</span></span> <span data-ttu-id="10e92-138">У `CategoryName` как отображение и `CategoryID` как значение для каждого элемента списка.</span><span class="sxs-lookup"><span data-stu-id="10e92-138">Have the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>


<span data-ttu-id="10e92-139">[![Иметь элемент управления DropDownList отображает поле «Категория» и CategoryID использовать как значение](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image10.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="10e92-139">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image10.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image9.png)</span></span>

<span data-ttu-id="10e92-140">**Рис. 5**: Иметь элемент управления DropDownList отображает `CategoryName` и использует `CategoryID` как значение ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="10e92-140">**Figure 5**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image11.png))</span></span>


<span data-ttu-id="10e92-141">На этом этапе у нас есть элемент управления DropDownList, заполненный записями из `Categories` (все действия выполняются приблизительно за шесть секунд).</span><span class="sxs-lookup"><span data-stu-id="10e92-141">At this point we have a DropDownList control that's populated with the records from the `Categories` table (all accomplished in about six seconds).</span></span> <span data-ttu-id="10e92-142">Рис. 6 показаны до сих при просмотре через браузер.</span><span class="sxs-lookup"><span data-stu-id="10e92-142">Figure 6 shows our progress thus far when viewed through a browser.</span></span>


<span data-ttu-id="10e92-143">[![Раскрывающийся список с текущими категориями](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image13.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="10e92-143">[![A Drop-Down Lists the Current Categories](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image13.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image12.png)</span></span>

<span data-ttu-id="10e92-144">**Рис. 6**: Раскрывающийся список текущих категорий ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="10e92-144">**Figure 6**: A Drop-Down Lists the Current Categories ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image14.png))</span></span>


## <a name="step-2-adding-the-products-datalist"></a><span data-ttu-id="10e92-145">Шаг 2. Добавление элементов управления DataList продуктов</span><span class="sxs-lookup"><span data-stu-id="10e92-145">Step 2: Adding the Products DataList</span></span>

<span data-ttu-id="10e92-146">Последний шаг в нашем отчете «основной/подробности» является отображение списка продуктов, связанных с выбранной категорией.</span><span class="sxs-lookup"><span data-stu-id="10e92-146">The last step in our master/detail report is to list the products associated with the selected category.</span></span> <span data-ttu-id="10e92-147">Для этого добавьте на страницу элемент управления DataList и создайте новый ObjectDataSource, именуемый `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="10e92-147">To accomplish this, add a DataList to the page and create a new ObjectDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="10e92-148">У `ProductsByCategoryDataSource` получит свои данные из `ProductsBLL` класса `GetProductsByCategoryID(categoryID)` метод.</span><span class="sxs-lookup"><span data-stu-id="10e92-148">Have the `ProductsByCategoryDataSource` control retrieve its data from the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="10e92-149">Так как этот отчет «основной/подробности» доступна только для чтения, выберите параметр (нет) на вкладках INSERT, UPDATE и DELETE.</span><span class="sxs-lookup"><span data-stu-id="10e92-149">Since this master/detail report is read-only, choose the (None) option in the INSERT, UPDATE, and DELETE tabs.</span></span>


<span data-ttu-id="10e92-150">[![Выберите метод GetProductsByCategoryID(categoryID)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image16.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="10e92-150">[![Select the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image16.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image15.png)</span></span>

<span data-ttu-id="10e92-151">**Рис. 7**: Выберите `GetProductsByCategoryID(categoryID)` метод ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="10e92-151">**Figure 7**: Select the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image17.png))</span></span>


<span data-ttu-id="10e92-152">После нажатия кнопки Далее, мастер ObjectDataSource запрашивает значения для источника `GetProductsByCategoryID(categoryID)` метода *`categoryID`* параметра.</span><span class="sxs-lookup"><span data-stu-id="10e92-152">After clicking Next, the ObjectDataSource wizard prompts us for the source of the value for the `GetProductsByCategoryID(categoryID)` method's *`categoryID`* parameter.</span></span> <span data-ttu-id="10e92-153">Чтобы использовать значение выбранного `categories` элемент DropDownList источника параметра установите для элемента управления, а для ControlID – `Categories`.</span><span class="sxs-lookup"><span data-stu-id="10e92-153">To use the value of the selected `categories` DropDownList item set the Parameter source to Control and the ControlID to `Categories`.</span></span>


<span data-ttu-id="10e92-154">[![Значение параметра categoryID значение DropDownList категорий](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image19.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="10e92-154">[![Set the categoryID Parameter to the Value of the Categories DropDownList](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image19.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image18.png)</span></span>

<span data-ttu-id="10e92-155">**Рис. 8**: Задайте *`categoryID`* параметр значению `Categories` DropDownList ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="10e92-155">**Figure 8**: Set the *`categoryID`* Parameter to the Value of the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image20.png))</span></span>


<span data-ttu-id="10e92-156">После завершения работы мастера настройки источника данных, Visual Studio автоматически создаст `ItemTemplate` элемента управления DataList, отображающий имя и значение каждого поля данных.</span><span class="sxs-lookup"><span data-stu-id="10e92-156">Upon completing the Configure Data Source wizard, Visual Studio will automatically generate an `ItemTemplate` for the DataList that displays the name and value of each data field.</span></span> <span data-ttu-id="10e92-157">Давайте улучшим элемент управления DataList, чтобы вместо этого использовать `ItemTemplate` , отображающий только название продукта, категории, поставщика, количество в единицах измерения и цену, вместе с `SeparatorTemplate` , вводящим `<hr>` между вышеуказанными элементами.</span><span class="sxs-lookup"><span data-stu-id="10e92-157">Let's enhance the DataList to instead use an `ItemTemplate` that displays just the product's name, category, supplier, quantity per unit, and price along with a `SeparatorTemplate` that injects an `<hr>` element between each item.</span></span> <span data-ttu-id="10e92-158">Я буду использовать `ItemTemplate` из примера в [отображение данных с помощью элементов управления DataList и Repeater](../displaying-data-with-the-datalist-and-repeater/displaying-data-with-the-datalist-and-repeater-controls-vb.md) руководство, но вы можете использовать любые разметку шаблона, вы кажется наиболее визуально привлекательной.</span><span class="sxs-lookup"><span data-stu-id="10e92-158">I'm going to use the `ItemTemplate` from an example in the [Displaying Data with the DataList and Repeater Controls](../displaying-data-with-the-datalist-and-repeater/displaying-data-with-the-datalist-and-repeater-controls-vb.md) tutorial, but feel free to use whatever template markup you find most visually appealing.</span></span>

<span data-ttu-id="10e92-159">После внесения этих изменений, DataList и его ObjectDataSource разметки должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="10e92-159">After making these changes, your DataList and its ObjectDataSource's markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-datalist-vb/samples/sample2.aspx)]

<span data-ttu-id="10e92-160">Отвлекитесь и просмотрите ход работы в браузере.</span><span class="sxs-lookup"><span data-stu-id="10e92-160">Take a moment to check out our progress in a browser.</span></span> <span data-ttu-id="10e92-161">При первом просмотре странице, продукты, принадлежащие к выбранной категории (Напитки) отображаются (как показано на рис. 9), но изменения в элемент управления DropDownList данные не обновляются.</span><span class="sxs-lookup"><span data-stu-id="10e92-161">When first visiting the page, those products belonging to the selected category (Beverages) are displayed (as shown in Figure 9), but changing the DropDownList doesn't update the data.</span></span> <span data-ttu-id="10e92-162">Это обусловлено тем, для обновления элемента управления DataList необходимо осуществление обратной передачи.</span><span class="sxs-lookup"><span data-stu-id="10e92-162">This is because a postback must occur for the DataList to update.</span></span> <span data-ttu-id="10e92-163">Для этого мы можем либо задать DropDownList `AutoPostBack` свойства `true` или добавить кнопку веб-элемент управления на страницу.</span><span class="sxs-lookup"><span data-stu-id="10e92-163">To accomplish this we can either set the DropDownList's `AutoPostBack` property to `true` or add a Button Web control to the page.</span></span> <span data-ttu-id="10e92-164">В этом учебнике я выбрал установку DropDownList `AutoPostBack` свойства `true`.</span><span class="sxs-lookup"><span data-stu-id="10e92-164">For this tutorial, I've opted to set the DropDownList's `AutoPostBack` property to `true`.</span></span>

<span data-ttu-id="10e92-165">На рис. 9 и 10 показана работа отчета «основной/подробности» в действии.</span><span class="sxs-lookup"><span data-stu-id="10e92-165">Figures 9 and 10 illustrate the master/detail report in action.</span></span>


<span data-ttu-id="10e92-166">[![При первом просмотре странице отображаются продукты отображаются](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image22.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="10e92-166">[![When First Visiting the Page, the Beverage Products are Displayed](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image22.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image21.png)</span></span>

<span data-ttu-id="10e92-167">**Рис. 9**: При первом просмотре странице отображаются продукты отображаются ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="10e92-167">**Figure 9**: When First Visiting the Page, the Beverage Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image23.png))</span></span>


<span data-ttu-id="10e92-168">[![Выбор нового продукта (Produce) автоматически вызывает обратную передачу, обновляется элемент управления DataList](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image25.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="10e92-168">[![Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the DataList](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image25.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image24.png)</span></span>

<span data-ttu-id="10e92-169">**Рис. 10**: Выбор нового продукта (Produce) автоматически вызывает обратную передачу, обновляется элемент управления DataList ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="10e92-169">**Figure 10**: Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the DataList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image26.png))</span></span>


## <a name="adding-a----choose-a-category----list-item"></a><span data-ttu-id="10e92-170">Добавление элемента списка «--выберите категорию--»</span><span class="sxs-lookup"><span data-stu-id="10e92-170">Adding a "-- Choose a Category --" List Item</span></span>

<span data-ttu-id="10e92-171">При первом просмотре `FilterByDropDownList.aspx` странице первый элемент списка DropDownList (Напитки) выбран по умолчанию, показывающие в DataList отображаются продукты категории.</span><span class="sxs-lookup"><span data-stu-id="10e92-171">When first visiting the `FilterByDropDownList.aspx` page the categories DropDownList's first list item (Beverages) is selected by default, showing the beverage products in the DataList.</span></span> <span data-ttu-id="10e92-172">В *"основной/подробности" Фильтрация с помощью элемента управления DropDownList* руководстве, мы добавили параметр «--выберите категорию--» в элемент управления DropDownList, которое был выбран по умолчанию и, при выборе выводится *все* из продукты в базе данных.</span><span class="sxs-lookup"><span data-stu-id="10e92-172">In the *Master/Detail Filtering With a DropDownList* tutorial we added a "-- Choose a Category --" option to the DropDownList that was selected by default and, when selected, displayed *all* of the products in the database.</span></span> <span data-ttu-id="10e92-173">Такой подход был управляем при выводе продуктов в элементе управления GridView, как каждый продукт занимал малого объема пространства экрана.</span><span class="sxs-lookup"><span data-stu-id="10e92-173">Such an approach was manageable when listing the products in a GridView, as each product row took up a small amount of screen real estate.</span></span> <span data-ttu-id="10e92-174">Элемент управления DataList Однако сведения о каждом продукте занимает гораздо больший кусок экрана.</span><span class="sxs-lookup"><span data-stu-id="10e92-174">With the DataList, however, each product's information consumes a much larger chunk of the screen.</span></span> <span data-ttu-id="10e92-175">Давайте по-прежнему добавьте пункт «--выберите категорию--» и установите его включенным по умолчанию, но вместо показа всех продуктов при выборе, настройте его таким образом, чтобы он показывал бы продукты.</span><span class="sxs-lookup"><span data-stu-id="10e92-175">Let's still add a "-- Choose a Category --" option and have it selected by default, but instead of having it show all products when selected, let's configure it so that it shows no products.</span></span>

<span data-ttu-id="10e92-176">Чтобы добавить новый элемент списка DropDownList, перейдите в окно свойств и щелкните эллипсы в `Items` свойство.</span><span class="sxs-lookup"><span data-stu-id="10e92-176">To add a new list item to the DropDownList, go to the Properties window and click on the ellipses in the `Items` property.</span></span> <span data-ttu-id="10e92-177">Добавить новый элемент списка с `Text` «--выберите категорию--» и `Value` `0`.</span><span class="sxs-lookup"><span data-stu-id="10e92-177">Add a new list item with the `Text` "-- Choose a Category --" and the `Value` `0`.</span></span>


![Добавить](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image27.png)

<span data-ttu-id="10e92-179">**Рис. 11**: Добавление элемента списка «--выберите категорию--»</span><span class="sxs-lookup"><span data-stu-id="10e92-179">**Figure 11**: Add a "-- Choose a Category --" List Item</span></span>


<span data-ttu-id="10e92-180">Кроме того можно добавить элемент списка, добавив следующую разметку в элемент управления DropDownList:</span><span class="sxs-lookup"><span data-stu-id="10e92-180">Alternatively, you can add the list item by adding the following markup to the DropDownList:</span></span>

[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-datalist-vb/samples/sample3.aspx)]

<span data-ttu-id="10e92-181">Кроме того, нам нужно установить элемент управления DropDownList `AppendDataBoundItems` для `true` потому что если он становится равным `false` (по умолчанию), при привязке категорий к DropDownList из ObjectDataSource они будут перезаписывать все списки, добавленные вручную элементы.</span><span class="sxs-lookup"><span data-stu-id="10e92-181">Additionally, we need to set the DropDownList control's `AppendDataBoundItems` to `true` because if it's set to `false` (the default), when the categories are bound to the DropDownList from the ObjectDataSource they'll overwrite any manually-added list items.</span></span>


![Установите для свойства AppendDataBoundItems значение true](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image28.png)

<span data-ttu-id="10e92-183">**Рис. 12**: Задайте `AppendDataBoundItems` присваивается значение True</span><span class="sxs-lookup"><span data-stu-id="10e92-183">**Figure 12**: Set the `AppendDataBoundItems` Property to True</span></span>


<span data-ttu-id="10e92-184">Причина, по значение `0` для списка «--выберите категорию--» элемента обеспечивается, так как в системе со значением категории не `0`, поэтому записи не продукта будет возвращаться при выборе элемента списка «--выберите категорию--».</span><span class="sxs-lookup"><span data-stu-id="10e92-184">The reason we chose the value `0` for the "-- Choose a Category --" list item is because there are no categories in the system with a value of `0`, hence no product records will be returned when the "-- Choose a Category --" list item is selected.</span></span> <span data-ttu-id="10e92-185">Чтобы проверить это, Отвлекитесь и чтобы перейти на страницу через обозреватель.</span><span class="sxs-lookup"><span data-stu-id="10e92-185">To confirm this, take a moment to visit the page through a browser.</span></span> <span data-ttu-id="10e92-186">Как показано на рисунке 13, при первоначальном просмотре страницы выбран элемент списка «--выберите категорию--» продукты не отображаются.</span><span class="sxs-lookup"><span data-stu-id="10e92-186">As Figure 13 shows, when initially viewing the page the "-- Choose a Category --" list item is selected and no products are displayed.</span></span>


<span data-ttu-id="10e92-187">[![Когда](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image30.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="10e92-187">[![When the](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image30.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image29.png)</span></span>

<span data-ttu-id="10e92-188">**Рис. 13**: При выборе элемента списка «--выберите категорию--» продукты не отображаются ([Просмотр полноразмерного изображения](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="10e92-188">**Figure 13**: When the "-- Choose a Category --" List Item is Selected, No Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image31.png))</span></span>


<span data-ttu-id="10e92-189">Если предпочтительнее отобразить *все* продуктов, при выборе параметра «--выберите категорию--», используйте значение `-1` вместо этого.</span><span class="sxs-lookup"><span data-stu-id="10e92-189">If you'd rather display *all* of the products when the "-- Choose a Category --" option is selected, use a value of `-1` instead.</span></span> <span data-ttu-id="10e92-190">Внимательный читатель, наверное, помните, назад в *"основной/подробности" Фильтрация с помощью элемента управления DropDownList* руководстве, мы обновили `ProductsBLL` класса `GetProductsByCategoryID(categoryID)` метод таким образом, если *`categoryID`* значение `-1` был передан в всех продуктов, возвращенных записей.</span><span class="sxs-lookup"><span data-stu-id="10e92-190">The astute reader will recall that back in the *Master/Detail Filtering With a DropDownList* tutorial we updated the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method so that if a *`categoryID`* value of `-1` was passed in, all product records were returned.</span></span>

## <a name="summary"></a><span data-ttu-id="10e92-191">Сводка</span><span class="sxs-lookup"><span data-stu-id="10e92-191">Summary</span></span>

<span data-ttu-id="10e92-192">При отображении иерархически связанных данных часто полезно представлять данные с помощью отчетов «основной/подробности», из которых пользователь может начать изучение данных в верхней части иерархии и перейти к подробным сведениям.</span><span class="sxs-lookup"><span data-stu-id="10e92-192">When displaying hierarchically-related data, it often helps to present the data using master/detail reports, from which the user can start perusing the data from the top of the hierarchy and drill down into details.</span></span> <span data-ttu-id="10e92-193">В этом руководстве было рассмотрено создание "основной/подробности" простой отчет, показывающий продукты выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="10e92-193">In this tutorial we examined building a simple master/detail report showing a selected category's products.</span></span> <span data-ttu-id="10e92-194">Это осуществлялось с помощью элемента управления DropDownList для списка категорий и DataList для продуктов, принадлежащих выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="10e92-194">This was accomplished by using a DropDownList for the list of categories and a DataList for the products belonging to the selected category.</span></span>

<span data-ttu-id="10e92-195">В следующем учебном курсе мы рассмотрим разделение записей на двух страницах.</span><span class="sxs-lookup"><span data-stu-id="10e92-195">In the next tutorial we'll look at separating the master and details records across two pages.</span></span> <span data-ttu-id="10e92-196">На первой странице список «основных» записей будет отображаться со ссылкой для получения сведений.</span><span class="sxs-lookup"><span data-stu-id="10e92-196">In the first page, a list of "master" records will be displayed, with a link to view the details.</span></span> <span data-ttu-id="10e92-197">Щелчок ссылки перенесет пользователя на вторую страницу, который будет отображать подробные сведения о выбранной основной записи.</span><span class="sxs-lookup"><span data-stu-id="10e92-197">Clicking on the link will whisk the user to the second page, which will display the details for the selected master record.</span></span>

<span data-ttu-id="10e92-198">Счастливого вам программирования!</span><span class="sxs-lookup"><span data-stu-id="10e92-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="10e92-199">Об авторе</span><span class="sxs-lookup"><span data-stu-id="10e92-199">About the Author</span></span>

<span data-ttu-id="10e92-200">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP.NET и основатель веб- [4GuysFromRolla.com](http://www.4guysfromrolla.com), работает с веб-технологиями Microsoft с 1998 года.</span><span class="sxs-lookup"><span data-stu-id="10e92-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="10e92-201">Скотт — независимый консультант, преподаватель и автор.</span><span class="sxs-lookup"><span data-stu-id="10e92-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="10e92-202">Его последняя книга — [ *Sams Teach ASP.NET 2.0 in 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="10e92-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="10e92-203">Ним можно связаться по адресу [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="10e92-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="10e92-204">или через его блог, который можно найти в [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="10e92-204">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="10e92-205">Особая благодарность</span><span class="sxs-lookup"><span data-stu-id="10e92-205">Special Thanks To…</span></span>

<span data-ttu-id="10e92-206">В этой серии руководств пособий рецензировалась многими компетентными редакторами.</span><span class="sxs-lookup"><span data-stu-id="10e92-206">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="10e92-207">Основной рецензент этого учебного Рэнди Шмидт.</span><span class="sxs-lookup"><span data-stu-id="10e92-207">Lead reviewer for this tutorial was Randy Schmidt.</span></span> <span data-ttu-id="10e92-208">Хотите поработать с моих последующих статей для MSDN?</span><span class="sxs-lookup"><span data-stu-id="10e92-208">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="10e92-209">Если Да, напишите мне [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="10e92-209">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="10e92-210">[Назад](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md)
> [Вперед](master-detail-filtering-acess-two-pages-datalist-vb.md)</span><span class="sxs-lookup"><span data-stu-id="10e92-210">[Previous](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md)
[Next](master-detail-filtering-acess-two-pages-datalist-vb.md)</span></span>
