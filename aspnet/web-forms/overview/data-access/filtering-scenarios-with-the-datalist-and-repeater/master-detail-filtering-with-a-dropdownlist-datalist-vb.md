---
uid: web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-with-a-dropdownlist-datalist-vb
title: Фильтрация "основной/подробности" с помощью DropDownList (VB) | Документация Майкрософт
author: rick-anderson
description: В этом учебнике показано, как отобразить отчеты "основной/подробности" на одной веб-странице с помощью элементов управления DropDownList, чтобы отобразить записи "Master" и DataList для отображения...
ms.author: riande
ms.date: 07/18/2007
ms.assetid: ad0f1014-1eff-465f-bdc6-93058de00e44
msc.legacyurl: /web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-with-a-dropdownlist-datalist-vb
msc.type: authoredcontent
ms.openlocfilehash: 537f8e76bc0cbfa759a014b63ae5f68b5d3ca64d
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78491088"
---
# <a name="masterdetail-filtering-with-a-dropdownlist-vb"></a><span data-ttu-id="58701-103">Фильтрация "Основной/подробности" с помощью элемента управления DropDownList (VB)</span><span class="sxs-lookup"><span data-stu-id="58701-103">Master/Detail Filtering With a DropDownList (VB)</span></span>

<span data-ttu-id="58701-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="58701-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="58701-105">[Скачивание примера приложения](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_33_VB.exe) или [Загрузка PDF-файла](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/datatutorial33vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="58701-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_33_VB.exe) or [Download PDF](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/datatutorial33vb1.pdf)</span></span>

> <span data-ttu-id="58701-106">В этом учебнике показано, как отображать отчеты «основной/подробности» на одной веб-странице с помощью элементов управления DropDownList для отображения «главных» записей и элементов управления DataList для отображения «сведений».</span><span class="sxs-lookup"><span data-stu-id="58701-106">In this tutorial we see how to display master/detail reports in a single web page using DropDownLists to display the "master" records and a DataList to display the "details".</span></span>

## <a name="introduction"></a><span data-ttu-id="58701-107">Введение</span><span class="sxs-lookup"><span data-stu-id="58701-107">Introduction</span></span>

<span data-ttu-id="58701-108">Отчет "основной/подробности", который сначала был создан с помощью GridView в предыдущей [фильтрации "основной/подробности" с помощью DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) , начинается с отображения некоторого набора "основных" записей.</span><span class="sxs-lookup"><span data-stu-id="58701-108">The master/detail report, which we first created using a GridView in the earlier [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial, begins by showing some set of "master" records.</span></span> <span data-ttu-id="58701-109">Затем пользователь может выполнить детализацию до одной из основных записей, тем самым просмотрев сведения о главной записи.</span><span class="sxs-lookup"><span data-stu-id="58701-109">The user can then drill down into one of the master records, thereby viewing that master record's "details."</span></span> <span data-ttu-id="58701-110">Отчеты «основной/подробности» являются идеальным выбором для визуализации связей «один-ко-многим» и для отображения подробных сведений из особенно «широких» таблиц (тех, которые содержат большое количество столбцов).</span><span class="sxs-lookup"><span data-stu-id="58701-110">Master/detail reports are an ideal choice for visualizing one-to-many relationships and for displaying detailed information from particularly "wide" tables (ones that have a lot of columns).</span></span> <span data-ttu-id="58701-111">Мы изучили, как реализовать отчеты «основной/подробности» с помощью элементов управления GridView и DetailsView в предыдущих руководствах.</span><span class="sxs-lookup"><span data-stu-id="58701-111">We've explored how to implement master/detail reports using the GridView and DetailsView controls in previous tutorials.</span></span> <span data-ttu-id="58701-112">В этом руководстве и двух следующих примерах мы будем пересмотреть эти концепции, но сосредоточиться на использовании элементов управления DataList и Repeater.</span><span class="sxs-lookup"><span data-stu-id="58701-112">In this tutorial and the next two, we'll reexamine these concepts, but focus on using DataList and Repeater controls instead.</span></span>

<span data-ttu-id="58701-113">В этом учебнике мы рассмотрим использование DropDownList для размещения записей «Master» с записями «Details», отображаемыми в DataList.</span><span class="sxs-lookup"><span data-stu-id="58701-113">In this tutorial, we'll look at using a DropDownList to contain the "master" records, with the "details" records displayed in a DataList.</span></span>

## <a name="step-1-adding-the-masterdetail-tutorial-web-pages"></a><span data-ttu-id="58701-114">Шаг 1. Добавление веб-страниц учебника "основной/подробности"</span><span class="sxs-lookup"><span data-stu-id="58701-114">Step 1: Adding the Master/Detail Tutorial Web Pages</span></span>

<span data-ttu-id="58701-115">Прежде чем приступить к работе с этим руководством, сначала нужно добавить папку и ASP.NET страницы, которые понадобятся для работы с этим руководством, и два следующих действия с отчетами «основной/подробности» с помощью элементов управления DataList и Repeater.</span><span class="sxs-lookup"><span data-stu-id="58701-115">Before we start this tutorial, let's first take a moment to add the folder and ASP.NET pages we'll need for this tutorial and the next two dealing with master/detail reports using the DataList and Repeater controls.</span></span> <span data-ttu-id="58701-116">Начните с создания новой папки в проекте с именем `DataListRepeaterFiltering`.</span><span class="sxs-lookup"><span data-stu-id="58701-116">Start by creating a new folder in the project named `DataListRepeaterFiltering`.</span></span> <span data-ttu-id="58701-117">Затем добавьте в эту папку следующие пять страниц ASP.NET, чтобы все они были настроены для использования главной страницы `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="58701-117">Next, add the following five ASP.NET pages to this folder, having all of them configured to use the master page `Site.master`:</span></span>

- `Default.aspx`
- `FilterByDropDownList.aspx`
- `CategoryListMaster.aspx`
- `ProductsForCategoryDetails.aspx`
- `CategoriesAndProducts.aspx`

![Создание папки DataListRepeaterFiltering и добавление страниц Tutorial ASP.NET](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image1.png)

<span data-ttu-id="58701-119">**Рис. 1**. Создание `DataListRepeaterFiltering` папки и добавление страниц Tutorial ASP.NET</span><span class="sxs-lookup"><span data-stu-id="58701-119">**Figure 1**: Create a `DataListRepeaterFiltering` Folder and Add the Tutorial ASP.NET Pages</span></span>

<span data-ttu-id="58701-120">Затем откройте страницу `Default.aspx` и перетащите `SectionLevelTutorialListing.ascx` пользовательский элемент управления из папки `UserControls` в область конструктора.</span><span class="sxs-lookup"><span data-stu-id="58701-120">Next, open the `Default.aspx` page and drag the `SectionLevelTutorialListing.ascx` User Control from the `UserControls` folder onto the Design surface.</span></span> <span data-ttu-id="58701-121">Этот пользовательский элемент управления, созданный в учебнике « [главные страницы и Навигация по узлу](../introduction/master-pages-and-site-navigation-vb.md) », перечисляет карту узла и отображает учебники из текущего раздела в маркированном списке.</span><span class="sxs-lookup"><span data-stu-id="58701-121">This User Control, which we created in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-vb.md) tutorial, enumerates the site map and displays the tutorials from the current section in a bulleted list.</span></span>

<span data-ttu-id="58701-122">[![добавить пользовательский элемент управления SectionLevelTutorialListing. ascx в Default. aspx](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image3.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="58701-122">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image3.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image2.png)</span></span>

<span data-ttu-id="58701-123">**Рис. 2**. Добавление пользовательского элемента управления `SectionLevelTutorialListing.ascx` в `Default.aspx` ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="58701-123">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image4.png))</span></span>

<span data-ttu-id="58701-124">Чтобы в маркированном списке отображались основные и подробные учебники, которые будут созданы, необходимо добавить их на карту узла.</span><span class="sxs-lookup"><span data-stu-id="58701-124">In order to have the bulleted list display the master/detail tutorials we'll be creating, we need to add them to the site map.</span></span> <span data-ttu-id="58701-125">Откройте файл `Web.sitemap` и добавьте следующую разметку после разметки узла "Отображение данных с помощью DataList и Repeater".</span><span class="sxs-lookup"><span data-stu-id="58701-125">Open the `Web.sitemap` file and add the following markup after the "Displaying Data with the DataList and Repeater" site map node markup:</span></span>

[!code-xml[Main](master-detail-filtering-with-a-dropdownlist-datalist-vb/samples/sample1.xml)]

![Обновление схемы узла для включения новых страниц ASP.NET](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image5.png)

<span data-ttu-id="58701-127">**Рис. 3**. обновление схемы узла для включения новых страниц ASP.NET</span><span class="sxs-lookup"><span data-stu-id="58701-127">**Figure 3**: Update the Site Map to Include the New ASP.NET Pages</span></span>

## <a name="step-2-displaying-the-categories-in-a-dropdownlist"></a><span data-ttu-id="58701-128">Шаг 2. Отображение категорий в DropDownList</span><span class="sxs-lookup"><span data-stu-id="58701-128">Step 2: Displaying the Categories in a DropDownList</span></span>

<span data-ttu-id="58701-129">В нашем отчете «основной/подробности» будут перечислены категории в DropDownList, а продукты выбранного элемента списка отображаются на странице в элементе управления DataList.</span><span class="sxs-lookup"><span data-stu-id="58701-129">Our master/detail report will list the categories in a DropDownList, with the selected list item's products displayed further down in the page in a DataList.</span></span> <span data-ttu-id="58701-130">Первая задача, предшествующая нам, заключается в том, чтобы отобразить категории в DropDownList.</span><span class="sxs-lookup"><span data-stu-id="58701-130">The first task ahead of us, then, is to have the categories displayed in a DropDownList.</span></span> <span data-ttu-id="58701-131">Для начала откройте страницу `FilterByDropDownList.aspx` в папке `DataListRepeaterFiltering` и перетащите DropDownList с панели элементов на конструктор страницы.</span><span class="sxs-lookup"><span data-stu-id="58701-131">Start by opening the `FilterByDropDownList.aspx` page in the `DataListRepeaterFiltering` folder and drag a DropDownList from the Toolbox onto the page's designer.</span></span> <span data-ttu-id="58701-132">Затем присвойте свойству `ID` DropDownList значение `Categories`.</span><span class="sxs-lookup"><span data-stu-id="58701-132">Next, set the DropDownList's `ID` property to `Categories`.</span></span> <span data-ttu-id="58701-133">Щелкните ссылку Выбор источника данных из смарт-тега DropDownList и создайте новый элемент управления ObjectDataSource с именем `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="58701-133">Click on the Choose Data Source link from the DropDownList's smart tag and create a new ObjectDataSource named `CategoriesDataSource`.</span></span>

<span data-ttu-id="58701-134">[![добавить новый элемент управления ObjectDataSource с именем CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image7.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="58701-134">[![Add a New ObjectDataSource Named CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image7.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image6.png)</span></span>

<span data-ttu-id="58701-135">**Рис. 4**. Добавление нового элемента управления ObjectDataSource с именем `CategoriesDataSource` ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="58701-135">**Figure 4**: Add a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image8.png))</span></span>

<span data-ttu-id="58701-136">Настройте новый элемент ObjectDataSource таким способом, чтобы он вызывал метод `GetCategories()` класса `CategoriesBLL`.</span><span class="sxs-lookup"><span data-stu-id="58701-136">Configure the new ObjectDataSource such that it invokes the `CategoriesBLL` class's `GetCategories()` method.</span></span> <span data-ttu-id="58701-137">После настройки ObjectDataSource необходимо указать поле источника данных, которое должно быть отображено в элементе управления DropDownList, а также связать его со значением для каждого элемента списка.</span><span class="sxs-lookup"><span data-stu-id="58701-137">After configuring the ObjectDataSource we still need to specify what data source field should be displayed in the DropDownList and which one should be associated as the value for each list item.</span></span> <span data-ttu-id="58701-138">По`CategoryName` поле в качестве отображаемого и `CategoryID` в качестве значения для каждого элемента списка.</span><span class="sxs-lookup"><span data-stu-id="58701-138">Have the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>

<span data-ttu-id="58701-139">[![отображать поле CategoryName и использовать CategoryID в качестве значения](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image10.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="58701-139">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image10.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image9.png)</span></span>

<span data-ttu-id="58701-140">**Рис. 5**. отображение поля `CategoryName` в DropDownList и использование `CategoryID` в качестве значения ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="58701-140">**Figure 5**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image11.png))</span></span>

<span data-ttu-id="58701-141">На этом этапе у нас есть элемент управления DropDownList, который заполняется записями из таблицы `Categories` (все это выполняется около шести секунд).</span><span class="sxs-lookup"><span data-stu-id="58701-141">At this point we have a DropDownList control that's populated with the records from the `Categories` table (all accomplished in about six seconds).</span></span> <span data-ttu-id="58701-142">На рис. 6 показан ход работы в браузере.</span><span class="sxs-lookup"><span data-stu-id="58701-142">Figure 6 shows our progress thus far when viewed through a browser.</span></span>

<span data-ttu-id="58701-143">[![раскрывающийся список с текущими категориями](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image13.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="58701-143">[![A Drop-Down Lists the Current Categories](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image13.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image12.png)</span></span>

<span data-ttu-id="58701-144">**Рис. 6**. раскрывающийся список с текущими категориями ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="58701-144">**Figure 6**: A Drop-Down Lists the Current Categories ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image14.png))</span></span>

## <a name="step-2-adding-the-products-datalist"></a><span data-ttu-id="58701-145">Шаг 2. Добавление элемента управления DataList для продуктов</span><span class="sxs-lookup"><span data-stu-id="58701-145">Step 2: Adding the Products DataList</span></span>

<span data-ttu-id="58701-146">Последним шагом в нашем отчете «основной/подробности» является отображение списка продуктов, связанных с выбранной категорией.</span><span class="sxs-lookup"><span data-stu-id="58701-146">The last step in our master/detail report is to list the products associated with the selected category.</span></span> <span data-ttu-id="58701-147">Для этого добавьте на страницу элемент управления DataList и создайте новый элемент ObjectDataSource с именем `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="58701-147">To accomplish this, add a DataList to the page and create a new ObjectDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="58701-148">Элементы управления `ProductsByCategoryDataSource` извлекают свои данные из метода `GetProductsByCategoryID(categoryID)` класса `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="58701-148">Have the `ProductsByCategoryDataSource` control retrieve its data from the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="58701-149">Поскольку этот отчет «основной/подробности» доступен только для чтения, выберите параметр (нет) на вкладках Вставка, обновление и удаление.</span><span class="sxs-lookup"><span data-stu-id="58701-149">Since this master/detail report is read-only, choose the (None) option in the INSERT, UPDATE, and DELETE tabs.</span></span>

<span data-ttu-id="58701-150">[![выбрать метод GetProductsByCategoryID (КодТипа)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image16.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="58701-150">[![Select the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image16.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image15.png)</span></span>

<span data-ttu-id="58701-151">**Рис. 7**. выбор метода `GetProductsByCategoryID(categoryID)` ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="58701-151">**Figure 7**: Select the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image17.png))</span></span>

<span data-ttu-id="58701-152">После нажатия кнопки Далее мастер ObjectDataSource запрашивает источник значения для параметра *`categoryID`* метода `GetProductsByCategoryID(categoryID)`.</span><span class="sxs-lookup"><span data-stu-id="58701-152">After clicking Next, the ObjectDataSource wizard prompts us for the source of the value for the `GetProductsByCategoryID(categoryID)` method's *`categoryID`* parameter.</span></span> <span data-ttu-id="58701-153">Чтобы использовать значение выбранного элемента DropDownList `categories`, установите источник параметра в значение Control, а для ControlID — значение `Categories`.</span><span class="sxs-lookup"><span data-stu-id="58701-153">To use the value of the selected `categories` DropDownList item set the Parameter source to Control and the ControlID to `Categories`.</span></span>

<span data-ttu-id="58701-154">[![задать для параметра categoryID значение элемента DropDownList категорий](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image19.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="58701-154">[![Set the categoryID Parameter to the Value of the Categories DropDownList](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image19.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image18.png)</span></span>

<span data-ttu-id="58701-155">**Рис. 8**. Установка для параметра *`categoryID`* значения `Categories` DropDownList ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="58701-155">**Figure 8**: Set the *`categoryID`* Parameter to the Value of the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image20.png))</span></span>

<span data-ttu-id="58701-156">После завершения работы мастера настройки источника данных Visual Studio автоматически создаст `ItemTemplate` для элемента управления DataList, отображающего имя и значение каждого поля данных.</span><span class="sxs-lookup"><span data-stu-id="58701-156">Upon completing the Configure Data Source wizard, Visual Studio will automatically generate an `ItemTemplate` for the DataList that displays the name and value of each data field.</span></span> <span data-ttu-id="58701-157">Попробуем вместо этого использовать `ItemTemplate`, отображающий только название продукта, категорию, поставщика, количество на единицу и цену, а также `SeparatorTemplate`, которая вставляет элемент `<hr>` между каждым элементом.</span><span class="sxs-lookup"><span data-stu-id="58701-157">Let's enhance the DataList to instead use an `ItemTemplate` that displays just the product's name, category, supplier, quantity per unit, and price along with a `SeparatorTemplate` that injects an `<hr>` element between each item.</span></span> <span data-ttu-id="58701-158">Я буду использовать `ItemTemplate` из примера в руководстве по [отображению данных с помощью элементов управления DataList и Repeater](../displaying-data-with-the-datalist-and-repeater/displaying-data-with-the-datalist-and-repeater-controls-vb.md) , но вы можете использовать любую разметку шаблона, которая наиболее наглядна.</span><span class="sxs-lookup"><span data-stu-id="58701-158">I'm going to use the `ItemTemplate` from an example in the [Displaying Data with the DataList and Repeater Controls](../displaying-data-with-the-datalist-and-repeater/displaying-data-with-the-datalist-and-repeater-controls-vb.md) tutorial, but feel free to use whatever template markup you find most visually appealing.</span></span>

<span data-ttu-id="58701-159">После внесения этих изменений элемент управления DataList и его разметка ObjectDataSource должны выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="58701-159">After making these changes, your DataList and its ObjectDataSource's markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-datalist-vb/samples/sample2.aspx)]

<span data-ttu-id="58701-160">Уделите немного времени для проверки хода выполнения в браузере.</span><span class="sxs-lookup"><span data-stu-id="58701-160">Take a moment to check out our progress in a browser.</span></span> <span data-ttu-id="58701-161">При первом посещении страницы отображаются продукты, принадлежащие выбранной категории (напитки) (как показано на рис. 9), но изменение DropDownList не приводит к обновлению данных.</span><span class="sxs-lookup"><span data-stu-id="58701-161">When first visiting the page, those products belonging to the selected category (Beverages) are displayed (as shown in Figure 9), but changing the DropDownList doesn't update the data.</span></span> <span data-ttu-id="58701-162">Это связано с тем, что для обновления элемента управления DataList должна быть выполнена обратная передача.</span><span class="sxs-lookup"><span data-stu-id="58701-162">This is because a postback must occur for the DataList to update.</span></span> <span data-ttu-id="58701-163">Для этого можно либо присвоить свойству `AutoPostBack` DropDownList значение `true`, либо добавить на страницу веб-элемент управления Button.</span><span class="sxs-lookup"><span data-stu-id="58701-163">To accomplish this we can either set the DropDownList's `AutoPostBack` property to `true` or add a Button Web control to the page.</span></span> <span data-ttu-id="58701-164">В этом руководстве я решил установить для свойства `AutoPostBack` DropDownList значение `true`.</span><span class="sxs-lookup"><span data-stu-id="58701-164">For this tutorial, I've opted to set the DropDownList's `AutoPostBack` property to `true`.</span></span>

<span data-ttu-id="58701-165">На рисунках 9 и 10 показан отчет «основной/подробности» в действии.</span><span class="sxs-lookup"><span data-stu-id="58701-165">Figures 9 and 10 illustrate the master/detail report in action.</span></span>

<span data-ttu-id="58701-166">[![при первом посещении страницы отображаются продукты напитков](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image22.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="58701-166">[![When First Visiting the Page, the Beverage Products are Displayed](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image22.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image21.png)</span></span>

<span data-ttu-id="58701-167">**Рис. 9**. при первом посещении страницы отображаются продукты напитков ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image23.png)).</span><span class="sxs-lookup"><span data-stu-id="58701-167">**Figure 9**: When First Visiting the Page, the Beverage Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image23.png))</span></span>

<span data-ttu-id="58701-168">[![выборе нового продукта (фрукты) автоматически вызывает обратную передачу, обновляя элемент управления DataList.](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image25.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="58701-168">[![Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the DataList](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image25.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image24.png)</span></span>

<span data-ttu-id="58701-169">**Рис. 10**. Выбор нового продукта (фрукты) автоматически вызывает обратную передачу, обновляя элемент управления DataList ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="58701-169">**Figure 10**: Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the DataList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image26.png))</span></span>

## <a name="adding-a----choose-a-category----list-item"></a><span data-ttu-id="58701-170">Добавление элемента списка "--выберите категорию--"</span><span class="sxs-lookup"><span data-stu-id="58701-170">Adding a "-- Choose a Category --" List Item</span></span>

<span data-ttu-id="58701-171">При первом посещении страницы `FilterByDropDownList.aspx` по умолчанию выбирается первый элемент списка элемента управления DropDownList, отображая продукты категории «напитки» в DataList.</span><span class="sxs-lookup"><span data-stu-id="58701-171">When first visiting the `FilterByDropDownList.aspx` page the categories DropDownList's first list item (Beverages) is selected by default, showing the beverage products in the DataList.</span></span> <span data-ttu-id="58701-172">В *фильтрации "основной/подробности" с помощью элемента DropDownList* мы добавили в DropDownList параметр "--выберите категорию--", который был выбран по умолчанию, и при выборе этого параметра отображаются *все* продукты в базе данных.</span><span class="sxs-lookup"><span data-stu-id="58701-172">In the *Master/Detail Filtering With a DropDownList* tutorial we added a "-- Choose a Category --" option to the DropDownList that was selected by default and, when selected, displayed *all* of the products in the database.</span></span> <span data-ttu-id="58701-173">Такой подход был бы управляемым при перечислении продуктов в GridView, так как каждая строка продукта занимала небольшой объем экранного пространства.</span><span class="sxs-lookup"><span data-stu-id="58701-173">Such an approach was manageable when listing the products in a GridView, as each product row took up a small amount of screen real estate.</span></span> <span data-ttu-id="58701-174">Однако при использовании элемента управления DataList каждый продукт использует гораздо больший фрагмент экрана.</span><span class="sxs-lookup"><span data-stu-id="58701-174">With the DataList, however, each product's information consumes a much larger chunk of the screen.</span></span> <span data-ttu-id="58701-175">Давайте по-прежнему добавим параметр "--выбрать категорию--", и он будет выбран по умолчанию, но вместо того, чтобы отображать все продукты при выборе, давайте настроим его таким образом, чтобы он не отображал продукты.</span><span class="sxs-lookup"><span data-stu-id="58701-175">Let's still add a "-- Choose a Category --" option and have it selected by default, but instead of having it show all products when selected, let's configure it so that it shows no products.</span></span>

<span data-ttu-id="58701-176">Чтобы добавить новый элемент списка в DropDownList, перейдите к окно свойств и щелкните многоточие в свойстве `Items`.</span><span class="sxs-lookup"><span data-stu-id="58701-176">To add a new list item to the DropDownList, go to the Properties window and click on the ellipses in the `Items` property.</span></span> <span data-ttu-id="58701-177">Добавьте новый элемент списка с `Text` "--выберите категорию--" и `0``Value`.</span><span class="sxs-lookup"><span data-stu-id="58701-177">Add a new list item with the `Text` "-- Choose a Category --" and the `Value` `0`.</span></span>

![Добавить](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image27.png)

<span data-ttu-id="58701-179">**Рис. 11**. Добавление элемента списка «--выберите категорию--»</span><span class="sxs-lookup"><span data-stu-id="58701-179">**Figure 11**: Add a "-- Choose a Category --" List Item</span></span>

<span data-ttu-id="58701-180">Кроме того, можно добавить элемент списка, добавив в DropDownList следующую разметку:</span><span class="sxs-lookup"><span data-stu-id="58701-180">Alternatively, you can add the list item by adding the following markup to the DropDownList:</span></span>

[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-datalist-vb/samples/sample3.aspx)]

<span data-ttu-id="58701-181">Кроме того, необходимо присвоить `AppendDataBoundItems`у элемента управления DropDownList `true`, так как если он имеет значение `false` (значение по умолчанию), то при привязке категорий к DropDownList из ObjectDataSource они будут перезаписывать элементы списка, добавленные вручную.</span><span class="sxs-lookup"><span data-stu-id="58701-181">Additionally, we need to set the DropDownList control's `AppendDataBoundItems` to `true` because if it's set to `false` (the default), when the categories are bound to the DropDownList from the ObjectDataSource they'll overwrite any manually-added list items.</span></span>

![Присвойте свойству Аппенддатабаундитемс значение true.](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image28.png)

<span data-ttu-id="58701-183">**Рис. 12**. установка свойства `AppendDataBoundItems` в значение true</span><span class="sxs-lookup"><span data-stu-id="58701-183">**Figure 12**: Set the `AppendDataBoundItems` Property to True</span></span>

<span data-ttu-id="58701-184">Причина, по которой мы выбрали значение `0` для элемента списка "--выберите категорию--", заключается в том, что в системе нет категорий со значением `0`, поэтому при выборе элемента списка "--выберите категорию--" не будут возвращаться никакие записи о продукте.</span><span class="sxs-lookup"><span data-stu-id="58701-184">The reason we chose the value `0` for the "-- Choose a Category --" list item is because there are no categories in the system with a value of `0`, hence no product records will be returned when the "-- Choose a Category --" list item is selected.</span></span> <span data-ttu-id="58701-185">Чтобы подтвердить это, уделите время посетить страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="58701-185">To confirm this, take a moment to visit the page through a browser.</span></span> <span data-ttu-id="58701-186">Как показано на рис. 13, при первом просмотре страницы выбирается элемент списка «--выберите категорию--», и продукты не отображаются.</span><span class="sxs-lookup"><span data-stu-id="58701-186">As Figure 13 shows, when initially viewing the page the "-- Choose a Category --" list item is selected and no products are displayed.</span></span>

<span data-ttu-id="58701-187">[![, когда](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image30.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="58701-187">[![When the](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image30.png)](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image29.png)</span></span>

<span data-ttu-id="58701-188">**Рис. 13**. при выборе элемента списка "--выберите категорию--" продукты не отображаются ([щелкните, чтобы просмотреть изображение с полным размером](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="58701-188">**Figure 13**: When the "-- Choose a Category --" List Item is Selected, No Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-datalist-vb/_static/image31.png))</span></span>

<span data-ttu-id="58701-189">Если вы предпочитаете отображать *все* продукты, если выбран параметр "--выбрать категорию--", используйте вместо этого значение `-1`.</span><span class="sxs-lookup"><span data-stu-id="58701-189">If you'd rather display *all* of the products when the "-- Choose a Category --" option is selected, use a value of `-1` instead.</span></span> <span data-ttu-id="58701-190">Читатель внимательный будет отзывать его в фильтрации " *основной/подробности" с помощью DropDownList* . Мы обновили метод `GetProductsByCategoryID(categoryID)` класса `ProductsBLL`, чтобы при передаче *`categoryID`* значения `-1` были возвращены все записи продуктов.</span><span class="sxs-lookup"><span data-stu-id="58701-190">The astute reader will recall that back in the *Master/Detail Filtering With a DropDownList* tutorial we updated the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method so that if a *`categoryID`* value of `-1` was passed in, all product records were returned.</span></span>

## <a name="summary"></a><span data-ttu-id="58701-191">Сводка</span><span class="sxs-lookup"><span data-stu-id="58701-191">Summary</span></span>

<span data-ttu-id="58701-192">При отображении иерархически связанных данных часто бывает удобно представлять данные с помощью отчетов «основной/подробности», из которых пользователь может начать изучение данных из верхней части иерархии и детализировать подробные сведения.</span><span class="sxs-lookup"><span data-stu-id="58701-192">When displaying hierarchically-related data, it often helps to present the data using master/detail reports, from which the user can start perusing the data from the top of the hierarchy and drill down into details.</span></span> <span data-ttu-id="58701-193">В этом учебнике мы рассмотрели создание простого отчета «основной/подробности», в котором отображаются продукты выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="58701-193">In this tutorial we examined building a simple master/detail report showing a selected category's products.</span></span> <span data-ttu-id="58701-194">Это было выполнено с помощью DropDownList для списка категорий и DataList для продуктов, принадлежащих выбранной категории.</span><span class="sxs-lookup"><span data-stu-id="58701-194">This was accomplished by using a DropDownList for the list of categories and a DataList for the products belonging to the selected category.</span></span>

<span data-ttu-id="58701-195">В следующем учебном курсе мы рассмотрим отделение основных и подробных записей на двух страницах.</span><span class="sxs-lookup"><span data-stu-id="58701-195">In the next tutorial we'll look at separating the master and details records across two pages.</span></span> <span data-ttu-id="58701-196">На первой странице будет отображен список записей «Master» со ссылкой для просмотра сведений.</span><span class="sxs-lookup"><span data-stu-id="58701-196">In the first page, a list of "master" records will be displayed, with a link to view the details.</span></span> <span data-ttu-id="58701-197">Щелкнув ссылку, вы перенесет пользователя на вторую страницу, где будут отображаться сведения о выбранной главной записи.</span><span class="sxs-lookup"><span data-stu-id="58701-197">Clicking on the link will whisk the user to the second page, which will display the details for the selected master record.</span></span>

<span data-ttu-id="58701-198">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="58701-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="58701-199">Об авторе</span><span class="sxs-lookup"><span data-stu-id="58701-199">About the Author</span></span>

<span data-ttu-id="58701-200">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="58701-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="58701-201">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="58701-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="58701-202">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="58701-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="58701-203">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="58701-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="58701-204">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="58701-204">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="58701-205">Особая благодарность...</span><span class="sxs-lookup"><span data-stu-id="58701-205">Special Thanks To…</span></span>

<span data-ttu-id="58701-206">Эта серия руководств была рассмотрена многими полезными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="58701-206">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="58701-207">Специалист по интересу для этого руководства был Рэнди Шмидт.</span><span class="sxs-lookup"><span data-stu-id="58701-207">Lead reviewer for this tutorial was Randy Schmidt.</span></span> <span data-ttu-id="58701-208">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="58701-208">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="58701-209">Если это так, расположите строку в [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="58701-209">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="58701-210">[Назад](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md)
> [Вперед](master-detail-filtering-acess-two-pages-datalist-vb.md)</span><span class="sxs-lookup"><span data-stu-id="58701-210">[Previous](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md)
[Next](master-detail-filtering-acess-two-pages-datalist-vb.md)</span></span>
