---
uid: web-forms/overview/data-access/custom-button-actions-with-the-datalist-and-repeater/custom-buttons-in-the-datalist-and-repeater-cs
title: Пользовательские кнопки в DataList и Repeater (C#) | Документация Майкрософт
author: rick-anderson
description: В этом учебнике мы создадим интерфейс, который использует Repeater для перечисления категорий в системе, где каждая категория предоставляет кнопку для отображения ее ассоЦи...
ms.author: riande
ms.date: 11/13/2006
ms.assetid: 1f42e332-78dc-438b-9e35-0c97aa0ad929
msc.legacyurl: /web-forms/overview/data-access/custom-button-actions-with-the-datalist-and-repeater/custom-buttons-in-the-datalist-and-repeater-cs
msc.type: authoredcontent
ms.openlocfilehash: e8cb1054068327c25e057b6df1cc7506feec8d37
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74601761"
---
# <a name="custom-buttons-in-the-datalist-and-repeater-c"></a><span data-ttu-id="f3086-103">Настраиваемые кнопки в элементах управления DataList и Repeater (C#)</span><span class="sxs-lookup"><span data-stu-id="f3086-103">Custom Buttons in the DataList and Repeater (C#)</span></span>

<span data-ttu-id="f3086-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f3086-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f3086-105">[Скачивание примера приложения](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_46_CS.exe) или [Загрузка PDF-файла](custom-buttons-in-the-datalist-and-repeater-cs/_static/datatutorial46cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f3086-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_46_CS.exe) or [Download PDF](custom-buttons-in-the-datalist-and-repeater-cs/_static/datatutorial46cs1.pdf)</span></span>

> <span data-ttu-id="f3086-106">В этом учебнике мы создадим интерфейс, который использует Repeater для перечисления категорий в системе, где каждая категория предоставляет кнопку для отображения связанных с ней продуктов с помощью элемента управления маркированного списка.</span><span class="sxs-lookup"><span data-stu-id="f3086-106">In this tutorial we'll build an interface that uses a Repeater to list the categories in the system, with each category providing a button to show its associated products using a BulletedList control.</span></span>

## <a name="introduction"></a><span data-ttu-id="f3086-107">Введение</span><span class="sxs-lookup"><span data-stu-id="f3086-107">Introduction</span></span>

<span data-ttu-id="f3086-108">В течение прошлых учебников по DataList и Repeater мы создали как примеры для чтения, так и изменения и удаления примеров.</span><span class="sxs-lookup"><span data-stu-id="f3086-108">Throughout the past seventeen DataList and Repeater tutorials, we ve created both read-only examples and editing and deleting examples.</span></span> <span data-ttu-id="f3086-109">Чтобы упростить редактирование и удаление возможностей в DataList, мы добавили кнопки в элементы DataList `ItemTemplate`, которые при нажатии вызвали обратную передачу и вызвали событие DataList, соответствующее свойству `CommandName` Button.</span><span class="sxs-lookup"><span data-stu-id="f3086-109">To facilitate editing and deleting capabilities within a DataList, we added buttons to the DataList s `ItemTemplate` that, when clicked, caused a postback and raised a DataList event corresponding to the button s `CommandName` property.</span></span> <span data-ttu-id="f3086-110">Например, Добавление кнопки в `ItemTemplate` с `CommandName`ным значением свойства Edit приводит к срабатыванию `EditCommand` DataList s при обратной передаче. один с `CommandName` удаления вызывает `DeleteCommand`.</span><span class="sxs-lookup"><span data-stu-id="f3086-110">For example, adding a button to the `ItemTemplate` with a `CommandName` property value of Edit causes the DataList s `EditCommand` to fire on postback; one with the `CommandName` Delete raises the `DeleteCommand`.</span></span>

<span data-ttu-id="f3086-111">Помимо кнопок "Правка" и "Удалить", элементы управления DataList и Repeater могут также включать кнопки, LinkButton или Имажебуттонс, которые при нажатии выполняют некоторую пользовательскую логику на стороне сервера.</span><span class="sxs-lookup"><span data-stu-id="f3086-111">In addition to Edit and Delete buttons, the DataList and Repeater controls can also include Buttons, LinkButtons, or ImageButtons that, when clicked, perform some custom server-side logic.</span></span> <span data-ttu-id="f3086-112">В этом учебнике мы создадим интерфейс, который использует Repeater для перечисления категорий в системе.</span><span class="sxs-lookup"><span data-stu-id="f3086-112">In this tutorial we'll build an interface that uses a Repeater to list the categories in the system.</span></span> <span data-ttu-id="f3086-113">Для каждой категории Repeater будет содержать кнопку для отображения связанных с категориями продуктов, использующих элемент управления «Маркированный список» (см. рис. 1).</span><span class="sxs-lookup"><span data-stu-id="f3086-113">For each category, the Repeater will include a button to show the category s associated products using a BulletedList control (see Figure 1).</span></span>

<span data-ttu-id="f3086-114">[![щелкнув ссылку Показать продукты, вы увидите продукты категории в маркированном списке.](custom-buttons-in-the-datalist-and-repeater-cs/_static/image2.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f3086-114">[![Clicking the Show Products Link Displays the Category s Products in a Bulleted List](custom-buttons-in-the-datalist-and-repeater-cs/_static/image2.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image1.png)</span></span>

<span data-ttu-id="f3086-115">**Рис. 1**. Если щелкнуть ссылку Показать продукты, отображаются продукты категории в маркированном списке ([щелкните, чтобы просмотреть изображение с полным размером](custom-buttons-in-the-datalist-and-repeater-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="f3086-115">**Figure 1**: Clicking the Show Products Link Displays the Category s Products in a Bulleted List ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-cs/_static/image3.png))</span></span>

## <a name="step-1-adding-the-custom-button-tutorial-web-pages"></a><span data-ttu-id="f3086-116">Шаг 1. Добавление веб-страниц учебника по настраиваемым кнопкам</span><span class="sxs-lookup"><span data-stu-id="f3086-116">Step 1: Adding the Custom Button Tutorial Web Pages</span></span>

<span data-ttu-id="f3086-117">Прежде чем мы посмотрим, как добавить пользовательскую кнопку, давайте сначала создадим страницы ASP.NET в нашем проекте веб-сайта, которые понадобятся для работы с этим руководством.</span><span class="sxs-lookup"><span data-stu-id="f3086-117">Before we look at how to add a custom button, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial.</span></span> <span data-ttu-id="f3086-118">Для начала добавьте новую папку с именем `CustomButtonsDataListRepeater`.</span><span class="sxs-lookup"><span data-stu-id="f3086-118">Start by adding a new folder named `CustomButtonsDataListRepeater`.</span></span> <span data-ttu-id="f3086-119">Затем добавьте следующие две страницы ASP.NET в эту папку, чтобы связать каждую страницу с главной страницей `Site.master`:</span><span class="sxs-lookup"><span data-stu-id="f3086-119">Next, add the following two ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `CustomButtons.aspx`

![Добавление страниц ASP.NET для руководств, связанных с пользовательскими кнопками](custom-buttons-in-the-datalist-and-repeater-cs/_static/image4.png)

<span data-ttu-id="f3086-121">**Рис. 2**. добавление страниц ASP.NET для руководств, связанных с пользовательскими кнопками</span><span class="sxs-lookup"><span data-stu-id="f3086-121">**Figure 2**: Add the ASP.NET Pages for the Custom Buttons-Related Tutorials</span></span>

<span data-ttu-id="f3086-122">Как и в других папках, `Default.aspx` в папке `CustomButtonsDataListRepeater` будут перечислены учебники в разделе.</span><span class="sxs-lookup"><span data-stu-id="f3086-122">Like in the other folders, `Default.aspx` in the `CustomButtonsDataListRepeater` folder will list the tutorials in its section.</span></span> <span data-ttu-id="f3086-123">Вспомним, что `SectionLevelTutorialListing.ascx` пользовательский элемент управления предоставляет эти функции.</span><span class="sxs-lookup"><span data-stu-id="f3086-123">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="f3086-124">Добавьте этот пользовательский элемент управления в `Default.aspx`, перетащив его из обозреватель решений на страницу s представление конструирования.</span><span class="sxs-lookup"><span data-stu-id="f3086-124">Add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="f3086-125">[![добавить пользовательский элемент управления SectionLevelTutorialListing. ascx в Default. aspx](custom-buttons-in-the-datalist-and-repeater-cs/_static/image6.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="f3086-125">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](custom-buttons-in-the-datalist-and-repeater-cs/_static/image6.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image5.png)</span></span>

<span data-ttu-id="f3086-126">**Рис. 3**. Добавление пользовательского элемента управления `SectionLevelTutorialListing.ascx` в `Default.aspx` ([щелкните, чтобы просмотреть изображение с полным размером](custom-buttons-in-the-datalist-and-repeater-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="f3086-126">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-cs/_static/image7.png))</span></span>

<span data-ttu-id="f3086-127">Наконец, добавьте страницы в качестве записей в файл `Web.sitemap`.</span><span class="sxs-lookup"><span data-stu-id="f3086-127">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="f3086-128">В частности, добавьте следующую разметку после разбиения по страницам и сортировку с помощью элементов управления DataList и Repeater `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="f3086-128">Specifically, add the following markup after the Paging and Sorting with the DataList and Repeater `<siteMapNode>`:</span></span>

[!code-xml[Main](custom-buttons-in-the-datalist-and-repeater-cs/samples/sample1.xml)]

<span data-ttu-id="f3086-129">После обновления `Web.sitemap`просмотрите веб-сайт учебников в браузере.</span><span class="sxs-lookup"><span data-stu-id="f3086-129">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="f3086-130">В меню слева теперь содержатся элементы для учебников по редактированию, вставке и удалению.</span><span class="sxs-lookup"><span data-stu-id="f3086-130">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>

![На карте узла теперь есть запись для учебника по настраиваемым кнопкам](custom-buttons-in-the-datalist-and-repeater-cs/_static/image8.png)

<span data-ttu-id="f3086-132">**Рис. 4**. в карте узла теперь есть запись для учебника по настраиваемым кнопкам</span><span class="sxs-lookup"><span data-stu-id="f3086-132">**Figure 4**: The Site Map Now Includes the Entry for the Custom Buttons Tutorial</span></span>

## <a name="step-2-adding-the-list-of-categories"></a><span data-ttu-id="f3086-133">Шаг 2. Добавление списка категорий</span><span class="sxs-lookup"><span data-stu-id="f3086-133">Step 2: Adding the List of Categories</span></span>

<span data-ttu-id="f3086-134">Для работы с этим руководством необходимо создать элемент Repeater со списком всех категорий вместе с элементом «Показать продукты», который при щелчке отображает связанные продукты категории в маркированном списке.</span><span class="sxs-lookup"><span data-stu-id="f3086-134">For this tutorial we need to create a Repeater that lists all categories along with a Show Products LinkButton that, when clicked, displays the associated category s products in a bulleted list.</span></span> <span data-ttu-id="f3086-135">Давайте сначала создадим простой элемент Repeater, содержащий категории в системе.</span><span class="sxs-lookup"><span data-stu-id="f3086-135">Let s first create a simple Repeater that lists the categories in the system.</span></span> <span data-ttu-id="f3086-136">Для начала откройте страницу `CustomButtons.aspx` в папке `CustomButtonsDataListRepeater`.</span><span class="sxs-lookup"><span data-stu-id="f3086-136">Start by opening the `CustomButtons.aspx` page in the `CustomButtonsDataListRepeater` folder.</span></span> <span data-ttu-id="f3086-137">Перетащите элемент Repeater из панели элементов в конструктор и задайте для его свойства `ID` значение `Categories`.</span><span class="sxs-lookup"><span data-stu-id="f3086-137">Drag a Repeater from the Toolbox onto the Designer and set its `ID` property to `Categories`.</span></span> <span data-ttu-id="f3086-138">Затем создайте новый элемент управления источниками данных из смарт-тега Repeater s.</span><span class="sxs-lookup"><span data-stu-id="f3086-138">Next, create a new data source control from the Repeater s smart tag.</span></span> <span data-ttu-id="f3086-139">В частности, создайте новый элемент управления ObjectDataSource с именем `CategoriesDataSource`, выбирающий его данные из метода `CategoriesBLL` класса s `GetCategories()`.</span><span class="sxs-lookup"><span data-stu-id="f3086-139">Specifically, create a new ObjectDataSource control named `CategoriesDataSource` that selects its data from the `CategoriesBLL` class s `GetCategories()` method.</span></span>

<span data-ttu-id="f3086-140">[![настроить ObjectDataSource для использования метода класса CategoriesBLL-Categories ()](custom-buttons-in-the-datalist-and-repeater-cs/_static/image10.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="f3086-140">[![Configure the ObjectDataSource to Use the CategoriesBLL Class s GetCategories() Method](custom-buttons-in-the-datalist-and-repeater-cs/_static/image10.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image9.png)</span></span>

<span data-ttu-id="f3086-141">**Рис. 5**. Настройка ObjectDataSource для использования метода `GetCategories()` `CategoriesBLL` Class ([щелкните, чтобы просмотреть изображение с полным размером](custom-buttons-in-the-datalist-and-repeater-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="f3086-141">**Figure 5**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class s `GetCategories()` Method ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-cs/_static/image11.png))</span></span>

<span data-ttu-id="f3086-142">В отличие от элемента управления DataList, для которого Visual Studio создает `ItemTemplate` по умолчанию на основе источника данных, шаблоны Repeater необходимо определять вручную.</span><span class="sxs-lookup"><span data-stu-id="f3086-142">Unlike the DataList control, for which Visual Studio creates a default `ItemTemplate` based on the data source, the Repeater s templates must be manually defined.</span></span> <span data-ttu-id="f3086-143">Более того, шаблоны Repeater должны создаваться и редактироваться декларативно (то есть в смарт-теге Repeater s нет параметра "изменить шаблоны").</span><span class="sxs-lookup"><span data-stu-id="f3086-143">Furthermore, the Repeater s templates must be created and edited declaratively (that is, there s no Edit Templates option in the Repeater s smart tag).</span></span>

<span data-ttu-id="f3086-144">Щелкните вкладку Source (источник) в левом нижнем углу и добавьте `ItemTemplate`, отображающий имя категории в элементе `<h3>` и его описание в теге абзаца. Включите `SeparatorTemplate`, отображающий горизонтальное правило (`<hr />`) между каждой категорией.</span><span class="sxs-lookup"><span data-stu-id="f3086-144">Click on the Source tab in the bottom left corner and add an `ItemTemplate` that displays the category s name in an `<h3>` element and its description in a paragraph tag; include a `SeparatorTemplate` that displays a horizontal rule (`<hr />`) between each category.</span></span> <span data-ttu-id="f3086-145">Также добавьте элемент LinkButton со свойством `Text`, имеющим значение отображать продукты.</span><span class="sxs-lookup"><span data-stu-id="f3086-145">Also add a LinkButton with its `Text` property set to Show Products.</span></span> <span data-ttu-id="f3086-146">После выполнения этих действий декларативная разметка страницы должна выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="f3086-146">After completing these steps, your page s declarative markup should look like the following:</span></span>

[!code-aspx[Main](custom-buttons-in-the-datalist-and-repeater-cs/samples/sample2.aspx)]

<span data-ttu-id="f3086-147">На рис. 6 показана страница при просмотре в браузере.</span><span class="sxs-lookup"><span data-stu-id="f3086-147">Figure 6 shows the page when viewed through a browser.</span></span> <span data-ttu-id="f3086-148">В списке указаны имя и описание каждой категории.</span><span class="sxs-lookup"><span data-stu-id="f3086-148">Each category name and description is listed.</span></span> <span data-ttu-id="f3086-149">Кнопка "показывать продукты" при нажатии вызывает обратную передачу, но еще не выполняет никаких действий.</span><span class="sxs-lookup"><span data-stu-id="f3086-149">The Show Products button, when clicked, causes a postback but does not yet perform any action.</span></span>

<span data-ttu-id="f3086-150">[![отображается имя и описание каждой категории, а также элемент Показать продукты LinkButton.](custom-buttons-in-the-datalist-and-repeater-cs/_static/image13.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="f3086-150">[![Each Category s Name and Description is Displayed, Along with a Show Products LinkButton](custom-buttons-in-the-datalist-and-repeater-cs/_static/image13.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image12.png)</span></span>

<span data-ttu-id="f3086-151">**Рис. 6**. отображается имя и описание каждой категории, а также элемент "Показать продукты" ([щелкните, чтобы просмотреть изображение с полным размером](custom-buttons-in-the-datalist-and-repeater-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="f3086-151">**Figure 6**: Each Category s Name and Description is Displayed, Along with a Show Products LinkButton ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-cs/_static/image14.png))</span></span>

## <a name="step-3-executing-server-side-logic-when-the-show-products-linkbutton-is-clicked"></a><span data-ttu-id="f3086-152">Шаг 3. исполнение логики на стороне сервера при нажатии кнопки "отобразить продукты"</span><span class="sxs-lookup"><span data-stu-id="f3086-152">Step 3: Executing Server-Side Logic When the Show Products LinkButton is Clicked</span></span>

<span data-ttu-id="f3086-153">При нажатии кнопки, LinkButton или ImageButton в шаблоне в элементе управления DataList или Repeater происходит обратная передача, а также порождается событие `ItemCommand` DataList или Repeater s.</span><span class="sxs-lookup"><span data-stu-id="f3086-153">Anytime a Button, LinkButton, or ImageButton within a template in a DataList or Repeater is clicked, a postback occurs and the DataList or Repeater s `ItemCommand` event fires.</span></span> <span data-ttu-id="f3086-154">В дополнение к событию `ItemCommand` элемент управления DataList может также вызвать другое, более конкретное событие, если свойство Button `CommandName` имеет значение одной из зарезервированных строк (Delete, Правка, отменить, обновить или выбрать), но событие `ItemCommand` *всегда* срабатывает.</span><span class="sxs-lookup"><span data-stu-id="f3086-154">In addition to the `ItemCommand` event, the DataList control may also raise another, more specific event if the button s `CommandName` property is set to one of the reserved strings ( Delete, Edit, Cancel, Update, or Select ), but the `ItemCommand` event is *always* fired.</span></span>

<span data-ttu-id="f3086-155">При нажатии кнопки в элементе управления DataList или Repeater часто нам нужно передать нажатую кнопку (в случае, если в элементе есть несколько кнопок, таких как кнопка "Изменить" и "Удалить") и, возможно, некоторые дополнительные сведения (например, значение первичного ключа элемента, кнопка которого была нажата.</span><span class="sxs-lookup"><span data-stu-id="f3086-155">When a button is clicked within a DataList or Repeater, oftentimes we need to pass along which button was clicked (in the case that there may be multiple buttons within the control, such as both an Edit and Delete button) and perhaps some additional information (such as the primary key value of the item whose button was clicked).</span></span> <span data-ttu-id="f3086-156">Кнопки, LinkButton и ImageButton предоставляют два свойства, значения которых передаются в обработчик событий `ItemCommand`:</span><span class="sxs-lookup"><span data-stu-id="f3086-156">The Button, LinkButton, and ImageButton provide two properties whose values are passed to the `ItemCommand` event handler:</span></span>

- <span data-ttu-id="f3086-157">`CommandName` строку, обычно используемую для поиска каждой кнопки в шаблоне</span><span class="sxs-lookup"><span data-stu-id="f3086-157">`CommandName` a string typically used to identify each button in the template</span></span>
- <span data-ttu-id="f3086-158">`CommandArgument` обычно используется для хранения значения некоторого поля данных, например значения первичного ключа.</span><span class="sxs-lookup"><span data-stu-id="f3086-158">`CommandArgument` commonly used to hold the value of some data field, such as the primary key value</span></span>

<span data-ttu-id="f3086-159">В этом примере задайте свойству `CommandName` LinkButton s значение Шовпродуктс и привяжите `CategoryID` значения первичного ключа текущей записи к свойству `CommandArgument` с помощью синтаксиса привязки данных `CategoryArgument='<%# Eval("CategoryID") %>'`.</span><span class="sxs-lookup"><span data-stu-id="f3086-159">For this example, set the LinkButton s `CommandName` property to ShowProducts and bind the current record s primary key value `CategoryID` to the `CommandArgument` property using the databinding syntax `CategoryArgument='<%# Eval("CategoryID") %>'`.</span></span> <span data-ttu-id="f3086-160">После указания этих двух свойств декларативный синтаксис LinkButton s должен выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="f3086-160">After specifying these two properties, the LinkButton s declarative syntax should look like the following:</span></span>

[!code-aspx[Main](custom-buttons-in-the-datalist-and-repeater-cs/samples/sample3.aspx)]

<span data-ttu-id="f3086-161">При нажатии кнопки происходит обратная передача и вызывается событие DataList или Repeater s `ItemCommand`.</span><span class="sxs-lookup"><span data-stu-id="f3086-161">When the button is clicked, a postback occurs and the DataList or Repeater s `ItemCommand` event fires.</span></span> <span data-ttu-id="f3086-162">Обработчику событий передается кнопка s `CommandName` и `CommandArgument` значения.</span><span class="sxs-lookup"><span data-stu-id="f3086-162">The event handler is passed the button s `CommandName` and `CommandArgument` values.</span></span>

<span data-ttu-id="f3086-163">Создайте обработчик событий для события Repeater `ItemCommand` и обратите внимание на второй параметр, передаваемый в обработчик событий (с именем `e`).</span><span class="sxs-lookup"><span data-stu-id="f3086-163">Create an event handler for the Repeater s `ItemCommand` event and note the second parameter passed into the event handler (named `e`).</span></span> <span data-ttu-id="f3086-164">Второй параметр имеет тип [`RepeaterCommandEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeatercommandeventargs.aspx) и имеет следующие четыре свойства:</span><span class="sxs-lookup"><span data-stu-id="f3086-164">This second parameter is of type [`RepeaterCommandEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeatercommandeventargs.aspx) and has the following four properties:</span></span>

- <span data-ttu-id="f3086-165">`CommandArgument` значение свойства `CommandArgument` нажатой кнопки</span><span class="sxs-lookup"><span data-stu-id="f3086-165">`CommandArgument` the value of the clicked button s `CommandArgument` property</span></span>
- <span data-ttu-id="f3086-166">`CommandName` значение свойства кнопки `CommandName`</span><span class="sxs-lookup"><span data-stu-id="f3086-166">`CommandName` the value of the button s `CommandName` property</span></span>
- <span data-ttu-id="f3086-167">`CommandSource` ссылку на элемент управления Button, который был нажат</span><span class="sxs-lookup"><span data-stu-id="f3086-167">`CommandSource` a reference to the button control that was clicked</span></span>
- <span data-ttu-id="f3086-168">`Item` ссылку на [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem.aspx) , содержащую кнопку, которая была нажата. Каждая запись, привязанная к элементу Repeater, является `RepeaterItem`</span><span class="sxs-lookup"><span data-stu-id="f3086-168">`Item` a reference to the [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem.aspx) that contains the button that was clicked; each record bound to the Repeater is manifested as a `RepeaterItem`</span></span>

<span data-ttu-id="f3086-169">Так как выбранная категория s `CategoryID` передается через свойство `CommandArgument`, можно получить набор продуктов, связанных с выбранной категорией, в обработчике событий `ItemCommand`.</span><span class="sxs-lookup"><span data-stu-id="f3086-169">Since the selected category s `CategoryID` is passed in via the `CommandArgument` property, we can get the set of products associated with the selected category in the `ItemCommand` event handler.</span></span> <span data-ttu-id="f3086-170">Затем эти продукты можно привязать к элементу управления "маркированный" в `ItemTemplate` (который мы еще не добавили).</span><span class="sxs-lookup"><span data-stu-id="f3086-170">These products can then be bound to a BulletedList control in the `ItemTemplate` (which we ve yet to add).</span></span> <span data-ttu-id="f3086-171">Все, что остается, — это добавить маркированный список, ссылаться на него в обработчике событий `ItemCommand` и привязать к нему набор продуктов для выбранной категории, который мы рассмотрим на шаге 4.</span><span class="sxs-lookup"><span data-stu-id="f3086-171">All that remains, then, is to add the BulletedList, reference it in the `ItemCommand` event handler, and bind to it the set of products for the selected category, which we'll tackle in Step 4.</span></span>

> [!NOTE]
> <span data-ttu-id="f3086-172">Обработчику событий DataList `ItemCommand` передается объект типа [`DataListCommandEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistcommandeventargs.aspx), который предоставляет те же четыре свойства, что и класс `RepeaterCommandEventArgs`.</span><span class="sxs-lookup"><span data-stu-id="f3086-172">The DataList s `ItemCommand` event handler is passed an object of type [`DataListCommandEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistcommandeventargs.aspx), which offers the same four properties as the `RepeaterCommandEventArgs` class.</span></span>

## <a name="step-4-displaying-the-selected-category-s-products-in-a-bulleted-list"></a><span data-ttu-id="f3086-173">Шаг 4. Отображение выбранных продуктов категории в маркированном списке</span><span class="sxs-lookup"><span data-stu-id="f3086-173">Step 4: Displaying the Selected Category s Products in a Bulleted List</span></span>

<span data-ttu-id="f3086-174">Выбранные продукты категории можно отобразить в элементе управления Repeater `ItemTemplate` с помощью любого числа элементов.</span><span class="sxs-lookup"><span data-stu-id="f3086-174">The selected category s products can be displayed within the Repeater s `ItemTemplate` using any number of controls.</span></span> <span data-ttu-id="f3086-175">Можно добавить еще один вложенный элемент управления Repeater, DataList, DropDownList, GridView и т. д.</span><span class="sxs-lookup"><span data-stu-id="f3086-175">We could add another nested Repeater, a DataList, a DropDownList, a GridView, and so on.</span></span> <span data-ttu-id="f3086-176">Так как мы хотим отобразить продукты в виде маркированного списка, мы будем использовать элемент управления «Маркированный список».</span><span class="sxs-lookup"><span data-stu-id="f3086-176">Since we want to display the products as a bulleted list, though, we'll use the BulletedList control.</span></span> <span data-ttu-id="f3086-177">После возврата к декларативной разметке страницы `CustomButtons.aspx` добавьте элемент управления "маркированный список" в `ItemTemplate` после элемента "отображать продукты LinkButton".</span><span class="sxs-lookup"><span data-stu-id="f3086-177">Returning to the `CustomButtons.aspx` page s declarative markup, add a BulletedList control to the `ItemTemplate` after the Show Products LinkButton.</span></span> <span data-ttu-id="f3086-178">Установите `ID` Буллетедлистс s в значение `ProductsInCategory`.</span><span class="sxs-lookup"><span data-stu-id="f3086-178">Set the BulletedLists s `ID` to `ProductsInCategory`.</span></span> <span data-ttu-id="f3086-179">Маркированный список отображает значение поля данных, указанного с помощью свойства `DataTextField`; так как этот элемент управления будет иметь привязанную к нему информацию о продукте, задайте для свойства `DataTextField` значение `ProductName`.</span><span class="sxs-lookup"><span data-stu-id="f3086-179">The BulletedList displays the value of the data field specified via the `DataTextField` property; since this control will have product information bound to it, set the `DataTextField` property to `ProductName`.</span></span>

[!code-aspx[Main](custom-buttons-in-the-datalist-and-repeater-cs/samples/sample4.aspx)]

<span data-ttu-id="f3086-180">В обработчике событий `ItemCommand` сослаться на этот элемент управления с помощью `e.Item.FindControl("ProductsInCategory")` и привязать его к набору продуктов, связанных с выбранной категорией.</span><span class="sxs-lookup"><span data-stu-id="f3086-180">In the `ItemCommand` event handler, reference this control using `e.Item.FindControl("ProductsInCategory")` and bind it to the set of products associated with the selected category.</span></span>

[!code-csharp[Main](custom-buttons-in-the-datalist-and-repeater-cs/samples/sample5.cs)]

<span data-ttu-id="f3086-181">Перед выполнением каких бы то ни было действий в обработчике событий `ItemCommand`, разумно сначала проверить значение входящего `CommandName`.</span><span class="sxs-lookup"><span data-stu-id="f3086-181">Before performing any action in the `ItemCommand` event handler, it s prudent to first check the value of the incoming `CommandName`.</span></span> <span data-ttu-id="f3086-182">Так как обработчик событий `ItemCommand` срабатывает при нажатии *любой* кнопки, если в шаблоне есть несколько кнопок, используется значение `CommandName`, чтобы определить, какое действие следует предпринять.</span><span class="sxs-lookup"><span data-stu-id="f3086-182">Since the `ItemCommand` event handler fires when *any* button is clicked, if there are multiple buttons in the template use the `CommandName` value to discern what action to take.</span></span> <span data-ttu-id="f3086-183">Проверка `CommandName` здесь затеи, так как у нас есть только одна кнопка, но это хороший привычка для формирования.</span><span class="sxs-lookup"><span data-stu-id="f3086-183">Checking the `CommandName` here is moot, since we only have a single button, but it is a good habit to form.</span></span> <span data-ttu-id="f3086-184">Затем `CategoryID` выбранной категории извлекается из свойства `CommandArgument`.</span><span class="sxs-lookup"><span data-stu-id="f3086-184">Next, the `CategoryID` of the selected category is retrieved from the `CommandArgument` property.</span></span> <span data-ttu-id="f3086-185">Затем на элемент управления Маркированный список в шаблоне указываются и привязываются результаты метода `ProductsBLL` класса `GetProductsByCategoryID(categoryID)`.</span><span class="sxs-lookup"><span data-stu-id="f3086-185">The BulletedList control in the template is then referenced and bound to the results of the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method.</span></span>

<span data-ttu-id="f3086-186">В предыдущих руководствах, в которых использовались кнопки в DataList, например [Общие сведения об изменении и удалении данных в DataList](../editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md), мы определили значение первичного ключа данного элемента через коллекцию `DataKeys`.</span><span class="sxs-lookup"><span data-stu-id="f3086-186">In previous tutorials that used the buttons within a DataList, such as [An Overview of Editing and Deleting Data in the DataList](../editing-and-deleting-data-through-the-datalist/an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md), we determined the primary key value of a given item via the `DataKeys` collection.</span></span> <span data-ttu-id="f3086-187">Хотя этот подход хорошо работает с элементом управления DataList, элемент управления Repeater не имеет свойства `DataKeys`.</span><span class="sxs-lookup"><span data-stu-id="f3086-187">While this approach works well with the DataList, the Repeater does not have a `DataKeys` property.</span></span> <span data-ttu-id="f3086-188">Вместо этого следует использовать альтернативный подход к предоставлению значения первичного ключа, например, с помощью кнопки `CommandArgument` свойство или назначив значение первичного ключа для веб-элемента управления скрытой метки в шаблоне и прочесть его значение обратно в обработчике событий `ItemCommand` с помощью `e.Item.FindControl("LabelID")`.</span><span class="sxs-lookup"><span data-stu-id="f3086-188">Instead, we must use an alternative approach for supplying the primary key value, such as through the button s `CommandArgument` property or by assigning the primary key value to a hidden Label Web control within the template and reading its value back in the `ItemCommand` event handler using `e.Item.FindControl("LabelID")`.</span></span>

<span data-ttu-id="f3086-189">После завершения `ItemCommand` обработчика событий проверьте эту страницу в браузере.</span><span class="sxs-lookup"><span data-stu-id="f3086-189">After completing the `ItemCommand` event handler, take a moment to test out this page in a browser.</span></span> <span data-ttu-id="f3086-190">Как показано на рис. 7, щелчок ссылки Показать продукты вызывает обратную передачу и отображает продукты для выбранной категории в маркированном списке.</span><span class="sxs-lookup"><span data-stu-id="f3086-190">As Figure 7 shows, clicking the Show Products link causes a postback and displays the products for the selected category in a BulletedList.</span></span> <span data-ttu-id="f3086-191">Кроме того, обратите внимание, что эти сведения о продукте остаются, даже если щелкнуть другие категории, чтобы отобразить ссылки на продукты.</span><span class="sxs-lookup"><span data-stu-id="f3086-191">Furthermore, note that this product information remains, even if other categories Show Products links are clicked.</span></span>

> [!NOTE]
> <span data-ttu-id="f3086-192">Если вы хотите изменить поведение этого отчета таким образом, чтобы в каждый момент времени была указана только одна категория продуктов категории, просто установите для свойства `EnableViewState` управления маркированными списками значение `False`.</span><span class="sxs-lookup"><span data-stu-id="f3086-192">If you want to modify the behavior of this report, such that the only one category s products are listed at a time, simply set the BulletedList control s `EnableViewState` property to `False`.</span></span>

<span data-ttu-id="f3086-193">[![для вывода продуктов выбранной категории используется маркированный список](custom-buttons-in-the-datalist-and-repeater-cs/_static/image16.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="f3086-193">[![A BulletedList is used to Display the Products of the Selected Category](custom-buttons-in-the-datalist-and-repeater-cs/_static/image16.png)](custom-buttons-in-the-datalist-and-repeater-cs/_static/image15.png)</span></span>

<span data-ttu-id="f3086-194">**Рис. 7**. для отображения продуктов выбранной категории используется маркированный список ([щелкните, чтобы просмотреть изображение с полным размером](custom-buttons-in-the-datalist-and-repeater-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="f3086-194">**Figure 7**: A BulletedList is used to Display the Products of the Selected Category ([Click to view full-size image](custom-buttons-in-the-datalist-and-repeater-cs/_static/image17.png))</span></span>

## <a name="summary"></a><span data-ttu-id="f3086-195">Сводка</span><span class="sxs-lookup"><span data-stu-id="f3086-195">Summary</span></span>

<span data-ttu-id="f3086-196">Элементы управления DataList и Repeater могут включать любое количество кнопок, LinkButton или Имажебуттонс в своих шаблонах.</span><span class="sxs-lookup"><span data-stu-id="f3086-196">The DataList and Repeater controls can include any number of Buttons, LinkButtons, or ImageButtons within their templates.</span></span> <span data-ttu-id="f3086-197">Такие кнопки при нажатии вызывают обратную передачу и вызывают событие `ItemCommand`.</span><span class="sxs-lookup"><span data-stu-id="f3086-197">Such buttons, when clicked, cause a postback and raise the `ItemCommand` event.</span></span> <span data-ttu-id="f3086-198">Чтобы связать пользовательское действие на стороне сервера с нажатой кнопкой, создайте обработчик событий для события `ItemCommand`.</span><span class="sxs-lookup"><span data-stu-id="f3086-198">To associate custom server-side action with a button being clicked, create an event handler for the `ItemCommand` event.</span></span> <span data-ttu-id="f3086-199">В этом обработчике событий сначала проверьте значение входящего `CommandName`, чтобы определить, какая кнопка была нажата.</span><span class="sxs-lookup"><span data-stu-id="f3086-199">In this event handler first check the incoming `CommandName` value to determine which button was clicked.</span></span> <span data-ttu-id="f3086-200">Дополнительные сведения можно дополнительно указать с помощью кнопки `CommandArgument` свойства.</span><span class="sxs-lookup"><span data-stu-id="f3086-200">Additional information can optionally be supplied through the button s `CommandArgument` property.</span></span>

<span data-ttu-id="f3086-201">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="f3086-201">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="f3086-202">Об авторе</span><span class="sxs-lookup"><span data-stu-id="f3086-202">About the Author</span></span>

<span data-ttu-id="f3086-203">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="f3086-203">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f3086-204">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="f3086-204">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f3086-205">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="f3086-205">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f3086-206">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f3086-206">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="f3086-207">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="f3086-207">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="f3086-208">Специальная благодарность</span><span class="sxs-lookup"><span data-stu-id="f3086-208">Special Thanks To</span></span>

<span data-ttu-id="f3086-209">Эта серия руководств была рассмотрена многими полезными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="f3086-209">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f3086-210">Специалист по интересу для этого руководства был Деннис Patterson.</span><span class="sxs-lookup"><span data-stu-id="f3086-210">Lead reviewer for this tutorial was Dennis Patterson.</span></span> <span data-ttu-id="f3086-211">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="f3086-211">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f3086-212">Если это так, расположите строку в [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f3086-212">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="f3086-213">Вперед</span><span class="sxs-lookup"><span data-stu-id="f3086-213">Next</span></span>](custom-buttons-in-the-datalist-and-repeater-vb.md)
