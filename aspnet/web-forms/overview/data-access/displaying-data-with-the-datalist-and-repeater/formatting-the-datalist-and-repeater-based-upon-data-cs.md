---
uid: web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-cs
title: Форматирование элементов управления DataList и Repeater на основе данных (C#) | Документация Майкрософт
author: rick-anderson
description: В этом учебнике мы рассмотрим примеры форматирования внешнего вида элементов управления DataList и Repeater с помощью функций форматирования с...
ms.author: riande
ms.date: 09/13/2006
ms.assetid: 83e3d759-82b8-41e6-8d62-f0f4b3edec41
msc.legacyurl: /web-forms/overview/data-access/displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-cs
msc.type: authoredcontent
ms.openlocfilehash: 68de3450ed97fc7bd0efb27e089d9db8e3e85fb0
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/28/2019
ms.locfileid: "74633275"
---
# <a name="formatting-the-datalist-and-repeater-based-upon-data-c"></a><span data-ttu-id="c39dd-103">Форматирование элементов управления DataList и Repeater в зависимости от данных (C#)</span><span class="sxs-lookup"><span data-stu-id="c39dd-103">Formatting the DataList and Repeater Based Upon Data (C#)</span></span>

<span data-ttu-id="c39dd-104">по [Скотт Митчелл](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c39dd-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c39dd-105">[Скачивание примера приложения](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_CS.exe) или [Загрузка PDF-файла](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/datatutorial30cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c39dd-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_30_CS.exe) or [Download PDF](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/datatutorial30cs1.pdf)</span></span>

> <span data-ttu-id="c39dd-106">В этом учебнике мы рассмотрим примеры форматирования внешнего вида элементов управления DataList и Repeater с помощью функций форматирования в шаблонах или обработки события DataBound.</span><span class="sxs-lookup"><span data-stu-id="c39dd-106">In this tutorial we'll step through examples of how we format the appearance of the DataList and Repeater controls, either by using formatting functions within templates or by handling the DataBound event.</span></span>

## <a name="introduction"></a><span data-ttu-id="c39dd-107">Введение</span><span class="sxs-lookup"><span data-stu-id="c39dd-107">Introduction</span></span>

<span data-ttu-id="c39dd-108">Как было показано в предыдущем учебном курсе, DataList предлагает ряд свойств, связанных со стилем, которые влияют на его внешний вид.</span><span class="sxs-lookup"><span data-stu-id="c39dd-108">As we saw in the preceding tutorial, the DataList offers a number of style-related properties that affect its appearance.</span></span> <span data-ttu-id="c39dd-109">В частности, мы увидели, как назначить классы CSS по умолчанию свойствам DataList `HeaderStyle`, `ItemStyle`, `AlternatingItemStyle`и `SelectedItemStyle`.</span><span class="sxs-lookup"><span data-stu-id="c39dd-109">In particular, we saw how to assign default CSS classes to the DataList s `HeaderStyle`, `ItemStyle`, `AlternatingItemStyle`, and `SelectedItemStyle` properties.</span></span> <span data-ttu-id="c39dd-110">В дополнение к этим четырем свойствам DataList содержит ряд других свойств, связанных с стилем, таких как `Font`, `ForeColor`, `BackColor`и `BorderWidth`, для нескольких имен.</span><span class="sxs-lookup"><span data-stu-id="c39dd-110">In addition to these four properties, the DataList includes a number of other style-related properties, such as `Font`, `ForeColor`, `BackColor`, and `BorderWidth`, to name a few.</span></span> <span data-ttu-id="c39dd-111">Элемент управления Repeater не содержит свойств, связанных со стилем.</span><span class="sxs-lookup"><span data-stu-id="c39dd-111">The Repeater control does not contain any style-related properties.</span></span> <span data-ttu-id="c39dd-112">Все такие параметры стиля должны быть сделаны непосредственно в разметке в шаблонах Repeater s.</span><span class="sxs-lookup"><span data-stu-id="c39dd-112">Any such style settings must be made directly within the markup in the Repeater s templates.</span></span>

<span data-ttu-id="c39dd-113">Однако часто форматирование данных зависит от самих данных.</span><span class="sxs-lookup"><span data-stu-id="c39dd-113">Often, though, how data should be formatted depends on the data itself.</span></span> <span data-ttu-id="c39dd-114">Например, при перечислении продуктов может потребоваться отобразить сведения о продукте в светло-сером цвете шрифта, если он снят, или же можно выделить `UnitsInStock` значение, если оно равно нулю.</span><span class="sxs-lookup"><span data-stu-id="c39dd-114">For example, when listing products we might want to display the product information in a light gray font color if it is discontinued, or we may want to highlight the `UnitsInStock` value if it is zero.</span></span> <span data-ttu-id="c39dd-115">Как мы видели в предыдущих руководствах, GridView, DetailsView и FormView предлагают два различных способа форматирования своего внешнего вида на основе их данных:</span><span class="sxs-lookup"><span data-stu-id="c39dd-115">As we saw in previous tutorials, the GridView, DetailsView, and FormView offer two distinct ways to format their appearance based on their data:</span></span>

- <span data-ttu-id="c39dd-116">**Событие `DataBound`** создает обработчик событий для соответствующего события `DataBound`, которое срабатывает после привязки данных к каждому элементу (для GridView это событие `RowDataBound`; для элементов управления DataList и Repeater это событие `ItemDataBound`).</span><span class="sxs-lookup"><span data-stu-id="c39dd-116">**The `DataBound` event** create an event handler for the appropriate `DataBound` event, which fires after the data has been bound to each item (for the GridView it was the `RowDataBound` event; for the DataList and Repeater it is the `ItemDataBound` event).</span></span> <span data-ttu-id="c39dd-117">В этом обработчике событий можно проанализировать и отформатировать решения, связанные только с данными.</span><span class="sxs-lookup"><span data-stu-id="c39dd-117">In that event handler, the data just bound can be examined and formatting decisions made.</span></span> <span data-ttu-id="c39dd-118">Мы рассматривали этот метод в [пользовательском форматировании, основанном](../custom-formatting/custom-formatting-based-upon-data-cs.md) на руководстве по данным.</span><span class="sxs-lookup"><span data-stu-id="c39dd-118">We examined this technique in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-cs.md) tutorial.</span></span>
- <span data-ttu-id="c39dd-119">**Функции форматирования в шаблонах** при использовании полей TemplateField в элементах управления DetailsView или GridView или в шаблоне элемента управления FormView можно добавить функцию форматирования в класс кода программной части ASP.NET Page, уровень бизнес-логики или любую другую библиотеку классов, доступную из веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="c39dd-119">**Formatting Functions in Templates** when using TemplateFields in the DetailsView or GridView controls, or a template in the FormView control, we can add a formatting function to the ASP.NET page s code-behind class, the Business Logic Layer, or any other class library that is accessible from the web application.</span></span> <span data-ttu-id="c39dd-120">Эта функция форматирования может принимать произвольное число входных параметров, но должна возвращать HTML-код для отрисовки в шаблоне.</span><span class="sxs-lookup"><span data-stu-id="c39dd-120">This formatting function can accept an arbitrary number of input parameters, but must return the HTML to render in the template.</span></span> <span data-ttu-id="c39dd-121">Функции форматирования сначала были проверены в [с помощью полей TemplateField в руководстве по элементу управления GridView](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) .</span><span class="sxs-lookup"><span data-stu-id="c39dd-121">Formatting functions were first examined in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) tutorial.</span></span>

<span data-ttu-id="c39dd-122">Оба способа форматирования доступны в элементах управления DataList и Repeater.</span><span class="sxs-lookup"><span data-stu-id="c39dd-122">Both of these formatting techniques are available with the DataList and Repeater controls.</span></span> <span data-ttu-id="c39dd-123">В этом учебнике мы рассмотрим примеры использования обоих методов для обоих элементов управления.</span><span class="sxs-lookup"><span data-stu-id="c39dd-123">In this tutorial we'll step through examples using both techniques for both controls.</span></span>

## <a name="using-theitemdataboundevent-handler"></a><span data-ttu-id="c39dd-124">Использование обработчика событий`ItemDataBound`</span><span class="sxs-lookup"><span data-stu-id="c39dd-124">Using the`ItemDataBound`Event Handler</span></span>

<span data-ttu-id="c39dd-125">Когда данные привязываются к элементу управления DataList, как из элемента источника данных, так и путем программного назначения данных свойству `DataSource` управления и вызова метода `DataBind()`, вызывается событие DataList `DataBinding`, источник данных перечислено, а каждая запись данных привязывается к DataList.</span><span class="sxs-lookup"><span data-stu-id="c39dd-125">When data is bound to a DataList, either from a data source control or through programmatically assigning data to the control s `DataSource` property and calling its `DataBind()` method, the DataList s `DataBinding` event fires, the data source enumerated, and each data record is bound to the DataList.</span></span> <span data-ttu-id="c39dd-126">Для каждой записи в источнике данных DataList создает объект [`DataListItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx) , который затем привязывается к текущей записи.</span><span class="sxs-lookup"><span data-stu-id="c39dd-126">For each record in the data source, the DataList creates a [`DataListItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.aspx) object that is then bound to the current record.</span></span> <span data-ttu-id="c39dd-127">Во время этого процесса DataList вызывает два события:</span><span class="sxs-lookup"><span data-stu-id="c39dd-127">During this process, the DataList raises two events:</span></span>

- <span data-ttu-id="c39dd-128">**`ItemCreated`** срабатывает после создания `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="c39dd-128">**`ItemCreated`** fires after the `DataListItem` has been created</span></span>
- <span data-ttu-id="c39dd-129">**`ItemDataBound`** срабатывает после привязки текущей записи к `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="c39dd-129">**`ItemDataBound`** fires after the current record has been bound to the `DataListItem`</span></span>

<span data-ttu-id="c39dd-130">Следующие шаги описывают процесс привязки данных для элемента управления DataList.</span><span class="sxs-lookup"><span data-stu-id="c39dd-130">The following steps outline the data binding process for the DataList control.</span></span>

1. <span data-ttu-id="c39dd-131">Порождается [событие`DataBinding`](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx) DataList s</span><span class="sxs-lookup"><span data-stu-id="c39dd-131">The DataList s [`DataBinding` event](https://msdn.microsoft.com/library/system.web.ui.control.databinding.aspx) fires</span></span>
2. <span data-ttu-id="c39dd-132">Данные привязаны к DataList</span><span class="sxs-lookup"><span data-stu-id="c39dd-132">The data is bound to the DataList</span></span>  
  
   <span data-ttu-id="c39dd-133">Для каждой записи в источнике данных</span><span class="sxs-lookup"><span data-stu-id="c39dd-133">For each record in the data source</span></span> 

    1. <span data-ttu-id="c39dd-134">Создание объекта `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="c39dd-134">Create a `DataListItem` object</span></span>
    2. <span data-ttu-id="c39dd-135">Запустить [событие`ItemCreated`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span><span class="sxs-lookup"><span data-stu-id="c39dd-135">Fire the [`ItemCreated` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemcreated.aspx)</span></span>
    3. <span data-ttu-id="c39dd-136">Привязка записи к `DataListItem`</span><span class="sxs-lookup"><span data-stu-id="c39dd-136">Bind the record to the `DataListItem`</span></span>
    4. <span data-ttu-id="c39dd-137">Запустить [событие`ItemDataBound`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span><span class="sxs-lookup"><span data-stu-id="c39dd-137">Fire the [`ItemDataBound` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.itemdatabound.aspx)</span></span>
    5. <span data-ttu-id="c39dd-138">Добавление `DataListItem` в коллекцию `Items`</span><span class="sxs-lookup"><span data-stu-id="c39dd-138">Add the `DataListItem` to the `Items` collection</span></span>

<span data-ttu-id="c39dd-139">При привязке данных к элементу управления Repeater он проходит точную последовательность шагов.</span><span class="sxs-lookup"><span data-stu-id="c39dd-139">When binding data to the Repeater control, it progresses through the exact same sequence of steps.</span></span> <span data-ttu-id="c39dd-140">Единственное отличие заключается в том, что вместо создаваемых экземпляров `DataListItem`, Repeater использует [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s.</span><span class="sxs-lookup"><span data-stu-id="c39dd-140">The only difference is that instead of `DataListItem` instances being created, the Repeater uses [`RepeaterItem`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeateritem(VS.80).aspx)s.</span></span>

> [!NOTE]
> <span data-ttu-id="c39dd-141">Читатель внимательный мог заметить незначительную аномалию между последовательностью действий, которые возникают, когда элемент управления DataList и Repeater привязаны к данным, а элемент управления GridView привязан к данным.</span><span class="sxs-lookup"><span data-stu-id="c39dd-141">The astute reader may have noticed a slight anomaly between the sequence of steps that transpire when the DataList and Repeater are bound to data versus when the GridView is bound to data.</span></span> <span data-ttu-id="c39dd-142">В заключительном конце процесса привязки данных GridView вызывает событие `DataBound`; Однако ни элемент управления DataList, ни Repeater не имеют такого события.</span><span class="sxs-lookup"><span data-stu-id="c39dd-142">At the tail end of the data binding process, the GridView raises the `DataBound` event; however, neither the DataList nor Repeater control have such an event.</span></span> <span data-ttu-id="c39dd-143">Это связано с тем, что элементы управления DataList и Repeater были созданы обратно в период ASP.NET 1. x, до того, как шаблон обработчика событий до и после этого был распространен.</span><span class="sxs-lookup"><span data-stu-id="c39dd-143">This is because the DataList and Repeater controls were created back in the ASP.NET 1.x timeframe, before the pre- and post-level event handler pattern had become common.</span></span>

<span data-ttu-id="c39dd-144">Как и в случае с GridView, одним из вариантов форматирования на основе данных является создание обработчика для события `ItemDataBound`.</span><span class="sxs-lookup"><span data-stu-id="c39dd-144">Like with the GridView, one option for formatting based on the data is to create an event handler for the `ItemDataBound` event.</span></span> <span data-ttu-id="c39dd-145">Этот обработчик событий проверит данные, которые были только что привязаны к `DataListItem` или `RepeaterItem` и влияет на форматирование элемента управления по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="c39dd-145">This event handler would inspect the data that had just been bound to the `DataListItem` or `RepeaterItem` and affect the formatting of the control as needed.</span></span>

<span data-ttu-id="c39dd-146">Для элемента управления DataList изменения форматирования для всего элемента можно реализовать с помощью свойств, связанных со стилем `DataListItem` s, которые включают стандартные `Font`, `ForeColor`, `BackColor`, `CssClass`и т. д.</span><span class="sxs-lookup"><span data-stu-id="c39dd-146">For the DataList control, formatting changes for the entire item can be implemented using the `DataListItem` s style-related properties, which include the standard `Font`, `ForeColor`, `BackColor`, `CssClass`, and so on.</span></span> <span data-ttu-id="c39dd-147">Чтобы повлиять на форматирование определенных веб-элементов управления в шаблоне DataList, необходимо программно получить доступ и изменить стиль этих веб-элементов управления.</span><span class="sxs-lookup"><span data-stu-id="c39dd-147">To affect the formatting of particular Web controls within the DataList s template, we need to programmatically access and modify the style of those Web controls.</span></span> <span data-ttu-id="c39dd-148">Мы увидели, как это сделать в *пользовательском форматировании, основанном* на руководстве по данным.</span><span class="sxs-lookup"><span data-stu-id="c39dd-148">We saw how to accomplish this back in the *Custom Formatting Based Upon Data* tutorial.</span></span> <span data-ttu-id="c39dd-149">Как и элемент управления Repeater, класс `RepeaterItem` не имеет свойств, связанных со стилем; Таким образом, все изменения, связанные с стилями, внесенные в `RepeaterItem` в обработчике событий `ItemDataBound`, должны быть выполнены программным доступом и обновлением веб-элементов управления в шаблоне.</span><span class="sxs-lookup"><span data-stu-id="c39dd-149">Like the Repeater control, the `RepeaterItem` class has no style-related properties; therefore, all style-related changes made to a `RepeaterItem` in the `ItemDataBound` event handler must be done by programmatically accessing and updating Web controls within the template.</span></span>

<span data-ttu-id="c39dd-150">Так как методика форматирования `ItemDataBound` для DataList и Repeater практически идентичны, наш пример будет сосредоточиться на использовании DataList.</span><span class="sxs-lookup"><span data-stu-id="c39dd-150">Since the `ItemDataBound` formatting technique for the DataList and Repeater are virtually identical, our example will focus on using the DataList.</span></span>

## <a name="step-1-displaying-product-information-in-the-datalist"></a><span data-ttu-id="c39dd-151">Шаг 1. Отображение сведений о продукте в DataList</span><span class="sxs-lookup"><span data-stu-id="c39dd-151">Step 1: Displaying Product Information in the DataList</span></span>

<span data-ttu-id="c39dd-152">Прежде чем беспокоиться о форматировании, давайте сначала создадим страницу, которая использует элемент управления DataList для вывода сведений о продукте.</span><span class="sxs-lookup"><span data-stu-id="c39dd-152">Before we worry about the formatting, let s first create a page that uses a DataList to display product information.</span></span> <span data-ttu-id="c39dd-153">В [предыдущем учебном курсе](displaying-data-with-the-datalist-and-repeater-controls-cs.md) мы создали элемент управления DataList, на котором `ItemTemplate` отображалось название, категория, поставщик, количество на единицу и цена.</span><span class="sxs-lookup"><span data-stu-id="c39dd-153">In the [previous tutorial](displaying-data-with-the-datalist-and-repeater-controls-cs.md) we created a DataList whose `ItemTemplate` displayed each product s name, category, supplier, quantity per unit, and price.</span></span> <span data-ttu-id="c39dd-154">Давайте повторим эту функциональность в этом руководстве.</span><span class="sxs-lookup"><span data-stu-id="c39dd-154">Let s repeat this functionality here in this tutorial.</span></span> <span data-ttu-id="c39dd-155">Для этого можно либо повторно создать элемент управления DataList, либо его ObjectDataSource с нуля, либо скопировать их на страницу, созданную в предыдущем учебнике (`Basics.aspx`), и вставить их на страницу этого учебника (`Formatting.aspx`).</span><span class="sxs-lookup"><span data-stu-id="c39dd-155">To accomplish this, you can either recreate the DataList and its ObjectDataSource from scratch, or you can copy over those controls from the page created in the previous tutorial (`Basics.aspx`) and paste them into the page for this tutorial (`Formatting.aspx`).</span></span>

<span data-ttu-id="c39dd-156">После того как функции DataList и ObjectDataSource были реплицированы из `Basics.aspx` в `Formatting.aspx`, необходимо изменить свойство `ID` DataList s с `DataList1` на более описательное `ItemDataBoundFormattingExample`.</span><span class="sxs-lookup"><span data-stu-id="c39dd-156">Once you have replicated the DataList and ObjectDataSource functionality from `Basics.aspx` into `Formatting.aspx`, take a moment to change the DataList s `ID` property from `DataList1` to a more descriptive `ItemDataBoundFormattingExample`.</span></span> <span data-ttu-id="c39dd-157">Затем просмотрите элемент управления DataList в браузере.</span><span class="sxs-lookup"><span data-stu-id="c39dd-157">Next, view the DataList in a browser.</span></span> <span data-ttu-id="c39dd-158">Как показано на рис. 1, единственное различие форматирования между каждым продуктом заключается в том, что цвет фона является альтернативой.</span><span class="sxs-lookup"><span data-stu-id="c39dd-158">As Figure 1 shows, the only formatting difference between each product is that the background color alternates.</span></span>

<span data-ttu-id="c39dd-159">[![продукты перечислены в элементе управления DataList](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c39dd-159">[![The Products are Listed in the DataList Control](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image2.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image1.png)</span></span>

<span data-ttu-id="c39dd-160">**Рис. 1**. продукты перечислены в элементе управления DataList ([щелкните, чтобы просмотреть изображение с полным размером](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="c39dd-160">**Figure 1**: The Products are Listed in the DataList Control ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image3.png))</span></span>

<span data-ttu-id="c39dd-161">В этом руководстве мы будем форматировать элемент управления DataList так, чтобы для всех продуктов, цена которых меньше $20,00, были выбраны желтые названия и цена за единицу.</span><span class="sxs-lookup"><span data-stu-id="c39dd-161">For this tutorial, let s format the DataList such that any products with a price less than $20.00 will have both its name and unit price highlighted yellow.</span></span>

## <a name="step-2-programmatically-determining-the-value-of-the-data-in-the-itemdatabound-event-handler"></a><span data-ttu-id="c39dd-162">Шаг 2. Программное определение значения данных в обработчике событий ItemDataBound</span><span class="sxs-lookup"><span data-stu-id="c39dd-162">Step 2: Programmatically Determining the Value of the Data in the ItemDataBound Event Handler</span></span>

<span data-ttu-id="c39dd-163">Поскольку только продукты с ценой в $20,00 будут иметь настраиваемое форматирование, необходимо иметь возможность определить цену за каждый продукт.</span><span class="sxs-lookup"><span data-stu-id="c39dd-163">Since only those products with a price under $20.00 will have the custom formatting applied, we must be able to determine each product s price.</span></span> <span data-ttu-id="c39dd-164">При привязке данных к элементу управления DataList перечисляет записи в источнике данных, а для каждой записи создает экземпляр `DataListItem`, привязывая запись источника данных к `DataListItem`.</span><span class="sxs-lookup"><span data-stu-id="c39dd-164">When binding data to a DataList, the DataList enumerates the records in its data source and, for each record, creates a `DataListItem` instance, binding the data source record to the `DataListItem`.</span></span> <span data-ttu-id="c39dd-165">После привязки данных записи к текущему объекту `DataListItem` срабатывает событие `ItemDataBound` DataList.</span><span class="sxs-lookup"><span data-stu-id="c39dd-165">After the particular record s data has been bound to the current `DataListItem` object, the DataList s `ItemDataBound` event is fired.</span></span> <span data-ttu-id="c39dd-166">Можно создать обработчик событий для этого события, чтобы проверить значения данных для текущего `DataListItem` и, основываясь на этих значениях, внести необходимые изменения форматирования.</span><span class="sxs-lookup"><span data-stu-id="c39dd-166">We can create an event handler for this event to inspect the data values for the current `DataListItem` and, based upon those values, make any formatting changes necessary.</span></span>

<span data-ttu-id="c39dd-167">Создайте событие `ItemDataBound` для DataList и добавьте следующий код:</span><span class="sxs-lookup"><span data-stu-id="c39dd-167">Create an `ItemDataBound` event for the DataList and add the following code:</span></span>

[!code-csharp[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample1.cs)]

<span data-ttu-id="c39dd-168">В то время как концепция и семантика для обработчика событий DataList `ItemDataBound` совпадают с теми, которые используются обработчиком событий GridView s `RowDataBound` в *пользовательском форматировании, основанном* на руководстве по данным, синтаксис немного различается.</span><span class="sxs-lookup"><span data-stu-id="c39dd-168">While the concept and semantics behind the DataList s `ItemDataBound` event handler are the same as those used by the GridView s `RowDataBound` event handler in the *Custom Formatting Based Upon Data* tutorial, the syntax differs slightly.</span></span> <span data-ttu-id="c39dd-169">При срабатывании события `ItemDataBound` `DataListItem`, только что привязанные к данным, передаются в соответствующий обработчик событий через `e.Item` (вместо `e.Row`, как в обработчике событий GridView `RowDataBound`).</span><span class="sxs-lookup"><span data-stu-id="c39dd-169">When the `ItemDataBound` event fires, the `DataListItem` just bound to data is passed into corresponding event handler via `e.Item` (instead of `e.Row`, as with the GridView s `RowDataBound` event handler).</span></span> <span data-ttu-id="c39dd-170">Обработчик событий DataList `ItemDataBound` вызывается для *каждой* строки, добавленной в DataList, включая строки заголовков, нижние колонтитулы и разделительные строки.</span><span class="sxs-lookup"><span data-stu-id="c39dd-170">The DataList s `ItemDataBound` event handler fires for *each* row added to the DataList, including header rows, footer rows, and separator rows.</span></span> <span data-ttu-id="c39dd-171">Однако сведения о продукте привязываются только к строкам данных.</span><span class="sxs-lookup"><span data-stu-id="c39dd-171">However, the product information is only bound to the data rows.</span></span> <span data-ttu-id="c39dd-172">Поэтому при использовании события `ItemDataBound` для проверки данных, привязанных к DataList, сначала необходимо убедиться, что мы переработали с элементом данных.</span><span class="sxs-lookup"><span data-stu-id="c39dd-172">Therefore, when using the `ItemDataBound` event to inspect the data bound to the DataList, we need to first ensure that we re working with a data item.</span></span> <span data-ttu-id="c39dd-173">Это можно сделать, проверив [свойство `DataListItem``ItemType`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx), которое может иметь одно из [следующих восьми значений](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx):</span><span class="sxs-lookup"><span data-stu-id="c39dd-173">This can be accomplished by checking the `DataListItem` s [`ItemType` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalistitem.itemtype.aspx), which can have one of [the following eight values](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listitemtype.aspx):</span></span>

- `AlternatingItem`
- `EditItem`
- `Footer`
- `Header`
- `Item`
- `Pager`
- `SelectedItem`
- `Separator`

<span data-ttu-id="c39dd-174">Как `Item`, так и `AlternatingItem``DataListItem` s описывающего элементы данных DataList.</span><span class="sxs-lookup"><span data-stu-id="c39dd-174">Both `Item` and `AlternatingItem``DataListItem` s makeup the DataList s data items.</span></span> <span data-ttu-id="c39dd-175">При условии, что мы переработали `Item` или `AlternatingItem`, мы доступим к реальному экземпляру `ProductsRow`, который был привязан к текущему `DataListItem`.</span><span class="sxs-lookup"><span data-stu-id="c39dd-175">Assuming we re working with an `Item` or `AlternatingItem`, we access the actual `ProductsRow` instance that was bound to the current `DataListItem`.</span></span> <span data-ttu-id="c39dd-176">Свойство `DataListItem` s [`DataItem`](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx) содержит ссылку на объект `DataRowView`, свойство `Row` которого предоставляет ссылку на фактический объект `ProductsRow`.</span><span class="sxs-lookup"><span data-stu-id="c39dd-176">The `DataListItem` s [`DataItem` property](https://msdn.microsoft.com/system.web.ui.webcontrols.datalistitem.dataitem.aspx) contains a reference to the `DataRowView` object, whose `Row` property provides a reference to the actual `ProductsRow` object.</span></span>

<span data-ttu-id="c39dd-177">Далее мы проверяем свойство `ProductsRow` экземпляра `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="c39dd-177">Next, we check the `ProductsRow` instance s `UnitPrice` property.</span></span> <span data-ttu-id="c39dd-178">Так как таблица Products s `UnitPrice` допускает `NULL` значений, прежде чем пытаться получить доступ к свойству `UnitPrice`, необходимо сначала проверить, имеет ли оно значение `NULL` с помощью метода `IsUnitPriceNull()`.</span><span class="sxs-lookup"><span data-stu-id="c39dd-178">Since the Products table s `UnitPrice` field allows `NULL` values, before attempting to access the `UnitPrice` property we should first check to see if it has a `NULL` value using the `IsUnitPriceNull()` method.</span></span> <span data-ttu-id="c39dd-179">Если значение `UnitPrice` не `NULL`, то проверяется, меньше ли его $20,00.</span><span class="sxs-lookup"><span data-stu-id="c39dd-179">If the `UnitPrice` value is not `NULL`, we then check to see if it s less than $20.00.</span></span> <span data-ttu-id="c39dd-180">Если он действительно находится в $20,00, необходимо применить пользовательское форматирование.</span><span class="sxs-lookup"><span data-stu-id="c39dd-180">If it is indeed under $20.00, we then need to apply the custom formatting.</span></span>

## <a name="step-3-highlighting-the-product-s-name-and-price"></a><span data-ttu-id="c39dd-181">Шаг 3. выделение имени и цены продукта</span><span class="sxs-lookup"><span data-stu-id="c39dd-181">Step 3: Highlighting the Product s Name and Price</span></span>

<span data-ttu-id="c39dd-182">Когда мы понимаем, что цена продукта меньше $20,00, остается только выделить ее название и цену.</span><span class="sxs-lookup"><span data-stu-id="c39dd-182">Once we know that a product s price is less than $20.00, all that remains is to highlight its name and price.</span></span> <span data-ttu-id="c39dd-183">Для этого необходимо сначала программно ссылаться на элементы управления Label в `ItemTemplate`, отображающих название и цену продукта.</span><span class="sxs-lookup"><span data-stu-id="c39dd-183">To accomplish this, we must first programmatically reference the Label controls in the `ItemTemplate` that display the product s name and price.</span></span> <span data-ttu-id="c39dd-184">Далее необходимо, чтобы в них отображался желтый фон.</span><span class="sxs-lookup"><span data-stu-id="c39dd-184">Next, we need to have them display a yellow background.</span></span> <span data-ttu-id="c39dd-185">Эти сведения о форматировании могут быть применены путем непосредственного изменения меток `BackColor` свойствами (`LabelID.BackColor = Color.Yellow`). Однако в идеале все вопросы, связанные с отображением, должны выражаться в каскадных таблицах стилей.</span><span class="sxs-lookup"><span data-stu-id="c39dd-185">This formatting information can be applied by directly modifying the Labels `BackColor` properties (`LabelID.BackColor = Color.Yellow`); ideally, though, all display-related matters should be expressed through cascading stylesheets.</span></span> <span data-ttu-id="c39dd-186">На самом деле, у нас уже есть таблица стилей, предоставляющая требуемое форматирование, определенное в `Styles.css` - `AffordablePriceEmphasis`, которое было создано и рассмотрено в руководстве по работе с *данными в пользовательском формате* .</span><span class="sxs-lookup"><span data-stu-id="c39dd-186">In fact, we already have a stylesheet that provides the desired formatting defined in `Styles.css` - `AffordablePriceEmphasis`, which was created and discussed in the *Custom Formatting Based Upon Data* tutorial.</span></span>

<span data-ttu-id="c39dd-187">Чтобы применить форматирование, просто задайте для двух веб-элементов управления Label `CssClass` свойства `AffordablePriceEmphasis`, как показано в следующем коде:</span><span class="sxs-lookup"><span data-stu-id="c39dd-187">To apply the formatting, simply set the two Label Web controls `CssClass` properties to `AffordablePriceEmphasis`, as shown in the following code:</span></span>

[!code-csharp[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample2.cs)]

<span data-ttu-id="c39dd-188">После завершения обработчика `ItemDataBound` событий перейдите на страницу `Formatting.aspx` в браузере.</span><span class="sxs-lookup"><span data-stu-id="c39dd-188">With the `ItemDataBound` event handler completed, revisit the `Formatting.aspx` page in a browser.</span></span> <span data-ttu-id="c39dd-189">Как показано на рис. 2, продукты с ценой ниже $20,00 имеют выделенное имя и цену.</span><span class="sxs-lookup"><span data-stu-id="c39dd-189">As Figure 2 illustrates, those products with a price under $20.00 have both their name and price highlighted.</span></span>

<span data-ttu-id="c39dd-190">[![выделены эти продукты меньше $20,00](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="c39dd-190">[![Those Products Less than $20.00 are Highlighted](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image5.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image4.png)</span></span>

<span data-ttu-id="c39dd-191">**Рис. 2**. выделены продукты, размер которых меньше $20,00 ([щелкните, чтобы просмотреть изображение с полным размером](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="c39dd-191">**Figure 2**: Those Products Less than $20.00 are Highlighted ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image6.png))</span></span>

> [!NOTE]
> <span data-ttu-id="c39dd-192">Поскольку элемент управления DataList подготавливается к просмотру как HTML-`<table>`, его экземпляры `DataListItem` имеют свойства, связанные со стилем, которые можно задать для применения определенного стиля ко всему элементу.</span><span class="sxs-lookup"><span data-stu-id="c39dd-192">Since the DataList is rendered as an HTML `<table>`, its `DataListItem` instances have style-related properties that can be set to apply a specific style to the entire item.</span></span> <span data-ttu-id="c39dd-193">Например, если нужно выделить *желтый элемент,* если его цена меньше $20,00, можно было бы заменить код, на который ссылаются метки, и задать свойства `CssClass` с помощью следующей строки кода: `e.Item.CssClass = "AffordablePriceEmphasis"` (см. рис. 3).</span><span class="sxs-lookup"><span data-stu-id="c39dd-193">For example, if we wanted to highlight the *entire* item yellow when its price was less than $20.00, we could have replaced the code that referenced the Labels and set their `CssClass` properties with the following line of code: `e.Item.CssClass = "AffordablePriceEmphasis"` (see Figure 3).</span></span>

<span data-ttu-id="c39dd-194">Однако `RepeaterItem`, которые составляют элемент управления Repeater, не предоставляют такие свойства на уровне стиля.</span><span class="sxs-lookup"><span data-stu-id="c39dd-194">The `RepeaterItem` s that make up the Repeater control, however, don t offer such style-level properties.</span></span> <span data-ttu-id="c39dd-195">Таким образом, применение пользовательского форматирования к элементу управления Repeater требует применения свойств стиля к веб-элементам, которые находятся в шаблонах Repeater, точно так же, как показано на рис. 2.</span><span class="sxs-lookup"><span data-stu-id="c39dd-195">Therefore, applying custom formatting to the Repeater requires the application of style properties to the Web controls within the Repeater s templates, just like we did in Figure 2.</span></span>

<span data-ttu-id="c39dd-196">[![весь элемент продукта выделяется для продуктов под управлением $20,00](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="c39dd-196">[![The Entire Product Item is Highlighted for Products Under $20.00](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image8.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image7.png)</span></span>

<span data-ttu-id="c39dd-197">**Рис. 3**. весь элемент продукта выделяется для продуктов под заголовком $20,00 ([щелкните, чтобы просмотреть изображение с полным размером](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="c39dd-197">**Figure 3**: The Entire Product Item is Highlighted for Products Under $20.00 ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image9.png))</span></span>

## <a name="using-formatting-functions-from-within-the-template"></a><span data-ttu-id="c39dd-198">Использование функций форматирования в шаблоне</span><span class="sxs-lookup"><span data-stu-id="c39dd-198">Using Formatting Functions from Within the Template</span></span>

<span data-ttu-id="c39dd-199">В учебнике *Использование полей TemplateField в руководстве по элементу управления GridView* мы увидели, как использовать функцию форматирования в GridView TemplateField для применения пользовательского форматирования на основе данных, привязанных к строкам GridView s.</span><span class="sxs-lookup"><span data-stu-id="c39dd-199">In the *Using TemplateFields in the GridView Control* tutorial we saw how to use a formatting function within a GridView TemplateField to apply custom formatting based upon the data bound to the GridView s rows.</span></span> <span data-ttu-id="c39dd-200">Функция форматирования — это метод, который может быть вызван из шаблона и возвращать HTML, который будет выдаваться на его месте.</span><span class="sxs-lookup"><span data-stu-id="c39dd-200">A formatting function is a method that can be invoked from a template and returns the HTML to be emitted in its place.</span></span> <span data-ttu-id="c39dd-201">Функции форматирования могут находиться в классе кода программной части ASP.NET Page s или могут быть централизованы в файлы классов в папке `App_Code` или в отдельном проекте библиотеки классов.</span><span class="sxs-lookup"><span data-stu-id="c39dd-201">Formatting functions can reside in the ASP.NET page s code-behind class or can be centralized into class files in the `App_Code` folder or in a separate Class Library project.</span></span> <span data-ttu-id="c39dd-202">Перемещение функции форматирования из класса кода программной части ASP.NET Pages идеально подходит, если вы планируете использовать ту же функцию форматирования на нескольких ASP.NET страницах или в других веб-приложениях ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="c39dd-202">Moving the formatting function out of the ASP.NET page s code-behind class is ideal if you plan on using the same formatting function in multiple ASP.NET pages or in other ASP.NET web applications.</span></span>

<span data-ttu-id="c39dd-203">Чтобы продемонстрировать функции форматирования, добавим в сведения о продукте текст [снят с производства] рядом с названием продукта, если оно больше не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="c39dd-203">To demonstrate formatting functions, let s have the product information include the text [DISCONTINUED] next to the product s name if it s discontinued.</span></span> <span data-ttu-id="c39dd-204">Кроме того, пусть Цена выделена желтым цветом, если она меньше $20,00 (как в примере обработчика событий `ItemDataBound`); Если цена $20,00 или более поздняя, не выводит фактическую цену, а вместо текста вызовите предложение с расценками цены.</span><span class="sxs-lookup"><span data-stu-id="c39dd-204">Also, let s have the price highlighted yellow if it s less than $20.00 (as we did in the `ItemDataBound` event handler example); if the price is $20.00 or higher, let s not display the actual price, but instead the text, Please call for a price quote.</span></span> <span data-ttu-id="c39dd-205">На рис. 4 показан снимок экрана со списком продуктов с примененными правилами форматирования.</span><span class="sxs-lookup"><span data-stu-id="c39dd-205">Figure 4 shows a screen shot of the products listing with these formatting rules applied.</span></span>

<span data-ttu-id="c39dd-206">[![для дорогостоящих продуктов цена заменяется текстом, вызовите для предложения цены.](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="c39dd-206">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image11.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image10.png)</span></span>

<span data-ttu-id="c39dd-207">**Рис. 4**. для дорогостоящих продуктов цена заменяется текстом, вызовите предложение с расценками цены ([щелкните, чтобы просмотреть изображение с полным размером](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image12.png)).</span><span class="sxs-lookup"><span data-stu-id="c39dd-207">**Figure 4**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image12.png))</span></span>

## <a name="step-1-create-the-formatting-functions"></a><span data-ttu-id="c39dd-208">Шаг 1. Создание функций форматирования</span><span class="sxs-lookup"><span data-stu-id="c39dd-208">Step 1: Create the Formatting Functions</span></span>

<span data-ttu-id="c39dd-209">В этом примере нам нужны две функции форматирования, одна из которых отображает название продукта вместе с текстом [снят с производства], если это необходимо, а другая, отображающая выделенную цену, если она меньше $20,00 или текста, в противном случае вызовите предложение цены.</span><span class="sxs-lookup"><span data-stu-id="c39dd-209">For this example we need two formatting functions, one that displays the product name along with the text [DISCONTINUED], if needed, and another that displays either a highlighted price if it s less than $20.00, or the text, Please call for a price quote otherwise.</span></span> <span data-ttu-id="c39dd-210">Давайте создадим эти функции в классе кода программной части ASP.NET Page s и назовем их `DisplayProductNameAndDiscontinuedStatus` и `DisplayPrice`.</span><span class="sxs-lookup"><span data-stu-id="c39dd-210">Let s create these functions in the ASP.NET page s code-behind class and name them `DisplayProductNameAndDiscontinuedStatus` and `DisplayPrice`.</span></span> <span data-ttu-id="c39dd-211">Оба метода должны возвращать HTML-код для отображения в виде строки и должны быть помечены как `Protected` (или `Public`), чтобы вызываться из части декларативного синтаксиса страниц ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="c39dd-211">Both methods need to return the HTML to render as a string and both need to be marked `Protected` (or `Public`) in order to be invoked from the ASP.NET page s declarative syntax portion.</span></span> <span data-ttu-id="c39dd-212">Ниже приведен код для этих двух методов:</span><span class="sxs-lookup"><span data-stu-id="c39dd-212">The code for these two methods follows:</span></span>

[!code-csharp[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample3.cs)]

<span data-ttu-id="c39dd-213">Обратите внимание, что метод `DisplayProductNameAndDiscontinuedStatus` принимает значения полей данных `productName` и `discontinued` в виде скалярных значений, тогда как метод `DisplayPrice` принимает экземпляр `ProductsRow` (а не `unitPrice` скалярное значение).</span><span class="sxs-lookup"><span data-stu-id="c39dd-213">Note that the `DisplayProductNameAndDiscontinuedStatus` method accepts the values of the `productName` and `discontinued` data fields as scalar values, whereas the `DisplayPrice` method accepts a `ProductsRow` instance (rather than a `unitPrice` scalar value).</span></span> <span data-ttu-id="c39dd-214">Любой из этих подходов будет работать. Однако если функция форматирования работает со скалярными значениями, которые могут содержать значения `NULL` базы данных (например, `UnitPrice`; ни `ProductName`, ни `Discontinued` не допускают `NULL` значений), при обработке этих скалярных входных данных необходимо уделить особое внимание.</span><span class="sxs-lookup"><span data-stu-id="c39dd-214">Either approach will work; however, if the formatting function is working with scalar values that can contain database `NULL` values (such as `UnitPrice`; neither `ProductName` nor `Discontinued` allow `NULL` values), special care must be taken in handling these scalar inputs.</span></span>

<span data-ttu-id="c39dd-215">В частности, входной параметр должен иметь тип `Object`, так как входящее значение может быть `DBNull`ным экземпляром, а не ожидаемым типом данных.</span><span class="sxs-lookup"><span data-stu-id="c39dd-215">In particular, the input parameter must be of type `Object` since the incoming value might be a `DBNull` instance instead of the expected data type.</span></span> <span data-ttu-id="c39dd-216">Кроме того, необходимо выполнить проверку, чтобы определить, является ли входящее значение значением `NULL` базы данных.</span><span class="sxs-lookup"><span data-stu-id="c39dd-216">Additionally, a check must be made to determine whether or not the incoming value is a database `NULL` value.</span></span> <span data-ttu-id="c39dd-217">То есть, если нам требовалось, чтобы метод `DisplayPrice` принимал цену как скалярное значение, нам нужно использовать следующий код:</span><span class="sxs-lookup"><span data-stu-id="c39dd-217">That is, if we wanted the `DisplayPrice` method to accept the price as a scalar value, we d have to use the following code:</span></span>

[!code-csharp[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample4.cs)]

<span data-ttu-id="c39dd-218">Обратите внимание, что `unitPrice` входной параметр имеет тип `Object` и условный оператор был изменен, чтобы убедиться, что `unitPrice` `DBNull`.</span><span class="sxs-lookup"><span data-stu-id="c39dd-218">Note that the `unitPrice` input parameter is of type `Object` and that the conditional statement has been modified to ascertain if `unitPrice` is `DBNull` or not.</span></span> <span data-ttu-id="c39dd-219">Кроме того, поскольку входной параметр `unitPrice` передается в качестве `Object`, он должен быть приведен к десятичному значению.</span><span class="sxs-lookup"><span data-stu-id="c39dd-219">Furthermore, since the `unitPrice` input parameter is passed in as an `Object`, it must be cast to a decimal value.</span></span>

## <a name="step-2-calling-the-formatting-function-from-the-datalist-s-itemtemplate"></a><span data-ttu-id="c39dd-220">Шаг 2. вызов функции форматирования из DataList s ItemTemplate</span><span class="sxs-lookup"><span data-stu-id="c39dd-220">Step 2: Calling the Formatting Function from the DataList s ItemTemplate</span></span>

<span data-ttu-id="c39dd-221">С помощью функций форматирования, добавленных в наш класс кода программной части ASP.NET Page s, остается только вызвать эти функции форматирования из `ItemTemplate`DataList.</span><span class="sxs-lookup"><span data-stu-id="c39dd-221">With the formatting functions added to our ASP.NET page s code-behind class, all that remains is to invoke these formatting functions from the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="c39dd-222">Чтобы вызвать функцию форматирования из шаблона, поместите вызов функции в синтаксис DataBinding:</span><span class="sxs-lookup"><span data-stu-id="c39dd-222">To call a formatting function from a template, place the function call within the databinding syntax:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample5.aspx)]

<span data-ttu-id="c39dd-223">В DataList s `ItemTemplate` веб-элемент управления Labels `ProductNameLabel` отображает имя продукта, назначив его свойство `Text` результату `<%# Eval("ProductName") %>`.</span><span class="sxs-lookup"><span data-stu-id="c39dd-223">In the DataList s `ItemTemplate` the `ProductNameLabel` Label Web control currently displays the product s name by assigning its `Text` property the result of `<%# Eval("ProductName") %>`.</span></span> <span data-ttu-id="c39dd-224">Чтобы отобразить имя и текст [СНЯТо с учета], обновите декларативный синтаксис таким образом, чтобы он назначил свойству `Text` значение метода `DisplayProductNameAndDiscontinuedStatus`.</span><span class="sxs-lookup"><span data-stu-id="c39dd-224">In order to have it display the name plus the text [DISCONTINUED], if needed, update the declarative syntax so that it instead assigns the `Text` property the value of the `DisplayProductNameAndDiscontinuedStatus` method.</span></span> <span data-ttu-id="c39dd-225">При этом необходимо передать имя продукта и неподдерживаемые значения с помощью синтаксиса `Eval("columnName")`.</span><span class="sxs-lookup"><span data-stu-id="c39dd-225">When doing so, we must pass in the product s name and discontinued values using the `Eval("columnName")` syntax.</span></span> <span data-ttu-id="c39dd-226">`Eval` возвращает значение типа `Object`, но метод `DisplayProductNameAndDiscontinuedStatus` ждет входные параметры типа `String` и `Boolean`; Поэтому необходимо привести значения, возвращаемые методом `Eval`, к ожидаемым типам входных параметров, например так:</span><span class="sxs-lookup"><span data-stu-id="c39dd-226">`Eval` returns a value of type `Object`, but the `DisplayProductNameAndDiscontinuedStatus` method expects input parameters of type `String` and `Boolean`; therefore, we must cast the values returned by the `Eval` method to the expected input parameter types, like so:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample6.aspx)]

<span data-ttu-id="c39dd-227">Чтобы отобразить цену, можно просто установить для свойства `UnitPriceLabel` Label `Text` значение, возвращаемое методом `DisplayPrice`, точно так же, как и для отображения имени продукта и текста [СНЯТо с производства].</span><span class="sxs-lookup"><span data-stu-id="c39dd-227">To display the price, we can simply set the `UnitPriceLabel` Label s `Text` property to the value returned by the `DisplayPrice` method, just like we did for displaying the product s name and [DISCONTINUED] text.</span></span> <span data-ttu-id="c39dd-228">Однако вместо передачи `UnitPrice` в качестве скалярного входного параметра мы передаем весь экземпляр `ProductsRow`:</span><span class="sxs-lookup"><span data-stu-id="c39dd-228">However, instead of passing in the `UnitPrice` as a scalar input parameter, we instead pass in the entire `ProductsRow` instance:</span></span>

[!code-aspx[Main](formatting-the-datalist-and-repeater-based-upon-data-cs/samples/sample7.aspx)]

<span data-ttu-id="c39dd-229">Используя вызовы функций форматирования на месте, уделите время для просмотра хода выполнения в браузере.</span><span class="sxs-lookup"><span data-stu-id="c39dd-229">With the calls to the formatting functions in place, take a moment to view our progress in a browser.</span></span> <span data-ttu-id="c39dd-230">Экран должен выглядеть примерно так, как показано на рис. 5, с неподдерживаемыми продуктами, включая текст [СНЯТо с производства], и товары, стоимость которых превышает $20,00, если их цена заменена текстом, обратитесь в ценовую квоту.</span><span class="sxs-lookup"><span data-stu-id="c39dd-230">Your screen should look similar to Figure 5, with the discontinued products including the text [DISCONTINUED] and those products costing more than $20.00 having their price replaced with the text Please call for a price quote .</span></span>

<span data-ttu-id="c39dd-231">[![для дорогостоящих продуктов цена заменяется текстом, вызовите для предложения цены.](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="c39dd-231">[![For Expensive Products, the Price is Replaced with the Text, Please call for a price quote](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image14.png)](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image13.png)</span></span>

<span data-ttu-id="c39dd-232">**Рис. 5**. для дорогостоящих продуктов цена заменяется текстом, вызовите предложение с расценками цены ([щелкните, чтобы просмотреть изображение с полным размером](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image15.png)).</span><span class="sxs-lookup"><span data-stu-id="c39dd-232">**Figure 5**: For Expensive Products, the Price is Replaced with the Text, Please call for a price quote ([Click to view full-size image](formatting-the-datalist-and-repeater-based-upon-data-cs/_static/image15.png))</span></span>

## <a name="summary"></a><span data-ttu-id="c39dd-233">Сводка</span><span class="sxs-lookup"><span data-stu-id="c39dd-233">Summary</span></span>

<span data-ttu-id="c39dd-234">Форматирование содержимого элемента управления DataList или Repeater на основе данных может быть выполнено с помощью двух методов.</span><span class="sxs-lookup"><span data-stu-id="c39dd-234">Formatting the contents of a DataList or Repeater control based upon the data can be accomplished using two techniques.</span></span> <span data-ttu-id="c39dd-235">Первым методом является создание обработчика для события `ItemDataBound`, которое срабатывает, когда каждая запись в источнике данных привязывается к новому `DataListItem` или `RepeaterItem`.</span><span class="sxs-lookup"><span data-stu-id="c39dd-235">The first technique is to create an event handler for the `ItemDataBound` event, which fires as each record in the data source is bound to a new `DataListItem` or `RepeaterItem`.</span></span> <span data-ttu-id="c39dd-236">В обработчике `ItemDataBound` событий можно просмотреть текущие данные элементов, а затем применить форматирование к содержимому шаблона или, для `DataListItem` s, ко всему элементу.</span><span class="sxs-lookup"><span data-stu-id="c39dd-236">In the `ItemDataBound` event handler, the current item s data can be examined and then formatting can be applied to the contents of the template or, for `DataListItem` s, to the entire item itself.</span></span>

<span data-ttu-id="c39dd-237">Кроме того, пользовательское форматирование можно реализовать с помощью функций форматирования.</span><span class="sxs-lookup"><span data-stu-id="c39dd-237">Alternatively, custom formatting can be realized through formatting functions.</span></span> <span data-ttu-id="c39dd-238">Функция форматирования — это метод, который может быть вызван из шаблонов DataList или Repeater, который возвращает HTML-код для порождения на своем месте.</span><span class="sxs-lookup"><span data-stu-id="c39dd-238">A formatting function is a method that can be invoked from the DataList or Repeater s templates that returns the HTML to emit in its place.</span></span> <span data-ttu-id="c39dd-239">Часто HTML-код, возвращаемый функцией форматирования, определяется значениями, привязанными к текущему элементу.</span><span class="sxs-lookup"><span data-stu-id="c39dd-239">Often, the HTML returned by a formatting function is determined by the values being bound to the current item.</span></span> <span data-ttu-id="c39dd-240">Эти значения можно передать в функцию форматирования либо в виде скалярных значений, либо передавая весь объект, привязанный к элементу (например, `ProductsRow` экземпляр).</span><span class="sxs-lookup"><span data-stu-id="c39dd-240">These values can be passed into the formatting function, either as scalar values or by passing in the entire object being bound to the item (such as the `ProductsRow` instance).</span></span>

<span data-ttu-id="c39dd-241">Поздравляем с программированием!</span><span class="sxs-lookup"><span data-stu-id="c39dd-241">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c39dd-242">Об авторе</span><span class="sxs-lookup"><span data-stu-id="c39dd-242">About the Author</span></span>

<span data-ttu-id="c39dd-243">[Скотт Митчелл](http://www.4guysfromrolla.com/ScottMitchell.shtml), автор семи книг по ASP/ASP. NET и основатель [4GuysFromRolla.com](http://www.4guysfromrolla.com), работал с веб-технологиями Майкрософт с 1998.</span><span class="sxs-lookup"><span data-stu-id="c39dd-243">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c39dd-244">Скотт работает как независимый консультант, преподаватель и модуль записи.</span><span class="sxs-lookup"><span data-stu-id="c39dd-244">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c39dd-245">Его последняя книга — [*Sams обучать себя ASP.NET 2,0 за 24 часа*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="c39dd-245">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c39dd-246">Он доступен по адресу [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c39dd-246">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="c39dd-247">или через его блог, который можно найти по адресу [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="c39dd-247">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="c39dd-248">Специальная благодарность</span><span class="sxs-lookup"><span data-stu-id="c39dd-248">Special Thanks To</span></span>

<span data-ttu-id="c39dd-249">Эта серия руководств была рассмотрена многими полезными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="c39dd-249">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="c39dd-250">Потенциальные рецензенты для этого руководства: Яааков yaakov Ellis), Рэнди Шмидт и основными рецензентами.</span><span class="sxs-lookup"><span data-stu-id="c39dd-250">Lead reviewers for this tutorial were Yaakov Ellis, Randy Schmidt, and Liz Shulok.</span></span> <span data-ttu-id="c39dd-251">Хотите ознакомиться с моими будущими статьями MSDN?</span><span class="sxs-lookup"><span data-stu-id="c39dd-251">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="c39dd-252">Если это так, расположите строку в [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c39dd-252">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c39dd-253">[Назад](displaying-data-with-the-datalist-and-repeater-controls-cs.md)
> [Вперед](showing-multiple-records-per-row-with-the-datalist-control-cs.md)</span><span class="sxs-lookup"><span data-stu-id="c39dd-253">[Previous](displaying-data-with-the-datalist-and-repeater-controls-cs.md)
[Next](showing-multiple-records-per-row-with-the-datalist-control-cs.md)</span></span>
